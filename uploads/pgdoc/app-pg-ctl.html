<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>pg_ctl</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="prev" href="app-pgcontroldata.html" title="pg_controldata" /><link rel="next" href="app-pgresetxlog.html" title="pg_resetxlog" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center"><span xmlns="http://www.w3.org/1999/xhtml" class="application">pg_ctl</span></th></tr><tr><td width="10%" align="left"><a accesskey="p" href="app-pgcontroldata.html" title="pg_controldata">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="reference-server.html" title="PostgreSQL Server Applications">Up</a></td><th width="60%" align="center">PostgreSQL Server Applications</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 10devel Documentation">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="app-pgresetxlog.html" title="pg_resetxlog">Next</a></td></tr></table><hr></hr></div><div class="refentry" id="app-pg-ctl"><div class="titlepage"></div><a id="idm45642330016080" class="indexterm"></a><div class="refnamediv"><h2>Name</h2><p>pg_ctl — initialize, start, stop, or control a <span class="productname">PostgreSQL</span> server</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p id="idm45642330012112"><code class="command">pg_ctl</code>  <code class="option">init[db]</code>  [<code class="option">-s</code>] [<code class="option">-D</code> <em class="replaceable"><code>datadir</code></em>] [<code class="option">-o</code> <em class="replaceable"><code>initdb-options</code></em>]</p></div><div class="cmdsynopsis"><p id="idm45642330006704"><code class="command">pg_ctl</code>  <code class="option">start</code>  [<code class="option">-w</code>] [<code class="option">-t</code> <em class="replaceable"><code>seconds</code></em>] [<code class="option">-s</code>] [<code class="option">-D</code> <em class="replaceable"><code>datadir</code></em>] [<code class="option">-l</code> <em class="replaceable"><code>filename</code></em>] [<code class="option">-o</code> <em class="replaceable"><code>options</code></em>] [<code class="option">-p</code> <em class="replaceable"><code>path</code></em>] [<code class="option">-c</code>]</p></div><div class="cmdsynopsis"><p id="idm45642329995568"><code class="command">pg_ctl</code>  <code class="option">stop</code>  [<code class="option">-W</code>] [<code class="option">-t</code> <em class="replaceable"><code>seconds</code></em>] [<code class="option">-s</code>] [<code class="option">-D</code> <em class="replaceable"><code>datadir</code></em>] [<code class="option">-m</code>
        <code class="option">s[mart]</code>  |   <code class="option">f[ast]</code>  |   <code class="option">i[mmediate]</code>  
   ]</p></div><div class="cmdsynopsis"><p id="idm45642329984512"><code class="command">pg_ctl</code>  <code class="option">restart</code>  [<code class="option">-w</code>] [<code class="option">-t</code> <em class="replaceable"><code>seconds</code></em>] [<code class="option">-s</code>] [<code class="option">-D</code> <em class="replaceable"><code>datadir</code></em>] [<code class="option">-c</code>] [<code class="option">-m</code>
        <code class="option">s[mart]</code>  |   <code class="option">f[ast]</code>  |   <code class="option">i[mmediate]</code>  
   ] [<code class="option">-o</code> <em class="replaceable"><code>options</code></em>]</p></div><div class="cmdsynopsis"><p id="idm45642329971296"><code class="command">pg_ctl</code>  <code class="option">reload</code>  [<code class="option">-s</code>] [<code class="option">-D</code> <em class="replaceable"><code>datadir</code></em>]</p></div><div class="cmdsynopsis"><p id="idm45642329967200"><code class="command">pg_ctl</code>  <code class="option">status</code>  [<code class="option">-D</code> <em class="replaceable"><code>datadir</code></em>]</p></div><div class="cmdsynopsis"><p id="idm45642329964000"><code class="command">pg_ctl</code>  <code class="option">promote</code>  [<code class="option">-w</code>] [<code class="option">-t</code> <em class="replaceable"><code>seconds</code></em>] [<code class="option">-s</code>] [<code class="option">-D</code> <em class="replaceable"><code>datadir</code></em>]</p></div><div class="cmdsynopsis"><p id="idm45642329957696"><code class="command">pg_ctl</code>  <code class="option">kill</code>   <em class="replaceable"><code>signal_name</code></em>   <em class="replaceable"><code>process_id</code></em> </p></div><div class="cmdsynopsis"><p id="idm45642329953888"><code class="command">pg_ctl</code>  <code class="option">register</code>  [<code class="option">-N</code> <em class="replaceable"><code>servicename</code></em>] [<code class="option">-U</code> <em class="replaceable"><code>username</code></em>] [<code class="option">-P</code> <em class="replaceable"><code>password</code></em>] [<code class="option">-D</code> <em class="replaceable"><code>datadir</code></em>] [<code class="option">-S</code>
        <code class="option">a[uto]</code>  |   <code class="option">d[emand]</code>  
   ] [<code class="option">-w</code>] [<code class="option">-t</code> <em class="replaceable"><code>seconds</code></em>] [<code class="option">-s</code>] [<code class="option">-o</code> <em class="replaceable"><code>options</code></em>]</p></div><div class="cmdsynopsis"><p id="idm45642329938592"><code class="command">pg_ctl</code>  <code class="option">unregister</code>  [<code class="option">-N</code> <em class="replaceable"><code>servicename</code></em>]</p></div></div><div class="refsect1" id="app-pg-ctl-description"><h2>Description</h2><p>   <span class="application">pg_ctl</span> is a utility for initializing a
   <span class="productname">PostgreSQL</span> database cluster, starting,
   stopping, or restarting the <span class="productname">PostgreSQL</span>
   database server (<a class="xref" href="app-postgres.html" title="postgres"><span class="refentrytitle"><span class="application">postgres</span></span></a>), or displaying the
   status of a running server.  Although the server can be started
   manually, <span class="application">pg_ctl</span> encapsulates tasks such
   as redirecting log output and properly detaching from the terminal
   and process group. It also provides convenient options for
   controlled shutdown.
  </p><p>   The <code class="option">init</code> or <code class="option">initdb</code> mode creates a new
   <span class="productname">PostgreSQL</span> database cluster.  A database
   cluster is a collection of databases that are managed by a single
   server instance.  This mode invokes the <code class="command">initdb</code>
   command.  See <a class="xref" href="app-initdb.html" title="initdb"><span class="refentrytitle">initdb</span></a> for details.
  </p><p>   In <code class="option">start</code> mode, a new server is launched.  The
   server is started in the background, and its standard input is attached
   to <code class="filename">/dev/null</code> (or <code class="literal">nul</code> on Windows).
   On Unix-like systems, by default, the server's standard output and
   standard error are sent to <span class="application">pg_ctl</span>'s
   standard output (not standard error).  The standard output of
   <span class="application">pg_ctl</span> should then be redirected to a
   file or piped to another process such as a log rotating program
   like <span class="application">rotatelogs</span>; otherwise <code class="command">postgres</code>
   will write its output to the controlling terminal (from the
   background) and will not leave the shell's process group.  On
   Windows, by default the server's standard output and standard error
   are sent to the terminal.  These default behaviors can be changed
   by using <code class="option">-l</code> to append the server's output to a log file.
   Use of either <code class="option">-l</code> or output redirection is recommended.
  </p><p>   In <code class="option">stop</code> mode, the server that is running in
   the specified data directory is shut down.  Three different
   shutdown methods can be selected with the <code class="option">-m</code>
   option.  <span class="quote">“<span class="quote">Smart</span>”</span> mode waits for all active
   clients to disconnect and any online backup to finish.
   If the server is in hot standby, recovery and streaming replication
   will be terminated once all clients have disconnected.
   <span class="quote">“<span class="quote">Fast</span>”</span> mode (the default) does not wait for clients to disconnect and
   will terminate an online backup in progress.  All active transactions are
   rolled back and clients are forcibly disconnected, then the
   server is shut down.  <span class="quote">“<span class="quote">Immediate</span>”</span> mode will abort
   all server processes immediately, without a clean shutdown.
   This will lead to a crash-recovery run on the next restart.
  </p><p>   <code class="option">restart</code> mode effectively executes a stop followed
   by a start.  This allows changing the <code class="command">postgres</code>
   command-line options.  <code class="option">restart</code> might fail if
   relative paths specified were specified on the command-line during
   server start.
  </p><p>   <code class="option">reload</code> mode simply sends the
   <code class="command">postgres</code> process a <span class="systemitem">SIGHUP</span>
   signal, causing it to reread its configuration files
   (<code class="filename">postgresql.conf</code>,
   <code class="filename">pg_hba.conf</code>, etc.).  This allows changing of
   configuration-file options that do not require a complete restart
   to take effect.
  </p><p>   <code class="option">status</code> mode checks whether a server is running in
   the specified data directory. If it is, the <acronym class="acronym">PID</acronym>
   and the command line options that were used to invoke it are
   displayed.  If the server is not running, the process returns an
   exit status of 3.  If an accessible data directory is not specified,
   the process returns an exit status of 4.
  </p><p>   In <code class="option">promote</code> mode, the standby server that is
   running in the specified data directory is commanded to exit
   recovery and begin read-write operations.
  </p><p>   <code class="option">kill</code> mode allows you to send a signal to a specified
    process.  This is particularly valuable for <span class="productname">Microsoft Windows</span>
    which does not have a <span class="application">kill</span> command.  Use
    <code class="literal">--help</code> to see a list of supported signal names.
  </p><p>   <code class="option">register</code> mode allows you to register a system service
   on <span class="productname">Microsoft Windows</span>.  The <code class="option">-S</code> option
   allows selection of service start type, either <span class="quote">“<span class="quote">auto</span>”</span> (start
   service automatically on system startup) or <span class="quote">“<span class="quote">demand</span>”</span> (start
   service on demand).
  </p><p>   <code class="option">unregister</code> mode allows you to unregister a system service
   on <span class="productname">Microsoft Windows</span>.  This undoes the effects of the
   <code class="option">register</code> command.
  </p></div><div class="refsect1" id="app-pg-ctl-options"><h2>Options</h2><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-c</code><br /></span><span class="term"><code class="option">--core-file</code></span></dt><dd><p>        Attempt to allow server crashes to produce core files, on platforms
        where this is possible, by lifting any soft resource limit placed on
        core files.
        This is useful in debugging or diagnosing problems by allowing a
        stack trace to be obtained from a failed server process.
       </p></dd><dt><span class="term"><code class="option">-D <em class="replaceable"><code>datadir</code></em></code><br /></span><span class="term"><code class="option">--pgdata=<em class="replaceable"><code>datadir</code></em></code></span></dt><dd><p>        Specifies the file system location of the database configuration files.  If
        this is omitted, the environment variable
        <code class="envar">PGDATA</code> is used.
       </p></dd><dt><span class="term"><code class="option">-l <em class="replaceable"><code>filename</code></em></code><br /></span><span class="term"><code class="option">--log=<em class="replaceable"><code>filename</code></em></code></span></dt><dd><p>        Append the server log output to
        <em class="replaceable"><code>filename</code></em>.  If the file does not
        exist, it is created.  The <span class="systemitem">umask</span> is set to 077,
        so access to the log file is disallowed to other users by default.
       </p></dd><dt><span class="term"><code class="option">-m <em class="replaceable"><code>mode</code></em></code><br /></span><span class="term"><code class="option">--mode=<em class="replaceable"><code>mode</code></em></code></span></dt><dd><p>        Specifies the shutdown mode.  <em class="replaceable"><code>mode</code></em>
        can be <code class="literal">smart</code>, <code class="literal">fast</code>, or
        <code class="literal">immediate</code>, or the first letter of one of
        these three.  If this is omitted, <code class="literal">fast</code> is used.
       </p></dd><dt><span class="term"><code class="option">-o <em class="replaceable"><code>options</code></em></code><br /></span><span class="term"><code class="option">--options=<em class="replaceable"><code>options</code></em></code></span></dt><dd><p>        Specifies options to be passed directly to the
        <code class="command">postgres</code> command;  multiple
        option invocations are appended.
       </p><p>        The options should usually be surrounded by single or double
        quotes to ensure that they are passed through as a group.
       </p></dd><dt><span class="term"><code class="option">-o <em class="replaceable"><code>initdb-options</code></em></code><br /></span><span class="term"><code class="option">--options=<em class="replaceable"><code>initdb-options</code></em></code></span></dt><dd><p>        Specifies options to be passed directly to the
        <code class="command">initdb</code> command.
       </p><p>        The options should usually be surrounded by single or double
        quotes to ensure that they are passed through as a group.
       </p></dd><dt><span class="term"><code class="option">-p <em class="replaceable"><code>path</code></em></code></span></dt><dd><p>        Specifies the location of the <code class="filename">postgres</code>
        executable.  By default the <code class="filename">postgres</code> executable is taken from the same
        directory as <code class="command">pg_ctl</code>, or failing that, the hard-wired
        installation directory.  It is not necessary to use this
        option unless you are doing something unusual and get errors
        that the <code class="filename">postgres</code> executable was not found.
       </p><p>        In <code class="literal">init</code> mode, this option analogously
        specifies the location of the <code class="filename">initdb</code>
        executable.
       </p></dd><dt><span class="term"><code class="option">-s</code><br /></span><span class="term"><code class="option">--silent</code></span></dt><dd><p>        Print only errors, no informational messages.
       </p></dd><dt><span class="term"><code class="option">-t</code><br /></span><span class="term"><code class="option">--timeout</code></span></dt><dd><p>        The maximum number of seconds to wait when waiting for an operation
        to complete (see option <code class="option">-w</code>). Defaults to the value of the
        <code class="envar">PGCTLTIMEOUT</code> environment variable or, if not set, to 60
        seconds.
       </p></dd><dt><span class="term"><code class="option">-V</code><br /></span><span class="term"><code class="option">--version</code></span></dt><dd><p>         Print the <span class="application">pg_ctl</span> version and exit.
        </p></dd><dt><span class="term"><code class="option">-w</code><br /></span><span class="term"><code class="option">--wait</code></span></dt><dd><p>        Wait for an operation to complete.  This is supported for the
        modes <code class="literal">start</code>, <code class="literal">stop</code>,
        <code class="literal">restart</code>, <code class="literal">promote</code>,
        and <code class="literal">register</code>.
       </p><p>        Waiting is the default option for shutdowns, but not startups,
        restarts, or promotions.  This is mainly for historical reasons; the
        waiting option is almost always preferable.  If waiting is not
        selected, the requested action is triggered, but there is no feedback
        about its success.  In that case, the server log file or an external
        monitoring system would have to be used to check the progress and
        success of the operation.
       </p><p>        When waiting for startup, <code class="command">pg_ctl</code> repeatedly
        attempts to connect to the server.
        When waiting for shutdown, <code class="command">pg_ctl</code> waits for
        the server to remove its <acronym class="acronym">PID</acronym> file.
        This option allows the entry of an <acronym class="acronym">SSL</acronym> passphrase on startup.
        <code class="command">pg_ctl</code> returns an exit code based on the
        success of the startup or shutdown.
       </p></dd><dt><span class="term"><code class="option">-W</code><br /></span><span class="term"><code class="option">--no-wait</code></span></dt><dd><p>        Do not wait for an operation to complete.  This is the opposite of the
        option <code class="option">-w</code>.
       </p></dd><dt><span class="term"><code class="option">-?</code><br /></span><span class="term"><code class="option">--help</code></span></dt><dd><p>        Show help about <span class="application">pg_ctl</span> command line
        arguments, and exit.
       </p></dd></dl></div><div class="refsect2" id="app-pg-ctl-windows-options"><h3>Options for Windows</h3><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-e <em class="replaceable"><code>source</code></em></code></span></dt><dd><p>       Name of the event source for <span class="application">pg_ctl</span> to use
       for logging to the event log when running as a Windows service.  The
       default is <code class="literal">PostgreSQL</code>.  Note that this only controls
       the logging from <span class="application">pg_ctl</span> itself; once
       started, the server will use the event source specified
       by <a class="xref" href="runtime-config-logging.html#guc-event-source">event_source</a>.  Should the server fail during
       early startup, it might also log using the default event
       source <code class="literal">PostgreSQL</code>.
      </p></dd><dt><span class="term"><code class="option">-N <em class="replaceable"><code>servicename</code></em></code></span></dt><dd><p>       Name of the system service to register. The name will be used
       as both the service name and the display name.
      </p></dd><dt><span class="term"><code class="option">-P <em class="replaceable"><code>password</code></em></code></span></dt><dd><p>       Password for the user to start the service.
      </p></dd><dt><span class="term"><code class="option">-S <em class="replaceable"><code>start-type</code></em></code></span></dt><dd><p>       Start type of the system service to register.  start-type can
       be <code class="literal">auto</code>, or <code class="literal">demand</code>, or
       the first letter of one of these two. If this is omitted,
       <code class="literal">auto</code> is used.
      </p></dd><dt><span class="term"><code class="option">-U <em class="replaceable"><code>username</code></em></code></span></dt><dd><p>       User name for the user to start the service. For domain users, use the
       format <code class="literal">DOMAIN\username</code>.
      </p></dd></dl></div></div></div><div class="refsect1" id="idm45642329837456"><h2>Environment</h2><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="envar">PGCTLTIMEOUT</code></span></dt><dd><p>      Default limit on the number of seconds to wait when waiting for startup
      or shutdown to complete.  If not set, the default is 60 seconds.
     </p></dd><dt><span class="term"><code class="envar">PGDATA</code></span></dt><dd><p>      Default data directory location.
     </p></dd></dl></div><p>   <code class="command">pg_ctl</code>, like most other <span class="productname">PostgreSQL</span>
   utilities,
   also uses the environment variables supported by <span class="application">libpq</span>
   (see <a class="xref" href="libpq-envars.html" title="32.14. Environment Variables">Section 32.14, “Environment Variables”</a>).
   For additional server variables, see <a class="xref" href="app-postgres.html" title="postgres"><span class="refentrytitle"><span class="application">postgres</span></span></a>.
  </p></div><div class="refsect1" id="idm45642329830976"><h2>Files</h2><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="filename">postmaster.pid</code></span></dt><dd><p>      The existence of this file in the data directory is used to help
      <span class="application">pg_ctl</span> determine if the server is
      currently running.
     </p></dd><dt><span class="term"><code class="filename">postmaster.opts</code></span></dt><dd><p>If this file exists in the data directory,
      <span class="application">pg_ctl</span> (in <code class="option">restart</code> mode)
      will pass the contents of the file as options to
      <span class="application">postgres</span>, unless overridden
      by the <code class="option">-o</code> option. The contents of this file
      are also displayed in <code class="option">status</code> mode.
     </p></dd></dl></div></div><div class="refsect1" id="r1-app-pgctl-2"><h2>Examples</h2><div class="refsect2" id="r2-app-pgctl-3"><h3>Starting the Server</h3><p>    To start the server:
</p><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code>pg_ctl start</code></strong></pre><p>
   </p><p>    To start the server, waiting until the server is
    accepting connections:
</p><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code>pg_ctl -w start</code></strong></pre><p>
   </p><p>    To start the server using port 5433, and
    running without <code class="function">fsync</code>, use:
</p><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code>pg_ctl -o "-F -p 5433" start</code></strong></pre></div><div class="refsect2" id="r2-app-pgctl-4"><h3>Stopping the Server</h3><p>    To stop the server, use:
</p><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code>pg_ctl stop</code></strong></pre><p>
    The <code class="option">-m</code> option allows control over
    <span class="emphasis"><em>how</em></span> the server shuts down:
</p><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code>pg_ctl stop -m fast</code></strong></pre></div><div class="refsect2" id="r2-app-pgctl-5"><h3>Restarting the Server</h3><p>    Restarting the server is almost equivalent to stopping the
    server and starting it again,
    except that <code class="command">pg_ctl</code> saves and reuses the command line options that
    were passed to the previously running instance.  To restart
    the server in the simplest form, use:
</p><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code>pg_ctl restart</code></strong></pre><p>
   </p><p>    To restart the server,
    waiting for it to shut down and restart:
</p><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code>pg_ctl -w restart</code></strong></pre><p>
   </p><p>    To restart using port 5433, disabling <code class="function">fsync</code> upon restart:
</p><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code>pg_ctl -o "-F -p 5433" restart</code></strong></pre></div><div class="refsect2" id="r2-app-pgctl-6"><h3>Showing the Server Status</h3><p>    Here is sample status output from
    <span class="application">pg_ctl</span>:
</p><pre class="screen"><code class="prompt">$</code> <strong class="userinput"><code>pg_ctl status</code></strong>
<code class="computeroutput">pg_ctl: server is running (PID: 13718)
/usr/local/pgsql/bin/postgres "-D" "/usr/local/pgsql/data" "-p" "5433" "-B" "128"</code></pre><p>
    This is the command line that would be invoked in restart mode.
   </p></div></div><div class="refsect1" id="idm45642329797088"><h2>See Also</h2><span class="simplelist"><a class="xref" href="app-initdb.html" title="initdb"><span class="refentrytitle">initdb</span></a>, <a class="xref" href="app-postgres.html" title="postgres"><span class="refentrytitle"><span class="application">postgres</span></span></a></span></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="app-pgcontroldata.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="reference-server.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="app-pgresetxlog.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top"><span class="application">pg_controldata</span> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> <span class="application">pg_resetxlog</span></td></tr></table></div></body></html>