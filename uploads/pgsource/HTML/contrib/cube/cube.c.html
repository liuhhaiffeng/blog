<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>contrib\cube\cube.c</title>
<LINK REL=StyleSheet HREF="../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>contrib\cube\cube.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:25 2017
</td></tr>
<tr><td><a href='../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/****************************************************************************** 
  contrib/cube/cube.c 
 
  This file contains routines that can be bound to a Postgres backend and 
  called by the backend in the process of processing queries.  The calling 
  format for these routines is dictated by Postgres architecture. 
******************************************************************************/ 
</span> 
<span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>&LT;float.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;math.h&GT;</span> 
 
<span class='Keyword'>#include </span><span class='String'>"access/gist.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/stratnum.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/array.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/builtins.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>"cubedata.h"</span> 
 
<a href="../../src/include/fmgr.h.html#LN442"><span class='Ref_to_Const'>PG_MODULE_MAGIC</span></a><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Taken from the intarray contrib header 
 */ 
</span><a name="LN25"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>ARRPTR</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>x</span><span class='Parentheses'>)</span>  <span class='Parentheses'>(</span> <span class='Parentheses'>(</span><span class='Keyword'>double </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/utils/array.h.html#LN302"><span class='Ref_to_Macro'>ARR_DATA_PTR</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN25"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>) )</span> 
<a name="LN26"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>ARRNELEMS</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>x</span><span class='Parentheses'>)</span>  <a href="../../src/backend/utils/adt/arrayutils.c.html#LN73"><span class='Ref_to_Func'>ArrayGetNItems</span></a><span class='Parentheses'>(</span> <a href="../../src/include/utils/array.h.html#LN270"><span class='Ref_to_Macro'>ARR_NDIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN26"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../../src/include/utils/array.h.html#LN274"><span class='Ref_to_Macro'>ARR_DIMS</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN26"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>))</span> 
 
<span class='Comment_Multi_Line'>/* 
** Input/Output routines 
*/ 
</span><a name="LN31"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN115"><span class='Ref_to_Func'>cube_in</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN32"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN135"><span class='Ref_to_Func'>cube_a_f8_f8</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN33"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN195"><span class='Ref_to_Func'>cube_a_f8</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN34"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN268"><span class='Ref_to_Func'>cube_out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN35"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1598"><span class='Ref_to_Func'>cube_f8</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN36"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1616"><span class='Ref_to_Func'>cube_f8_f8</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN37"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1648"><span class='Ref_to_Func'>cube_c_f8</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN38"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1688"><span class='Ref_to_Func'>cube_c_f8_f8</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN39"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1426"><span class='Ref_to_Func'>cube_dim</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN40"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1437"><span class='Ref_to_Func'>cube_ll_coord</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN41"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1454"><span class='Ref_to_Func'>cube_ur_coord</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN42"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1475"><span class='Ref_to_Func'>cube_coord</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN43"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1503"><span class='Ref_to_Func'>cube_coord_llur</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN44"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN226"><span class='Ref_to_Func'>cube_subset</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* 
** GiST support methods 
*/ 
</span> 
<a name="LN50"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN314"><span class='Ref_to_Func'>g_cube_consistent</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN51"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN380"><span class='Ref_to_Func'>g_cube_compress</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN52"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN386"><span class='Ref_to_Func'>g_cube_decompress</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN53"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN409"><span class='Ref_to_Func'>g_cube_penalty</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN54"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN434"><span class='Ref_to_Func'>g_cube_picksplit</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN55"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN348"><span class='Ref_to_Func'>g_cube_union</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN56"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN583"><span class='Ref_to_Func'>g_cube_same</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN57"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1328"><span class='Ref_to_Func'>g_cube_distance</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* 
** B-tree support functions 
*/ 
</span><a name="LN62"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN962"><span class='Ref_to_Func'>cube_eq</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN63"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN977"><span class='Ref_to_Func'>cube_ne</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN64"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN992"><span class='Ref_to_Func'>cube_lt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN65"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1007"><span class='Ref_to_Func'>cube_gt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN66"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1022"><span class='Ref_to_Func'>cube_le</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN67"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1037"><span class='Ref_to_Func'>cube_ge</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN68"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN947"><span class='Ref_to_Func'>cube_cmp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* 
** R-tree support functions 
*/ 
</span> 
<a name="LN74"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1092"><span class='Ref_to_Func'>cube_contains</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN75"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1108"><span class='Ref_to_Func'>cube_contained</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN76"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1163"><span class='Ref_to_Func'>cube_overlap</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN77"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN734"><span class='Ref_to_Func'>cube_union</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN78"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN749"><span class='Ref_to_Func'>cube_inter</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN79"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN829"><span class='Ref_to_Func'>cube_size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* 
** miscellaneous 
*/ 
</span><a name="LN84"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1232"><span class='Ref_to_Func'>distance_taxicab</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN85"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1183"><span class='Ref_to_Func'>cube_distance</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN86"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1276"><span class='Ref_to_Func'>distance_chebyshev</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN87"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1391"><span class='Ref_to_Func'>cube_is_point</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN88"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1533"><span class='Ref_to_Func'>cube_enlarge</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* 
** For internal use only 
*/ 
</span><a name="LN93"></a><a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Prototype'>cube_cmp_v0</span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>b</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN94"></a><span class='Keyword'>bool</span>        <span class='Declare_Prototype'>cube_contains_v0</span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>b</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN95"></a><span class='Keyword'>bool</span>        <span class='Declare_Prototype'>cube_overlap_v0</span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>b</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN96"></a><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Prototype'>cube_union_v0</span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>b</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN97"></a><span class='Keyword'>void</span>        <span class='Declare_Prototype'>rt_cube_size</span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><span class='Keyword'>double </span><span class='Operator'>*</span><span class='Declare_Parameter'>sz</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN98"></a><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Prototype'>g_cube_binary_union</span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>r1</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>r2</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>sizep</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN99"></a><span class='Keyword'>bool</span>        <span class='Declare_Prototype'>g_cube_leaf_consistent</span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>key</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>query</span><span class='Delimiter'>, </span><a href="../../src/include/access/stratnum.h.html#LN21"><span class='Ref_to_Typedef'>StrategyNumber</span></a> <span class='Declare_Parameter'>strategy</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN100"></a><span class='Keyword'>bool</span>        <span class='Declare_Prototype'>g_cube_internal_consistent</span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>key</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>query</span><span class='Delimiter'>, </span><a href="../../src/include/access/stratnum.h.html#LN21"><span class='Ref_to_Typedef'>StrategyNumber</span></a> <span class='Declare_Parameter'>strategy</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* 
** Auxiliary funxtions 
*/ 
</span><a name="LN105"></a><span class='Keyword'>static double </span><span class='Declare_Prototype'>distance_1D</span><span class='Parentheses'>(</span><span class='Keyword'>double </span><span class='Declare_Parameter'>a1</span><span class='Delimiter'>, </span><span class='Keyword'>double </span><span class='Declare_Parameter'>a2</span><span class='Delimiter'>, </span><span class='Keyword'>double </span><span class='Declare_Parameter'>b1</span><span class='Delimiter'>, </span><span class='Keyword'>double </span><span class='Declare_Parameter'>b2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN106"></a><span class='Keyword'>static bool </span><span class='Declare_Prototype'>cube_is_point_internal</span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cube</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/***************************************************************************** 
 * Input/Output functions 
 *****************************************************************************/ 
</span> 
<span class='Comment_Multi_Line'>/* NdBox = [(lowerleft),(upperright)] */ 
/* [(xLL(1)...xLL(N)),(xUR(1)...xUR(n))] */ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN116"></a><span class='Declare_Function'>cube_in</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN118"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>str</span> <span class='Operator'>= </span><a href="../../src/include/fmgr.h.html#LN241"><span class='Ref_to_Macro'>PG_GETARG_CSTRING</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN119"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="cubedata.h.html#LN64"><span class='Ref_to_Proto'>cube_scanner_init</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN118"><span class='Ref_To_Local'>str</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN68"><span class='Ref_to_Proto'>cube_yyparse</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="cube.c.html#LN119"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        cube_yyerror<span class='Parentheses'>(</span><span class='Operator'>&</span><a href="cube.c.html#LN119"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><span class='String'>"cube parser failed"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="cubedata.h.html#LN65"><span class='Ref_to_Proto'>cube_scanner_finish</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="cubedata.h.html#LN53"><span class='Ref_to_Macro'>PG_RETURN_NDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN119"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
** Allows the construction of a cube from 2 float[]'s 
*/ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN136"></a><span class='Declare_Function'>cube_a_f8_f8</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN138"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>ur</span> <span class='Operator'>= </span><a href="../../src/include/utils/array.h.html#LN243"><span class='Ref_to_Macro'>PG_GETARG_ARRAYTYPE_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN139"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>ll</span> <span class='Operator'>= </span><a href="../../src/include/utils/array.h.html#LN243"><span class='Ref_to_Macro'>PG_GETARG_ARRAYTYPE_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN140"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN141"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN142"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>dim</span><span class='Delimiter'>; 
</span><a name="LN143"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>size</span><span class='Delimiter'>; 
</span><a name="LN144"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>point</span><span class='Delimiter'>; 
</span><a name="LN145"></a>    <span class='Keyword'>double</span>     <span class='Operator'>*</span><span class='Declare_Local'>dur</span><span class='Delimiter'>, 
</span><a name="LN146"></a>               <span class='Operator'>*</span><span class='Declare_Local'>dll</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/include/utils/array.h.html#LN386"><span class='Ref_to_Proto'>array_contains_nulls</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN138"><span class='Ref_To_Local'>ur</span></a><span class='Parentheses'>) </span><span class='Operator'>|| </span><a href="../../src/include/utils/array.h.html#LN386"><span class='Ref_to_Proto'>array_contains_nulls</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN139"><span class='Ref_To_Local'>ll</span></a><span class='Parentheses'>))</span> 
        <a href="../../src/include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../src/include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../src/include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_ARRAY_ELEMENT_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../../src/backend/utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot work with arrays containing NULLs"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN142"><span class='Ref_To_Local'>dim</span></a> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN14"><span class='Ref_to_Macro'>ARRNELEMS</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN138"><span class='Ref_To_Local'>ur</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../intarray/_int.h.html#LN14"><span class='Ref_to_Macro'>ARRNELEMS</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN139"><span class='Ref_To_Local'>ll</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="cube.c.html#LN142"><span class='Ref_To_Local'>dim</span></a><span class='Parentheses'>)</span> 
        <a href="../../src/include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../src/include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../src/include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_ARRAY_ELEMENT_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../../src/backend/utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"UR and LL arrays must be of same length"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN145"><span class='Ref_To_Local'>dur</span></a> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN138"><span class='Ref_To_Local'>ur</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cube.c.html#LN146"><span class='Ref_To_Local'>dll</span></a> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN139"><span class='Ref_To_Local'>ll</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Check if it's a point */ 
</span>    <a href="cube.c.html#LN144"><span class='Ref_To_Local'>point</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN141"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cube.c.html#LN141"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cube.c.html#LN142"><span class='Ref_To_Local'>dim</span></a><span class='Delimiter'>; </span><a href="cube.c.html#LN141"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN145"><span class='Ref_To_Local'>dur</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN141"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>!= </span><a href="cube.c.html#LN146"><span class='Ref_To_Local'>dll</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN141"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="cube.c.html#LN144"><span class='Ref_To_Local'>point</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="cube.c.html#LN143"><span class='Ref_To_Local'>size</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN144"><span class='Ref_To_Local'>point</span></a> <span class='Operator'>? </span><a href="cubedata.h.html#LN47"><span class='Ref_to_Macro'>POINT_SIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN142"><span class='Ref_To_Local'>dim</span></a><span class='Parentheses'>) </span><span class='Operator'>: </span><a href="cubedata.h.html#LN48"><span class='Ref_to_Macro'>CUBE_SIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN142"><span class='Ref_To_Local'>dim</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cube.c.html#LN140"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN143"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN140"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN143"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cubedata.h.html#LN42"><span class='Ref_to_Macro'>SET_DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN140"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN142"><span class='Ref_To_Local'>dim</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN141"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cube.c.html#LN141"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cube.c.html#LN142"><span class='Ref_To_Local'>dim</span></a><span class='Delimiter'>; </span><a href="cube.c.html#LN141"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <a href="cube.c.html#LN140"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN141"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cube.c.html#LN145"><span class='Ref_To_Local'>dur</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN141"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="cube.c.html#LN144"><span class='Ref_To_Local'>point</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN141"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cube.c.html#LN141"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cube.c.html#LN142"><span class='Ref_To_Local'>dim</span></a><span class='Delimiter'>; </span><a href="cube.c.html#LN141"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>            <a href="cube.c.html#LN140"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN141"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>+ </span><a href="cube.c.html#LN142"><span class='Ref_To_Local'>dim</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cube.c.html#LN146"><span class='Ref_To_Local'>dll</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN141"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
        <a href="cubedata.h.html#LN40"><span class='Ref_to_Macro'>SET_POINT_BIT</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN140"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="cubedata.h.html#LN53"><span class='Ref_to_Macro'>PG_RETURN_NDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN140"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end cube_a_f8_f8 &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
** Allows the construction of a zero-volume cube from a float[] 
*/ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN196"></a><span class='Declare_Function'>cube_a_f8</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN198"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>ur</span> <span class='Operator'>= </span><a href="../../src/include/utils/array.h.html#LN243"><span class='Ref_to_Macro'>PG_GETARG_ARRAYTYPE_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN199"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN200"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN201"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>dim</span><span class='Delimiter'>; 
</span><a name="LN202"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>size</span><span class='Delimiter'>; 
</span><a name="LN203"></a>    <span class='Keyword'>double</span>     <span class='Operator'>*</span><span class='Declare_Local'>dur</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/include/utils/array.h.html#LN386"><span class='Ref_to_Proto'>array_contains_nulls</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN198"><span class='Ref_To_Local'>ur</span></a><span class='Parentheses'>))</span> 
        <a href="../../src/include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../src/include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../src/include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_ARRAY_ELEMENT_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../../src/backend/utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot work with arrays containing NULLs"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN201"><span class='Ref_To_Local'>dim</span></a> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN14"><span class='Ref_to_Macro'>ARRNELEMS</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN198"><span class='Ref_To_Local'>ur</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN203"><span class='Ref_To_Local'>dur</span></a> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN198"><span class='Ref_To_Local'>ur</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN202"><span class='Ref_To_Local'>size</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN47"><span class='Ref_to_Macro'>POINT_SIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN201"><span class='Ref_To_Local'>dim</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cube.c.html#LN199"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN202"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN199"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN202"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cubedata.h.html#LN42"><span class='Ref_to_Macro'>SET_DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN199"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN201"><span class='Ref_To_Local'>dim</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cubedata.h.html#LN40"><span class='Ref_to_Macro'>SET_POINT_BIT</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN199"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN200"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cube.c.html#LN200"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cube.c.html#LN201"><span class='Ref_To_Local'>dim</span></a><span class='Delimiter'>; </span><a href="cube.c.html#LN200"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <a href="cube.c.html#LN199"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN200"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cube.c.html#LN203"><span class='Ref_To_Local'>dur</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN200"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span> 
    <a href="cubedata.h.html#LN53"><span class='Ref_to_Macro'>PG_RETURN_NDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN199"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end cube_a_f8 &raquo; </span> 
 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN227"></a><span class='Declare_Function'>cube_subset</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN229"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>c</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN230"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>idx</span> <span class='Operator'>= </span><a href="../../src/include/utils/array.h.html#LN243"><span class='Ref_to_Macro'>PG_GETARG_ARRAYTYPE_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN231"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN232"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>size</span><span class='Delimiter'>, 
</span><a name="LN233"></a>                <span class='Declare_Local'>dim</span><span class='Delimiter'>, 
</span><a name="LN234"></a>                <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN235"></a>    <span class='Keyword'>int</span>        <span class='Operator'>*</span><span class='Declare_Local'>dx</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/include/utils/array.h.html#LN386"><span class='Ref_to_Proto'>array_contains_nulls</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN230"><span class='Ref_To_Local'>idx</span></a><span class='Parentheses'>))</span> 
        <a href="../../src/include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../src/include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../src/include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_ARRAY_ELEMENT_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../../src/backend/utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot work with arrays containing NULLs"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN235"><span class='Ref_To_Local'>dx</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/utils/array.h.html#LN302"><span class='Ref_to_Macro'>ARR_DATA_PTR</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN230"><span class='Ref_To_Local'>idx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN233"><span class='Ref_To_Local'>dim</span></a> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN14"><span class='Ref_to_Macro'>ARRNELEMS</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN230"><span class='Ref_To_Local'>idx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cube.c.html#LN232"><span class='Ref_To_Local'>size</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN39"><span class='Ref_to_Macro'>IS_POINT</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN229"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="cubedata.h.html#LN47"><span class='Ref_to_Macro'>POINT_SIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN233"><span class='Ref_To_Local'>dim</span></a><span class='Parentheses'>) </span><span class='Operator'>: </span><a href="cubedata.h.html#LN48"><span class='Ref_to_Macro'>CUBE_SIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN233"><span class='Ref_To_Local'>dim</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cube.c.html#LN231"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN232"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN231"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN232"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cubedata.h.html#LN42"><span class='Ref_to_Macro'>SET_DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN231"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN233"><span class='Ref_To_Local'>dim</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN39"><span class='Ref_to_Macro'>IS_POINT</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN229"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>))</span> 
        <a href="cubedata.h.html#LN40"><span class='Ref_to_Macro'>SET_POINT_BIT</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN231"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN234"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cube.c.html#LN234"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cube.c.html#LN233"><span class='Ref_To_Local'>dim</span></a><span class='Delimiter'>; </span><a href="cube.c.html#LN234"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="cube.c.html#LN235"><span class='Ref_To_Local'>dx</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN234"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span> <span class='Operator'>|| </span><span class='Parentheses'>(</span><a href="cube.c.html#LN235"><span class='Ref_To_Local'>dx</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN234"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>&GT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN229"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>)))</span> 
            <a href="../../src/include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../src/include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../src/include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_ARRAY_ELEMENT_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../../src/backend/utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"Index out of bounds"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN231"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN234"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cube.c.html#LN229"><span class='Ref_To_Local'>c</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN235"><span class='Ref_To_Local'>dx</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN234"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="cubedata.h.html#LN39"><span class='Ref_to_Macro'>IS_POINT</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN229"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>))</span> 
            <a href="cube.c.html#LN231"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN234"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>+ </span><a href="cube.c.html#LN233"><span class='Ref_To_Local'>dim</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cube.c.html#LN229"><span class='Ref_To_Local'>c</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN235"><span class='Ref_To_Local'>dx</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN234"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>+ </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN229"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN229"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cubedata.h.html#LN53"><span class='Ref_to_Macro'>PG_RETURN_NDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN231"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end cube_subset &raquo; </span> 
 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN269"></a><span class='Declare_Function'>cube_out</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN271"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>cube</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN272"></a>    <a href="../../src/include/lib/stringinfo.h.html#LN34"><span class='Ref_to_Struct'>StringInfoData</span></a> <span class='Declare_Local'>buf</span><span class='Delimiter'>; 
</span><a name="LN273"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>dim</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN271"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN274"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/backend/lib/stringinfo.c.html#LN44"><span class='Ref_to_Func'>initStringInfo</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="cube.c.html#LN272"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/backend/replication/syncrep_scanner.l.html#LN76"><span class='Ref_to_Proto'>appendStringInfoChar</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="cube.c.html#LN272"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>'('</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN274"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cube.c.html#LN274"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cube.c.html#LN273"><span class='Ref_To_Local'>dim</span></a><span class='Delimiter'>; </span><a href="cube.c.html#LN274"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN274"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="../../src/bin/pg_waldump/compat.c.html#LN79"><span class='Ref_to_Func'>appendStringInfoString</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="cube.c.html#LN272"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>", "</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/bin/pg_waldump/compat.c.html#LN79"><span class='Ref_to_Func'>appendStringInfoString</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="cube.c.html#LN272"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="../../src/include/utils/builtins.h.html#LN62"><span class='Ref_to_Proto'>float8out_internal</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN271"><span class='Ref_To_Local'>cube</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN274"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="../../src/backend/replication/syncrep_scanner.l.html#LN76"><span class='Ref_to_Proto'>appendStringInfoChar</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="cube.c.html#LN272"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>')'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="cube.c.html#LN106"><span class='Ref_to_Proto'>cube_is_point_internal</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN271"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../src/bin/pg_waldump/compat.c.html#LN79"><span class='Ref_to_Func'>appendStringInfoString</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="cube.c.html#LN272"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>",("</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN274"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cube.c.html#LN274"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cube.c.html#LN273"><span class='Ref_To_Local'>dim</span></a><span class='Delimiter'>; </span><a href="cube.c.html#LN274"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN274"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                <a href="../../src/bin/pg_waldump/compat.c.html#LN79"><span class='Ref_to_Func'>appendStringInfoString</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="cube.c.html#LN272"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>", "</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../src/bin/pg_waldump/compat.c.html#LN79"><span class='Ref_to_Func'>appendStringInfoString</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="cube.c.html#LN272"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="../../src/include/utils/builtins.h.html#LN62"><span class='Ref_to_Proto'>float8out_internal</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN271"><span class='Ref_To_Local'>cube</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN274"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="../../src/backend/replication/syncrep_scanner.l.html#LN76"><span class='Ref_to_Proto'>appendStringInfoChar</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="cube.c.html#LN272"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>')'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN271"><span class='Ref_To_Local'>cube</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN321"><span class='Ref_to_Macro'>PG_RETURN_CSTRING</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN272"><span class='Ref_To_Local'>buf</span></a><span class='Operator'>.</span><a href="../../src/include/lib/stringinfo.h.html#LN36"><span class='Ref_to_Member'>data</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end cube_out &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/***************************************************************************** 
 *                         GiST functions 
 *****************************************************************************/ 
</span> 
<span class='Comment_Multi_Line'>/* 
** The GiST Consistent method for boxes 
** Should return false if for all data items x below entry, 
** the predicate x op query == FALSE, where op is the oper 
** corresponding to strategy in the pg_amop table. 
*/ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN315"></a><span class='Declare_Function'>g_cube_consistent</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN317"></a>    <a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>entry</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN318"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>query</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN319"></a>    <a href="../../src/include/access/stratnum.h.html#LN21"><span class='Ref_to_Typedef'>StrategyNumber</span></a> <span class='Declare_Local'>strategy</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/stratnum.h.html#LN21"><span class='Ref_to_Typedef'>StrategyNumber</span></a><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN236"><span class='Ref_to_Macro'>PG_GETARG_UINT16</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Oid      subtype = PG_GETARG_OID(3); */ 
</span><a name="LN322"></a>    <span class='Keyword'>bool</span>       <span class='Operator'>*</span><span class='Declare_Local'>recheck</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>4</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN323"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* All cases served by this function are exact */ 
</span>    <span class='Operator'>*</span><a href="cube.c.html#LN322"><span class='Ref_To_Local'>recheck</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * if entry is not leaf, use g_cube_internal_consistent, else use 
     * g_cube_leaf_consistent 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN132"><span class='Ref_to_Macro'>GIST_LEAF</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN317"><span class='Ref_To_Local'>entry</span></a><span class='Parentheses'>))</span> 
        <a href="cube.c.html#LN323"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN99"><span class='Ref_to_Proto'>g_cube_leaf_consistent</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN51"><span class='Ref_to_Macro'>DatumGetNDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN317"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                     <a href="cube.c.html#LN318"><span class='Ref_To_Local'>query</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN319"><span class='Ref_To_Local'>strategy</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="cube.c.html#LN323"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN100"><span class='Ref_to_Proto'>g_cube_internal_consistent</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN51"><span class='Ref_to_Macro'>DatumGetNDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN317"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                         <a href="cube.c.html#LN318"><span class='Ref_To_Local'>query</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN319"><span class='Ref_To_Local'>strategy</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN318"><span class='Ref_To_Local'>query</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN323"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end g_cube_consistent &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
** The GiST Union method for boxes 
** returns the minimal bounding box that encloses all the entries in entryvec 
*/ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN349"></a><span class='Declare_Function'>g_cube_union</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN351"></a>    <a href="../../src/include/access/gist.h.html#LN157"><span class='Ref_to_Typedef'>GistEntryVector</span></a> <span class='Operator'>*</span><span class='Declare_Local'>entryvec</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN157"><span class='Ref_to_Typedef'>GistEntryVector</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN352"></a>    <span class='Keyword'>int</span>        <span class='Operator'>*</span><span class='Declare_Local'>sizep</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN353"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>out</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN354"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>tmp</span><span class='Delimiter'>; 
</span><a name="LN355"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN354"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN51"><span class='Ref_to_Macro'>DatumGetNDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN351"><span class='Ref_To_Local'>entryvec</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN160"><span class='Ref_to_Member'>vector</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * sizep = sizeof(NDBOX); -- NDBOX has variable size 
     */ 
</span>    <span class='Operator'>*</span><a href="cube.c.html#LN352"><span class='Ref_To_Local'>sizep</span></a> <span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN354"><span class='Ref_To_Local'>tmp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN355"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; </span><a href="cube.c.html#LN355"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cube.c.html#LN351"><span class='Ref_To_Local'>entryvec</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN159"><span class='Ref_to_Member'>n</span></a><span class='Delimiter'>; </span><a href="cube.c.html#LN355"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="cube.c.html#LN353"><span class='Ref_To_Local'>out</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN98"><span class='Ref_to_Proto'>g_cube_binary_union</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN354"><span class='Ref_To_Local'>tmp</span></a><span class='Delimiter'>, 
</span>                                  <a href="cubedata.h.html#LN51"><span class='Ref_to_Macro'>DatumGetNDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN351"><span class='Ref_To_Local'>entryvec</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN160"><span class='Ref_to_Member'>vector</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN355"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                  <a href="cube.c.html#LN352"><span class='Ref_To_Local'>sizep</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN354"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN353"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN353"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end g_cube_union &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
** GiST Compress and Decompress methods for boxes 
** do not do anything. 
*/ 
</span> 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN381"></a><span class='Declare_Function'>g_cube_compress</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="../../src/include/fmgr.h.html#LN312"><span class='Ref_to_Macro'>PG_RETURN_DATUM</span></a><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN387"></a><span class='Declare_Function'>g_cube_decompress</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN389"></a>    <a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>entry</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN390"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>key</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN51"><span class='Ref_to_Macro'>DatumGetNDBOX</span></a><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN204"><span class='Ref_to_Macro'>PG_DETOAST_DATUM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN389"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN390"><span class='Ref_To_Local'>key</span></a> <span class='Operator'>!= </span><a href="cubedata.h.html#LN51"><span class='Ref_to_Macro'>DatumGetNDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN389"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN394"></a>        <a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>retval</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <a href="../../src/include/access/gist.h.html#LN168"><span class='Ref_to_Macro'>gistentryinit</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="cube.c.html#LN394"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN390"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                      <a href="cube.c.html#LN389"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN123"><span class='Ref_to_Member'>rel</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN389"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN124"><span class='Ref_to_Member'>page</span></a><span class='Delimiter'>, 
</span>                      <a href="cube.c.html#LN389"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN125"><span class='Ref_to_Member'>offset</span></a><span class='Delimiter'>, </span><span class='Boolean'>FALSE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN394"><span class='Ref_To_Local'>retval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN389"><span class='Ref_To_Local'>entry</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
** The GiST Penalty method for boxes 
** As in the R-tree paper, we use change in area as our penalty metric 
*/ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN410"></a><span class='Declare_Function'>g_cube_penalty</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN412"></a>    <a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>origentry</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN413"></a>    <a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>newentry</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN414"></a>    <span class='Keyword'>float</span>      <span class='Operator'>*</span><span class='Declare_Local'>result</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>float </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN415"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>ud</span><span class='Delimiter'>; 
</span><a name="LN416"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>tmp1</span><span class='Delimiter'>, 
</span><a name="LN417"></a>                <span class='Declare_Local'>tmp2</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN415"><span class='Ref_To_Local'>ud</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN96"><span class='Ref_to_Proto'>cube_union_v0</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN51"><span class='Ref_to_Macro'>DatumGetNDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN412"><span class='Ref_To_Local'>origentry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                       <a href="cubedata.h.html#LN51"><span class='Ref_to_Macro'>DatumGetNDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN413"><span class='Ref_To_Local'>newentry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="cube.c.html#LN97"><span class='Ref_to_Proto'>rt_cube_size</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN415"><span class='Ref_To_Local'>ud</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="cube.c.html#LN416"><span class='Ref_To_Local'>tmp1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cube.c.html#LN97"><span class='Ref_to_Proto'>rt_cube_size</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN51"><span class='Ref_to_Macro'>DatumGetNDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN412"><span class='Ref_To_Local'>origentry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="cube.c.html#LN417"><span class='Ref_To_Local'>tmp2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="cube.c.html#LN414"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>float</span><span class='Parentheses'>) (</span><a href="cube.c.html#LN416"><span class='Ref_To_Local'>tmp1</span></a> <span class='Operator'>- </span><a href="cube.c.html#LN417"><span class='Ref_To_Local'>tmp2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN325"><span class='Ref_to_Macro'>PG_RETURN_FLOAT8</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="cube.c.html#LN414"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
 
<span class='Comment_Multi_Line'>/* 
** The GiST PickSplit method for boxes 
** We use Guttman's poly time split algorithm 
*/ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN435"></a><span class='Declare_Function'>g_cube_picksplit</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN437"></a>    <a href="../../src/include/access/gist.h.html#LN157"><span class='Ref_to_Typedef'>GistEntryVector</span></a> <span class='Operator'>*</span><span class='Declare_Local'>entryvec</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN157"><span class='Ref_to_Typedef'>GistEntryVector</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN438"></a>    <a href="../../src/include/access/gist.h.html#LN102"><span class='Ref_to_Struct'>GIST_SPLITVEC</span></a> <span class='Operator'>*</span><span class='Declare_Local'>v</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN102"><span class='Ref_to_Struct'>GIST_SPLITVEC</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN439"></a>    <a href="../../src/include/storage/off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Declare_Local'>i</span><span class='Delimiter'>, 
</span><a name="LN440"></a>                <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span><a name="LN441"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>datum_alpha</span><span class='Delimiter'>, 
</span><a name="LN442"></a>               <span class='Operator'>*</span><span class='Declare_Local'>datum_beta</span><span class='Delimiter'>; 
</span><a name="LN443"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>datum_l</span><span class='Delimiter'>, 
</span><a name="LN444"></a>               <span class='Operator'>*</span><span class='Declare_Local'>datum_r</span><span class='Delimiter'>; 
</span><a name="LN445"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>union_d</span><span class='Delimiter'>, 
</span><a name="LN446"></a>               <span class='Operator'>*</span><span class='Declare_Local'>union_dl</span><span class='Delimiter'>, 
</span><a name="LN447"></a>               <span class='Operator'>*</span><span class='Declare_Local'>union_dr</span><span class='Delimiter'>; 
</span><a name="LN448"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>inter_d</span><span class='Delimiter'>; 
</span><a name="LN449"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>firsttime</span><span class='Delimiter'>; 
</span><a name="LN450"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>size_alpha</span><span class='Delimiter'>, 
</span><a name="LN451"></a>                <span class='Declare_Local'>size_beta</span><span class='Delimiter'>, 
</span><a name="LN452"></a>                <span class='Declare_Local'>size_union</span><span class='Delimiter'>, 
</span><a name="LN453"></a>                <span class='Declare_Local'>size_inter</span><span class='Delimiter'>; 
</span><a name="LN454"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>size_waste</span><span class='Delimiter'>, 
</span><a name="LN455"></a>                <span class='Declare_Local'>waste</span><span class='Delimiter'>; 
</span><a name="LN456"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>size_l</span><span class='Delimiter'>, 
</span><a name="LN457"></a>                <span class='Declare_Local'>size_r</span><span class='Delimiter'>; 
</span><a name="LN458"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>nbytes</span><span class='Delimiter'>; 
</span><a name="LN459"></a>    <a href="../../src/include/storage/off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Declare_Local'>seed_1</span> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>, 
</span><a name="LN460"></a>                <span class='Declare_Local'>seed_2</span> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span><a name="LN461"></a>    <a href="../../src/include/storage/off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Operator'>*</span><span class='Declare_Local'>left</span><span class='Delimiter'>, 
</span><a name="LN462"></a>               <span class='Operator'>*</span><span class='Declare_Local'>right</span><span class='Delimiter'>; 
</span><a name="LN463"></a>    <a href="../../src/include/storage/off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Declare_Local'>maxoff</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN463"><span class='Ref_To_Local'>maxoff</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN437"><span class='Ref_To_Local'>entryvec</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN159"><span class='Ref_to_Member'>n</span></a> <span class='Operator'>- </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <a href="cube.c.html#LN458"><span class='Ref_To_Local'>nbytes</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="cube.c.html#LN463"><span class='Ref_To_Local'>maxoff</span></a> <span class='Operator'>+ </span><span class='Number'>2</span><span class='Parentheses'>) </span><span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../src/include/storage/off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cube.c.html#LN438"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN104"><span class='Ref_to_Member'>spl_left</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/storage/off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN458"><span class='Ref_To_Local'>nbytes</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cube.c.html#LN438"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN109"><span class='Ref_to_Member'>spl_right</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/storage/off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN458"><span class='Ref_To_Local'>nbytes</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN449"><span class='Ref_To_Local'>firsttime</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <a href="cube.c.html#LN455"><span class='Ref_To_Local'>waste</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN439"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN26"><span class='Ref_to_Const'>FirstOffsetNumber</span></a><span class='Delimiter'>; </span><a href="cube.c.html#LN439"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cube.c.html#LN463"><span class='Ref_To_Local'>maxoff</span></a><span class='Delimiter'>; </span><a href="cube.c.html#LN439"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN52"><span class='Ref_to_Macro'>OffsetNumberNext</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN439"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="cube.c.html#LN441"><span class='Ref_To_Local'>datum_alpha</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN51"><span class='Ref_to_Macro'>DatumGetNDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN437"><span class='Ref_To_Local'>entryvec</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN160"><span class='Ref_to_Member'>vector</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN439"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN440"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN52"><span class='Ref_to_Macro'>OffsetNumberNext</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN439"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN440"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT;= </span><a href="cube.c.html#LN463"><span class='Ref_To_Local'>maxoff</span></a><span class='Delimiter'>; </span><a href="cube.c.html#LN440"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN52"><span class='Ref_to_Macro'>OffsetNumberNext</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN440"><span class='Ref_To_Local'>j</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="cube.c.html#LN442"><span class='Ref_To_Local'>datum_beta</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN51"><span class='Ref_to_Macro'>DatumGetNDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN437"><span class='Ref_To_Local'>entryvec</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN160"><span class='Ref_to_Member'>vector</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN440"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* compute the wasted space by unioning these guys */ 
</span>            <span class='Comment_Multi_Line'>/* size_waste = size_union - size_inter; */ 
</span>            <a href="cube.c.html#LN445"><span class='Ref_To_Local'>union_d</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN96"><span class='Ref_to_Proto'>cube_union_v0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN441"><span class='Ref_To_Local'>datum_alpha</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN442"><span class='Ref_To_Local'>datum_beta</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="cube.c.html#LN97"><span class='Ref_to_Proto'>rt_cube_size</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN445"><span class='Ref_To_Local'>union_d</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="cube.c.html#LN452"><span class='Ref_To_Local'>size_union</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="cube.c.html#LN448"><span class='Ref_To_Local'>inter_d</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN51"><span class='Ref_to_Macro'>DatumGetNDBOX</span></a><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN585"><span class='Ref_to_Macro'>DirectFunctionCall2</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN749"><span class='Ref_to_Func'>cube_inter</span></a><span class='Delimiter'>, 
</span>                          <a href="cube.c.html#LN437"><span class='Ref_To_Local'>entryvec</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN160"><span class='Ref_to_Member'>vector</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN439"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN437"><span class='Ref_To_Local'>entryvec</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN160"><span class='Ref_to_Member'>vector</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN440"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="cube.c.html#LN97"><span class='Ref_to_Proto'>rt_cube_size</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN448"><span class='Ref_To_Local'>inter_d</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="cube.c.html#LN453"><span class='Ref_To_Local'>size_inter</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="cube.c.html#LN454"><span class='Ref_To_Local'>size_waste</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN452"><span class='Ref_To_Local'>size_union</span></a> <span class='Operator'>- </span><a href="cube.c.html#LN453"><span class='Ref_To_Local'>size_inter</span></a><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * are these a more promising split than what we've already seen? 
             */ 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN454"><span class='Ref_To_Local'>size_waste</span></a> <span class='Operator'>&GT; </span><a href="cube.c.html#LN455"><span class='Ref_To_Local'>waste</span></a> <span class='Operator'>|| </span><a href="cube.c.html#LN449"><span class='Ref_To_Local'>firsttime</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="cube.c.html#LN455"><span class='Ref_To_Local'>waste</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN454"><span class='Ref_To_Local'>size_waste</span></a><span class='Delimiter'>; 
</span>                <a href="cube.c.html#LN459"><span class='Ref_To_Local'>seed_1</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN439"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>                <a href="cube.c.html#LN460"><span class='Ref_To_Local'>seed_2</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN440"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>; 
</span>                <a href="cube.c.html#LN449"><span class='Ref_To_Local'>firsttime</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for j=OffsetNumberNext(i)... &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=FirstOffsetNumber;i... &raquo; </span> 
 
    <a href="cube.c.html#LN461"><span class='Ref_To_Local'>left</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN438"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN104"><span class='Ref_to_Member'>spl_left</span></a><span class='Delimiter'>; 
</span>    <a href="cube.c.html#LN438"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN105"><span class='Ref_to_Member'>spl_nleft</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="cube.c.html#LN462"><span class='Ref_To_Local'>right</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN438"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN109"><span class='Ref_to_Member'>spl_right</span></a><span class='Delimiter'>; 
</span>    <a href="cube.c.html#LN438"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN110"><span class='Ref_to_Member'>spl_nright</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN441"><span class='Ref_To_Local'>datum_alpha</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN51"><span class='Ref_to_Macro'>DatumGetNDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN437"><span class='Ref_To_Local'>entryvec</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN160"><span class='Ref_to_Member'>vector</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN459"><span class='Ref_To_Local'>seed_1</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cube.c.html#LN443"><span class='Ref_To_Local'>datum_l</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN96"><span class='Ref_to_Proto'>cube_union_v0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN441"><span class='Ref_To_Local'>datum_alpha</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN441"><span class='Ref_To_Local'>datum_alpha</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cube.c.html#LN97"><span class='Ref_to_Proto'>rt_cube_size</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN443"><span class='Ref_To_Local'>datum_l</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="cube.c.html#LN456"><span class='Ref_To_Local'>size_l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cube.c.html#LN442"><span class='Ref_To_Local'>datum_beta</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN51"><span class='Ref_to_Macro'>DatumGetNDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN437"><span class='Ref_To_Local'>entryvec</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN160"><span class='Ref_to_Member'>vector</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN460"><span class='Ref_To_Local'>seed_2</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cube.c.html#LN444"><span class='Ref_To_Local'>datum_r</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN96"><span class='Ref_to_Proto'>cube_union_v0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN442"><span class='Ref_To_Local'>datum_beta</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN442"><span class='Ref_To_Local'>datum_beta</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cube.c.html#LN97"><span class='Ref_to_Proto'>rt_cube_size</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN444"><span class='Ref_To_Local'>datum_r</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="cube.c.html#LN457"><span class='Ref_To_Local'>size_r</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Now split up the regions between the two seeds.  An important property 
     * of this split algorithm is that the split vector v has the indices of 
     * items to be split in order in its left and right vectors.  We exploit 
     * this property by doing a merge in the code that actually splits the 
     * page. 
     * 
     * For efficiency, we also place the new index tuple in this loop. This is 
     * handled at the very end, when we have placed all the existing tuples 
     * and i == maxoff + 1. 
     */ 
</span> 
    <a href="cube.c.html#LN463"><span class='Ref_To_Local'>maxoff</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN52"><span class='Ref_to_Macro'>OffsetNumberNext</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN463"><span class='Ref_To_Local'>maxoff</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN439"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN26"><span class='Ref_to_Const'>FirstOffsetNumber</span></a><span class='Delimiter'>; </span><a href="cube.c.html#LN439"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT;= </span><a href="cube.c.html#LN463"><span class='Ref_To_Local'>maxoff</span></a><span class='Delimiter'>; </span><a href="cube.c.html#LN439"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN52"><span class='Ref_to_Macro'>OffsetNumberNext</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN439"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * If we've already decided where to place this item, just put it on 
         * the right list.  Otherwise, we need to figure out which page needs 
         * the least enlargement in order to store the item. 
         */ 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN439"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>== </span><a href="cube.c.html#LN459"><span class='Ref_To_Local'>seed_1</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="cube.c.html#LN461"><span class='Ref_To_Local'>left</span></a><span class='Operator'>++ = </span><a href="cube.c.html#LN439"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>            <a href="cube.c.html#LN438"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN105"><span class='Ref_to_Member'>spl_nleft</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN439"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>== </span><a href="cube.c.html#LN460"><span class='Ref_To_Local'>seed_2</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="cube.c.html#LN462"><span class='Ref_To_Local'>right</span></a><span class='Operator'>++ = </span><a href="cube.c.html#LN439"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>            <a href="cube.c.html#LN438"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN110"><span class='Ref_to_Member'>spl_nright</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* okay, which page needs least enlargement? */ 
</span>        <a href="cube.c.html#LN441"><span class='Ref_To_Local'>datum_alpha</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN51"><span class='Ref_to_Macro'>DatumGetNDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN437"><span class='Ref_To_Local'>entryvec</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN160"><span class='Ref_to_Member'>vector</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN439"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN446"><span class='Ref_To_Local'>union_dl</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN96"><span class='Ref_to_Proto'>cube_union_v0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN443"><span class='Ref_To_Local'>datum_l</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN441"><span class='Ref_To_Local'>datum_alpha</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN447"><span class='Ref_To_Local'>union_dr</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN96"><span class='Ref_to_Proto'>cube_union_v0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN444"><span class='Ref_To_Local'>datum_r</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN441"><span class='Ref_To_Local'>datum_alpha</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN97"><span class='Ref_to_Proto'>rt_cube_size</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN446"><span class='Ref_To_Local'>union_dl</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="cube.c.html#LN450"><span class='Ref_To_Local'>size_alpha</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN97"><span class='Ref_to_Proto'>rt_cube_size</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN447"><span class='Ref_To_Local'>union_dr</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="cube.c.html#LN451"><span class='Ref_To_Local'>size_beta</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* pick which page to add it to */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN450"><span class='Ref_To_Local'>size_alpha</span></a> <span class='Operator'>- </span><a href="cube.c.html#LN456"><span class='Ref_To_Local'>size_l</span></a> <span class='Operator'>&LT; </span><a href="cube.c.html#LN451"><span class='Ref_To_Local'>size_beta</span></a> <span class='Operator'>- </span><a href="cube.c.html#LN457"><span class='Ref_To_Local'>size_r</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="cube.c.html#LN443"><span class='Ref_To_Local'>datum_l</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN446"><span class='Ref_To_Local'>union_dl</span></a><span class='Delimiter'>; 
</span>            <a href="cube.c.html#LN456"><span class='Ref_To_Local'>size_l</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN450"><span class='Ref_To_Local'>size_alpha</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="cube.c.html#LN461"><span class='Ref_To_Local'>left</span></a><span class='Operator'>++ = </span><a href="cube.c.html#LN439"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>            <a href="cube.c.html#LN438"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN105"><span class='Ref_to_Member'>spl_nleft</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="cube.c.html#LN444"><span class='Ref_To_Local'>datum_r</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN447"><span class='Ref_To_Local'>union_dr</span></a><span class='Delimiter'>; 
</span>            <a href="cube.c.html#LN457"><span class='Ref_To_Local'>size_r</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN451"><span class='Ref_To_Local'>size_beta</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="cube.c.html#LN462"><span class='Ref_To_Local'>right</span></a><span class='Operator'>++ = </span><a href="cube.c.html#LN439"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>            <a href="cube.c.html#LN438"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN110"><span class='Ref_to_Member'>spl_nright</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=FirstOffsetNumber;i... &raquo; </span> 
    <span class='Operator'>*</span><a href="cube.c.html#LN461"><span class='Ref_To_Local'>left</span></a> <span class='Operator'>= *</span><a href="cube.c.html#LN462"><span class='Ref_To_Local'>right</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN26"><span class='Ref_to_Const'>FirstOffsetNumber</span></a><span class='Delimiter'>; </span><span class='Comment_Single_Line'>/* sentinel value, see dosplit() */ 
</span> 
    <a href="cube.c.html#LN438"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN106"><span class='Ref_to_Member'>spl_ldatum</span></a> <span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN443"><span class='Ref_To_Local'>datum_l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cube.c.html#LN438"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN111"><span class='Ref_to_Member'>spl_rdatum</span></a> <span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN444"><span class='Ref_To_Local'>datum_r</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN438"><span class='Ref_To_Local'>v</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end g_cube_picksplit &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
** Equality method 
*/ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN584"></a><span class='Declare_Function'>g_cube_same</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN586"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>b1</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN587"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>b2</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN588"></a>    <span class='Keyword'>bool</span>       <span class='Operator'>*</span><span class='Declare_Local'>result</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN93"><span class='Ref_to_Proto'>cube_cmp_v0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN586"><span class='Ref_To_Local'>b1</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN587"><span class='Ref_To_Local'>b2</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Operator'>*</span><a href="cube.c.html#LN588"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Boolean'>TRUE</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Operator'>*</span><a href="cube.c.html#LN588"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Boolean'>FALSE</span><span class='Delimiter'>; 
</span> 
    <a href="cubedata.h.html#LN53"><span class='Ref_to_Macro'>PG_RETURN_NDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN588"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
** SUPPORT ROUTINES 
*/ 
</span><span class='Keyword'>bool 
</span><a name="LN602"></a><span class='Declare_Function'>g_cube_leaf_consistent</span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>key</span><span class='Delimiter'>, 
</span><a name="LN603"></a>                       <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>query</span><span class='Delimiter'>, 
</span><a name="LN604"></a>                       <a href="../../src/include/access/stratnum.h.html#LN21"><span class='Ref_to_Typedef'>StrategyNumber</span></a> <span class='Declare_Parameter'>strategy</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN606"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>retval</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN604"><span class='Ref_to_Parameter'>strategy</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../src/include/access/stratnum.h.html#LN45"><span class='Ref_to_Const'>RTOverlapStrategyNumber</span></a><span class='Operator'>: 
</span>            <a href="cube.c.html#LN606"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>bool</span><span class='Parentheses'>) </span><a href="cube.c.html#LN95"><span class='Ref_to_Proto'>cube_overlap_v0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN602"><span class='Ref_to_Parameter'>key</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN603"><span class='Ref_to_Parameter'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../src/include/access/stratnum.h.html#LN48"><span class='Ref_to_Const'>RTSameStrategyNumber</span></a><span class='Operator'>: 
</span>            <a href="cube.c.html#LN606"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>bool</span><span class='Parentheses'>) (</span><a href="cube.c.html#LN93"><span class='Ref_to_Proto'>cube_cmp_v0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN602"><span class='Ref_to_Parameter'>key</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN603"><span class='Ref_to_Parameter'>query</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../src/include/access/stratnum.h.html#LN49"><span class='Ref_to_Const'>RTContainsStrategyNumber</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../src/include/access/stratnum.h.html#LN55"><span class='Ref_to_Const'>RTOldContainsStrategyNumber</span></a><span class='Operator'>: 
</span>            <a href="cube.c.html#LN606"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>bool</span><span class='Parentheses'>) </span><a href="cube.c.html#LN94"><span class='Ref_to_Proto'>cube_contains_v0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN602"><span class='Ref_to_Parameter'>key</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN603"><span class='Ref_to_Parameter'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../src/include/access/stratnum.h.html#LN50"><span class='Ref_to_Const'>RTContainedByStrategyNumber</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../src/include/access/stratnum.h.html#LN56"><span class='Ref_to_Const'>RTOldContainedByStrategyNumber</span></a><span class='Operator'>: 
</span>            <a href="cube.c.html#LN606"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>bool</span><span class='Parentheses'>) </span><a href="cube.c.html#LN94"><span class='Ref_to_Proto'>cube_contains_v0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN603"><span class='Ref_to_Parameter'>query</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN602"><span class='Ref_to_Parameter'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="cube.c.html#LN606"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><span class='Boolean'>FALSE</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN606"><span class='Ref_To_Local'>retval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end g_cube_leaf_consistent &raquo; </span> 
 
<span class='Keyword'>bool 
</span><a name="LN631"></a><span class='Declare_Function'>g_cube_internal_consistent</span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>key</span><span class='Delimiter'>, 
</span><a name="LN632"></a>                           <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>query</span><span class='Delimiter'>, 
</span><a name="LN633"></a>                           <a href="../../src/include/access/stratnum.h.html#LN21"><span class='Ref_to_Typedef'>StrategyNumber</span></a> <span class='Declare_Parameter'>strategy</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN635"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>retval</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN633"><span class='Ref_to_Parameter'>strategy</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../src/include/access/stratnum.h.html#LN45"><span class='Ref_to_Const'>RTOverlapStrategyNumber</span></a><span class='Operator'>: 
</span>            <a href="cube.c.html#LN635"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>bool</span><span class='Parentheses'>) </span><a href="cube.c.html#LN95"><span class='Ref_to_Proto'>cube_overlap_v0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN631"><span class='Ref_to_Parameter'>key</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN632"><span class='Ref_to_Parameter'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../src/include/access/stratnum.h.html#LN48"><span class='Ref_to_Const'>RTSameStrategyNumber</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../src/include/access/stratnum.h.html#LN49"><span class='Ref_to_Const'>RTContainsStrategyNumber</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../src/include/access/stratnum.h.html#LN55"><span class='Ref_to_Const'>RTOldContainsStrategyNumber</span></a><span class='Operator'>: 
</span>            <a href="cube.c.html#LN635"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>bool</span><span class='Parentheses'>) </span><a href="cube.c.html#LN94"><span class='Ref_to_Proto'>cube_contains_v0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN631"><span class='Ref_to_Parameter'>key</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN632"><span class='Ref_to_Parameter'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../src/include/access/stratnum.h.html#LN50"><span class='Ref_to_Const'>RTContainedByStrategyNumber</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../src/include/access/stratnum.h.html#LN56"><span class='Ref_to_Const'>RTOldContainedByStrategyNumber</span></a><span class='Operator'>: 
</span>            <a href="cube.c.html#LN635"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>bool</span><span class='Parentheses'>) </span><a href="cube.c.html#LN95"><span class='Ref_to_Proto'>cube_overlap_v0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN631"><span class='Ref_to_Parameter'>key</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN632"><span class='Ref_to_Parameter'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="cube.c.html#LN635"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><span class='Boolean'>FALSE</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN635"><span class='Ref_To_Local'>retval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end g_cube_internal_consistent &raquo; </span> 
 
<a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>* 
</span><a name="LN658"></a><span class='Declare_Function'>g_cube_binary_union</span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>r1</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>r2</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>sizep</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN660"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>retval</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN660"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN96"><span class='Ref_to_Proto'>cube_union_v0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN658"><span class='Ref_to_Parameter'>r1</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN658"><span class='Ref_to_Parameter'>r2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="cube.c.html#LN658"><span class='Ref_to_Parameter'>sizep</span></a> <span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN660"><span class='Ref_To_Local'>retval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN660"><span class='Ref_To_Local'>retval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* cube_union_v0 */ 
</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>* 
</span><a name="LN671"></a><span class='Declare_Function'>cube_union_v0</span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>b</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN673"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN674"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN675"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>dim</span><span class='Delimiter'>; 
</span><a name="LN676"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>size</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* trivial case */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN671"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>== </span><a href="cube.c.html#LN671"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="cube.c.html#LN671"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* swap the arguments if needed, so that 'a' is always larger than 'b' */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN671"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN671"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN685"></a>        <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>tmp</span> <span class='Operator'>= </span><a href="cube.c.html#LN671"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>; 
</span> 
        <a href="cube.c.html#LN671"><span class='Ref_to_Parameter'>b</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN671"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN671"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN685"><span class='Ref_To_Local'>tmp</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="cube.c.html#LN675"><span class='Ref_To_Local'>dim</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN671"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN676"><span class='Ref_To_Local'>size</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN48"><span class='Ref_to_Macro'>CUBE_SIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN675"><span class='Ref_To_Local'>dim</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cube.c.html#LN674"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../src/include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN676"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN674"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN676"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cubedata.h.html#LN42"><span class='Ref_to_Macro'>SET_DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN674"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN675"><span class='Ref_To_Local'>dim</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* First compute the union of the dimensions present in both args */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN673"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cube.c.html#LN673"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN671"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN673"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="cube.c.html#LN674"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN673"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span> 
                           <a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN671"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN673"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN671"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN673"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, 
</span>                           <a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN671"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN673"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN671"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN673"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> 
            <span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN674"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN673"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>+ </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN671"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span> 
                                    <a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN671"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN673"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN671"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN673"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, 
</span>                                    <a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN671"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN673"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN671"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN673"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> 
            <span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* continue on the higher dimensions only present in 'a' */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>; </span><a href="cube.c.html#LN673"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN671"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN673"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="cube.c.html#LN674"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN673"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Delimiter'>, 
</span>                           <a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN671"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN673"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN671"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN673"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> 
            <span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN674"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN673"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>+ </span><a href="cube.c.html#LN675"><span class='Ref_To_Local'>dim</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Delimiter'>, 
</span>                                 <a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN671"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN673"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN671"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN673"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> 
            <span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Check if the result was in fact a point, and set the flag in the datum 
     * accordingly. (we don't bother to repalloc it smaller) 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN106"><span class='Ref_to_Proto'>cube_is_point_internal</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN674"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="cube.c.html#LN676"><span class='Ref_To_Local'>size</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN47"><span class='Ref_to_Macro'>POINT_SIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN675"><span class='Ref_To_Local'>dim</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN674"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN676"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cubedata.h.html#LN40"><span class='Ref_to_Macro'>SET_POINT_BIT</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN674"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN674"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end cube_union_v0 &raquo; </span> 
 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN735"></a><span class='Declare_Function'>cube_union</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN737"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>a</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN738"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>b</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN739"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN739"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN96"><span class='Ref_to_Proto'>cube_union_v0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN737"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN738"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN737"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN738"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cubedata.h.html#LN53"><span class='Ref_to_Macro'>PG_RETURN_NDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN739"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* cube_inter */ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN750"></a><span class='Declare_Function'>cube_inter</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN752"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>a</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN753"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>b</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN754"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN755"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>swapped</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN756"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN757"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>dim</span><span class='Delimiter'>; 
</span><a name="LN758"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>size</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* swap the arguments if needed, so that 'a' is always larger than 'b' */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN752"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN753"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN763"></a>        <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>tmp</span> <span class='Operator'>= </span><a href="cube.c.html#LN753"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>; 
</span> 
        <a href="cube.c.html#LN753"><span class='Ref_To_Local'>b</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN752"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN752"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN763"><span class='Ref_To_Local'>tmp</span></a><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN755"><span class='Ref_To_Local'>swapped</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="cube.c.html#LN757"><span class='Ref_To_Local'>dim</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN752"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN758"><span class='Ref_To_Local'>size</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN48"><span class='Ref_to_Macro'>CUBE_SIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN757"><span class='Ref_To_Local'>dim</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cube.c.html#LN754"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN758"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN754"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN758"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cubedata.h.html#LN42"><span class='Ref_to_Macro'>SET_DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN754"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN757"><span class='Ref_To_Local'>dim</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* First compute intersection of the dimensions present in both args */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN756"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cube.c.html#LN756"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN753"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN756"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="cube.c.html#LN754"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN756"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span> 
                           <a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN752"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN756"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN752"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN756"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, 
</span>                           <a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN753"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN756"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN753"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN756"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> 
            <span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN754"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN756"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>+ </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN752"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span> 
                                    <a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN752"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN756"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN752"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN756"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, 
</span>                                    <a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN753"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN756"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN753"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN756"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> 
            <span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* continue on the higher dimensions only present in 'a' */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>; </span><a href="cube.c.html#LN756"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN752"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN756"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="cube.c.html#LN754"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN756"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Delimiter'>, 
</span>                           <a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN752"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN756"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN752"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN756"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> 
            <span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN754"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN756"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>+ </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN752"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Delimiter'>, 
</span>                                    <a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN752"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN756"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN752"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN756"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> 
            <span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Check if the result was in fact a point, and set the flag in the datum 
     * accordingly. (we don't bother to repalloc it smaller) 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN106"><span class='Ref_to_Proto'>cube_is_point_internal</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN754"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="cube.c.html#LN758"><span class='Ref_To_Local'>size</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN47"><span class='Ref_to_Macro'>POINT_SIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN757"><span class='Ref_To_Local'>dim</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN754"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../src/include/common/fe_memutils.h.html#LN36"><span class='Ref_to_Proto'>repalloc</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN754"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN758"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN754"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN758"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cubedata.h.html#LN40"><span class='Ref_to_Macro'>SET_POINT_BIT</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN754"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN755"><span class='Ref_To_Local'>swapped</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN753"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN752"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN752"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN753"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Is it OK to return a non-null intersection for non-overlapping boxes? 
     */ 
</span>    <a href="cubedata.h.html#LN53"><span class='Ref_to_Macro'>PG_RETURN_NDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN754"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end cube_inter &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* cube_size */ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN830"></a><span class='Declare_Function'>cube_size</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN832"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>a</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN833"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN97"><span class='Ref_to_Proto'>rt_cube_size</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN832"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="cube.c.html#LN833"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN832"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN325"><span class='Ref_to_Macro'>PG_RETURN_FLOAT8</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN833"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>void 
</span><a name="LN841"></a><span class='Declare_Function'>rt_cube_size</span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><span class='Keyword'>double </span><span class='Operator'>*</span><span class='Declare_Parameter'>size</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN843"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN844"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN841"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>== </span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* special case for GiST */ 
</span>        <a href="cube.c.html#LN843"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN39"><span class='Ref_to_Macro'>IS_POINT</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN841"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>|| </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN841"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* necessarily has zero size */ 
</span>        <a href="cube.c.html#LN843"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="cube.c.html#LN843"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN844"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cube.c.html#LN844"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN841"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN844"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
            <a href="cube.c.html#LN843"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>*= </span><a href="../../src/include/c.h.html#LN811"><span class='Ref_to_Macro'>Abs</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN841"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN844"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN841"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN844"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Operator'>*</span><a href="cube.c.html#LN841"><span class='Ref_to_Parameter'>size</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN843"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end rt_cube_size &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* make up a metric in which one box will be 'lower' than the other 
   -- this can be useful for sorting and to determine uniqueness */ 
</span><a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> 
<a name="LN868"></a><span class='Declare_Function'>cube_cmp_v0</span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>b</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN870"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN871"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>dim</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN871"><span class='Ref_To_Local'>dim</span></a> <span class='Operator'>= </span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* compare the common dimensions */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cube.c.html#LN871"><span class='Ref_To_Local'>dim</span></a><span class='Delimiter'>; </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> <span class='Operator'>&GT; 
</span>            <a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)))</span> 
            <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> <span class='Operator'>&LT; 
</span>            <a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)))</span> 
            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cube.c.html#LN871"><span class='Ref_To_Local'>dim</span></a><span class='Delimiter'>; </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> <span class='Operator'>&GT; 
</span>            <a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)))</span> 
            <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> <span class='Operator'>&LT; 
</span>            <a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)))</span> 
            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* compare extra dimensions to zero */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN871"><span class='Ref_To_Local'>dim</span></a><span class='Delimiter'>; </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN871"><span class='Ref_To_Local'>dim</span></a><span class='Delimiter'>; </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * if all common dimensions are equal, the cube with more dimensions 
         * wins 
         */ 
</span>        <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if DIM(a)&GT;DIM(b) &raquo; </span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN871"><span class='Ref_To_Local'>dim</span></a><span class='Delimiter'>; </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN871"><span class='Ref_To_Local'>dim</span></a><span class='Delimiter'>; </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN868"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN870"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * if all common dimensions are equal, the cube with more dimensions 
         * wins 
         */ 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if DIM(a)&LT;DIM(b) &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* They're really equal */ 
</span>    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end cube_cmp_v0 &raquo; </span> 
 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN948"></a><span class='Declare_Function'>cube_cmp</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN950"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>a</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span><a name="LN951"></a>               <span class='Operator'>*</span><span class='Declare_Local'>b</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN952"></a>    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN952"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN93"><span class='Ref_to_Proto'>cube_cmp_v0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN950"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN951"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN950"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN951"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN952"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN963"></a><span class='Declare_Function'>cube_eq</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN965"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>a</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span><a name="LN966"></a>               <span class='Operator'>*</span><span class='Declare_Local'>b</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN967"></a>    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN967"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN93"><span class='Ref_to_Proto'>cube_cmp_v0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN965"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN966"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN965"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN966"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN967"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN978"></a><span class='Declare_Function'>cube_ne</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN980"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>a</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span><a name="LN981"></a>               <span class='Operator'>*</span><span class='Declare_Local'>b</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN982"></a>    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN982"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN93"><span class='Ref_to_Proto'>cube_cmp_v0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN980"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN981"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN980"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN981"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN982"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN993"></a><span class='Declare_Function'>cube_lt</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN995"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>a</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span><a name="LN996"></a>               <span class='Operator'>*</span><span class='Declare_Local'>b</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN997"></a>    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN997"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN93"><span class='Ref_to_Proto'>cube_cmp_v0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN995"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN996"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN995"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN996"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN997"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1008"></a><span class='Declare_Function'>cube_gt</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1010"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>a</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span><a name="LN1011"></a>               <span class='Operator'>*</span><span class='Declare_Local'>b</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1012"></a>    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN1012"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN93"><span class='Ref_to_Proto'>cube_cmp_v0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1010"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1011"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1010"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1011"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1012"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1023"></a><span class='Declare_Function'>cube_le</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1025"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>a</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span><a name="LN1026"></a>               <span class='Operator'>*</span><span class='Declare_Local'>b</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1027"></a>    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN1027"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN93"><span class='Ref_to_Proto'>cube_cmp_v0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1025"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1026"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1025"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1026"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1027"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1038"></a><span class='Declare_Function'>cube_ge</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1040"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>a</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span><a name="LN1041"></a>               <span class='Operator'>*</span><span class='Declare_Local'>b</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1042"></a>    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN1042"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN93"><span class='Ref_to_Proto'>cube_cmp_v0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1040"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1041"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1040"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1041"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1042"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* Contains */ 
/* Box(A) CONTAINS Box(B) IFF pt(A) &LT; pt(B) */ 
</span><span class='Keyword'>bool 
</span><a name="LN1055"></a><span class='Declare_Function'>cube_contains_v0</span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>b</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1057"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="cube.c.html#LN1055"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) </span><span class='Operator'>|| </span><span class='Parentheses'>(</span><a href="cube.c.html#LN1055"><span class='Ref_to_Parameter'>b</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Boolean'>FALSE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1055"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1055"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * the further comparisons will make sense if the excess dimensions of 
         * (b) were zeroes Since both UL and UR coordinates must be zero, we 
         * can check them all without worrying about which is which. 
         */ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1057"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1055"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1057"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1055"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1057"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1055"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1057"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Boolean'>FALSE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1055"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1057"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Boolean'>FALSE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Can't care less about the excess dimensions of (a), if any */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1057"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1057"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1055"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1055"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1057"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1055"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1057"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1055"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1057"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> <span class='Operator'>&GT; 
</span>            <a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1055"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1057"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1055"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1057"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)))</span> 
            <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Boolean'>FALSE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1055"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1057"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1055"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1057"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> <span class='Operator'>&LT; 
</span>            <a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1055"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1057"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1055"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1057"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)))</span> 
            <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Boolean'>FALSE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Boolean'>TRUE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end cube_contains_v0 &raquo; </span> 
 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1093"></a><span class='Declare_Function'>cube_contains</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1095"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>a</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span><a name="LN1096"></a>               <span class='Operator'>*</span><span class='Declare_Local'>b</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1097"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN1097"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN94"><span class='Ref_to_Proto'>cube_contains_v0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1095"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1096"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1095"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1096"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1097"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* Contained */ 
/* Box(A) Contained by Box(B) IFF Box(B) Contains Box(A) */ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1109"></a><span class='Declare_Function'>cube_contained</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1111"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>a</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span><a name="LN1112"></a>               <span class='Operator'>*</span><span class='Declare_Local'>b</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1113"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN1113"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN94"><span class='Ref_to_Proto'>cube_contains_v0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1112"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1111"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1111"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1112"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1113"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* Overlap */ 
/* Box(A) Overlap Box(B) IFF (pt(a)LL &LT; pt(B)UR) && (pt(b)LL &LT; pt(a)UR) */ 
</span><span class='Keyword'>bool 
</span><a name="LN1125"></a><span class='Declare_Function'>cube_overlap_v0</span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>b</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1127"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="cube.c.html#LN1125"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) </span><span class='Operator'>|| </span><span class='Parentheses'>(</span><a href="cube.c.html#LN1125"><span class='Ref_to_Parameter'>b</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Boolean'>FALSE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* swap the box pointers if needed */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1125"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1125"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1135"></a>        <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>tmp</span> <span class='Operator'>= </span><a href="cube.c.html#LN1125"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>; 
</span> 
        <a href="cube.c.html#LN1125"><span class='Ref_to_Parameter'>b</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN1125"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN1125"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN1135"><span class='Ref_To_Local'>tmp</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* compare within the dimensions of (b) */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1127"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1127"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1125"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1127"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1125"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1127"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1125"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1127"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> <span class='Operator'>&GT; </span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1125"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1127"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1125"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1127"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)))</span> 
            <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Boolean'>FALSE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1125"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1127"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1125"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1127"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> <span class='Operator'>&LT; </span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1125"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1127"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1125"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1127"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)))</span> 
            <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Boolean'>FALSE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* compare to zero those dimensions in (a) absent in (b) */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1127"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1125"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1127"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1125"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1127"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1125"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1127"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1125"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1127"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Boolean'>FALSE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1125"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1127"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1125"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1127"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Boolean'>FALSE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Boolean'>TRUE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end cube_overlap_v0 &raquo; </span> 
 
 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1164"></a><span class='Declare_Function'>cube_overlap</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1166"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>a</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span><a name="LN1167"></a>               <span class='Operator'>*</span><span class='Declare_Local'>b</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1168"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN1168"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN95"><span class='Ref_to_Proto'>cube_overlap_v0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1166"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1167"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1166"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1167"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1168"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* Distance */ 
/* The distance is computed as a per axis sum of the squared distances 
   between 1D projections of the boxes onto Cartesian axes. Assuming zero 
   distance between overlapping projections, this metric coincides with the 
   "common sense" geometric distance */ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1184"></a><span class='Declare_Function'>cube_distance</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1186"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>a</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span><a name="LN1187"></a>               <span class='Operator'>*</span><span class='Declare_Local'>b</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1188"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>swapped</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN1189"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>d</span><span class='Delimiter'>, 
</span><a name="LN1190"></a>                <span class='Declare_Local'>distance</span><span class='Delimiter'>; 
</span><a name="LN1191"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* swap the box pointers if needed */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1186"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1187"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1196"></a>        <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>tmp</span> <span class='Operator'>= </span><a href="cube.c.html#LN1187"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>; 
</span> 
        <a href="cube.c.html#LN1187"><span class='Ref_To_Local'>b</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN1186"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN1186"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN1196"><span class='Ref_To_Local'>tmp</span></a><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN1188"><span class='Ref_To_Local'>swapped</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="cube.c.html#LN1190"><span class='Ref_To_Local'>distance</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* compute within the dimensions of (b) */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1191"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1191"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1187"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1191"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="cube.c.html#LN1189"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN105"><span class='Ref_to_Proto'>distance_1D</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1186"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1191"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1186"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1191"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1187"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1191"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1187"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1191"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN1190"><span class='Ref_To_Local'>distance</span></a> <span class='Operator'>+= </span><a href="cube.c.html#LN1189"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>* </span><a href="cube.c.html#LN1189"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* compute distance to zero for those dimensions in (a) absent in (b) */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1191"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1187"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1191"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1186"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1191"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="cube.c.html#LN1189"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN105"><span class='Ref_to_Proto'>distance_1D</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1186"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1191"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1186"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1191"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN1190"><span class='Ref_To_Local'>distance</span></a> <span class='Operator'>+= </span><a href="cube.c.html#LN1189"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>* </span><a href="cube.c.html#LN1189"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1188"><span class='Ref_To_Local'>swapped</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1187"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1186"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1186"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1187"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../src/include/fmgr.h.html#LN325"><span class='Ref_to_Macro'>PG_RETURN_FLOAT8</span></a><span class='Parentheses'>(</span>sqrt<span class='Parentheses'>(</span><a href="cube.c.html#LN1190"><span class='Ref_To_Local'>distance</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end cube_distance &raquo; </span> 
 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1233"></a><span class='Declare_Function'>distance_taxicab</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1235"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>a</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span><a name="LN1236"></a>               <span class='Operator'>*</span><span class='Declare_Local'>b</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1237"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>swapped</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN1238"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>distance</span><span class='Delimiter'>; 
</span><a name="LN1239"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* swap the box pointers if needed */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1235"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1236"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1244"></a>        <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>tmp</span> <span class='Operator'>= </span><a href="cube.c.html#LN1236"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>; 
</span> 
        <a href="cube.c.html#LN1236"><span class='Ref_To_Local'>b</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN1235"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN1235"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN1244"><span class='Ref_To_Local'>tmp</span></a><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN1237"><span class='Ref_To_Local'>swapped</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="cube.c.html#LN1238"><span class='Ref_To_Local'>distance</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* compute within the dimensions of (b) */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1239"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1239"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1236"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1239"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
        <a href="cube.c.html#LN1238"><span class='Ref_To_Local'>distance</span></a> <span class='Operator'>+= </span>fabs<span class='Parentheses'>(</span><a href="cube.c.html#LN105"><span class='Ref_to_Proto'>distance_1D</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1235"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1239"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1235"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1239"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                     <a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1236"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1239"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1236"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1239"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* compute distance to zero for those dimensions in (a) absent in (b) */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1239"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1236"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1239"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1235"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1239"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
        <a href="cube.c.html#LN1238"><span class='Ref_To_Local'>distance</span></a> <span class='Operator'>+= </span>fabs<span class='Parentheses'>(</span><a href="cube.c.html#LN105"><span class='Ref_to_Proto'>distance_1D</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1235"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1239"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1235"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1239"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                     <span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1237"><span class='Ref_To_Local'>swapped</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1236"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1235"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1235"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1236"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../src/include/fmgr.h.html#LN325"><span class='Ref_to_Macro'>PG_RETURN_FLOAT8</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1238"><span class='Ref_To_Local'>distance</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end distance_taxicab &raquo; </span> 
 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1277"></a><span class='Declare_Function'>distance_chebyshev</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1279"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>a</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span><a name="LN1280"></a>               <span class='Operator'>*</span><span class='Declare_Local'>b</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1281"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>swapped</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN1282"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>d</span><span class='Delimiter'>, 
</span><a name="LN1283"></a>                <span class='Declare_Local'>distance</span><span class='Delimiter'>; 
</span><a name="LN1284"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* swap the box pointers if needed */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1279"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1280"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1289"></a>        <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>tmp</span> <span class='Operator'>= </span><a href="cube.c.html#LN1280"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>; 
</span> 
        <a href="cube.c.html#LN1280"><span class='Ref_To_Local'>b</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN1279"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN1279"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN1289"><span class='Ref_To_Local'>tmp</span></a><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN1281"><span class='Ref_To_Local'>swapped</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="cube.c.html#LN1283"><span class='Ref_To_Local'>distance</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* compute within the dimensions of (b) */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1284"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1284"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1280"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1284"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="cube.c.html#LN1282"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= </span>fabs<span class='Parentheses'>(</span><a href="cube.c.html#LN105"><span class='Ref_to_Proto'>distance_1D</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1279"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1284"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1279"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1284"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1280"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1284"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1280"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1284"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1282"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>&GT; </span><a href="cube.c.html#LN1283"><span class='Ref_To_Local'>distance</span></a><span class='Parentheses'>) 
</span>            <a href="cube.c.html#LN1283"><span class='Ref_To_Local'>distance</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN1282"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* compute distance to zero for those dimensions in (a) absent in (b) */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1284"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1280"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1284"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1279"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1284"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="cube.c.html#LN1282"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= </span>fabs<span class='Parentheses'>(</span><a href="cube.c.html#LN105"><span class='Ref_to_Proto'>distance_1D</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1279"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1284"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1279"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1284"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1282"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>&GT; </span><a href="cube.c.html#LN1283"><span class='Ref_To_Local'>distance</span></a><span class='Parentheses'>) 
</span>            <a href="cube.c.html#LN1283"><span class='Ref_To_Local'>distance</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN1282"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1281"><span class='Ref_To_Local'>swapped</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1280"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1279"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1279"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1280"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../src/include/fmgr.h.html#LN325"><span class='Ref_to_Macro'>PG_RETURN_FLOAT8</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1283"><span class='Ref_To_Local'>distance</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end distance_chebyshev &raquo; </span> 
 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1329"></a><span class='Declare_Function'>g_cube_distance</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1331"></a>    <a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>entry</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1332"></a>    <a href="../../src/include/access/stratnum.h.html#LN21"><span class='Ref_to_Typedef'>StrategyNumber</span></a> <span class='Declare_Local'>strategy</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/stratnum.h.html#LN21"><span class='Ref_to_Typedef'>StrategyNumber</span></a><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN236"><span class='Ref_to_Macro'>PG_GETARG_UINT16</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1333"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>cube</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN51"><span class='Ref_to_Macro'>DatumGetNDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1331"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1334"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>retval</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1332"><span class='Ref_To_Local'>strategy</span></a> <span class='Operator'>== </span><a href="cubedata.h.html#LN56"><span class='Ref_to_Const'>CubeKNNDistanceCoord</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1338"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>coord</span> <span class='Operator'>= </span><a href="../../src/include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1333"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="cube.c.html#LN1334"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN39"><span class='Ref_to_Macro'>IS_POINT</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1333"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>))</span> 
            <a href="cube.c.html#LN1334"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN1333"><span class='Ref_To_Local'>cube</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1338"><span class='Ref_To_Local'>coord</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>% </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1333"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>)</span><span class='Delimiter'>]; 
</span>        <span class='Control'>else</span> 
            <a href="cube.c.html#LN1334"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1333"><span class='Ref_To_Local'>cube</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1338"><span class='Ref_To_Local'>coord</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>% </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1333"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>)</span><span class='Delimiter'>], 
</span>                         <a href="cube.c.html#LN1333"><span class='Ref_To_Local'>cube</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1338"><span class='Ref_To_Local'>coord</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>% </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1333"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1333"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>)</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1350"></a>        <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>query</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1332"><span class='Ref_To_Local'>strategy</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>case</span> <a href="cubedata.h.html#LN57"><span class='Ref_to_Const'>CubeKNNDistanceTaxicab</span></a><span class='Operator'>: 
</span>                <a href="cube.c.html#LN1334"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN720"><span class='Ref_to_Func'>DatumGetFloat8</span></a><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN585"><span class='Ref_to_Macro'>DirectFunctionCall2</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1232"><span class='Ref_to_Func'>distance_taxicab</span></a><span class='Delimiter'>, 
</span>                             <a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1333"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1350"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="cubedata.h.html#LN58"><span class='Ref_to_Const'>CubeKNNDistanceEuclid</span></a><span class='Operator'>: 
</span>                <a href="cube.c.html#LN1334"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN720"><span class='Ref_to_Func'>DatumGetFloat8</span></a><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN585"><span class='Ref_to_Macro'>DirectFunctionCall2</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1183"><span class='Ref_to_Func'>cube_distance</span></a><span class='Delimiter'>, 
</span>                             <a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1333"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1350"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="cubedata.h.html#LN59"><span class='Ref_to_Const'>CubeKNNDistanceChebyshev</span></a><span class='Operator'>: 
</span>                <a href="cube.c.html#LN1334"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN720"><span class='Ref_to_Func'>DatumGetFloat8</span></a><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN585"><span class='Ref_to_Macro'>DirectFunctionCall2</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1276"><span class='Ref_to_Func'>distance_chebyshev</span></a><span class='Delimiter'>, 
</span>                             <a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1333"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1350"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>default</span><span class='Operator'>: 
</span>                <a href="../../src/backend/bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../src/include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized cube strategy number: %d"</span><span class='Delimiter'>, </span><a href="cube.c.html#LN1332"><span class='Ref_To_Local'>strategy</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="cube.c.html#LN1334"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
    <a href="../../src/include/fmgr.h.html#LN325"><span class='Ref_to_Macro'>PG_RETURN_FLOAT8</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1334"><span class='Ref_To_Local'>retval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end g_cube_distance &raquo; </span> 
 
<span class='Keyword'>static double 
</span><a name="LN1376"></a><span class='Declare_Function'>distance_1D</span><span class='Parentheses'>(</span><span class='Keyword'>double </span><span class='Declare_Parameter'>a1</span><span class='Delimiter'>, </span><span class='Keyword'>double </span><span class='Declare_Parameter'>a2</span><span class='Delimiter'>, </span><span class='Keyword'>double </span><span class='Declare_Parameter'>b1</span><span class='Delimiter'>, </span><span class='Keyword'>double </span><span class='Declare_Parameter'>b2</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* interval (a) is entirely on the left of (b) */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="cube.c.html#LN1376"><span class='Ref_to_Parameter'>a1</span></a> <span class='Operator'>&LT;= </span><a href="cube.c.html#LN1376"><span class='Ref_to_Parameter'>b1</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="cube.c.html#LN1376"><span class='Ref_to_Parameter'>a2</span></a> <span class='Operator'>&LT;= </span><a href="cube.c.html#LN1376"><span class='Ref_to_Parameter'>b1</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="cube.c.html#LN1376"><span class='Ref_to_Parameter'>a1</span></a> <span class='Operator'>&LT;= </span><a href="cube.c.html#LN1376"><span class='Ref_to_Parameter'>b2</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="cube.c.html#LN1376"><span class='Ref_to_Parameter'>a2</span></a> <span class='Operator'>&LT;= </span><a href="cube.c.html#LN1376"><span class='Ref_to_Parameter'>b2</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1376"><span class='Ref_to_Parameter'>b1</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1376"><span class='Ref_to_Parameter'>b2</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1376"><span class='Ref_to_Parameter'>a1</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1376"><span class='Ref_to_Parameter'>a2</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* interval (a) is entirely on the right of (b) */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="cube.c.html#LN1376"><span class='Ref_to_Parameter'>a1</span></a> <span class='Operator'>&GT; </span><a href="cube.c.html#LN1376"><span class='Ref_to_Parameter'>b1</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="cube.c.html#LN1376"><span class='Ref_to_Parameter'>a2</span></a> <span class='Operator'>&GT; </span><a href="cube.c.html#LN1376"><span class='Ref_to_Parameter'>b1</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="cube.c.html#LN1376"><span class='Ref_to_Parameter'>a1</span></a> <span class='Operator'>&GT; </span><a href="cube.c.html#LN1376"><span class='Ref_to_Parameter'>b2</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="cube.c.html#LN1376"><span class='Ref_to_Parameter'>a2</span></a> <span class='Operator'>&GT; </span><a href="cube.c.html#LN1376"><span class='Ref_to_Parameter'>b2</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1376"><span class='Ref_to_Parameter'>a1</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1376"><span class='Ref_to_Parameter'>a2</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1376"><span class='Ref_to_Parameter'>b1</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1376"><span class='Ref_to_Parameter'>b2</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* the rest are all sorts of intersections */ 
</span>    <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* Test if a box is also a point */ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1392"></a><span class='Declare_Function'>cube_is_point</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1394"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>cube</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1395"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN1395"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN106"><span class='Ref_to_Proto'>cube_is_point_internal</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1394"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1394"><span class='Ref_To_Local'>cube</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1395"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static bool 
</span><a name="LN1403"></a><span class='Declare_Function'>cube_is_point_internal</span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cube</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1405"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN39"><span class='Ref_to_Macro'>IS_POINT</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1403"><span class='Ref_to_Parameter'>cube</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Even if the point-flag is not set, all the lower-left coordinates might 
     * match the upper-right coordinates, so that the value is in fact a 
     * point. Such values don't arise with current code - the point flag is 
     * always set if appropriate - but they might be present on-disk in 
     * clusters upgraded from pre-9.4 versions. 
     */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1405"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1405"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1403"><span class='Ref_to_Parameter'>cube</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1405"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1403"><span class='Ref_to_Parameter'>cube</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1405"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1403"><span class='Ref_to_Parameter'>cube</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1405"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end cube_is_point_internal &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* Return dimensions in use in the data structure */ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1427"></a><span class='Declare_Function'>cube_dim</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1429"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>c</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1430"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>dim</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1429"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1429"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1430"><span class='Ref_To_Local'>dim</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* Return a specific normalized LL coordinate */ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1438"></a><span class='Declare_Function'>cube_ll_coord</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1440"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>c</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1441"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>n</span> <span class='Operator'>= </span><a href="../../src/include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1442"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1440"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><a href="cube.c.html#LN1441"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>&& </span><a href="cube.c.html#LN1441"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="cube.c.html#LN1442"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1440"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1441"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1440"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1441"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="cube.c.html#LN1442"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1440"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN325"><span class='Ref_to_Macro'>PG_RETURN_FLOAT8</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1442"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* Return a specific normalized UR coordinate */ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1455"></a><span class='Declare_Function'>cube_ur_coord</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1457"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>c</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1458"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>n</span> <span class='Operator'>= </span><a href="../../src/include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1459"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1457"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><a href="cube.c.html#LN1458"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>&& </span><a href="cube.c.html#LN1458"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="cube.c.html#LN1459"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1457"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1458"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1457"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1458"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="cube.c.html#LN1459"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1457"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN325"><span class='Ref_to_Macro'>PG_RETURN_FLOAT8</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1459"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Function returns cube coordinate. 
 * Numbers from 1 to DIM denotes first corner coordinates. 
 * Numbers from DIM+1 to 2*DIM denotes second corner coordinates. 
 */ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1476"></a><span class='Declare_Function'>cube_coord</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1478"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>cube</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1479"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>coord</span> <span class='Operator'>= </span><a href="../../src/include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1479"><span class='Ref_To_Local'>coord</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="cube.c.html#LN1479"><span class='Ref_To_Local'>coord</span></a> <span class='Operator'>&GT; </span><span class='Number'>2</span> <span class='Operator'>* </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1478"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>))</span> 
        <a href="../../src/include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../src/include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../src/include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_ARRAY_ELEMENT_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../../src/backend/utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cube index %d is out of bounds"</span><span class='Delimiter'>, </span><a href="cube.c.html#LN1479"><span class='Ref_To_Local'>coord</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN39"><span class='Ref_to_Macro'>IS_POINT</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1478"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>))</span> 
        <a href="../../src/include/fmgr.h.html#LN325"><span class='Ref_to_Macro'>PG_RETURN_FLOAT8</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1478"><span class='Ref_To_Local'>cube</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1479"><span class='Ref_To_Local'>coord</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>% </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1478"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>)</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="../../src/include/fmgr.h.html#LN325"><span class='Ref_to_Macro'>PG_RETURN_FLOAT8</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1478"><span class='Ref_To_Local'>cube</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1479"><span class='Ref_To_Local'>coord</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * This function works like cube_coord(), 
 * but rearranges coordinates of corners to get cube representation 
 * in the form of (lower left, upper right). 
 * For historical reasons that extension allows us to create cubes in form 
 * ((2,1),(1,2)) and instead of normalizing such cube to ((1,1),(2,2)) it 
 * stores cube in original way. But to get cubes ordered by one of dimensions 
 * directly from the index without extra sort step we need some 
 * representation-independent coordinate getter. This function implements it. 
 */ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1504"></a><span class='Declare_Function'>cube_coord_llur</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1506"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>cube</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1507"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>coord</span> <span class='Operator'>= </span><a href="../../src/include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1507"><span class='Ref_To_Local'>coord</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="cube.c.html#LN1507"><span class='Ref_To_Local'>coord</span></a> <span class='Operator'>&GT; </span><span class='Number'>2</span> <span class='Operator'>* </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1506"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>))</span> 
        <a href="../../src/include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../src/include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../src/include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_ARRAY_ELEMENT_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../../src/backend/utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cube index %d is out of bounds"</span><span class='Delimiter'>, </span><a href="cube.c.html#LN1507"><span class='Ref_To_Local'>coord</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1507"><span class='Ref_To_Local'>coord</span></a> <span class='Operator'>&LT;= </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1506"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN39"><span class='Ref_to_Macro'>IS_POINT</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1506"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>))</span> 
            <a href="../../src/include/fmgr.h.html#LN325"><span class='Ref_to_Macro'>PG_RETURN_FLOAT8</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1506"><span class='Ref_To_Local'>cube</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1507"><span class='Ref_To_Local'>coord</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="../../src/include/fmgr.h.html#LN325"><span class='Ref_to_Macro'>PG_RETURN_FLOAT8</span></a><span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1506"><span class='Ref_To_Local'>cube</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1507"><span class='Ref_To_Local'>coord</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>], 
</span>                                 <a href="cube.c.html#LN1506"><span class='Ref_To_Local'>cube</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1507"><span class='Ref_To_Local'>coord</span></a> <span class='Operator'>- </span><span class='Number'>1</span> <span class='Operator'>+ </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1506"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>)</span><span class='Delimiter'>]</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN39"><span class='Ref_to_Macro'>IS_POINT</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1506"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>))</span> 
            <a href="../../src/include/fmgr.h.html#LN325"><span class='Ref_to_Macro'>PG_RETURN_FLOAT8</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1506"><span class='Ref_To_Local'>cube</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><span class='Parentheses'>(</span><a href="cube.c.html#LN1507"><span class='Ref_To_Local'>coord</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>% </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1506"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>)</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="../../src/include/fmgr.h.html#LN325"><span class='Ref_to_Macro'>PG_RETURN_FLOAT8</span></a><span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1506"><span class='Ref_To_Local'>cube</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1507"><span class='Ref_To_Local'>coord</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>], 
</span>                                 <a href="cube.c.html#LN1506"><span class='Ref_To_Local'>cube</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1507"><span class='Ref_To_Local'>coord</span></a> <span class='Operator'>- </span><span class='Number'>1</span> <span class='Operator'>- </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1506"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>)</span><span class='Delimiter'>]</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end cube_coord_llur &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* Increase or decrease box size by a radius in at least n dimensions. */ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1534"></a><span class='Declare_Function'>cube_enlarge</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1536"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>a</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1537"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>r</span> <span class='Operator'>= </span><a href="../../src/include/fmgr.h.html#LN245"><span class='Ref_to_Macro'>PG_GETARG_FLOAT8</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1538"></a>    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>n</span> <span class='Operator'>= </span><a href="../../src/include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1539"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1540"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>dim</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN1541"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>size</span><span class='Delimiter'>; 
</span><a name="LN1542"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>, 
</span><a name="LN1543"></a>                <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1538"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>&GT; </span><a href="cubedata.h.html#LN6"><span class='Ref_to_Const'>CUBE_MAX_DIM</span></a><span class='Parentheses'>) 
</span>        <a href="cube.c.html#LN1538"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN6"><span class='Ref_to_Const'>CUBE_MAX_DIM</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1537"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="cube.c.html#LN1538"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="cube.c.html#LN1540"><span class='Ref_To_Local'>dim</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN1538"><span class='Ref_To_Local'>n</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1536"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><a href="cube.c.html#LN1540"><span class='Ref_To_Local'>dim</span></a><span class='Parentheses'>)</span> 
        <a href="cube.c.html#LN1540"><span class='Ref_To_Local'>dim</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1536"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN1541"><span class='Ref_To_Local'>size</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN48"><span class='Ref_to_Macro'>CUBE_SIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1540"><span class='Ref_To_Local'>dim</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cube.c.html#LN1539"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1541"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1539"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1541"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cubedata.h.html#LN42"><span class='Ref_to_Macro'>SET_DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1539"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1540"><span class='Ref_To_Local'>dim</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1542"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="cube.c.html#LN1543"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><a href="cube.c.html#LN1540"><span class='Ref_To_Local'>dim</span></a><span class='Delimiter'>; </span><a href="cube.c.html#LN1542"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1536"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1542"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Delimiter'>, </span><a href="cube.c.html#LN1543"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1536"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1542"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1536"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1542"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="cube.c.html#LN1539"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1542"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1536"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1542"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="cube.c.html#LN1537"><span class='Ref_To_Local'>r</span></a><span class='Delimiter'>; 
</span>            <a href="cube.c.html#LN1539"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1543"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1536"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1542"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="cube.c.html#LN1537"><span class='Ref_To_Local'>r</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="cube.c.html#LN1539"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1542"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1536"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1542"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="cube.c.html#LN1537"><span class='Ref_To_Local'>r</span></a><span class='Delimiter'>; 
</span>            <a href="cube.c.html#LN1539"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1543"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1536"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1542"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="cube.c.html#LN1537"><span class='Ref_To_Local'>r</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1539"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1542"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>&GT; </span><a href="cube.c.html#LN1539"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1543"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="cube.c.html#LN1539"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1542"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Parentheses'>(</span><a href="cube.c.html#LN1539"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1542"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>+ </span><a href="cube.c.html#LN1539"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1543"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) </span><span class='Operator'>/ </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>            <a href="cube.c.html#LN1539"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1543"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cube.c.html#LN1539"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1542"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* dim &GT; a-&GT;dim only if r &GT; 0 */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1542"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cube.c.html#LN1540"><span class='Ref_To_Local'>dim</span></a><span class='Delimiter'>; </span><a href="cube.c.html#LN1542"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Delimiter'>, </span><a href="cube.c.html#LN1543"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="cube.c.html#LN1539"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1542"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= -</span><a href="cube.c.html#LN1537"><span class='Ref_To_Local'>r</span></a><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN1539"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1543"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cube.c.html#LN1537"><span class='Ref_To_Local'>r</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Check if the result was in fact a point, and set the flag in the datum 
     * accordingly. (we don't bother to repalloc it smaller) 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN106"><span class='Ref_to_Proto'>cube_is_point_internal</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1539"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="cube.c.html#LN1541"><span class='Ref_To_Local'>size</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN47"><span class='Ref_to_Macro'>POINT_SIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1540"><span class='Ref_To_Local'>dim</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1539"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1541"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cubedata.h.html#LN40"><span class='Ref_to_Macro'>SET_POINT_BIT</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1539"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1536"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cubedata.h.html#LN53"><span class='Ref_to_Macro'>PG_RETURN_NDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1539"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end cube_enlarge &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* Create a one dimensional box with identical upper and lower coordinates */ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1599"></a><span class='Declare_Function'>cube_f8</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1601"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>x</span> <span class='Operator'>= </span><a href="../../src/include/fmgr.h.html#LN245"><span class='Ref_to_Macro'>PG_GETARG_FLOAT8</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1602"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1603"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>size</span><span class='Delimiter'>; 
</span> 
    <a href="cube.c.html#LN1603"><span class='Ref_To_Local'>size</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN47"><span class='Ref_to_Macro'>POINT_SIZE</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cube.c.html#LN1602"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1603"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1602"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1603"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cubedata.h.html#LN42"><span class='Ref_to_Macro'>SET_DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1602"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cubedata.h.html#LN40"><span class='Ref_to_Macro'>SET_POINT_BIT</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1602"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cube.c.html#LN1602"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cube.c.html#LN1601"><span class='Ref_To_Local'>x</span></a><span class='Delimiter'>; 
</span> 
    <a href="cubedata.h.html#LN53"><span class='Ref_to_Macro'>PG_RETURN_NDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1602"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* Create a one dimensional box */ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1617"></a><span class='Declare_Function'>cube_f8_f8</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1619"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>x0</span> <span class='Operator'>= </span><a href="../../src/include/fmgr.h.html#LN245"><span class='Ref_to_Macro'>PG_GETARG_FLOAT8</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1620"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>x1</span> <span class='Operator'>= </span><a href="../../src/include/fmgr.h.html#LN245"><span class='Ref_to_Macro'>PG_GETARG_FLOAT8</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1621"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1622"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>size</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1619"><span class='Ref_To_Local'>x0</span></a> <span class='Operator'>== </span><a href="cube.c.html#LN1620"><span class='Ref_To_Local'>x1</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="cube.c.html#LN1622"><span class='Ref_To_Local'>size</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN47"><span class='Ref_to_Macro'>POINT_SIZE</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN1621"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1622"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1621"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1622"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cubedata.h.html#LN42"><span class='Ref_to_Macro'>SET_DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1621"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cubedata.h.html#LN40"><span class='Ref_to_Macro'>SET_POINT_BIT</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1621"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN1621"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cube.c.html#LN1619"><span class='Ref_To_Local'>x0</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="cube.c.html#LN1622"><span class='Ref_To_Local'>size</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN48"><span class='Ref_to_Macro'>CUBE_SIZE</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN1621"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1622"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1621"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1622"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cubedata.h.html#LN42"><span class='Ref_to_Macro'>SET_DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1621"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN1621"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cube.c.html#LN1619"><span class='Ref_To_Local'>x0</span></a><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN1621"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cube.c.html#LN1620"><span class='Ref_To_Local'>x1</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="cubedata.h.html#LN53"><span class='Ref_to_Macro'>PG_RETURN_NDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1621"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end cube_f8_f8 &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* Add a dimension to an existing cube with the same values for the new 
   coordinate */ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1649"></a><span class='Declare_Function'>cube_c_f8</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1651"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>cube</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1652"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>x</span> <span class='Operator'>= </span><a href="../../src/include/fmgr.h.html#LN245"><span class='Ref_to_Macro'>PG_GETARG_FLOAT8</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1653"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1654"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>size</span><span class='Delimiter'>; 
</span><a name="LN1655"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN39"><span class='Ref_to_Macro'>IS_POINT</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1651"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="cube.c.html#LN1654"><span class='Ref_To_Local'>size</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN47"><span class='Ref_to_Macro'>POINT_SIZE</span></a><span class='Parentheses'>((</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1651"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN1653"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1654"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1653"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1654"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cubedata.h.html#LN42"><span class='Ref_to_Macro'>SET_DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1653"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1651"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cubedata.h.html#LN40"><span class='Ref_to_Macro'>SET_POINT_BIT</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1653"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1655"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1655"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1651"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1655"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
            <a href="cube.c.html#LN1653"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1655"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cube.c.html#LN1651"><span class='Ref_To_Local'>cube</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1655"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>        <a href="cube.c.html#LN1653"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1653"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cube.c.html#LN1652"><span class='Ref_To_Local'>x</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="cube.c.html#LN1654"><span class='Ref_To_Local'>size</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN48"><span class='Ref_to_Macro'>CUBE_SIZE</span></a><span class='Parentheses'>((</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1651"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN1653"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1654"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1653"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1654"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cubedata.h.html#LN42"><span class='Ref_to_Macro'>SET_DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1653"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1651"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1655"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1655"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1651"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1655"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="cube.c.html#LN1653"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1655"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cube.c.html#LN1651"><span class='Ref_To_Local'>cube</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1655"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>            <a href="cube.c.html#LN1653"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1653"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="cube.c.html#LN1655"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cube.c.html#LN1651"><span class='Ref_To_Local'>cube</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1651"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="cube.c.html#LN1655"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>        <span class='Delimiter'>} 
</span>        <a href="cube.c.html#LN1653"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1653"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cube.c.html#LN1652"><span class='Ref_To_Local'>x</span></a><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN1653"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><span class='Number'>2</span> <span class='Operator'>* </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1653"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cube.c.html#LN1652"><span class='Ref_To_Local'>x</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1651"><span class='Ref_To_Local'>cube</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cubedata.h.html#LN53"><span class='Ref_to_Macro'>PG_RETURN_NDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1653"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end cube_c_f8 &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* Add a dimension to an existing cube */ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1689"></a><span class='Declare_Function'>cube_c_f8_f8</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1691"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>cube</span> <span class='Operator'>= </span><a href="cubedata.h.html#LN52"><span class='Ref_to_Macro'>PG_GETARG_NDBOX</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1692"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>x1</span> <span class='Operator'>= </span><a href="../../src/include/fmgr.h.html#LN245"><span class='Ref_to_Macro'>PG_GETARG_FLOAT8</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1693"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>x2</span> <span class='Operator'>= </span><a href="../../src/include/fmgr.h.html#LN245"><span class='Ref_to_Macro'>PG_GETARG_FLOAT8</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1694"></a>    <a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1695"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>size</span><span class='Delimiter'>; 
</span><a name="LN1696"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cubedata.h.html#LN39"><span class='Ref_to_Macro'>IS_POINT</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1691"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="cube.c.html#LN1692"><span class='Ref_To_Local'>x1</span></a> <span class='Operator'>== </span><a href="cube.c.html#LN1693"><span class='Ref_To_Local'>x2</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="cube.c.html#LN1695"><span class='Ref_To_Local'>size</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN47"><span class='Ref_to_Macro'>POINT_SIZE</span></a><span class='Parentheses'>((</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1691"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN1694"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1695"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1694"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1695"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cubedata.h.html#LN42"><span class='Ref_to_Macro'>SET_DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1694"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1691"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cubedata.h.html#LN40"><span class='Ref_to_Macro'>SET_POINT_BIT</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1694"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1696"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1696"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1691"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1696"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
            <a href="cube.c.html#LN1694"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1696"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cube.c.html#LN1691"><span class='Ref_To_Local'>cube</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1696"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>        <a href="cube.c.html#LN1694"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1694"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cube.c.html#LN1692"><span class='Ref_To_Local'>x1</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="cube.c.html#LN1695"><span class='Ref_To_Local'>size</span></a> <span class='Operator'>= </span><a href="cubedata.h.html#LN48"><span class='Ref_to_Macro'>CUBE_SIZE</span></a><span class='Parentheses'>((</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1691"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN1694"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="cubedata.h.html#LN8"><span class='Ref_to_Struct'>NDBOX</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1695"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1694"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1695"><span class='Ref_To_Local'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cubedata.h.html#LN42"><span class='Ref_to_Macro'>SET_DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1694"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1691"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cube.c.html#LN1696"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1696"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1691"><span class='Ref_To_Local'>cube</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="cube.c.html#LN1696"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="cube.c.html#LN1694"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cube.c.html#LN1696"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cubedata.h.html#LN44"><span class='Ref_to_Macro'>LL_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1691"><span class='Ref_To_Local'>cube</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1696"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="cube.c.html#LN1694"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1694"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="cube.c.html#LN1696"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cubedata.h.html#LN45"><span class='Ref_to_Macro'>UR_COORD</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1691"><span class='Ref_To_Local'>cube</span></a><span class='Delimiter'>, </span><a href="cube.c.html#LN1696"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="cube.c.html#LN1694"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1694"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cube.c.html#LN1692"><span class='Ref_To_Local'>x1</span></a><span class='Delimiter'>; 
</span>        <a href="cube.c.html#LN1694"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="cubedata.h.html#LN32"><span class='Ref_to_Member'>x</span></a><span class='Delimiter'>[</span><span class='Number'>2</span> <span class='Operator'>* </span><a href="cubedata.h.html#LN41"><span class='Ref_to_Macro'>DIM</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1694"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="cube.c.html#LN1693"><span class='Ref_To_Local'>x2</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1691"><span class='Ref_To_Local'>cube</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="cubedata.h.html#LN53"><span class='Ref_to_Macro'>PG_RETURN_NDBOX</span></a><span class='Parentheses'>(</span><a href="cube.c.html#LN1694"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end cube_c_f8_f8 &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>