<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>contrib\hstore\hstore_op.c</title>
<LINK REL=StyleSheet HREF="../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>contrib\hstore\hstore_op.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:25 2017
</td></tr>
<tr><td><a href='../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/* 
 * contrib/hstore/hstore_op.c 
 */ 
</span><span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>"access/hash.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/htup_details.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_type.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"funcapi.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/builtins.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/memutils.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>"hstore.h"</span> 
 
<span class='Comment_Multi_Line'>/* old names for C functions */ 
</span><a name="LN15"></a><span class='Declare_Prototype'>HSTORE_POLLUTE</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN129"><span class='Ref_to_Func'>hstore_fetchval</span></a><span class='Delimiter'>, </span>fetchval<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN16"></a><span class='Declare_Prototype'>HSTORE_POLLUTE</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN150"><span class='Ref_to_Func'>hstore_exists</span></a><span class='Delimiter'>, </span>exists<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN17"></a><span class='Declare_Prototype'>HSTORE_POLLUTE</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN231"><span class='Ref_to_Func'>hstore_defined</span></a><span class='Delimiter'>, </span>defined<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN18"></a><span class='Declare_Prototype'>HSTORE_POLLUTE</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN246"><span class='Ref_to_Func'>hstore_delete</span></a><span class='Delimiter'>, </span><span class='Control'>delete</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN19"></a><span class='Declare_Prototype'>HSTORE_POLLUTE</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN472"><span class='Ref_to_Func'>hstore_concat</span></a><span class='Delimiter'>, </span>hs_concat<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN20"></a><span class='Declare_Prototype'>HSTORE_POLLUTE</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN966"><span class='Ref_to_Func'>hstore_contains</span></a><span class='Delimiter'>, </span>hs_contains<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN21"></a><span class='Declare_Prototype'>HSTORE_POLLUTE</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1014"><span class='Ref_to_Func'>hstore_contained</span></a><span class='Delimiter'>, </span>hs_contained<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN22"></a><span class='Declare_Prototype'>HSTORE_POLLUTE</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN695"><span class='Ref_to_Func'>hstore_akeys</span></a><span class='Delimiter'>, </span>akeys<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN23"></a><span class='Declare_Prototype'>HSTORE_POLLUTE</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN730"><span class='Ref_to_Func'>hstore_avals</span></a><span class='Delimiter'>, </span>avals<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN24"></a><span class='Declare_Prototype'>HSTORE_POLLUTE</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN884"><span class='Ref_to_Func'>hstore_skeys</span></a><span class='Delimiter'>, </span>skeys<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN25"></a><span class='Declare_Prototype'>HSTORE_POLLUTE</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN918"><span class='Ref_to_Func'>hstore_svals</span></a><span class='Delimiter'>, </span>svals<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN26"></a><span class='Declare_Prototype'>HSTORE_POLLUTE</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1025"><span class='Ref_to_Func'>hstore_each</span></a><span class='Delimiter'>, </span><span class='Control'>each</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * We're often finding a sequence of keys in ascending order. The 
 * "lowbound" parameter is used to cache lower bounds of searches 
 * between calls, based on this assumption. Pass NULL for it for 
 * one-off or unordered searches. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN36"></a><span class='Declare_Function'>hstoreFindKey</span><span class='Parentheses'>(</span><a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>hs</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>lowbound</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>key</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>keylen</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN38"></a>    <a href="hstore.h.html#LN17"><span class='Ref_to_Typedef'>HEntry</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>entries</span> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN36"><span class='Ref_to_Parameter'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN39"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>stopLow</span> <span class='Operator'>= </span><a href="hstore_op.c.html#LN36"><span class='Ref_to_Parameter'>lowbound</span></a> <span class='Operator'>? *</span><a href="hstore_op.c.html#LN36"><span class='Ref_to_Parameter'>lowbound</span></a> <span class='Operator'>: </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN40"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>stopHigh</span> <span class='Operator'>= </span><a href="hstore.h.html#LN60"><span class='Ref_to_Macro'>HS_COUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN36"><span class='Ref_to_Parameter'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN41"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>stopMiddle</span><span class='Delimiter'>; 
</span><a name="LN42"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>base</span> <span class='Operator'>= </span><a href="hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN36"><span class='Ref_to_Parameter'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN39"><span class='Ref_To_Local'>stopLow</span></a> <span class='Operator'>&LT; </span><a href="hstore_op.c.html#LN40"><span class='Ref_To_Local'>stopHigh</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN46"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>difference</span><span class='Delimiter'>; 
</span> 
        <a href="hstore_op.c.html#LN41"><span class='Ref_To_Local'>stopMiddle</span></a> <span class='Operator'>= </span><a href="hstore_op.c.html#LN39"><span class='Ref_To_Local'>stopLow</span></a> <span class='Operator'>+ </span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN40"><span class='Ref_To_Local'>stopHigh</span></a> <span class='Operator'>- </span><a href="hstore_op.c.html#LN39"><span class='Ref_To_Local'>stopLow</span></a><span class='Parentheses'>) </span><span class='Operator'>/ </span><span class='Number'>2</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore.h.html#LN80"><span class='Ref_to_Macro'>HSTORE_KEYLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN38"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN41"><span class='Ref_To_Local'>stopMiddle</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="hstore_op.c.html#LN36"><span class='Ref_to_Parameter'>keylen</span></a><span class='Parentheses'>)</span> 
            <a href="hstore_op.c.html#LN46"><span class='Ref_To_Local'>difference</span></a> <span class='Operator'>= </span>memcmp<span class='Parentheses'>(</span><a href="hstore.h.html#LN78"><span class='Ref_to_Macro'>HSTORE_KEY</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN38"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN42"><span class='Ref_To_Local'>base</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN41"><span class='Ref_To_Local'>stopMiddle</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN36"><span class='Ref_to_Parameter'>key</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN36"><span class='Ref_to_Parameter'>keylen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="hstore_op.c.html#LN46"><span class='Ref_To_Local'>difference</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="hstore.h.html#LN80"><span class='Ref_to_Macro'>HSTORE_KEYLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN38"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN41"><span class='Ref_To_Local'>stopMiddle</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><a href="hstore_op.c.html#LN36"><span class='Ref_to_Parameter'>keylen</span></a><span class='Parentheses'>)</span> <span class='Operator'>? </span><span class='Number'>1</span> <span class='Operator'>: -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN46"><span class='Ref_To_Local'>difference</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN36"><span class='Ref_to_Parameter'>lowbound</span></a><span class='Parentheses'>) 
</span>                <span class='Operator'>*</span><a href="hstore_op.c.html#LN36"><span class='Ref_to_Parameter'>lowbound</span></a> <span class='Operator'>= </span><a href="hstore_op.c.html#LN41"><span class='Ref_To_Local'>stopMiddle</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <a href="hstore_op.c.html#LN41"><span class='Ref_To_Local'>stopMiddle</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN46"><span class='Ref_To_Local'>difference</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="hstore_op.c.html#LN39"><span class='Ref_To_Local'>stopLow</span></a> <span class='Operator'>= </span><a href="hstore_op.c.html#LN41"><span class='Ref_To_Local'>stopMiddle</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="hstore_op.c.html#LN40"><span class='Ref_To_Local'>stopHigh</span></a> <span class='Operator'>= </span><a href="hstore_op.c.html#LN41"><span class='Ref_To_Local'>stopMiddle</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while stopLow&LT;stopHigh &raquo; </span> 
 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN36"><span class='Ref_to_Parameter'>lowbound</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="hstore_op.c.html#LN36"><span class='Ref_to_Parameter'>lowbound</span></a> <span class='Operator'>= </span><a href="hstore_op.c.html#LN39"><span class='Ref_To_Local'>stopLow</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end hstoreFindKey &raquo; </span> 
 
<a href="hstore.h.html#LN160"><span class='Ref_to_Typedef'>Pairs</span></a> <span class='Operator'>* 
</span><a name="LN73"></a><span class='Declare_Function'>hstoreArrayToPairs</span><span class='Parentheses'>(</span><a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>npairs</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN75"></a>    <a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>key_datums</span><span class='Delimiter'>; 
</span><a name="LN76"></a>    <span class='Keyword'>bool</span>       <span class='Operator'>*</span><span class='Declare_Local'>key_nulls</span><span class='Delimiter'>; 
</span><a name="LN77"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>key_count</span><span class='Delimiter'>; 
</span><a name="LN78"></a>    <a href="hstore.h.html#LN160"><span class='Ref_to_Typedef'>Pairs</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>key_pairs</span><span class='Delimiter'>; 
</span><a name="LN79"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>bufsiz</span><span class='Delimiter'>; 
</span><a name="LN80"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>, 
</span><a name="LN81"></a>                <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/utils/array.h.html#LN382"><span class='Ref_to_Proto'>deconstruct_array</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN73"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, 
</span>                      <a href="../../src/interfaces/ecpg/ecpglib/pg_type.h.html#LN26"><span class='Ref_to_Const'>TEXTOID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='String'>'i'</span><span class='Delimiter'>, 
</span>                      <span class='Operator'>&</span><a href="hstore_op.c.html#LN75"><span class='Ref_To_Local'>key_datums</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="hstore_op.c.html#LN76"><span class='Ref_To_Local'>key_nulls</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="hstore_op.c.html#LN77"><span class='Ref_To_Local'>key_count</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN77"><span class='Ref_To_Local'>key_count</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Operator'>*</span><a href="hstore_op.c.html#LN73"><span class='Ref_to_Parameter'>npairs</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * A text array uses at least eight bytes per element, so any overflow in 
     * "key_count * sizeof(Pairs)" is small enough for palloc() to catch. 
     * However, credible improvements to the array format could invalidate 
     * that assumption.  Therefore, use an explicit check rather than relying 
     * on palloc() to complain. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN77"><span class='Ref_To_Local'>key_count</span></a> <span class='Operator'>&GT; </span><a href="../../src/common/psprintf.c.html#LN27"><span class='Ref_to_Const'>MaxAllocSize</span></a> <span class='Operator'>/ </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="hstore.h.html#LN160"><span class='Ref_to_Typedef'>Pairs</span></a><span class='Parentheses'>))</span> 
        <a href="../../src/include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../src/include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../src/include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_PROGRAM_LIMIT_EXCEEDED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>              <a href="../../src/backend/utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"number of pairs (%d) exceeds the maximum allowed (%d)"</span><span class='Delimiter'>, 
</span>                     <a href="hstore_op.c.html#LN77"><span class='Ref_To_Local'>key_count</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>)</span> <span class='Parentheses'>(</span><a href="../../src/common/psprintf.c.html#LN27"><span class='Ref_to_Const'>MaxAllocSize</span></a> <span class='Operator'>/ </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="hstore.h.html#LN160"><span class='Ref_to_Typedef'>Pairs</span></a><span class='Parentheses'>)))))</span><span class='Delimiter'>; 
</span> 
    <a href="hstore_op.c.html#LN78"><span class='Ref_To_Local'>key_pairs</span></a> <span class='Operator'>= </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="hstore.h.html#LN160"><span class='Ref_to_Typedef'>Pairs</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="hstore_op.c.html#LN77"><span class='Ref_To_Local'>key_count</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN80"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN81"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="hstore_op.c.html#LN80"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="hstore_op.c.html#LN77"><span class='Ref_To_Local'>key_count</span></a><span class='Delimiter'>; </span><a href="hstore_op.c.html#LN80"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="hstore_op.c.html#LN76"><span class='Ref_To_Local'>key_nulls</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN80"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="hstore_op.c.html#LN78"><span class='Ref_To_Local'>key_pairs</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN81"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="hstore.h.html#LN162"><span class='Ref_to_Member'>key</span></a> <span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN302"><span class='Ref_to_Macro'>VARDATA</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN75"><span class='Ref_To_Local'>key_datums</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN80"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="hstore_op.c.html#LN78"><span class='Ref_To_Local'>key_pairs</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN81"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="hstore.h.html#LN164"><span class='Ref_to_Member'>keylen</span></a> <span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN75"><span class='Ref_To_Local'>key_datums</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN80"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="../../src/include/c.h.html#LN444"><span class='Ref_to_Const'>VARHDRSZ</span></a><span class='Delimiter'>; 
</span>            <a href="hstore_op.c.html#LN78"><span class='Ref_To_Local'>key_pairs</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN81"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="hstore.h.html#LN163"><span class='Ref_to_Member'>val</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <a href="hstore_op.c.html#LN78"><span class='Ref_To_Local'>key_pairs</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN81"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="hstore.h.html#LN165"><span class='Ref_to_Member'>vallen</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <a href="hstore_op.c.html#LN78"><span class='Ref_To_Local'>key_pairs</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN81"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="hstore.h.html#LN167"><span class='Ref_to_Member'>needfree</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <a href="hstore_op.c.html#LN78"><span class='Ref_To_Local'>key_pairs</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN81"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="hstore.h.html#LN166"><span class='Ref_to_Member'>isnull</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <a href="hstore_op.c.html#LN81"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Operator'>*</span><a href="hstore_op.c.html#LN73"><span class='Ref_to_Parameter'>npairs</span></a> <span class='Operator'>= </span><a href="hstore.h.html#LN170"><span class='Ref_to_Proto'>hstoreUniquePairs</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN78"><span class='Ref_To_Local'>key_pairs</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN81"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="hstore_op.c.html#LN79"><span class='Ref_To_Local'>bufsiz</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="hstore_op.c.html#LN78"><span class='Ref_To_Local'>key_pairs</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end hstoreArrayToPairs &raquo; </span> 
 
 
<a name="LN128"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN129"><span class='Ref_to_Func'>hstore_fetchval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN130"></a><span class='Declare_Function'>hstore_fetchval</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN132"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>hs</span> <span class='Operator'>= </span><a href="hstore.h.html#LN153"><span class='Ref_to_Macro'>PG_GETARG_HS</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN133"></a>    <a href="../seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>key</span> <span class='Operator'>= </span><a href="../../src/include/fmgr.h.html#LN272"><span class='Ref_to_Macro'>PG_GETARG_TEXT_PP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN134"></a>    <a href="hstore.h.html#LN17"><span class='Ref_to_Typedef'>HEntry</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>entries</span> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN132"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN135"></a>    <a href="../seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>out</span><span class='Delimiter'>; 
</span><a name="LN136"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>idx</span> <span class='Operator'>= </span><a href="hstore_op.c.html#LN35"><span class='Ref_to_Func'>hstoreFindKey</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN132"><span class='Ref_To_Local'>hs</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                                    <a href="../../src/include/postgres.h.html#LN346"><span class='Ref_to_Macro'>VARDATA_ANY</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN133"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN339"><span class='Ref_to_Macro'>VARSIZE_ANY_EXHDR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN133"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN136"><span class='Ref_To_Local'>idx</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="hstore.h.html#LN82"><span class='Ref_to_Macro'>HSTORE_VALISNULL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN134"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN136"><span class='Ref_To_Local'>idx</span></a><span class='Parentheses'>))</span> 
        <a href="../../src/include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="hstore_op.c.html#LN135"><span class='Ref_To_Local'>out</span></a> <span class='Operator'>= </span><a href="../../src/include/utils/builtins.h.html#LN86"><span class='Ref_to_Proto'>cstring_to_text_with_len</span></a><span class='Parentheses'>(</span><a href="hstore.h.html#LN79"><span class='Ref_to_Macro'>HSTORE_VAL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN134"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN132"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN136"><span class='Ref_To_Local'>idx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                   <a href="hstore.h.html#LN81"><span class='Ref_to_Macro'>HSTORE_VALLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN134"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN136"><span class='Ref_To_Local'>idx</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN329"><span class='Ref_to_Macro'>PG_RETURN_TEXT_P</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN135"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<a name="LN149"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN150"><span class='Ref_to_Func'>hstore_exists</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN151"></a><span class='Declare_Function'>hstore_exists</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN153"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>hs</span> <span class='Operator'>= </span><a href="hstore.h.html#LN153"><span class='Ref_to_Macro'>PG_GETARG_HS</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN154"></a>    <a href="../seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>key</span> <span class='Operator'>= </span><a href="../../src/include/fmgr.h.html#LN272"><span class='Ref_to_Macro'>PG_GETARG_TEXT_PP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN155"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>idx</span> <span class='Operator'>= </span><a href="hstore_op.c.html#LN35"><span class='Ref_to_Func'>hstoreFindKey</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN153"><span class='Ref_To_Local'>hs</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                                    <a href="../../src/include/postgres.h.html#LN346"><span class='Ref_to_Macro'>VARDATA_ANY</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN154"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN339"><span class='Ref_to_Macro'>VARSIZE_ANY_EXHDR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN154"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN155"><span class='Ref_To_Local'>idx</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<a name="LN162"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN163"><span class='Ref_to_Func'>hstore_exists_any</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN164"></a><span class='Declare_Function'>hstore_exists_any</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN166"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>hs</span> <span class='Operator'>= </span><a href="hstore.h.html#LN153"><span class='Ref_to_Macro'>PG_GETARG_HS</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN167"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>keys</span> <span class='Operator'>= </span><a href="../../src/include/utils/array.h.html#LN243"><span class='Ref_to_Macro'>PG_GETARG_ARRAYTYPE_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN168"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>nkeys</span><span class='Delimiter'>; 
</span><a name="LN169"></a>    <a href="hstore.h.html#LN160"><span class='Ref_to_Typedef'>Pairs</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>key_pairs</span> <span class='Operator'>= </span><a href="hstore_op.c.html#LN72"><span class='Ref_to_Func'>hstoreArrayToPairs</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN167"><span class='Ref_To_Local'>keys</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="hstore_op.c.html#LN168"><span class='Ref_To_Local'>nkeys</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN170"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN171"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>lowbound</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN172"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>res</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * we exploit the fact that the pairs list is already sorted into strictly 
     * increasing order to narrow the hstoreFindKey search; each search can 
     * start one entry past the previous "found" entry, or at the lower bound 
     * of the last search. 
     */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN170"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="hstore_op.c.html#LN170"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="hstore_op.c.html#LN168"><span class='Ref_To_Local'>nkeys</span></a><span class='Delimiter'>; </span><a href="hstore_op.c.html#LN170"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN182"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>idx</span> <span class='Operator'>= </span><a href="hstore_op.c.html#LN35"><span class='Ref_to_Func'>hstoreFindKey</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN166"><span class='Ref_To_Local'>hs</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="hstore_op.c.html#LN171"><span class='Ref_To_Local'>lowbound</span></a><span class='Delimiter'>, 
</span>                                      <a href="hstore_op.c.html#LN169"><span class='Ref_To_Local'>key_pairs</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN170"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="hstore.h.html#LN162"><span class='Ref_to_Member'>key</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN169"><span class='Ref_To_Local'>key_pairs</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN170"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="hstore.h.html#LN164"><span class='Ref_to_Member'>keylen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN182"><span class='Ref_To_Local'>idx</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="hstore_op.c.html#LN172"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../src/include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN172"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end hstore_exists_any &raquo; </span> 
 
 
<a name="LN196"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN197"><span class='Ref_to_Func'>hstore_exists_all</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN198"></a><span class='Declare_Function'>hstore_exists_all</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN200"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>hs</span> <span class='Operator'>= </span><a href="hstore.h.html#LN153"><span class='Ref_to_Macro'>PG_GETARG_HS</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN201"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>keys</span> <span class='Operator'>= </span><a href="../../src/include/utils/array.h.html#LN243"><span class='Ref_to_Macro'>PG_GETARG_ARRAYTYPE_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN202"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>nkeys</span><span class='Delimiter'>; 
</span><a name="LN203"></a>    <a href="hstore.h.html#LN160"><span class='Ref_to_Typedef'>Pairs</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>key_pairs</span> <span class='Operator'>= </span><a href="hstore_op.c.html#LN72"><span class='Ref_to_Func'>hstoreArrayToPairs</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN201"><span class='Ref_To_Local'>keys</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="hstore_op.c.html#LN202"><span class='Ref_To_Local'>nkeys</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN204"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN205"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>lowbound</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN206"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>res</span> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * we exploit the fact that the pairs list is already sorted into strictly 
     * increasing order to narrow the hstoreFindKey search; each search can 
     * start one entry past the previous "found" entry, or at the lower bound 
     * of the last search. 
     */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN204"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="hstore_op.c.html#LN204"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="hstore_op.c.html#LN202"><span class='Ref_To_Local'>nkeys</span></a><span class='Delimiter'>; </span><a href="hstore_op.c.html#LN204"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN216"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>idx</span> <span class='Operator'>= </span><a href="hstore_op.c.html#LN35"><span class='Ref_to_Func'>hstoreFindKey</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN200"><span class='Ref_To_Local'>hs</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="hstore_op.c.html#LN205"><span class='Ref_To_Local'>lowbound</span></a><span class='Delimiter'>, 
</span>                                      <a href="hstore_op.c.html#LN203"><span class='Ref_To_Local'>key_pairs</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN204"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="hstore.h.html#LN162"><span class='Ref_to_Member'>key</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN203"><span class='Ref_To_Local'>key_pairs</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN204"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="hstore.h.html#LN164"><span class='Ref_to_Member'>keylen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN216"><span class='Ref_To_Local'>idx</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="hstore_op.c.html#LN206"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../src/include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN206"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end hstore_exists_all &raquo; </span> 
 
 
<a name="LN230"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN231"><span class='Ref_to_Func'>hstore_defined</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN232"></a><span class='Declare_Function'>hstore_defined</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN234"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>hs</span> <span class='Operator'>= </span><a href="hstore.h.html#LN153"><span class='Ref_to_Macro'>PG_GETARG_HS</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN235"></a>    <a href="../seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>key</span> <span class='Operator'>= </span><a href="../../src/include/fmgr.h.html#LN272"><span class='Ref_to_Macro'>PG_GETARG_TEXT_PP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN236"></a>    <a href="hstore.h.html#LN17"><span class='Ref_to_Typedef'>HEntry</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>entries</span> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN234"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN237"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>idx</span> <span class='Operator'>= </span><a href="hstore_op.c.html#LN35"><span class='Ref_to_Func'>hstoreFindKey</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN234"><span class='Ref_To_Local'>hs</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                                    <a href="../../src/include/postgres.h.html#LN346"><span class='Ref_to_Macro'>VARDATA_ANY</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN235"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN339"><span class='Ref_to_Macro'>VARSIZE_ANY_EXHDR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN235"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span><a name="LN239"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>res</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN237"><span class='Ref_To_Local'>idx</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span> <span class='Operator'>&& !</span><a href="hstore.h.html#LN82"><span class='Ref_to_Macro'>HSTORE_VALISNULL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN236"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN237"><span class='Ref_To_Local'>idx</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN239"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<a name="LN245"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN246"><span class='Ref_to_Func'>hstore_delete</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN247"></a><span class='Declare_Function'>hstore_delete</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN249"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>hs</span> <span class='Operator'>= </span><a href="hstore.h.html#LN153"><span class='Ref_to_Macro'>PG_GETARG_HS</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN250"></a>    <a href="../seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>key</span> <span class='Operator'>= </span><a href="../../src/include/fmgr.h.html#LN272"><span class='Ref_to_Macro'>PG_GETARG_TEXT_PP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN251"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>keyptr</span> <span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN346"><span class='Ref_to_Macro'>VARDATA_ANY</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN250"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN252"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>keylen</span> <span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN339"><span class='Ref_to_Macro'>VARSIZE_ANY_EXHDR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN250"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN253"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>out</span> <span class='Operator'>= </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN249"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span><a name="LN254"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>bufs</span><span class='Delimiter'>, 
</span><a name="LN255"></a>               <span class='Operator'>*</span><span class='Declare_Local'>bufd</span><span class='Delimiter'>, 
</span><a name="LN256"></a>               <span class='Operator'>*</span><span class='Declare_Local'>ptrd</span><span class='Delimiter'>; 
</span><a name="LN257"></a>    <a href="hstore.h.html#LN17"><span class='Ref_to_Typedef'>HEntry</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>es</span><span class='Delimiter'>, 
</span><a name="LN258"></a>               <span class='Operator'>*</span><span class='Declare_Local'>ed</span><span class='Delimiter'>; 
</span><a name="LN259"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN260"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>count</span> <span class='Operator'>= </span><a href="hstore.h.html#LN60"><span class='Ref_to_Macro'>HS_COUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN249"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN261"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>outcount</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN253"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN249"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="hstore.h.html#LN61"><span class='Ref_to_Macro'>HS_SETCOUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN253"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN260"><span class='Ref_To_Local'>count</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* temporary! */ 
</span> 
    <a href="hstore_op.c.html#LN254"><span class='Ref_To_Local'>bufs</span></a> <span class='Operator'>= </span><a href="hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN249"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN257"><span class='Ref_To_Local'>es</span></a> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN249"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN255"><span class='Ref_To_Local'>bufd</span></a> <span class='Operator'>= </span><a href="hstore_op.c.html#LN256"><span class='Ref_To_Local'>ptrd</span></a> <span class='Operator'>= </span><a href="hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN253"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN258"><span class='Ref_To_Local'>ed</span></a> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN253"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN259"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="hstore_op.c.html#LN259"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="hstore_op.c.html#LN260"><span class='Ref_To_Local'>count</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="hstore_op.c.html#LN259"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN273"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span> <span class='Operator'>= </span><a href="hstore.h.html#LN80"><span class='Ref_to_Macro'>HSTORE_KEYLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN257"><span class='Ref_To_Local'>es</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN259"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN274"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>ptrs</span> <span class='Operator'>= </span><a href="hstore.h.html#LN78"><span class='Ref_to_Macro'>HSTORE_KEY</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN257"><span class='Ref_To_Local'>es</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN254"><span class='Ref_To_Local'>bufs</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN259"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN273"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>== </span><a href="hstore_op.c.html#LN252"><span class='Ref_To_Local'>keylen</span></a> <span class='Operator'>&& </span>memcmp<span class='Parentheses'>(</span><a href="hstore_op.c.html#LN274"><span class='Ref_To_Local'>ptrs</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN251"><span class='Ref_To_Local'>keyptr</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN252"><span class='Ref_To_Local'>keylen</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN278"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>vallen</span> <span class='Operator'>= </span><a href="hstore.h.html#LN81"><span class='Ref_to_Macro'>HSTORE_VALLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN257"><span class='Ref_To_Local'>es</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN259"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="hstore.h.html#LN98"><span class='Ref_to_Macro'>HS_COPYITEM</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN258"><span class='Ref_To_Local'>ed</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN255"><span class='Ref_To_Local'>bufd</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN256"><span class='Ref_To_Local'>ptrd</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN274"><span class='Ref_To_Local'>ptrs</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN273"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN278"><span class='Ref_To_Local'>vallen</span></a><span class='Delimiter'>, 
</span>                        <a href="hstore.h.html#LN82"><span class='Ref_to_Macro'>HSTORE_VALISNULL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN257"><span class='Ref_To_Local'>es</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN259"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Operator'>++</span><a href="hstore_op.c.html#LN261"><span class='Ref_To_Local'>outcount</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="hstore.h.html#LN128"><span class='Ref_to_Macro'>HS_FINALIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN253"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN261"><span class='Ref_To_Local'>outcount</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN255"><span class='Ref_To_Local'>bufd</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN256"><span class='Ref_To_Local'>ptrd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN253"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end hstore_delete &raquo; </span> 
 
 
<a name="LN292"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN293"><span class='Ref_to_Func'>hstore_delete_array</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN294"></a><span class='Declare_Function'>hstore_delete_array</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN296"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>hs</span> <span class='Operator'>= </span><a href="hstore.h.html#LN153"><span class='Ref_to_Macro'>PG_GETARG_HS</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN297"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>out</span> <span class='Operator'>= </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN296"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span><a name="LN298"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>hs_count</span> <span class='Operator'>= </span><a href="hstore.h.html#LN60"><span class='Ref_to_Macro'>HS_COUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN296"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN299"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>ps</span><span class='Delimiter'>, 
</span><a name="LN300"></a>               <span class='Operator'>*</span><span class='Declare_Local'>bufd</span><span class='Delimiter'>, 
</span><a name="LN301"></a>               <span class='Operator'>*</span><span class='Declare_Local'>pd</span><span class='Delimiter'>; 
</span><a name="LN302"></a>    <a href="hstore.h.html#LN17"><span class='Ref_to_Typedef'>HEntry</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>es</span><span class='Delimiter'>, 
</span><a name="LN303"></a>               <span class='Operator'>*</span><span class='Declare_Local'>ed</span><span class='Delimiter'>; 
</span><a name="LN304"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>, 
</span><a name="LN305"></a>                <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span><a name="LN306"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>outcount</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN307"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>key_array</span> <span class='Operator'>= </span><a href="../../src/include/utils/array.h.html#LN243"><span class='Ref_to_Macro'>PG_GETARG_ARRAYTYPE_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN308"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>nkeys</span><span class='Delimiter'>; 
</span><a name="LN309"></a>    <a href="hstore.h.html#LN160"><span class='Ref_to_Typedef'>Pairs</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>key_pairs</span> <span class='Operator'>= </span><a href="hstore_op.c.html#LN72"><span class='Ref_to_Func'>hstoreArrayToPairs</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN307"><span class='Ref_To_Local'>key_array</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="hstore_op.c.html#LN308"><span class='Ref_To_Local'>nkeys</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN297"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN296"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="hstore.h.html#LN61"><span class='Ref_to_Macro'>HS_SETCOUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN297"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN298"><span class='Ref_To_Local'>hs_count</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><span class='Comment_Single_Line'>/* temporary! */ 
</span> 
    <a href="hstore_op.c.html#LN299"><span class='Ref_To_Local'>ps</span></a> <span class='Operator'>= </span><a href="hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN296"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN302"><span class='Ref_To_Local'>es</span></a> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN296"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN300"><span class='Ref_To_Local'>bufd</span></a> <span class='Operator'>= </span><a href="hstore_op.c.html#LN301"><span class='Ref_To_Local'>pd</span></a> <span class='Operator'>= </span><a href="hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN297"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN303"><span class='Ref_To_Local'>ed</span></a> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN297"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN308"><span class='Ref_To_Local'>nkeys</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* return a copy of the input, unchanged */ 
</span>        memcpy<span class='Parentheses'>(</span><a href="hstore_op.c.html#LN297"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN296"><span class='Ref_To_Local'>hs</span></a><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN296"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="hstore.h.html#LN142"><span class='Ref_to_Macro'>HS_FIXSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN297"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN298"><span class='Ref_To_Local'>hs_count</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="hstore.h.html#LN61"><span class='Ref_to_Macro'>HS_SETCOUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN297"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN298"><span class='Ref_To_Local'>hs_count</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN297"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * this is in effect a merge between hs and key_pairs, both of which are 
     * already sorted by (keylen,key); we take keys from hs only 
     */ 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN304"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="hstore_op.c.html#LN305"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="hstore_op.c.html#LN304"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="hstore_op.c.html#LN298"><span class='Ref_To_Local'>hs_count</span></a><span class='Delimiter'>;</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN335"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>difference</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN305"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&GT;= </span><a href="hstore_op.c.html#LN308"><span class='Ref_To_Local'>nkeys</span></a><span class='Parentheses'>) 
</span>            <a href="hstore_op.c.html#LN335"><span class='Ref_To_Local'>difference</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span><a name="LN341"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>skeylen</span> <span class='Operator'>= </span><a href="hstore.h.html#LN80"><span class='Ref_to_Macro'>HSTORE_KEYLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN302"><span class='Ref_To_Local'>es</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN304"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN341"><span class='Ref_To_Local'>skeylen</span></a> <span class='Operator'>== </span><a href="hstore_op.c.html#LN309"><span class='Ref_To_Local'>key_pairs</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN305"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="hstore.h.html#LN164"><span class='Ref_to_Member'>keylen</span></a><span class='Parentheses'>) 
</span>                <a href="hstore_op.c.html#LN335"><span class='Ref_To_Local'>difference</span></a> <span class='Operator'>= </span>memcmp<span class='Parentheses'>(</span><a href="hstore.h.html#LN78"><span class='Ref_to_Macro'>HSTORE_KEY</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN302"><span class='Ref_To_Local'>es</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN299"><span class='Ref_To_Local'>ps</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN304"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                    <a href="hstore_op.c.html#LN309"><span class='Ref_To_Local'>key_pairs</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN305"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="hstore.h.html#LN162"><span class='Ref_to_Member'>key</span></a><span class='Delimiter'>, 
</span>                                    <a href="hstore_op.c.html#LN309"><span class='Ref_To_Local'>key_pairs</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN305"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="hstore.h.html#LN164"><span class='Ref_to_Member'>keylen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="hstore_op.c.html#LN335"><span class='Ref_To_Local'>difference</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN341"><span class='Ref_To_Local'>skeylen</span></a> <span class='Operator'>&GT; </span><a href="hstore_op.c.html#LN309"><span class='Ref_To_Local'>key_pairs</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN305"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="hstore.h.html#LN164"><span class='Ref_to_Member'>keylen</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='Number'>1</span> <span class='Operator'>: -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN335"><span class='Ref_To_Local'>difference</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Operator'>++</span><a href="hstore_op.c.html#LN305"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN335"><span class='Ref_To_Local'>difference</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Operator'>++</span><a href="hstore_op.c.html#LN304"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>, </span><span class='Operator'>++</span><a href="hstore_op.c.html#LN305"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="hstore.h.html#LN98"><span class='Ref_to_Macro'>HS_COPYITEM</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN303"><span class='Ref_To_Local'>ed</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN300"><span class='Ref_To_Local'>bufd</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN301"><span class='Ref_To_Local'>pd</span></a><span class='Delimiter'>, 
</span>                        <a href="hstore.h.html#LN78"><span class='Ref_to_Macro'>HSTORE_KEY</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN302"><span class='Ref_To_Local'>es</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN299"><span class='Ref_To_Local'>ps</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN304"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="hstore.h.html#LN80"><span class='Ref_to_Macro'>HSTORE_KEYLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN302"><span class='Ref_To_Local'>es</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN304"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                        <a href="hstore.h.html#LN81"><span class='Ref_to_Macro'>HSTORE_VALLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN302"><span class='Ref_To_Local'>es</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN304"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="hstore.h.html#LN82"><span class='Ref_to_Macro'>HSTORE_VALISNULL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN302"><span class='Ref_To_Local'>es</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN304"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Operator'>++</span><a href="hstore_op.c.html#LN306"><span class='Ref_To_Local'>outcount</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>++</span><a href="hstore_op.c.html#LN304"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=j=0;i&LT;hs_count; &raquo; </span> 
 
    <a href="hstore.h.html#LN128"><span class='Ref_to_Macro'>HS_FINALIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN297"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN306"><span class='Ref_To_Local'>outcount</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN300"><span class='Ref_To_Local'>bufd</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN301"><span class='Ref_To_Local'>pd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN297"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end hstore_delete_array &raquo; </span> 
 
 
<a name="LN371"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN372"><span class='Ref_to_Func'>hstore_delete_hstore</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN373"></a><span class='Declare_Function'>hstore_delete_hstore</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN375"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>hs</span> <span class='Operator'>= </span><a href="hstore.h.html#LN153"><span class='Ref_to_Macro'>PG_GETARG_HS</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN376"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>hs2</span> <span class='Operator'>= </span><a href="hstore.h.html#LN153"><span class='Ref_to_Macro'>PG_GETARG_HS</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN377"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>out</span> <span class='Operator'>= </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN375"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span><a name="LN378"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>hs_count</span> <span class='Operator'>= </span><a href="hstore.h.html#LN60"><span class='Ref_to_Macro'>HS_COUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN375"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN379"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>hs2_count</span> <span class='Operator'>= </span><a href="hstore.h.html#LN60"><span class='Ref_to_Macro'>HS_COUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN376"><span class='Ref_To_Local'>hs2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN380"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>ps</span><span class='Delimiter'>, 
</span><a name="LN381"></a>               <span class='Operator'>*</span><span class='Declare_Local'>ps2</span><span class='Delimiter'>, 
</span><a name="LN382"></a>               <span class='Operator'>*</span><span class='Declare_Local'>bufd</span><span class='Delimiter'>, 
</span><a name="LN383"></a>               <span class='Operator'>*</span><span class='Declare_Local'>pd</span><span class='Delimiter'>; 
</span><a name="LN384"></a>    <a href="hstore.h.html#LN17"><span class='Ref_to_Typedef'>HEntry</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>es</span><span class='Delimiter'>, 
</span><a name="LN385"></a>               <span class='Operator'>*</span><span class='Declare_Local'>es2</span><span class='Delimiter'>, 
</span><a name="LN386"></a>               <span class='Operator'>*</span><span class='Declare_Local'>ed</span><span class='Delimiter'>; 
</span><a name="LN387"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>, 
</span><a name="LN388"></a>                <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span><a name="LN389"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>outcount</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN377"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN375"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="hstore.h.html#LN61"><span class='Ref_to_Macro'>HS_SETCOUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN377"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN378"><span class='Ref_To_Local'>hs_count</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><span class='Comment_Single_Line'>/* temporary! */ 
</span> 
    <a href="hstore_op.c.html#LN380"><span class='Ref_To_Local'>ps</span></a> <span class='Operator'>= </span><a href="hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN375"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN384"><span class='Ref_To_Local'>es</span></a> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN375"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN381"><span class='Ref_To_Local'>ps2</span></a> <span class='Operator'>= </span><a href="hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN376"><span class='Ref_To_Local'>hs2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN385"><span class='Ref_To_Local'>es2</span></a> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN376"><span class='Ref_To_Local'>hs2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN382"><span class='Ref_To_Local'>bufd</span></a> <span class='Operator'>= </span><a href="hstore_op.c.html#LN383"><span class='Ref_To_Local'>pd</span></a> <span class='Operator'>= </span><a href="hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN377"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN386"><span class='Ref_To_Local'>ed</span></a> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN377"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN379"><span class='Ref_To_Local'>hs2_count</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* return a copy of the input, unchanged */ 
</span>        memcpy<span class='Parentheses'>(</span><a href="hstore_op.c.html#LN377"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN375"><span class='Ref_To_Local'>hs</span></a><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN375"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="hstore.h.html#LN142"><span class='Ref_to_Macro'>HS_FIXSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN377"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN378"><span class='Ref_To_Local'>hs_count</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="hstore.h.html#LN61"><span class='Ref_to_Macro'>HS_SETCOUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN377"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN378"><span class='Ref_To_Local'>hs_count</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN377"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * this is in effect a merge between hs and hs2, both of which are already 
     * sorted by (keylen,key); we take keys from hs only; for equal keys, we 
     * take the value from hs unless the values are equal 
     */ 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN387"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="hstore_op.c.html#LN388"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="hstore_op.c.html#LN387"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="hstore_op.c.html#LN378"><span class='Ref_To_Local'>hs_count</span></a><span class='Delimiter'>;</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN418"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>difference</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN388"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&GT;= </span><a href="hstore_op.c.html#LN379"><span class='Ref_To_Local'>hs2_count</span></a><span class='Parentheses'>) 
</span>            <a href="hstore_op.c.html#LN418"><span class='Ref_To_Local'>difference</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span><a name="LN424"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>skeylen</span> <span class='Operator'>= </span><a href="hstore.h.html#LN80"><span class='Ref_to_Macro'>HSTORE_KEYLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN384"><span class='Ref_To_Local'>es</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN387"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN425"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>s2keylen</span> <span class='Operator'>= </span><a href="hstore.h.html#LN80"><span class='Ref_to_Macro'>HSTORE_KEYLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN385"><span class='Ref_To_Local'>es2</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN388"><span class='Ref_To_Local'>j</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN424"><span class='Ref_To_Local'>skeylen</span></a> <span class='Operator'>== </span><a href="hstore_op.c.html#LN425"><span class='Ref_To_Local'>s2keylen</span></a><span class='Parentheses'>) 
</span>                <a href="hstore_op.c.html#LN418"><span class='Ref_To_Local'>difference</span></a> <span class='Operator'>= </span>memcmp<span class='Parentheses'>(</span><a href="hstore.h.html#LN78"><span class='Ref_to_Macro'>HSTORE_KEY</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN384"><span class='Ref_To_Local'>es</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN380"><span class='Ref_To_Local'>ps</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN387"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                    <a href="hstore.h.html#LN78"><span class='Ref_to_Macro'>HSTORE_KEY</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN385"><span class='Ref_To_Local'>es2</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN381"><span class='Ref_To_Local'>ps2</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN388"><span class='Ref_To_Local'>j</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                    <a href="hstore_op.c.html#LN424"><span class='Ref_To_Local'>skeylen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="hstore_op.c.html#LN418"><span class='Ref_To_Local'>difference</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN424"><span class='Ref_To_Local'>skeylen</span></a> <span class='Operator'>&GT; </span><a href="hstore_op.c.html#LN425"><span class='Ref_To_Local'>s2keylen</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='Number'>1</span> <span class='Operator'>: -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN418"><span class='Ref_To_Local'>difference</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Operator'>++</span><a href="hstore_op.c.html#LN388"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN418"><span class='Ref_To_Local'>difference</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN439"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>svallen</span> <span class='Operator'>= </span><a href="hstore.h.html#LN81"><span class='Ref_to_Macro'>HSTORE_VALLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN384"><span class='Ref_To_Local'>es</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN387"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN440"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>snullval</span> <span class='Operator'>= </span><a href="hstore.h.html#LN82"><span class='Ref_to_Macro'>HSTORE_VALISNULL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN384"><span class='Ref_To_Local'>es</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN387"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN440"><span class='Ref_To_Local'>snullval</span></a> <span class='Operator'>!= </span><a href="hstore.h.html#LN82"><span class='Ref_to_Macro'>HSTORE_VALISNULL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN385"><span class='Ref_To_Local'>es2</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN388"><span class='Ref_To_Local'>j</span></a><span class='Parentheses'>)</span> <span class='Operator'>|| 
</span>                <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="hstore_op.c.html#LN440"><span class='Ref_To_Local'>snullval</span></a> <span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN439"><span class='Ref_To_Local'>svallen</span></a> <span class='Operator'>!= </span><a href="hstore.h.html#LN81"><span class='Ref_to_Macro'>HSTORE_VALLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN385"><span class='Ref_To_Local'>es2</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN388"><span class='Ref_To_Local'>j</span></a><span class='Parentheses'>)</span> <span class='Operator'>|| 
</span>                               memcmp<span class='Parentheses'>(</span><a href="hstore.h.html#LN79"><span class='Ref_to_Macro'>HSTORE_VAL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN384"><span class='Ref_To_Local'>es</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN380"><span class='Ref_To_Local'>ps</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN387"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                      <a href="hstore.h.html#LN79"><span class='Ref_to_Macro'>HSTORE_VAL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN385"><span class='Ref_To_Local'>es2</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN381"><span class='Ref_To_Local'>ps2</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN388"><span class='Ref_To_Local'>j</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                      <a href="hstore_op.c.html#LN439"><span class='Ref_To_Local'>svallen</span></a><span class='Parentheses'>)</span> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)))</span> 
            <span class='Delimiter'>{ 
</span>                <a href="hstore.h.html#LN98"><span class='Ref_to_Macro'>HS_COPYITEM</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN386"><span class='Ref_To_Local'>ed</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN382"><span class='Ref_To_Local'>bufd</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN383"><span class='Ref_To_Local'>pd</span></a><span class='Delimiter'>, 
</span>                            <a href="hstore.h.html#LN78"><span class='Ref_to_Macro'>HSTORE_KEY</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN384"><span class='Ref_To_Local'>es</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN380"><span class='Ref_To_Local'>ps</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN387"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="hstore.h.html#LN80"><span class='Ref_to_Macro'>HSTORE_KEYLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN384"><span class='Ref_To_Local'>es</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN387"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                            <a href="hstore_op.c.html#LN439"><span class='Ref_To_Local'>svallen</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN440"><span class='Ref_To_Local'>snullval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Operator'>++</span><a href="hstore_op.c.html#LN389"><span class='Ref_To_Local'>outcount</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Operator'>++</span><a href="hstore_op.c.html#LN387"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>, </span><span class='Operator'>++</span><a href="hstore_op.c.html#LN388"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="hstore.h.html#LN98"><span class='Ref_to_Macro'>HS_COPYITEM</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN386"><span class='Ref_To_Local'>ed</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN382"><span class='Ref_To_Local'>bufd</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN383"><span class='Ref_To_Local'>pd</span></a><span class='Delimiter'>, 
</span>                        <a href="hstore.h.html#LN78"><span class='Ref_to_Macro'>HSTORE_KEY</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN384"><span class='Ref_To_Local'>es</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN380"><span class='Ref_To_Local'>ps</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN387"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="hstore.h.html#LN80"><span class='Ref_to_Macro'>HSTORE_KEYLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN384"><span class='Ref_To_Local'>es</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN387"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                        <a href="hstore.h.html#LN81"><span class='Ref_to_Macro'>HSTORE_VALLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN384"><span class='Ref_To_Local'>es</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN387"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="hstore.h.html#LN82"><span class='Ref_to_Macro'>HSTORE_VALISNULL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN384"><span class='Ref_To_Local'>es</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN387"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Operator'>++</span><a href="hstore_op.c.html#LN389"><span class='Ref_To_Local'>outcount</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>++</span><a href="hstore_op.c.html#LN387"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=j=0;i&LT;hs_count; &raquo; </span> 
 
    <a href="hstore.h.html#LN128"><span class='Ref_to_Macro'>HS_FINALIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN377"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN389"><span class='Ref_To_Local'>outcount</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN382"><span class='Ref_To_Local'>bufd</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN383"><span class='Ref_To_Local'>pd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN377"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end hstore_delete_hstore &raquo; </span> 
 
 
<a name="LN471"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN472"><span class='Ref_to_Func'>hstore_concat</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN473"></a><span class='Declare_Function'>hstore_concat</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN475"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>s1</span> <span class='Operator'>= </span><a href="hstore.h.html#LN153"><span class='Ref_to_Macro'>PG_GETARG_HS</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN476"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>s2</span> <span class='Operator'>= </span><a href="hstore.h.html#LN153"><span class='Ref_to_Macro'>PG_GETARG_HS</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN477"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>out</span> <span class='Operator'>= </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN475"><span class='Ref_To_Local'>s1</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN476"><span class='Ref_To_Local'>s2</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span><a name="LN478"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>ps1</span><span class='Delimiter'>, 
</span><a name="LN479"></a>               <span class='Operator'>*</span><span class='Declare_Local'>ps2</span><span class='Delimiter'>, 
</span><a name="LN480"></a>               <span class='Operator'>*</span><span class='Declare_Local'>bufd</span><span class='Delimiter'>, 
</span><a name="LN481"></a>               <span class='Operator'>*</span><span class='Declare_Local'>pd</span><span class='Delimiter'>; 
</span><a name="LN482"></a>    <a href="hstore.h.html#LN17"><span class='Ref_to_Typedef'>HEntry</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>es1</span><span class='Delimiter'>, 
</span><a name="LN483"></a>               <span class='Operator'>*</span><span class='Declare_Local'>es2</span><span class='Delimiter'>, 
</span><a name="LN484"></a>               <span class='Operator'>*</span><span class='Declare_Local'>ed</span><span class='Delimiter'>; 
</span><a name="LN485"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>s1idx</span><span class='Delimiter'>; 
</span><a name="LN486"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>s2idx</span><span class='Delimiter'>; 
</span><a name="LN487"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>s1count</span> <span class='Operator'>= </span><a href="hstore.h.html#LN60"><span class='Ref_to_Macro'>HS_COUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN475"><span class='Ref_To_Local'>s1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN488"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>s2count</span> <span class='Operator'>= </span><a href="hstore.h.html#LN60"><span class='Ref_to_Macro'>HS_COUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN476"><span class='Ref_To_Local'>s2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN489"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>outcount</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN477"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN475"><span class='Ref_To_Local'>s1</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN476"><span class='Ref_To_Local'>s2</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="hstore.h.html#LN70"><span class='Ref_to_Const'>HSHRDSIZE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="hstore.h.html#LN61"><span class='Ref_to_Macro'>HS_SETCOUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN477"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN487"><span class='Ref_To_Local'>s1count</span></a> <span class='Operator'>+ </span><a href="hstore_op.c.html#LN488"><span class='Ref_To_Local'>s2count</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN487"><span class='Ref_To_Local'>s1count</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* return a copy of the input, unchanged */ 
</span>        memcpy<span class='Parentheses'>(</span><a href="hstore_op.c.html#LN477"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN476"><span class='Ref_To_Local'>s2</span></a><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN476"><span class='Ref_To_Local'>s2</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="hstore.h.html#LN142"><span class='Ref_to_Macro'>HS_FIXSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN477"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN488"><span class='Ref_To_Local'>s2count</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="hstore.h.html#LN61"><span class='Ref_to_Macro'>HS_SETCOUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN477"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN488"><span class='Ref_To_Local'>s2count</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN477"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN488"><span class='Ref_To_Local'>s2count</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* return a copy of the input, unchanged */ 
</span>        memcpy<span class='Parentheses'>(</span><a href="hstore_op.c.html#LN477"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN475"><span class='Ref_To_Local'>s1</span></a><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN475"><span class='Ref_To_Local'>s1</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="hstore.h.html#LN142"><span class='Ref_to_Macro'>HS_FIXSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN477"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN487"><span class='Ref_To_Local'>s1count</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="hstore.h.html#LN61"><span class='Ref_to_Macro'>HS_SETCOUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN477"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN487"><span class='Ref_To_Local'>s1count</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN477"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="hstore_op.c.html#LN478"><span class='Ref_To_Local'>ps1</span></a> <span class='Operator'>= </span><a href="hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN475"><span class='Ref_To_Local'>s1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN479"><span class='Ref_To_Local'>ps2</span></a> <span class='Operator'>= </span><a href="hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN476"><span class='Ref_To_Local'>s2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN480"><span class='Ref_To_Local'>bufd</span></a> <span class='Operator'>= </span><a href="hstore_op.c.html#LN481"><span class='Ref_To_Local'>pd</span></a> <span class='Operator'>= </span><a href="hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN477"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN482"><span class='Ref_To_Local'>es1</span></a> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN475"><span class='Ref_To_Local'>s1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN483"><span class='Ref_To_Local'>es2</span></a> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN476"><span class='Ref_To_Local'>s2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN484"><span class='Ref_To_Local'>ed</span></a> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN477"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * this is in effect a merge between s1 and s2, both of which are already 
     * sorted by (keylen,key); we take s2 for equal keys 
     */ 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN485"><span class='Ref_To_Local'>s1idx</span></a> <span class='Operator'>= </span><a href="hstore_op.c.html#LN486"><span class='Ref_To_Local'>s2idx</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="hstore_op.c.html#LN485"><span class='Ref_To_Local'>s1idx</span></a> <span class='Operator'>&LT; </span><a href="hstore_op.c.html#LN487"><span class='Ref_To_Local'>s1count</span></a> <span class='Operator'>|| </span><a href="hstore_op.c.html#LN486"><span class='Ref_To_Local'>s2idx</span></a> <span class='Operator'>&LT; </span><a href="hstore_op.c.html#LN488"><span class='Ref_To_Local'>s2count</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="hstore_op.c.html#LN489"><span class='Ref_To_Local'>outcount</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN526"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>difference</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN485"><span class='Ref_To_Local'>s1idx</span></a> <span class='Operator'>&GT;= </span><a href="hstore_op.c.html#LN487"><span class='Ref_To_Local'>s1count</span></a><span class='Parentheses'>) 
</span>            <a href="hstore_op.c.html#LN526"><span class='Ref_To_Local'>difference</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN486"><span class='Ref_To_Local'>s2idx</span></a> <span class='Operator'>&GT;= </span><a href="hstore_op.c.html#LN488"><span class='Ref_To_Local'>s2count</span></a><span class='Parentheses'>) 
</span>            <a href="hstore_op.c.html#LN526"><span class='Ref_To_Local'>difference</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span><a name="LN534"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>s1keylen</span> <span class='Operator'>= </span><a href="hstore.h.html#LN80"><span class='Ref_to_Macro'>HSTORE_KEYLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN482"><span class='Ref_To_Local'>es1</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN485"><span class='Ref_To_Local'>s1idx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN535"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>s2keylen</span> <span class='Operator'>= </span><a href="hstore.h.html#LN80"><span class='Ref_to_Macro'>HSTORE_KEYLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN483"><span class='Ref_To_Local'>es2</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN486"><span class='Ref_To_Local'>s2idx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN534"><span class='Ref_To_Local'>s1keylen</span></a> <span class='Operator'>== </span><a href="hstore_op.c.html#LN535"><span class='Ref_To_Local'>s2keylen</span></a><span class='Parentheses'>) 
</span>                <a href="hstore_op.c.html#LN526"><span class='Ref_To_Local'>difference</span></a> <span class='Operator'>= </span>memcmp<span class='Parentheses'>(</span><a href="hstore.h.html#LN78"><span class='Ref_to_Macro'>HSTORE_KEY</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN482"><span class='Ref_To_Local'>es1</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN478"><span class='Ref_To_Local'>ps1</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN485"><span class='Ref_To_Local'>s1idx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                    <a href="hstore.h.html#LN78"><span class='Ref_to_Macro'>HSTORE_KEY</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN483"><span class='Ref_To_Local'>es2</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN479"><span class='Ref_To_Local'>ps2</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN486"><span class='Ref_To_Local'>s2idx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                    <a href="hstore_op.c.html#LN534"><span class='Ref_To_Local'>s1keylen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="hstore_op.c.html#LN526"><span class='Ref_To_Local'>difference</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN534"><span class='Ref_To_Local'>s1keylen</span></a> <span class='Operator'>&GT; </span><a href="hstore_op.c.html#LN535"><span class='Ref_To_Local'>s2keylen</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='Number'>1</span> <span class='Operator'>: -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN526"><span class='Ref_To_Local'>difference</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="hstore.h.html#LN98"><span class='Ref_to_Macro'>HS_COPYITEM</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN484"><span class='Ref_To_Local'>ed</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN480"><span class='Ref_To_Local'>bufd</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN481"><span class='Ref_To_Local'>pd</span></a><span class='Delimiter'>, 
</span>                      <a href="hstore.h.html#LN78"><span class='Ref_to_Macro'>HSTORE_KEY</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN483"><span class='Ref_To_Local'>es2</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN479"><span class='Ref_To_Local'>ps2</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN486"><span class='Ref_To_Local'>s2idx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="hstore.h.html#LN80"><span class='Ref_to_Macro'>HSTORE_KEYLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN483"><span class='Ref_To_Local'>es2</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN486"><span class='Ref_To_Local'>s2idx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                    <a href="hstore.h.html#LN81"><span class='Ref_to_Macro'>HSTORE_VALLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN483"><span class='Ref_To_Local'>es2</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN486"><span class='Ref_To_Local'>s2idx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="hstore.h.html#LN82"><span class='Ref_to_Macro'>HSTORE_VALISNULL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN483"><span class='Ref_To_Local'>es2</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN486"><span class='Ref_To_Local'>s2idx</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Operator'>++</span><a href="hstore_op.c.html#LN486"><span class='Ref_To_Local'>s2idx</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN526"><span class='Ref_To_Local'>difference</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                <span class='Operator'>++</span><a href="hstore_op.c.html#LN485"><span class='Ref_To_Local'>s1idx</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="hstore.h.html#LN98"><span class='Ref_to_Macro'>HS_COPYITEM</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN484"><span class='Ref_To_Local'>ed</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN480"><span class='Ref_To_Local'>bufd</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN481"><span class='Ref_To_Local'>pd</span></a><span class='Delimiter'>, 
</span>                      <a href="hstore.h.html#LN78"><span class='Ref_to_Macro'>HSTORE_KEY</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN482"><span class='Ref_To_Local'>es1</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN478"><span class='Ref_To_Local'>ps1</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN485"><span class='Ref_To_Local'>s1idx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="hstore.h.html#LN80"><span class='Ref_to_Macro'>HSTORE_KEYLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN482"><span class='Ref_To_Local'>es1</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN485"><span class='Ref_To_Local'>s1idx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                    <a href="hstore.h.html#LN81"><span class='Ref_to_Macro'>HSTORE_VALLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN482"><span class='Ref_To_Local'>es1</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN485"><span class='Ref_To_Local'>s1idx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="hstore.h.html#LN82"><span class='Ref_to_Macro'>HSTORE_VALISNULL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN482"><span class='Ref_To_Local'>es1</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN485"><span class='Ref_To_Local'>s1idx</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Operator'>++</span><a href="hstore_op.c.html#LN485"><span class='Ref_To_Local'>s1idx</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for s1idx=s2idx=0;s1idx&LT;s... &raquo; </span> 
 
    <a href="hstore.h.html#LN128"><span class='Ref_to_Macro'>HS_FINALIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN477"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN489"><span class='Ref_To_Local'>outcount</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN480"><span class='Ref_To_Local'>bufd</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN481"><span class='Ref_To_Local'>pd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN477"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end hstore_concat &raquo; </span> 
 
 
<a name="LN569"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN570"><span class='Ref_to_Func'>hstore_slice_to_array</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN571"></a><span class='Declare_Function'>hstore_slice_to_array</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN573"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>hs</span> <span class='Operator'>= </span><a href="hstore.h.html#LN153"><span class='Ref_to_Macro'>PG_GETARG_HS</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN574"></a>    <a href="hstore.h.html#LN17"><span class='Ref_to_Typedef'>HEntry</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>entries</span> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN573"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN575"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>ptr</span> <span class='Operator'>= </span><a href="hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN573"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN576"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>key_array</span> <span class='Operator'>= </span><a href="../../src/include/utils/array.h.html#LN243"><span class='Ref_to_Macro'>PG_GETARG_ARRAYTYPE_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN577"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>aout</span><span class='Delimiter'>; 
</span><a name="LN578"></a>    <a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>key_datums</span><span class='Delimiter'>; 
</span><a name="LN579"></a>    <span class='Keyword'>bool</span>       <span class='Operator'>*</span><span class='Declare_Local'>key_nulls</span><span class='Delimiter'>; 
</span><a name="LN580"></a>    <a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>out_datums</span><span class='Delimiter'>; 
</span><a name="LN581"></a>    <span class='Keyword'>bool</span>       <span class='Operator'>*</span><span class='Declare_Local'>out_nulls</span><span class='Delimiter'>; 
</span><a name="LN582"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>key_count</span><span class='Delimiter'>; 
</span><a name="LN583"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/utils/array.h.html#LN382"><span class='Ref_to_Proto'>deconstruct_array</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN576"><span class='Ref_To_Local'>key_array</span></a><span class='Delimiter'>, 
</span>                      <a href="../../src/interfaces/ecpg/ecpglib/pg_type.h.html#LN26"><span class='Ref_to_Const'>TEXTOID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='String'>'i'</span><span class='Delimiter'>, 
</span>                      <span class='Operator'>&</span><a href="hstore_op.c.html#LN578"><span class='Ref_To_Local'>key_datums</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="hstore_op.c.html#LN579"><span class='Ref_To_Local'>key_nulls</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="hstore_op.c.html#LN582"><span class='Ref_To_Local'>key_count</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN582"><span class='Ref_To_Local'>key_count</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="hstore_op.c.html#LN577"><span class='Ref_To_Local'>aout</span></a> <span class='Operator'>= </span><a href="../../src/include/utils/array.h.html#LN378"><span class='Ref_to_Proto'>construct_empty_array</span></a><span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/ecpglib/pg_type.h.html#LN26"><span class='Ref_to_Const'>TEXTOID</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN577"><span class='Ref_To_Local'>aout</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="hstore_op.c.html#LN580"><span class='Ref_To_Local'>out_datums</span></a> <span class='Operator'>= </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="hstore_op.c.html#LN582"><span class='Ref_To_Local'>key_count</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN581"><span class='Ref_To_Local'>out_nulls</span></a> <span class='Operator'>= </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Keyword'>bool</span><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="hstore_op.c.html#LN582"><span class='Ref_To_Local'>key_count</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN583"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="hstore_op.c.html#LN583"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="hstore_op.c.html#LN582"><span class='Ref_To_Local'>key_count</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="hstore_op.c.html#LN583"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN600"></a>        <a href="../seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>key</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN578"><span class='Ref_To_Local'>key_datums</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN583"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN601"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>idx</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN579"><span class='Ref_To_Local'>key_nulls</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN583"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>            <a href="hstore_op.c.html#LN601"><span class='Ref_To_Local'>idx</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="hstore_op.c.html#LN601"><span class='Ref_To_Local'>idx</span></a> <span class='Operator'>= </span><a href="hstore_op.c.html#LN35"><span class='Ref_to_Func'>hstoreFindKey</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN573"><span class='Ref_To_Local'>hs</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN302"><span class='Ref_to_Macro'>VARDATA</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN600"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN600"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="../../src/include/c.h.html#LN444"><span class='Ref_to_Const'>VARHDRSZ</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN601"><span class='Ref_To_Local'>idx</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="hstore.h.html#LN82"><span class='Ref_to_Macro'>HSTORE_VALISNULL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN574"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN601"><span class='Ref_To_Local'>idx</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="hstore_op.c.html#LN581"><span class='Ref_To_Local'>out_nulls</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN583"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <a href="hstore_op.c.html#LN580"><span class='Ref_To_Local'>out_datums</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN583"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>) </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="hstore_op.c.html#LN580"><span class='Ref_To_Local'>out_datums</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN583"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span> 
                      <a href="../../src/include/utils/builtins.h.html#LN86"><span class='Ref_to_Proto'>cstring_to_text_with_len</span></a><span class='Parentheses'>(</span><a href="hstore.h.html#LN79"><span class='Ref_to_Macro'>HSTORE_VAL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN574"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN575"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN601"><span class='Ref_To_Local'>idx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                               <a href="hstore.h.html#LN81"><span class='Ref_to_Macro'>HSTORE_VALLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN574"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN601"><span class='Ref_To_Local'>idx</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <a href="hstore_op.c.html#LN581"><span class='Ref_To_Local'>out_nulls</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN583"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=0;i&LT;key_count;++i &raquo; </span> 
 
    <a href="hstore_op.c.html#LN577"><span class='Ref_To_Local'>aout</span></a> <span class='Operator'>= </span><a href="../../src/include/utils/array.h.html#LN372"><span class='Ref_to_Proto'>construct_md_array</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN580"><span class='Ref_To_Local'>out_datums</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN581"><span class='Ref_To_Local'>out_nulls</span></a><span class='Delimiter'>, 
</span>                              <a href="../../src/include/utils/array.h.html#LN270"><span class='Ref_to_Macro'>ARR_NDIM</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN576"><span class='Ref_To_Local'>key_array</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                              <a href="../../src/include/utils/array.h.html#LN274"><span class='Ref_to_Macro'>ARR_DIMS</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN576"><span class='Ref_To_Local'>key_array</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                              <a href="../../src/include/utils/array.h.html#LN276"><span class='Ref_to_Macro'>ARR_LBOUND</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN576"><span class='Ref_To_Local'>key_array</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                              <a href="../../src/interfaces/ecpg/ecpglib/pg_type.h.html#LN26"><span class='Ref_to_Const'>TEXTOID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='String'>'i'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN577"><span class='Ref_To_Local'>aout</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end hstore_slice_to_array &raquo; </span> 
 
 
<a name="LN632"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN633"><span class='Ref_to_Func'>hstore_slice_to_hstore</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN634"></a><span class='Declare_Function'>hstore_slice_to_hstore</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN636"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>hs</span> <span class='Operator'>= </span><a href="hstore.h.html#LN153"><span class='Ref_to_Macro'>PG_GETARG_HS</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN637"></a>    <a href="hstore.h.html#LN17"><span class='Ref_to_Typedef'>HEntry</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>entries</span> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN636"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN638"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>ptr</span> <span class='Operator'>= </span><a href="hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN636"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN639"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>key_array</span> <span class='Operator'>= </span><a href="../../src/include/utils/array.h.html#LN243"><span class='Ref_to_Macro'>PG_GETARG_ARRAYTYPE_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN640"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>out</span><span class='Delimiter'>; 
</span><a name="LN641"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>nkeys</span><span class='Delimiter'>; 
</span><a name="LN642"></a>    <a href="hstore.h.html#LN160"><span class='Ref_to_Typedef'>Pairs</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>key_pairs</span> <span class='Operator'>= </span><a href="hstore_op.c.html#LN72"><span class='Ref_to_Func'>hstoreArrayToPairs</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN639"><span class='Ref_To_Local'>key_array</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="hstore_op.c.html#LN641"><span class='Ref_To_Local'>nkeys</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN643"></a>    <a href="hstore.h.html#LN160"><span class='Ref_to_Typedef'>Pairs</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>out_pairs</span><span class='Delimiter'>; 
</span><a name="LN644"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>bufsiz</span><span class='Delimiter'>; 
</span><a name="LN645"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>lastidx</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN646"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN647"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>out_count</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN641"><span class='Ref_To_Local'>nkeys</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="hstore_op.c.html#LN640"><span class='Ref_To_Local'>out</span></a> <span class='Operator'>= </span><a href="hstore.h.html#LN171"><span class='Ref_to_Proto'>hstorePairs</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN640"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* hstoreArrayToPairs() checked overflow */ 
</span>    <a href="hstore_op.c.html#LN643"><span class='Ref_To_Local'>out_pairs</span></a> <span class='Operator'>= </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="hstore.h.html#LN160"><span class='Ref_to_Typedef'>Pairs</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="hstore_op.c.html#LN641"><span class='Ref_To_Local'>nkeys</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN644"><span class='Ref_To_Local'>bufsiz</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * we exploit the fact that the pairs list is already sorted into strictly 
     * increasing order to narrow the hstoreFindKey search; each search can 
     * start one entry past the previous "found" entry, or at the lower bound 
     * of the last search. 
     */ 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN646"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="hstore_op.c.html#LN646"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="hstore_op.c.html#LN641"><span class='Ref_To_Local'>nkeys</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="hstore_op.c.html#LN646"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN668"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>idx</span> <span class='Operator'>= </span><a href="hstore_op.c.html#LN35"><span class='Ref_to_Func'>hstoreFindKey</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN636"><span class='Ref_To_Local'>hs</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="hstore_op.c.html#LN645"><span class='Ref_To_Local'>lastidx</span></a><span class='Delimiter'>, 
</span>                                      <a href="hstore_op.c.html#LN642"><span class='Ref_To_Local'>key_pairs</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN646"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="hstore.h.html#LN162"><span class='Ref_to_Member'>key</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN642"><span class='Ref_To_Local'>key_pairs</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN646"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="hstore.h.html#LN164"><span class='Ref_to_Member'>keylen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN668"><span class='Ref_To_Local'>idx</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="hstore_op.c.html#LN643"><span class='Ref_To_Local'>out_pairs</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN647"><span class='Ref_To_Local'>out_count</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="hstore.h.html#LN162"><span class='Ref_to_Member'>key</span></a> <span class='Operator'>= </span><a href="hstore_op.c.html#LN642"><span class='Ref_To_Local'>key_pairs</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN646"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="hstore.h.html#LN162"><span class='Ref_to_Member'>key</span></a><span class='Delimiter'>; 
</span>            <a href="hstore_op.c.html#LN644"><span class='Ref_To_Local'>bufsiz</span></a> <span class='Operator'>+= </span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN643"><span class='Ref_To_Local'>out_pairs</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN647"><span class='Ref_To_Local'>out_count</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="hstore.h.html#LN164"><span class='Ref_to_Member'>keylen</span></a> <span class='Operator'>= </span><a href="hstore_op.c.html#LN642"><span class='Ref_To_Local'>key_pairs</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN646"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="hstore.h.html#LN164"><span class='Ref_to_Member'>keylen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="hstore_op.c.html#LN643"><span class='Ref_To_Local'>out_pairs</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN647"><span class='Ref_To_Local'>out_count</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="hstore.h.html#LN163"><span class='Ref_to_Member'>val</span></a> <span class='Operator'>= </span><a href="hstore.h.html#LN79"><span class='Ref_to_Macro'>HSTORE_VAL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN637"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN638"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN668"><span class='Ref_To_Local'>idx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="hstore_op.c.html#LN644"><span class='Ref_To_Local'>bufsiz</span></a> <span class='Operator'>+= </span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN643"><span class='Ref_To_Local'>out_pairs</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN647"><span class='Ref_To_Local'>out_count</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="hstore.h.html#LN165"><span class='Ref_to_Member'>vallen</span></a> <span class='Operator'>= </span><a href="hstore.h.html#LN81"><span class='Ref_to_Macro'>HSTORE_VALLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN637"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN668"><span class='Ref_To_Local'>idx</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="hstore_op.c.html#LN643"><span class='Ref_To_Local'>out_pairs</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN647"><span class='Ref_To_Local'>out_count</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="hstore.h.html#LN166"><span class='Ref_to_Member'>isnull</span></a> <span class='Operator'>= </span><a href="hstore.h.html#LN82"><span class='Ref_to_Macro'>HSTORE_VALISNULL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN637"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN668"><span class='Ref_To_Local'>idx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="hstore_op.c.html#LN643"><span class='Ref_To_Local'>out_pairs</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN647"><span class='Ref_To_Local'>out_count</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="hstore.h.html#LN167"><span class='Ref_to_Member'>needfree</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Operator'>++</span><a href="hstore_op.c.html#LN647"><span class='Ref_To_Local'>out_count</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * we don't use uniquePairs here because we know that the pairs list is 
     * already sorted and uniq'ed. 
     */ 
</span> 
    <a href="hstore_op.c.html#LN640"><span class='Ref_To_Local'>out</span></a> <span class='Operator'>= </span><a href="hstore.h.html#LN171"><span class='Ref_to_Proto'>hstorePairs</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN643"><span class='Ref_To_Local'>out_pairs</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN647"><span class='Ref_To_Local'>out_count</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN644"><span class='Ref_To_Local'>bufsiz</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN640"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end hstore_slice_to_hstore &raquo; </span> 
 
 
<a name="LN694"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN695"><span class='Ref_to_Func'>hstore_akeys</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN696"></a><span class='Declare_Function'>hstore_akeys</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN698"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>hs</span> <span class='Operator'>= </span><a href="hstore.h.html#LN153"><span class='Ref_to_Macro'>PG_GETARG_HS</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN699"></a>    <a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>d</span><span class='Delimiter'>; 
</span><a name="LN700"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>a</span><span class='Delimiter'>; 
</span><a name="LN701"></a>    <a href="hstore.h.html#LN17"><span class='Ref_to_Typedef'>HEntry</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>entries</span> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN698"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN702"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>base</span> <span class='Operator'>= </span><a href="hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN698"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN703"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>count</span> <span class='Operator'>= </span><a href="hstore.h.html#LN60"><span class='Ref_to_Macro'>HS_COUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN698"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN704"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN703"><span class='Ref_To_Local'>count</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="hstore_op.c.html#LN700"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="../../src/include/utils/array.h.html#LN378"><span class='Ref_to_Proto'>construct_empty_array</span></a><span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/ecpglib/pg_type.h.html#LN26"><span class='Ref_to_Const'>TEXTOID</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN700"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="hstore_op.c.html#LN699"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="hstore_op.c.html#LN703"><span class='Ref_To_Local'>count</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN704"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="hstore_op.c.html#LN704"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="hstore_op.c.html#LN703"><span class='Ref_To_Local'>count</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="hstore_op.c.html#LN704"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN716"></a>        <a href="../seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>t</span> <span class='Operator'>= </span><a href="../../src/include/utils/builtins.h.html#LN86"><span class='Ref_to_Proto'>cstring_to_text_with_len</span></a><span class='Parentheses'>(</span><a href="hstore.h.html#LN78"><span class='Ref_to_Macro'>HSTORE_KEY</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN701"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN702"><span class='Ref_To_Local'>base</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN704"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                                 <a href="hstore.h.html#LN80"><span class='Ref_to_Macro'>HSTORE_KEYLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN701"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN704"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <a href="hstore_op.c.html#LN699"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN704"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN716"><span class='Ref_To_Local'>t</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="hstore_op.c.html#LN700"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="../../src/include/utils/array.h.html#LN369"><span class='Ref_to_Proto'>construct_array</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN699"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN703"><span class='Ref_To_Local'>count</span></a><span class='Delimiter'>, 
</span>                        <a href="../../src/interfaces/ecpg/ecpglib/pg_type.h.html#LN26"><span class='Ref_to_Const'>TEXTOID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='String'>'i'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN700"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end hstore_akeys &raquo; </span> 
 
 
<a name="LN729"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN730"><span class='Ref_to_Func'>hstore_avals</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN731"></a><span class='Declare_Function'>hstore_avals</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN733"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>hs</span> <span class='Operator'>= </span><a href="hstore.h.html#LN153"><span class='Ref_to_Macro'>PG_GETARG_HS</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN734"></a>    <a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>d</span><span class='Delimiter'>; 
</span><a name="LN735"></a>    <span class='Keyword'>bool</span>       <span class='Operator'>*</span><span class='Declare_Local'>nulls</span><span class='Delimiter'>; 
</span><a name="LN736"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>a</span><span class='Delimiter'>; 
</span><a name="LN737"></a>    <a href="hstore.h.html#LN17"><span class='Ref_to_Typedef'>HEntry</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>entries</span> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN733"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN738"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>base</span> <span class='Operator'>= </span><a href="hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN733"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN739"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>count</span> <span class='Operator'>= </span><a href="hstore.h.html#LN60"><span class='Ref_to_Macro'>HS_COUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN733"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN740"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>lb</span> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span><a name="LN741"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN739"><span class='Ref_To_Local'>count</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="hstore_op.c.html#LN736"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="../../src/include/utils/array.h.html#LN378"><span class='Ref_to_Proto'>construct_empty_array</span></a><span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/ecpglib/pg_type.h.html#LN26"><span class='Ref_to_Const'>TEXTOID</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN736"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="hstore_op.c.html#LN734"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="hstore_op.c.html#LN739"><span class='Ref_To_Local'>count</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN735"><span class='Ref_To_Local'>nulls</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Keyword'>bool</span><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="hstore_op.c.html#LN739"><span class='Ref_To_Local'>count</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN741"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="hstore_op.c.html#LN741"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="hstore_op.c.html#LN739"><span class='Ref_To_Local'>count</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="hstore_op.c.html#LN741"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore.h.html#LN82"><span class='Ref_to_Macro'>HSTORE_VALISNULL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN737"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN741"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="hstore_op.c.html#LN734"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN741"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>) </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <a href="hstore_op.c.html#LN735"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN741"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span><a name="LN761"></a>            <a href="../seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>item</span> <span class='Operator'>= </span><a href="../../src/include/utils/builtins.h.html#LN86"><span class='Ref_to_Proto'>cstring_to_text_with_len</span></a><span class='Parentheses'>(</span><a href="hstore.h.html#LN79"><span class='Ref_to_Macro'>HSTORE_VAL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN737"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN738"><span class='Ref_To_Local'>base</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN741"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                                  <a href="hstore.h.html#LN81"><span class='Ref_to_Macro'>HSTORE_VALLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN737"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN741"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
            <a href="hstore_op.c.html#LN734"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN741"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN761"><span class='Ref_To_Local'>item</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="hstore_op.c.html#LN735"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN741"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="hstore_op.c.html#LN736"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="../../src/include/utils/array.h.html#LN372"><span class='Ref_to_Proto'>construct_md_array</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN734"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN735"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="hstore_op.c.html#LN739"><span class='Ref_To_Local'>count</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="hstore_op.c.html#LN740"><span class='Ref_To_Local'>lb</span></a><span class='Delimiter'>, 
</span>                           <a href="../../src/interfaces/ecpg/ecpglib/pg_type.h.html#LN26"><span class='Ref_to_Const'>TEXTOID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='String'>'i'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN736"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end hstore_avals &raquo; </span> 
 
 
<span class='Keyword'>static </span><a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>* 
</span><a name="LN777"></a><span class='Declare_Function'>hstore_to_array_internal</span><span class='Parentheses'>(</span><a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>hs</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>ndims</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN779"></a>    <a href="hstore.h.html#LN17"><span class='Ref_to_Typedef'>HEntry</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>entries</span> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN777"><span class='Ref_to_Parameter'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN780"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>base</span> <span class='Operator'>= </span><a href="hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN777"><span class='Ref_to_Parameter'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN781"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>count</span> <span class='Operator'>= </span><a href="hstore.h.html#LN60"><span class='Ref_to_Macro'>HS_COUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN777"><span class='Ref_to_Parameter'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN782"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>out_size</span><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Delimiter'>{</span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>}; 
</span><a name="LN783"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>lb</span><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Delimiter'>{</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>}; 
</span><a name="LN784"></a>    <a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>out_datums</span><span class='Delimiter'>; 
</span><a name="LN785"></a>    <span class='Keyword'>bool</span>       <span class='Operator'>*</span><span class='Declare_Local'>out_nulls</span><span class='Delimiter'>; 
</span><a name="LN786"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN777"><span class='Ref_to_Parameter'>ndims</span></a> <span class='Operator'>&LT; </span><span class='Number'>3</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN781"><span class='Ref_To_Local'>count</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="hstore_op.c.html#LN777"><span class='Ref_to_Parameter'>ndims</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="../../src/include/utils/array.h.html#LN378"><span class='Ref_to_Proto'>construct_empty_array</span></a><span class='Parentheses'>(</span><a href="../../src/interfaces/ecpg/ecpglib/pg_type.h.html#LN26"><span class='Ref_to_Const'>TEXTOID</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="hstore_op.c.html#LN782"><span class='Ref_To_Local'>out_size</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="hstore_op.c.html#LN781"><span class='Ref_To_Local'>count</span></a> <span class='Operator'>* </span><span class='Number'>2</span> <span class='Operator'>/ </span><a href="hstore_op.c.html#LN777"><span class='Ref_to_Parameter'>ndims</span></a><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN784"><span class='Ref_To_Local'>out_datums</span></a> <span class='Operator'>= </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="hstore_op.c.html#LN781"><span class='Ref_To_Local'>count</span></a> <span class='Operator'>* </span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN785"><span class='Ref_To_Local'>out_nulls</span></a> <span class='Operator'>= </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Keyword'>bool</span><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="hstore_op.c.html#LN781"><span class='Ref_To_Local'>count</span></a> <span class='Operator'>* </span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN786"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="hstore_op.c.html#LN786"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="hstore_op.c.html#LN781"><span class='Ref_To_Local'>count</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="hstore_op.c.html#LN786"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN799"></a>        <a href="../seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>key</span> <span class='Operator'>= </span><a href="../../src/include/utils/builtins.h.html#LN86"><span class='Ref_to_Proto'>cstring_to_text_with_len</span></a><span class='Parentheses'>(</span><a href="hstore.h.html#LN78"><span class='Ref_to_Macro'>HSTORE_KEY</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN779"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN780"><span class='Ref_To_Local'>base</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN786"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                                   <a href="hstore.h.html#LN80"><span class='Ref_to_Macro'>HSTORE_KEYLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN779"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN786"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <a href="hstore_op.c.html#LN784"><span class='Ref_To_Local'>out_datums</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN786"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>* </span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN799"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="hstore_op.c.html#LN785"><span class='Ref_To_Local'>out_nulls</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN786"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>* </span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore.h.html#LN82"><span class='Ref_to_Macro'>HSTORE_VALISNULL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN779"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN786"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="hstore_op.c.html#LN784"><span class='Ref_To_Local'>out_datums</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN786"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>* </span><span class='Number'>2</span> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>) </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <a href="hstore_op.c.html#LN785"><span class='Ref_To_Local'>out_nulls</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN786"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>* </span><span class='Number'>2</span> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span><a name="LN812"></a>            <a href="../seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>item</span> <span class='Operator'>= </span><a href="../../src/include/utils/builtins.h.html#LN86"><span class='Ref_to_Proto'>cstring_to_text_with_len</span></a><span class='Parentheses'>(</span><a href="hstore.h.html#LN79"><span class='Ref_to_Macro'>HSTORE_VAL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN779"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN780"><span class='Ref_To_Local'>base</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN786"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                                  <a href="hstore.h.html#LN81"><span class='Ref_to_Macro'>HSTORE_VALLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN779"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN786"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
            <a href="hstore_op.c.html#LN784"><span class='Ref_To_Local'>out_datums</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN786"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>* </span><span class='Number'>2</span> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN812"><span class='Ref_To_Local'>item</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="hstore_op.c.html#LN785"><span class='Ref_To_Local'>out_nulls</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN786"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>* </span><span class='Number'>2</span> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=0;i&LT;count;++i &raquo; </span> 
 
    <span class='Control'>return</span> <a href="../../src/include/utils/array.h.html#LN372"><span class='Ref_to_Proto'>construct_md_array</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN784"><span class='Ref_To_Local'>out_datums</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN785"><span class='Ref_To_Local'>out_nulls</span></a><span class='Delimiter'>, 
</span>                              <a href="hstore_op.c.html#LN777"><span class='Ref_to_Parameter'>ndims</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN782"><span class='Ref_To_Local'>out_size</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN783"><span class='Ref_To_Local'>lb</span></a><span class='Delimiter'>, 
</span>                              <a href="../../src/interfaces/ecpg/ecpglib/pg_type.h.html#LN26"><span class='Ref_to_Const'>TEXTOID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='String'>'i'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end hstore_to_array_internal &raquo; </span> 
 
<a name="LN825"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN826"><span class='Ref_to_Func'>hstore_to_array</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN827"></a><span class='Declare_Function'>hstore_to_array</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN829"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>hs</span> <span class='Operator'>= </span><a href="hstore.h.html#LN153"><span class='Ref_to_Macro'>PG_GETARG_HS</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN830"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>out</span> <span class='Operator'>= </span><a href="hstore_op.c.html#LN776"><span class='Ref_to_Func'>hstore_to_array_internal</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN829"><span class='Ref_To_Local'>hs</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN830"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a name="LN835"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN836"><span class='Ref_to_Func'>hstore_to_matrix</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN837"></a><span class='Declare_Function'>hstore_to_matrix</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN839"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>hs</span> <span class='Operator'>= </span><a href="hstore.h.html#LN153"><span class='Ref_to_Macro'>PG_GETARG_HS</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN840"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>out</span> <span class='Operator'>= </span><a href="hstore_op.c.html#LN776"><span class='Ref_to_Func'>hstore_to_array_internal</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN839"><span class='Ref_To_Local'>hs</span></a><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN840"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Common initialization function for the various set-returning 
 * funcs. fcinfo is only passed if the function is to return a 
 * composite; it will be used to look up the return tupledesc. 
 * we stash a copy of the hstore in the multi-call context in 
 * case it was originally toasted. (At least I assume that's why; 
 * there was no explanatory comment in the original code. --AG) 
 */ 
</span> 
<span class='Keyword'>static void 
</span><a name="LN855"></a><span class='Declare_Function'>setup_firstcall</span><span class='Parentheses'>(</span><a href="../../src/include/funcapi.h.html#LN56"><span class='Ref_to_Struct'>FuncCallContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>funcctx</span><span class='Delimiter'>, </span><a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>hs</span><span class='Delimiter'>, 
</span><a name="LN856"></a>                <a href="../../src/include/fmgr.h.html#LN76"><span class='Ref_to_Struct'>FunctionCallInfoData</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>fcinfo</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN858"></a>    <a href="../../src/include/utils/palloc.h.html#LN35"><span class='Ref_to_Typedef'>MemoryContext</span></a> <span class='Declare_Local'>oldcontext</span><span class='Delimiter'>; 
</span><a name="LN859"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>st</span><span class='Delimiter'>; 
</span> 
    <a href="hstore_op.c.html#LN858"><span class='Ref_To_Local'>oldcontext</span></a> <span class='Operator'>= </span><a href="../../src/include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN855"><span class='Ref_to_Parameter'>funcctx</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/funcapi.h.html#LN108"><span class='Ref_to_Member'>multi_call_memory_ctx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="hstore_op.c.html#LN859"><span class='Ref_To_Local'>st</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN855"><span class='Ref_to_Parameter'>hs</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    memcpy<span class='Parentheses'>(</span><a href="hstore_op.c.html#LN859"><span class='Ref_To_Local'>st</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN855"><span class='Ref_to_Parameter'>hs</span></a><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN855"><span class='Ref_to_Parameter'>hs</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="hstore_op.c.html#LN855"><span class='Ref_to_Parameter'>funcctx</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/funcapi.h.html#LN89"><span class='Ref_to_Member'>user_fctx</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="hstore_op.c.html#LN859"><span class='Ref_To_Local'>st</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN856"><span class='Ref_to_Parameter'>fcinfo</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN870"></a>        <a href="../../src/include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a>   <span class='Declare_Local'>tupdesc</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Build a tuple descriptor for our result type */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/include/funcapi.h.html#LN157"><span class='Ref_to_Proto'>get_call_result_type</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN856"><span class='Ref_to_Parameter'>fcinfo</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="hstore_op.c.html#LN870"><span class='Ref_To_Local'>tupdesc</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="../../src/include/funcapi.h.html#LN152"><span class='Ref_to_EnumConst'>TYPEFUNC_COMPOSITE</span></a><span class='Parentheses'>)</span> 
            <a href="../../src/backend/bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../src/include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"return type must be a row type"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="hstore_op.c.html#LN855"><span class='Ref_to_Parameter'>funcctx</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/funcapi.h.html#LN119"><span class='Ref_to_Member'>tuple_desc</span></a> <span class='Operator'>= </span><a href="../../src/include/funcapi.h.html#LN229"><span class='Ref_to_Proto'>BlessTupleDesc</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN870"><span class='Ref_To_Local'>tupdesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../src/include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN858"><span class='Ref_To_Local'>oldcontext</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end setup_firstcall &raquo; </span> 
 
 
<a name="LN883"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN884"><span class='Ref_to_Func'>hstore_skeys</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN885"></a><span class='Declare_Function'>hstore_skeys</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN887"></a>    <a href="../../src/include/funcapi.h.html#LN56"><span class='Ref_to_Struct'>FuncCallContext</span></a> <span class='Operator'>*</span><span class='Declare_Local'>funcctx</span><span class='Delimiter'>; 
</span><a name="LN888"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>hs</span><span class='Delimiter'>; 
</span><a name="LN889"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/include/funcapi.h.html#LN284"><span class='Ref_to_Macro'>SRF_IS_FIRSTCALL</span></a><span class='Parentheses'>())</span> 
    <span class='Delimiter'>{ 
</span>        <a href="hstore_op.c.html#LN888"><span class='Ref_To_Local'>hs</span></a> <span class='Operator'>= </span><a href="hstore.h.html#LN153"><span class='Ref_to_Macro'>PG_GETARG_HS</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="hstore_op.c.html#LN887"><span class='Ref_To_Local'>funcctx</span></a> <span class='Operator'>= </span><a href="../../src/include/funcapi.h.html#LN286"><span class='Ref_to_Macro'>SRF_FIRSTCALL_INIT</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <a href="hstore_op.c.html#LN854"><span class='Ref_to_Func'>setup_firstcall</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN887"><span class='Ref_To_Local'>funcctx</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN888"><span class='Ref_To_Local'>hs</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="hstore_op.c.html#LN887"><span class='Ref_To_Local'>funcctx</span></a> <span class='Operator'>= </span><a href="../../src/include/funcapi.h.html#LN288"><span class='Ref_to_Macro'>SRF_PERCALL_SETUP</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN888"><span class='Ref_To_Local'>hs</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="hstore_op.c.html#LN887"><span class='Ref_To_Local'>funcctx</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/funcapi.h.html#LN89"><span class='Ref_to_Member'>user_fctx</span></a><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN889"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="hstore_op.c.html#LN887"><span class='Ref_To_Local'>funcctx</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/funcapi.h.html#LN64"><span class='Ref_to_Member'>call_cntr</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN889"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="hstore.h.html#LN60"><span class='Ref_to_Macro'>HS_COUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN888"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN904"></a>        <a href="hstore.h.html#LN17"><span class='Ref_to_Typedef'>HEntry</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>entries</span> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN888"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN905"></a>        <a href="../seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>item</span><span class='Delimiter'>; 
</span> 
        <a href="hstore_op.c.html#LN905"><span class='Ref_To_Local'>item</span></a> <span class='Operator'>= </span><a href="../../src/include/utils/builtins.h.html#LN86"><span class='Ref_to_Proto'>cstring_to_text_with_len</span></a><span class='Parentheses'>(</span><a href="hstore.h.html#LN78"><span class='Ref_to_Macro'>HSTORE_KEY</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN904"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN888"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN889"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                        <a href="hstore.h.html#LN80"><span class='Ref_to_Macro'>HSTORE_KEYLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN904"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN889"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <a href="../../src/include/funcapi.h.html#LN290"><span class='Ref_to_Macro'>SRF_RETURN_NEXT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN887"><span class='Ref_To_Local'>funcctx</span></a><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN905"><span class='Ref_To_Local'>item</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../src/include/funcapi.h.html#LN308"><span class='Ref_to_Macro'>SRF_RETURN_DONE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN887"><span class='Ref_To_Local'>funcctx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end hstore_skeys &raquo; </span> 
 
 
<a name="LN917"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN918"><span class='Ref_to_Func'>hstore_svals</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN919"></a><span class='Declare_Function'>hstore_svals</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN921"></a>    <a href="../../src/include/funcapi.h.html#LN56"><span class='Ref_to_Struct'>FuncCallContext</span></a> <span class='Operator'>*</span><span class='Declare_Local'>funcctx</span><span class='Delimiter'>; 
</span><a name="LN922"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>hs</span><span class='Delimiter'>; 
</span><a name="LN923"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/include/funcapi.h.html#LN284"><span class='Ref_to_Macro'>SRF_IS_FIRSTCALL</span></a><span class='Parentheses'>())</span> 
    <span class='Delimiter'>{ 
</span>        <a href="hstore_op.c.html#LN922"><span class='Ref_To_Local'>hs</span></a> <span class='Operator'>= </span><a href="hstore.h.html#LN153"><span class='Ref_to_Macro'>PG_GETARG_HS</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="hstore_op.c.html#LN921"><span class='Ref_To_Local'>funcctx</span></a> <span class='Operator'>= </span><a href="../../src/include/funcapi.h.html#LN286"><span class='Ref_to_Macro'>SRF_FIRSTCALL_INIT</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <a href="hstore_op.c.html#LN854"><span class='Ref_to_Func'>setup_firstcall</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN921"><span class='Ref_To_Local'>funcctx</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN922"><span class='Ref_To_Local'>hs</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="hstore_op.c.html#LN921"><span class='Ref_To_Local'>funcctx</span></a> <span class='Operator'>= </span><a href="../../src/include/funcapi.h.html#LN288"><span class='Ref_to_Macro'>SRF_PERCALL_SETUP</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN922"><span class='Ref_To_Local'>hs</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="hstore_op.c.html#LN921"><span class='Ref_To_Local'>funcctx</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/funcapi.h.html#LN89"><span class='Ref_to_Member'>user_fctx</span></a><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN923"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="hstore_op.c.html#LN921"><span class='Ref_To_Local'>funcctx</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/funcapi.h.html#LN64"><span class='Ref_to_Member'>call_cntr</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN923"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="hstore.h.html#LN60"><span class='Ref_to_Macro'>HS_COUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN922"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN938"></a>        <a href="hstore.h.html#LN17"><span class='Ref_to_Typedef'>HEntry</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>entries</span> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN922"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore.h.html#LN82"><span class='Ref_to_Macro'>HSTORE_VALISNULL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN938"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN923"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN942"></a>            <a href="../../src/include/nodes/execnodes.h.html#LN261"><span class='Ref_to_Struct'>ReturnSetInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rsi</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* ugly ugly ugly. why no macro for this? */ 
</span>            <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN921"><span class='Ref_To_Local'>funcctx</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span><a href="../../src/include/funcapi.h.html#LN64"><span class='Ref_to_Member'>call_cntr</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <a href="hstore_op.c.html#LN942"><span class='Ref_To_Local'>rsi</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/nodes/execnodes.h.html#LN261"><span class='Ref_to_Struct'>ReturnSetInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span>fcinfo<span class='Operator'>-&GT;</span>resultinfo<span class='Delimiter'>; 
</span>            <a href="hstore_op.c.html#LN942"><span class='Ref_To_Local'>rsi</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/nodes/execnodes.h.html#LN270"><span class='Ref_to_Member'>isDone</span></a> <span class='Operator'>= </span><a href="../../src/include/nodes/execnodes.h.html#LN237"><span class='Ref_to_EnumConst'>ExprMultipleResult</span></a><span class='Delimiter'>; 
</span>            <a href="../../src/include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span><a name="LN952"></a>            <a href="../seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>item</span><span class='Delimiter'>; 
</span> 
            <a href="hstore_op.c.html#LN952"><span class='Ref_To_Local'>item</span></a> <span class='Operator'>= </span><a href="../../src/include/utils/builtins.h.html#LN86"><span class='Ref_to_Proto'>cstring_to_text_with_len</span></a><span class='Parentheses'>(</span><a href="hstore.h.html#LN79"><span class='Ref_to_Macro'>HSTORE_VAL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN938"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN922"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN923"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                            <a href="hstore.h.html#LN81"><span class='Ref_to_Macro'>HSTORE_VALLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN938"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN923"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
            <a href="../../src/include/funcapi.h.html#LN290"><span class='Ref_to_Macro'>SRF_RETURN_NEXT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN921"><span class='Ref_To_Local'>funcctx</span></a><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN952"><span class='Ref_To_Local'>item</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if i&LT;HS_COUNT(hs) &raquo; </span> 
 
    <a href="../../src/include/funcapi.h.html#LN308"><span class='Ref_to_Macro'>SRF_RETURN_DONE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN921"><span class='Ref_To_Local'>funcctx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end hstore_svals &raquo; </span> 
 
 
<a name="LN965"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN966"><span class='Ref_to_Func'>hstore_contains</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN967"></a><span class='Declare_Function'>hstore_contains</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN969"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>val</span> <span class='Operator'>= </span><a href="hstore.h.html#LN153"><span class='Ref_to_Macro'>PG_GETARG_HS</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN970"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>tmpl</span> <span class='Operator'>= </span><a href="hstore.h.html#LN153"><span class='Ref_to_Macro'>PG_GETARG_HS</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN971"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>res</span> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span><a name="LN972"></a>    <a href="hstore.h.html#LN17"><span class='Ref_to_Typedef'>HEntry</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>te</span> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN970"><span class='Ref_To_Local'>tmpl</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN973"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>tstr</span> <span class='Operator'>= </span><a href="hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN970"><span class='Ref_To_Local'>tmpl</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN974"></a>    <a href="hstore.h.html#LN17"><span class='Ref_to_Typedef'>HEntry</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>ve</span> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN969"><span class='Ref_To_Local'>val</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN975"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>vstr</span> <span class='Operator'>= </span><a href="hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN969"><span class='Ref_To_Local'>val</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN976"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>tcount</span> <span class='Operator'>= </span><a href="hstore.h.html#LN60"><span class='Ref_to_Macro'>HS_COUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN970"><span class='Ref_To_Local'>tmpl</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN977"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>lastidx</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN978"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * we exploit the fact that keys in "tmpl" are in strictly increasing 
     * order to narrow the hstoreFindKey search; each search can start one 
     * entry past the previous "found" entry, or at the lower bound of the 
     * search 
     */ 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN978"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="hstore_op.c.html#LN971"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>&& </span><a href="hstore_op.c.html#LN978"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="hstore_op.c.html#LN976"><span class='Ref_To_Local'>tcount</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="hstore_op.c.html#LN978"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN989"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>idx</span> <span class='Operator'>= </span><a href="hstore_op.c.html#LN35"><span class='Ref_to_Func'>hstoreFindKey</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN969"><span class='Ref_To_Local'>val</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="hstore_op.c.html#LN977"><span class='Ref_To_Local'>lastidx</span></a><span class='Delimiter'>, 
</span>                                        <a href="hstore.h.html#LN78"><span class='Ref_to_Macro'>HSTORE_KEY</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN972"><span class='Ref_To_Local'>te</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN973"><span class='Ref_To_Local'>tstr</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN978"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                        <a href="hstore.h.html#LN80"><span class='Ref_to_Macro'>HSTORE_KEYLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN972"><span class='Ref_To_Local'>te</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN978"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN989"><span class='Ref_To_Local'>idx</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN995"></a>            <span class='Keyword'>bool</span>        <span class='Declare_Local'>nullval</span> <span class='Operator'>= </span><a href="hstore.h.html#LN82"><span class='Ref_to_Macro'>HSTORE_VALISNULL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN972"><span class='Ref_To_Local'>te</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN978"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN996"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>vallen</span> <span class='Operator'>= </span><a href="hstore.h.html#LN81"><span class='Ref_to_Macro'>HSTORE_VALLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN972"><span class='Ref_To_Local'>te</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN978"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN995"><span class='Ref_To_Local'>nullval</span></a> <span class='Operator'>!= </span><a href="hstore.h.html#LN82"><span class='Ref_to_Macro'>HSTORE_VALISNULL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN974"><span class='Ref_To_Local'>ve</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN989"><span class='Ref_To_Local'>idx</span></a><span class='Parentheses'>)</span> <span class='Operator'>|| 
</span>                <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="hstore_op.c.html#LN995"><span class='Ref_To_Local'>nullval</span></a> <span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN996"><span class='Ref_To_Local'>vallen</span></a> <span class='Operator'>!= </span><a href="hstore.h.html#LN81"><span class='Ref_to_Macro'>HSTORE_VALLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN974"><span class='Ref_To_Local'>ve</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN989"><span class='Ref_To_Local'>idx</span></a><span class='Parentheses'>)</span> <span class='Operator'>|| 
</span>                              memcmp<span class='Parentheses'>(</span><a href="hstore.h.html#LN79"><span class='Ref_to_Macro'>HSTORE_VAL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN972"><span class='Ref_To_Local'>te</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN973"><span class='Ref_To_Local'>tstr</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN978"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                     <a href="hstore.h.html#LN79"><span class='Ref_to_Macro'>HSTORE_VAL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN974"><span class='Ref_To_Local'>ve</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN975"><span class='Ref_To_Local'>vstr</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN989"><span class='Ref_To_Local'>idx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                     <a href="hstore_op.c.html#LN996"><span class='Ref_To_Local'>vallen</span></a><span class='Parentheses'>)</span> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)))</span> 
                <a href="hstore_op.c.html#LN971"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
            <a href="hstore_op.c.html#LN971"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=0;res&&i&LT;tcount;++i &raquo; </span> 
 
    <a href="../../src/include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN971"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end hstore_contains &raquo; </span> 
 
 
<a name="LN1013"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1014"><span class='Ref_to_Func'>hstore_contained</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1015"></a><span class='Declare_Function'>hstore_contained</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="../../src/include/fmgr.h.html#LN312"><span class='Ref_to_Macro'>PG_RETURN_DATUM</span></a><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN585"><span class='Ref_to_Macro'>DirectFunctionCall2</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN966"><span class='Ref_to_Func'>hstore_contains</span></a><span class='Delimiter'>, 
</span>                                        <a href="../../src/include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                        <a href="../../src/include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                                        <span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
 
<a name="LN1024"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1025"><span class='Ref_to_Func'>hstore_each</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1026"></a><span class='Declare_Function'>hstore_each</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1028"></a>    <a href="../../src/include/funcapi.h.html#LN56"><span class='Ref_to_Struct'>FuncCallContext</span></a> <span class='Operator'>*</span><span class='Declare_Local'>funcctx</span><span class='Delimiter'>; 
</span><a name="LN1029"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>hs</span><span class='Delimiter'>; 
</span><a name="LN1030"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/include/funcapi.h.html#LN284"><span class='Ref_to_Macro'>SRF_IS_FIRSTCALL</span></a><span class='Parentheses'>())</span> 
    <span class='Delimiter'>{ 
</span>        <a href="hstore_op.c.html#LN1029"><span class='Ref_To_Local'>hs</span></a> <span class='Operator'>= </span><a href="hstore.h.html#LN153"><span class='Ref_to_Macro'>PG_GETARG_HS</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="hstore_op.c.html#LN1028"><span class='Ref_To_Local'>funcctx</span></a> <span class='Operator'>= </span><a href="../../src/include/funcapi.h.html#LN286"><span class='Ref_to_Macro'>SRF_FIRSTCALL_INIT</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <a href="hstore_op.c.html#LN854"><span class='Ref_to_Func'>setup_firstcall</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1028"><span class='Ref_To_Local'>funcctx</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN1029"><span class='Ref_To_Local'>hs</span></a><span class='Delimiter'>, </span>fcinfo<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="hstore_op.c.html#LN1028"><span class='Ref_To_Local'>funcctx</span></a> <span class='Operator'>= </span><a href="../../src/include/funcapi.h.html#LN288"><span class='Ref_to_Macro'>SRF_PERCALL_SETUP</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN1029"><span class='Ref_To_Local'>hs</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="hstore_op.c.html#LN1028"><span class='Ref_To_Local'>funcctx</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/funcapi.h.html#LN89"><span class='Ref_to_Member'>user_fctx</span></a><span class='Delimiter'>; 
</span>    <a href="hstore_op.c.html#LN1030"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="hstore_op.c.html#LN1028"><span class='Ref_To_Local'>funcctx</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/funcapi.h.html#LN64"><span class='Ref_to_Member'>call_cntr</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1030"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="hstore.h.html#LN60"><span class='Ref_to_Macro'>HS_COUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1029"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1045"></a>        <a href="hstore.h.html#LN17"><span class='Ref_to_Typedef'>HEntry</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>entries</span> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1029"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1046"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>ptr</span> <span class='Operator'>= </span><a href="hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1029"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1047"></a>        <a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>res</span><span class='Delimiter'>, 
</span><a name="LN1048"></a>                    <span class='Declare_Local'>dvalues</span><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]; 
</span><a name="LN1049"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>nulls</span><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Delimiter'>{</span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>}; 
</span><a name="LN1050"></a>        <a href="../seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>item</span><span class='Delimiter'>; 
</span><a name="LN1051"></a>        <a href="../../src/include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tuple</span><span class='Delimiter'>; 
</span> 
        <a href="hstore_op.c.html#LN1050"><span class='Ref_To_Local'>item</span></a> <span class='Operator'>= </span><a href="../../src/include/utils/builtins.h.html#LN86"><span class='Ref_to_Proto'>cstring_to_text_with_len</span></a><span class='Parentheses'>(</span><a href="hstore.h.html#LN78"><span class='Ref_to_Macro'>HSTORE_KEY</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1045"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN1046"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN1030"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                        <a href="hstore.h.html#LN80"><span class='Ref_to_Macro'>HSTORE_KEYLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1045"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN1030"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="hstore_op.c.html#LN1048"><span class='Ref_To_Local'>dvalues</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1050"><span class='Ref_To_Local'>item</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore.h.html#LN82"><span class='Ref_to_Macro'>HSTORE_VALISNULL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1045"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN1030"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="hstore_op.c.html#LN1048"><span class='Ref_To_Local'>dvalues</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>) </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <a href="hstore_op.c.html#LN1049"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="hstore_op.c.html#LN1050"><span class='Ref_To_Local'>item</span></a> <span class='Operator'>= </span><a href="../../src/include/utils/builtins.h.html#LN86"><span class='Ref_to_Proto'>cstring_to_text_with_len</span></a><span class='Parentheses'>(</span><a href="hstore.h.html#LN79"><span class='Ref_to_Macro'>HSTORE_VAL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1045"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN1046"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN1030"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                            <a href="hstore.h.html#LN81"><span class='Ref_to_Macro'>HSTORE_VALLEN</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1045"><span class='Ref_To_Local'>entries</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN1030"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="hstore_op.c.html#LN1048"><span class='Ref_To_Local'>dvalues</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1050"><span class='Ref_To_Local'>item</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="hstore_op.c.html#LN1051"><span class='Ref_To_Local'>tuple</span></a> <span class='Operator'>= </span><a href="../../src/backend/access/common/heaptuple.c.html#LN690"><span class='Ref_to_Func'>heap_form_tuple</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1028"><span class='Ref_To_Local'>funcctx</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/funcapi.h.html#LN119"><span class='Ref_to_Member'>tuple_desc</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN1048"><span class='Ref_To_Local'>dvalues</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN1049"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="hstore_op.c.html#LN1047"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="../../src/include/funcapi.h.html#LN221"><span class='Ref_to_Macro'>HeapTupleGetDatum</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1051"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="../../src/include/funcapi.h.html#LN290"><span class='Ref_to_Macro'>SRF_RETURN_NEXT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1028"><span class='Ref_To_Local'>funcctx</span></a><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1047"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if i&LT;HS_COUNT(hs) &raquo; </span> 
 
    <a href="../../src/include/funcapi.h.html#LN308"><span class='Ref_to_Macro'>SRF_RETURN_DONE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1028"><span class='Ref_To_Local'>funcctx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end hstore_each &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * btree sort order for hstores isn't intended to be useful; we really only 
 * care about equality versus non-equality.  we compare the entire string 
 * buffer first, then the entry pos array. 
 */ 
</span> 
<a name="LN1085"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1086"><span class='Ref_to_Func'>hstore_cmp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1087"></a><span class='Declare_Function'>hstore_cmp</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1089"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>hs1</span> <span class='Operator'>= </span><a href="hstore.h.html#LN153"><span class='Ref_to_Macro'>PG_GETARG_HS</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1090"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>hs2</span> <span class='Operator'>= </span><a href="hstore.h.html#LN153"><span class='Ref_to_Macro'>PG_GETARG_HS</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1091"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>hcount1</span> <span class='Operator'>= </span><a href="hstore.h.html#LN60"><span class='Ref_to_Macro'>HS_COUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1089"><span class='Ref_To_Local'>hs1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1092"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>hcount2</span> <span class='Operator'>= </span><a href="hstore.h.html#LN60"><span class='Ref_to_Macro'>HS_COUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1090"><span class='Ref_To_Local'>hs2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1093"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>res</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1091"><span class='Ref_To_Local'>hcount1</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="hstore_op.c.html#LN1092"><span class='Ref_To_Local'>hcount2</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * if either operand is empty, and the other is nonempty, the nonempty 
         * one is larger. If both are empty they are equal. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1091"><span class='Ref_To_Local'>hcount1</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="hstore_op.c.html#LN1093"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1092"><span class='Ref_To_Local'>hcount2</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="hstore_op.c.html#LN1093"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* here we know both operands are nonempty */ 
</span><a name="LN1109"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>str1</span> <span class='Operator'>= </span><a href="hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1089"><span class='Ref_To_Local'>hs1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1110"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>str2</span> <span class='Operator'>= </span><a href="hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1090"><span class='Ref_To_Local'>hs2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1111"></a>        <a href="hstore.h.html#LN17"><span class='Ref_to_Typedef'>HEntry</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>ent1</span> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1089"><span class='Ref_To_Local'>hs1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1112"></a>        <a href="hstore.h.html#LN17"><span class='Ref_to_Typedef'>HEntry</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>ent2</span> <span class='Operator'>= </span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1090"><span class='Ref_To_Local'>hs2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1113"></a>        size_t      <span class='Declare_Local'>len1</span> <span class='Operator'>= </span><a href="hstore.h.html#LN29"><span class='Ref_to_Macro'>HSE_ENDPOS</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1111"><span class='Ref_To_Local'>ent1</span></a><span class='Delimiter'>[</span><span class='Number'>2</span> <span class='Operator'>* </span><a href="hstore_op.c.html#LN1091"><span class='Ref_To_Local'>hcount1</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1114"></a>        size_t      <span class='Declare_Local'>len2</span> <span class='Operator'>= </span><a href="hstore.h.html#LN29"><span class='Ref_to_Macro'>HSE_ENDPOS</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1112"><span class='Ref_To_Local'>ent2</span></a><span class='Delimiter'>[</span><span class='Number'>2</span> <span class='Operator'>* </span><a href="hstore_op.c.html#LN1092"><span class='Ref_To_Local'>hcount2</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="hstore_op.c.html#LN1093"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span>memcmp<span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1109"><span class='Ref_To_Local'>str1</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN1110"><span class='Ref_To_Local'>str2</span></a><span class='Delimiter'>, </span><a href="../../src/interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1113"><span class='Ref_To_Local'>len1</span></a><span class='Delimiter'>, </span><a href="hstore_op.c.html#LN1114"><span class='Ref_To_Local'>len2</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1093"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1113"><span class='Ref_To_Local'>len1</span></a> <span class='Operator'>&GT; </span><a href="hstore_op.c.html#LN1114"><span class='Ref_To_Local'>len2</span></a><span class='Parentheses'>) 
</span>                <a href="hstore_op.c.html#LN1093"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1113"><span class='Ref_To_Local'>len1</span></a> <span class='Operator'>&LT; </span><a href="hstore_op.c.html#LN1114"><span class='Ref_To_Local'>len2</span></a><span class='Parentheses'>) 
</span>                <a href="hstore_op.c.html#LN1093"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1091"><span class='Ref_To_Local'>hcount1</span></a> <span class='Operator'>&GT; </span><a href="hstore_op.c.html#LN1092"><span class='Ref_To_Local'>hcount2</span></a><span class='Parentheses'>) 
</span>                <a href="hstore_op.c.html#LN1093"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1092"><span class='Ref_To_Local'>hcount2</span></a> <span class='Operator'>&GT; </span><a href="hstore_op.c.html#LN1091"><span class='Ref_To_Local'>hcount1</span></a><span class='Parentheses'>) 
</span>                <a href="hstore_op.c.html#LN1093"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span><a name="LN1130"></a>                <span class='Keyword'>int</span>         <span class='Declare_Local'>count</span> <span class='Operator'>= </span><a href="hstore_op.c.html#LN1091"><span class='Ref_To_Local'>hcount1</span></a> <span class='Operator'>* </span><span class='Number'>2</span><span class='Delimiter'>; 
</span><a name="LN1131"></a>                <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
                <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1131"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="hstore_op.c.html#LN1131"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="hstore_op.c.html#LN1130"><span class='Ref_To_Local'>count</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="hstore_op.c.html#LN1131"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore.h.html#LN29"><span class='Ref_to_Macro'>HSE_ENDPOS</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1111"><span class='Ref_To_Local'>ent1</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN1131"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="hstore.h.html#LN29"><span class='Ref_to_Macro'>HSE_ENDPOS</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1112"><span class='Ref_To_Local'>ent2</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN1131"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) </span><span class='Operator'>|| 
</span>                        <a href="hstore.h.html#LN28"><span class='Ref_to_Macro'>HSE_ISNULL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1111"><span class='Ref_To_Local'>ent1</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN1131"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="hstore.h.html#LN28"><span class='Ref_to_Macro'>HSE_ISNULL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1112"><span class='Ref_To_Local'>ent2</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN1131"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
                        <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1131"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="hstore_op.c.html#LN1130"><span class='Ref_To_Local'>count</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore.h.html#LN29"><span class='Ref_to_Macro'>HSE_ENDPOS</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1111"><span class='Ref_To_Local'>ent1</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN1131"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><a href="hstore.h.html#LN29"><span class='Ref_to_Macro'>HSE_ENDPOS</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1112"><span class='Ref_To_Local'>ent2</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN1131"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
                        <a href="hstore_op.c.html#LN1093"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore.h.html#LN29"><span class='Ref_to_Macro'>HSE_ENDPOS</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1111"><span class='Ref_To_Local'>ent1</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN1131"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><a href="hstore.h.html#LN29"><span class='Ref_to_Macro'>HSE_ENDPOS</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1112"><span class='Ref_To_Local'>ent2</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN1131"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
                        <a href="hstore_op.c.html#LN1093"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore.h.html#LN28"><span class='Ref_to_Macro'>HSE_ISNULL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1111"><span class='Ref_To_Local'>ent1</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN1131"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
                        <a href="hstore_op.c.html#LN1093"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="hstore.h.html#LN28"><span class='Ref_to_Macro'>HSE_ISNULL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1112"><span class='Ref_To_Local'>ent2</span></a><span class='Delimiter'>[</span><a href="hstore_op.c.html#LN1131"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
                        <a href="hstore_op.c.html#LN1093"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if res==0 &raquo; </span> 
        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="hstore_op.c.html#LN1093"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1093"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='Number'>1</span> <span class='Operator'>: -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* 
     * this is a btree support function; this is one of the few places where 
     * memory needs to be explicitly freed. 
     */ 
</span>    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1089"><span class='Ref_To_Local'>hs1</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1090"><span class='Ref_To_Local'>hs2</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1093"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end hstore_cmp &raquo; </span> 
 
 
<a name="LN1166"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1167"><span class='Ref_to_Func'>hstore_eq</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1168"></a><span class='Declare_Function'>hstore_eq</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1170"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>res</span> <span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN477"><span class='Ref_to_Macro'>DatumGetInt32</span></a><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN585"><span class='Ref_to_Macro'>DirectFunctionCall2</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1086"><span class='Ref_to_Func'>hstore_cmp</span></a><span class='Delimiter'>, 
</span>                                                        <a href="../../src/include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                                        <a href="../../src/include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1170"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a name="LN1177"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1178"><span class='Ref_to_Func'>hstore_ne</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1179"></a><span class='Declare_Function'>hstore_ne</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1181"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>res</span> <span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN477"><span class='Ref_to_Macro'>DatumGetInt32</span></a><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN585"><span class='Ref_to_Macro'>DirectFunctionCall2</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1086"><span class='Ref_to_Func'>hstore_cmp</span></a><span class='Delimiter'>, 
</span>                                                        <a href="../../src/include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                                        <a href="../../src/include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1181"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a name="LN1188"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1189"><span class='Ref_to_Func'>hstore_gt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1190"></a><span class='Declare_Function'>hstore_gt</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1192"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>res</span> <span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN477"><span class='Ref_to_Macro'>DatumGetInt32</span></a><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN585"><span class='Ref_to_Macro'>DirectFunctionCall2</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1086"><span class='Ref_to_Func'>hstore_cmp</span></a><span class='Delimiter'>, 
</span>                                                        <a href="../../src/include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                                        <a href="../../src/include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1192"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a name="LN1199"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1200"><span class='Ref_to_Func'>hstore_ge</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1201"></a><span class='Declare_Function'>hstore_ge</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1203"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>res</span> <span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN477"><span class='Ref_to_Macro'>DatumGetInt32</span></a><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN585"><span class='Ref_to_Macro'>DirectFunctionCall2</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1086"><span class='Ref_to_Func'>hstore_cmp</span></a><span class='Delimiter'>, 
</span>                                                        <a href="../../src/include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                                        <a href="../../src/include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1203"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a name="LN1210"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1211"><span class='Ref_to_Func'>hstore_lt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1212"></a><span class='Declare_Function'>hstore_lt</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1214"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>res</span> <span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN477"><span class='Ref_to_Macro'>DatumGetInt32</span></a><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN585"><span class='Ref_to_Macro'>DirectFunctionCall2</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1086"><span class='Ref_to_Func'>hstore_cmp</span></a><span class='Delimiter'>, 
</span>                                                        <a href="../../src/include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                                        <a href="../../src/include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1214"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a name="LN1221"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1222"><span class='Ref_to_Func'>hstore_le</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1223"></a><span class='Declare_Function'>hstore_le</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1225"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>res</span> <span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN477"><span class='Ref_to_Macro'>DatumGetInt32</span></a><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN585"><span class='Ref_to_Macro'>DirectFunctionCall2</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1086"><span class='Ref_to_Func'>hstore_cmp</span></a><span class='Delimiter'>, 
</span>                                                        <a href="../../src/include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                                        <a href="../../src/include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1225"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<a name="LN1233"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1234"><span class='Ref_to_Func'>hstore_hash</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1235"></a><span class='Declare_Function'>hstore_hash</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1237"></a>    <a href="hstore.h.html#LN43"><span class='Ref_to_Typedef'>HStore</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>hs</span> <span class='Operator'>= </span><a href="hstore.h.html#LN153"><span class='Ref_to_Macro'>PG_GETARG_HS</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1238"></a>    <a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>hval</span> <span class='Operator'>= </span><a href="../../src/backend/access/hash/hashfunc.c.html#LN305"><span class='Ref_to_Func'>hash_any</span></a><span class='Parentheses'>((</span><span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/postgres.h.html#LN302"><span class='Ref_to_Macro'>VARDATA</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1237"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                <a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1237"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="../../src/include/c.h.html#LN444"><span class='Ref_to_Const'>VARHDRSZ</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * this is the only place in the code that cares whether the overall 
     * varlena size exactly matches the true data size; this assertion should 
     * be maintained by all the other code, but we make it explicit here. 
     */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1237"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span> <span class='Operator'>== 
</span>           <span class='Parentheses'>(</span><a href="hstore.h.html#LN60"><span class='Ref_to_Macro'>HS_COUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1237"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span> <span class='Operator'>!= </span><span class='Number'>0</span> <span class='Operator'>? 
</span>            <a href="hstore.h.html#LN71"><span class='Ref_to_Macro'>CALCDATASIZE</span></a><span class='Parentheses'>(</span><a href="hstore.h.html#LN60"><span class='Ref_to_Macro'>HS_COUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1237"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="hstore.h.html#LN29"><span class='Ref_to_Macro'>HSE_ENDPOS</span></a><span class='Parentheses'>(</span><a href="../intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1237"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>[</span><span class='Number'>2</span> <span class='Operator'>* </span><a href="hstore.h.html#LN60"><span class='Ref_to_Macro'>HS_COUNT</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1237"><span class='Ref_To_Local'>hs</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>))</span> <span class='Operator'>: 
</span>            <a href="hstore.h.html#LN70"><span class='Ref_to_Const'>HSHRDSIZE</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1237"><span class='Ref_To_Local'>hs</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN312"><span class='Ref_to_Macro'>PG_RETURN_DATUM</span></a><span class='Parentheses'>(</span><a href="hstore_op.c.html#LN1238"><span class='Ref_To_Local'>hval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end hstore_hash &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>