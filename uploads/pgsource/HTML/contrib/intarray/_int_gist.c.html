<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>contrib\intarray\_int_gist.c</title>
<LINK REL=StyleSheet HREF="../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>contrib\intarray\_int_gist.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:25 2017
</td></tr>
<tr><td><a href='../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/* 
 * contrib/intarray/_int_gist.c 
 */ 
</span><span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>&LT;limits.h&GT;</span> 
 
<span class='Keyword'>#include </span><span class='String'>"access/gist.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/stratnum.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>"_int.h"</span> 
 
<a name="LN12"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>GETENTRY</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>vec</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>pos</span><span class='Parentheses'>) ((</span><a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>*</span><span class='Parentheses'>)</span> <a href="../../src/include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>((</span><a href="_int_gist.c.html#LN12"><span class='Ref_to_Parameter'>vec</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>vector<span class='Delimiter'>[</span><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN12"><span class='Ref_to_Parameter'>pos</span></a><span class='Parentheses'>)</span><span class='Delimiter'>]</span><span class='Operator'>.</span>key<span class='Parentheses'>))</span> 
 
<span class='Comment_Multi_Line'>/* 
** GiST support methods 
*/ 
</span><a name="LN17"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN32"><span class='Ref_to_Func'>g_int_consistent</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN18"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN137"><span class='Ref_to_Func'>g_int_compress</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN19"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN215"><span class='Ref_to_Func'>g_int_decompress</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN20"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN283"><span class='Ref_to_Func'>g_int_penalty</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN21"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN361"><span class='Ref_to_Func'>g_int_picksplit</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN22"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN97"><span class='Ref_to_Func'>g_int_union</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN23"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN305"><span class='Ref_to_Func'>g_int_same</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* 
** The GiST Consistent method for _intments 
** Should return false if for all data items x below entry, 
** the predicate x op query == FALSE, where op is the oper 
** corresponding to strategy in the pg_amop table. 
*/ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN33"></a><span class='Declare_Function'>g_int_consistent</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN35"></a>    <a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>entry</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN36"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>query</span> <span class='Operator'>= </span><a href="../../src/include/utils/array.h.html#LN244"><span class='Ref_to_Macro'>PG_GETARG_ARRAYTYPE_P_COPY</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN37"></a>    <a href="../../src/include/access/stratnum.h.html#LN21"><span class='Ref_to_Typedef'>StrategyNumber</span></a> <span class='Declare_Local'>strategy</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/stratnum.h.html#LN21"><span class='Ref_to_Typedef'>StrategyNumber</span></a><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN236"><span class='Ref_to_Macro'>PG_GETARG_UINT16</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Oid      subtype = PG_GETARG_OID(3); */ 
</span><a name="LN40"></a>    <span class='Keyword'>bool</span>       <span class='Operator'>*</span><span class='Declare_Local'>recheck</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>4</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN41"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>retval</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* this is exact except for RTSameStrategyNumber */ 
</span>    <span class='Operator'>*</span><a href="_int_gist.c.html#LN40"><span class='Ref_To_Local'>recheck</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN37"><span class='Ref_To_Local'>strategy</span></a> <span class='Operator'>== </span><a href="../../src/include/access/stratnum.h.html#LN48"><span class='Ref_to_Const'>RTSameStrategyNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN37"><span class='Ref_To_Local'>strategy</span></a> <span class='Operator'>== </span><a href="_int.h.html#LN118"><span class='Ref_to_Const'>BooleanSearchStrategy</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="_int_gist.c.html#LN41"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><a href="_int.h.html#LN158"><span class='Ref_to_Proto'>execconsistent</span></a><span class='Parentheses'>((</span><a href="_int.h.html#LN131"><span class='Ref_to_Struct'>QUERYTYPE</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="_int_gist.c.html#LN36"><span class='Ref_To_Local'>query</span></a><span class='Delimiter'>, 
</span>                                <span class='Parentheses'>(</span><a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN35"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                <a href="../../src/include/access/gist.h.html#LN132"><span class='Ref_to_Macro'>GIST_LEAF</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN35"><span class='Ref_To_Local'>entry</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <a href="../../src/include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN36"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN41"><span class='Ref_To_Local'>retval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* sort query for fast search, key is already sorted */ 
</span>    <a href="_int.h.html#LN17"><span class='Ref_to_Macro'>CHECKARRVALID</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN36"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="_int.h.html#LN36"><span class='Ref_to_Macro'>PREPAREARR</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN36"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN37"><span class='Ref_To_Local'>strategy</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../src/include/access/stratnum.h.html#LN45"><span class='Ref_to_Const'>RTOverlapStrategyNumber</span></a><span class='Operator'>: 
</span>            <a href="_int_gist.c.html#LN41"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><a href="_int_tool.c.html#LN46"><span class='Ref_to_Func'>inner_int_overlap</span></a><span class='Parentheses'>((</span><a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN35"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                       <a href="_int_gist.c.html#LN36"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../src/include/access/stratnum.h.html#LN48"><span class='Ref_to_Const'>RTSameStrategyNumber</span></a><span class='Operator'>: 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN132"><span class='Ref_to_Macro'>GIST_LEAF</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN35"><span class='Ref_To_Local'>entry</span></a><span class='Parentheses'>))</span> 
                <a href="../../src/include/fmgr.h.html#LN587"><span class='Ref_to_Macro'>DirectFunctionCall3</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN305"><span class='Ref_to_Func'>g_int_same</span></a><span class='Delimiter'>, 
</span>                                    <a href="_int_gist.c.html#LN35"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Delimiter'>, 
</span>                                    <a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN36"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                    <a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="_int_gist.c.html#LN41"><span class='Ref_To_Local'>retval</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="_int_gist.c.html#LN41"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><a href="_int_tool.c.html#LN11"><span class='Ref_to_Func'>inner_int_contains</span></a><span class='Parentheses'>((</span><a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN35"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                            <a href="_int_gist.c.html#LN36"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../src/include/access/stratnum.h.html#LN49"><span class='Ref_to_Const'>RTContainsStrategyNumber</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../src/include/access/stratnum.h.html#LN55"><span class='Ref_to_Const'>RTOldContainsStrategyNumber</span></a><span class='Operator'>: 
</span>            <a href="_int_gist.c.html#LN41"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><a href="_int_tool.c.html#LN11"><span class='Ref_to_Func'>inner_int_contains</span></a><span class='Parentheses'>((</span><a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN35"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                        <a href="_int_gist.c.html#LN36"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../src/include/access/stratnum.h.html#LN50"><span class='Ref_to_Const'>RTContainedByStrategyNumber</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../src/include/access/stratnum.h.html#LN56"><span class='Ref_to_Const'>RTOldContainedByStrategyNumber</span></a><span class='Operator'>: 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN132"><span class='Ref_to_Macro'>GIST_LEAF</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN35"><span class='Ref_To_Local'>entry</span></a><span class='Parentheses'>))</span> 
                <a href="_int_gist.c.html#LN41"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><a href="_int_tool.c.html#LN11"><span class='Ref_to_Func'>inner_int_contains</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN36"><span class='Ref_To_Local'>query</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN35"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="_int_gist.c.html#LN41"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><a href="_int_tool.c.html#LN46"><span class='Ref_to_Func'>inner_int_overlap</span></a><span class='Parentheses'>((</span><a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN35"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                           <a href="_int_gist.c.html#LN36"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="_int_gist.c.html#LN41"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><span class='Boolean'>FALSE</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch strategy &raquo; </span> 
    <a href="../../src/include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN36"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN41"><span class='Ref_To_Local'>retval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end g_int_consistent &raquo; </span> 
 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN98"></a><span class='Declare_Function'>g_int_union</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN100"></a>    <a href="../../src/include/access/gist.h.html#LN157"><span class='Ref_to_Typedef'>GistEntryVector</span></a> <span class='Operator'>*</span><span class='Declare_Local'>entryvec</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN157"><span class='Ref_to_Typedef'>GistEntryVector</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN101"></a>    <span class='Keyword'>int</span>        <span class='Operator'>*</span><span class='Declare_Local'>size</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN102"></a>    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>i</span><span class='Delimiter'>, 
</span><a name="LN103"></a>               <span class='Operator'>*</span><span class='Declare_Local'>ptr</span><span class='Delimiter'>; 
</span><a name="LN104"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN105"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>totlen</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN102"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="_int_gist.c.html#LN102"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="_int_gist.c.html#LN100"><span class='Ref_To_Local'>entryvec</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN159"><span class='Ref_to_Member'>n</span></a><span class='Delimiter'>; </span><a href="_int_gist.c.html#LN102"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN109"></a>        <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>ent</span> <span class='Operator'>= </span><a href="_intbig_gist.c.html#LN10"><span class='Ref_to_Macro'>GETENTRY</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN100"><span class='Ref_To_Local'>entryvec</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN102"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="_int.h.html#LN17"><span class='Ref_to_Macro'>CHECKARRVALID</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN109"><span class='Ref_To_Local'>ent</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="_int_gist.c.html#LN105"><span class='Ref_To_Local'>totlen</span></a> <span class='Operator'>+= </span><a href="_int.h.html#LN14"><span class='Ref_to_Macro'>ARRNELEMS</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN109"><span class='Ref_To_Local'>ent</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="_int_gist.c.html#LN104"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="_int.h.html#LN97"><span class='Ref_to_Proto'>new_intArrayType</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN105"><span class='Ref_To_Local'>totlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="_int_gist.c.html#LN103"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>= </span><a href="_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN104"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN102"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="_int_gist.c.html#LN102"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="_int_gist.c.html#LN100"><span class='Ref_To_Local'>entryvec</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN159"><span class='Ref_to_Member'>n</span></a><span class='Delimiter'>; </span><a href="_int_gist.c.html#LN102"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN120"></a>        <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>ent</span> <span class='Operator'>= </span><a href="_intbig_gist.c.html#LN10"><span class='Ref_to_Macro'>GETENTRY</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN100"><span class='Ref_To_Local'>entryvec</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN102"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN121"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>nel</span><span class='Delimiter'>; 
</span> 
        <a href="_int_gist.c.html#LN121"><span class='Ref_To_Local'>nel</span></a> <span class='Operator'>= </span><a href="_int.h.html#LN14"><span class='Ref_to_Macro'>ARRNELEMS</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN120"><span class='Ref_To_Local'>ent</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        memcpy<span class='Parentheses'>(</span><a href="_int_gist.c.html#LN103"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>, </span><a href="_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN120"><span class='Ref_To_Local'>ent</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN121"><span class='Ref_To_Local'>nel</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="_int_gist.c.html#LN103"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>+= </span><a href="_int_gist.c.html#LN121"><span class='Ref_To_Local'>nel</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="_int.h.html#LN167"><span class='Ref_to_Macro'>QSORT</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN104"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="_int_gist.c.html#LN104"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="_int.h.html#LN101"><span class='Ref_to_Proto'>_int_unique</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN104"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="_int_gist.c.html#LN101"><span class='Ref_To_Local'>size</span></a> <span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN104"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN104"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end g_int_union &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
** GiST Compress and Decompress methods 
*/ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN138"></a><span class='Declare_Function'>g_int_compress</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN140"></a>    <a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>entry</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN141"></a>    <a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>retval</span><span class='Delimiter'>; 
</span><a name="LN142"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>r</span><span class='Delimiter'>; 
</span><a name="LN143"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span><a name="LN144"></a>    <span class='Keyword'>int</span>        <span class='Operator'>*</span><span class='Declare_Local'>dr</span><span class='Delimiter'>; 
</span><a name="LN145"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>, 
</span><a name="LN146"></a>                <span class='Declare_Local'>min</span><span class='Delimiter'>, 
</span><a name="LN147"></a>                <span class='Declare_Local'>cand</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN140"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN126"><span class='Ref_to_Member'>leafkey</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="_int_gist.c.html#LN142"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><a href="../../src/include/utils/array.h.html#LN242"><span class='Ref_to_Macro'>DatumGetArrayTypePCopy</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN140"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="_int.h.html#LN17"><span class='Ref_to_Macro'>CHECKARRVALID</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN142"><span class='Ref_To_Local'>r</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="_int.h.html#LN36"><span class='Ref_to_Macro'>PREPAREARR</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN142"><span class='Ref_To_Local'>r</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="_int.h.html#LN14"><span class='Ref_to_Macro'>ARRNELEMS</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN142"><span class='Ref_To_Local'>r</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>2</span> <span class='Operator'>* </span><a href="_int.h.html#LN10"><span class='Ref_to_Const'>MAXNUMRANGE</span></a><span class='Parentheses'>)</span> 
            <a href="../../src/backend/bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../src/include/utils/elog.h.html#LN36"><span class='Ref_to_Const'>NOTICE</span></a><span class='Delimiter'>, </span><span class='String'>"input array is too big (%d maximum allowed, %d current), use gist__intbig_ops opclass instead"</span><span class='Delimiter'>, 
</span>                 <span class='Number'>2</span> <span class='Operator'>* </span><a href="_int.h.html#LN10"><span class='Ref_to_Const'>MAXNUMRANGE</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="_int.h.html#LN14"><span class='Ref_to_Macro'>ARRNELEMS</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN142"><span class='Ref_To_Local'>r</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <a href="_int_gist.c.html#LN141"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/access/gist.h.html#LN168"><span class='Ref_to_Macro'>gistentryinit</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="_int_gist.c.html#LN141"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN142"><span class='Ref_To_Local'>r</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                      <a href="_int_gist.c.html#LN140"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN123"><span class='Ref_to_Member'>rel</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN140"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN124"><span class='Ref_to_Member'>page</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN140"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN125"><span class='Ref_to_Member'>offset</span></a><span class='Delimiter'>, </span><span class='Boolean'>FALSE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN141"><span class='Ref_To_Local'>retval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * leaf entries never compress one more time, only when entry-&GT;leafkey 
     * ==true, so now we work only with internal keys 
     */ 
</span> 
    <a href="_int_gist.c.html#LN142"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><a href="../../src/include/utils/array.h.html#LN241"><span class='Ref_to_Macro'>DatumGetArrayTypeP</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN140"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="_int.h.html#LN17"><span class='Ref_to_Macro'>CHECKARRVALID</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN142"><span class='Ref_To_Local'>r</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="_int.h.html#LN25"><span class='Ref_to_Macro'>ARRISEMPTY</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN142"><span class='Ref_To_Local'>r</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN142"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>!= </span><span class='Parentheses'>(</span><a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN140"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>))</span> 
            <a href="../../src/include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN142"><span class='Ref_To_Local'>r</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN140"><span class='Ref_To_Local'>entry</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="_int_gist.c.html#LN143"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="_int.h.html#LN14"><span class='Ref_to_Macro'>ARRNELEMS</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN142"><span class='Ref_To_Local'>r</span></a><span class='Parentheses'>))</span> <span class='Operator'>&GT;= </span><span class='Number'>2</span> <span class='Operator'>* </span><a href="_int.h.html#LN10"><span class='Ref_to_Const'>MAXNUMRANGE</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{</span>                           <span class='Comment_Single_Line'>/* compress */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN142"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>== </span><span class='Parentheses'>(</span><a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN140"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>))</span> 
            <a href="_int_gist.c.html#LN142"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><a href="../../src/include/utils/array.h.html#LN242"><span class='Ref_to_Macro'>DatumGetArrayTypePCopy</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN140"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="_int_gist.c.html#LN142"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><a href="_int.h.html#LN99"><span class='Ref_to_Proto'>resize_intArrayType</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN142"><span class='Ref_To_Local'>r</span></a><span class='Delimiter'>, </span><span class='Number'>2</span> <span class='Operator'>* </span><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN143"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <a href="_int_gist.c.html#LN144"><span class='Ref_To_Local'>dr</span></a> <span class='Operator'>= </span><a href="_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN142"><span class='Ref_To_Local'>r</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN145"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="_int_gist.c.html#LN143"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; </span><a href="_int_gist.c.html#LN145"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="_int_gist.c.html#LN145"><span class='Ref_To_Local'>i</span></a><span class='Operator'>--</span><span class='Parentheses'>) 
</span>            <a href="_int_gist.c.html#LN144"><span class='Ref_To_Local'>dr</span></a><span class='Delimiter'>[</span><span class='Number'>2</span> <span class='Operator'>* </span><a href="_int_gist.c.html#LN145"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="_int_gist.c.html#LN144"><span class='Ref_To_Local'>dr</span></a><span class='Delimiter'>[</span><span class='Number'>2</span> <span class='Operator'>* </span><a href="_int_gist.c.html#LN145"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="_int_gist.c.html#LN144"><span class='Ref_To_Local'>dr</span></a><span class='Delimiter'>[</span><a href="_int_gist.c.html#LN145"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span> 
        <a href="_int_gist.c.html#LN143"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>*= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>        <a href="_int_gist.c.html#LN147"><span class='Ref_To_Local'>cand</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN143"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>&GT; </span><a href="_int.h.html#LN10"><span class='Ref_to_Const'>MAXNUMRANGE</span></a> <span class='Operator'>* </span><span class='Number'>2</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="_int_gist.c.html#LN146"><span class='Ref_To_Local'>min</span></a> <span class='Operator'>= </span>INT_MAX<span class='Delimiter'>; 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN145"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; </span><a href="_int_gist.c.html#LN145"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="_int_gist.c.html#LN143"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; </span><a href="_int_gist.c.html#LN145"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>+= </span><span class='Number'>2</span><span class='Parentheses'>) 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN146"><span class='Ref_To_Local'>min</span></a> <span class='Operator'>&GT; </span><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN144"><span class='Ref_To_Local'>dr</span></a><span class='Delimiter'>[</span><a href="_int_gist.c.html#LN145"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>- </span><a href="_int_gist.c.html#LN144"><span class='Ref_To_Local'>dr</span></a><span class='Delimiter'>[</span><a href="_int_gist.c.html#LN145"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
                <span class='Delimiter'>{ 
</span>                    <a href="_int_gist.c.html#LN146"><span class='Ref_To_Local'>min</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN144"><span class='Ref_To_Local'>dr</span></a><span class='Delimiter'>[</span><a href="_int_gist.c.html#LN145"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>- </span><a href="_int_gist.c.html#LN144"><span class='Ref_To_Local'>dr</span></a><span class='Delimiter'>[</span><a href="_int_gist.c.html#LN145"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <a href="_int_gist.c.html#LN147"><span class='Ref_To_Local'>cand</span></a> <span class='Operator'>= </span><a href="_int_gist.c.html#LN145"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>            <a href="../../src/include/c.h.html#LN1057"><span class='Ref_to_Macro'>memmove</span></a><span class='Parentheses'>((</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="_int_gist.c.html#LN144"><span class='Ref_To_Local'>dr</span></a><span class='Delimiter'>[</span><a href="_int_gist.c.html#LN147"><span class='Ref_To_Local'>cand</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>], </span><span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="_int_gist.c.html#LN144"><span class='Ref_To_Local'>dr</span></a><span class='Delimiter'>[</span><a href="_int_gist.c.html#LN147"><span class='Ref_To_Local'>cand</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>], </span><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN143"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>- </span><a href="_int_gist.c.html#LN147"><span class='Ref_To_Local'>cand</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="_int_gist.c.html#LN143"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>-= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="_int_gist.c.html#LN142"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><a href="_int.h.html#LN99"><span class='Ref_to_Proto'>resize_intArrayType</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN142"><span class='Ref_To_Local'>r</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN143"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="_int_gist.c.html#LN141"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/access/gist.h.html#LN168"><span class='Ref_to_Macro'>gistentryinit</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="_int_gist.c.html#LN141"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN142"><span class='Ref_To_Local'>r</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                      <a href="_int_gist.c.html#LN140"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN123"><span class='Ref_to_Member'>rel</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN140"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN124"><span class='Ref_to_Member'>page</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN140"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN125"><span class='Ref_to_Member'>offset</span></a><span class='Delimiter'>, </span><span class='Boolean'>FALSE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN141"><span class='Ref_To_Local'>retval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if (len=ARRNELEMS(r))&GT;=2... &raquo; </span> 
    <span class='Control'>else</span> 
        <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN140"><span class='Ref_To_Local'>entry</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end g_int_compress &raquo; </span> 
 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN216"></a><span class='Declare_Function'>g_int_decompress</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN218"></a>    <a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>entry</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN219"></a>    <a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>retval</span><span class='Delimiter'>; 
</span><a name="LN220"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>r</span><span class='Delimiter'>; 
</span><a name="LN221"></a>    <span class='Keyword'>int</span>        <span class='Operator'>*</span><span class='Declare_Local'>dr</span><span class='Delimiter'>, 
</span><a name="LN222"></a>                <span class='Declare_Local'>lenr</span><span class='Delimiter'>; 
</span><a name="LN223"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>in</span><span class='Delimiter'>; 
</span><a name="LN224"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>lenin</span><span class='Delimiter'>; 
</span><a name="LN225"></a>    <span class='Keyword'>int</span>        <span class='Operator'>*</span><span class='Declare_Local'>din</span><span class='Delimiter'>; 
</span><a name="LN226"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>, 
</span><a name="LN227"></a>                <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span> 
    <a href="_int_gist.c.html#LN223"><span class='Ref_To_Local'>in</span></a> <span class='Operator'>= </span><a href="../../src/include/utils/array.h.html#LN241"><span class='Ref_to_Macro'>DatumGetArrayTypeP</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN218"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="_int.h.html#LN17"><span class='Ref_to_Macro'>CHECKARRVALID</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN223"><span class='Ref_To_Local'>in</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="_int.h.html#LN25"><span class='Ref_to_Macro'>ARRISEMPTY</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN223"><span class='Ref_To_Local'>in</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN223"><span class='Ref_To_Local'>in</span></a> <span class='Operator'>!= </span><span class='Parentheses'>(</span><a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN218"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="_int_gist.c.html#LN219"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="../../src/include/access/gist.h.html#LN168"><span class='Ref_to_Macro'>gistentryinit</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="_int_gist.c.html#LN219"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN223"><span class='Ref_To_Local'>in</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                          <a href="_int_gist.c.html#LN218"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN123"><span class='Ref_to_Member'>rel</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN218"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN124"><span class='Ref_to_Member'>page</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN218"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN125"><span class='Ref_to_Member'>offset</span></a><span class='Delimiter'>, </span><span class='Boolean'>FALSE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN219"><span class='Ref_To_Local'>retval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN218"><span class='Ref_To_Local'>entry</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="_int_gist.c.html#LN224"><span class='Ref_To_Local'>lenin</span></a> <span class='Operator'>= </span><a href="_int.h.html#LN14"><span class='Ref_to_Macro'>ARRNELEMS</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN223"><span class='Ref_To_Local'>in</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN224"><span class='Ref_To_Local'>lenin</span></a> <span class='Operator'>&LT; </span><span class='Number'>2</span> <span class='Operator'>* </span><a href="_int.h.html#LN10"><span class='Ref_to_Const'>MAXNUMRANGE</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{</span>                           <span class='Comment_Single_Line'>/* not compressed value */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN223"><span class='Ref_To_Local'>in</span></a> <span class='Operator'>!= </span><span class='Parentheses'>(</span><a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN218"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="_int_gist.c.html#LN219"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="../../src/include/access/gist.h.html#LN168"><span class='Ref_to_Macro'>gistentryinit</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="_int_gist.c.html#LN219"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN223"><span class='Ref_To_Local'>in</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                          <a href="_int_gist.c.html#LN218"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN123"><span class='Ref_to_Member'>rel</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN218"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN124"><span class='Ref_to_Member'>page</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN218"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN125"><span class='Ref_to_Member'>offset</span></a><span class='Delimiter'>, </span><span class='Boolean'>FALSE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN219"><span class='Ref_To_Local'>retval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN218"><span class='Ref_To_Local'>entry</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="_int_gist.c.html#LN225"><span class='Ref_To_Local'>din</span></a> <span class='Operator'>= </span><a href="_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN223"><span class='Ref_To_Local'>in</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="_int_gist.c.html#LN222"><span class='Ref_To_Local'>lenr</span></a> <span class='Operator'>= </span><a href="_int.h.html#LN100"><span class='Ref_to_Proto'>internal_size</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN225"><span class='Ref_To_Local'>din</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN224"><span class='Ref_To_Local'>lenin</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="_int_gist.c.html#LN220"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><a href="_int.h.html#LN97"><span class='Ref_to_Proto'>new_intArrayType</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN222"><span class='Ref_To_Local'>lenr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="_int_gist.c.html#LN221"><span class='Ref_To_Local'>dr</span></a> <span class='Operator'>= </span><a href="_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN220"><span class='Ref_To_Local'>r</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN226"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="_int_gist.c.html#LN226"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="_int_gist.c.html#LN224"><span class='Ref_To_Local'>lenin</span></a><span class='Delimiter'>; </span><a href="_int_gist.c.html#LN226"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>+= </span><span class='Number'>2</span><span class='Parentheses'>) 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN227"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><a href="_int_gist.c.html#LN225"><span class='Ref_To_Local'>din</span></a><span class='Delimiter'>[</span><a href="_int_gist.c.html#LN226"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; </span><a href="_int_gist.c.html#LN227"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT;= </span><a href="_int_gist.c.html#LN225"><span class='Ref_To_Local'>din</span></a><span class='Delimiter'>[</span><a href="_int_gist.c.html#LN226"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>]; </span><a href="_int_gist.c.html#LN227"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>            <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>!</span><a href="_int_gist.c.html#LN226"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) </span><span class='Operator'>|| *</span><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN221"><span class='Ref_To_Local'>dr</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="_int_gist.c.html#LN227"><span class='Ref_To_Local'>j</span></a><span class='Parentheses'>)</span> 
                <span class='Operator'>*</span><a href="_int_gist.c.html#LN221"><span class='Ref_To_Local'>dr</span></a><span class='Operator'>++ = </span><a href="_int_gist.c.html#LN227"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN223"><span class='Ref_To_Local'>in</span></a> <span class='Operator'>!= </span><span class='Parentheses'>(</span><a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN218"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>))</span> 
        <a href="../../src/include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN223"><span class='Ref_To_Local'>in</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="_int_gist.c.html#LN219"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/access/gist.h.html#LN168"><span class='Ref_to_Macro'>gistentryinit</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="_int_gist.c.html#LN219"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN220"><span class='Ref_To_Local'>r</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                  <a href="_int_gist.c.html#LN218"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN123"><span class='Ref_to_Member'>rel</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN218"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN124"><span class='Ref_to_Member'>page</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN218"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN125"><span class='Ref_to_Member'>offset</span></a><span class='Delimiter'>, </span><span class='Boolean'>FALSE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN219"><span class='Ref_To_Local'>retval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end g_int_decompress &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
** The GiST Penalty method for _intments 
*/ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN284"></a><span class='Declare_Function'>g_int_penalty</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN286"></a>    <a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>origentry</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN287"></a>    <a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>newentry</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN288"></a>    <span class='Keyword'>float</span>      <span class='Operator'>*</span><span class='Declare_Local'>result</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>float </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN289"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>ud</span><span class='Delimiter'>; 
</span><a name="LN290"></a>    <span class='Keyword'>float</span>       <span class='Declare_Local'>tmp1</span><span class='Delimiter'>, 
</span><a name="LN291"></a>                <span class='Declare_Local'>tmp2</span><span class='Delimiter'>; 
</span> 
    <a href="_int_gist.c.html#LN289"><span class='Ref_To_Local'>ud</span></a> <span class='Operator'>= </span><a href="_int_tool.c.html#LN75"><span class='Ref_to_Func'>inner_int_union</span></a><span class='Parentheses'>((</span><a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN286"><span class='Ref_To_Local'>origentry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <span class='Parentheses'>(</span><a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN287"><span class='Ref_To_Local'>newentry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="_int.h.html#LN110"><span class='Ref_to_Proto'>rt__int_size</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN289"><span class='Ref_To_Local'>ud</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="_int_gist.c.html#LN290"><span class='Ref_To_Local'>tmp1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="_int.h.html#LN110"><span class='Ref_to_Proto'>rt__int_size</span></a><span class='Parentheses'>((</span><a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN286"><span class='Ref_To_Local'>origentry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="_int_gist.c.html#LN291"><span class='Ref_To_Local'>tmp2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="_int_gist.c.html#LN288"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="_int_gist.c.html#LN290"><span class='Ref_To_Local'>tmp1</span></a> <span class='Operator'>- </span><a href="_int_gist.c.html#LN291"><span class='Ref_To_Local'>tmp2</span></a><span class='Delimiter'>; 
</span>    <a href="../../src/include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN289"><span class='Ref_To_Local'>ud</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN288"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN306"></a><span class='Declare_Function'>g_int_same</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN308"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>a</span> <span class='Operator'>= </span><a href="../../src/include/utils/array.h.html#LN243"><span class='Ref_to_Macro'>PG_GETARG_ARRAYTYPE_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN309"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>b</span> <span class='Operator'>= </span><a href="../../src/include/utils/array.h.html#LN243"><span class='Ref_to_Macro'>PG_GETARG_ARRAYTYPE_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN310"></a>    <span class='Keyword'>bool</span>       <span class='Operator'>*</span><span class='Declare_Local'>result</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN311"></a>    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>n</span> <span class='Operator'>= </span><a href="_int.h.html#LN14"><span class='Ref_to_Macro'>ARRNELEMS</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN308"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN312"></a>    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>da</span><span class='Delimiter'>, 
</span><a name="LN313"></a>               <span class='Operator'>*</span><span class='Declare_Local'>db</span><span class='Delimiter'>; 
</span> 
    <a href="_int.h.html#LN17"><span class='Ref_to_Macro'>CHECKARRVALID</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN308"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="_int.h.html#LN17"><span class='Ref_to_Macro'>CHECKARRVALID</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN309"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN311"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>!= </span><a href="_int.h.html#LN14"><span class='Ref_to_Macro'>ARRNELEMS</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN309"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Operator'>*</span><a href="_int_gist.c.html#LN310"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN310"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Operator'>*</span><a href="_int_gist.c.html#LN310"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Boolean'>TRUE</span><span class='Delimiter'>; 
</span>    <a href="_int_gist.c.html#LN312"><span class='Ref_To_Local'>da</span></a> <span class='Operator'>= </span><a href="_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN308"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="_int_gist.c.html#LN313"><span class='Ref_To_Local'>db</span></a> <span class='Operator'>= </span><a href="_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN309"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN311"><span class='Ref_To_Local'>n</span></a><span class='Operator'>--</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="_int_gist.c.html#LN312"><span class='Ref_To_Local'>da</span></a><span class='Operator'>++ != *</span><a href="_int_gist.c.html#LN313"><span class='Ref_To_Local'>db</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="_int_gist.c.html#LN310"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Boolean'>FALSE</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN310"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end g_int_same &raquo; </span> 
 
<span class='Comment_Multi_Line'>/***************************************************************** 
** Common GiST Method 
*****************************************************************/ 
</span> 
<span class='Control'>typedef</span> <span class='Control'>struct</span> 
<span class='Delimiter'>{ 
</span><a name="LN344"></a>    <a href="../../src/include/storage/off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Declare_Member'>pos</span><span class='Delimiter'>; 
</span><a name="LN345"></a>    <span class='Keyword'>float</span>       <span class='Declare_Member'>cost</span><span class='Delimiter'>; 
</span><a name="LN346"></a>} <span class='Declare_Typedef'>SPLITCOST</span><span class='Delimiter'>; 
</span> 
<span class='Keyword'>static int 
</span><a name="LN349"></a><span class='Declare_Function'>comparecost</span><span class='Parentheses'>(</span><span class='Keyword'>const void </span><span class='Operator'>*</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><span class='Keyword'>const void </span><span class='Operator'>*</span><span class='Declare_Parameter'>b</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(((</span><span class='Keyword'>const </span><a href="../hstore/hstore_gist.c.html#LN320"><span class='Ref_to_Typedef'>SPLITCOST</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="_int_gist.c.html#LN349"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>cost <span class='Operator'>== </span><span class='Parentheses'>((</span><span class='Keyword'>const </span><a href="../hstore/hstore_gist.c.html#LN320"><span class='Ref_to_Typedef'>SPLITCOST</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="_int_gist.c.html#LN349"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>cost<span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <span class='Parentheses'>(((</span><span class='Keyword'>const </span><a href="../hstore/hstore_gist.c.html#LN320"><span class='Ref_to_Typedef'>SPLITCOST</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="_int_gist.c.html#LN349"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>cost <span class='Operator'>&GT; </span><span class='Parentheses'>((</span><span class='Keyword'>const </span><a href="../hstore/hstore_gist.c.html#LN320"><span class='Ref_to_Typedef'>SPLITCOST</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="_int_gist.c.html#LN349"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>cost<span class='Parentheses'>)</span> <span class='Operator'>? </span><span class='Number'>1</span> <span class='Operator'>: -</span><span class='Number'>1</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
** The GiST PickSplit method for _intments 
** We use Guttman's poly time split algorithm 
*/ 
</span><a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN362"></a><span class='Declare_Function'>g_int_picksplit</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN364"></a>    <a href="../../src/include/access/gist.h.html#LN157"><span class='Ref_to_Typedef'>GistEntryVector</span></a> <span class='Operator'>*</span><span class='Declare_Local'>entryvec</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN157"><span class='Ref_to_Typedef'>GistEntryVector</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN365"></a>    <a href="../../src/include/access/gist.h.html#LN102"><span class='Ref_to_Struct'>GIST_SPLITVEC</span></a> <span class='Operator'>*</span><span class='Declare_Local'>v</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN102"><span class='Ref_to_Struct'>GIST_SPLITVEC</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN366"></a>    <a href="../../src/include/storage/off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Declare_Local'>i</span><span class='Delimiter'>, 
</span><a name="LN367"></a>                <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span><a name="LN368"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>datum_alpha</span><span class='Delimiter'>, 
</span><a name="LN369"></a>               <span class='Operator'>*</span><span class='Declare_Local'>datum_beta</span><span class='Delimiter'>; 
</span><a name="LN370"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>datum_l</span><span class='Delimiter'>, 
</span><a name="LN371"></a>               <span class='Operator'>*</span><span class='Declare_Local'>datum_r</span><span class='Delimiter'>; 
</span><a name="LN372"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>union_d</span><span class='Delimiter'>, 
</span><a name="LN373"></a>               <span class='Operator'>*</span><span class='Declare_Local'>union_dl</span><span class='Delimiter'>, 
</span><a name="LN374"></a>               <span class='Operator'>*</span><span class='Declare_Local'>union_dr</span><span class='Delimiter'>; 
</span><a name="LN375"></a>    <a href="../../src/include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>inter_d</span><span class='Delimiter'>; 
</span><a name="LN376"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>firsttime</span><span class='Delimiter'>; 
</span><a name="LN377"></a>    <span class='Keyword'>float</span>       <span class='Declare_Local'>size_alpha</span><span class='Delimiter'>, 
</span><a name="LN378"></a>                <span class='Declare_Local'>size_beta</span><span class='Delimiter'>, 
</span><a name="LN379"></a>                <span class='Declare_Local'>size_union</span><span class='Delimiter'>, 
</span><a name="LN380"></a>                <span class='Declare_Local'>size_inter</span><span class='Delimiter'>; 
</span><a name="LN381"></a>    <span class='Keyword'>float</span>       <span class='Declare_Local'>size_waste</span><span class='Delimiter'>, 
</span><a name="LN382"></a>                <span class='Declare_Local'>waste</span><span class='Delimiter'>; 
</span><a name="LN383"></a>    <span class='Keyword'>float</span>       <span class='Declare_Local'>size_l</span><span class='Delimiter'>, 
</span><a name="LN384"></a>                <span class='Declare_Local'>size_r</span><span class='Delimiter'>; 
</span><a name="LN385"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>nbytes</span><span class='Delimiter'>; 
</span><a name="LN386"></a>    <a href="../../src/include/storage/off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Declare_Local'>seed_1</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>, 
</span><a name="LN387"></a>                <span class='Declare_Local'>seed_2</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN388"></a>    <a href="../../src/include/storage/off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Operator'>*</span><span class='Declare_Local'>left</span><span class='Delimiter'>, 
</span><a name="LN389"></a>               <span class='Operator'>*</span><span class='Declare_Local'>right</span><span class='Delimiter'>; 
</span><a name="LN390"></a>    <a href="../../src/include/storage/off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Declare_Local'>maxoff</span><span class='Delimiter'>; 
</span><a name="LN391"></a>    <a href="../hstore/hstore_gist.c.html#LN320"><span class='Ref_to_Typedef'>SPLITCOST</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>costvector</span><span class='Delimiter'>; 
</span> 
<span class='Directive'>#ifdef</span> GIST_DEBUG 
    <a href="../../src/backend/bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../src/include/utils/elog.h.html#LN22"><span class='Ref_to_Const'>DEBUG3</span></a><span class='Delimiter'>, </span><span class='String'>"--------picksplit %d"</span><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN364"><span class='Ref_To_Local'>entryvec</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN159"><span class='Ref_to_Member'>n</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
 
    <a href="_int_gist.c.html#LN390"><span class='Ref_To_Local'>maxoff</span></a> <span class='Operator'>= </span><a href="_int_gist.c.html#LN364"><span class='Ref_To_Local'>entryvec</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN159"><span class='Ref_to_Member'>n</span></a> <span class='Operator'>- </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <a href="_int_gist.c.html#LN385"><span class='Ref_To_Local'>nbytes</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN390"><span class='Ref_To_Local'>maxoff</span></a> <span class='Operator'>+ </span><span class='Number'>2</span><span class='Parentheses'>) </span><span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../src/include/storage/off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="_int_gist.c.html#LN365"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN104"><span class='Ref_to_Member'>spl_left</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/storage/off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN385"><span class='Ref_To_Local'>nbytes</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="_int_gist.c.html#LN365"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN109"><span class='Ref_to_Member'>spl_right</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/storage/off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN385"><span class='Ref_To_Local'>nbytes</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="_int_gist.c.html#LN376"><span class='Ref_To_Local'>firsttime</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <a href="_int_gist.c.html#LN382"><span class='Ref_To_Local'>waste</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN366"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN26"><span class='Ref_to_Const'>FirstOffsetNumber</span></a><span class='Delimiter'>; </span><a href="_int_gist.c.html#LN366"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="_int_gist.c.html#LN390"><span class='Ref_To_Local'>maxoff</span></a><span class='Delimiter'>; </span><a href="_int_gist.c.html#LN366"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN52"><span class='Ref_to_Macro'>OffsetNumberNext</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN366"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="_int_gist.c.html#LN368"><span class='Ref_To_Local'>datum_alpha</span></a> <span class='Operator'>= </span><a href="_intbig_gist.c.html#LN10"><span class='Ref_to_Macro'>GETENTRY</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN364"><span class='Ref_To_Local'>entryvec</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN366"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN367"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN52"><span class='Ref_to_Macro'>OffsetNumberNext</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN366"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="_int_gist.c.html#LN367"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT;= </span><a href="_int_gist.c.html#LN390"><span class='Ref_To_Local'>maxoff</span></a><span class='Delimiter'>; </span><a href="_int_gist.c.html#LN367"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN52"><span class='Ref_to_Macro'>OffsetNumberNext</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN367"><span class='Ref_To_Local'>j</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="_int_gist.c.html#LN369"><span class='Ref_To_Local'>datum_beta</span></a> <span class='Operator'>= </span><a href="_intbig_gist.c.html#LN10"><span class='Ref_to_Macro'>GETENTRY</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN364"><span class='Ref_To_Local'>entryvec</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN367"><span class='Ref_To_Local'>j</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* compute the wasted space by unioning these guys */ 
</span>            <span class='Comment_Multi_Line'>/* size_waste = size_union - size_inter; */ 
</span>            <a href="_int_gist.c.html#LN372"><span class='Ref_To_Local'>union_d</span></a> <span class='Operator'>= </span><a href="_int_tool.c.html#LN75"><span class='Ref_to_Func'>inner_int_union</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN368"><span class='Ref_To_Local'>datum_alpha</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN369"><span class='Ref_To_Local'>datum_beta</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="_int.h.html#LN110"><span class='Ref_to_Proto'>rt__int_size</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN372"><span class='Ref_To_Local'>union_d</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="_int_gist.c.html#LN379"><span class='Ref_To_Local'>size_union</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="_int_gist.c.html#LN375"><span class='Ref_To_Local'>inter_d</span></a> <span class='Operator'>= </span><a href="_int.h.html#LN109"><span class='Ref_to_Proto'>inner_int_inter</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN368"><span class='Ref_To_Local'>datum_alpha</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN369"><span class='Ref_To_Local'>datum_beta</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="_int.h.html#LN110"><span class='Ref_to_Proto'>rt__int_size</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN375"><span class='Ref_To_Local'>inter_d</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="_int_gist.c.html#LN380"><span class='Ref_To_Local'>size_inter</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="_int_gist.c.html#LN381"><span class='Ref_To_Local'>size_waste</span></a> <span class='Operator'>= </span><a href="_int_gist.c.html#LN379"><span class='Ref_To_Local'>size_union</span></a> <span class='Operator'>- </span><a href="_int_gist.c.html#LN380"><span class='Ref_To_Local'>size_inter</span></a><span class='Delimiter'>; 
</span> 
            <a href="../../src/include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN372"><span class='Ref_To_Local'>union_d</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../src/include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN375"><span class='Ref_To_Local'>inter_d</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * are these a more promising split that what we've already seen? 
             */ 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN381"><span class='Ref_To_Local'>size_waste</span></a> <span class='Operator'>&GT; </span><a href="_int_gist.c.html#LN382"><span class='Ref_To_Local'>waste</span></a> <span class='Operator'>|| </span><a href="_int_gist.c.html#LN376"><span class='Ref_To_Local'>firsttime</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="_int_gist.c.html#LN382"><span class='Ref_To_Local'>waste</span></a> <span class='Operator'>= </span><a href="_int_gist.c.html#LN381"><span class='Ref_To_Local'>size_waste</span></a><span class='Delimiter'>; 
</span>                <a href="_int_gist.c.html#LN386"><span class='Ref_To_Local'>seed_1</span></a> <span class='Operator'>= </span><a href="_int_gist.c.html#LN366"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>                <a href="_int_gist.c.html#LN387"><span class='Ref_To_Local'>seed_2</span></a> <span class='Operator'>= </span><a href="_int_gist.c.html#LN367"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>; 
</span>                <a href="_int_gist.c.html#LN376"><span class='Ref_To_Local'>firsttime</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for j=OffsetNumberNext(i)... &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=FirstOffsetNumber;i... &raquo; </span> 
 
    <a href="_int_gist.c.html#LN388"><span class='Ref_To_Local'>left</span></a> <span class='Operator'>= </span><a href="_int_gist.c.html#LN365"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN104"><span class='Ref_to_Member'>spl_left</span></a><span class='Delimiter'>; 
</span>    <a href="_int_gist.c.html#LN365"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN105"><span class='Ref_to_Member'>spl_nleft</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="_int_gist.c.html#LN389"><span class='Ref_To_Local'>right</span></a> <span class='Operator'>= </span><a href="_int_gist.c.html#LN365"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN109"><span class='Ref_to_Member'>spl_right</span></a><span class='Delimiter'>; 
</span>    <a href="_int_gist.c.html#LN365"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN110"><span class='Ref_to_Member'>spl_nright</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN386"><span class='Ref_To_Local'>seed_1</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="_int_gist.c.html#LN387"><span class='Ref_To_Local'>seed_2</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="_int_gist.c.html#LN386"><span class='Ref_To_Local'>seed_1</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <a href="_int_gist.c.html#LN387"><span class='Ref_To_Local'>seed_2</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="_int_gist.c.html#LN368"><span class='Ref_To_Local'>datum_alpha</span></a> <span class='Operator'>= </span><a href="_intbig_gist.c.html#LN10"><span class='Ref_to_Macro'>GETENTRY</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN364"><span class='Ref_To_Local'>entryvec</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN386"><span class='Ref_To_Local'>seed_1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="_int_gist.c.html#LN370"><span class='Ref_To_Local'>datum_l</span></a> <span class='Operator'>= </span><a href="_int.h.html#LN98"><span class='Ref_to_Proto'>copy_intArrayType</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN368"><span class='Ref_To_Local'>datum_alpha</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="_int.h.html#LN110"><span class='Ref_to_Proto'>rt__int_size</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN370"><span class='Ref_To_Local'>datum_l</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="_int_gist.c.html#LN383"><span class='Ref_To_Local'>size_l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="_int_gist.c.html#LN369"><span class='Ref_To_Local'>datum_beta</span></a> <span class='Operator'>= </span><a href="_intbig_gist.c.html#LN10"><span class='Ref_to_Macro'>GETENTRY</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN364"><span class='Ref_To_Local'>entryvec</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN387"><span class='Ref_To_Local'>seed_2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="_int_gist.c.html#LN371"><span class='Ref_To_Local'>datum_r</span></a> <span class='Operator'>= </span><a href="_int.h.html#LN98"><span class='Ref_to_Proto'>copy_intArrayType</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN369"><span class='Ref_To_Local'>datum_beta</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="_int.h.html#LN110"><span class='Ref_to_Proto'>rt__int_size</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN371"><span class='Ref_To_Local'>datum_r</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="_int_gist.c.html#LN384"><span class='Ref_To_Local'>size_r</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="_int_gist.c.html#LN390"><span class='Ref_To_Local'>maxoff</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN52"><span class='Ref_to_Macro'>OffsetNumberNext</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN390"><span class='Ref_To_Local'>maxoff</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * sort entries 
     */ 
</span>    <a href="_int_gist.c.html#LN391"><span class='Ref_To_Local'>costvector</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN320"><span class='Ref_to_Typedef'>SPLITCOST</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN320"><span class='Ref_to_Typedef'>SPLITCOST</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="_int_gist.c.html#LN390"><span class='Ref_To_Local'>maxoff</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN366"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN26"><span class='Ref_to_Const'>FirstOffsetNumber</span></a><span class='Delimiter'>; </span><a href="_int_gist.c.html#LN366"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT;= </span><a href="_int_gist.c.html#LN390"><span class='Ref_To_Local'>maxoff</span></a><span class='Delimiter'>; </span><a href="_int_gist.c.html#LN366"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN52"><span class='Ref_to_Macro'>OffsetNumberNext</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN366"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="_int_gist.c.html#LN391"><span class='Ref_To_Local'>costvector</span></a><span class='Delimiter'>[</span><a href="_int_gist.c.html#LN366"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/backend/utils/adt/tsquery_gist.c.html#LN152"><span class='Ref_to_Member'>pos</span></a> <span class='Operator'>= </span><a href="_int_gist.c.html#LN366"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>        <a href="_int_gist.c.html#LN368"><span class='Ref_To_Local'>datum_alpha</span></a> <span class='Operator'>= </span><a href="_intbig_gist.c.html#LN10"><span class='Ref_to_Macro'>GETENTRY</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN364"><span class='Ref_To_Local'>entryvec</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN366"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="_int_gist.c.html#LN372"><span class='Ref_To_Local'>union_d</span></a> <span class='Operator'>= </span><a href="_int_tool.c.html#LN75"><span class='Ref_to_Func'>inner_int_union</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN370"><span class='Ref_To_Local'>datum_l</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN368"><span class='Ref_To_Local'>datum_alpha</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="_int.h.html#LN110"><span class='Ref_to_Proto'>rt__int_size</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN372"><span class='Ref_To_Local'>union_d</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="_int_gist.c.html#LN377"><span class='Ref_To_Local'>size_alpha</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN372"><span class='Ref_To_Local'>union_d</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="_int_gist.c.html#LN372"><span class='Ref_To_Local'>union_d</span></a> <span class='Operator'>= </span><a href="_int_tool.c.html#LN75"><span class='Ref_to_Func'>inner_int_union</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN371"><span class='Ref_To_Local'>datum_r</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN368"><span class='Ref_To_Local'>datum_alpha</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="_int.h.html#LN110"><span class='Ref_to_Proto'>rt__int_size</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN372"><span class='Ref_To_Local'>union_d</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="_int_gist.c.html#LN378"><span class='Ref_To_Local'>size_beta</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN372"><span class='Ref_To_Local'>union_d</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="_int_gist.c.html#LN391"><span class='Ref_To_Local'>costvector</span></a><span class='Delimiter'>[</span><a href="_int_gist.c.html#LN366"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/backend/utils/adt/tsquery_gist.c.html#LN153"><span class='Ref_to_Member'>cost</span></a> <span class='Operator'>= </span><a href="../../src/include/c.h.html#LN811"><span class='Ref_to_Macro'>Abs</span></a><span class='Parentheses'>((</span><a href="_int_gist.c.html#LN377"><span class='Ref_To_Local'>size_alpha</span></a> <span class='Operator'>- </span><a href="_int_gist.c.html#LN383"><span class='Ref_To_Local'>size_l</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN378"><span class='Ref_To_Local'>size_beta</span></a> <span class='Operator'>- </span><a href="_int_gist.c.html#LN384"><span class='Ref_To_Local'>size_r</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="../../src/include/port.h.html#LN439"><span class='Ref_to_Macro'>qsort</span></a><span class='Parentheses'>((</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="_int_gist.c.html#LN391"><span class='Ref_To_Local'>costvector</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN390"><span class='Ref_To_Local'>maxoff</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN320"><span class='Ref_to_Typedef'>SPLITCOST</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../../src/backend/utils/adt/tsquery_gist.c.html#LN156"><span class='Ref_to_Func'>comparecost</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Now split up the regions between the two seeds.  An important property 
     * of this split algorithm is that the split vector v has the indices of 
     * items to be split in order in its left and right vectors.  We exploit 
     * this property by doing a merge in the code that actually splits the 
     * page. 
     * 
     * For efficiency, we also place the new index tuple in this loop. This is 
     * handled at the very end, when we have placed all the existing tuples 
     * and i == maxoff + 1. 
     */ 
</span> 
 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN367"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="_int_gist.c.html#LN367"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><a href="_int_gist.c.html#LN390"><span class='Ref_To_Local'>maxoff</span></a><span class='Delimiter'>; </span><a href="_int_gist.c.html#LN367"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="_int_gist.c.html#LN366"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="_int_gist.c.html#LN391"><span class='Ref_To_Local'>costvector</span></a><span class='Delimiter'>[</span><a href="_int_gist.c.html#LN367"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/backend/utils/adt/tsquery_gist.c.html#LN152"><span class='Ref_to_Member'>pos</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If we've already decided where to place this item, just put it on 
         * the right list.  Otherwise, we need to figure out which page needs 
         * the least enlargement in order to store the item. 
         */ 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN366"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>== </span><a href="_int_gist.c.html#LN386"><span class='Ref_To_Local'>seed_1</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="_int_gist.c.html#LN388"><span class='Ref_To_Local'>left</span></a><span class='Operator'>++ = </span><a href="_int_gist.c.html#LN366"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>            <a href="_int_gist.c.html#LN365"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN105"><span class='Ref_to_Member'>spl_nleft</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN366"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>== </span><a href="_int_gist.c.html#LN387"><span class='Ref_To_Local'>seed_2</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="_int_gist.c.html#LN389"><span class='Ref_To_Local'>right</span></a><span class='Operator'>++ = </span><a href="_int_gist.c.html#LN366"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>            <a href="_int_gist.c.html#LN365"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN110"><span class='Ref_to_Member'>spl_nright</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* okay, which page needs least enlargement? */ 
</span>        <a href="_int_gist.c.html#LN368"><span class='Ref_To_Local'>datum_alpha</span></a> <span class='Operator'>= </span><a href="_intbig_gist.c.html#LN10"><span class='Ref_to_Macro'>GETENTRY</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN364"><span class='Ref_To_Local'>entryvec</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN366"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="_int_gist.c.html#LN373"><span class='Ref_To_Local'>union_dl</span></a> <span class='Operator'>= </span><a href="_int_tool.c.html#LN75"><span class='Ref_to_Func'>inner_int_union</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN370"><span class='Ref_To_Local'>datum_l</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN368"><span class='Ref_To_Local'>datum_alpha</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="_int_gist.c.html#LN374"><span class='Ref_To_Local'>union_dr</span></a> <span class='Operator'>= </span><a href="_int_tool.c.html#LN75"><span class='Ref_to_Func'>inner_int_union</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN371"><span class='Ref_To_Local'>datum_r</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN368"><span class='Ref_To_Local'>datum_alpha</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="_int.h.html#LN110"><span class='Ref_to_Proto'>rt__int_size</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN373"><span class='Ref_To_Local'>union_dl</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="_int_gist.c.html#LN377"><span class='Ref_To_Local'>size_alpha</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="_int.h.html#LN110"><span class='Ref_to_Proto'>rt__int_size</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN374"><span class='Ref_To_Local'>union_dr</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="_int_gist.c.html#LN378"><span class='Ref_To_Local'>size_beta</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* pick which page to add it to */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="_int_gist.c.html#LN377"><span class='Ref_To_Local'>size_alpha</span></a> <span class='Operator'>- </span><a href="_int_gist.c.html#LN383"><span class='Ref_To_Local'>size_l</span></a> <span class='Operator'>&LT; </span><a href="_int_gist.c.html#LN378"><span class='Ref_To_Local'>size_beta</span></a> <span class='Operator'>- </span><a href="_int_gist.c.html#LN384"><span class='Ref_To_Local'>size_r</span></a> <span class='Operator'>+ </span><a href="_int.h.html#LN45"><span class='Ref_to_Macro'>WISH_F</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN365"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN105"><span class='Ref_to_Member'>spl_nleft</span></a><span class='Delimiter'>, </span><a href="_int_gist.c.html#LN365"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN110"><span class='Ref_to_Member'>spl_nright</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>01</span><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="../../src/include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN370"><span class='Ref_To_Local'>datum_l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../src/include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN374"><span class='Ref_To_Local'>union_dr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="_int_gist.c.html#LN370"><span class='Ref_To_Local'>datum_l</span></a> <span class='Operator'>= </span><a href="_int_gist.c.html#LN373"><span class='Ref_To_Local'>union_dl</span></a><span class='Delimiter'>; 
</span>            <a href="_int_gist.c.html#LN383"><span class='Ref_To_Local'>size_l</span></a> <span class='Operator'>= </span><a href="_int_gist.c.html#LN377"><span class='Ref_To_Local'>size_alpha</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="_int_gist.c.html#LN388"><span class='Ref_To_Local'>left</span></a><span class='Operator'>++ = </span><a href="_int_gist.c.html#LN366"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>            <a href="_int_gist.c.html#LN365"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN105"><span class='Ref_to_Member'>spl_nleft</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="../../src/include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN371"><span class='Ref_To_Local'>datum_r</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../src/include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN373"><span class='Ref_To_Local'>union_dl</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="_int_gist.c.html#LN371"><span class='Ref_To_Local'>datum_r</span></a> <span class='Operator'>= </span><a href="_int_gist.c.html#LN374"><span class='Ref_To_Local'>union_dr</span></a><span class='Delimiter'>; 
</span>            <a href="_int_gist.c.html#LN384"><span class='Ref_To_Local'>size_r</span></a> <span class='Operator'>= </span><a href="_int_gist.c.html#LN378"><span class='Ref_To_Local'>size_beta</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="_int_gist.c.html#LN389"><span class='Ref_To_Local'>right</span></a><span class='Operator'>++ = </span><a href="_int_gist.c.html#LN366"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>            <a href="_int_gist.c.html#LN365"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN110"><span class='Ref_to_Member'>spl_nright</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for j=0;j&LT;maxoff;j++ &raquo; </span> 
    <a href="../../src/include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN391"><span class='Ref_To_Local'>costvector</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="_int_gist.c.html#LN389"><span class='Ref_To_Local'>right</span></a> <span class='Operator'>= *</span><a href="_int_gist.c.html#LN388"><span class='Ref_To_Local'>left</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN26"><span class='Ref_to_Const'>FirstOffsetNumber</span></a><span class='Delimiter'>; 
</span> 
    <a href="_int_gist.c.html#LN365"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN106"><span class='Ref_to_Member'>spl_ldatum</span></a> <span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN370"><span class='Ref_To_Local'>datum_l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="_int_gist.c.html#LN365"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN111"><span class='Ref_to_Member'>spl_rdatum</span></a> <span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN371"><span class='Ref_To_Local'>datum_r</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="_int_gist.c.html#LN365"><span class='Ref_To_Local'>v</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end g_int_picksplit &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>