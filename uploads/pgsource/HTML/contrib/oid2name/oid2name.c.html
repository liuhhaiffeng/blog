<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>contrib\oid2name\oid2name.c</title>
<LINK REL=StyleSheet HREF="../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>contrib\oid2name\oid2name.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:25 2017
</td></tr>
<tr><td><a href='../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/* 
 * oid2name, a PostgreSQL app to map OIDs on the filesystem 
 * to table and database names. 
 * 
 * Originally by 
 * B. Palmer, bpalmer@crimelabs.net 1-17-2001 
 * 
 * contrib/oid2name/oid2name.c 
 */ 
</span><span class='Keyword'>#include </span><span class='String'>"postgres_fe.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_class.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>"libpq-fe.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"pg_getopt.h"</span> 
 
<span class='Comment_Multi_Line'>/* an extensible array to keep track of elements to show */ 
</span><span class='Control'>typedef</span> <span class='Control'>struct</span> 
<span class='Delimiter'>{ 
</span><a name="LN19"></a>    <span class='Keyword'>char</span>      <span class='Operator'>**</span><span class='Declare_Member'>array</span><span class='Delimiter'>; 
</span><a name="LN20"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>num</span><span class='Delimiter'>; 
</span><a name="LN21"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>alloc</span><span class='Delimiter'>; 
</span><a name="LN22"></a>} <span class='Declare_Typedef'>eary</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* these are the opts structures for command line params */ 
</span><a name="LN25"></a><span class='Control'>struct</span> <span class='Declare_Struct'>options</span> 
<span class='Delimiter'>{ 
</span><a name="LN27"></a>    <a href="oid2name.c.html#LN17"><span class='Ref_to_Typedef'>eary</span></a>       <span class='Operator'>*</span><span class='Declare_Member'>tables</span><span class='Delimiter'>; 
</span><a name="LN28"></a>    <a href="oid2name.c.html#LN17"><span class='Ref_to_Typedef'>eary</span></a>       <span class='Operator'>*</span><span class='Declare_Member'>oids</span><span class='Delimiter'>; 
</span><a name="LN29"></a>    <a href="oid2name.c.html#LN17"><span class='Ref_to_Typedef'>eary</span></a>       <span class='Operator'>*</span><span class='Declare_Member'>filenodes</span><span class='Delimiter'>; 
</span> 
<a name="LN31"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Member'>quiet</span><span class='Delimiter'>; 
</span><a name="LN32"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Member'>systables</span><span class='Delimiter'>; 
</span><a name="LN33"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Member'>indexes</span><span class='Delimiter'>; 
</span><a name="LN34"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Member'>nodb</span><span class='Delimiter'>; 
</span><a name="LN35"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Member'>extended</span><span class='Delimiter'>; 
</span><a name="LN36"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Member'>tablespaces</span><span class='Delimiter'>; 
</span> 
<a name="LN38"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Member'>dbname</span><span class='Delimiter'>; 
</span><a name="LN39"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Member'>hostname</span><span class='Delimiter'>; 
</span><a name="LN40"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Member'>port</span><span class='Delimiter'>; 
</span><a name="LN41"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Member'>username</span><span class='Delimiter'>; 
</span><a name="LN42"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Member'>progname</span><span class='Delimiter'>; 
}; 
</span> 
<span class='Comment_Multi_Line'>/* function prototypes */ 
</span><a name="LN46"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>help</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>progname</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN47"></a><span class='Keyword'>void</span>        <span class='Declare_Prototype'>get_opts</span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>char</span> <span class='Operator'>**</span><span class='Delimiter'>, </span><span class='Control'>struct</span> <span class='Declare_Parameter'>options</span> <span class='Operator'>*</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN48"></a><span class='Keyword'>void</span>        <span class='Declare_Prototype'>add_one_elt</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>eltname</span><span class='Delimiter'>, </span><a href="oid2name.c.html#LN48"><span class='Ref_to_Parameter'>eary</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>eary</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN49"></a><span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Prototype'>get_comma_elts</span><span class='Parentheses'>(</span><a href="oid2name.c.html#LN49"><span class='Ref_to_Parameter'>eary</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>eary</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN50"></a><a href="../../src/interfaces/libpq/libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a>     <span class='Operator'>*</span><span class='Declare_Prototype'>sql_conn</span><span class='Parentheses'>(</span><span class='Control'>struct</span> <span class='Declare_Parameter'>options</span> <span class='Operator'>*</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN51"></a><span class='Keyword'>int</span>         <span class='Declare_Prototype'>sql_exec</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>PGconn</span> <span class='Operator'>*</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>sql</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>quiet</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN52"></a><span class='Keyword'>void</span>        <span class='Declare_Prototype'>sql_exec_dumpalldbs</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>PGconn</span> <span class='Operator'>*</span><span class='Delimiter'>, </span><span class='Control'>struct</span> <span class='Declare_Parameter'>options</span> <span class='Operator'>*</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN53"></a><span class='Keyword'>void</span>        <span class='Declare_Prototype'>sql_exec_dumpalltables</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>PGconn</span> <span class='Operator'>*</span><span class='Delimiter'>, </span><span class='Control'>struct</span> <span class='Declare_Parameter'>options</span> <span class='Operator'>*</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN54"></a><span class='Keyword'>void</span>        <span class='Declare_Prototype'>sql_exec_searchtables</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>PGconn</span> <span class='Operator'>*</span><span class='Delimiter'>, </span><span class='Control'>struct</span> <span class='Declare_Parameter'>options</span> <span class='Operator'>*</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN55"></a><span class='Keyword'>void</span>        <span class='Declare_Prototype'>sql_exec_dumpalltbspc</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>PGconn</span> <span class='Operator'>*</span><span class='Delimiter'>, </span><span class='Control'>struct</span> <span class='Declare_Parameter'>options</span> <span class='Operator'>*</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* function to parse command line options and check for some usage errors. */ 
</span><span class='Keyword'>void 
</span><a name="LN59"></a><span class='Declare_Function'>get_opts</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>argc</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>**</span><span class='Declare_Parameter'>argv</span><span class='Delimiter'>, </span><span class='Control'>struct</span> <a href="oid2name.c.html#LN25"><span class='Ref_to_Struct'>options</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>my_opts</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN61"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>c</span><span class='Delimiter'>; 
</span><a name="LN62"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>progname</span><span class='Delimiter'>; 
</span> 
    <a href="oid2name.c.html#LN62"><span class='Ref_To_Local'>progname</span></a> <span class='Operator'>= </span><a href="../../src/include/port.h.html#LN49"><span class='Ref_to_Proto'>get_progname</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* set the defaults */ 
</span>    <a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN31"><span class='Ref_to_Member'>quiet</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN32"><span class='Ref_to_Member'>systables</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN33"><span class='Ref_to_Member'>indexes</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN34"><span class='Ref_to_Member'>nodb</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN35"><span class='Ref_to_Member'>extended</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN36"><span class='Ref_to_Member'>tablespaces</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN38"><span class='Ref_to_Member'>dbname</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN39"><span class='Ref_to_Member'>hostname</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN40"><span class='Ref_to_Member'>port</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN41"><span class='Ref_to_Member'>username</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN42"><span class='Ref_to_Member'>progname</span></a> <span class='Operator'>= </span><a href="oid2name.c.html#LN62"><span class='Ref_To_Local'>progname</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>argc</span></a> <span class='Operator'>&GT; </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>], </span><span class='String'>"--help"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| </span>strcmp<span class='Parentheses'>(</span><a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>], </span><span class='String'>"-?"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="../../src/bin/scripts/pg_isready.c.html#LN16"><span class='Ref_to_Proto'>help</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN62"><span class='Ref_To_Local'>progname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../src/test/isolation/specscanner.l.html#LN91"><span class='Ref_to_Proto'>exit</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>], </span><span class='String'>"--version"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| </span>strcmp<span class='Parentheses'>(</span><a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>], </span><span class='String'>"-V"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            puts<span class='Parentheses'>(</span><span class='String'>"oid2name (PostgreSQL) "</span> PG_VERSION<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../src/test/isolation/specscanner.l.html#LN91"><span class='Ref_to_Proto'>exit</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* get opts */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>((</span><a href="oid2name.c.html#LN61"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= </span><a href="../../src/include/pg_getopt.h.html#LN42"><span class='Ref_to_Proto'>getopt</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>argc</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>argv</span></a><span class='Delimiter'>, </span><span class='String'>"H:p:U:d:t:o:f:qSxish"</span><span class='Parentheses'>))</span> <span class='Operator'>!= -</span><span class='Number'>1</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="oid2name.c.html#LN61"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* specify the database */ 
</span>            <span class='Control'>case</span> <span class='String'>'d'</span><span class='Operator'>: 
</span>                <a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN38"><span class='Ref_to_Member'>dbname</span></a> <span class='Operator'>= </span><a href="../../src/include/common/fe_memutils.h.html#LN24"><span class='Ref_to_Proto'>pg_strdup</span></a><span class='Parentheses'>(</span><a href="../../src/port/getopt.c.html#LN52"><span class='Ref_to_Global_Var'>optarg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* specify one tablename to show */ 
</span>            <span class='Control'>case</span> <span class='String'>'t'</span><span class='Operator'>: 
</span>                <a href="oid2name.c.html#LN48"><span class='Ref_to_Proto'>add_one_elt</span></a><span class='Parentheses'>(</span><a href="../../src/port/getopt.c.html#LN52"><span class='Ref_to_Global_Var'>optarg</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN27"><span class='Ref_to_Member'>tables</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* specify one Oid to show */ 
</span>            <span class='Control'>case</span> <span class='String'>'o'</span><span class='Operator'>: 
</span>                <a href="oid2name.c.html#LN48"><span class='Ref_to_Proto'>add_one_elt</span></a><span class='Parentheses'>(</span><a href="../../src/port/getopt.c.html#LN52"><span class='Ref_to_Global_Var'>optarg</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN28"><span class='Ref_to_Member'>oids</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* specify one filenode to show */ 
</span>            <span class='Control'>case</span> <span class='String'>'f'</span><span class='Operator'>: 
</span>                <a href="oid2name.c.html#LN48"><span class='Ref_to_Proto'>add_one_elt</span></a><span class='Parentheses'>(</span><a href="../../src/port/getopt.c.html#LN52"><span class='Ref_to_Global_Var'>optarg</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN29"><span class='Ref_to_Member'>filenodes</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* don't show headers */ 
</span>            <span class='Control'>case</span> <span class='String'>'q'</span><span class='Operator'>: 
</span>                <a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN31"><span class='Ref_to_Member'>quiet</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* host to connect to */ 
</span>            <span class='Control'>case</span> <span class='String'>'H'</span><span class='Operator'>: 
</span>                <a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN39"><span class='Ref_to_Member'>hostname</span></a> <span class='Operator'>= </span><a href="../../src/include/common/fe_memutils.h.html#LN24"><span class='Ref_to_Proto'>pg_strdup</span></a><span class='Parentheses'>(</span><a href="../../src/port/getopt.c.html#LN52"><span class='Ref_to_Global_Var'>optarg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* port to connect to on remote host */ 
</span>            <span class='Control'>case</span> <span class='String'>'p'</span><span class='Operator'>: 
</span>                <a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN40"><span class='Ref_to_Member'>port</span></a> <span class='Operator'>= </span><a href="../../src/include/common/fe_memutils.h.html#LN24"><span class='Ref_to_Proto'>pg_strdup</span></a><span class='Parentheses'>(</span><a href="../../src/port/getopt.c.html#LN52"><span class='Ref_to_Global_Var'>optarg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* username */ 
</span>            <span class='Control'>case</span> <span class='String'>'U'</span><span class='Operator'>: 
</span>                <a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN41"><span class='Ref_to_Member'>username</span></a> <span class='Operator'>= </span><a href="../../src/include/common/fe_memutils.h.html#LN24"><span class='Ref_to_Proto'>pg_strdup</span></a><span class='Parentheses'>(</span><a href="../../src/port/getopt.c.html#LN52"><span class='Ref_to_Global_Var'>optarg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* display system tables */ 
</span>            <span class='Control'>case</span> <span class='String'>'S'</span><span class='Operator'>: 
</span>                <a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN32"><span class='Ref_to_Member'>systables</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* also display indexes */ 
</span>            <span class='Control'>case</span> <span class='String'>'i'</span><span class='Operator'>: 
</span>                <a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN33"><span class='Ref_to_Member'>indexes</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* display extra columns */ 
</span>            <span class='Control'>case</span> <span class='String'>'x'</span><span class='Operator'>: 
</span>                <a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN35"><span class='Ref_to_Member'>extended</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* dump tablespaces only */ 
</span>            <span class='Control'>case</span> <span class='String'>'s'</span><span class='Operator'>: 
</span>                <a href="oid2name.c.html#LN59"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN36"><span class='Ref_to_Member'>tablespaces</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <span class='String'>'h'</span><span class='Operator'>: 
</span>                <a href="../../src/bin/scripts/pg_isready.c.html#LN16"><span class='Ref_to_Proto'>help</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN62"><span class='Ref_To_Local'>progname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="../../src/test/isolation/specscanner.l.html#LN91"><span class='Ref_to_Proto'>exit</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>default</span><span class='Operator'>: 
</span>                <a href="../seg/segscan.l.html#LN10"><span class='Ref_to_Macro'>fprintf</span></a><span class='Parentheses'>(</span>stderr<span class='Delimiter'>, </span>_<span class='Parentheses'>(</span><span class='String'>"Try \"%s --help\" for more information.\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="oid2name.c.html#LN62"><span class='Ref_To_Local'>progname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="../../src/test/isolation/specscanner.l.html#LN91"><span class='Ref_to_Proto'>exit</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch c &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while (c=getopt(argc,argv,"... &raquo; </span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end get_opts &raquo; </span> 
 
<span class='Keyword'>static void 
</span><a name="LN171"></a><span class='Declare_Function'>help</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>progname</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="../../src/include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span><span class='String'>"%s helps examining the file structure used by PostgreSQL.\n\n"</span> 
           <span class='String'>"Usage:\n"</span> 
           <span class='String'>"  %s [OPTION]...\n"</span> 
           <span class='String'>"\nOptions:\n"</span> 
           <span class='String'>"  -d DBNAME      database to connect to\n"</span> 
           <span class='String'>"  -f FILENODE    show info for table with given file node\n"</span> 
           <span class='String'>"  -H HOSTNAME    database server host or socket directory\n"</span> 
           <span class='String'>"  -i             show indexes and sequences too\n"</span> 
           <span class='String'>"  -o OID         show info for table with given OID\n"</span> 
           <span class='String'>"  -p PORT        database server port number\n"</span> 
           <span class='String'>"  -q             quiet (don't show headers)\n"</span> 
           <span class='String'>"  -s             show all tablespaces\n"</span> 
           <span class='String'>"  -S             show system objects too\n"</span> 
           <span class='String'>"  -t TABLE       show info for named table\n"</span> 
           <span class='String'>"  -U NAME        connect as specified database user\n"</span> 
           <span class='String'>"  -V, --version  output version information, then exit\n"</span> 
           <span class='String'>"  -x             extended (show additional columns)\n"</span> 
           <span class='String'>"  -?, --help     show this help, then exit\n"</span> 
           <span class='String'>"\nThe default action is to show all database OIDs.\n\n"</span> 
           <span class='String'>"Report bugs to &LT;pgsql-bugs@postgresql.org&GT;.\n"</span><span class='Delimiter'>, 
</span>           <a href="oid2name.c.html#LN171"><span class='Ref_to_Parameter'>progname</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN171"><span class='Ref_to_Parameter'>progname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end help &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * add_one_elt 
 * 
 * Add one element to a (possibly empty) eary struct. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN202"></a><span class='Declare_Function'>add_one_elt</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>eltname</span><span class='Delimiter'>, </span><a href="oid2name.c.html#LN202"><span class='Ref_to_Parameter'>eary</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>eary</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="oid2name.c.html#LN202"><span class='Ref_to_Parameter'>eary</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN21"><span class='Ref_to_Member'>alloc</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="oid2name.c.html#LN202"><span class='Ref_to_Parameter'>eary</span></a>      <span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN21"><span class='Ref_to_Member'>alloc</span></a> <span class='Operator'>= </span><span class='Number'>8</span><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN202"><span class='Ref_to_Parameter'>eary</span></a>      <span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN19"><span class='Ref_to_Member'>array</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>**</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN25"><span class='Ref_to_Proto'>pg_malloc</span></a><span class='Parentheses'>(</span><span class='Number'>8</span> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="oid2name.c.html#LN202"><span class='Ref_to_Parameter'>eary</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN20"><span class='Ref_to_Member'>num</span></a> <span class='Operator'>&GT;= </span><a href="oid2name.c.html#LN202"><span class='Ref_to_Parameter'>eary</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN21"><span class='Ref_to_Member'>alloc</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="oid2name.c.html#LN202"><span class='Ref_to_Parameter'>eary</span></a>      <span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN21"><span class='Ref_to_Member'>alloc</span></a> <span class='Operator'>*= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN202"><span class='Ref_to_Parameter'>eary</span></a>      <span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN19"><span class='Ref_to_Member'>array</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>**</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN28"><span class='Ref_to_Proto'>pg_realloc</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN202"><span class='Ref_to_Parameter'>eary</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN19"><span class='Ref_to_Member'>array</span></a><span class='Delimiter'>, 
</span>                                               <a href="oid2name.c.html#LN202"><span class='Ref_to_Parameter'>eary</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN21"><span class='Ref_to_Member'>alloc</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="oid2name.c.html#LN202"><span class='Ref_to_Parameter'>eary</span></a>      <span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN19"><span class='Ref_to_Member'>array</span></a><span class='Delimiter'>[</span><a href="oid2name.c.html#LN202"><span class='Ref_to_Parameter'>eary</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN20"><span class='Ref_to_Member'>num</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../src/include/common/fe_memutils.h.html#LN24"><span class='Ref_to_Proto'>pg_strdup</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN202"><span class='Ref_to_Parameter'>eltname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="oid2name.c.html#LN202"><span class='Ref_to_Parameter'>eary</span></a>      <span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN20"><span class='Ref_to_Member'>num</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * get_comma_elts 
 * 
 * Return the elements of an eary as a (freshly allocated) single string, in 
 * single quotes, separated by commas and properly escaped for insertion in an 
 * SQL statement. 
 */ 
</span><span class='Keyword'>char </span><span class='Operator'>* 
</span><a name="LN228"></a><span class='Declare_Function'>get_comma_elts</span><span class='Parentheses'>(</span><a href="oid2name.c.html#LN228"><span class='Ref_to_Parameter'>eary</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>eary</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN230"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>ret</span><span class='Delimiter'>, 
</span><a name="LN231"></a>               <span class='Operator'>*</span><span class='Declare_Local'>ptr</span><span class='Delimiter'>; 
</span><a name="LN232"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>, 
</span><a name="LN233"></a>                <span class='Declare_Local'>length</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="oid2name.c.html#LN228"><span class='Ref_to_Parameter'>eary</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN20"><span class='Ref_to_Member'>num</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="../../src/include/common/fe_memutils.h.html#LN24"><span class='Ref_to_Proto'>pg_strdup</span></a><span class='Parentheses'>(</span><span class='String'>""</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * PQescapeString wants 2 * length + 1 bytes of breath space.  Add two 
     * chars per element for the single quotes and one for the comma. 
     */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="oid2name.c.html#LN232"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="oid2name.c.html#LN232"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="oid2name.c.html#LN228"><span class='Ref_to_Parameter'>eary</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN20"><span class='Ref_to_Member'>num</span></a><span class='Delimiter'>; </span><a href="oid2name.c.html#LN232"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <a href="oid2name.c.html#LN233"><span class='Ref_To_Local'>length</span></a> <span class='Operator'>+= </span>strlen<span class='Parentheses'>(</span><a href="oid2name.c.html#LN228"><span class='Ref_to_Parameter'>eary</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN19"><span class='Ref_to_Member'>array</span></a><span class='Delimiter'>[</span><a href="oid2name.c.html#LN232"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="oid2name.c.html#LN230"><span class='Ref_To_Local'>ret</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN25"><span class='Ref_to_Proto'>pg_malloc</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN233"><span class='Ref_To_Local'>length</span></a> <span class='Operator'>* </span><span class='Number'>2</span> <span class='Operator'>+ </span><span class='Number'>4</span> <span class='Operator'>* </span><a href="oid2name.c.html#LN228"><span class='Ref_to_Parameter'>eary</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN20"><span class='Ref_to_Member'>num</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="oid2name.c.html#LN231"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>= </span><a href="oid2name.c.html#LN230"><span class='Ref_To_Local'>ret</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="oid2name.c.html#LN232"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="oid2name.c.html#LN232"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="oid2name.c.html#LN228"><span class='Ref_to_Parameter'>eary</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN20"><span class='Ref_to_Member'>num</span></a><span class='Delimiter'>; </span><a href="oid2name.c.html#LN232"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="oid2name.c.html#LN232"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="../../src/include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN231"><span class='Ref_To_Local'>ptr</span></a><span class='Operator'>++</span><span class='Delimiter'>, </span><span class='String'>","</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN231"><span class='Ref_To_Local'>ptr</span></a><span class='Operator'>++</span><span class='Delimiter'>, </span><span class='String'>"'"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN231"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>+= </span><a href="../../src/interfaces/libpq/libpq-fe.h.html#LN533"><span class='Ref_to_Proto'>PQescapeString</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN231"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN228"><span class='Ref_to_Parameter'>eary</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN19"><span class='Ref_to_Member'>array</span></a><span class='Delimiter'>[</span><a href="oid2name.c.html#LN232"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>], </span>strlen<span class='Parentheses'>(</span><a href="oid2name.c.html#LN228"><span class='Ref_to_Parameter'>eary</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN19"><span class='Ref_to_Member'>array</span></a><span class='Delimiter'>[</span><a href="oid2name.c.html#LN232"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN231"><span class='Ref_To_Local'>ptr</span></a><span class='Operator'>++</span><span class='Delimiter'>, </span><span class='String'>"'"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="oid2name.c.html#LN230"><span class='Ref_To_Local'>ret</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end get_comma_elts &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* establish connection with database. */ 
</span><a href="../../src/interfaces/libpq/libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>* 
</span><a name="LN262"></a><span class='Declare_Function'>sql_conn</span><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="oid2name.c.html#LN25"><span class='Ref_to_Struct'>options</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>my_opts</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN264"></a>    <a href="../../src/interfaces/libpq/libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>conn</span><span class='Delimiter'>; 
</span><a name="LN265"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>have_password</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN266"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>password</span><span class='Delimiter'>[</span><span class='Number'>100</span><span class='Delimiter'>]; 
</span><a name="LN267"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>new_pass</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Start the connection.  Loop until we have a password if requested by 
     * backend. 
     */ 
</span>    <span class='Control'>do</span> 
    <span class='Delimiter'>{ 
</span><a name="LN275"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>PARAMS_ARRAY_SIZE</span>   <span class='Number'>7</span> 
 
<a name="LN277"></a>        <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>keywords</span><span class='Delimiter'>[</span><a href="oid2name.c.html#LN275"><span class='Ref_to_Const'>PARAMS_ARRAY_SIZE</span></a><span class='Delimiter'>]; 
</span><a name="LN278"></a>        <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>values</span><span class='Delimiter'>[</span><a href="oid2name.c.html#LN275"><span class='Ref_to_Const'>PARAMS_ARRAY_SIZE</span></a><span class='Delimiter'>]; 
</span> 
        <a href="oid2name.c.html#LN277"><span class='Ref_To_Local'>keywords</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='String'>"host"</span><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN278"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="oid2name.c.html#LN262"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN39"><span class='Ref_to_Member'>hostname</span></a><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN277"><span class='Ref_To_Local'>keywords</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='String'>"port"</span><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN278"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="oid2name.c.html#LN262"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN40"><span class='Ref_to_Member'>port</span></a><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN277"><span class='Ref_To_Local'>keywords</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='String'>"user"</span><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN278"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="oid2name.c.html#LN262"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN41"><span class='Ref_to_Member'>username</span></a><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN277"><span class='Ref_To_Local'>keywords</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='String'>"password"</span><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN278"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="oid2name.c.html#LN265"><span class='Ref_To_Local'>have_password</span></a> <span class='Operator'>? </span><a href="oid2name.c.html#LN266"><span class='Ref_To_Local'>password</span></a> <span class='Operator'>: </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN277"><span class='Ref_To_Local'>keywords</span></a><span class='Delimiter'>[</span><span class='Number'>4</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='String'>"dbname"</span><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN278"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>4</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="oid2name.c.html#LN262"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN38"><span class='Ref_to_Member'>dbname</span></a><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN277"><span class='Ref_To_Local'>keywords</span></a><span class='Delimiter'>[</span><span class='Number'>5</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='String'>"fallback_application_name"</span><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN278"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>5</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="oid2name.c.html#LN262"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN42"><span class='Ref_to_Member'>progname</span></a><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN277"><span class='Ref_To_Local'>keywords</span></a><span class='Delimiter'>[</span><span class='Number'>6</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN278"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>6</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
        <a href="oid2name.c.html#LN267"><span class='Ref_To_Local'>new_pass</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN264"><span class='Ref_To_Local'>conn</span></a> <span class='Operator'>= </span><a href="../../src/interfaces/libpq/libpq-fe.h.html#LN261"><span class='Ref_to_Proto'>PQconnectdbParams</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN277"><span class='Ref_To_Local'>keywords</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN278"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="oid2name.c.html#LN264"><span class='Ref_To_Local'>conn</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="../seg/segscan.l.html#LN10"><span class='Ref_to_Macro'>fprintf</span></a><span class='Parentheses'>(</span>stderr<span class='Delimiter'>, </span><span class='String'>"%s: could not connect to database %s\n"</span><span class='Delimiter'>, 
</span>                    <span class='String'>"oid2name"</span><span class='Delimiter'>, </span><a href="oid2name.c.html#LN262"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN38"><span class='Ref_to_Member'>dbname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../src/test/isolation/specscanner.l.html#LN91"><span class='Ref_to_Proto'>exit</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/interfaces/libpq/libpq-fe.h.html#LN317"><span class='Ref_to_Proto'>PQstatus</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN264"><span class='Ref_To_Local'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="../../src/interfaces/libpq/libpq-fe.h.html#LN49"><span class='Ref_to_EnumConst'>CONNECTION_BAD</span></a> <span class='Operator'>&& 
</span>            <a href="../../src/interfaces/libpq/libpq-fe.h.html#LN326"><span class='Ref_to_Proto'>PQconnectionNeedsPassword</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN264"><span class='Ref_To_Local'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>            <span class='Operator'>!</span><a href="oid2name.c.html#LN265"><span class='Ref_To_Local'>have_password</span></a><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="../../src/interfaces/libpq/libpq-fe.h.html#LN272"><span class='Ref_to_Proto'>PQfinish</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN264"><span class='Ref_To_Local'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../src/port/sprompt.c.html#LN35"><span class='Ref_to_Func'>simple_prompt</span></a><span class='Parentheses'>(</span><span class='String'>"Password: "</span><span class='Delimiter'>, </span><a href="oid2name.c.html#LN266"><span class='Ref_To_Local'>password</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="oid2name.c.html#LN266"><span class='Ref_To_Local'>password</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="oid2name.c.html#LN265"><span class='Ref_To_Local'>have_password</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <a href="oid2name.c.html#LN267"><span class='Ref_To_Local'>new_pass</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end do &raquo; </span> <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="oid2name.c.html#LN267"><span class='Ref_To_Local'>new_pass</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* check to see that the backend connection was successfully made */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/interfaces/libpq/libpq-fe.h.html#LN317"><span class='Ref_to_Proto'>PQstatus</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN264"><span class='Ref_To_Local'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="../../src/interfaces/libpq/libpq-fe.h.html#LN49"><span class='Ref_to_EnumConst'>CONNECTION_BAD</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../seg/segscan.l.html#LN10"><span class='Ref_to_Macro'>fprintf</span></a><span class='Parentheses'>(</span>stderr<span class='Delimiter'>, </span><span class='String'>"%s: could not connect to database %s: %s"</span><span class='Delimiter'>, 
</span>                <span class='String'>"oid2name"</span><span class='Delimiter'>, </span><a href="oid2name.c.html#LN262"><span class='Ref_to_Parameter'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN38"><span class='Ref_to_Member'>dbname</span></a><span class='Delimiter'>, </span><a href="../../src/interfaces/libpq/libpq-fe.h.html#LN323"><span class='Ref_to_Proto'>PQerrorMessage</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN264"><span class='Ref_To_Local'>conn</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../src/interfaces/libpq/libpq-fe.h.html#LN272"><span class='Ref_to_Proto'>PQfinish</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN264"><span class='Ref_To_Local'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/test/isolation/specscanner.l.html#LN91"><span class='Ref_to_Proto'>exit</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* return the conn if good */ 
</span>    <span class='Control'>return</span> <a href="oid2name.c.html#LN264"><span class='Ref_To_Local'>conn</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end sql_conn &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Actual code to make call to the database and print the output data. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN333"></a><span class='Declare_Function'>sql_exec</span><span class='Parentheses'>(</span><a href="../../src/interfaces/libpq/libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>todo</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>quiet</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN335"></a>    <a href="../../src/interfaces/libpq/libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
<a name="LN337"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>nfields</span><span class='Delimiter'>; 
</span><a name="LN338"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>nrows</span><span class='Delimiter'>; 
</span><a name="LN339"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>, 
</span><a name="LN340"></a>                <span class='Declare_Local'>j</span><span class='Delimiter'>, 
</span><a name="LN341"></a>                <span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span><a name="LN342"></a>    <span class='Keyword'>int</span>        <span class='Operator'>*</span><span class='Declare_Local'>length</span><span class='Delimiter'>; 
</span><a name="LN343"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>pad</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* make the call */ 
</span>    <a href="oid2name.c.html#LN335"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="../../src/interfaces/libpq/libpq-fe.h.html#LN380"><span class='Ref_to_Proto'>PQexec</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN333"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN333"><span class='Ref_to_Parameter'>todo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* check and deal with errors */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="oid2name.c.html#LN335"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>|| </span><a href="../../src/interfaces/libpq/libpq-fe.h.html#LN466"><span class='Ref_to_Proto'>PQresultStatus</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN335"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><span class='Number'>2</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../seg/segscan.l.html#LN10"><span class='Ref_to_Macro'>fprintf</span></a><span class='Parentheses'>(</span>stderr<span class='Delimiter'>, </span><span class='String'>"oid2name: query failed: %s\n"</span><span class='Delimiter'>, </span><a href="../../src/interfaces/libpq/libpq-fe.h.html#LN323"><span class='Ref_to_Proto'>PQerrorMessage</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN333"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../seg/segscan.l.html#LN10"><span class='Ref_to_Macro'>fprintf</span></a><span class='Parentheses'>(</span>stderr<span class='Delimiter'>, </span><span class='String'>"oid2name: query was: %s\n"</span><span class='Delimiter'>, </span><a href="oid2name.c.html#LN333"><span class='Ref_to_Parameter'>todo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="../../src/interfaces/libpq/libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN335"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/interfaces/libpq/libpq-fe.h.html#LN272"><span class='Ref_to_Proto'>PQfinish</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN333"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/test/isolation/specscanner.l.html#LN91"><span class='Ref_to_Proto'>exit</span></a><span class='Parentheses'>(</span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* get the number of fields */ 
</span>    <a href="oid2name.c.html#LN338"><span class='Ref_To_Local'>nrows</span></a> <span class='Operator'>= </span><a href="../../src/interfaces/libpq/libpq-fe.h.html#LN473"><span class='Ref_to_Proto'>PQntuples</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN335"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="oid2name.c.html#LN337"><span class='Ref_To_Local'>nfields</span></a> <span class='Operator'>= </span><a href="../../src/interfaces/libpq/libpq-fe.h.html#LN474"><span class='Ref_to_Proto'>PQnfields</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN335"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* for each field, get the needed width */ 
</span>    <a href="oid2name.c.html#LN342"><span class='Ref_To_Local'>length</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN25"><span class='Ref_to_Proto'>pg_malloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="oid2name.c.html#LN337"><span class='Ref_To_Local'>nfields</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="oid2name.c.html#LN340"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="oid2name.c.html#LN340"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><a href="oid2name.c.html#LN337"><span class='Ref_To_Local'>nfields</span></a><span class='Delimiter'>; </span><a href="oid2name.c.html#LN340"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <a href="oid2name.c.html#LN342"><span class='Ref_To_Local'>length</span></a><span class='Delimiter'>[</span><a href="oid2name.c.html#LN340"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span>strlen<span class='Parentheses'>(</span><a href="../../src/interfaces/libpq/libpq-fe.h.html#LN476"><span class='Ref_to_Proto'>PQfname</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN335"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN340"><span class='Ref_To_Local'>j</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="oid2name.c.html#LN339"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="oid2name.c.html#LN339"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="oid2name.c.html#LN338"><span class='Ref_To_Local'>nrows</span></a><span class='Delimiter'>; </span><a href="oid2name.c.html#LN339"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="oid2name.c.html#LN340"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="oid2name.c.html#LN340"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><a href="oid2name.c.html#LN337"><span class='Ref_To_Local'>nfields</span></a><span class='Delimiter'>; </span><a href="oid2name.c.html#LN340"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="oid2name.c.html#LN341"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>= </span>strlen<span class='Parentheses'>(</span><a href="../../src/interfaces/libpq/libpq-fe.h.html#LN488"><span class='Ref_to_Proto'>PQgetvalue</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN335"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN339"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN340"><span class='Ref_To_Local'>j</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="oid2name.c.html#LN341"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>&GT; </span><a href="oid2name.c.html#LN342"><span class='Ref_To_Local'>length</span></a><span class='Delimiter'>[</span><a href="oid2name.c.html#LN340"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>                <a href="oid2name.c.html#LN342"><span class='Ref_To_Local'>length</span></a><span class='Delimiter'>[</span><a href="oid2name.c.html#LN340"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span>strlen<span class='Parentheses'>(</span><a href="../../src/interfaces/libpq/libpq-fe.h.html#LN488"><span class='Ref_to_Proto'>PQgetvalue</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN335"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN339"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN340"><span class='Ref_To_Local'>j</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* print a header */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="oid2name.c.html#LN333"><span class='Ref_to_Parameter'>quiet</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="oid2name.c.html#LN340"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="oid2name.c.html#LN341"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="oid2name.c.html#LN340"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><a href="oid2name.c.html#LN337"><span class='Ref_To_Local'>nfields</span></a><span class='Delimiter'>; </span><a href="oid2name.c.html#LN340"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="../seg/segscan.l.html#LN10"><span class='Ref_to_Macro'>fprintf</span></a><span class='Parentheses'>(</span>stdout<span class='Delimiter'>, </span><span class='String'>"%*s"</span><span class='Delimiter'>, </span><a href="oid2name.c.html#LN342"><span class='Ref_To_Local'>length</span></a><span class='Delimiter'>[</span><a href="oid2name.c.html#LN340"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>] </span><span class='Operator'>+ </span><span class='Number'>2</span><span class='Delimiter'>, </span><a href="../../src/interfaces/libpq/libpq-fe.h.html#LN476"><span class='Ref_to_Proto'>PQfname</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN335"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN340"><span class='Ref_To_Local'>j</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="oid2name.c.html#LN341"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>+= </span><a href="oid2name.c.html#LN342"><span class='Ref_To_Local'>length</span></a><span class='Delimiter'>[</span><a href="oid2name.c.html#LN340"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>] </span><span class='Operator'>+ </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="../seg/segscan.l.html#LN10"><span class='Ref_to_Macro'>fprintf</span></a><span class='Parentheses'>(</span>stdout<span class='Delimiter'>, </span><span class='String'>"\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN343"><span class='Ref_To_Local'>pad</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN25"><span class='Ref_to_Proto'>pg_malloc</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN341"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/c.h.html#LN856"><span class='Ref_to_Macro'>MemSet</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN343"><span class='Ref_To_Local'>pad</span></a><span class='Delimiter'>, </span><span class='String'>'-'</span><span class='Delimiter'>, </span><a href="oid2name.c.html#LN341"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN343"><span class='Ref_To_Local'>pad</span></a><span class='Delimiter'>[</span><a href="oid2name.c.html#LN341"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>        <a href="../seg/segscan.l.html#LN10"><span class='Ref_to_Macro'>fprintf</span></a><span class='Parentheses'>(</span>stdout<span class='Delimiter'>, </span><span class='String'>"%s\n"</span><span class='Delimiter'>, </span><a href="oid2name.c.html#LN343"><span class='Ref_To_Local'>pad</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN343"><span class='Ref_To_Local'>pad</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* for each row, dump the information */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="oid2name.c.html#LN339"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="oid2name.c.html#LN339"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="oid2name.c.html#LN338"><span class='Ref_To_Local'>nrows</span></a><span class='Delimiter'>; </span><a href="oid2name.c.html#LN339"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="oid2name.c.html#LN340"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="oid2name.c.html#LN340"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><a href="oid2name.c.html#LN337"><span class='Ref_To_Local'>nfields</span></a><span class='Delimiter'>; </span><a href="oid2name.c.html#LN340"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>            <a href="../seg/segscan.l.html#LN10"><span class='Ref_to_Macro'>fprintf</span></a><span class='Parentheses'>(</span>stdout<span class='Delimiter'>, </span><span class='String'>"%*s"</span><span class='Delimiter'>, </span><a href="oid2name.c.html#LN342"><span class='Ref_To_Local'>length</span></a><span class='Delimiter'>[</span><a href="oid2name.c.html#LN340"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>] </span><span class='Operator'>+ </span><span class='Number'>2</span><span class='Delimiter'>, </span><a href="../../src/interfaces/libpq/libpq-fe.h.html#LN488"><span class='Ref_to_Proto'>PQgetvalue</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN335"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN339"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN340"><span class='Ref_To_Local'>j</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../seg/segscan.l.html#LN10"><span class='Ref_to_Macro'>fprintf</span></a><span class='Parentheses'>(</span>stdout<span class='Delimiter'>, </span><span class='String'>"\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* cleanup */ 
</span>    <a href="../../src/interfaces/libpq/libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN335"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN342"><span class='Ref_To_Local'>length</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end sql_exec &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Dump all databases.  There are no system objects to worry about. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN413"></a><span class='Declare_Function'>sql_exec_dumpalldbs</span><span class='Parentheses'>(</span><a href="../../src/interfaces/libpq/libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Control'>struct</span> <a href="oid2name.c.html#LN25"><span class='Ref_to_Struct'>options</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>opts</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN415"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>todo</span><span class='Delimiter'>[</span><span class='Number'>1024</span><span class='Delimiter'>]; 
</span> 
    <span class='Comment_Multi_Line'>/* get the oid and database name from the system pg_database table */ 
</span>    <a href="../../src/pl/plperl/plperl.h.html#LN60"><span class='Ref_to_Macro'>snprintf</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN415"><span class='Ref_To_Local'>todo</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="oid2name.c.html#LN415"><span class='Ref_To_Local'>todo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>             <span class='String'>"SELECT d.oid AS \"Oid\", datname AS \"Database Name\", "</span> 
             <span class='String'>"spcname AS \"Tablespace\" FROM pg_catalog.pg_database d JOIN pg_catalog.pg_tablespace t ON "</span> 
             <span class='String'>"(dattablespace = t.oid) ORDER BY 2"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="oid2name.c.html#LN51"><span class='Ref_to_Proto'>sql_exec</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN413"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN415"><span class='Ref_To_Local'>todo</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN413"><span class='Ref_to_Parameter'>opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN31"><span class='Ref_to_Member'>quiet</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Dump all tables, indexes and sequences in the current database. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN430"></a><span class='Declare_Function'>sql_exec_dumpalltables</span><span class='Parentheses'>(</span><a href="../../src/interfaces/libpq/libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Control'>struct</span> <a href="oid2name.c.html#LN25"><span class='Ref_to_Struct'>options</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>opts</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN432"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>todo</span><span class='Delimiter'>[</span><span class='Number'>1024</span><span class='Delimiter'>]; 
</span><a name="LN433"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>addfields</span> <span class='Operator'>= </span><span class='String'>",c.oid AS \"Oid\", nspname AS \"Schema\", spcname as \"Tablespace\" "</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/pl/plperl/plperl.h.html#LN60"><span class='Ref_to_Macro'>snprintf</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN432"><span class='Ref_To_Local'>todo</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="oid2name.c.html#LN432"><span class='Ref_To_Local'>todo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>             <span class='String'>"SELECT pg_catalog.pg_relation_filenode(c.oid) as \"Filenode\", relname as \"Table Name\" %s "</span> 
             <span class='String'>"FROM pg_catalog.pg_class c "</span> 
           <span class='String'>"    LEFT JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace "</span> 
             <span class='String'>"  LEFT JOIN pg_catalog.pg_database d ON d.datname = pg_catalog.current_database(),"</span> 
             <span class='String'>"  pg_catalog.pg_tablespace t "</span> 
             <span class='String'>"WHERE relkind IN ("</span> <a href="../../src/include/c.h.html#LN161"><span class='Ref_to_Macro'>CppAsString2</span></a><span class='Parentheses'>(</span><a href="../../src/include/catalog/pg_class.h.html#LN159"><span class='Ref_to_Const'>RELKIND_RELATION</span></a><span class='Parentheses'>) </span><span class='String'>","</span> 
             <a href="../../src/include/c.h.html#LN161"><span class='Ref_to_Macro'>CppAsString2</span></a><span class='Parentheses'>(</span><a href="../../src/include/catalog/pg_class.h.html#LN164"><span class='Ref_to_Const'>RELKIND_MATVIEW</span></a><span class='Parentheses'>) </span><span class='String'>"%s%s) AND "</span> 
             <span class='String'>"  %s"</span> 
             <span class='String'>"      t.oid = CASE"</span> 
             <span class='String'>"          WHEN reltablespace &LT;&GT; 0 THEN reltablespace"</span> 
             <span class='String'>"          ELSE dattablespace"</span> 
             <span class='String'>"      END "</span> 
             <span class='String'>"ORDER BY relname"</span><span class='Delimiter'>, 
</span>             <a href="oid2name.c.html#LN430"><span class='Ref_to_Parameter'>opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN35"><span class='Ref_to_Member'>extended</span></a> <span class='Operator'>? </span><a href="oid2name.c.html#LN433"><span class='Ref_To_Local'>addfields</span></a> <span class='Operator'>: </span><span class='String'>""</span><span class='Delimiter'>, 
</span>             <a href="oid2name.c.html#LN430"><span class='Ref_to_Parameter'>opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN33"><span class='Ref_to_Member'>indexes</span></a> <span class='Operator'>? </span><span class='String'>","</span> <a href="../../src/include/c.h.html#LN161"><span class='Ref_to_Macro'>CppAsString2</span></a><span class='Parentheses'>(</span><a href="../../src/include/catalog/pg_class.h.html#LN160"><span class='Ref_to_Const'>RELKIND_INDEX</span></a><span class='Parentheses'>) </span><span class='String'>","</span> <a href="../../src/include/c.h.html#LN161"><span class='Ref_to_Macro'>CppAsString2</span></a><span class='Parentheses'>(</span><a href="../../src/include/catalog/pg_class.h.html#LN161"><span class='Ref_to_Const'>RELKIND_SEQUENCE</span></a><span class='Parentheses'>) </span><span class='Operator'>: </span><span class='String'>""</span><span class='Delimiter'>, 
</span>             <a href="oid2name.c.html#LN430"><span class='Ref_to_Parameter'>opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN32"><span class='Ref_to_Member'>systables</span></a> <span class='Operator'>? </span><span class='String'>","</span> <a href="../../src/include/c.h.html#LN161"><span class='Ref_to_Macro'>CppAsString2</span></a><span class='Parentheses'>(</span><a href="../../src/include/catalog/pg_class.h.html#LN162"><span class='Ref_to_Const'>RELKIND_TOASTVALUE</span></a><span class='Parentheses'>) </span><span class='Operator'>: </span><span class='String'>""</span><span class='Delimiter'>, 
</span>             <a href="oid2name.c.html#LN430"><span class='Ref_to_Parameter'>opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN32"><span class='Ref_to_Member'>systables</span></a> <span class='Operator'>? </span><span class='String'>""</span> <span class='Operator'>: </span><span class='String'>"n.nspname NOT IN ('pg_catalog', 'information_schema') AND n.nspname !~ '^pg_toast' AND"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="oid2name.c.html#LN51"><span class='Ref_to_Proto'>sql_exec</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN430"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN432"><span class='Ref_To_Local'>todo</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN430"><span class='Ref_to_Parameter'>opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN31"><span class='Ref_to_Member'>quiet</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end sql_exec_dumpalltables &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Show oid, filenode, name, schema and tablespace for each of the 
 * given objects in the current database. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN462"></a><span class='Declare_Function'>sql_exec_searchtables</span><span class='Parentheses'>(</span><a href="../../src/interfaces/libpq/libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Control'>struct</span> <a href="oid2name.c.html#LN25"><span class='Ref_to_Struct'>options</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>opts</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN464"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>todo</span><span class='Delimiter'>; 
</span><a name="LN465"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>qualifiers</span><span class='Delimiter'>, 
</span><a name="LN466"></a>               <span class='Operator'>*</span><span class='Declare_Local'>ptr</span><span class='Delimiter'>; 
</span><a name="LN467"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>comma_oids</span><span class='Delimiter'>, 
</span><a name="LN468"></a>               <span class='Operator'>*</span><span class='Declare_Local'>comma_filenodes</span><span class='Delimiter'>, 
</span><a name="LN469"></a>               <span class='Operator'>*</span><span class='Declare_Local'>comma_tables</span><span class='Delimiter'>; 
</span><a name="LN470"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>written</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN471"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>addfields</span> <span class='Operator'>= </span><span class='String'>",c.oid AS \"Oid\", nspname AS \"Schema\", spcname as \"Tablespace\" "</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* get tables qualifiers, whether names, filenodes, or OIDs */ 
</span>    <a href="oid2name.c.html#LN467"><span class='Ref_To_Local'>comma_oids</span></a> <span class='Operator'>= </span><a href="oid2name.c.html#LN49"><span class='Ref_to_Proto'>get_comma_elts</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN462"><span class='Ref_to_Parameter'>opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN28"><span class='Ref_to_Member'>oids</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="oid2name.c.html#LN469"><span class='Ref_To_Local'>comma_tables</span></a> <span class='Operator'>= </span><a href="oid2name.c.html#LN49"><span class='Ref_to_Proto'>get_comma_elts</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN462"><span class='Ref_to_Parameter'>opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN27"><span class='Ref_to_Member'>tables</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="oid2name.c.html#LN468"><span class='Ref_To_Local'>comma_filenodes</span></a> <span class='Operator'>= </span><a href="oid2name.c.html#LN49"><span class='Ref_to_Proto'>get_comma_elts</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN462"><span class='Ref_to_Parameter'>opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN29"><span class='Ref_to_Member'>filenodes</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 80 extra chars for SQL expression */ 
</span>    <a href="oid2name.c.html#LN465"><span class='Ref_To_Local'>qualifiers</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN25"><span class='Ref_to_Proto'>pg_malloc</span></a><span class='Parentheses'>(</span>strlen<span class='Parentheses'>(</span><a href="oid2name.c.html#LN467"><span class='Ref_To_Local'>comma_oids</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span>strlen<span class='Parentheses'>(</span><a href="oid2name.c.html#LN469"><span class='Ref_To_Local'>comma_tables</span></a><span class='Parentheses'>) </span><span class='Operator'>+ 
</span>                                    strlen<span class='Parentheses'>(</span><a href="oid2name.c.html#LN468"><span class='Ref_To_Local'>comma_filenodes</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>80</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="oid2name.c.html#LN466"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>= </span><a href="oid2name.c.html#LN465"><span class='Ref_To_Local'>qualifiers</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="oid2name.c.html#LN462"><span class='Ref_to_Parameter'>opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN28"><span class='Ref_to_Member'>oids</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN20"><span class='Ref_to_Member'>num</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="oid2name.c.html#LN466"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>+= </span><a href="../../src/include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN466"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>, </span><span class='String'>"c.oid IN (%s)"</span><span class='Delimiter'>, </span><a href="oid2name.c.html#LN467"><span class='Ref_To_Local'>comma_oids</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN470"><span class='Ref_To_Local'>written</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="oid2name.c.html#LN462"><span class='Ref_to_Parameter'>opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN29"><span class='Ref_to_Member'>filenodes</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN20"><span class='Ref_to_Member'>num</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="oid2name.c.html#LN470"><span class='Ref_To_Local'>written</span></a><span class='Parentheses'>) 
</span>            <a href="oid2name.c.html#LN466"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>+= </span><a href="../../src/include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN466"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>, </span><span class='String'>" OR "</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN466"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>+= </span><a href="../../src/include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN466"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>, </span><span class='String'>"pg_catalog.pg_relation_filenode(c.oid) IN (%s)"</span><span class='Delimiter'>, </span><a href="oid2name.c.html#LN468"><span class='Ref_To_Local'>comma_filenodes</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN470"><span class='Ref_To_Local'>written</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="oid2name.c.html#LN462"><span class='Ref_to_Parameter'>opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN27"><span class='Ref_to_Member'>tables</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN20"><span class='Ref_to_Member'>num</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="oid2name.c.html#LN470"><span class='Ref_To_Local'>written</span></a><span class='Parentheses'>) 
</span>            <a href="oid2name.c.html#LN466"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>+= </span><a href="../../src/include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN466"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>, </span><span class='String'>" OR "</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN466"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>, </span><span class='String'>"c.relname ~~ ANY (ARRAY[%s])"</span><span class='Delimiter'>, </span><a href="oid2name.c.html#LN469"><span class='Ref_To_Local'>comma_tables</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="../../src/include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN467"><span class='Ref_To_Local'>comma_oids</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN469"><span class='Ref_To_Local'>comma_tables</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN468"><span class='Ref_To_Local'>comma_filenodes</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* now build the query */ 
</span>    <a href="oid2name.c.html#LN464"><span class='Ref_To_Local'>todo</span></a> <span class='Operator'>= </span><a href="../../src/common/psprintf.c.html#LN44"><span class='Ref_to_Func'>psprintf</span></a><span class='Parentheses'>(</span> 
                    <span class='String'>"SELECT pg_catalog.pg_relation_filenode(c.oid) as \"Filenode\", relname as \"Table Name\" %s\n"</span> 
                    <span class='String'>"FROM pg_catalog.pg_class c\n"</span> 
         <span class='String'>"  LEFT JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace\n"</span> 
                    <span class='String'>"   LEFT JOIN pg_catalog.pg_database d ON d.datname = pg_catalog.current_database(),\n"</span> 
                    <span class='String'>"   pg_catalog.pg_tablespace t\n"</span> 
                    <span class='String'>"WHERE relkind IN ("</span> <a href="../../src/include/c.h.html#LN161"><span class='Ref_to_Macro'>CppAsString2</span></a><span class='Parentheses'>(</span><a href="../../src/include/catalog/pg_class.h.html#LN159"><span class='Ref_to_Const'>RELKIND_RELATION</span></a><span class='Parentheses'>) </span><span class='String'>","</span> 
                    <a href="../../src/include/c.h.html#LN161"><span class='Ref_to_Macro'>CppAsString2</span></a><span class='Parentheses'>(</span><a href="../../src/include/catalog/pg_class.h.html#LN164"><span class='Ref_to_Const'>RELKIND_MATVIEW</span></a><span class='Parentheses'>) </span><span class='String'>","</span> 
                    <a href="../../src/include/c.h.html#LN161"><span class='Ref_to_Macro'>CppAsString2</span></a><span class='Parentheses'>(</span><a href="../../src/include/catalog/pg_class.h.html#LN160"><span class='Ref_to_Const'>RELKIND_INDEX</span></a><span class='Parentheses'>) </span><span class='String'>","</span> 
                    <a href="../../src/include/c.h.html#LN161"><span class='Ref_to_Macro'>CppAsString2</span></a><span class='Parentheses'>(</span><a href="../../src/include/catalog/pg_class.h.html#LN161"><span class='Ref_to_Const'>RELKIND_SEQUENCE</span></a><span class='Parentheses'>) </span><span class='String'>","</span> 
                    <a href="../../src/include/c.h.html#LN161"><span class='Ref_to_Macro'>CppAsString2</span></a><span class='Parentheses'>(</span><a href="../../src/include/catalog/pg_class.h.html#LN162"><span class='Ref_to_Const'>RELKIND_TOASTVALUE</span></a><span class='Parentheses'>) </span><span class='String'>") AND\n"</span> 
                    <span class='String'>"       t.oid = CASE\n"</span> 
            <span class='String'>"           WHEN reltablespace &LT;&GT; 0 THEN reltablespace\n"</span> 
                    <span class='String'>"           ELSE dattablespace\n"</span> 
                    <span class='String'>"       END AND\n"</span> 
                    <span class='String'>"  (%s)\n"</span> 
                    <span class='String'>"ORDER BY relname\n"</span><span class='Delimiter'>, 
</span>                    <a href="oid2name.c.html#LN462"><span class='Ref_to_Parameter'>opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN35"><span class='Ref_to_Member'>extended</span></a> <span class='Operator'>? </span><a href="oid2name.c.html#LN471"><span class='Ref_To_Local'>addfields</span></a> <span class='Operator'>: </span><span class='String'>""</span><span class='Delimiter'>, 
</span>                    <a href="oid2name.c.html#LN465"><span class='Ref_To_Local'>qualifiers</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN465"><span class='Ref_To_Local'>qualifiers</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="oid2name.c.html#LN51"><span class='Ref_to_Proto'>sql_exec</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN462"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN464"><span class='Ref_To_Local'>todo</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN462"><span class='Ref_to_Parameter'>opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN31"><span class='Ref_to_Member'>quiet</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end sql_exec_searchtables &raquo; </span> 
 
<span class='Keyword'>void 
</span><a name="LN532"></a><span class='Declare_Function'>sql_exec_dumpalltbspc</span><span class='Parentheses'>(</span><a href="../../src/interfaces/libpq/libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Control'>struct</span> <a href="oid2name.c.html#LN25"><span class='Ref_to_Struct'>options</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>opts</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN534"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>todo</span><span class='Delimiter'>[</span><span class='Number'>1024</span><span class='Delimiter'>]; 
</span> 
    <a href="../../src/pl/plperl/plperl.h.html#LN60"><span class='Ref_to_Macro'>snprintf</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN534"><span class='Ref_To_Local'>todo</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="oid2name.c.html#LN534"><span class='Ref_To_Local'>todo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>             <span class='String'>"SELECT oid AS \"Oid\", spcname as \"Tablespace Name\"\n"</span> 
             <span class='String'>"FROM pg_catalog.pg_tablespace"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="oid2name.c.html#LN51"><span class='Ref_to_Proto'>sql_exec</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN532"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN534"><span class='Ref_To_Local'>todo</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN532"><span class='Ref_to_Parameter'>opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN31"><span class='Ref_to_Member'>quiet</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>int 
</span><a name="LN544"></a><span class='Declare_Function'>main</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>argc</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>**</span><span class='Declare_Parameter'>argv</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN546"></a>    <span class='Control'>struct</span> <a href="oid2name.c.html#LN25"><span class='Ref_to_Struct'>options</span></a> <span class='Operator'>*</span><span class='Declare_Local'>my_opts</span><span class='Delimiter'>; 
</span><a name="LN547"></a>    <a href="../../src/interfaces/libpq/libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>pgconn</span><span class='Delimiter'>; 
</span> 
    <a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="oid2name.c.html#LN25"><span class='Ref_to_Struct'>options</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN25"><span class='Ref_to_Proto'>pg_malloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="oid2name.c.html#LN25"><span class='Ref_to_Struct'>options</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN28"><span class='Ref_to_Member'>oids</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="oid2name.c.html#LN17"><span class='Ref_to_Typedef'>eary</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN25"><span class='Ref_to_Proto'>pg_malloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="oid2name.c.html#LN17"><span class='Ref_to_Typedef'>eary</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN27"><span class='Ref_to_Member'>tables</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="oid2name.c.html#LN17"><span class='Ref_to_Typedef'>eary</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN25"><span class='Ref_to_Proto'>pg_malloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="oid2name.c.html#LN17"><span class='Ref_to_Typedef'>eary</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN29"><span class='Ref_to_Member'>filenodes</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="oid2name.c.html#LN17"><span class='Ref_to_Typedef'>eary</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN25"><span class='Ref_to_Proto'>pg_malloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="oid2name.c.html#LN17"><span class='Ref_to_Typedef'>eary</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN28"><span class='Ref_to_Member'>oids</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN20"><span class='Ref_to_Member'>num</span></a> <span class='Operator'>= </span><a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN28"><span class='Ref_to_Member'>oids</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN21"><span class='Ref_to_Member'>alloc</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN27"><span class='Ref_to_Member'>tables</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN20"><span class='Ref_to_Member'>num</span></a> <span class='Operator'>= </span><a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN27"><span class='Ref_to_Member'>tables</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN21"><span class='Ref_to_Member'>alloc</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN29"><span class='Ref_to_Member'>filenodes</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN20"><span class='Ref_to_Member'>num</span></a> <span class='Operator'>= </span><a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN29"><span class='Ref_to_Member'>filenodes</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN21"><span class='Ref_to_Member'>alloc</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* parse the opts */ 
</span>    <a href="oid2name.c.html#LN47"><span class='Ref_to_Proto'>get_opts</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN544"><span class='Ref_to_Parameter'>argc</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN544"><span class='Ref_to_Parameter'>argv</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN38"><span class='Ref_to_Member'>dbname</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN38"><span class='Ref_to_Member'>dbname</span></a> <span class='Operator'>= </span><span class='String'>"postgres"</span><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN34"><span class='Ref_to_Member'>nodb</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="oid2name.c.html#LN547"><span class='Ref_To_Local'>pgconn</span></a> <span class='Operator'>= </span><a href="oid2name.c.html#LN50"><span class='Ref_to_Proto'>sql_conn</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* display only tablespaces */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN36"><span class='Ref_to_Member'>tablespaces</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN31"><span class='Ref_to_Member'>quiet</span></a><span class='Parentheses'>) 
</span>            <a href="../../src/include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span><span class='String'>"All tablespaces:\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN55"><span class='Ref_to_Proto'>sql_exec_dumpalltbspc</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN547"><span class='Ref_To_Local'>pgconn</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="../../src/interfaces/libpq/libpq-fe.h.html#LN272"><span class='Ref_to_Proto'>PQfinish</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN547"><span class='Ref_To_Local'>pgconn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/test/isolation/specscanner.l.html#LN91"><span class='Ref_to_Proto'>exit</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* display the given elements in the database */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN28"><span class='Ref_to_Member'>oids</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN20"><span class='Ref_to_Member'>num</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        <a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN27"><span class='Ref_to_Member'>tables</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN20"><span class='Ref_to_Member'>num</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        <a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN29"><span class='Ref_to_Member'>filenodes</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN20"><span class='Ref_to_Member'>num</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN31"><span class='Ref_to_Member'>quiet</span></a><span class='Parentheses'>) 
</span>            <a href="../../src/include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span><span class='String'>"From database \"%s\":\n"</span><span class='Delimiter'>, </span><a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN38"><span class='Ref_to_Member'>dbname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN54"><span class='Ref_to_Proto'>sql_exec_searchtables</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN547"><span class='Ref_To_Local'>pgconn</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="../../src/interfaces/libpq/libpq-fe.h.html#LN272"><span class='Ref_to_Proto'>PQfinish</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN547"><span class='Ref_To_Local'>pgconn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/test/isolation/specscanner.l.html#LN91"><span class='Ref_to_Proto'>exit</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* no elements given; dump the given database */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN38"><span class='Ref_to_Member'>dbname</span></a> <span class='Operator'>&& !</span><a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN34"><span class='Ref_to_Member'>nodb</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN31"><span class='Ref_to_Member'>quiet</span></a><span class='Parentheses'>) 
</span>            <a href="../../src/include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span><span class='String'>"From database \"%s\":\n"</span><span class='Delimiter'>, </span><a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN38"><span class='Ref_to_Member'>dbname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="oid2name.c.html#LN53"><span class='Ref_to_Proto'>sql_exec_dumpalltables</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN547"><span class='Ref_To_Local'>pgconn</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="../../src/interfaces/libpq/libpq-fe.h.html#LN272"><span class='Ref_to_Proto'>PQfinish</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN547"><span class='Ref_To_Local'>pgconn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/test/isolation/specscanner.l.html#LN91"><span class='Ref_to_Proto'>exit</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* no database either; dump all databases */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Operator'>-&GT;</span><a href="oid2name.c.html#LN31"><span class='Ref_to_Member'>quiet</span></a><span class='Parentheses'>) 
</span>        <a href="../../src/include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span><span class='String'>"All databases:\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="oid2name.c.html#LN52"><span class='Ref_to_Proto'>sql_exec_dumpalldbs</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN547"><span class='Ref_To_Local'>pgconn</span></a><span class='Delimiter'>, </span><a href="oid2name.c.html#LN546"><span class='Ref_To_Local'>my_opts</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/interfaces/libpq/libpq-fe.h.html#LN272"><span class='Ref_to_Proto'>PQfinish</span></a><span class='Parentheses'>(</span><a href="oid2name.c.html#LN547"><span class='Ref_To_Local'>pgconn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end main &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>