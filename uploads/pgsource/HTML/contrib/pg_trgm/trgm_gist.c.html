<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>contrib\pg_trgm\trgm_gist.c</title>
<LINK REL=StyleSheet HREF="../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>contrib\pg_trgm\trgm_gist.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:26 2017
</td></tr>
<tr><td><a href='../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/* 
 * contrib/pg_trgm/trgm_gist.c 
 */ 
</span><span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>"trgm.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>"access/stratnum.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"fmgr.h"</span> 
 
 
<span class='Control'>typedef</span> <span class='Control'>struct</span> 
<span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* most recent inputs to gtrgm_consistent */ 
</span><a name="LN14"></a>    <a href="../../src/include/access/stratnum.h.html#LN21"><span class='Ref_to_Typedef'>StrategyNumber</span></a> <span class='Declare_Member'>strategy</span><span class='Delimiter'>; 
</span><a name="LN15"></a>    <a href="../seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a>       <span class='Operator'>*</span><span class='Declare_Member'>query</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* extracted trigrams for query */ 
</span><a name="LN17"></a>    <a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a>       <span class='Operator'>*</span><span class='Declare_Member'>trigrams</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* if a regex operator, the extracted graph */ 
</span><a name="LN19"></a>    <a href="trgm_regexp.c.html#LN440"><span class='Ref_to_Struct'>TrgmPackedGraph</span></a> <span class='Operator'>*</span><span class='Declare_Member'>graph</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * The "query" and "trigrams" are stored in the same palloc block as this 
     * cache struct, at MAXALIGN'ed offsets.  The graph however isn't. 
     */ 
</span><a name="LN25"></a><span class='Delimiter'>} </span><span class='Declare_Typedef'>gtrgm_consistent_cache</span><span class='Delimiter'>; 
</span> 
<a name="LN27"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>GETENTRY</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>vec</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>pos</span><span class='Parentheses'>) ((</span><a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a> <span class='Operator'>*</span><span class='Parentheses'>)</span> <a href="../../src/include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>((</span><a href="trgm_gist.c.html#LN27"><span class='Ref_to_Parameter'>vec</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>vector<span class='Delimiter'>[</span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN27"><span class='Ref_to_Parameter'>pos</span></a><span class='Parentheses'>)</span><span class='Delimiter'>]</span><span class='Operator'>.</span>key<span class='Parentheses'>))</span> 
 
 
<a name="LN30"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN62"><span class='Ref_to_Func'>gtrgm_in</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN31"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN69"><span class='Ref_to_Func'>gtrgm_out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN32"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN93"><span class='Ref_to_Func'>gtrgm_compress</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN33"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN137"><span class='Ref_to_Func'>gtrgm_decompress</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN34"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN179"><span class='Ref_to_Func'>gtrgm_consistent</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN35"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN425"><span class='Ref_to_Func'>gtrgm_distance</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN36"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN534"><span class='Ref_to_Func'>gtrgm_union</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN37"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN567"><span class='Ref_to_Func'>gtrgm_same</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN38"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN667"><span class='Ref_to_Func'>gtrgm_penalty</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN39"></a><span class='Declare_Prototype'>PG_FUNCTION_INFO_V1</span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN773"><span class='Ref_to_Func'>gtrgm_picksplit</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Number of one-bits in an unsigned byte */ 
</span><a name="LN42"></a><span class='Keyword'>static const </span><a href="../../src/include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Declare_Var'>number_of_ones</span><span class='Delimiter'>[</span><span class='Number'>256</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Delimiter'>{ 
</span>    <span class='Number'>0</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, 
</span>    <span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, 
</span>    <span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, 
</span>    <span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, 
</span>    <span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, 
</span>    <span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, 
</span>    <span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, 
</span>    <span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, </span><span class='Number'>7</span><span class='Delimiter'>, 
</span>    <span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, 
</span>    <span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, 
</span>    <span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, 
</span>    <span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, </span><span class='Number'>7</span><span class='Delimiter'>, 
</span>    <span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, 
</span>    <span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, </span><span class='Number'>7</span><span class='Delimiter'>, 
</span>    <span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, </span><span class='Number'>7</span><span class='Delimiter'>, 
</span>    <span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, </span><span class='Number'>7</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, </span><span class='Number'>7</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, </span><span class='Number'>7</span><span class='Delimiter'>, </span><span class='Number'>7</span><span class='Delimiter'>, </span><span class='Number'>8</span> 
<span class='Delimiter'>}; 
</span> 
 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN63"></a><span class='Declare_Function'>gtrgm_in</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="../../src/backend/bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../src/include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"not implemented"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN312"><span class='Ref_to_Macro'>PG_RETURN_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN70"></a><span class='Declare_Function'>gtrgm_out</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="../../src/backend/bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../src/include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"not implemented"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN312"><span class='Ref_to_Macro'>PG_RETURN_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static void 
</span><a name="LN77"></a><span class='Declare_Function'>makesign</span><span class='Parentheses'>(</span><a href="../intarray/_int.h.html#LN54"><span class='Ref_to_Typedef'>BITVECP</span></a> <span class='Declare_Parameter'>sign</span><span class='Delimiter'>, </span><a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>a</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN79"></a>    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>k</span><span class='Delimiter'>, 
</span><a name="LN80"></a>                <span class='Declare_Local'>len</span> <span class='Operator'>= </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN70"><span class='Ref_to_Macro'>ARRNELEM</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN77"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN81"></a>    <a href="trgm.h.html#LN37"><span class='Ref_to_Typedef'>trgm</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>ptr</span> <span class='Operator'>= </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN69"><span class='Ref_to_Macro'>GETARR</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN77"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN82"></a>    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>tmp</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/c.h.html#LN856"><span class='Ref_to_Macro'>MemSet</span></a><span class='Parentheses'>((</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN77"><span class='Ref_to_Parameter'>sign</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../intarray/_int.h.html#LN53"><span class='Ref_to_Typedef'>BITVEC</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../bloom/blutils.c.html#LN32"><span class='Ref_to_Macro'>SETBIT</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN77"><span class='Ref_to_Parameter'>sign</span></a><span class='Delimiter'>, </span><a href="../hstore/hstore_gist.c.html#LN16"><span class='Ref_to_Const'>SIGLENBIT</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* set last unused bit */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN79"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="trgm_gist.c.html#LN79"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>&LT; </span><a href="trgm_gist.c.html#LN80"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; </span><a href="trgm_gist.c.html#LN79"><span class='Ref_To_Local'>k</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="trgm.h.html#LN43"><span class='Ref_to_Macro'>CPTRGM</span></a><span class='Parentheses'>(((</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="trgm_gist.c.html#LN82"><span class='Ref_To_Local'>tmp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN81"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>+ </span><a href="trgm_gist.c.html#LN79"><span class='Ref_To_Local'>k</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../hstore/hstore_gist.c.html#LN37"><span class='Ref_to_Macro'>HASH</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN77"><span class='Ref_to_Parameter'>sign</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN82"><span class='Ref_To_Local'>tmp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
} 
</span> 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN94"></a><span class='Declare_Function'>gtrgm_compress</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN96"></a>    <a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>entry</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN97"></a>    <a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>retval</span> <span class='Operator'>= </span><a href="trgm_gist.c.html#LN96"><span class='Ref_To_Local'>entry</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN96"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN126"><span class='Ref_to_Member'>leafkey</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{</span>                           <span class='Comment_Single_Line'>/* trgm */ 
</span><a name="LN101"></a>        <a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN102"></a>        <a href="../seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>val</span> <span class='Operator'>= </span><a href="../../src/include/fmgr.h.html#LN255"><span class='Ref_to_Macro'>DatumGetTextPP</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN96"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="trgm_gist.c.html#LN101"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="trgm.h.html#LN125"><span class='Ref_to_Proto'>generate_trgm</span></a><span class='Parentheses'>(</span><a href="../../src/include/postgres.h.html#LN346"><span class='Ref_to_Macro'>VARDATA_ANY</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN102"><span class='Ref_To_Local'>val</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN339"><span class='Ref_to_Macro'>VARSIZE_ANY_EXHDR</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN102"><span class='Ref_To_Local'>val</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="trgm_gist.c.html#LN97"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/access/gist.h.html#LN168"><span class='Ref_to_Macro'>gistentryinit</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="trgm_gist.c.html#LN97"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                      <a href="trgm_gist.c.html#LN96"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN123"><span class='Ref_to_Member'>rel</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN96"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN124"><span class='Ref_to_Member'>page</span></a><span class='Delimiter'>, 
</span>                      <a href="trgm_gist.c.html#LN96"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN125"><span class='Ref_to_Member'>offset</span></a><span class='Delimiter'>, </span><span class='Boolean'>FALSE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN62"><span class='Ref_to_Macro'>ISSIGNKEY</span></a><span class='Parentheses'>(</span><a href="../../src/include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN96"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>))</span> <span class='Operator'>&& 
</span>             <span class='Operator'>!</span><a href="../hstore/hstore_gist.c.html#LN48"><span class='Ref_to_Macro'>ISALLTRUE</span></a><span class='Parentheses'>(</span><a href="../../src/include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN96"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN113"></a>        <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>i</span><span class='Delimiter'>, 
</span><a name="LN114"></a>                    <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span><a name="LN115"></a>        <a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN116"></a>        <a href="../intarray/_int.h.html#LN54"><span class='Ref_to_Typedef'>BITVECP</span></a>     <span class='Declare_Local'>sign</span> <span class='Operator'>= </span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="../../src/include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN96"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <a href="../hstore/hstore_gist.c.html#LN24"><span class='Ref_to_Const'>LOOPBYTE</span></a> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="trgm_gist.c.html#LN116"><span class='Ref_To_Local'>sign</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN113"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>& </span><span class='Number'>0xff</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0xff</span><span class='Parentheses'>)</span> 
                <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN97"><span class='Ref_To_Local'>retval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="trgm_gist.c.html#LN114"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="../hstore/hstore_gist.c.html#LN51"><span class='Ref_to_Macro'>CALCGTSIZE</span></a><span class='Parentheses'>(</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN58"><span class='Ref_to_Const'>SIGNKEY</span></a> <span class='Operator'>| </span><a href="../hstore/hstore_gist.c.html#LN46"><span class='Ref_to_Const'>ALLISTRUE</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="trgm_gist.c.html#LN115"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN114"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN115"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN114"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="trgm_gist.c.html#LN115"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="trgm.h.html#LN65"><span class='Ref_to_Member'>flag</span></a> <span class='Operator'>= </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN58"><span class='Ref_to_Const'>SIGNKEY</span></a> <span class='Operator'>| </span><a href="../hstore/hstore_gist.c.html#LN46"><span class='Ref_to_Const'>ALLISTRUE</span></a><span class='Delimiter'>; 
</span> 
        <a href="trgm_gist.c.html#LN97"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/access/gist.h.html#LN168"><span class='Ref_to_Macro'>gistentryinit</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="trgm_gist.c.html#LN97"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN115"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                      <a href="trgm_gist.c.html#LN96"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN123"><span class='Ref_to_Member'>rel</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN96"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN124"><span class='Ref_to_Member'>page</span></a><span class='Delimiter'>, 
</span>                      <a href="trgm_gist.c.html#LN96"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN125"><span class='Ref_to_Member'>offset</span></a><span class='Delimiter'>, </span><span class='Boolean'>FALSE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if ISSIGNKEY(DatumGetPoi... &raquo; </span> 
    <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN97"><span class='Ref_To_Local'>retval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end gtrgm_compress &raquo; </span> 
 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN138"></a><span class='Declare_Function'>gtrgm_decompress</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN140"></a>    <a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>entry</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN141"></a>    <a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>retval</span><span class='Delimiter'>; 
</span><a name="LN142"></a>    <a href="../seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>key</span><span class='Delimiter'>; 
</span> 
    <a href="trgm_gist.c.html#LN142"><span class='Ref_To_Local'>key</span></a> <span class='Operator'>= </span><a href="../../src/include/fmgr.h.html#LN255"><span class='Ref_to_Macro'>DatumGetTextPP</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN140"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN142"><span class='Ref_To_Local'>key</span></a> <span class='Operator'>!= </span><span class='Parentheses'>(</span><a href="../seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN140"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* need to pass back the decompressed item */ 
</span>        <a href="trgm_gist.c.html#LN141"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/access/gist.h.html#LN168"><span class='Ref_to_Macro'>gistentryinit</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="trgm_gist.c.html#LN141"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN142"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                      <a href="trgm_gist.c.html#LN140"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN123"><span class='Ref_to_Member'>rel</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN140"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN124"><span class='Ref_to_Member'>page</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN140"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN125"><span class='Ref_to_Member'>offset</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN140"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN126"><span class='Ref_to_Member'>leafkey</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN141"><span class='Ref_To_Local'>retval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* we can return the entry as-is */ 
</span>        <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN140"><span class='Ref_To_Local'>entry</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end gtrgm_decompress &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> 
<a name="LN162"></a><span class='Declare_Function'>cnt_sml_sign_common</span><span class='Parentheses'>(</span><a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qtrg</span><span class='Delimiter'>, </span><a href="../intarray/_int.h.html#LN54"><span class='Ref_to_Typedef'>BITVECP</span></a> <span class='Declare_Parameter'>sign</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN164"></a>    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>count</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN165"></a>    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>k</span><span class='Delimiter'>, 
</span><a name="LN166"></a>                <span class='Declare_Local'>len</span> <span class='Operator'>= </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN70"><span class='Ref_to_Macro'>ARRNELEM</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN162"><span class='Ref_to_Parameter'>qtrg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN167"></a>    <a href="trgm.h.html#LN37"><span class='Ref_to_Typedef'>trgm</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>ptr</span> <span class='Operator'>= </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN69"><span class='Ref_to_Macro'>GETARR</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN162"><span class='Ref_to_Parameter'>qtrg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN168"></a>    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>tmp</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN165"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="trgm_gist.c.html#LN165"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>&LT; </span><a href="trgm_gist.c.html#LN166"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; </span><a href="trgm_gist.c.html#LN165"><span class='Ref_To_Local'>k</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="trgm.h.html#LN43"><span class='Ref_to_Macro'>CPTRGM</span></a><span class='Parentheses'>(((</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="trgm_gist.c.html#LN168"><span class='Ref_To_Local'>tmp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN167"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>+ </span><a href="trgm_gist.c.html#LN165"><span class='Ref_To_Local'>k</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="trgm_gist.c.html#LN164"><span class='Ref_To_Local'>count</span></a> <span class='Operator'>+= </span><a href="../bloom/blutils.c.html#LN33"><span class='Ref_to_Macro'>GETBIT</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN162"><span class='Ref_to_Parameter'>sign</span></a><span class='Delimiter'>, </span><a href="../hstore/hstore_gist.c.html#LN36"><span class='Ref_to_Macro'>HASHVAL</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN168"><span class='Ref_To_Local'>tmp</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="trgm_gist.c.html#LN164"><span class='Ref_To_Local'>count</span></a><span class='Delimiter'>; 
} 
</span> 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN180"></a><span class='Declare_Function'>gtrgm_consistent</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN182"></a>    <a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>entry</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN183"></a>    <a href="../seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>query</span> <span class='Operator'>= </span><a href="../../src/include/fmgr.h.html#LN299"><span class='Ref_to_Macro'>PG_GETARG_TEXT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN184"></a>    <a href="../../src/include/access/stratnum.h.html#LN21"><span class='Ref_to_Typedef'>StrategyNumber</span></a> <span class='Declare_Local'>strategy</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/stratnum.h.html#LN21"><span class='Ref_to_Typedef'>StrategyNumber</span></a><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN236"><span class='Ref_to_Macro'>PG_GETARG_UINT16</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Oid      subtype = PG_GETARG_OID(3); */ 
</span><a name="LN187"></a>    <span class='Keyword'>bool</span>       <span class='Operator'>*</span><span class='Declare_Local'>recheck</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>4</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN188"></a>    <a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>key</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN182"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN189"></a>    <a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>qtrg</span><span class='Delimiter'>; 
</span><a name="LN190"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN191"></a>    <a href="../../src/include/c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a>        <span class='Declare_Local'>querysize</span> <span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN183"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN192"></a>    <a href="trgm_gist.c.html#LN11"><span class='Ref_to_Typedef'>gtrgm_consistent_cache</span></a> <span class='Operator'>*</span><span class='Declare_Local'>cache</span><span class='Delimiter'>; 
</span><a name="LN193"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>nlimit</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We keep the extracted trigrams in cache, because trigram extraction is 
     * relatively CPU-expensive.  When trying to reuse a cached value, check 
     * strategy number not just query itself, because trigram extraction 
     * depends on strategy. 
     * 
     * The cached structure is a single palloc chunk containing the 
     * gtrgm_consistent_cache header, then the input query (4-byte length 
     * word, uncompressed, starting at a MAXALIGN boundary), then the TRGM 
     * value (also starting at a MAXALIGN boundary).  However we don't try to 
     * include the regex graph (if any) in that struct.  (XXX currently, this 
     * approach can leak regex graphs across index rescans.  Not clear if 
     * that's worth fixing.) 
     */ 
</span>    <a href="trgm_gist.c.html#LN192"><span class='Ref_To_Local'>cache</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN11"><span class='Ref_to_Typedef'>gtrgm_consistent_cache</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span>fcinfo<span class='Operator'>-&GT;</span>flinfo<span class='Operator'>-&GT;</span>fn_extra<span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN192"><span class='Ref_To_Local'>cache</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| 
</span>        <a href="trgm_gist.c.html#LN192"><span class='Ref_To_Local'>cache</span></a><span class='Operator'>-&GT;</span><a href="trgm_gist.c.html#LN14"><span class='Ref_to_Member'>strategy</span></a> <span class='Operator'>!= </span><a href="trgm_gist.c.html#LN184"><span class='Ref_To_Local'>strategy</span></a> <span class='Operator'>|| 
</span>        <a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN192"><span class='Ref_To_Local'>cache</span></a><span class='Operator'>-&GT;</span><a href="trgm_gist.c.html#LN15"><span class='Ref_to_Member'>query</span></a><span class='Parentheses'>)</span> <span class='Operator'>!= </span><a href="trgm_gist.c.html#LN191"><span class='Ref_To_Local'>querysize</span></a> <span class='Operator'>|| 
</span>        memcmp<span class='Parentheses'>((</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN192"><span class='Ref_To_Local'>cache</span></a><span class='Operator'>-&GT;</span><a href="trgm_gist.c.html#LN15"><span class='Ref_to_Member'>query</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN183"><span class='Ref_To_Local'>query</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN191"><span class='Ref_To_Local'>querysize</span></a><span class='Parentheses'>)</span> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span><a name="LN215"></a>        <a href="trgm_gist.c.html#LN11"><span class='Ref_to_Typedef'>gtrgm_consistent_cache</span></a> <span class='Operator'>*</span><span class='Declare_Local'>newcache</span><span class='Delimiter'>; 
</span><a name="LN216"></a>        <a href="trgm_regexp.c.html#LN440"><span class='Ref_to_Struct'>TrgmPackedGraph</span></a> <span class='Operator'>*</span><span class='Declare_Local'>graph</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN217"></a>        <a href="../../src/include/c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a>        <span class='Declare_Local'>qtrgsize</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN184"><span class='Ref_To_Local'>strategy</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>case</span> <a href="trgm.h.html#LN28"><span class='Ref_to_Const'>SimilarityStrategyNumber</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="trgm.h.html#LN34"><span class='Ref_to_Const'>WordSimilarityStrategyNumber</span></a><span class='Operator'>: 
</span>                <a href="trgm_gist.c.html#LN189"><span class='Ref_To_Local'>qtrg</span></a> <span class='Operator'>= </span><a href="trgm.h.html#LN125"><span class='Ref_to_Proto'>generate_trgm</span></a><span class='Parentheses'>(</span><a href="../../src/include/postgres.h.html#LN302"><span class='Ref_to_Macro'>VARDATA</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN183"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                     <a href="trgm_gist.c.html#LN191"><span class='Ref_To_Local'>querysize</span></a> <span class='Operator'>- </span><a href="../../src/include/c.h.html#LN444"><span class='Ref_to_Const'>VARHDRSZ</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="trgm.h.html#LN31"><span class='Ref_to_Const'>ILikeStrategyNumber</span></a><span class='Operator'>: 
</span><span class='Directive'>#ifndef</span> <a href="trgm.h.html#LN24"><span class='Ref_to_Const'>IGNORECASE</span></a> 
                <a href="../../src/backend/bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../src/include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cannot handle ~~* with case-sensitive trigrams"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
                <span class='Comment_Multi_Line'>/* FALL THRU */ 
</span>            <span class='Control'>case</span> <a href="trgm.h.html#LN30"><span class='Ref_to_Const'>LikeStrategyNumber</span></a><span class='Operator'>: 
</span>                <a href="trgm_gist.c.html#LN189"><span class='Ref_To_Local'>qtrg</span></a> <span class='Operator'>= </span><a href="trgm.h.html#LN126"><span class='Ref_to_Proto'>generate_wildcard_trgm</span></a><span class='Parentheses'>(</span><a href="../../src/include/postgres.h.html#LN302"><span class='Ref_to_Macro'>VARDATA</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN183"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                              <a href="trgm_gist.c.html#LN191"><span class='Ref_To_Local'>querysize</span></a> <span class='Operator'>- </span><a href="../../src/include/c.h.html#LN444"><span class='Ref_to_Const'>VARHDRSZ</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="trgm.h.html#LN33"><span class='Ref_to_Const'>RegExpICaseStrategyNumber</span></a><span class='Operator'>: 
</span><span class='Directive'>#ifndef</span> <a href="trgm.h.html#LN24"><span class='Ref_to_Const'>IGNORECASE</span></a> 
                <a href="../../src/backend/bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../src/include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cannot handle ~* with case-sensitive trigrams"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
                <span class='Comment_Multi_Line'>/* FALL THRU */ 
</span>            <span class='Control'>case</span> <a href="trgm.h.html#LN32"><span class='Ref_to_Const'>RegExpStrategyNumber</span></a><span class='Operator'>: 
</span>                <a href="trgm_gist.c.html#LN189"><span class='Ref_To_Local'>qtrg</span></a> <span class='Operator'>= </span><a href="trgm.h.html#LN130"><span class='Ref_to_Proto'>createTrgmNFA</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN183"><span class='Ref_To_Local'>query</span></a><span class='Delimiter'>, </span><a href="../../src/include/fmgr.h.html#LN162"><span class='Ref_to_Macro'>PG_GET_COLLATION</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, 
</span>                                     <span class='Operator'>&</span><a href="trgm_gist.c.html#LN216"><span class='Ref_To_Local'>graph</span></a><span class='Delimiter'>, </span>fcinfo<span class='Operator'>-&GT;</span>flinfo<span class='Operator'>-&GT;</span>fn_mcxt<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Comment_Multi_Line'>/* just in case an empty array is returned ... */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN189"><span class='Ref_To_Local'>qtrg</span></a> <span class='Operator'>&& </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN70"><span class='Ref_to_Macro'>ARRNELEM</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN189"><span class='Ref_To_Local'>qtrg</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Delimiter'>{ 
</span>                    <a href="../../src/include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN189"><span class='Ref_To_Local'>qtrg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <a href="trgm_gist.c.html#LN189"><span class='Ref_To_Local'>qtrg</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>default</span><span class='Operator'>: 
</span>                <a href="../../src/backend/bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../src/include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized strategy number: %d"</span><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN184"><span class='Ref_To_Local'>strategy</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="trgm_gist.c.html#LN189"><span class='Ref_To_Local'>qtrg</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch strategy &raquo; </span> 
 
        <a href="trgm_gist.c.html#LN217"><span class='Ref_To_Local'>qtrgsize</span></a> <span class='Operator'>= </span><a href="trgm_gist.c.html#LN189"><span class='Ref_To_Local'>qtrg</span></a> <span class='Operator'>? </span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN189"><span class='Ref_To_Local'>qtrg</span></a><span class='Parentheses'>) </span><span class='Operator'>: </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
        <a href="trgm_gist.c.html#LN215"><span class='Ref_To_Local'>newcache</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN11"><span class='Ref_to_Typedef'>gtrgm_consistent_cache</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="../../src/include/utils/palloc.h.html#LN70"><span class='Ref_to_Proto'>MemoryContextAlloc</span></a><span class='Parentheses'>(</span>fcinfo<span class='Operator'>-&GT;</span>flinfo<span class='Operator'>-&GT;</span>fn_mcxt<span class='Delimiter'>, 
</span>                               <a href="../../src/include/c.h.html#LN587"><span class='Ref_to_Macro'>MAXALIGN</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN11"><span class='Ref_to_Typedef'>gtrgm_consistent_cache</span></a><span class='Parentheses'>))</span> <span class='Operator'>+ 
</span>                               <a href="../../src/include/c.h.html#LN587"><span class='Ref_to_Macro'>MAXALIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN191"><span class='Ref_To_Local'>querysize</span></a><span class='Parentheses'>)</span> <span class='Operator'>+ 
</span>                               <a href="trgm_gist.c.html#LN217"><span class='Ref_To_Local'>qtrgsize</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="trgm_gist.c.html#LN215"><span class='Ref_To_Local'>newcache</span></a><span class='Operator'>-&GT;</span><a href="trgm_gist.c.html#LN14"><span class='Ref_to_Member'>strategy</span></a> <span class='Operator'>= </span><a href="trgm_gist.c.html#LN184"><span class='Ref_To_Local'>strategy</span></a><span class='Delimiter'>; 
</span>        <a href="trgm_gist.c.html#LN215"><span class='Ref_To_Local'>newcache</span></a><span class='Operator'>-&GT;</span><a href="trgm_gist.c.html#LN15"><span class='Ref_to_Member'>query</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <span class='Parentheses'>((</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>)</span> <a href="trgm_gist.c.html#LN215"><span class='Ref_To_Local'>newcache</span></a> <span class='Operator'>+ </span><a href="../../src/include/c.h.html#LN587"><span class='Ref_to_Macro'>MAXALIGN</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN11"><span class='Ref_to_Typedef'>gtrgm_consistent_cache</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        memcpy<span class='Parentheses'>((</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN215"><span class='Ref_To_Local'>newcache</span></a><span class='Operator'>-&GT;</span><a href="trgm_gist.c.html#LN15"><span class='Ref_to_Member'>query</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN183"><span class='Ref_To_Local'>query</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN191"><span class='Ref_To_Local'>querysize</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN189"><span class='Ref_To_Local'>qtrg</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="trgm_gist.c.html#LN215"><span class='Ref_To_Local'>newcache</span></a><span class='Operator'>-&GT;</span><a href="trgm_gist.c.html#LN17"><span class='Ref_to_Member'>trigrams</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>                <span class='Parentheses'>((</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN215"><span class='Ref_To_Local'>newcache</span></a><span class='Operator'>-&GT;</span><a href="trgm_gist.c.html#LN15"><span class='Ref_to_Member'>query</span></a> <span class='Operator'>+ </span><a href="../../src/include/c.h.html#LN587"><span class='Ref_to_Macro'>MAXALIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN191"><span class='Ref_To_Local'>querysize</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            memcpy<span class='Parentheses'>((</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN215"><span class='Ref_To_Local'>newcache</span></a><span class='Operator'>-&GT;</span><a href="trgm_gist.c.html#LN17"><span class='Ref_to_Member'>trigrams</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN189"><span class='Ref_To_Local'>qtrg</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN217"><span class='Ref_To_Local'>qtrgsize</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* release qtrg in case it was made in fn_mcxt */ 
</span>            <a href="../../src/include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN189"><span class='Ref_To_Local'>qtrg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
            <a href="trgm_gist.c.html#LN215"><span class='Ref_To_Local'>newcache</span></a><span class='Operator'>-&GT;</span><a href="trgm_gist.c.html#LN17"><span class='Ref_to_Member'>trigrams</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="trgm_gist.c.html#LN215"><span class='Ref_To_Local'>newcache</span></a><span class='Operator'>-&GT;</span><a href="trgm_gist.c.html#LN19"><span class='Ref_to_Member'>graph</span></a> <span class='Operator'>= </span><a href="trgm_gist.c.html#LN216"><span class='Ref_To_Local'>graph</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN192"><span class='Ref_To_Local'>cache</span></a><span class='Parentheses'>) 
</span>            <a href="../../src/include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN192"><span class='Ref_To_Local'>cache</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        fcinfo<span class='Operator'>-&GT;</span>flinfo<span class='Operator'>-&GT;</span>fn_extra <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN215"><span class='Ref_To_Local'>newcache</span></a><span class='Delimiter'>; 
</span>        <a href="trgm_gist.c.html#LN192"><span class='Ref_To_Local'>cache</span></a> <span class='Operator'>= </span><a href="trgm_gist.c.html#LN215"><span class='Ref_To_Local'>newcache</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if cache==NULL||cache-&GT;s... &raquo; </span> 
 
    <a href="trgm_gist.c.html#LN189"><span class='Ref_To_Local'>qtrg</span></a> <span class='Operator'>= </span><a href="trgm_gist.c.html#LN192"><span class='Ref_To_Local'>cache</span></a><span class='Operator'>-&GT;</span><a href="trgm_gist.c.html#LN17"><span class='Ref_to_Member'>trigrams</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN184"><span class='Ref_To_Local'>strategy</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="trgm.h.html#LN28"><span class='Ref_to_Const'>SimilarityStrategyNumber</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="trgm.h.html#LN34"><span class='Ref_to_Const'>WordSimilarityStrategyNumber</span></a><span class='Operator'>: 
</span>            <span class='Comment_Multi_Line'>/* Similarity search is exact. Word similarity search is inexact */ 
</span>            <span class='Operator'>*</span><a href="trgm_gist.c.html#LN187"><span class='Ref_To_Local'>recheck</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN184"><span class='Ref_To_Local'>strategy</span></a> <span class='Operator'>== </span><a href="trgm.h.html#LN34"><span class='Ref_to_Const'>WordSimilarityStrategyNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="trgm_gist.c.html#LN193"><span class='Ref_To_Local'>nlimit</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN184"><span class='Ref_To_Local'>strategy</span></a> <span class='Operator'>== </span><a href="trgm.h.html#LN28"><span class='Ref_to_Const'>SimilarityStrategyNumber</span></a><span class='Parentheses'>) </span><span class='Operator'>? 
</span>                <a href="trgm_op.c.html#LN18"><span class='Ref_to_Global_Var'>similarity_threshold</span></a> <span class='Operator'>: </span><a href="trgm_op.c.html#LN19"><span class='Ref_to_Global_Var'>word_similarity_threshold</span></a><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN132"><span class='Ref_to_Macro'>GIST_LEAF</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN182"><span class='Ref_To_Local'>entry</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{</span>                   <span class='Comment_Single_Line'>/* all leafs contains orig trgm */ 
</span><a name="LN299"></a>                <span class='Keyword'>double</span>      <span class='Declare_Local'>tmpsml</span> <span class='Operator'>= </span><a href="trgm.h.html#LN127"><span class='Ref_to_Proto'>cnt_sml</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN189"><span class='Ref_To_Local'>qtrg</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN188"><span class='Ref_To_Local'>key</span></a><span class='Delimiter'>, </span><span class='Operator'>*</span><a href="trgm_gist.c.html#LN187"><span class='Ref_To_Local'>recheck</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <a href="trgm_gist.c.html#LN190"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN299"><span class='Ref_To_Local'>tmpsml</span></a> <span class='Operator'>&GT;= </span><a href="trgm_gist.c.html#LN193"><span class='Ref_To_Local'>nlimit</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN48"><span class='Ref_to_Macro'>ISALLTRUE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN188"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{</span>                   <span class='Comment_Single_Line'>/* non-leaf contains signature */ 
</span>                <a href="trgm_gist.c.html#LN190"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{</span>                   <span class='Comment_Single_Line'>/* non-leaf contains signature */ 
</span><a name="LN309"></a>                <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>count</span> <span class='Operator'>= </span><a href="trgm_gist.c.html#LN161"><span class='Ref_to_Func'>cnt_sml_sign_common</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN189"><span class='Ref_To_Local'>qtrg</span></a><span class='Delimiter'>, </span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN188"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span><a name="LN310"></a>                <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>len</span> <span class='Operator'>= </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN70"><span class='Ref_to_Macro'>ARRNELEM</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN189"><span class='Ref_To_Local'>qtrg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN310"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                    <a href="trgm_gist.c.html#LN190"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                <span class='Control'>else</span> 
                    <a href="trgm_gist.c.html#LN190"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Parentheses'>(((((</span><a href="../../src/include/c.h.html#LN380"><span class='Ref_to_Typedef'>float8</span></a><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN309"><span class='Ref_To_Local'>count</span></a><span class='Parentheses'>)</span> <span class='Operator'>/ </span><span class='Parentheses'>((</span><a href="../../src/include/c.h.html#LN380"><span class='Ref_to_Typedef'>float8</span></a><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN310"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)))</span> <span class='Operator'>&GT;= </span><a href="trgm_gist.c.html#LN193"><span class='Ref_To_Local'>nlimit</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="trgm.h.html#LN31"><span class='Ref_to_Const'>ILikeStrategyNumber</span></a><span class='Operator'>: 
</span><span class='Directive'>#ifndef</span> <a href="trgm.h.html#LN24"><span class='Ref_to_Const'>IGNORECASE</span></a> 
            <a href="../../src/backend/bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../src/include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cannot handle ~~* with case-sensitive trigrams"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
            <span class='Comment_Multi_Line'>/* FALL THRU */ 
</span>        <span class='Control'>case</span> <a href="trgm.h.html#LN30"><span class='Ref_to_Const'>LikeStrategyNumber</span></a><span class='Operator'>: 
</span>            <span class='Comment_Multi_Line'>/* Wildcard search is inexact */ 
</span>            <span class='Operator'>*</span><a href="trgm_gist.c.html#LN187"><span class='Ref_To_Local'>recheck</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Check if all the extracted trigrams can be present in child 
             * nodes. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN132"><span class='Ref_to_Macro'>GIST_LEAF</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN182"><span class='Ref_To_Local'>entry</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{</span>                   <span class='Comment_Single_Line'>/* all leafs contains orig trgm */ 
</span>                <a href="trgm_gist.c.html#LN190"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="trgm.h.html#LN128"><span class='Ref_to_Proto'>trgm_contained_by</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN189"><span class='Ref_To_Local'>qtrg</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN188"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN48"><span class='Ref_to_Macro'>ISALLTRUE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN188"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{</span>                   <span class='Comment_Single_Line'>/* non-leaf contains signature */ 
</span>                <a href="trgm_gist.c.html#LN190"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{</span>                   <span class='Comment_Single_Line'>/* non-leaf contains signature */ 
</span><a name="LN341"></a>                <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>k</span><span class='Delimiter'>, 
</span><a name="LN342"></a>                            <span class='Declare_Local'>tmp</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>, 
</span><a name="LN343"></a>                            <span class='Declare_Local'>len</span> <span class='Operator'>= </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN70"><span class='Ref_to_Macro'>ARRNELEM</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN189"><span class='Ref_To_Local'>qtrg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN344"></a>                <a href="trgm.h.html#LN37"><span class='Ref_to_Typedef'>trgm</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>ptr</span> <span class='Operator'>= </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN69"><span class='Ref_to_Macro'>GETARR</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN189"><span class='Ref_To_Local'>qtrg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN345"></a>                <a href="../intarray/_int.h.html#LN54"><span class='Ref_to_Typedef'>BITVECP</span></a>     <span class='Declare_Local'>sign</span> <span class='Operator'>= </span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN188"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <a href="trgm_gist.c.html#LN190"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN341"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="trgm_gist.c.html#LN341"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>&LT; </span><a href="trgm_gist.c.html#LN343"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; </span><a href="trgm_gist.c.html#LN341"><span class='Ref_To_Local'>k</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <a href="trgm.h.html#LN43"><span class='Ref_to_Macro'>CPTRGM</span></a><span class='Parentheses'>(((</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="trgm_gist.c.html#LN342"><span class='Ref_To_Local'>tmp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN344"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>+ </span><a href="trgm_gist.c.html#LN341"><span class='Ref_To_Local'>k</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../bloom/blutils.c.html#LN33"><span class='Ref_to_Macro'>GETBIT</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN345"><span class='Ref_To_Local'>sign</span></a><span class='Delimiter'>, </span><a href="../hstore/hstore_gist.c.html#LN36"><span class='Ref_to_Macro'>HASHVAL</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN342"><span class='Ref_To_Local'>tmp</span></a><span class='Parentheses'>)))</span> 
                    <span class='Delimiter'>{ 
</span>                        <a href="trgm_gist.c.html#LN190"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                        <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="trgm.h.html#LN33"><span class='Ref_to_Const'>RegExpICaseStrategyNumber</span></a><span class='Operator'>: 
</span><span class='Directive'>#ifndef</span> <a href="trgm.h.html#LN24"><span class='Ref_to_Const'>IGNORECASE</span></a> 
            <a href="../../src/backend/bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../src/include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cannot handle ~* with case-sensitive trigrams"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
            <span class='Comment_Multi_Line'>/* FALL THRU */ 
</span>        <span class='Control'>case</span> <a href="trgm.h.html#LN32"><span class='Ref_to_Const'>RegExpStrategyNumber</span></a><span class='Operator'>: 
</span>            <span class='Comment_Multi_Line'>/* Regexp search is inexact */ 
</span>            <span class='Operator'>*</span><a href="trgm_gist.c.html#LN187"><span class='Ref_To_Local'>recheck</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Check regex match as much as we can with available info */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN189"><span class='Ref_To_Local'>qtrg</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN132"><span class='Ref_to_Macro'>GIST_LEAF</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN182"><span class='Ref_To_Local'>entry</span></a><span class='Parentheses'>))</span> 
                <span class='Delimiter'>{</span>               <span class='Comment_Single_Line'>/* all leafs contains orig trgm */ 
</span><a name="LN373"></a>                    <span class='Keyword'>bool</span>       <span class='Operator'>*</span><span class='Declare_Local'>check</span><span class='Delimiter'>; 
</span> 
                    <a href="trgm_gist.c.html#LN373"><span class='Ref_To_Local'>check</span></a> <span class='Operator'>= </span><a href="trgm.h.html#LN129"><span class='Ref_to_Proto'>trgm_presence_map</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN189"><span class='Ref_To_Local'>qtrg</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN188"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <a href="trgm_gist.c.html#LN190"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="trgm.h.html#LN132"><span class='Ref_to_Proto'>trigramsMatchGraph</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN192"><span class='Ref_To_Local'>cache</span></a><span class='Operator'>-&GT;</span><a href="trgm_gist.c.html#LN19"><span class='Ref_to_Member'>graph</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN373"><span class='Ref_To_Local'>check</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <a href="../../src/include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN373"><span class='Ref_To_Local'>check</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN48"><span class='Ref_to_Macro'>ISALLTRUE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN188"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>))</span> 
                <span class='Delimiter'>{</span>               <span class='Comment_Single_Line'>/* non-leaf contains signature */ 
</span>                    <a href="trgm_gist.c.html#LN190"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                <span class='Delimiter'>{</span>               <span class='Comment_Single_Line'>/* non-leaf contains signature */ 
</span><a name="LN385"></a>                    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>k</span><span class='Delimiter'>, 
</span><a name="LN386"></a>                                <span class='Declare_Local'>tmp</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>, 
</span><a name="LN387"></a>                                <span class='Declare_Local'>len</span> <span class='Operator'>= </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN70"><span class='Ref_to_Macro'>ARRNELEM</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN189"><span class='Ref_To_Local'>qtrg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN388"></a>                    <a href="trgm.h.html#LN37"><span class='Ref_to_Typedef'>trgm</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>ptr</span> <span class='Operator'>= </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN69"><span class='Ref_to_Macro'>GETARR</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN189"><span class='Ref_To_Local'>qtrg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN389"></a>                    <a href="../intarray/_int.h.html#LN54"><span class='Ref_to_Typedef'>BITVECP</span></a>     <span class='Declare_Local'>sign</span> <span class='Operator'>= </span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN188"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN390"></a>                    <span class='Keyword'>bool</span>       <span class='Operator'>*</span><span class='Declare_Local'>check</span><span class='Delimiter'>; 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * GETBIT() tests may give false positives, due to limited 
                     * size of the sign array.  But since trigramsMatchGraph() 
                     * implements a monotone boolean function, false positives 
                     * in the check array can't lead to false negative answer. 
                     * So we can apply trigramsMatchGraph despite uncertainty, 
                     * and that usefully improves the quality of the search. 
                     */ 
</span>                    <a href="trgm_gist.c.html#LN390"><span class='Ref_To_Local'>check</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN387"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Keyword'>bool</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN385"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="trgm_gist.c.html#LN385"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>&LT; </span><a href="trgm_gist.c.html#LN387"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; </span><a href="trgm_gist.c.html#LN385"><span class='Ref_To_Local'>k</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <a href="trgm.h.html#LN43"><span class='Ref_to_Macro'>CPTRGM</span></a><span class='Parentheses'>(((</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="trgm_gist.c.html#LN386"><span class='Ref_To_Local'>tmp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN388"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>+ </span><a href="trgm_gist.c.html#LN385"><span class='Ref_To_Local'>k</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                        <a href="trgm_gist.c.html#LN390"><span class='Ref_To_Local'>check</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN385"><span class='Ref_To_Local'>k</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../bloom/blutils.c.html#LN33"><span class='Ref_to_Macro'>GETBIT</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN389"><span class='Ref_To_Local'>sign</span></a><span class='Delimiter'>, </span><a href="../hstore/hstore_gist.c.html#LN36"><span class='Ref_to_Macro'>HASHVAL</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN386"><span class='Ref_To_Local'>tmp</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    <a href="trgm_gist.c.html#LN190"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="trgm.h.html#LN132"><span class='Ref_to_Proto'>trigramsMatchGraph</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN192"><span class='Ref_To_Local'>cache</span></a><span class='Operator'>-&GT;</span><a href="trgm_gist.c.html#LN19"><span class='Ref_to_Member'>graph</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN390"><span class='Ref_To_Local'>check</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <a href="../../src/include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN390"><span class='Ref_To_Local'>check</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
            <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if qtrg &raquo; </span> 
            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* trigram-free query must be rechecked everywhere */ 
</span>                <a href="trgm_gist.c.html#LN190"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="../../src/backend/bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../src/include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized strategy number: %d"</span><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN184"><span class='Ref_To_Local'>strategy</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="trgm_gist.c.html#LN190"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch strategy &raquo; </span> 
 
    <a href="../../src/include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN190"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end gtrgm_consistent &raquo; </span> 
 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN426"></a><span class='Declare_Function'>gtrgm_distance</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN428"></a>    <a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>entry</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN429"></a>    <a href="../seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>query</span> <span class='Operator'>= </span><a href="../../src/include/fmgr.h.html#LN299"><span class='Ref_to_Macro'>PG_GETARG_TEXT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN430"></a>    <a href="../../src/include/access/stratnum.h.html#LN21"><span class='Ref_to_Typedef'>StrategyNumber</span></a> <span class='Declare_Local'>strategy</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/stratnum.h.html#LN21"><span class='Ref_to_Typedef'>StrategyNumber</span></a><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN236"><span class='Ref_to_Macro'>PG_GETARG_UINT16</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Oid      subtype = PG_GETARG_OID(3); */ 
</span><a name="LN433"></a>    <span class='Keyword'>bool</span>       <span class='Operator'>*</span><span class='Declare_Local'>recheck</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>4</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN434"></a>    <a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>key</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN428"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN435"></a>    <a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>qtrg</span><span class='Delimiter'>; 
</span><a name="LN436"></a>    <a href="../../src/include/c.h.html#LN380"><span class='Ref_to_Typedef'>float8</span></a>      <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN437"></a>    <a href="../../src/include/c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a>        <span class='Declare_Local'>querysize</span> <span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN429"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN438"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>cache</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span>fcinfo<span class='Operator'>-&GT;</span>flinfo<span class='Operator'>-&GT;</span>fn_extra<span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Cache the generated trigrams across multiple calls with the same query. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN438"><span class='Ref_To_Local'>cache</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| 
</span>        <a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN438"><span class='Ref_To_Local'>cache</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="trgm_gist.c.html#LN437"><span class='Ref_To_Local'>querysize</span></a> <span class='Operator'>|| 
</span>        memcmp<span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN438"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN429"><span class='Ref_To_Local'>query</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN437"><span class='Ref_To_Local'>querysize</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span><a name="LN447"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>newcache</span><span class='Delimiter'>; 
</span> 
        <a href="trgm_gist.c.html#LN435"><span class='Ref_To_Local'>qtrg</span></a> <span class='Operator'>= </span><a href="trgm.h.html#LN125"><span class='Ref_to_Proto'>generate_trgm</span></a><span class='Parentheses'>(</span><a href="../../src/include/postgres.h.html#LN302"><span class='Ref_to_Macro'>VARDATA</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN429"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN437"><span class='Ref_To_Local'>querysize</span></a> <span class='Operator'>- </span><a href="../../src/include/c.h.html#LN444"><span class='Ref_to_Const'>VARHDRSZ</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="trgm_gist.c.html#LN447"><span class='Ref_To_Local'>newcache</span></a> <span class='Operator'>= </span><a href="../../src/include/utils/palloc.h.html#LN70"><span class='Ref_to_Proto'>MemoryContextAlloc</span></a><span class='Parentheses'>(</span>fcinfo<span class='Operator'>-&GT;</span>flinfo<span class='Operator'>-&GT;</span>fn_mcxt<span class='Delimiter'>, 
</span>                                      <a href="../../src/include/c.h.html#LN587"><span class='Ref_to_Macro'>MAXALIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN437"><span class='Ref_To_Local'>querysize</span></a><span class='Parentheses'>) </span><span class='Operator'>+ 
</span>                                      <a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN435"><span class='Ref_To_Local'>qtrg</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        memcpy<span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN447"><span class='Ref_To_Local'>newcache</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN429"><span class='Ref_To_Local'>query</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN437"><span class='Ref_To_Local'>querysize</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        memcpy<span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN447"><span class='Ref_To_Local'>newcache</span></a> <span class='Operator'>+ </span><a href="../../src/include/c.h.html#LN587"><span class='Ref_to_Macro'>MAXALIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN437"><span class='Ref_To_Local'>querysize</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN435"><span class='Ref_To_Local'>qtrg</span></a><span class='Delimiter'>, </span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN435"><span class='Ref_To_Local'>qtrg</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN438"><span class='Ref_To_Local'>cache</span></a><span class='Parentheses'>) 
</span>            <a href="../../src/include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN438"><span class='Ref_To_Local'>cache</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        fcinfo<span class='Operator'>-&GT;</span>flinfo<span class='Operator'>-&GT;</span>fn_extra <span class='Operator'>= </span><a href="trgm_gist.c.html#LN447"><span class='Ref_To_Local'>newcache</span></a><span class='Delimiter'>; 
</span>        <a href="trgm_gist.c.html#LN438"><span class='Ref_To_Local'>cache</span></a> <span class='Operator'>= </span><a href="trgm_gist.c.html#LN447"><span class='Ref_To_Local'>newcache</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if cache==NULL||VARSIZE(... &raquo; </span> 
 
    <a href="trgm_gist.c.html#LN435"><span class='Ref_To_Local'>qtrg</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a> <span class='Operator'>*</span><span class='Parentheses'>) (</span><a href="trgm_gist.c.html#LN438"><span class='Ref_To_Local'>cache</span></a> <span class='Operator'>+ </span><a href="../../src/include/c.h.html#LN587"><span class='Ref_to_Macro'>MAXALIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN437"><span class='Ref_To_Local'>querysize</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN430"><span class='Ref_To_Local'>strategy</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="trgm.h.html#LN29"><span class='Ref_to_Const'>DistanceStrategyNumber</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="trgm.h.html#LN35"><span class='Ref_to_Const'>WordDistanceStrategyNumber</span></a><span class='Operator'>: 
</span>            <span class='Operator'>*</span><a href="trgm_gist.c.html#LN433"><span class='Ref_To_Local'>recheck</span></a> <span class='Operator'>= </span><a href="trgm_gist.c.html#LN430"><span class='Ref_To_Local'>strategy</span></a> <span class='Operator'>== </span><a href="trgm.h.html#LN35"><span class='Ref_to_Const'>WordDistanceStrategyNumber</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN132"><span class='Ref_to_Macro'>GIST_LEAF</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN428"><span class='Ref_To_Local'>entry</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{</span>                   <span class='Comment_Single_Line'>/* all leafs contains orig trgm */ 
</span> 
                <span class='Comment_Multi_Line'>/* 
                 * Prevent gcc optimizing the sml variable using volatile 
                 * keyword. Otherwise res can differ from the 
                 * word_similarity_dist_op() function. 
                 */ 
</span><a name="LN479"></a>                <a href="../../src/include/c.h.html#LN379"><span class='Ref_to_Typedef'>float4</span></a> <span class='Keyword'>volatile </span><span class='Declare_Local'>sml</span> <span class='Operator'>= </span><a href="trgm.h.html#LN127"><span class='Ref_to_Proto'>cnt_sml</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN435"><span class='Ref_To_Local'>qtrg</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN434"><span class='Ref_To_Local'>key</span></a><span class='Delimiter'>, </span><span class='Operator'>*</span><a href="trgm_gist.c.html#LN433"><span class='Ref_To_Local'>recheck</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <a href="trgm_gist.c.html#LN436"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Operator'>.</span><span class='Number'>0</span> <span class='Operator'>- </span><a href="trgm_gist.c.html#LN479"><span class='Ref_To_Local'>sml</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN48"><span class='Ref_to_Macro'>ISALLTRUE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN434"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{</span>                   <span class='Comment_Single_Line'>/* all leafs contains orig trgm */ 
</span>                <a href="trgm_gist.c.html#LN436"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{</span>                   <span class='Comment_Single_Line'>/* non-leaf contains signature */ 
</span><a name="LN489"></a>                <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>count</span> <span class='Operator'>= </span><a href="trgm_gist.c.html#LN161"><span class='Ref_to_Func'>cnt_sml_sign_common</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN435"><span class='Ref_To_Local'>qtrg</span></a><span class='Delimiter'>, </span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN434"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span><a name="LN490"></a>                <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>len</span> <span class='Operator'>= </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN70"><span class='Ref_to_Macro'>ARRNELEM</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN435"><span class='Ref_To_Local'>qtrg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <a href="trgm_gist.c.html#LN436"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN490"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) </span><span class='Operator'>? -</span><span class='Number'>1</span><span class='Operator'>.</span><span class='Number'>0</span> <span class='Operator'>: </span><span class='Number'>1</span><span class='Operator'>.</span><span class='Number'>0</span> <span class='Operator'>- </span><span class='Parentheses'>((</span><a href="../../src/include/c.h.html#LN380"><span class='Ref_to_Typedef'>float8</span></a><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN489"><span class='Ref_To_Local'>count</span></a><span class='Parentheses'>)</span> <span class='Operator'>/ </span><span class='Parentheses'>((</span><a href="../../src/include/c.h.html#LN380"><span class='Ref_to_Typedef'>float8</span></a><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN490"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="../../src/backend/bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../src/include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized strategy number: %d"</span><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN430"><span class='Ref_To_Local'>strategy</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="trgm_gist.c.html#LN436"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>;</span>            <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch strategy &raquo; </span> 
 
    <a href="../../src/include/fmgr.h.html#LN325"><span class='Ref_to_Macro'>PG_RETURN_FLOAT8</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN436"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end gtrgm_distance &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> 
<a name="LN505"></a><span class='Declare_Function'>unionkey</span><span class='Parentheses'>(</span><a href="../intarray/_int.h.html#LN54"><span class='Ref_to_Typedef'>BITVECP</span></a> <span class='Declare_Parameter'>sbase</span><span class='Delimiter'>, </span><a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>add</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN507"></a>    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN62"><span class='Ref_to_Macro'>ISSIGNKEY</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN505"><span class='Ref_to_Parameter'>add</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN511"></a>        <a href="../intarray/_int.h.html#LN54"><span class='Ref_to_Typedef'>BITVECP</span></a>     <span class='Declare_Local'>sadd</span> <span class='Operator'>= </span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN505"><span class='Ref_to_Parameter'>add</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN48"><span class='Ref_to_Macro'>ISALLTRUE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN505"><span class='Ref_to_Parameter'>add</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span> 
        <a href="../hstore/hstore_gist.c.html#LN24"><span class='Ref_to_Const'>LOOPBYTE</span></a> 
            <a href="trgm_gist.c.html#LN505"><span class='Ref_to_Parameter'>sbase</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN507"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>|= </span><a href="trgm_gist.c.html#LN511"><span class='Ref_To_Local'>sadd</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN507"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span><a name="LN521"></a>        <a href="trgm.h.html#LN37"><span class='Ref_to_Typedef'>trgm</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>ptr</span> <span class='Operator'>= </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN69"><span class='Ref_to_Macro'>GETARR</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN505"><span class='Ref_to_Parameter'>add</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN522"></a>        <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>tmp</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN507"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="trgm_gist.c.html#LN507"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN70"><span class='Ref_to_Macro'>ARRNELEM</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN505"><span class='Ref_to_Parameter'>add</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="trgm_gist.c.html#LN507"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="trgm.h.html#LN43"><span class='Ref_to_Macro'>CPTRGM</span></a><span class='Parentheses'>(((</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="trgm_gist.c.html#LN522"><span class='Ref_To_Local'>tmp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN521"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>+ </span><a href="trgm_gist.c.html#LN507"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../hstore/hstore_gist.c.html#LN37"><span class='Ref_to_Macro'>HASH</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN505"><span class='Ref_to_Parameter'>sbase</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN522"><span class='Ref_To_Local'>tmp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end unionkey &raquo; </span> 
 
 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN535"></a><span class='Declare_Function'>gtrgm_union</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN537"></a>    <a href="../../src/include/access/gist.h.html#LN157"><span class='Ref_to_Typedef'>GistEntryVector</span></a> <span class='Operator'>*</span><span class='Declare_Local'>entryvec</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN157"><span class='Ref_to_Typedef'>GistEntryVector</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN538"></a>    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>len</span> <span class='Operator'>= </span><a href="trgm_gist.c.html#LN537"><span class='Ref_To_Local'>entryvec</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN159"><span class='Ref_to_Member'>n</span></a><span class='Delimiter'>; 
</span><a name="LN539"></a>    <span class='Keyword'>int</span>        <span class='Operator'>*</span><span class='Declare_Local'>size</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN540"></a>    <a href="../intarray/_int.h.html#LN53"><span class='Ref_to_Typedef'>BITVEC</span></a>      <span class='Declare_Local'>base</span><span class='Delimiter'>; 
</span><a name="LN541"></a>    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN542"></a>    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>flag</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN543"></a>    <a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/c.h.html#LN856"><span class='Ref_to_Macro'>MemSet</span></a><span class='Parentheses'>((</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN540"><span class='Ref_To_Local'>base</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../intarray/_int.h.html#LN53"><span class='Ref_to_Typedef'>BITVEC</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN541"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="trgm_gist.c.html#LN541"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="trgm_gist.c.html#LN538"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; </span><a href="trgm_gist.c.html#LN541"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../ltree/_ltree_gist.c.html#LN162"><span class='Ref_to_Func'>unionkey</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN540"><span class='Ref_To_Local'>base</span></a><span class='Delimiter'>, </span><a href="../intarray/_intbig_gist.c.html#LN10"><span class='Ref_to_Macro'>GETENTRY</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN537"><span class='Ref_To_Local'>entryvec</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN541"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="trgm_gist.c.html#LN542"><span class='Ref_To_Local'>flag</span></a> <span class='Operator'>= </span><a href="../hstore/hstore_gist.c.html#LN46"><span class='Ref_to_Const'>ALLISTRUE</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="trgm_gist.c.html#LN542"><span class='Ref_To_Local'>flag</span></a> <span class='Operator'>|= </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN58"><span class='Ref_to_Const'>SIGNKEY</span></a><span class='Delimiter'>; 
</span>    <a href="trgm_gist.c.html#LN538"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="../hstore/hstore_gist.c.html#LN51"><span class='Ref_to_Macro'>CALCGTSIZE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN542"><span class='Ref_To_Local'>flag</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="trgm_gist.c.html#LN543"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN538"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN543"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN538"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="trgm_gist.c.html#LN543"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="trgm.h.html#LN65"><span class='Ref_to_Member'>flag</span></a> <span class='Operator'>= </span><a href="trgm_gist.c.html#LN542"><span class='Ref_To_Local'>flag</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../hstore/hstore_gist.c.html#LN48"><span class='Ref_to_Macro'>ISALLTRUE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN543"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span> 
        memcpy<span class='Parentheses'>((</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN543"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN540"><span class='Ref_To_Local'>base</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../intarray/_int.h.html#LN53"><span class='Ref_to_Typedef'>BITVEC</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="trgm_gist.c.html#LN539"><span class='Ref_To_Local'>size</span></a> <span class='Operator'>= </span><a href="trgm_gist.c.html#LN538"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN543"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end gtrgm_union &raquo; </span> 
 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN568"></a><span class='Declare_Function'>gtrgm_same</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN570"></a>    <a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>a</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN571"></a>    <a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>b</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN572"></a>    <span class='Keyword'>bool</span>       <span class='Operator'>*</span><span class='Declare_Local'>result</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN62"><span class='Ref_to_Macro'>ISSIGNKEY</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN570"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{</span>                           <span class='Comment_Single_Line'>/* then b also ISSIGNKEY */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN48"><span class='Ref_to_Macro'>ISALLTRUE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN570"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><a href="../hstore/hstore_gist.c.html#LN48"><span class='Ref_to_Macro'>ISALLTRUE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN571"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>))</span> 
            <span class='Operator'>*</span><a href="trgm_gist.c.html#LN572"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN48"><span class='Ref_to_Macro'>ISALLTRUE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN570"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>))</span> 
            <span class='Operator'>*</span><a href="trgm_gist.c.html#LN572"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN48"><span class='Ref_to_Macro'>ISALLTRUE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN571"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>))</span> 
            <span class='Operator'>*</span><a href="trgm_gist.c.html#LN572"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span><a name="LN584"></a>            <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN585"></a>            <a href="../intarray/_int.h.html#LN54"><span class='Ref_to_Typedef'>BITVECP</span></a>     <span class='Declare_Local'>sa</span> <span class='Operator'>= </span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN570"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span><a name="LN586"></a>                        <span class='Declare_Local'>sb</span> <span class='Operator'>= </span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN571"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Operator'>*</span><a href="trgm_gist.c.html#LN572"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <a href="../hstore/hstore_gist.c.html#LN24"><span class='Ref_to_Const'>LOOPBYTE</span></a> 
            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN585"><span class='Ref_To_Local'>sa</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN584"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>!= </span><a href="trgm_gist.c.html#LN586"><span class='Ref_To_Local'>sb</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN584"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Operator'>*</span><a href="trgm_gist.c.html#LN572"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if ISSIGNKEY(a) &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{</span>                           <span class='Comment_Single_Line'>/* a and b ISARRKEY */ 
</span><a name="LN601"></a>        <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>lena</span> <span class='Operator'>= </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN70"><span class='Ref_to_Macro'>ARRNELEM</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN570"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span><a name="LN602"></a>                    <span class='Declare_Local'>lenb</span> <span class='Operator'>= </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN70"><span class='Ref_to_Macro'>ARRNELEM</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN571"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN601"><span class='Ref_To_Local'>lena</span></a> <span class='Operator'>!= </span><a href="trgm_gist.c.html#LN602"><span class='Ref_To_Local'>lenb</span></a><span class='Parentheses'>) 
</span>            <span class='Operator'>*</span><a href="trgm_gist.c.html#LN572"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span><a name="LN608"></a>            <a href="trgm.h.html#LN37"><span class='Ref_to_Typedef'>trgm</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>ptra</span> <span class='Operator'>= </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN69"><span class='Ref_to_Macro'>GETARR</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN570"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span><a name="LN609"></a>                       <span class='Operator'>*</span><span class='Declare_Local'>ptrb</span> <span class='Operator'>= </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN69"><span class='Ref_to_Macro'>GETARR</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN571"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN610"></a>            <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
            <span class='Operator'>*</span><a href="trgm_gist.c.html#LN572"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN610"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="trgm_gist.c.html#LN610"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="trgm_gist.c.html#LN601"><span class='Ref_To_Local'>lena</span></a><span class='Delimiter'>; </span><a href="trgm_gist.c.html#LN610"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="trgm.h.html#LN41"><span class='Ref_to_Macro'>CMPTRGM</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN608"><span class='Ref_To_Local'>ptra</span></a> <span class='Operator'>+ </span><a href="trgm_gist.c.html#LN610"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN609"><span class='Ref_To_Local'>ptrb</span></a> <span class='Operator'>+ </span><a href="trgm_gist.c.html#LN610"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> 
                <span class='Delimiter'>{ 
</span>                    <span class='Operator'>*</span><a href="trgm_gist.c.html#LN572"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN572"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end gtrgm_same &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> 
<a name="LN626"></a><span class='Declare_Function'>sizebitvec</span><span class='Parentheses'>(</span><a href="../intarray/_int.h.html#LN54"><span class='Ref_to_Typedef'>BITVECP</span></a> <span class='Declare_Parameter'>sign</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN628"></a>    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>size</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>, 
</span><a name="LN629"></a>                <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <a href="../hstore/hstore_gist.c.html#LN24"><span class='Ref_to_Const'>LOOPBYTE</span></a> 
        <a href="trgm_gist.c.html#LN628"><span class='Ref_To_Local'>size</span></a> <span class='Operator'>+= </span><a href="../intarray/_intbig_gist.c.html#LN23"><span class='Ref_to_Global_Var'>number_of_ones</span></a><span class='Delimiter'>[</span><span class='Parentheses'>(</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN626"><span class='Ref_to_Parameter'>sign</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN629"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]]; 
</span>    <span class='Control'>return</span> <a href="trgm_gist.c.html#LN628"><span class='Ref_To_Local'>size</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN637"></a><span class='Declare_Function'>hemdistsign</span><span class='Parentheses'>(</span><a href="../intarray/_int.h.html#LN54"><span class='Ref_to_Typedef'>BITVECP</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="../intarray/_int.h.html#LN54"><span class='Ref_to_Typedef'>BITVECP</span></a> <span class='Declare_Parameter'>b</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN639"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>, 
</span><a name="LN640"></a>                <span class='Declare_Local'>diff</span><span class='Delimiter'>, 
</span><a name="LN641"></a>                <span class='Declare_Local'>dist</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <a href="../hstore/hstore_gist.c.html#LN24"><span class='Ref_to_Const'>LOOPBYTE</span></a> 
    <span class='Delimiter'>{ 
</span>        <a href="trgm_gist.c.html#LN640"><span class='Ref_To_Local'>diff</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) (</span><a href="trgm_gist.c.html#LN637"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN639"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>^ </span><a href="trgm_gist.c.html#LN637"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN639"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="trgm_gist.c.html#LN641"><span class='Ref_To_Local'>dist</span></a> <span class='Operator'>+= </span><a href="../intarray/_intbig_gist.c.html#LN23"><span class='Ref_to_Global_Var'>number_of_ones</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN640"><span class='Ref_To_Local'>diff</span></a><span class='Delimiter'>]; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="trgm_gist.c.html#LN641"><span class='Ref_To_Local'>dist</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN652"></a><span class='Declare_Function'>hemdist</span><span class='Parentheses'>(</span><a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>b</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN48"><span class='Ref_to_Macro'>ISALLTRUE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN652"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN48"><span class='Ref_to_Macro'>ISALLTRUE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN652"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <span class='Control'>return</span> <a href="../hstore/hstore_gist.c.html#LN16"><span class='Ref_to_Const'>SIGLENBIT</span></a> <span class='Operator'>- </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN92"><span class='Ref_to_Proto'>sizebitvec</span></a><span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN652"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN48"><span class='Ref_to_Macro'>ISALLTRUE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN652"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <a href="../hstore/hstore_gist.c.html#LN16"><span class='Ref_to_Const'>SIGLENBIT</span></a> <span class='Operator'>- </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN92"><span class='Ref_to_Proto'>sizebitvec</span></a><span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN652"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="../intarray/_intbig_gist.c.html#LN217"><span class='Ref_to_Func'>hemdistsign</span></a><span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN652"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN652"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN668"></a><span class='Declare_Function'>gtrgm_penalty</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN670"></a>    <a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>origentry</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; </span><span class='Comment_Single_Line'>/* always ISSIGNKEY */ 
</span><a name="LN671"></a>    <a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>newentry</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN120"><span class='Ref_to_Struct'>GISTENTRY</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN672"></a>    <span class='Keyword'>float</span>      <span class='Operator'>*</span><span class='Declare_Local'>penalty</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>float </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN673"></a>    <a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>origval</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN670"><span class='Ref_To_Local'>origentry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN674"></a>    <a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>newval</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN671"><span class='Ref_To_Local'>newentry</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN122"><span class='Ref_to_Member'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN675"></a>    <a href="../intarray/_int.h.html#LN54"><span class='Ref_to_Typedef'>BITVECP</span></a>     <span class='Declare_Local'>orig</span> <span class='Operator'>= </span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN673"><span class='Ref_To_Local'>origval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Operator'>*</span><a href="trgm_gist.c.html#LN672"><span class='Ref_To_Local'>penalty</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN61"><span class='Ref_to_Macro'>ISARRKEY</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN674"><span class='Ref_To_Local'>newval</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN681"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>cache</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span>fcinfo<span class='Operator'>-&GT;</span>flinfo<span class='Operator'>-&GT;</span>fn_extra<span class='Delimiter'>; 
</span><a name="LN682"></a>        <a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>cachedVal</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a> <span class='Operator'>*</span><span class='Parentheses'>) (</span><a href="trgm_gist.c.html#LN681"><span class='Ref_To_Local'>cache</span></a> <span class='Operator'>+ </span><a href="../../src/include/c.h.html#LN587"><span class='Ref_to_Macro'>MAXALIGN</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../intarray/_int.h.html#LN53"><span class='Ref_to_Typedef'>BITVEC</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span><a name="LN683"></a>        <a href="../../src/include/c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a>        <span class='Declare_Local'>newvalsize</span> <span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN674"><span class='Ref_To_Local'>newval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN684"></a>        <a href="../intarray/_int.h.html#LN54"><span class='Ref_to_Typedef'>BITVECP</span></a>     <span class='Declare_Local'>sign</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Cache the sign data across multiple calls with the same newval. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN681"><span class='Ref_To_Local'>cache</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| 
</span>            <a href="../../src/include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN682"><span class='Ref_To_Local'>cachedVal</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="trgm_gist.c.html#LN683"><span class='Ref_To_Local'>newvalsize</span></a> <span class='Operator'>|| 
</span>            memcmp<span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN682"><span class='Ref_To_Local'>cachedVal</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN674"><span class='Ref_To_Local'>newval</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN683"><span class='Ref_To_Local'>newvalsize</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span><a name="LN693"></a>            <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>newcache</span><span class='Delimiter'>; 
</span> 
            <a href="trgm_gist.c.html#LN693"><span class='Ref_To_Local'>newcache</span></a> <span class='Operator'>= </span><a href="../../src/include/utils/palloc.h.html#LN70"><span class='Ref_to_Proto'>MemoryContextAlloc</span></a><span class='Parentheses'>(</span>fcinfo<span class='Operator'>-&GT;</span>flinfo<span class='Operator'>-&GT;</span>fn_mcxt<span class='Delimiter'>, 
</span>                                          <a href="../../src/include/c.h.html#LN587"><span class='Ref_to_Macro'>MAXALIGN</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../intarray/_int.h.html#LN53"><span class='Ref_to_Typedef'>BITVEC</span></a><span class='Parentheses'>))</span> <span class='Operator'>+ 
</span>                                          <a href="trgm_gist.c.html#LN683"><span class='Ref_To_Local'>newvalsize</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="trgm_gist.c.html#LN76"><span class='Ref_to_Func'>makesign</span></a><span class='Parentheses'>((</span><a href="../intarray/_int.h.html#LN54"><span class='Ref_to_Typedef'>BITVECP</span></a><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN693"><span class='Ref_To_Local'>newcache</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN674"><span class='Ref_To_Local'>newval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="trgm_gist.c.html#LN682"><span class='Ref_To_Local'>cachedVal</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a> <span class='Operator'>*</span><span class='Parentheses'>) (</span><a href="trgm_gist.c.html#LN693"><span class='Ref_To_Local'>newcache</span></a> <span class='Operator'>+ </span><a href="../../src/include/c.h.html#LN587"><span class='Ref_to_Macro'>MAXALIGN</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../intarray/_int.h.html#LN53"><span class='Ref_to_Typedef'>BITVEC</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            memcpy<span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN682"><span class='Ref_To_Local'>cachedVal</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN674"><span class='Ref_To_Local'>newval</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN683"><span class='Ref_To_Local'>newvalsize</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN681"><span class='Ref_To_Local'>cache</span></a><span class='Parentheses'>) 
</span>                <a href="../../src/include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN681"><span class='Ref_To_Local'>cache</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            fcinfo<span class='Operator'>-&GT;</span>flinfo<span class='Operator'>-&GT;</span>fn_extra <span class='Operator'>= </span><a href="trgm_gist.c.html#LN693"><span class='Ref_To_Local'>newcache</span></a><span class='Delimiter'>; 
</span>            <a href="trgm_gist.c.html#LN681"><span class='Ref_To_Local'>cache</span></a> <span class='Operator'>= </span><a href="trgm_gist.c.html#LN693"><span class='Ref_To_Local'>newcache</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if cache==NULL||VARSIZE(... &raquo; </span> 
 
        <a href="trgm_gist.c.html#LN684"><span class='Ref_To_Local'>sign</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../intarray/_int.h.html#LN54"><span class='Ref_to_Typedef'>BITVECP</span></a><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN681"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN48"><span class='Ref_to_Macro'>ISALLTRUE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN673"><span class='Ref_To_Local'>origval</span></a><span class='Parentheses'>))</span> 
            <span class='Operator'>*</span><a href="trgm_gist.c.html#LN672"><span class='Ref_To_Local'>penalty</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><span class='Keyword'>float</span><span class='Parentheses'>)</span> <span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN16"><span class='Ref_to_Const'>SIGLENBIT</span></a> <span class='Operator'>- </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN92"><span class='Ref_to_Proto'>sizebitvec</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN684"><span class='Ref_To_Local'>sign</span></a><span class='Parentheses'>)))</span> <span class='Operator'>/ </span><span class='Parentheses'>(</span><span class='Keyword'>float</span><span class='Parentheses'>) (</span><a href="../hstore/hstore_gist.c.html#LN16"><span class='Ref_to_Const'>SIGLENBIT</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <span class='Operator'>*</span><a href="trgm_gist.c.html#LN672"><span class='Ref_To_Local'>penalty</span></a> <span class='Operator'>= </span><a href="../intarray/_intbig_gist.c.html#LN217"><span class='Ref_to_Func'>hemdistsign</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN684"><span class='Ref_To_Local'>sign</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN675"><span class='Ref_To_Local'>orig</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if ISARRKEY(newval) &raquo; </span> 
    <span class='Control'>else</span> 
        <span class='Operator'>*</span><a href="trgm_gist.c.html#LN672"><span class='Ref_To_Local'>penalty</span></a> <span class='Operator'>= </span><a href="../../src/backend/utils/adt/tsquery_gist.c.html#LN129"><span class='Ref_to_Func'>hemdist</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN673"><span class='Ref_To_Local'>origval</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN674"><span class='Ref_To_Local'>newval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN672"><span class='Ref_To_Local'>penalty</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end gtrgm_penalty &raquo; </span> 
 
<span class='Control'>typedef</span> <span class='Control'>struct</span> 
<span class='Delimiter'>{ 
</span><a name="LN724"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Member'>allistrue</span><span class='Delimiter'>; 
</span><a name="LN725"></a>    <a href="../intarray/_int.h.html#LN53"><span class='Ref_to_Typedef'>BITVEC</span></a>      <span class='Declare_Member'>sign</span><span class='Delimiter'>; 
</span><a name="LN726"></a>} <span class='Declare_Typedef'>CACHESIGN</span><span class='Delimiter'>; 
</span> 
<span class='Keyword'>static void 
</span><a name="LN729"></a><span class='Declare_Function'>fillcache</span><span class='Parentheses'>(</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN568"><span class='Ref_to_Typedef'>CACHESIGN</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>item</span><span class='Delimiter'>, </span><a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>key</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="trgm_gist.c.html#LN729"><span class='Ref_to_Parameter'>item</span></a><span class='Operator'>-&GT;</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN570"><span class='Ref_to_Member'>allistrue</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN61"><span class='Ref_to_Macro'>ISARRKEY</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN729"><span class='Ref_to_Parameter'>key</span></a><span class='Parentheses'>))</span> 
        <a href="trgm_gist.c.html#LN76"><span class='Ref_to_Func'>makesign</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN729"><span class='Ref_to_Parameter'>item</span></a><span class='Operator'>-&GT;</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN571"><span class='Ref_to_Member'>sign</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN729"><span class='Ref_to_Parameter'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN48"><span class='Ref_to_Macro'>ISALLTRUE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN729"><span class='Ref_to_Parameter'>key</span></a><span class='Parentheses'>))</span> 
        <a href="trgm_gist.c.html#LN729"><span class='Ref_to_Parameter'>item</span></a><span class='Operator'>-&GT;</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN570"><span class='Ref_to_Member'>allistrue</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        memcpy<span class='Parentheses'>((</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN729"><span class='Ref_to_Parameter'>item</span></a><span class='Operator'>-&GT;</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN571"><span class='Ref_to_Member'>sign</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN729"><span class='Ref_to_Parameter'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../intarray/_int.h.html#LN53"><span class='Ref_to_Typedef'>BITVEC</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a name="LN740"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>WISH_F</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>b</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>c</span><span class='Parentheses'>) (</span><span class='Keyword'>double</span><span class='Parentheses'>)(</span> <span class='Operator'>-</span><span class='Parentheses'>(</span><span class='Keyword'>double</span><span class='Parentheses'>)(((</span><a href="trgm_gist.c.html#LN740"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Operator'>-</span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN740"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>))</span><span class='Operator'>*</span><span class='Parentheses'>((</span><a href="trgm_gist.c.html#LN740"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Operator'>-</span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN740"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>))</span><span class='Operator'>*</span><span class='Parentheses'>((</span><a href="trgm_gist.c.html#LN740"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Operator'>-</span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN740"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)))</span><span class='Operator'>*</span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN740"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span> <span class='Parentheses'>)</span> 
<span class='Control'>typedef</span> <span class='Control'>struct</span> 
<span class='Delimiter'>{ 
</span><a name="LN743"></a>    <a href="../../src/include/storage/off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Declare_Member'>pos</span><span class='Delimiter'>; 
</span><a name="LN744"></a>    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Member'>cost</span><span class='Delimiter'>; 
</span><a name="LN745"></a>} <span class='Declare_Typedef'>SPLITCOST</span><span class='Delimiter'>; 
</span> 
<span class='Keyword'>static int 
</span><a name="LN748"></a><span class='Declare_Function'>comparecost</span><span class='Parentheses'>(</span><span class='Keyword'>const void </span><span class='Operator'>*</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><span class='Keyword'>const void </span><span class='Operator'>*</span><span class='Declare_Parameter'>b</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(((</span><span class='Keyword'>const </span><a href="../hstore/hstore_gist.c.html#LN320"><span class='Ref_to_Typedef'>SPLITCOST</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN748"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>cost <span class='Operator'>== </span><span class='Parentheses'>((</span><span class='Keyword'>const </span><a href="../hstore/hstore_gist.c.html#LN320"><span class='Ref_to_Typedef'>SPLITCOST</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN748"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>cost<span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <span class='Parentheses'>(((</span><span class='Keyword'>const </span><a href="../hstore/hstore_gist.c.html#LN320"><span class='Ref_to_Typedef'>SPLITCOST</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN748"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>cost <span class='Operator'>&GT; </span><span class='Parentheses'>((</span><span class='Keyword'>const </span><a href="../hstore/hstore_gist.c.html#LN320"><span class='Ref_to_Typedef'>SPLITCOST</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN748"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>cost<span class='Parentheses'>)</span> <span class='Operator'>? </span><span class='Number'>1</span> <span class='Operator'>: -</span><span class='Number'>1</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Keyword'>static int 
</span><a name="LN758"></a><span class='Declare_Function'>hemdistcache</span><span class='Parentheses'>(</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN568"><span class='Ref_to_Typedef'>CACHESIGN</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN568"><span class='Ref_to_Typedef'>CACHESIGN</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>b</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN758"><span class='Ref_to_Parameter'>a</span></a><span class='Operator'>-&GT;</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN570"><span class='Ref_to_Member'>allistrue</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN758"><span class='Ref_to_Parameter'>b</span></a><span class='Operator'>-&GT;</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN570"><span class='Ref_to_Member'>allistrue</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <span class='Control'>return</span> <a href="../hstore/hstore_gist.c.html#LN16"><span class='Ref_to_Const'>SIGLENBIT</span></a> <span class='Operator'>- </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN92"><span class='Ref_to_Proto'>sizebitvec</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN758"><span class='Ref_to_Parameter'>b</span></a><span class='Operator'>-&GT;</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN571"><span class='Ref_to_Member'>sign</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN758"><span class='Ref_to_Parameter'>b</span></a><span class='Operator'>-&GT;</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN570"><span class='Ref_to_Member'>allistrue</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="../hstore/hstore_gist.c.html#LN16"><span class='Ref_to_Const'>SIGLENBIT</span></a> <span class='Operator'>- </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN92"><span class='Ref_to_Proto'>sizebitvec</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN758"><span class='Ref_to_Parameter'>a</span></a><span class='Operator'>-&GT;</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN571"><span class='Ref_to_Member'>sign</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="../intarray/_intbig_gist.c.html#LN217"><span class='Ref_to_Func'>hemdistsign</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN758"><span class='Ref_to_Parameter'>a</span></a><span class='Operator'>-&GT;</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN571"><span class='Ref_to_Member'>sign</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN758"><span class='Ref_to_Parameter'>b</span></a><span class='Operator'>-&GT;</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN571"><span class='Ref_to_Member'>sign</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../src/include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN774"></a><span class='Declare_Function'>gtrgm_picksplit</span><span class='Parentheses'>(</span><a href="../../src/include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN776"></a>    <a href="../../src/include/access/gist.h.html#LN157"><span class='Ref_to_Typedef'>GistEntryVector</span></a> <span class='Operator'>*</span><span class='Declare_Local'>entryvec</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN157"><span class='Ref_to_Typedef'>GistEntryVector</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN777"></a>    <a href="../../src/include/storage/off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Declare_Local'>maxoff</span> <span class='Operator'>= </span><a href="trgm_gist.c.html#LN776"><span class='Ref_To_Local'>entryvec</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN159"><span class='Ref_to_Member'>n</span></a> <span class='Operator'>- </span><span class='Number'>2</span><span class='Delimiter'>; 
</span><a name="LN778"></a>    <a href="../../src/include/access/gist.h.html#LN102"><span class='Ref_to_Struct'>GIST_SPLITVEC</span></a> <span class='Operator'>*</span><span class='Declare_Local'>v</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/access/gist.h.html#LN102"><span class='Ref_to_Struct'>GIST_SPLITVEC</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN779"></a>    <a href="../../src/include/storage/off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Declare_Local'>k</span><span class='Delimiter'>, 
</span><a name="LN780"></a>                <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span><a name="LN781"></a>    <a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>datum_l</span><span class='Delimiter'>, 
</span><a name="LN782"></a>               <span class='Operator'>*</span><span class='Declare_Local'>datum_r</span><span class='Delimiter'>; 
</span><a name="LN783"></a>    <a href="../intarray/_int.h.html#LN54"><span class='Ref_to_Typedef'>BITVECP</span></a>     <span class='Declare_Local'>union_l</span><span class='Delimiter'>, 
</span><a name="LN784"></a>                <span class='Declare_Local'>union_r</span><span class='Delimiter'>; 
</span><a name="LN785"></a>    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>size_alpha</span><span class='Delimiter'>, 
</span><a name="LN786"></a>                <span class='Declare_Local'>size_beta</span><span class='Delimiter'>; 
</span><a name="LN787"></a>    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>size_waste</span><span class='Delimiter'>, 
</span><a name="LN788"></a>                <span class='Declare_Local'>waste</span> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span><a name="LN789"></a>    <a href="../../src/include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>nbytes</span><span class='Delimiter'>; 
</span><a name="LN790"></a>    <a href="../../src/include/storage/off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Declare_Local'>seed_1</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>, 
</span><a name="LN791"></a>                <span class='Declare_Local'>seed_2</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN792"></a>    <a href="../../src/include/storage/off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Operator'>*</span><span class='Declare_Local'>left</span><span class='Delimiter'>, 
</span><a name="LN793"></a>               <span class='Operator'>*</span><span class='Declare_Local'>right</span><span class='Delimiter'>; 
</span><a name="LN794"></a>    <a href="../intarray/_int.h.html#LN54"><span class='Ref_to_Typedef'>BITVECP</span></a>     <span class='Declare_Local'>ptr</span><span class='Delimiter'>; 
</span><a name="LN795"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN796"></a>    <a href="../../src/backend/utils/adt/tsgistidx.c.html#LN568"><span class='Ref_to_Typedef'>CACHESIGN</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>cache</span><span class='Delimiter'>; 
</span><a name="LN797"></a>    <a href="../hstore/hstore_gist.c.html#LN320"><span class='Ref_to_Typedef'>SPLITCOST</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>costvector</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* cache the sign data for each existing item */ 
</span>    <a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN568"><span class='Ref_to_Typedef'>CACHESIGN</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN568"><span class='Ref_to_Typedef'>CACHESIGN</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN777"><span class='Ref_To_Local'>maxoff</span></a> <span class='Operator'>+ </span><span class='Number'>2</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN779"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN26"><span class='Ref_to_Const'>FirstOffsetNumber</span></a><span class='Delimiter'>; </span><a href="trgm_gist.c.html#LN779"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>&LT;= </span><a href="trgm_gist.c.html#LN777"><span class='Ref_To_Local'>maxoff</span></a><span class='Delimiter'>; </span><a href="trgm_gist.c.html#LN779"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN52"><span class='Ref_to_Macro'>OffsetNumberNext</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN779"><span class='Ref_To_Local'>k</span></a><span class='Parentheses'>))</span> 
        <a href="../../src/backend/utils/adt/tsgistidx.c.html#LN574"><span class='Ref_to_Func'>fillcache</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN779"><span class='Ref_To_Local'>k</span></a><span class='Delimiter'>], </span><a href="../intarray/_intbig_gist.c.html#LN10"><span class='Ref_to_Macro'>GETENTRY</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN776"><span class='Ref_To_Local'>entryvec</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN779"><span class='Ref_To_Local'>k</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* now find the two furthest-apart items */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN779"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN26"><span class='Ref_to_Const'>FirstOffsetNumber</span></a><span class='Delimiter'>; </span><a href="trgm_gist.c.html#LN779"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>&LT; </span><a href="trgm_gist.c.html#LN777"><span class='Ref_To_Local'>maxoff</span></a><span class='Delimiter'>; </span><a href="trgm_gist.c.html#LN779"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN52"><span class='Ref_to_Macro'>OffsetNumberNext</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN779"><span class='Ref_To_Local'>k</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN52"><span class='Ref_to_Macro'>OffsetNumberNext</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN779"><span class='Ref_To_Local'>k</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT;= </span><a href="trgm_gist.c.html#LN777"><span class='Ref_To_Local'>maxoff</span></a><span class='Delimiter'>; </span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN52"><span class='Ref_to_Macro'>OffsetNumberNext</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="trgm_gist.c.html#LN787"><span class='Ref_To_Local'>size_waste</span></a> <span class='Operator'>= </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN606"><span class='Ref_to_Func'>hemdistcache</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Operator'>&</span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN779"><span class='Ref_To_Local'>k</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN787"><span class='Ref_To_Local'>size_waste</span></a> <span class='Operator'>&GT; </span><a href="trgm_gist.c.html#LN788"><span class='Ref_To_Local'>waste</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="trgm_gist.c.html#LN788"><span class='Ref_To_Local'>waste</span></a> <span class='Operator'>= </span><a href="trgm_gist.c.html#LN787"><span class='Ref_To_Local'>size_waste</span></a><span class='Delimiter'>; 
</span>                <a href="trgm_gist.c.html#LN790"><span class='Ref_To_Local'>seed_1</span></a> <span class='Operator'>= </span><a href="trgm_gist.c.html#LN779"><span class='Ref_To_Local'>k</span></a><span class='Delimiter'>; 
</span>                <a href="trgm_gist.c.html#LN791"><span class='Ref_To_Local'>seed_2</span></a> <span class='Operator'>= </span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* just in case we didn't make a selection ... */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN790"><span class='Ref_To_Local'>seed_1</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="trgm_gist.c.html#LN791"><span class='Ref_To_Local'>seed_2</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="trgm_gist.c.html#LN790"><span class='Ref_To_Local'>seed_1</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <a href="trgm_gist.c.html#LN791"><span class='Ref_To_Local'>seed_2</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* initialize the result vectors */ 
</span>    <a href="trgm_gist.c.html#LN789"><span class='Ref_To_Local'>nbytes</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN777"><span class='Ref_To_Local'>maxoff</span></a> <span class='Operator'>+ </span><span class='Number'>2</span><span class='Parentheses'>) </span><span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../src/include/storage/off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="trgm_gist.c.html#LN778"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN104"><span class='Ref_to_Member'>spl_left</span></a> <span class='Operator'>= </span><a href="trgm_gist.c.html#LN792"><span class='Ref_To_Local'>left</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/storage/off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN789"><span class='Ref_To_Local'>nbytes</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="trgm_gist.c.html#LN778"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN109"><span class='Ref_to_Member'>spl_right</span></a> <span class='Operator'>= </span><a href="trgm_gist.c.html#LN793"><span class='Ref_To_Local'>right</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../src/include/storage/off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN789"><span class='Ref_To_Local'>nbytes</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="trgm_gist.c.html#LN778"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN105"><span class='Ref_to_Member'>spl_nleft</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="trgm_gist.c.html#LN778"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN110"><span class='Ref_to_Member'>spl_nright</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* form initial .. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN790"><span class='Ref_To_Local'>seed_1</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN570"><span class='Ref_to_Member'>allistrue</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="trgm_gist.c.html#LN781"><span class='Ref_To_Local'>datum_l</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN51"><span class='Ref_to_Macro'>CALCGTSIZE</span></a><span class='Parentheses'>(</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN58"><span class='Ref_to_Const'>SIGNKEY</span></a> <span class='Operator'>| </span><a href="../hstore/hstore_gist.c.html#LN46"><span class='Ref_to_Const'>ALLISTRUE</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN781"><span class='Ref_To_Local'>datum_l</span></a><span class='Delimiter'>, </span><a href="../hstore/hstore_gist.c.html#LN51"><span class='Ref_to_Macro'>CALCGTSIZE</span></a><span class='Parentheses'>(</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN58"><span class='Ref_to_Const'>SIGNKEY</span></a> <span class='Operator'>| </span><a href="../hstore/hstore_gist.c.html#LN46"><span class='Ref_to_Const'>ALLISTRUE</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="trgm_gist.c.html#LN781"><span class='Ref_To_Local'>datum_l</span></a><span class='Operator'>-&GT;</span><a href="trgm.h.html#LN65"><span class='Ref_to_Member'>flag</span></a> <span class='Operator'>= </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN58"><span class='Ref_to_Const'>SIGNKEY</span></a> <span class='Operator'>| </span><a href="../hstore/hstore_gist.c.html#LN46"><span class='Ref_to_Const'>ALLISTRUE</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="trgm_gist.c.html#LN781"><span class='Ref_To_Local'>datum_l</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN51"><span class='Ref_to_Macro'>CALCGTSIZE</span></a><span class='Parentheses'>(</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN58"><span class='Ref_to_Const'>SIGNKEY</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN781"><span class='Ref_To_Local'>datum_l</span></a><span class='Delimiter'>, </span><a href="../hstore/hstore_gist.c.html#LN51"><span class='Ref_to_Macro'>CALCGTSIZE</span></a><span class='Parentheses'>(</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN58"><span class='Ref_to_Const'>SIGNKEY</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="trgm_gist.c.html#LN781"><span class='Ref_To_Local'>datum_l</span></a><span class='Operator'>-&GT;</span><a href="trgm.h.html#LN65"><span class='Ref_to_Member'>flag</span></a> <span class='Operator'>= </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN58"><span class='Ref_to_Const'>SIGNKEY</span></a><span class='Delimiter'>; 
</span>        memcpy<span class='Parentheses'>((</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN781"><span class='Ref_To_Local'>datum_l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN790"><span class='Ref_To_Local'>seed_1</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN571"><span class='Ref_to_Member'>sign</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../intarray/_int.h.html#LN53"><span class='Ref_to_Typedef'>BITVEC</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN791"><span class='Ref_To_Local'>seed_2</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN570"><span class='Ref_to_Member'>allistrue</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="trgm_gist.c.html#LN782"><span class='Ref_To_Local'>datum_r</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN51"><span class='Ref_to_Macro'>CALCGTSIZE</span></a><span class='Parentheses'>(</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN58"><span class='Ref_to_Const'>SIGNKEY</span></a> <span class='Operator'>| </span><a href="../hstore/hstore_gist.c.html#LN46"><span class='Ref_to_Const'>ALLISTRUE</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN782"><span class='Ref_To_Local'>datum_r</span></a><span class='Delimiter'>, </span><a href="../hstore/hstore_gist.c.html#LN51"><span class='Ref_to_Macro'>CALCGTSIZE</span></a><span class='Parentheses'>(</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN58"><span class='Ref_to_Const'>SIGNKEY</span></a> <span class='Operator'>| </span><a href="../hstore/hstore_gist.c.html#LN46"><span class='Ref_to_Const'>ALLISTRUE</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="trgm_gist.c.html#LN782"><span class='Ref_To_Local'>datum_r</span></a><span class='Operator'>-&GT;</span><a href="trgm.h.html#LN65"><span class='Ref_to_Member'>flag</span></a> <span class='Operator'>= </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN58"><span class='Ref_to_Const'>SIGNKEY</span></a> <span class='Operator'>| </span><a href="../hstore/hstore_gist.c.html#LN46"><span class='Ref_to_Const'>ALLISTRUE</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="trgm_gist.c.html#LN782"><span class='Ref_To_Local'>datum_r</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="trgm.h.html#LN62"><span class='Ref_to_Typedef'>TRGM</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN51"><span class='Ref_to_Macro'>CALCGTSIZE</span></a><span class='Parentheses'>(</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN58"><span class='Ref_to_Const'>SIGNKEY</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../src/include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN782"><span class='Ref_To_Local'>datum_r</span></a><span class='Delimiter'>, </span><a href="../hstore/hstore_gist.c.html#LN51"><span class='Ref_to_Macro'>CALCGTSIZE</span></a><span class='Parentheses'>(</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN58"><span class='Ref_to_Const'>SIGNKEY</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="trgm_gist.c.html#LN782"><span class='Ref_To_Local'>datum_r</span></a><span class='Operator'>-&GT;</span><a href="trgm.h.html#LN65"><span class='Ref_to_Member'>flag</span></a> <span class='Operator'>= </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN58"><span class='Ref_to_Const'>SIGNKEY</span></a><span class='Delimiter'>; 
</span>        memcpy<span class='Parentheses'>((</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN782"><span class='Ref_To_Local'>datum_r</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN791"><span class='Ref_To_Local'>seed_2</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN571"><span class='Ref_to_Member'>sign</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../intarray/_int.h.html#LN53"><span class='Ref_to_Typedef'>BITVEC</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="trgm_gist.c.html#LN783"><span class='Ref_To_Local'>union_l</span></a> <span class='Operator'>= </span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN781"><span class='Ref_To_Local'>datum_l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="trgm_gist.c.html#LN784"><span class='Ref_To_Local'>union_r</span></a> <span class='Operator'>= </span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN782"><span class='Ref_To_Local'>datum_r</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="trgm_gist.c.html#LN777"><span class='Ref_To_Local'>maxoff</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN52"><span class='Ref_to_Macro'>OffsetNumberNext</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN777"><span class='Ref_To_Local'>maxoff</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../src/backend/utils/adt/tsgistidx.c.html#LN574"><span class='Ref_to_Func'>fillcache</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN777"><span class='Ref_To_Local'>maxoff</span></a><span class='Delimiter'>], </span><a href="../intarray/_intbig_gist.c.html#LN10"><span class='Ref_to_Macro'>GETENTRY</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN776"><span class='Ref_To_Local'>entryvec</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN777"><span class='Ref_To_Local'>maxoff</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* sort before ... */ 
</span>    <a href="trgm_gist.c.html#LN797"><span class='Ref_To_Local'>costvector</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN320"><span class='Ref_to_Typedef'>SPLITCOST</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../src/include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN320"><span class='Ref_to_Typedef'>SPLITCOST</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="trgm_gist.c.html#LN777"><span class='Ref_To_Local'>maxoff</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN26"><span class='Ref_to_Const'>FirstOffsetNumber</span></a><span class='Delimiter'>; </span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT;= </span><a href="trgm_gist.c.html#LN777"><span class='Ref_To_Local'>maxoff</span></a><span class='Delimiter'>; </span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN52"><span class='Ref_to_Macro'>OffsetNumberNext</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="trgm_gist.c.html#LN797"><span class='Ref_To_Local'>costvector</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/backend/utils/adt/tsquery_gist.c.html#LN152"><span class='Ref_to_Member'>pos</span></a> <span class='Operator'>= </span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>; 
</span>        <a href="trgm_gist.c.html#LN785"><span class='Ref_To_Local'>size_alpha</span></a> <span class='Operator'>= </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN606"><span class='Ref_to_Func'>hemdistcache</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN790"><span class='Ref_To_Local'>seed_1</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Operator'>&</span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="trgm_gist.c.html#LN786"><span class='Ref_To_Local'>size_beta</span></a> <span class='Operator'>= </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN606"><span class='Ref_to_Func'>hemdistcache</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN791"><span class='Ref_To_Local'>seed_2</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Operator'>&</span><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="trgm_gist.c.html#LN797"><span class='Ref_To_Local'>costvector</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/backend/utils/adt/tsquery_gist.c.html#LN153"><span class='Ref_to_Member'>cost</span></a> <span class='Operator'>= </span>abs<span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN785"><span class='Ref_To_Local'>size_alpha</span></a> <span class='Operator'>- </span><a href="trgm_gist.c.html#LN786"><span class='Ref_To_Local'>size_beta</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="../../src/include/port.h.html#LN439"><span class='Ref_to_Macro'>qsort</span></a><span class='Parentheses'>((</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="trgm_gist.c.html#LN797"><span class='Ref_To_Local'>costvector</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN777"><span class='Ref_To_Local'>maxoff</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN320"><span class='Ref_to_Typedef'>SPLITCOST</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../../src/backend/utils/adt/tsquery_gist.c.html#LN156"><span class='Ref_to_Func'>comparecost</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN779"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="trgm_gist.c.html#LN779"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>&LT; </span><a href="trgm_gist.c.html#LN777"><span class='Ref_To_Local'>maxoff</span></a><span class='Delimiter'>; </span><a href="trgm_gist.c.html#LN779"><span class='Ref_To_Local'>k</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><a href="trgm_gist.c.html#LN797"><span class='Ref_To_Local'>costvector</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN779"><span class='Ref_To_Local'>k</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/backend/utils/adt/tsquery_gist.c.html#LN152"><span class='Ref_to_Member'>pos</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>== </span><a href="trgm_gist.c.html#LN790"><span class='Ref_To_Local'>seed_1</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="trgm_gist.c.html#LN792"><span class='Ref_To_Local'>left</span></a><span class='Operator'>++ = </span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>; 
</span>            <a href="trgm_gist.c.html#LN778"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN105"><span class='Ref_to_Member'>spl_nleft</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>== </span><a href="trgm_gist.c.html#LN791"><span class='Ref_To_Local'>seed_2</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="trgm_gist.c.html#LN793"><span class='Ref_To_Local'>right</span></a><span class='Operator'>++ = </span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>; 
</span>            <a href="trgm_gist.c.html#LN778"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN110"><span class='Ref_to_Member'>spl_nright</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN48"><span class='Ref_to_Macro'>ISALLTRUE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN781"><span class='Ref_To_Local'>datum_l</span></a><span class='Parentheses'>) </span><span class='Operator'>|| </span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN570"><span class='Ref_to_Member'>allistrue</span></a><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN48"><span class='Ref_to_Macro'>ISALLTRUE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN781"><span class='Ref_To_Local'>datum_l</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN570"><span class='Ref_to_Member'>allistrue</span></a><span class='Parentheses'>)</span> 
                <a href="trgm_gist.c.html#LN785"><span class='Ref_To_Local'>size_alpha</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="trgm_gist.c.html#LN785"><span class='Ref_To_Local'>size_alpha</span></a> <span class='Operator'>= </span><a href="../hstore/hstore_gist.c.html#LN16"><span class='Ref_to_Const'>SIGLENBIT</span></a> <span class='Operator'>- </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN92"><span class='Ref_to_Proto'>sizebitvec</span></a><span class='Parentheses'>(</span> 
                                                    <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN570"><span class='Ref_to_Member'>allistrue</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN781"><span class='Ref_To_Local'>datum_l</span></a><span class='Parentheses'>) </span><span class='Operator'>: </span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN571"><span class='Ref_to_Member'>sign</span></a><span class='Parentheses'>) 
</span>                    <span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
            <a href="trgm_gist.c.html#LN785"><span class='Ref_To_Local'>size_alpha</span></a> <span class='Operator'>= </span><a href="../intarray/_intbig_gist.c.html#LN217"><span class='Ref_to_Func'>hemdistsign</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN571"><span class='Ref_to_Member'>sign</span></a><span class='Delimiter'>, </span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN781"><span class='Ref_To_Local'>datum_l</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN48"><span class='Ref_to_Macro'>ISALLTRUE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN782"><span class='Ref_To_Local'>datum_r</span></a><span class='Parentheses'>) </span><span class='Operator'>|| </span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN570"><span class='Ref_to_Member'>allistrue</span></a><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN48"><span class='Ref_to_Macro'>ISALLTRUE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN782"><span class='Ref_To_Local'>datum_r</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN570"><span class='Ref_to_Member'>allistrue</span></a><span class='Parentheses'>)</span> 
                <a href="trgm_gist.c.html#LN786"><span class='Ref_To_Local'>size_beta</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="trgm_gist.c.html#LN786"><span class='Ref_To_Local'>size_beta</span></a> <span class='Operator'>= </span><a href="../hstore/hstore_gist.c.html#LN16"><span class='Ref_to_Const'>SIGLENBIT</span></a> <span class='Operator'>- </span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN92"><span class='Ref_to_Proto'>sizebitvec</span></a><span class='Parentheses'>(</span> 
                                                   <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN570"><span class='Ref_to_Member'>allistrue</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN782"><span class='Ref_To_Local'>datum_r</span></a><span class='Parentheses'>) </span><span class='Operator'>: </span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN571"><span class='Ref_to_Member'>sign</span></a><span class='Parentheses'>) 
</span>                    <span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
            <a href="trgm_gist.c.html#LN786"><span class='Ref_To_Local'>size_beta</span></a> <span class='Operator'>= </span><a href="../intarray/_intbig_gist.c.html#LN217"><span class='Ref_to_Func'>hemdistsign</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN571"><span class='Ref_to_Member'>sign</span></a><span class='Delimiter'>, </span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN782"><span class='Ref_To_Local'>datum_r</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN785"><span class='Ref_To_Local'>size_alpha</span></a> <span class='Operator'>&LT; </span><a href="trgm_gist.c.html#LN786"><span class='Ref_To_Local'>size_beta</span></a> <span class='Operator'>+ </span><a href="../intarray/_int.h.html#LN45"><span class='Ref_to_Macro'>WISH_F</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN778"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN105"><span class='Ref_to_Member'>spl_nleft</span></a><span class='Delimiter'>, </span><a href="trgm_gist.c.html#LN778"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN110"><span class='Ref_to_Member'>spl_nright</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>1</span><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN48"><span class='Ref_to_Macro'>ISALLTRUE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN781"><span class='Ref_To_Local'>datum_l</span></a><span class='Parentheses'>) </span><span class='Operator'>|| </span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN570"><span class='Ref_to_Member'>allistrue</span></a><span class='Parentheses'>)</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../hstore/hstore_gist.c.html#LN48"><span class='Ref_to_Macro'>ISALLTRUE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN781"><span class='Ref_To_Local'>datum_l</span></a><span class='Parentheses'>))</span> 
                    <a href="../../src/include/c.h.html#LN856"><span class='Ref_to_Macro'>MemSet</span></a><span class='Parentheses'>((</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN781"><span class='Ref_To_Local'>datum_l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Number'>0xff</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../intarray/_int.h.html#LN53"><span class='Ref_to_Typedef'>BITVEC</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <a href="trgm_gist.c.html#LN794"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>= </span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN571"><span class='Ref_to_Member'>sign</span></a><span class='Delimiter'>; 
</span>                <a href="../hstore/hstore_gist.c.html#LN24"><span class='Ref_to_Const'>LOOPBYTE</span></a> 
                    <a href="trgm_gist.c.html#LN783"><span class='Ref_To_Local'>union_l</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN795"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>|= </span><a href="trgm_gist.c.html#LN794"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN795"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Operator'>*</span><a href="trgm_gist.c.html#LN792"><span class='Ref_To_Local'>left</span></a><span class='Operator'>++ = </span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>; 
</span>            <a href="trgm_gist.c.html#LN778"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN105"><span class='Ref_to_Member'>spl_nleft</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../hstore/hstore_gist.c.html#LN48"><span class='Ref_to_Macro'>ISALLTRUE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN782"><span class='Ref_To_Local'>datum_r</span></a><span class='Parentheses'>) </span><span class='Operator'>|| </span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN570"><span class='Ref_to_Member'>allistrue</span></a><span class='Parentheses'>)</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../hstore/hstore_gist.c.html#LN48"><span class='Ref_to_Macro'>ISALLTRUE</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN782"><span class='Ref_To_Local'>datum_r</span></a><span class='Parentheses'>))</span> 
                    <a href="../../src/include/c.h.html#LN856"><span class='Ref_to_Macro'>MemSet</span></a><span class='Parentheses'>((</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../hstore/hstore_gist.c.html#LN53"><span class='Ref_to_Macro'>GETSIGN</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN782"><span class='Ref_To_Local'>datum_r</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Number'>0xff</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../intarray/_int.h.html#LN53"><span class='Ref_to_Typedef'>BITVEC</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <a href="trgm_gist.c.html#LN794"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>= </span><a href="trgm_gist.c.html#LN796"><span class='Ref_To_Local'>cache</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../src/backend/utils/adt/tsgistidx.c.html#LN571"><span class='Ref_to_Member'>sign</span></a><span class='Delimiter'>; 
</span>                <a href="../hstore/hstore_gist.c.html#LN24"><span class='Ref_to_Const'>LOOPBYTE</span></a> 
                    <a href="trgm_gist.c.html#LN784"><span class='Ref_To_Local'>union_r</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN795"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>|= </span><a href="trgm_gist.c.html#LN794"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>[</span><a href="trgm_gist.c.html#LN795"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Operator'>*</span><a href="trgm_gist.c.html#LN793"><span class='Ref_To_Local'>right</span></a><span class='Operator'>++ = </span><a href="trgm_gist.c.html#LN780"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>; 
</span>            <a href="trgm_gist.c.html#LN778"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN110"><span class='Ref_to_Member'>spl_nright</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for k=0;k&LT;maxoff;k++ &raquo; </span> 
 
    <span class='Operator'>*</span><a href="trgm_gist.c.html#LN793"><span class='Ref_To_Local'>right</span></a> <span class='Operator'>= *</span><a href="trgm_gist.c.html#LN792"><span class='Ref_To_Local'>left</span></a> <span class='Operator'>= </span><a href="../../src/include/storage/off.h.html#LN26"><span class='Ref_to_Const'>FirstOffsetNumber</span></a><span class='Delimiter'>; 
</span>    <a href="trgm_gist.c.html#LN778"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN106"><span class='Ref_to_Member'>spl_ldatum</span></a> <span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN781"><span class='Ref_To_Local'>datum_l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="trgm_gist.c.html#LN778"><span class='Ref_To_Local'>v</span></a><span class='Operator'>-&GT;</span><a href="../../src/include/access/gist.h.html#LN111"><span class='Ref_to_Member'>spl_rdatum</span></a> <span class='Operator'>= </span><a href="../../src/include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN782"><span class='Ref_To_Local'>datum_r</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../src/include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="trgm_gist.c.html#LN778"><span class='Ref_To_Local'>v</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end gtrgm_picksplit &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>