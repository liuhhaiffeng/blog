<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>contrib\pgcrypto\imath.c</title>
<LINK REL=StyleSheet HREF="../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>contrib\pgcrypto\imath.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:26 2017
</td></tr>
<tr><td><a href='../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/* imath version 1.3 */ 
/* 
  Name:     imath.c 
  Purpose:  Arbitrary precision integer arithmetic routines. 
  Author:   M. J. Fromberger &LT;http://spinning-yarns.org/michael/sw/&GT; 
  Info:     Id: imath.c 21 2006-04-02 18:58:36Z sting 
 
  Copyright (C) 2002 Michael J. Fromberger, All Rights Reserved. 
 
  Permission is hereby granted, free of charge, to any person 
  obtaining a copy of this software and associated documentation files 
  (the "Software"), to deal in the Software without restriction, 
  including without limitation the rights to use, copy, modify, merge, 
  publish, distribute, sublicense, and/or sell copies of the Software, 
  and to permit persons to whom the Software is furnished to do so, 
  subject to the following conditions: 
 
  The above copyright notice and this permission notice shall be 
  included in all copies or substantial portions of the Software. 
 
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, 
  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF 
  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND 
  NONINFRINGEMENT.  IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS 
  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN 
  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN 
  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE 
  SOFTWARE. 
 */ 
/* contrib/pgcrypto/imath.c */ 
</span> 
<span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"px.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"imath.h"</span> 
 
<span class='Keyword'>#undef </span><span class='Debug'>assert</span> 
<a name="LN36"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>assert</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>TEST</span><span class='Parentheses'>) </span><span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="imath.c.html#LN36"><span class='Ref_to_Parameter'>TEST</span></a><span class='Parentheses'>) 
</span><a name="LN37"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>TRACEABLE_CLAMP</span> <span class='Number'>0</span> 
<a name="LN38"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>TRACEABLE_FREE</span> <span class='Number'>0</span> 
 
<span class='Comment_Multi_Line'>/* {{{ Constants */ 
</span> 
<a name="LN42"></a><span class='Keyword'>const </span><a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> <span class='Declare_Var'>MP_OK</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>;</span>      <span class='Comment_Single_Line'>/* no error, all is well  */ 
</span><a name="LN43"></a><span class='Keyword'>const </span><a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> <span class='Declare_Var'>MP_FALSE</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>;</span>   <span class='Comment_Single_Line'>/* boolean false          */ 
</span><a name="LN44"></a><span class='Keyword'>const </span><a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> <span class='Declare_Var'>MP_TRUE</span> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>;</span>   <span class='Comment_Single_Line'>/* boolean true           */ 
</span><a name="LN45"></a><span class='Keyword'>const </span><a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> <span class='Declare_Var'>MP_MEMORY</span> <span class='Operator'>= -</span><span class='Number'>2</span><span class='Delimiter'>; </span><span class='Comment_Single_Line'>/* out of memory          */ 
</span><a name="LN46"></a><span class='Keyword'>const </span><a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> <span class='Declare_Var'>MP_RANGE</span> <span class='Operator'>= -</span><span class='Number'>3</span><span class='Delimiter'>;</span>  <span class='Comment_Single_Line'>/* argument out of range  */ 
</span><a name="LN47"></a><span class='Keyword'>const </span><a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> <span class='Declare_Var'>MP_UNDEF</span> <span class='Operator'>= -</span><span class='Number'>4</span><span class='Delimiter'>;</span>  <span class='Comment_Single_Line'>/* result undefined       */ 
</span><a name="LN48"></a><span class='Keyword'>const </span><a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> <span class='Declare_Var'>MP_TRUNC</span> <span class='Operator'>= -</span><span class='Number'>5</span><span class='Delimiter'>;</span>  <span class='Comment_Single_Line'>/* output truncated       */ 
</span><a name="LN49"></a><span class='Keyword'>const </span><a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> <span class='Declare_Var'>MP_BADARG</span> <span class='Operator'>= -</span><span class='Number'>6</span><span class='Delimiter'>; </span><span class='Comment_Single_Line'>/* invalid null argument  */ 
</span> 
<a name="LN51"></a><span class='Keyword'>const </span><a href="imath.h.html#LN38"><span class='Ref_to_Typedef'>mp_sign</span></a> <span class='Declare_Var'>MP_NEG</span> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* value is strictly negative */ 
</span><a name="LN52"></a><span class='Keyword'>const </span><a href="imath.h.html#LN38"><span class='Ref_to_Typedef'>mp_sign</span></a> <span class='Declare_Var'>MP_ZPOS</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>;</span>      <span class='Comment_Single_Line'>/* value is non-negative      */ 
</span> 
<a name="LN54"></a><span class='Keyword'>static const char </span><span class='Operator'>*</span><span class='Declare_Var'>s_unknown_err</span> <span class='Operator'>= </span><span class='String'>"unknown result code"</span><span class='Delimiter'>; 
</span><a name="LN55"></a><span class='Keyword'>static const char </span><span class='Operator'>*</span><span class='Declare_Var'>s_error_msg</span><span class='Delimiter'>[] </span><span class='Operator'>= </span><span class='Delimiter'>{ 
</span>    <span class='String'>"error code 0"</span><span class='Delimiter'>, 
</span>    <span class='String'>"boolean true"</span><span class='Delimiter'>, 
</span>    <span class='String'>"out of memory"</span><span class='Delimiter'>, 
</span>    <span class='String'>"argument out of range"</span><span class='Delimiter'>, 
</span>    <span class='String'>"result undefined"</span><span class='Delimiter'>, 
</span>    <span class='String'>"output truncated"</span><span class='Delimiter'>, 
</span>    <span class='String'>"invalid null argument"</span><span class='Delimiter'>, 
</span>    <span class='Null_Value'>NULL 
</span><span class='Delimiter'>}; 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* Optional library flags */ 
</span><a name="LN69"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>MP_CAP_DIGITS</span>   <span class='Number'>1</span>       <span class='Comment_Single_Line'>/* flag bit to capitalize letter digits */ 
</span> 
<span class='Comment_Multi_Line'>/* Argument checking macros 
   Use CHECK() where a return value is required; NRCHECK() elsewhere */ 
</span><a name="LN73"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>CHECK</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>TEST</span><span class='Parentheses'>)</span>   <span class='Debug'>assert</span><span class='Parentheses'>(</span><a href="imath.c.html#LN73"><span class='Ref_to_Parameter'>TEST</span></a><span class='Parentheses'>) 
</span><a name="LN74"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>NRCHECK</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>TEST</span><span class='Parentheses'>) </span><span class='Debug'>assert</span><span class='Parentheses'>(</span><a href="imath.c.html#LN74"><span class='Ref_to_Parameter'>TEST</span></a><span class='Parentheses'>) 
</span> 
<span class='Comment_Multi_Line'>/* {{{ Logarithm table for computing output sizes */ 
</span> 
<span class='Comment_Multi_Line'>/* The ith entry of this table gives the value of log_i(2). 
 
   An integer value n requires ceil(log_i(n)) digits to be represented 
   in base i.  Since it is easy to compute lg(n), by counting bits, we 
   can compute log_i(n) = lg(n) * log_i(2). 
 */ 
</span><a name="LN84"></a><span class='Keyword'>static const double </span><span class='Declare_Var'>s_log2</span><span class='Delimiter'>[] </span><span class='Operator'>= </span><span class='Delimiter'>{ 
</span>    <span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>000000000</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>000000000</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Operator'>.</span><span class='Number'>000000000</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>630929754</span><span class='Delimiter'>, </span><span class='Comment_Single_Line'>/* 0  1  2  3 */ 
</span>    <span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>500000000</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>430676558</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>386852807</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>356207187</span><span class='Delimiter'>, </span><span class='Comment_Single_Line'>/* 4  5  6  7 */ 
</span>    <span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>333333333</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>315464877</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>301029996</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>289064826</span><span class='Delimiter'>, </span><span class='Comment_Single_Line'>/* 8  9 10 11 */ 
</span>    <span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>278942946</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>270238154</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>262649535</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>255958025</span><span class='Delimiter'>, </span><span class='Comment_Single_Line'>/* 12 13 14 15 */ 
</span>    <span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>250000000</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>244650542</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>239812467</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>235408913</span><span class='Delimiter'>, </span><span class='Comment_Single_Line'>/* 16 17 18 19 */ 
</span>    <span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>231378213</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>227670249</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>224243824</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>221064729</span><span class='Delimiter'>, </span><span class='Comment_Single_Line'>/* 20 21 22 23 */ 
</span>    <span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>218104292</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>215338279</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>212746054</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>210309918</span><span class='Delimiter'>, </span><span class='Comment_Single_Line'>/* 24 25 26 27 */ 
</span>    <span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>208014598</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>205846832</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>203795047</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>201849087</span><span class='Delimiter'>, </span><span class='Comment_Single_Line'>/* 28 29 30 31 */ 
</span>    <span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>200000000</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>198239863</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>196561632</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>194959022</span><span class='Delimiter'>, </span><span class='Comment_Single_Line'>/* 32 33 34 35 */ 
</span>    <span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>193426404</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>191958720</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>190551412</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>189200360</span><span class='Delimiter'>, </span><span class='Comment_Single_Line'>/* 36 37 38 39 */ 
</span>    <span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>187901825</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>186652411</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>185449023</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>184288833</span><span class='Delimiter'>, </span><span class='Comment_Single_Line'>/* 40 41 42 43 */ 
</span>    <span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>183169251</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>182087900</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>181042597</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>180031327</span><span class='Delimiter'>, </span><span class='Comment_Single_Line'>/* 44 45 46 47 */ 
</span>    <span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>179052232</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>178103594</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>177183820</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>176291434</span><span class='Delimiter'>, </span><span class='Comment_Single_Line'>/* 48 49 50 51 */ 
</span>    <span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>175425064</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>174583430</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>173765343</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>172969690</span><span class='Delimiter'>, </span><span class='Comment_Single_Line'>/* 52 53 54 55 */ 
</span>    <span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>172195434</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>171441601</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>170707280</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>169991616</span><span class='Delimiter'>, </span><span class='Comment_Single_Line'>/* 56 57 58 59 */ 
</span>    <span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>169293808</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>168613099</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>167948779</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>167300179</span><span class='Delimiter'>, </span><span class='Comment_Single_Line'>/* 60 61 62 63 */ 
</span>    <span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>166666667</span> 
<span class='Delimiter'>}; 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
/* {{{ Various macros */ 
</span> 
<span class='Comment_Multi_Line'>/* Return the number of digits needed to represent a static value */ 
</span><a name="LN108"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>MP_VALUE_DIGITS</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>V</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span><span class='Parentheses'>((</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="imath.c.html#LN108"><span class='Ref_to_Parameter'>V</span></a><span class='Parentheses'>)</span><span class='Operator'>+</span><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a><span class='Parentheses'>)</span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>))</span><span class='Operator'>/</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a><span class='Parentheses'>))</span> 
 
<span class='Comment_Multi_Line'>/* Round precision P to nearest word boundary */ 
</span><a name="LN112"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>ROUND_PREC</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>P</span><span class='Parentheses'>) ((</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a><span class='Parentheses'>)(</span><span class='Number'>2</span><span class='Operator'>*</span><span class='Parentheses'>(((</span><a href="imath.c.html#LN112"><span class='Ref_to_Parameter'>P</span></a><span class='Parentheses'>)</span><span class='Operator'>+</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Operator'>/</span><span class='Number'>2</span><span class='Parentheses'>)))</span> 
 
<span class='Comment_Multi_Line'>/* Set array P of S digits to zero */ 
</span><a name="LN115"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>ZERO</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>P</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>S</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span><span class='Control'>do</span><span class='Delimiter'>{</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> i__<span class='Operator'>=</span><span class='Parentheses'>(</span><a href="imath.c.html#LN115"><span class='Ref_to_Parameter'>S</span></a><span class='Parentheses'>)</span><span class='Operator'>*</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span>p__<span class='Operator'>=</span><span class='Parentheses'>(</span><a href="imath.c.html#LN115"><span class='Ref_to_Parameter'>P</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>memset<span class='Parentheses'>(</span>p__<span class='Delimiter'>,</span><span class='Number'>0</span><span class='Delimiter'>,</span>i__<span class='Parentheses'>)</span><span class='Delimiter'>;}</span><span class='Control'>while</span><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>) 
</span> 
<span class='Comment_Multi_Line'>/* Copy S digits from array P to array Q */ 
</span><a name="LN119"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>COPY</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>P</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>Q</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>S</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span><span class='Control'>do</span><span class='Delimiter'>{</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> i__<span class='Operator'>=</span><span class='Parentheses'>(</span><a href="imath.c.html#LN119"><span class='Ref_to_Parameter'>S</span></a><span class='Parentheses'>)</span><span class='Operator'>*</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span>p__<span class='Operator'>=</span><span class='Parentheses'>(</span><a href="imath.c.html#LN119"><span class='Ref_to_Parameter'>P</span></a><span class='Parentheses'>)</span><span class='Delimiter'>,</span><span class='Operator'>*</span>q__<span class='Operator'>=</span><span class='Parentheses'>(</span><a href="imath.c.html#LN119"><span class='Ref_to_Parameter'>Q</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span><span class='Operator'>\ 
</span>memcpy<span class='Parentheses'>(</span>q__<span class='Delimiter'>,</span>p__<span class='Delimiter'>,</span>i__<span class='Parentheses'>)</span><span class='Delimiter'>;}</span><span class='Control'>while</span><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>) 
</span> 
<span class='Comment_Multi_Line'>/* Reverse N elements of type T in array A */ 
</span><a name="LN124"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>REV</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>T</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>A</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>N</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span><span class='Control'>do</span><span class='Delimiter'>{</span><a href="imath.c.html#LN124"><span class='Ref_to_Parameter'>T</span></a> <span class='Operator'>*</span>u_<span class='Operator'>=</span><span class='Parentheses'>(</span><a href="imath.c.html#LN124"><span class='Ref_to_Parameter'>A</span></a><span class='Parentheses'>)</span><span class='Delimiter'>,</span><span class='Operator'>*</span>v_<span class='Operator'>=</span>u_<span class='Operator'>+</span><span class='Parentheses'>(</span><a href="imath.c.html#LN124"><span class='Ref_to_Parameter'>N</span></a><span class='Parentheses'>)</span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>;</span><span class='Control'>while</span><span class='Parentheses'>(</span>u_<span class='Operator'>&LT;</span>v_<span class='Parentheses'>)</span><span class='Delimiter'>{</span><a href="imath.c.html#LN124"><span class='Ref_to_Parameter'>T</span></a> xch<span class='Operator'>=*</span>u_<span class='Delimiter'>;</span><span class='Operator'>*</span>u_<span class='Operator'>++=*</span>v_<span class='Delimiter'>;</span><span class='Operator'>*</span>v_<span class='Operator'>--=</span>xch<span class='Delimiter'>;}}</span><span class='Control'>while</span><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>) 
</span> 
<span class='Directive'>#if</span> <a href="imath.c.html#LN37"><span class='Ref_to_Const'>TRACEABLE_CLAMP</span></a> 
<a name="LN128"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>CLAMP</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>Z</span><span class='Parentheses'>) </span><a href="imath.c.html#LN190"><span class='Ref_to_Proto'>s_clamp</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN128"><span class='Ref_to_Parameter'>Z</span></a><span class='Parentheses'>) 
</span><span class='Directive'>#else</span> 
<a name="LN130"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>CLAMP</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>Z</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span><span class='Control'>do</span><span class='Delimiter'>{</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> z_<span class='Operator'>=</span><span class='Parentheses'>(</span><a href="imath.c.html#LN130"><span class='Ref_to_Parameter'>Z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> uz_<span class='Operator'>=</span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span>z_<span class='Parentheses'>)</span><span class='Delimiter'>;</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span>dz_<span class='Operator'>=</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span>z_<span class='Parentheses'>)</span><span class='Operator'>+</span>uz_<span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>;</span><span class='Operator'>\ 
</span><span class='Control'>while</span><span class='Parentheses'>(</span>uz_ <span class='Operator'>&GT; </span><span class='Number'>1</span> <span class='Operator'>&& </span><span class='Parentheses'>(</span><span class='Operator'>*</span>dz_<span class='Operator'>-- == </span><span class='Number'>0</span><span class='Parentheses'>))</span> <span class='Operator'>--</span>uz_<span class='Delimiter'>;</span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span>z_<span class='Parentheses'>)</span><span class='Operator'>=</span>uz_<span class='Delimiter'>;}</span><span class='Control'>while</span><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>) 
</span><span class='Directive'>#endif</span> 
 
<span class='Keyword'>#undef </span><a href="imath.c.html#LN137"><span class='Ref_to_Macro'>MIN</span></a> 
<span class='Keyword'>#undef </span><a href="imath.c.html#LN138"><span class='Ref_to_Macro'>MAX</span></a> 
<a name="LN137"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>MIN</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>A</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>B</span><span class='Parentheses'>) ((</span><a href="imath.c.html#LN137"><span class='Ref_to_Parameter'>B</span></a><span class='Parentheses'>)</span><span class='Operator'>&LT;</span><span class='Parentheses'>(</span><a href="imath.c.html#LN137"><span class='Ref_to_Parameter'>A</span></a><span class='Parentheses'>)</span><span class='Operator'>?</span><span class='Parentheses'>(</span><a href="imath.c.html#LN137"><span class='Ref_to_Parameter'>B</span></a><span class='Parentheses'>)</span><span class='Operator'>:</span><span class='Parentheses'>(</span><a href="imath.c.html#LN137"><span class='Ref_to_Parameter'>A</span></a><span class='Parentheses'>))</span> 
<a name="LN138"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>MAX</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>A</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>B</span><span class='Parentheses'>) ((</span><a href="imath.c.html#LN138"><span class='Ref_to_Parameter'>B</span></a><span class='Parentheses'>)</span><span class='Operator'>&GT;</span><span class='Parentheses'>(</span><a href="imath.c.html#LN138"><span class='Ref_to_Parameter'>A</span></a><span class='Parentheses'>)</span><span class='Operator'>?</span><span class='Parentheses'>(</span><a href="imath.c.html#LN138"><span class='Ref_to_Parameter'>B</span></a><span class='Parentheses'>)</span><span class='Operator'>:</span><span class='Parentheses'>(</span><a href="imath.c.html#LN138"><span class='Ref_to_Parameter'>A</span></a><span class='Parentheses'>))</span> 
<a name="LN139"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>SWAP</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>T</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>A</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>B</span><span class='Parentheses'>) </span><span class='Control'>do</span><span class='Delimiter'>{</span><a href="imath.c.html#LN139"><span class='Ref_to_Parameter'>T</span></a> t_<span class='Operator'>=</span><span class='Parentheses'>(</span><a href="imath.c.html#LN139"><span class='Ref_to_Parameter'>A</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span><a href="imath.c.html#LN139"><span class='Ref_to_Parameter'>A</span></a><span class='Operator'>=</span><span class='Parentheses'>(</span><a href="imath.c.html#LN139"><span class='Ref_to_Parameter'>B</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span><a href="imath.c.html#LN139"><span class='Ref_to_Parameter'>B</span></a><span class='Operator'>=</span>t_<span class='Delimiter'>;}</span><span class='Control'>while</span><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>) 
</span> 
<a name="LN141"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>TEMP</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>K</span><span class='Parentheses'>) (</span>temp <span class='Operator'>+ </span><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Parameter'>K</span></a><span class='Parentheses'>))</span> 
<a name="LN142"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>SETUP</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>E</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>C</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span><span class='Control'>do</span><span class='Delimiter'>{</span><span class='Control'>if</span><span class='Parentheses'>((</span>res <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.c.html#LN142"><span class='Ref_to_Parameter'>E</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> <span class='Control'>goto</span> CLEANUP<span class='Delimiter'>; </span><span class='Operator'>++</span><span class='Parentheses'>(</span><a href="imath.c.html#LN142"><span class='Ref_to_Parameter'>C</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;}</span><span class='Control'>while</span><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>) 
</span> 
<a name="LN145"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>CMPZ</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>Z</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span><span class='Parentheses'>(((</span><a href="imath.c.html#LN145"><span class='Ref_to_Parameter'>Z</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>used<span class='Operator'>==</span><span class='Number'>1</span><span class='Operator'>&&</span><span class='Parentheses'>(</span><a href="imath.c.html#LN145"><span class='Ref_to_Parameter'>Z</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>digits<span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>==</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Operator'>?</span><span class='Number'>0</span><span class='Operator'>:</span><span class='Parentheses'>((</span><a href="imath.c.html#LN145"><span class='Ref_to_Parameter'>Z</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>sign<span class='Operator'>==</span><a href="imath.c.html#LN51"><span class='Ref_to_Global_Var'>MP_NEG</span></a><span class='Parentheses'>)</span><span class='Operator'>?-</span><span class='Number'>1</span><span class='Operator'>:</span><span class='Number'>1</span><span class='Parentheses'>)</span> 
 
<a name="LN148"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>UMUL</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>X</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>Y</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>Z</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span><span class='Control'>do</span><span class='Delimiter'>{</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> ua_<span class='Operator'>=</span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN148"><span class='Ref_to_Parameter'>X</span></a><span class='Parentheses'>)</span><span class='Delimiter'>,</span>ub_<span class='Operator'>=</span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN148"><span class='Ref_to_Parameter'>Y</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> o_<span class='Operator'>=</span>ua_<span class='Operator'>+</span>ub_<span class='Delimiter'>;</span><span class='Operator'>\ 
</span><a href="imath.c.html#LN115"><span class='Ref_to_Macro'>ZERO</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN148"><span class='Ref_to_Parameter'>Z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>,</span>o_<span class='Parentheses'>)</span><span class='Delimiter'>;</span><span class='Operator'>\ 
</span><span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="imath.c.html#LN218"><span class='Ref_to_Proto'>s_kmul</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN148"><span class='Ref_to_Parameter'>X</span></a><span class='Parentheses'>)</span><span class='Delimiter'>,</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN148"><span class='Ref_to_Parameter'>Y</span></a><span class='Parentheses'>)</span><span class='Delimiter'>,</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN148"><span class='Ref_to_Parameter'>Z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>,</span>ua_<span class='Delimiter'>,</span>ub_<span class='Parentheses'>)</span><span class='Delimiter'>;</span><span class='Operator'>\ 
</span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN148"><span class='Ref_to_Parameter'>Z</span></a><span class='Parentheses'>)</span><span class='Operator'>=</span>o_<span class='Delimiter'>;</span><a href="imath.c.html#LN128"><span class='Ref_to_Macro'>CLAMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN148"><span class='Ref_to_Parameter'>Z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;}</span><span class='Control'>while</span><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>) 
</span> 
<a name="LN154"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>USQR</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>X</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>Z</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span><span class='Control'>do</span><span class='Delimiter'>{</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> ua_<span class='Operator'>=</span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN154"><span class='Ref_to_Parameter'>X</span></a><span class='Parentheses'>)</span><span class='Delimiter'>,</span>o_<span class='Operator'>=</span>ua_<span class='Operator'>+</span>ua_<span class='Delimiter'>;</span><a href="imath.c.html#LN115"><span class='Ref_to_Macro'>ZERO</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN154"><span class='Ref_to_Parameter'>Z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>,</span>o_<span class='Parentheses'>)</span><span class='Delimiter'>;</span><span class='Operator'>\ 
</span><span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="imath.c.html#LN226"><span class='Ref_to_Proto'>s_ksqr</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN154"><span class='Ref_to_Parameter'>X</span></a><span class='Parentheses'>)</span><span class='Delimiter'>,</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN154"><span class='Ref_to_Parameter'>Z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>,</span>ua_<span class='Parentheses'>)</span><span class='Delimiter'>;</span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN154"><span class='Ref_to_Parameter'>Z</span></a><span class='Parentheses'>)</span><span class='Operator'>=</span>o_<span class='Delimiter'>;</span><a href="imath.c.html#LN128"><span class='Ref_to_Macro'>CLAMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN154"><span class='Ref_to_Parameter'>Z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;}</span><span class='Control'>while</span><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>) 
</span> 
<a name="LN158"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>UPPER_HALF</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>W</span><span class='Parentheses'>)</span>           <span class='Parentheses'>((</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>)((</span><a href="imath.c.html#LN158"><span class='Ref_to_Parameter'>W</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;&GT; </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a><span class='Parentheses'>))</span> 
<a name="LN159"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>LOWER_HALF</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>W</span><span class='Parentheses'>)</span>           <span class='Parentheses'>((</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a><span class='Parentheses'>)(</span><a href="imath.c.html#LN159"><span class='Ref_to_Parameter'>W</span></a><span class='Parentheses'>))</span> 
<a name="LN160"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>HIGH_BIT_SET</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>W</span><span class='Parentheses'>)</span>         <span class='Parentheses'>((</span><a href="imath.c.html#LN160"><span class='Ref_to_Parameter'>W</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;&GT; </span><span class='Parentheses'>(</span><a href="imath.h.html#LN80"><span class='Ref_to_Const'>MP_WORD_BIT</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>))</span> 
<a name="LN161"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>ADD_WILL_OVERFLOW</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>W</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>V</span><span class='Parentheses'>) ((</span><a href="imath.h.html#LN47"><span class='Ref_to_Const'>MP_WORD_MAX</span></a> <span class='Operator'>- </span><span class='Parentheses'>(</span><a href="imath.c.html#LN161"><span class='Ref_to_Parameter'>V</span></a><span class='Parentheses'>))</span> <span class='Operator'>&LT; </span><span class='Parentheses'>(</span><a href="imath.c.html#LN161"><span class='Ref_to_Parameter'>W</span></a><span class='Parentheses'>))</span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* Default number of digits allocated to a new mp_int */ 
</span><a name="LN166"></a><span class='Keyword'>static </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Var'>default_precision</span> <span class='Operator'>= </span><span class='Number'>64</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Minimum number of digits to invoke recursive multiply */ 
</span><a name="LN169"></a><span class='Keyword'>static </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Var'>multiply_threshold</span> <span class='Operator'>= </span><span class='Number'>32</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Default library configuration flags */ 
</span><a name="LN172"></a><span class='Keyword'>static </span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a> <span class='Declare_Var'>mp_flags</span> <span class='Operator'>= </span><a href="imath.c.html#LN69"><span class='Ref_to_Const'>MP_CAP_DIGITS</span></a><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Allocate a buffer of (at least) num digits, or return 
   NULL if that couldn't be done.  */ 
</span><a name="LN176"></a><span class='Keyword'>static </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>s_alloc</span><span class='Parentheses'>(</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>num</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Directive'>#if</span> <a href="imath.c.html#LN38"><span class='Ref_to_Const'>TRACEABLE_FREE</span></a> 
<a name="LN179"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>s_free</span><span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Declare_Parameter'>ptr</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#else</span> 
<a name="LN181"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>s_free</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>P</span><span class='Parentheses'>) </span><a href="px.h.html#LN45"><span class='Ref_to_Macro'>px_free</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN181"><span class='Ref_to_Parameter'>P</span></a><span class='Parentheses'>) 
</span><span class='Directive'>#endif</span> 
 
<span class='Comment_Multi_Line'>/* Insure that z has at least min digits allocated, resizing if 
   necessary.  Returns true if successful, false if out of memory. */ 
</span><a name="LN186"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>s_pad</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>min</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Normalize by removing leading zeroes (except when z = 0) */ 
</span><span class='Directive'>#if</span> <a href="imath.c.html#LN37"><span class='Ref_to_Const'>TRACEABLE_CLAMP</span></a> 
<a name="LN190"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>s_clamp</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
 
<span class='Comment_Multi_Line'>/* Fill in a "fake" mp_int on the stack with a given value */ 
</span><a name="LN194"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>s_fake</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>value</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Declare_Parameter'>vbuf</span><span class='Delimiter'>[]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Compare two runs of digits of given length, returns &LT;0, 0, &GT;0 */ 
</span><a name="LN197"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>s_cdig</span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>da</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>db</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>len</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Pack the unsigned digits of v into array t */ 
</span><a name="LN200"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>s_vpack</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>v</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Declare_Parameter'>t</span><span class='Delimiter'>[]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Compare magnitudes of a and b, returns &LT;0, 0, &GT;0 */ 
</span><a name="LN203"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>s_ucmp</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>b</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Compare magnitudes of a and v, returns &LT;0, 0, &GT;0 */ 
</span><a name="LN206"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>s_vcmp</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>v</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Unsigned magnitude addition; assumes dc is big enough. 
   Carry out is returned (no memory allocated). */ 
</span><a name="LN210"></a><span class='Keyword'>static </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Declare_Prototype'>s_uadd</span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>da</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>db</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dc</span><span class='Delimiter'>, 
</span><a name="LN211"></a>       <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>size_a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>size_b</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Unsigned magnitude subtraction.  Assumes dc is big enough. */ 
</span><a name="LN214"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>s_usub</span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>da</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>db</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dc</span><span class='Delimiter'>, 
</span><a name="LN215"></a>       <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>size_a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>size_b</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Unsigned recursive multiplication.  Assumes dc is big enough. */ 
</span><a name="LN218"></a><span class='Keyword'>static int </span><span class='Declare_Prototype'>s_kmul</span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>da</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>db</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dc</span><span class='Delimiter'>, 
</span><a name="LN219"></a>       <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>size_a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>size_b</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Unsigned magnitude multiplication.  Assumes dc is big enough. */ 
</span><a name="LN222"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>s_umul</span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>da</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>db</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dc</span><span class='Delimiter'>, 
</span><a name="LN223"></a>       <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>size_a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>size_b</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Unsigned recursive squaring.  Assumes dc is big enough. */ 
</span><a name="LN226"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>s_ksqr</span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>da</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dc</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>size_a</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Unsigned magnitude squaring.  Assumes dc is big enough. */ 
</span><a name="LN229"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>s_usqr</span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>da</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dc</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>size_a</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Single digit addition.  Assumes a is big enough. */ 
</span><a name="LN232"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>s_dadd</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Declare_Parameter'>b</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Single digit multiplication.  Assumes a is big enough. */ 
</span><a name="LN235"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>s_dmul</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Declare_Parameter'>b</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Single digit multiplication on buffers; assumes dc is big enough. */ 
</span><a name="LN238"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>s_dbmul</span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>da</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Declare_Parameter'>b</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dc</span><span class='Delimiter'>, 
</span><a name="LN239"></a>        <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>size_a</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Single digit division.  Replaces a with the quotient, 
   returns the remainder.  */ 
</span><a name="LN243"></a><span class='Keyword'>static </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Declare_Prototype'>s_ddiv</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Declare_Parameter'>b</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Quick division by a power of 2, replaces z (no allocation) */ 
</span><a name="LN246"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>s_qdiv</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>p2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Quick remainder by a power of 2, replaces z (no allocation) */ 
</span><a name="LN249"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>s_qmod</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>p2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Quick multiplication by a power of 2, replaces z. 
   Allocates if necessary; returns false in case this fails. */ 
</span><a name="LN253"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>s_qmul</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>p2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Quick subtraction from a power of 2, replaces z. 
   Allocates if necessary; returns false in case this fails. */ 
</span><a name="LN257"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>s_qsub</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>p2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Return maximum k such that 2^k divides z. */ 
</span><a name="LN260"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>s_dp2k</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Return k &GT;= 0 such that z = 2^k, or -1 if there is no such k. */ 
</span><a name="LN263"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>s_isp2</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Set z to 2^k.  May allocate; returns false in case this fails. */ 
</span><a name="LN266"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>s_2expt</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>k</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Normalize a and b for division, returns normalization constant */ 
</span><a name="LN269"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>s_norm</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>b</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Compute constant mu for Barrett reduction, given modulus m, result 
   replaces z, m is untouched. */ 
</span><a name="LN273"></a><span class='Keyword'>static </span><a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> <span class='Declare_Prototype'>s_brmu</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>m</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Reduce a modulo m, using Barrett's algorithm. */ 
</span><a name="LN276"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>s_reduce</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>x</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>m</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>mu</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>q1</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>q2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Modular exponentiation, using Barrett reduction */ 
</span><a name="LN279"></a><span class='Keyword'>static </span><a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> <span class='Declare_Prototype'>s_embar</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>b</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>m</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>mu</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Unsigned magnitude division.  Assumes |a| &GT; |b|.  Allocates 
   temporaries; overwrites a with quotient, b with remainder. */ 
</span><a name="LN283"></a><span class='Keyword'>static </span><a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> <span class='Declare_Prototype'>s_udiv</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>b</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Compute the number of digits in radix r required to represent the 
   given value.  Does not account for sign flags, terminators, etc. */ 
</span><a name="LN287"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>s_outlen</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>r</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Guess how many digits of precision will be needed to represent a 
   radix r value of the specified number of digits.  Returns a value 
   guaranteed to be no smaller than the actual number required. */ 
</span><a name="LN292"></a><span class='Keyword'>static </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Prototype'>s_inlen</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>r</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Convert a character to a digit value in radix r, or 
   -1 if out of range */ 
</span><a name="LN296"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>s_ch2val</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Declare_Parameter'>c</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>r</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Convert a digit value to a character */ 
</span><a name="LN299"></a><span class='Keyword'>static char </span><span class='Declare_Prototype'>s_val2ch</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>v</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>caps</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Take 2's complement of a buffer in place */ 
</span><a name="LN302"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>s_2comp</span><span class='Parentheses'>(</span><span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>buf</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Convert a value to binary, ignoring sign.  On input, *limpos is the 
   bound on how many bytes should be written to buf; on output, *limpos 
   is set to the number of bytes actually written. */ 
</span><a name="LN307"></a><span class='Keyword'>static </span><a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> <span class='Declare_Prototype'>s_tobin</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>buf</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>limpos</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>pad</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Directive'>#if</span> <span class='Number'>0</span> 
<span class='Inactive_Code'>/* Dump a representation of the mp_int to standard output */ 
void        s_print(char *tag, mp_int z); 
void        s_print_buf(char *tag, mp_digit *buf, mp_size num); 
</span><span class='Directive'>#endif</span> 
 
<span class='Comment_Multi_Line'>/* {{{ get_default_precision() */ 
</span> 
<a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> 
<a name="LN318"></a><span class='Declare_Function'>mp_get_default_precision</span><span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="imath.c.html#LN166"><span class='Ref_to_Global_Var'>default_precision</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_set_default_precision(s) */ 
</span> 
<span class='Keyword'>void 
</span><a name="LN328"></a><span class='Declare_Function'>mp_set_default_precision</span><span class='Parentheses'>(</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="imath.c.html#LN74"><span class='Ref_to_Macro'>NRCHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN328"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN166"><span class='Ref_to_Global_Var'>default_precision</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN112"><span class='Ref_to_Macro'>ROUND_PREC</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN328"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_get_multiply_threshold() */ 
</span> 
<a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> 
<a name="LN340"></a><span class='Declare_Function'>mp_get_multiply_threshold</span><span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="imath.c.html#LN169"><span class='Ref_to_Global_Var'>multiply_threshold</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_set_multiply_threshold(s) */ 
</span> 
<span class='Keyword'>void 
</span><a name="LN350"></a><span class='Declare_Function'>mp_set_multiply_threshold</span><span class='Parentheses'>(</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="imath.c.html#LN169"><span class='Ref_to_Global_Var'>multiply_threshold</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN350"><span class='Ref_to_Parameter'>s</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_init(z) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN360"></a><span class='Declare_Function'>mp_int_init</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="imath.h.html#LN98"><span class='Ref_to_Proto'>mp_int_init_size</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN360"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN166"><span class='Ref_to_Global_Var'>default_precision</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_alloc() */ 
</span> 
<a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> 
<a name="LN370"></a><span class='Declare_Function'>mp_int_alloc</span><span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN372"></a>    <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a>      <span class='Declare_Local'>out</span> <span class='Operator'>= </span><a href="px.h.html#LN43"><span class='Ref_to_Macro'>px_alloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mpz_t</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>assert</span><span class='Parentheses'>(</span><a href="imath.c.html#LN372"><span class='Ref_To_Local'>out</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN372"><span class='Ref_To_Local'>out</span></a><span class='Operator'>-&GT;</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN372"><span class='Ref_To_Local'>out</span></a><span class='Operator'>-&GT;</span><a href="imath.h.html#LN60"><span class='Ref_to_Member'>used</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN372"><span class='Ref_To_Local'>out</span></a><span class='Operator'>-&GT;</span><a href="imath.h.html#LN59"><span class='Ref_to_Member'>alloc</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN372"><span class='Ref_To_Local'>out</span></a><span class='Operator'>-&GT;</span><a href="imath.h.html#LN61"><span class='Ref_to_Member'>sign</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN372"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_init_size(z, prec) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN388"></a><span class='Declare_Function'>mp_int_init_size</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>prec</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN388"><span class='Ref_to_Parameter'>z</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN388"><span class='Ref_to_Parameter'>prec</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN112"><span class='Ref_to_Macro'>ROUND_PREC</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN388"><span class='Ref_to_Parameter'>prec</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN388"><span class='Ref_to_Parameter'>prec</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN138"><span class='Ref_to_Macro'>MAX</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN388"><span class='Ref_to_Parameter'>prec</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN166"><span class='Ref_to_Global_Var'>default_precision</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN388"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN176"><span class='Ref_to_Proto'>s_alloc</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN388"><span class='Ref_to_Parameter'>prec</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN45"><span class='Ref_to_Global_Var'>MP_MEMORY</span></a><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN388"><span class='Ref_to_Parameter'>z</span></a><span class='Operator'>-&GT;</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN388"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="imath.h.html#LN66"><span class='Ref_to_Macro'>MP_ALLOC</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN388"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN388"><span class='Ref_to_Parameter'>prec</span></a><span class='Delimiter'>; 
</span>    <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN388"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_init_copy(z, old) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN411"></a><span class='Declare_Function'>mp_int_init_copy</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>old</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN413"></a>    <a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a>   <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN414"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>uold</span><span class='Delimiter'>, 
</span><a name="LN415"></a>                <span class='Declare_Local'>target</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN411"><span class='Ref_to_Parameter'>z</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN411"><span class='Ref_to_Parameter'>old</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN414"><span class='Ref_To_Local'>uold</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN411"><span class='Ref_to_Parameter'>old</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN415"><span class='Ref_To_Local'>target</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN138"><span class='Ref_to_Macro'>MAX</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN414"><span class='Ref_To_Local'>uold</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN166"><span class='Ref_to_Global_Var'>default_precision</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN413"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN98"><span class='Ref_to_Proto'>mp_int_init_size</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN411"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN415"><span class='Ref_To_Local'>target</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN413"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
</span> 
    <a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN411"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN414"><span class='Ref_To_Local'>uold</span></a><span class='Delimiter'>; 
</span>    <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN411"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN411"><span class='Ref_to_Parameter'>old</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN119"><span class='Ref_to_Macro'>COPY</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN411"><span class='Ref_to_Parameter'>old</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN411"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN414"><span class='Ref_To_Local'>uold</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_init_copy &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_init_value(z, value) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN437"></a><span class='Declare_Function'>mp_int_init_value</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>value</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN439"></a>    <a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a>   <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN437"><span class='Ref_to_Parameter'>z</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN439"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN96"><span class='Ref_to_Proto'>mp_int_init</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN437"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN439"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.h.html#LN101"><span class='Ref_to_Proto'>mp_int_set_value</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN437"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span><span class='Keyword'>value</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_set_value(z, value) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN454"></a><span class='Declare_Function'>mp_int_set_value</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>value</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN456"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>ndig</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN454"><span class='Ref_to_Parameter'>z</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* How many digits to copy */ 
</span>    <a href="imath.c.html#LN456"><span class='Ref_To_Local'>ndig</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN108"><span class='Ref_to_Macro'>MP_VALUE_DIGITS</span></a><span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="imath.c.html#LN186"><span class='Ref_to_Proto'>s_pad</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN454"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN456"><span class='Ref_To_Local'>ndig</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN45"><span class='Ref_to_Global_Var'>MP_MEMORY</span></a><span class='Delimiter'>; 
</span> 
    <a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN454"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN200"><span class='Ref_to_Proto'>s_vpack</span></a><span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Delimiter'>, </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN454"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN454"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>value </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="imath.c.html#LN51"><span class='Ref_to_Global_Var'>MP_NEG</span></a> <span class='Operator'>: </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_clear(z) */ 
</span> 
<span class='Keyword'>void 
</span><a name="LN477"></a><span class='Declare_Function'>mp_int_clear</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN477"><span class='Ref_to_Parameter'>z</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN477"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN179"><span class='Ref_to_Proto'>s_free</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN477"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN477"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_free(z) */ 
</span> 
<span class='Keyword'>void 
</span><a name="LN494"></a><span class='Declare_Function'>mp_int_free</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="imath.c.html#LN74"><span class='Ref_to_Macro'>NRCHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN494"><span class='Ref_to_Parameter'>z</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN494"><span class='Ref_to_Parameter'>z</span></a><span class='Operator'>-&GT;</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <a href="imath.h.html#LN102"><span class='Ref_to_Proto'>mp_int_clear</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN494"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="px.h.html#LN45"><span class='Ref_to_Macro'>px_free</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN494"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_copy(a, c) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN509"></a><span class='Declare_Function'>mp_int_copy</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN509"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN509"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN509"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>!= </span><a href="imath.c.html#LN509"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN515"></a>        <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>ua</span> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN509"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN516"></a>        <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>da</span><span class='Delimiter'>, 
</span><a name="LN517"></a>                   <span class='Operator'>*</span><span class='Declare_Local'>dc</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="imath.c.html#LN186"><span class='Ref_to_Proto'>s_pad</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN509"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN515"><span class='Ref_To_Local'>ua</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="imath.c.html#LN45"><span class='Ref_to_Global_Var'>MP_MEMORY</span></a><span class='Delimiter'>; 
</span> 
        <a href="imath.c.html#LN516"><span class='Ref_To_Local'>da</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN509"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN517"><span class='Ref_To_Local'>dc</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN509"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN119"><span class='Ref_to_Macro'>COPY</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN516"><span class='Ref_To_Local'>da</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN517"><span class='Ref_To_Local'>dc</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN515"><span class='Ref_To_Local'>ua</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN509"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN515"><span class='Ref_To_Local'>ua</span></a><span class='Delimiter'>; 
</span>        <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN509"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN509"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_copy &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_swap(a, c) */ 
</span> 
<span class='Keyword'>void 
</span><a name="LN538"></a><span class='Declare_Function'>mp_int_swap</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN538"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>!= </span><a href="imath.c.html#LN538"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN542"></a>        <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mpz_t</span></a>       <span class='Declare_Local'>tmp</span> <span class='Operator'>= *</span><a href="imath.c.html#LN538"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>; 
</span> 
        <span class='Operator'>*</span><a href="imath.c.html#LN538"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>= *</span><a href="imath.c.html#LN538"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="imath.c.html#LN538"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN542"><span class='Ref_To_Local'>tmp</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_zero(z) */ 
</span> 
<span class='Keyword'>void 
</span><a name="LN554"></a><span class='Declare_Function'>mp_int_zero</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="imath.c.html#LN74"><span class='Ref_to_Macro'>NRCHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN554"><span class='Ref_to_Parameter'>z</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN554"><span class='Ref_to_Parameter'>z</span></a><span class='Operator'>-&GT;</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN554"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN554"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_abs(a, c) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN568"></a><span class='Declare_Function'>mp_int_abs</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN570"></a>    <a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a>   <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN568"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN568"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN570"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN568"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN568"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN570"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
</span> 
    <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN568"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_neg(a, c) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN586"></a><span class='Declare_Function'>mp_int_neg</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN588"></a>    <a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a>   <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN586"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN586"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN588"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN586"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN586"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN588"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN145"><span class='Ref_to_Macro'>CMPZ</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN586"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN586"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><span class='Number'>1</span> <span class='Operator'>- </span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN586"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_add(a, b, c) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN606"></a><span class='Declare_Function'>mp_int_add</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>b</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN608"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>ua</span><span class='Delimiter'>, 
</span><a name="LN609"></a>                <span class='Declare_Local'>ub</span><span class='Delimiter'>, 
</span><a name="LN610"></a>                <span class='Declare_Local'>uc</span><span class='Delimiter'>, 
</span><a name="LN611"></a>                <span class='Declare_Local'>max</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>b</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN608"><span class='Ref_To_Local'>ua</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN609"><span class='Ref_To_Local'>ub</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN610"><span class='Ref_To_Local'>uc</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN611"><span class='Ref_To_Local'>max</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN138"><span class='Ref_to_Macro'>MAX</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN608"><span class='Ref_To_Local'>ua</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN609"><span class='Ref_To_Local'>ub</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Same sign -- add magnitudes, preserve sign of addends */ 
</span><a name="LN623"></a>        <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>    <span class='Declare_Local'>carry</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="imath.c.html#LN186"><span class='Ref_to_Proto'>s_pad</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN611"><span class='Ref_To_Local'>max</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="imath.c.html#LN45"><span class='Ref_to_Global_Var'>MP_MEMORY</span></a><span class='Delimiter'>; 
</span> 
        <a href="imath.c.html#LN623"><span class='Ref_To_Local'>carry</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN210"><span class='Ref_to_Proto'>s_uadd</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN608"><span class='Ref_To_Local'>ua</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN609"><span class='Ref_To_Local'>ub</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN610"><span class='Ref_To_Local'>uc</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN611"><span class='Ref_To_Local'>max</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN623"><span class='Ref_To_Local'>carry</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="imath.c.html#LN186"><span class='Ref_to_Proto'>s_pad</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN611"><span class='Ref_To_Local'>max</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>))</span> 
                <span class='Control'>return</span> <a href="imath.c.html#LN45"><span class='Ref_to_Global_Var'>MP_MEMORY</span></a><span class='Delimiter'>; 
</span> 
            <a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>c</span></a><span class='Operator'>-&GT;</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN611"><span class='Ref_To_Local'>max</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="imath.c.html#LN623"><span class='Ref_To_Local'>carry</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>++</span><a href="imath.c.html#LN610"><span class='Ref_To_Local'>uc</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN610"><span class='Ref_To_Local'>uc</span></a><span class='Delimiter'>; 
</span>        <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if MP_SIGN(a)==MP_SIGN(b... &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Different signs -- subtract magnitudes, preserve sign of greater */ 
</span><a name="LN647"></a>        <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a>      <span class='Declare_Local'>x</span><span class='Delimiter'>, 
</span><a name="LN648"></a>                    <span class='Declare_Local'>y</span><span class='Delimiter'>; 
</span><a name="LN649"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>cmp</span> <span class='Operator'>= </span><a href="imath.c.html#LN203"><span class='Ref_to_Proto'>s_ucmp</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><span class='Comment_Single_Line'>/* magnitude comparison, sign ignored */ 
</span> 
        <span class='Comment_Multi_Line'>/* Set x to max(a, b), y to min(a, b) to simplify later code */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN649"><span class='Ref_To_Local'>cmp</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="imath.c.html#LN647"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN648"><span class='Ref_To_Local'>y</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="imath.c.html#LN647"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN648"><span class='Ref_To_Local'>y</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="imath.c.html#LN186"><span class='Ref_to_Proto'>s_pad</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>, </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN647"><span class='Ref_To_Local'>x</span></a><span class='Parentheses'>)))</span> 
            <span class='Control'>return</span> <a href="imath.c.html#LN45"><span class='Ref_to_Global_Var'>MP_MEMORY</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Subtract smaller from larger */ 
</span>        <a href="imath.c.html#LN214"><span class='Ref_to_Proto'>s_usub</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN647"><span class='Ref_To_Local'>x</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN648"><span class='Ref_To_Local'>y</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN647"><span class='Ref_To_Local'>x</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN648"><span class='Ref_To_Local'>y</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN647"><span class='Ref_To_Local'>x</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN128"><span class='Ref_to_Macro'>CLAMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Give result the sign of the larger */ 
</span>        <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN606"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN647"><span class='Ref_To_Local'>x</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <span class='Control'>return</span> <a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_add &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_add_value(a, value, c) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN683"></a><span class='Declare_Function'>mp_int_add_value</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>value</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN685"></a>    <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mpz_t</span></a>       <span class='Declare_Local'>vtmp</span><span class='Delimiter'>; 
</span><a name="LN686"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>    <span class='Declare_Local'>vbuf</span><span class='Delimiter'>[</span><a href="imath.c.html#LN108"><span class='Ref_to_Macro'>MP_VALUE_DIGITS</span></a><span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Parentheses'>)</span><span class='Delimiter'>]; 
</span> 
    <a href="imath.c.html#LN194"><span class='Ref_to_Proto'>s_fake</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN685"><span class='Ref_To_Local'>vtmp</span></a><span class='Delimiter'>, </span><span class='Keyword'>value</span><span class='Delimiter'>, </span><a href="imath.c.html#LN686"><span class='Ref_To_Local'>vbuf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.h.html#LN110"><span class='Ref_to_Proto'>mp_int_add</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN683"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="imath.c.html#LN685"><span class='Ref_To_Local'>vtmp</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN683"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_sub(a, b, c) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN698"></a><span class='Declare_Function'>mp_int_sub</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>b</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN700"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>ua</span><span class='Delimiter'>, 
</span><a name="LN701"></a>                <span class='Declare_Local'>ub</span><span class='Delimiter'>, 
</span><a name="LN702"></a>                <span class='Declare_Local'>uc</span><span class='Delimiter'>, 
</span><a name="LN703"></a>                <span class='Declare_Local'>max</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>b</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN700"><span class='Ref_To_Local'>ua</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN701"><span class='Ref_To_Local'>ub</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN702"><span class='Ref_To_Local'>uc</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN703"><span class='Ref_To_Local'>max</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN138"><span class='Ref_to_Macro'>MAX</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN700"><span class='Ref_To_Local'>ua</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN701"><span class='Ref_To_Local'>ub</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Different signs -- add magnitudes and keep sign of a */ 
</span><a name="LN715"></a>        <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>    <span class='Declare_Local'>carry</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="imath.c.html#LN186"><span class='Ref_to_Proto'>s_pad</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN703"><span class='Ref_To_Local'>max</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="imath.c.html#LN45"><span class='Ref_to_Global_Var'>MP_MEMORY</span></a><span class='Delimiter'>; 
</span> 
        <a href="imath.c.html#LN715"><span class='Ref_To_Local'>carry</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN210"><span class='Ref_to_Proto'>s_uadd</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN700"><span class='Ref_To_Local'>ua</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN701"><span class='Ref_To_Local'>ub</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN702"><span class='Ref_To_Local'>uc</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN703"><span class='Ref_To_Local'>max</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN715"><span class='Ref_To_Local'>carry</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="imath.c.html#LN186"><span class='Ref_to_Proto'>s_pad</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN703"><span class='Ref_To_Local'>max</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>))</span> 
                <span class='Control'>return</span> <a href="imath.c.html#LN45"><span class='Ref_to_Global_Var'>MP_MEMORY</span></a><span class='Delimiter'>; 
</span> 
            <a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>c</span></a><span class='Operator'>-&GT;</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN703"><span class='Ref_To_Local'>max</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="imath.c.html#LN715"><span class='Ref_To_Local'>carry</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>++</span><a href="imath.c.html#LN702"><span class='Ref_To_Local'>uc</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN702"><span class='Ref_To_Local'>uc</span></a><span class='Delimiter'>; 
</span>        <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if MP_SIGN(a)!=MP_SIGN(b... &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Same signs -- subtract magnitudes */ 
</span><a name="LN739"></a>        <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a>      <span class='Declare_Local'>x</span><span class='Delimiter'>, 
</span><a name="LN740"></a>                    <span class='Declare_Local'>y</span><span class='Delimiter'>; 
</span><a name="LN741"></a>        <a href="imath.h.html#LN38"><span class='Ref_to_Typedef'>mp_sign</span></a>     <span class='Declare_Local'>osign</span><span class='Delimiter'>; 
</span><a name="LN742"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>cmp</span> <span class='Operator'>= </span><a href="imath.c.html#LN203"><span class='Ref_to_Proto'>s_ucmp</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="imath.c.html#LN186"><span class='Ref_to_Proto'>s_pad</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN703"><span class='Ref_To_Local'>max</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="imath.c.html#LN45"><span class='Ref_to_Global_Var'>MP_MEMORY</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN742"><span class='Ref_To_Local'>cmp</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="imath.c.html#LN739"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN740"><span class='Ref_To_Local'>y</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN741"><span class='Ref_To_Local'>osign</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="imath.c.html#LN739"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN740"><span class='Ref_To_Local'>y</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN741"><span class='Ref_To_Local'>osign</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN51"><span class='Ref_to_Global_Var'>MP_NEG</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="imath.c.html#LN51"><span class='Ref_to_Global_Var'>MP_NEG</span></a> <span class='Operator'>&& </span><a href="imath.c.html#LN742"><span class='Ref_To_Local'>cmp</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="imath.c.html#LN741"><span class='Ref_To_Local'>osign</span></a> <span class='Operator'>= </span><span class='Number'>1</span> <span class='Operator'>- </span><a href="imath.c.html#LN741"><span class='Ref_To_Local'>osign</span></a><span class='Delimiter'>; 
</span> 
        <a href="imath.c.html#LN214"><span class='Ref_to_Proto'>s_usub</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN739"><span class='Ref_To_Local'>x</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN740"><span class='Ref_To_Local'>y</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN739"><span class='Ref_To_Local'>x</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN740"><span class='Ref_To_Local'>y</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN739"><span class='Ref_To_Local'>x</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN128"><span class='Ref_to_Macro'>CLAMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN698"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN741"><span class='Ref_To_Local'>osign</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <span class='Control'>return</span> <a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_sub &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_sub_value(a, value, c) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN778"></a><span class='Declare_Function'>mp_int_sub_value</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>value</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN780"></a>    <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mpz_t</span></a>       <span class='Declare_Local'>vtmp</span><span class='Delimiter'>; 
</span><a name="LN781"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>    <span class='Declare_Local'>vbuf</span><span class='Delimiter'>[</span><a href="imath.c.html#LN108"><span class='Ref_to_Macro'>MP_VALUE_DIGITS</span></a><span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Parentheses'>)</span><span class='Delimiter'>]; 
</span> 
    <a href="imath.c.html#LN194"><span class='Ref_to_Proto'>s_fake</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN780"><span class='Ref_To_Local'>vtmp</span></a><span class='Delimiter'>, </span><span class='Keyword'>value</span><span class='Delimiter'>, </span><a href="imath.c.html#LN781"><span class='Ref_To_Local'>vbuf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.h.html#LN112"><span class='Ref_to_Proto'>mp_int_sub</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN778"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="imath.c.html#LN780"><span class='Ref_To_Local'>vtmp</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN778"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_mul(a, b, c) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN793"></a><span class='Declare_Function'>mp_int_mul</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>b</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN795"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>out</span><span class='Delimiter'>; 
</span><a name="LN796"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>osize</span><span class='Delimiter'>, 
</span><a name="LN797"></a>                <span class='Declare_Local'>ua</span><span class='Delimiter'>, 
</span><a name="LN798"></a>                <span class='Declare_Local'>ub</span><span class='Delimiter'>, 
</span><a name="LN799"></a>                <span class='Declare_Local'>p</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN800"></a>    <a href="imath.h.html#LN38"><span class='Ref_to_Typedef'>mp_sign</span></a>     <span class='Declare_Local'>osign</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN793"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN793"><span class='Ref_to_Parameter'>b</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN793"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* If either input is zero, we can shortcut multiplication */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN133"><span class='Ref_to_Proto'>mp_int_compare_zero</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN793"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="imath.h.html#LN133"><span class='Ref_to_Proto'>mp_int_compare_zero</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN793"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="imath.h.html#LN107"><span class='Ref_to_Proto'>mp_int_zero</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN793"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Output is positive if inputs have same sign, otherwise negative */ 
</span>    <a href="imath.c.html#LN800"><span class='Ref_To_Local'>osign</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN793"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN793"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>))</span> <span class='Operator'>? </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a> <span class='Operator'>: </span><a href="imath.c.html#LN51"><span class='Ref_to_Global_Var'>MP_NEG</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If the output is not equal to any of the inputs, we'll write the 
     * results there directly; otherwise, allocate a temporary space. 
     */ 
</span>    <a href="imath.c.html#LN797"><span class='Ref_To_Local'>ua</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN793"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN798"><span class='Ref_To_Local'>ub</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN793"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN796"><span class='Ref_To_Local'>osize</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN138"><span class='Ref_to_Macro'>MAX</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN797"><span class='Ref_To_Local'>ua</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN798"><span class='Ref_To_Local'>ub</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN796"><span class='Ref_To_Local'>osize</span></a> <span class='Operator'>= </span><span class='Number'>4</span> <span class='Operator'>* </span><span class='Parentheses'>((</span><a href="imath.c.html#LN796"><span class='Ref_To_Local'>osize</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>/ </span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN793"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>== </span><a href="imath.c.html#LN793"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>|| </span><a href="imath.c.html#LN793"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>== </span><a href="imath.c.html#LN793"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN799"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN112"><span class='Ref_to_Macro'>ROUND_PREC</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN796"><span class='Ref_To_Local'>osize</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN799"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN138"><span class='Ref_to_Macro'>MAX</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN799"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN166"><span class='Ref_to_Global_Var'>default_precision</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN795"><span class='Ref_To_Local'>out</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN176"><span class='Ref_to_Proto'>s_alloc</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN799"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <a href="imath.c.html#LN45"><span class='Ref_to_Global_Var'>MP_MEMORY</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="imath.c.html#LN186"><span class='Ref_to_Proto'>s_pad</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN793"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN796"><span class='Ref_To_Local'>osize</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="imath.c.html#LN45"><span class='Ref_to_Global_Var'>MP_MEMORY</span></a><span class='Delimiter'>; 
</span> 
        <a href="imath.c.html#LN795"><span class='Ref_To_Local'>out</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN793"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="imath.c.html#LN115"><span class='Ref_to_Macro'>ZERO</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN795"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN796"><span class='Ref_To_Local'>osize</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="imath.c.html#LN218"><span class='Ref_to_Proto'>s_kmul</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN793"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN793"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN795"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN797"><span class='Ref_To_Local'>ua</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN798"><span class='Ref_To_Local'>ub</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN45"><span class='Ref_to_Global_Var'>MP_MEMORY</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If we allocated a new buffer, get rid of whatever memory c was already 
     * using, and fix up its fields to reflect that. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN795"><span class='Ref_To_Local'>out</span></a> <span class='Operator'>!= </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN793"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN179"><span class='Ref_to_Proto'>s_free</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN793"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN793"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN795"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>; 
</span>        <a href="imath.h.html#LN66"><span class='Ref_to_Macro'>MP_ALLOC</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN793"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN799"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN793"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN796"><span class='Ref_To_Local'>osize</span></a><span class='Delimiter'>;</span>         <span class='Comment_Single_Line'>/* might not be true, but we'll fix it ... */ 
</span>    <a href="imath.c.html#LN128"><span class='Ref_to_Macro'>CLAMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN793"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>                   <span class='Comment_Single_Line'>/* ... right here */ 
</span>    <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN793"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN800"><span class='Ref_To_Local'>osign</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_mul &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_mul_value(a, value, c) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN866"></a><span class='Declare_Function'>mp_int_mul_value</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>value</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN868"></a>    <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mpz_t</span></a>       <span class='Declare_Local'>vtmp</span><span class='Delimiter'>; 
</span><a name="LN869"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>    <span class='Declare_Local'>vbuf</span><span class='Delimiter'>[</span><a href="imath.c.html#LN108"><span class='Ref_to_Macro'>MP_VALUE_DIGITS</span></a><span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Parentheses'>)</span><span class='Delimiter'>]; 
</span> 
    <a href="imath.c.html#LN194"><span class='Ref_to_Proto'>s_fake</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN868"><span class='Ref_To_Local'>vtmp</span></a><span class='Delimiter'>, </span><span class='Keyword'>value</span><span class='Delimiter'>, </span><a href="imath.c.html#LN869"><span class='Ref_To_Local'>vbuf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.h.html#LN114"><span class='Ref_to_Proto'>mp_int_mul</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN866"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="imath.c.html#LN868"><span class='Ref_To_Local'>vtmp</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN866"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_mul_pow2(a, p2, c) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN881"></a><span class='Declare_Function'>mp_int_mul_pow2</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>p2</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN883"></a>    <a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a>   <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN881"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN881"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN881"><span class='Ref_to_Parameter'>p2</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN883"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN881"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN881"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN883"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN253"><span class='Ref_to_Proto'>s_qmul</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN881"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN881"><span class='Ref_to_Parameter'>p2</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN45"><span class='Ref_to_Global_Var'>MP_MEMORY</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_sqr(a, c) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN901"></a><span class='Declare_Function'>mp_int_sqr</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN903"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>out</span><span class='Delimiter'>; 
</span><a name="LN904"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>osize</span><span class='Delimiter'>, 
</span><a name="LN905"></a>                <span class='Declare_Local'>p</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN901"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN901"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Get a temporary buffer big enough to hold the result */ 
</span>    <a href="imath.c.html#LN904"><span class='Ref_To_Local'>osize</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a><span class='Parentheses'>) </span><span class='Number'>4</span> <span class='Operator'>*</span><span class='Parentheses'>((</span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN901"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>)</span> <span class='Operator'>/ </span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN901"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>== </span><a href="imath.c.html#LN901"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN905"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN112"><span class='Ref_to_Macro'>ROUND_PREC</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN904"><span class='Ref_To_Local'>osize</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN905"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN138"><span class='Ref_to_Macro'>MAX</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN905"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN166"><span class='Ref_to_Global_Var'>default_precision</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN903"><span class='Ref_To_Local'>out</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN176"><span class='Ref_to_Proto'>s_alloc</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN905"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <a href="imath.c.html#LN45"><span class='Ref_to_Global_Var'>MP_MEMORY</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="imath.c.html#LN186"><span class='Ref_to_Proto'>s_pad</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN901"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN904"><span class='Ref_To_Local'>osize</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="imath.c.html#LN45"><span class='Ref_to_Global_Var'>MP_MEMORY</span></a><span class='Delimiter'>; 
</span> 
        <a href="imath.c.html#LN903"><span class='Ref_To_Local'>out</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN901"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="imath.c.html#LN115"><span class='Ref_to_Macro'>ZERO</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN903"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN904"><span class='Ref_To_Local'>osize</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN226"><span class='Ref_to_Proto'>s_ksqr</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN901"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN903"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN901"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Get rid of whatever memory c was already using, and fix up its fields 
     * to reflect the new digit array it's using 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN903"><span class='Ref_To_Local'>out</span></a> <span class='Operator'>!= </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN901"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN179"><span class='Ref_to_Proto'>s_free</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN901"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN901"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN903"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>; 
</span>        <a href="imath.h.html#LN66"><span class='Ref_to_Macro'>MP_ALLOC</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN901"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN905"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN901"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN904"><span class='Ref_To_Local'>osize</span></a><span class='Delimiter'>;</span>         <span class='Comment_Single_Line'>/* might not be true, but we'll fix it ... */ 
</span>    <a href="imath.c.html#LN128"><span class='Ref_to_Macro'>CLAMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN901"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>                   <span class='Comment_Single_Line'>/* ... right here */ 
</span>    <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN901"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_sqr &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_div(a, b, q, r) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN954"></a><span class='Declare_Function'>mp_int_div</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>b</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>q</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>r</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN956"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>cmp</span><span class='Delimiter'>, 
</span><a name="LN957"></a>                <span class='Declare_Local'>last</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>, 
</span><a name="LN958"></a>                <span class='Declare_Local'>lg</span><span class='Delimiter'>; 
</span><a name="LN959"></a>    <a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a>   <span class='Declare_Local'>res</span> <span class='Operator'>= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Delimiter'>; 
</span><a name="LN960"></a>    <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mpz_t</span></a>       <span class='Declare_Local'>temp</span><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]; 
</span><a name="LN961"></a>    <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a>      <span class='Declare_Local'>qout</span><span class='Delimiter'>, 
</span><a name="LN962"></a>                <span class='Declare_Local'>rout</span><span class='Delimiter'>; 
</span><a name="LN963"></a>    <a href="imath.h.html#LN38"><span class='Ref_to_Typedef'>mp_sign</span></a>     <span class='Declare_Local'>sa</span> <span class='Operator'>= </span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span><a name="LN964"></a>                <span class='Declare_Local'>sb</span> <span class='Operator'>= </span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>b</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>q</span></a> <span class='Operator'>!= </span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>r</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN145"><span class='Ref_to_Macro'>CMPZ</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN47"><span class='Ref_to_Global_Var'>MP_UNDEF</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN956"><span class='Ref_To_Local'>cmp</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN203"><span class='Ref_to_Proto'>s_ucmp</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>))</span> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * If |a| &LT; |b|, no division is required: q = 0, r = a 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>r</span></a> <span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="imath.c.html#LN959"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>r</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <a href="imath.c.html#LN959"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>q</span></a><span class='Parentheses'>) 
</span>            <a href="imath.h.html#LN107"><span class='Ref_to_Proto'>mp_int_zero</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>q</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN956"><span class='Ref_To_Local'>cmp</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * If |a| = |b|, no division is required: q = 1 or -1, r = 0 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>r</span></a><span class='Parentheses'>) 
</span>            <a href="imath.h.html#LN107"><span class='Ref_to_Proto'>mp_int_zero</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>r</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>q</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="imath.h.html#LN107"><span class='Ref_to_Proto'>mp_int_zero</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>q</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>q</span></a><span class='Operator'>-&GT;</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN963"><span class='Ref_To_Local'>sa</span></a> <span class='Operator'>!= </span><a href="imath.c.html#LN964"><span class='Ref_To_Local'>sb</span></a><span class='Parentheses'>) 
</span>                <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>q</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN51"><span class='Ref_to_Global_Var'>MP_NEG</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * When |a| &GT; |b|, real division is required.  We need someplace to store 
     * quotient and remainder, but q and r are allowed to be NULL or to 
     * overlap with the inputs. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN958"><span class='Ref_To_Local'>lg</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN263"><span class='Ref_to_Proto'>s_isp2</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>))</span> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>q</span></a> <span class='Operator'>&& </span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>b</span></a> <span class='Operator'>!= </span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>q</span></a> <span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="imath.c.html#LN959"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>q</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="imath.c.html#LN961"><span class='Ref_To_Local'>qout</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>q</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="imath.c.html#LN961"><span class='Ref_To_Local'>qout</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN957"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN142"><span class='Ref_to_Macro'>SETUP</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN99"><span class='Ref_to_Proto'>mp_int_init_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN957"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN957"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>r</span></a> <span class='Operator'>&& </span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>!= </span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>r</span></a> <span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="imath.c.html#LN959"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>r</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="imath.c.html#LN962"><span class='Ref_To_Local'>rout</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>r</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="imath.c.html#LN962"><span class='Ref_To_Local'>rout</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN957"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN142"><span class='Ref_to_Macro'>SETUP</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN99"><span class='Ref_to_Proto'>mp_int_init_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN957"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN957"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN959"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN283"><span class='Ref_to_Proto'>s_udiv</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN961"><span class='Ref_To_Local'>qout</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN962"><span class='Ref_To_Local'>rout</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1067"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if (lg=s_isp2(b))&LT;0 &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>q</span></a> <span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="imath.c.html#LN959"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>q</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1067"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>r</span></a> <span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="imath.c.html#LN959"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>r</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1067"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>q</span></a><span class='Parentheses'>) 
</span>            <a href="imath.c.html#LN246"><span class='Ref_to_Proto'>s_qdiv</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>q</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN958"><span class='Ref_To_Local'>lg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN961"><span class='Ref_To_Local'>qout</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>q</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>r</span></a><span class='Parentheses'>) 
</span>            <a href="imath.c.html#LN249"><span class='Ref_to_Proto'>s_qmod</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>r</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN958"><span class='Ref_To_Local'>lg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN962"><span class='Ref_To_Local'>rout</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>r</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Recompute signs for output */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN962"><span class='Ref_To_Local'>rout</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN962"><span class='Ref_To_Local'>rout</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN963"><span class='Ref_To_Local'>sa</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN145"><span class='Ref_to_Macro'>CMPZ</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN962"><span class='Ref_To_Local'>rout</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN962"><span class='Ref_To_Local'>rout</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN961"><span class='Ref_To_Local'>qout</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN961"><span class='Ref_To_Local'>qout</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.c.html#LN963"><span class='Ref_To_Local'>sa</span></a> <span class='Operator'>== </span><a href="imath.c.html#LN964"><span class='Ref_To_Local'>sb</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a> <span class='Operator'>: </span><a href="imath.c.html#LN51"><span class='Ref_to_Global_Var'>MP_NEG</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN145"><span class='Ref_to_Macro'>CMPZ</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN961"><span class='Ref_To_Local'>qout</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN961"><span class='Ref_To_Local'>qout</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>q</span></a> <span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="imath.c.html#LN959"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN961"><span class='Ref_To_Local'>qout</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>q</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1067"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>r</span></a> <span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="imath.c.html#LN959"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN962"><span class='Ref_To_Local'>rout</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN954"><span class='Ref_to_Parameter'>r</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1067"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span> 
<a name="LN1067"></a><span class='Label'>CLEANUP</span><span class='Operator'>: 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>--</span><a href="imath.c.html#LN957"><span class='Ref_To_Local'>last</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="imath.h.html#LN102"><span class='Ref_to_Proto'>mp_int_clear</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN957"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN959"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_div &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_mod(a, m, c) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN1079"></a><span class='Declare_Function'>mp_int_mod</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>m</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1081"></a>    <a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a>   <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN1082"></a>    <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mpz_t</span></a>       <span class='Declare_Local'>tmp</span><span class='Delimiter'>; 
</span><a name="LN1083"></a>    <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a>      <span class='Declare_Local'>out</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1079"><span class='Ref_to_Parameter'>m</span></a> <span class='Operator'>== </span><a href="imath.c.html#LN1079"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1081"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN96"><span class='Ref_to_Proto'>mp_int_init</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1082"><span class='Ref_To_Local'>tmp</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <a href="imath.c.html#LN1081"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
</span> 
        <a href="imath.c.html#LN1083"><span class='Ref_To_Local'>out</span></a> <span class='Operator'>= &</span><a href="imath.c.html#LN1082"><span class='Ref_To_Local'>tmp</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN1083"><span class='Ref_To_Local'>out</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN1079"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1081"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN119"><span class='Ref_to_Proto'>mp_int_div</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1079"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1079"><span class='Ref_to_Parameter'>m</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1083"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1105"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN145"><span class='Ref_to_Macro'>CMPZ</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1083"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="imath.c.html#LN1081"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN110"><span class='Ref_to_Proto'>mp_int_add</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1083"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1079"><span class='Ref_to_Parameter'>m</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1079"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="imath.c.html#LN1081"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1083"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1079"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<a name="LN1105"></a><span class='Label'>CLEANUP</span><span class='Operator'>: 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1083"><span class='Ref_To_Local'>out</span></a> <span class='Operator'>!= </span><a href="imath.c.html#LN1079"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) 
</span>        <a href="imath.h.html#LN102"><span class='Ref_to_Proto'>mp_int_clear</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1082"><span class='Ref_To_Local'>tmp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN1081"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_mod &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
 
<span class='Comment_Multi_Line'>/* {{{ mp_int_div_value(a, value, q, r) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN1118"></a><span class='Declare_Function'>mp_int_div_value</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>value</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>q</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>r</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1120"></a>    <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mpz_t</span></a>       <span class='Declare_Local'>vtmp</span><span class='Delimiter'>, 
</span><a name="LN1121"></a>                <span class='Declare_Local'>rtmp</span><span class='Delimiter'>; 
</span><a name="LN1122"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>    <span class='Declare_Local'>vbuf</span><span class='Delimiter'>[</span><a href="imath.c.html#LN108"><span class='Ref_to_Macro'>MP_VALUE_DIGITS</span></a><span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Parentheses'>)</span><span class='Delimiter'>]; 
</span><a name="LN1123"></a>    <a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a>   <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1123"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN96"><span class='Ref_to_Proto'>mp_int_init</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1121"><span class='Ref_To_Local'>rtmp</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN1123"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN194"><span class='Ref_to_Proto'>s_fake</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1120"><span class='Ref_To_Local'>vtmp</span></a><span class='Delimiter'>, </span><span class='Keyword'>value</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1122"><span class='Ref_To_Local'>vbuf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1123"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN119"><span class='Ref_to_Proto'>mp_int_div</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1118"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="imath.c.html#LN1120"><span class='Ref_To_Local'>vtmp</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1118"><span class='Ref_to_Parameter'>q</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="imath.c.html#LN1121"><span class='Ref_To_Local'>rtmp</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1135"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1118"><span class='Ref_to_Parameter'>r</span></a><span class='Parentheses'>) 
</span>        <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="imath.h.html#LN163"><span class='Ref_to_Proto'>mp_int_to_int</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1121"><span class='Ref_To_Local'>rtmp</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1118"><span class='Ref_to_Parameter'>r</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><span class='Comment_Single_Line'>/* can't fail */ 
</span> 
<a name="LN1135"></a><span class='Label'>CLEANUP</span><span class='Operator'>: 
</span>    <a href="imath.h.html#LN102"><span class='Ref_to_Proto'>mp_int_clear</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1121"><span class='Ref_To_Local'>rtmp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="imath.c.html#LN1123"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_div_value &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_div_pow2(a, p2, q, r) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN1145"></a><span class='Declare_Function'>mp_int_div_pow2</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>p2</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>q</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>r</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1147"></a>    <a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a>   <span class='Declare_Local'>res</span> <span class='Operator'>= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1145"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN1145"><span class='Ref_to_Parameter'>p2</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="imath.c.html#LN1145"><span class='Ref_to_Parameter'>q</span></a> <span class='Operator'>!= </span><a href="imath.c.html#LN1145"><span class='Ref_to_Parameter'>r</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1145"><span class='Ref_to_Parameter'>q</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="imath.c.html#LN1147"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1145"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1145"><span class='Ref_to_Parameter'>q</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <a href="imath.c.html#LN246"><span class='Ref_to_Proto'>s_qdiv</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1145"><span class='Ref_to_Parameter'>q</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN1145"><span class='Ref_to_Parameter'>p2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1147"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>== </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a> <span class='Operator'>&& </span><a href="imath.c.html#LN1145"><span class='Ref_to_Parameter'>r</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="imath.c.html#LN1147"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1145"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1145"><span class='Ref_to_Parameter'>r</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <a href="imath.c.html#LN249"><span class='Ref_to_Proto'>s_qmod</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1145"><span class='Ref_to_Parameter'>r</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN1145"><span class='Ref_to_Parameter'>p2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN1147"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_expt(a, b, c) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN1165"></a><span class='Declare_Function'>mp_int_expt</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>b</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1167"></a>    <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mpz_t</span></a>       <span class='Declare_Local'>t</span><span class='Delimiter'>; 
</span><a name="LN1168"></a>    <a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a>   <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN1169"></a>    <span class='Keyword'>unsigned int </span><span class='Declare_Local'>v</span> <span class='Operator'>= </span>abs<span class='Parentheses'>(</span><a href="imath.c.html#LN1165"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1165"><span class='Ref_to_Parameter'>b</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="imath.c.html#LN1165"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1168"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN99"><span class='Ref_to_Proto'>mp_int_init_copy</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1167"><span class='Ref_To_Local'>t</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1165"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN1168"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
</span> 
    <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="imath.h.html#LN101"><span class='Ref_to_Proto'>mp_int_set_value</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1165"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1169"><span class='Ref_To_Local'>v</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1169"><span class='Ref_To_Local'>v</span></a> <span class='Operator'>& </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1168"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN114"><span class='Ref_to_Proto'>mp_int_mul</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1165"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="imath.c.html#LN1167"><span class='Ref_To_Local'>t</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1165"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1193"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="imath.c.html#LN1169"><span class='Ref_To_Local'>v</span></a> <span class='Operator'>&GT;&GT;= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1169"><span class='Ref_To_Local'>v</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1168"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN117"><span class='Ref_to_Proto'>mp_int_sqr</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1167"><span class='Ref_To_Local'>t</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="imath.c.html#LN1167"><span class='Ref_To_Local'>t</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1193"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
<a name="LN1193"></a><span class='Label'>CLEANUP</span><span class='Operator'>: 
</span>    <a href="imath.h.html#LN102"><span class='Ref_to_Proto'>mp_int_clear</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1167"><span class='Ref_To_Local'>t</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="imath.c.html#LN1168"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_expt &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_expt_value(a, b, c) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN1203"></a><span class='Declare_Function'>mp_int_expt_value</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>b</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1205"></a>    <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mpz_t</span></a>       <span class='Declare_Local'>t</span><span class='Delimiter'>; 
</span><a name="LN1206"></a>    <a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a>   <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN1207"></a>    <span class='Keyword'>unsigned int </span><span class='Declare_Local'>v</span> <span class='Operator'>= </span>abs<span class='Parentheses'>(</span><a href="imath.c.html#LN1203"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1203"><span class='Ref_to_Parameter'>b</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="imath.c.html#LN1203"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1206"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN100"><span class='Ref_to_Proto'>mp_int_init_value</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1205"><span class='Ref_To_Local'>t</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1203"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN1206"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
</span> 
    <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="imath.h.html#LN101"><span class='Ref_to_Proto'>mp_int_set_value</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1203"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1207"><span class='Ref_To_Local'>v</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1207"><span class='Ref_To_Local'>v</span></a> <span class='Operator'>& </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1206"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN114"><span class='Ref_to_Proto'>mp_int_mul</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1203"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="imath.c.html#LN1205"><span class='Ref_To_Local'>t</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1203"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1231"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="imath.c.html#LN1207"><span class='Ref_To_Local'>v</span></a> <span class='Operator'>&GT;&GT;= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1207"><span class='Ref_To_Local'>v</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1206"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN117"><span class='Ref_to_Proto'>mp_int_sqr</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1205"><span class='Ref_To_Local'>t</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="imath.c.html#LN1205"><span class='Ref_To_Local'>t</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1231"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
<a name="LN1231"></a><span class='Label'>CLEANUP</span><span class='Operator'>: 
</span>    <a href="imath.h.html#LN102"><span class='Ref_to_Proto'>mp_int_clear</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1205"><span class='Ref_To_Local'>t</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="imath.c.html#LN1206"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_expt_value &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_compare(a, b) */ 
</span> 
<span class='Keyword'>int 
</span><a name="LN1241"></a><span class='Declare_Function'>mp_int_compare</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>b</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1243"></a>    <a href="imath.h.html#LN38"><span class='Ref_to_Typedef'>mp_sign</span></a>     <span class='Declare_Local'>sa</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1241"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN1241"><span class='Ref_to_Parameter'>b</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN1243"><span class='Ref_To_Local'>sa</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1241"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1243"><span class='Ref_To_Local'>sa</span></a> <span class='Operator'>== </span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1241"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1250"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>cmp</span> <span class='Operator'>= </span><a href="imath.c.html#LN203"><span class='Ref_to_Proto'>s_ucmp</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1241"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1241"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If they're both zero or positive, the normal comparison applies; if 
         * both negative, the sense is reversed. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1243"><span class='Ref_To_Local'>sa</span></a> <span class='Operator'>== </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <a href="imath.c.html#LN1250"><span class='Ref_To_Local'>cmp</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <span class='Control'>return</span> <span class='Operator'>-</span><a href="imath.c.html#LN1250"><span class='Ref_To_Local'>cmp</span></a><span class='Delimiter'>; 
</span> 
    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1243"><span class='Ref_To_Local'>sa</span></a> <span class='Operator'>== </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_compare &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_compare_unsigned(a, b) */ 
</span> 
<span class='Keyword'>int 
</span><a name="LN1276"></a><span class='Declare_Function'>mp_int_compare_unsigned</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>b</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="imath.c.html#LN74"><span class='Ref_to_Macro'>NRCHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1276"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN1276"><span class='Ref_to_Parameter'>b</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN203"><span class='Ref_to_Proto'>s_ucmp</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1276"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1276"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_compare_zero(z) */ 
</span> 
<span class='Keyword'>int 
</span><a name="LN1288"></a><span class='Declare_Function'>mp_int_compare_zero</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="imath.c.html#LN74"><span class='Ref_to_Macro'>NRCHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1288"><span class='Ref_to_Parameter'>z</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1288"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>1</span> <span class='Operator'>&& </span><a href="imath.c.html#LN1288"><span class='Ref_to_Parameter'>z</span></a><span class='Operator'>-&GT;</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1288"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_compare_value(z, value) */ 
</span> 
<span class='Keyword'>int 
</span><a name="LN1305"></a><span class='Declare_Function'>mp_int_compare_value</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>value</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1307"></a>    <a href="imath.h.html#LN38"><span class='Ref_to_Typedef'>mp_sign</span></a>     <span class='Declare_Local'>vsign</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>value </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="imath.c.html#LN51"><span class='Ref_to_Global_Var'>MP_NEG</span></a> <span class='Operator'>: </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Delimiter'>; 
</span><a name="LN1308"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>cmp</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1305"><span class='Ref_to_Parameter'>z</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1307"><span class='Ref_To_Local'>vsign</span></a> <span class='Operator'>== </span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1305"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN1308"><span class='Ref_To_Local'>cmp</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN206"><span class='Ref_to_Proto'>s_vcmp</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1305"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span><span class='Keyword'>value</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1307"><span class='Ref_To_Local'>vsign</span></a> <span class='Operator'>== </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <a href="imath.c.html#LN1308"><span class='Ref_To_Local'>cmp</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <span class='Control'>return</span> <span class='Operator'>-</span><a href="imath.c.html#LN1308"><span class='Ref_To_Local'>cmp</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>value </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_compare_value &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_exptmod(a, b, m, c) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN1335"></a><span class='Declare_Function'>mp_int_exptmod</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>b</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>m</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1337"></a>    <a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a>   <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN1338"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>um</span><span class='Delimiter'>; 
</span><a name="LN1339"></a>    <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mpz_t</span></a>       <span class='Declare_Local'>temp</span><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>]; 
</span><a name="LN1340"></a>    <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a>      <span class='Declare_Local'>s</span><span class='Delimiter'>; 
</span><a name="LN1341"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>last</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1335"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN1335"><span class='Ref_to_Parameter'>b</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN1335"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN1335"><span class='Ref_to_Parameter'>m</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Zero moduli and negative exponents are not considered. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN145"><span class='Ref_to_Macro'>CMPZ</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1335"><span class='Ref_to_Parameter'>m</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN47"><span class='Ref_to_Global_Var'>MP_UNDEF</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN145"><span class='Ref_to_Macro'>CMPZ</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1335"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN46"><span class='Ref_to_Global_Var'>MP_RANGE</span></a><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN1338"><span class='Ref_To_Local'>um</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1335"><span class='Ref_to_Parameter'>m</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN142"><span class='Ref_to_Macro'>SETUP</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN98"><span class='Ref_to_Proto'>mp_int_init_size</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Number'>2</span> <span class='Operator'>* </span><a href="imath.c.html#LN1338"><span class='Ref_To_Local'>um</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1341"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN142"><span class='Ref_to_Macro'>SETUP</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN98"><span class='Ref_to_Proto'>mp_int_init_size</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Number'>2</span> <span class='Operator'>* </span><a href="imath.c.html#LN1338"><span class='Ref_To_Local'>um</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1341"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1335"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>== </span><a href="imath.c.html#LN1335"><span class='Ref_to_Parameter'>b</span></a> <span class='Operator'>|| </span><a href="imath.c.html#LN1335"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>== </span><a href="imath.c.html#LN1335"><span class='Ref_to_Parameter'>m</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN142"><span class='Ref_to_Macro'>SETUP</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN98"><span class='Ref_to_Proto'>mp_int_init_size</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Number'>2</span> <span class='Operator'>* </span><a href="imath.c.html#LN1338"><span class='Ref_To_Local'>um</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1341"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN1340"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN1340"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN1335"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1337"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN125"><span class='Ref_to_Proto'>mp_int_mod</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1335"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1335"><span class='Ref_to_Parameter'>m</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1376"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1337"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN273"><span class='Ref_to_Proto'>s_brmu</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1335"><span class='Ref_to_Parameter'>m</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1376"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1337"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN279"><span class='Ref_to_Proto'>s_embar</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1335"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1335"><span class='Ref_to_Parameter'>m</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1340"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1376"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN1337"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1340"><span class='Ref_To_Local'>s</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1335"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<a name="LN1376"></a><span class='Label'>CLEANUP</span><span class='Operator'>: 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>--</span><a href="imath.c.html#LN1341"><span class='Ref_To_Local'>last</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="imath.h.html#LN102"><span class='Ref_to_Proto'>mp_int_clear</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1341"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN1337"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_exptmod &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_exptmod_evalue(a, value, m, c) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN1388"></a><span class='Declare_Function'>mp_int_exptmod_evalue</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>value</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>m</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1390"></a>    <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mpz_t</span></a>       <span class='Declare_Local'>vtmp</span><span class='Delimiter'>; 
</span><a name="LN1391"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>    <span class='Declare_Local'>vbuf</span><span class='Delimiter'>[</span><a href="imath.c.html#LN108"><span class='Ref_to_Macro'>MP_VALUE_DIGITS</span></a><span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Parentheses'>)</span><span class='Delimiter'>]; 
</span> 
    <a href="imath.c.html#LN194"><span class='Ref_to_Proto'>s_fake</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1390"><span class='Ref_To_Local'>vtmp</span></a><span class='Delimiter'>, </span><span class='Keyword'>value</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1391"><span class='Ref_To_Local'>vbuf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.h.html#LN142"><span class='Ref_to_Proto'>mp_int_exptmod</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1388"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="imath.c.html#LN1390"><span class='Ref_To_Local'>vtmp</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1388"><span class='Ref_to_Parameter'>m</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1388"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_exptmod_bvalue(v, b, m, c) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN1403"></a><span class='Declare_Function'>mp_int_exptmod_bvalue</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>value</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>b</span><span class='Delimiter'>, 
</span><a name="LN1404"></a>                      <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>m</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1406"></a>    <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mpz_t</span></a>       <span class='Declare_Local'>vtmp</span><span class='Delimiter'>; 
</span><a name="LN1407"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>    <span class='Declare_Local'>vbuf</span><span class='Delimiter'>[</span><a href="imath.c.html#LN108"><span class='Ref_to_Macro'>MP_VALUE_DIGITS</span></a><span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Parentheses'>)</span><span class='Delimiter'>]; 
</span> 
    <a href="imath.c.html#LN194"><span class='Ref_to_Proto'>s_fake</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1406"><span class='Ref_To_Local'>vtmp</span></a><span class='Delimiter'>, </span><span class='Keyword'>value</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1407"><span class='Ref_To_Local'>vbuf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.h.html#LN142"><span class='Ref_to_Proto'>mp_int_exptmod</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1406"><span class='Ref_To_Local'>vtmp</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1403"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1404"><span class='Ref_to_Parameter'>m</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1404"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_exptmod_known(a, b, m, mu, c) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN1419"></a><span class='Declare_Function'>mp_int_exptmod_known</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>b</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>m</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>mu</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1421"></a>    <a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a>   <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN1422"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>um</span><span class='Delimiter'>; 
</span><a name="LN1423"></a>    <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mpz_t</span></a>       <span class='Declare_Local'>temp</span><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]; 
</span><a name="LN1424"></a>    <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a>      <span class='Declare_Local'>s</span><span class='Delimiter'>; 
</span><a name="LN1425"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>last</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1419"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>&& </span><a href="imath.c.html#LN1419"><span class='Ref_to_Parameter'>b</span></a> <span class='Operator'>&& </span><a href="imath.c.html#LN1419"><span class='Ref_to_Parameter'>m</span></a> <span class='Operator'>&& </span><a href="imath.c.html#LN1419"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Zero moduli and negative exponents are not considered. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN145"><span class='Ref_to_Macro'>CMPZ</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1419"><span class='Ref_to_Parameter'>m</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN47"><span class='Ref_to_Global_Var'>MP_UNDEF</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN145"><span class='Ref_to_Macro'>CMPZ</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1419"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN46"><span class='Ref_to_Global_Var'>MP_RANGE</span></a><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN1422"><span class='Ref_To_Local'>um</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1419"><span class='Ref_to_Parameter'>m</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN142"><span class='Ref_to_Macro'>SETUP</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN98"><span class='Ref_to_Proto'>mp_int_init_size</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Number'>2</span> <span class='Operator'>* </span><a href="imath.c.html#LN1422"><span class='Ref_To_Local'>um</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1425"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1419"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>== </span><a href="imath.c.html#LN1419"><span class='Ref_to_Parameter'>b</span></a> <span class='Operator'>|| </span><a href="imath.c.html#LN1419"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>== </span><a href="imath.c.html#LN1419"><span class='Ref_to_Parameter'>m</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN142"><span class='Ref_to_Macro'>SETUP</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN98"><span class='Ref_to_Proto'>mp_int_init_size</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Number'>2</span> <span class='Operator'>* </span><a href="imath.c.html#LN1422"><span class='Ref_To_Local'>um</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1425"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN1424"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN1424"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN1419"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1421"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN125"><span class='Ref_to_Proto'>mp_int_mod</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1419"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1419"><span class='Ref_to_Parameter'>m</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1456"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1421"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN279"><span class='Ref_to_Proto'>s_embar</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1419"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1419"><span class='Ref_to_Parameter'>m</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1419"><span class='Ref_to_Parameter'>mu</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1424"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1456"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN1421"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1424"><span class='Ref_To_Local'>s</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1419"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<a name="LN1456"></a><span class='Label'>CLEANUP</span><span class='Operator'>: 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>--</span><a href="imath.c.html#LN1425"><span class='Ref_To_Local'>last</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="imath.h.html#LN102"><span class='Ref_to_Proto'>mp_int_clear</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1425"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN1421"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_exptmod_known &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_redux_const(m, c) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN1468"></a><span class='Declare_Function'>mp_int_redux_const</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>m</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1468"><span class='Ref_to_Parameter'>m</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN1468"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN1468"><span class='Ref_to_Parameter'>m</span></a> <span class='Operator'>!= </span><a href="imath.c.html#LN1468"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN273"><span class='Ref_to_Proto'>s_brmu</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1468"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1468"><span class='Ref_to_Parameter'>m</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_invmod(a, m, c) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN1480"></a><span class='Declare_Function'>mp_int_invmod</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>m</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1482"></a>    <a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a>   <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN1483"></a>    <a href="imath.h.html#LN38"><span class='Ref_to_Typedef'>mp_sign</span></a>     <span class='Declare_Local'>sa</span><span class='Delimiter'>; 
</span><a name="LN1484"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>last</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN1485"></a>    <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mpz_t</span></a>       <span class='Declare_Local'>temp</span><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1480"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN1480"><span class='Ref_to_Parameter'>m</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN1480"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN145"><span class='Ref_to_Macro'>CMPZ</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1480"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="imath.c.html#LN145"><span class='Ref_to_Macro'>CMPZ</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1480"><span class='Ref_to_Parameter'>m</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN46"><span class='Ref_to_Global_Var'>MP_RANGE</span></a><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN1483"><span class='Ref_To_Local'>sa</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1480"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>            <span class='Comment_Single_Line'>/* need this for the result later */ 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1484"><span class='Ref_To_Local'>last</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="imath.c.html#LN1484"><span class='Ref_To_Local'>last</span></a> <span class='Operator'>&LT; </span><span class='Number'>2</span><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="imath.c.html#LN1484"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1482"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN96"><span class='Ref_to_Proto'>mp_int_init</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1484"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>)))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1522"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1482"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN157"><span class='Ref_to_Proto'>mp_int_egcd</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1480"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1480"><span class='Ref_to_Parameter'>m</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1522"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN134"><span class='Ref_to_Proto'>mp_int_compare_value</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN1482"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN47"><span class='Ref_to_Global_Var'>MP_UNDEF</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1522"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* It is first necessary to constrain the value to the proper range */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1482"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN125"><span class='Ref_to_Proto'>mp_int_mod</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1480"><span class='Ref_to_Parameter'>m</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1522"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Now, if 'a' was originally negative, the value we have is actually the 
     * magnitude of the negative representative; to get the positive value we 
     * have to subtract from the modulus.  Otherwise, the value is okay as it 
     * stands. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1483"><span class='Ref_To_Local'>sa</span></a> <span class='Operator'>== </span><a href="imath.c.html#LN51"><span class='Ref_to_Global_Var'>MP_NEG</span></a><span class='Parentheses'>) 
</span>        <a href="imath.c.html#LN1482"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN112"><span class='Ref_to_Proto'>mp_int_sub</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1480"><span class='Ref_to_Parameter'>m</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1480"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="imath.c.html#LN1482"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1480"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<a name="LN1522"></a><span class='Label'>CLEANUP</span><span class='Operator'>: 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>--</span><a href="imath.c.html#LN1484"><span class='Ref_To_Local'>last</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="imath.h.html#LN102"><span class='Ref_to_Proto'>mp_int_clear</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1484"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN1482"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_invmod &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_gcd(a, b, c) */ 
</span> 
<span class='Comment_Multi_Line'>/* Binary GCD algorithm due to Josef Stein, 1961 */ 
</span><a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN1535"></a><span class='Declare_Function'>mp_int_gcd</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>b</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1537"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>ca</span><span class='Delimiter'>, 
</span><a name="LN1538"></a>                <span class='Declare_Local'>cb</span><span class='Delimiter'>, 
</span><a name="LN1539"></a>                <span class='Declare_Local'>k</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN1540"></a>    <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mpz_t</span></a>       <span class='Declare_Local'>u</span><span class='Delimiter'>, 
</span><a name="LN1541"></a>                <span class='Declare_Local'>v</span><span class='Delimiter'>, 
</span><a name="LN1542"></a>                <span class='Declare_Local'>t</span><span class='Delimiter'>; 
</span><a name="LN1543"></a>    <a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a>   <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1535"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN1535"><span class='Ref_to_Parameter'>b</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN1535"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN1537"><span class='Ref_To_Local'>ca</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN145"><span class='Ref_to_Macro'>CMPZ</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1535"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN1538"><span class='Ref_To_Local'>cb</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN145"><span class='Ref_to_Macro'>CMPZ</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1535"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1537"><span class='Ref_To_Local'>ca</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="imath.c.html#LN1538"><span class='Ref_To_Local'>cb</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="imath.c.html#LN47"><span class='Ref_to_Global_Var'>MP_UNDEF</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1537"><span class='Ref_To_Local'>ca</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="imath.h.html#LN108"><span class='Ref_to_Proto'>mp_int_abs</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1535"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1535"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1538"><span class='Ref_To_Local'>cb</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="imath.h.html#LN108"><span class='Ref_to_Proto'>mp_int_abs</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1535"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1535"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1543"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN96"><span class='Ref_to_Proto'>mp_int_init</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1542"><span class='Ref_To_Local'>t</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN1543"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1543"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN99"><span class='Ref_to_Proto'>mp_int_init_copy</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1540"><span class='Ref_To_Local'>u</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1535"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1616"><span class='Ref_to_Label'>U</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1543"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN99"><span class='Ref_to_Proto'>mp_int_init_copy</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1541"><span class='Ref_To_Local'>v</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1535"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1615"><span class='Ref_to_Label'>V</span></a><span class='Delimiter'>; 
</span> 
<a name="LN1563"></a>    <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><span class='Declare_Local'>u</span><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Delimiter'>; 
</span><a name="LN1564"></a>    <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><span class='Declare_Local'>v</span><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Delimiter'>; 
</span> 
    <span class='Delimiter'>{</span>                           <span class='Comment_Single_Line'>/* Divide out common factors of 2 from u and v */ 
</span><a name="LN1567"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>div2_u</span> <span class='Operator'>= </span><a href="imath.c.html#LN260"><span class='Ref_to_Proto'>s_dp2k</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1540"><span class='Ref_To_Local'>u</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span><a name="LN1568"></a>                    <span class='Declare_Local'>div2_v</span> <span class='Operator'>= </span><a href="imath.c.html#LN260"><span class='Ref_to_Proto'>s_dp2k</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1541"><span class='Ref_To_Local'>v</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="imath.c.html#LN1539"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN137"><span class='Ref_to_Macro'>MIN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1567"><span class='Ref_To_Local'>div2_u</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1568"><span class='Ref_To_Local'>div2_v</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN246"><span class='Ref_to_Proto'>s_qdiv</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1540"><span class='Ref_To_Local'>u</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN1539"><span class='Ref_To_Local'>k</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN246"><span class='Ref_to_Proto'>s_qdiv</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1541"><span class='Ref_To_Local'>v</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN1539"><span class='Ref_To_Local'>k</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN88"><span class='Ref_to_Macro'>mp_int_is_odd</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1540"><span class='Ref_To_Local'>u</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1543"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN109"><span class='Ref_to_Proto'>mp_int_neg</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1541"><span class='Ref_To_Local'>v</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="imath.c.html#LN1542"><span class='Ref_To_Local'>t</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1613"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1543"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1540"><span class='Ref_To_Local'>u</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="imath.c.html#LN1542"><span class='Ref_To_Local'>t</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1613"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>;;</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN246"><span class='Ref_to_Proto'>s_qdiv</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1542"><span class='Ref_To_Local'>t</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN260"><span class='Ref_to_Proto'>s_dp2k</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1542"><span class='Ref_To_Local'>t</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN145"><span class='Ref_to_Macro'>CMPZ</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1542"><span class='Ref_To_Local'>t</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1543"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1542"><span class='Ref_To_Local'>t</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="imath.c.html#LN1540"><span class='Ref_To_Local'>u</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1613"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1543"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN109"><span class='Ref_to_Proto'>mp_int_neg</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1542"><span class='Ref_To_Local'>t</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="imath.c.html#LN1541"><span class='Ref_To_Local'>v</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1613"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1543"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN112"><span class='Ref_to_Proto'>mp_int_sub</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1540"><span class='Ref_To_Local'>u</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="imath.c.html#LN1541"><span class='Ref_To_Local'>v</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="imath.c.html#LN1542"><span class='Ref_To_Local'>t</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1613"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN145"><span class='Ref_to_Macro'>CMPZ</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1542"><span class='Ref_To_Local'>t</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for ;; &raquo; </span> 
 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1543"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN108"><span class='Ref_to_Proto'>mp_int_abs</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1540"><span class='Ref_To_Local'>u</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1535"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1613"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="imath.c.html#LN253"><span class='Ref_to_Proto'>s_qmul</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1535"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN1539"><span class='Ref_To_Local'>k</span></a><span class='Parentheses'>))</span> 
        <a href="imath.c.html#LN1543"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN45"><span class='Ref_to_Global_Var'>MP_MEMORY</span></a><span class='Delimiter'>; 
</span> 
<a name="LN1613"></a><span class='Label'>CLEANUP</span><span class='Operator'>: 
</span>    <a href="imath.h.html#LN102"><span class='Ref_to_Proto'>mp_int_clear</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1541"><span class='Ref_To_Local'>v</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1615"></a><span class='Label'>V</span><span class='Operator'>: </span><a href="imath.h.html#LN102"><span class='Ref_to_Proto'>mp_int_clear</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1540"><span class='Ref_To_Local'>u</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1616"></a><span class='Label'>U</span><span class='Operator'>: </span><a href="imath.h.html#LN102"><span class='Ref_to_Proto'>mp_int_clear</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1542"><span class='Ref_To_Local'>t</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN1543"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_gcd &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_egcd(a, b, c, x, y) */ 
</span> 
<span class='Comment_Multi_Line'>/* This is the binary GCD algorithm again, but this time we keep track 
   of the elementary matrix operations as we go, so we can get values 
   x and y satisfying c = ax + by. 
 */ 
</span><a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN1630"></a><span class='Declare_Function'>mp_int_egcd</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>b</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Delimiter'>, 
</span><a name="LN1631"></a>            <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>x</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>y</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1633"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>k</span><span class='Delimiter'>, 
</span><a name="LN1634"></a>                <span class='Declare_Local'>last</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>, 
</span><a name="LN1635"></a>                <span class='Declare_Local'>ca</span><span class='Delimiter'>, 
</span><a name="LN1636"></a>                <span class='Declare_Local'>cb</span><span class='Delimiter'>; 
</span><a name="LN1637"></a>    <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mpz_t</span></a>       <span class='Declare_Local'>temp</span><span class='Delimiter'>[</span><span class='Number'>8</span><span class='Delimiter'>]; 
</span><a name="LN1638"></a>    <a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a>   <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1630"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN1630"><span class='Ref_to_Parameter'>b</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN1630"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& 
</span>          <span class='Parentheses'>(</span><a href="imath.c.html#LN1631"><span class='Ref_to_Parameter'>x</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span><a href="imath.c.html#LN1631"><span class='Ref_to_Parameter'>y</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN1635"><span class='Ref_To_Local'>ca</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN145"><span class='Ref_to_Macro'>CMPZ</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1630"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN1636"><span class='Ref_To_Local'>cb</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN145"><span class='Ref_to_Macro'>CMPZ</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1630"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1635"><span class='Ref_To_Local'>ca</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="imath.c.html#LN1636"><span class='Ref_To_Local'>cb</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="imath.c.html#LN47"><span class='Ref_to_Global_Var'>MP_UNDEF</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1635"><span class='Ref_To_Local'>ca</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1638"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN108"><span class='Ref_to_Proto'>mp_int_abs</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1630"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1630"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <a href="imath.c.html#LN1638"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
</span>        <a href="imath.h.html#LN107"><span class='Ref_to_Proto'>mp_int_zero</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1631"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="imath.h.html#LN101"><span class='Ref_to_Proto'>mp_int_set_value</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1631"><span class='Ref_to_Parameter'>y</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1636"><span class='Ref_To_Local'>cb</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1638"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN108"><span class='Ref_to_Proto'>mp_int_abs</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1630"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1630"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <a href="imath.c.html#LN1638"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
</span>        <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="imath.h.html#LN101"><span class='Ref_to_Proto'>mp_int_set_value</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1631"><span class='Ref_to_Parameter'>x</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.h.html#LN107"><span class='Ref_to_Proto'>mp_int_zero</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1631"><span class='Ref_to_Parameter'>y</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Initialize temporaries: A:0, B:1, C:2, D:3, u:4, v:5, ou:6, ov:7 
     */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1634"><span class='Ref_To_Local'>last</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="imath.c.html#LN1634"><span class='Ref_To_Local'>last</span></a> <span class='Operator'>&LT; </span><span class='Number'>4</span><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="imath.c.html#LN1634"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1638"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN96"><span class='Ref_to_Proto'>mp_int_init</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1634"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>)))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1768"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>digits<span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>3</span><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>digits<span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN142"><span class='Ref_to_Macro'>SETUP</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN99"><span class='Ref_to_Proto'>mp_int_init_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>4</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1630"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1634"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN142"><span class='Ref_to_Macro'>SETUP</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN99"><span class='Ref_to_Proto'>mp_int_init_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>5</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1630"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1634"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* We will work with absolute values here */ 
</span>    <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>4</span><span class='Parentheses'>))</span> <span class='Operator'>= </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Delimiter'>; 
</span>    <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>5</span><span class='Parentheses'>))</span> <span class='Operator'>= </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Delimiter'>; 
</span> 
    <span class='Delimiter'>{</span>                           <span class='Comment_Single_Line'>/* Divide out common factors of 2 from u and v */ 
</span><a name="LN1683"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>div2_u</span> <span class='Operator'>= </span><a href="imath.c.html#LN260"><span class='Ref_to_Proto'>s_dp2k</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>4</span><span class='Parentheses'>))</span><span class='Delimiter'>, 
</span><a name="LN1684"></a>                    <span class='Declare_Local'>div2_v</span> <span class='Operator'>= </span><a href="imath.c.html#LN260"><span class='Ref_to_Proto'>s_dp2k</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>5</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <a href="imath.c.html#LN1633"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN137"><span class='Ref_to_Macro'>MIN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1683"><span class='Ref_To_Local'>div2_u</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1684"><span class='Ref_To_Local'>div2_v</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN246"><span class='Ref_to_Proto'>s_qdiv</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>4</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1633"><span class='Ref_To_Local'>k</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN246"><span class='Ref_to_Proto'>s_qdiv</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>5</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1633"><span class='Ref_To_Local'>k</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="imath.c.html#LN142"><span class='Ref_to_Macro'>SETUP</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN99"><span class='Ref_to_Proto'>mp_int_init_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>6</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>4</span><span class='Parentheses'>))</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1634"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN142"><span class='Ref_to_Macro'>SETUP</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN99"><span class='Ref_to_Proto'>mp_int_init_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>7</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>5</span><span class='Parentheses'>))</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1634"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>;;</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN89"><span class='Ref_to_Macro'>mp_int_is_even</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>4</span><span class='Parentheses'>)))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="imath.c.html#LN246"><span class='Ref_to_Proto'>s_qdiv</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>4</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN88"><span class='Ref_to_Macro'>mp_int_is_odd</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>))</span> <span class='Operator'>|| </span><a href="imath.h.html#LN88"><span class='Ref_to_Macro'>mp_int_is_odd</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)))</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1638"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN110"><span class='Ref_to_Proto'>mp_int_add</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>7</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
                    <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1768"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1638"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN112"><span class='Ref_to_Proto'>mp_int_sub</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>6</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
                    <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1768"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <a href="imath.c.html#LN246"><span class='Ref_to_Proto'>s_qdiv</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN246"><span class='Ref_to_Proto'>s_qdiv</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN89"><span class='Ref_to_Macro'>mp_int_is_even</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>5</span><span class='Parentheses'>)))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="imath.c.html#LN246"><span class='Ref_to_Proto'>s_qdiv</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>5</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN88"><span class='Ref_to_Macro'>mp_int_is_odd</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>))</span> <span class='Operator'>|| </span><a href="imath.h.html#LN88"><span class='Ref_to_Macro'>mp_int_is_odd</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>3</span><span class='Parentheses'>)))</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1638"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN110"><span class='Ref_to_Proto'>mp_int_add</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>7</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
                    <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1768"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1638"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN112"><span class='Ref_to_Proto'>mp_int_sub</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>3</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>6</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>3</span><span class='Parentheses'>)))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
                    <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1768"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <a href="imath.c.html#LN246"><span class='Ref_to_Proto'>s_qdiv</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN246"><span class='Ref_to_Proto'>s_qdiv</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>3</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN131"><span class='Ref_to_Proto'>mp_int_compare</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>4</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>5</span><span class='Parentheses'>))</span> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1638"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN112"><span class='Ref_to_Proto'>mp_int_sub</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>4</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>5</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>4</span><span class='Parentheses'>)))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1768"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1638"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN112"><span class='Ref_to_Proto'>mp_int_sub</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1768"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1638"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN112"><span class='Ref_to_Proto'>mp_int_sub</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>3</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1768"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1638"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN112"><span class='Ref_to_Proto'>mp_int_sub</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>5</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>4</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>5</span><span class='Parentheses'>)))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1768"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1638"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN112"><span class='Ref_to_Proto'>mp_int_sub</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1768"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1638"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN112"><span class='Ref_to_Proto'>mp_int_sub</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>3</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>3</span><span class='Parentheses'>)))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1768"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN145"><span class='Ref_to_Macro'>CMPZ</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>4</span><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1631"><span class='Ref_to_Parameter'>x</span></a> <span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="imath.c.html#LN1638"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1631"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1768"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1631"><span class='Ref_to_Parameter'>y</span></a> <span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="imath.c.html#LN1638"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>3</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1631"><span class='Ref_to_Parameter'>y</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1768"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1630"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="imath.c.html#LN253"><span class='Ref_to_Proto'>s_qmul</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>5</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1633"><span class='Ref_To_Local'>k</span></a><span class='Parentheses'>))</span> 
                <span class='Delimiter'>{ 
</span>                    <a href="imath.c.html#LN1638"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN45"><span class='Ref_to_Global_Var'>MP_MEMORY</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1768"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span> 
                <a href="imath.c.html#LN1638"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>5</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1630"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for ;; &raquo; </span> 
 
<a name="LN1768"></a><span class='Label'>CLEANUP</span><span class='Operator'>: 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>--</span><a href="imath.c.html#LN1634"><span class='Ref_To_Local'>last</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="imath.h.html#LN102"><span class='Ref_to_Proto'>mp_int_clear</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1634"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN1638"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_egcd &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_divisible_value(a, v) */ 
</span> 
<span class='Keyword'>int 
</span><a name="LN1780"></a><span class='Declare_Function'>mp_int_divisible_value</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>v</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1782"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>rem</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN121"><span class='Ref_to_Proto'>mp_int_div_value</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1780"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1780"><span class='Ref_to_Parameter'>v</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="imath.c.html#LN1782"><span class='Ref_To_Local'>rem</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN1782"><span class='Ref_To_Local'>rem</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_is_pow2(z) */ 
</span> 
<span class='Keyword'>int 
</span><a name="LN1795"></a><span class='Declare_Function'>mp_int_is_pow2</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1795"><span class='Ref_to_Parameter'>z</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN263"><span class='Ref_to_Proto'>s_isp2</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1795"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_sqrt(a, c) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN1807"></a><span class='Declare_Function'>mp_int_sqrt</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1809"></a>    <a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a>   <span class='Declare_Local'>res</span> <span class='Operator'>= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Delimiter'>; 
</span><a name="LN1810"></a>    <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mpz_t</span></a>       <span class='Declare_Local'>temp</span><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]; 
</span><a name="LN1811"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>last</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1807"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN1807"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* The square root of a negative value does not exist in the integers. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1807"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="imath.c.html#LN51"><span class='Ref_to_Global_Var'>MP_NEG</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN47"><span class='Ref_to_Global_Var'>MP_UNDEF</span></a><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN142"><span class='Ref_to_Macro'>SETUP</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN99"><span class='Ref_to_Proto'>mp_int_init_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1811"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1807"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1811"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN142"><span class='Ref_to_Macro'>SETUP</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN96"><span class='Ref_to_Proto'>mp_int_init</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1811"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1811"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>;;</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1809"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN117"><span class='Ref_to_Proto'>mp_int_sqr</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1852"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN132"><span class='Ref_to_Proto'>mp_int_compare_unsigned</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1807"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1809"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1807"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1852"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1809"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN119"><span class='Ref_to_Proto'>mp_int_div</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1852"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1809"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN110"><span class='Ref_to_Proto'>mp_int_add</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1852"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1809"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN123"><span class='Ref_to_Proto'>mp_int_div_pow2</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1852"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN132"><span class='Ref_to_Proto'>mp_int_compare_unsigned</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1809"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN113"><span class='Ref_to_Proto'>mp_int_sub_value</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1852"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN132"><span class='Ref_to_Proto'>mp_int_compare_unsigned</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1809"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN1852"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for ;; &raquo; </span> 
 
    <a href="imath.c.html#LN1809"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN1807"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<a name="LN1852"></a><span class='Label'>CLEANUP</span><span class='Operator'>: 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>--</span><a href="imath.c.html#LN1811"><span class='Ref_To_Local'>last</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="imath.h.html#LN102"><span class='Ref_to_Proto'>mp_int_clear</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1811"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN1809"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_sqrt &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_to_int(z, out) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN1864"></a><span class='Declare_Function'>mp_int_to_int</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>out</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1866"></a>    <span class='Keyword'>unsigned int </span><span class='Declare_Local'>uv</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN1867"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>uz</span><span class='Delimiter'>; 
</span><a name="LN1868"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>dz</span><span class='Delimiter'>; 
</span><a name="LN1869"></a>    <a href="imath.h.html#LN38"><span class='Ref_to_Typedef'>mp_sign</span></a>     <span class='Declare_Local'>sz</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1864"><span class='Ref_to_Parameter'>z</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Make sure the value is representable as an int */ 
</span>    <a href="imath.c.html#LN1869"><span class='Ref_To_Local'>sz</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1864"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1869"><span class='Ref_To_Local'>sz</span></a> <span class='Operator'>== </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a> <span class='Operator'>&& </span><a href="imath.h.html#LN134"><span class='Ref_to_Proto'>mp_int_compare_value</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1864"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span>INT_MAX<span class='Parentheses'>) </span><span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> <span class='Operator'>|| 
</span>        <a href="imath.h.html#LN134"><span class='Ref_to_Proto'>mp_int_compare_value</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1864"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span>INT_MIN<span class='Parentheses'>)</span> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN46"><span class='Ref_to_Global_Var'>MP_RANGE</span></a><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN1867"><span class='Ref_To_Local'>uz</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1864"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN1868"><span class='Ref_To_Local'>dz</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1864"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="imath.c.html#LN1867"><span class='Ref_To_Local'>uz</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1867"><span class='Ref_To_Local'>uz</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN1866"><span class='Ref_To_Local'>uv</span></a> <span class='Operator'>&LT;&LT;= </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a> <span class='Operator'>/ </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN1866"><span class='Ref_To_Local'>uv</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.c.html#LN1866"><span class='Ref_To_Local'>uv</span></a> <span class='Operator'>&LT;&LT; </span><span class='Parentheses'>(</span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a> <span class='Operator'>/ </span><span class='Number'>2</span><span class='Parentheses'>))</span> <span class='Operator'>| *</span><a href="imath.c.html#LN1868"><span class='Ref_To_Local'>dz</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>        <span class='Operator'>--</span><a href="imath.c.html#LN1867"><span class='Ref_To_Local'>uz</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1864"><span class='Ref_to_Parameter'>out</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="imath.c.html#LN1864"><span class='Ref_to_Parameter'>out</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.c.html#LN1869"><span class='Ref_To_Local'>sz</span></a> <span class='Operator'>== </span><a href="imath.c.html#LN51"><span class='Ref_to_Global_Var'>MP_NEG</span></a><span class='Parentheses'>) </span><span class='Operator'>? -</span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="imath.c.html#LN1866"><span class='Ref_To_Local'>uv</span></a> <span class='Operator'>: </span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="imath.c.html#LN1866"><span class='Ref_To_Local'>uv</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_to_int &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_to_string(z, radix, str, limit) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN1900"></a><span class='Declare_Function'>mp_int_to_string</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>radix</span><span class='Delimiter'>, 
</span><a name="LN1901"></a>                 <span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>str</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>limit</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1903"></a>    <a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a>   <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN1904"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>cmp</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1900"><span class='Ref_to_Parameter'>z</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN1901"><span class='Ref_to_Parameter'>str</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN1901"><span class='Ref_to_Parameter'>limit</span></a> <span class='Operator'>&GT;= </span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1900"><span class='Ref_to_Parameter'>radix</span></a> <span class='Operator'>&LT; </span><a href="imath.h.html#LN82"><span class='Ref_to_Const'>MP_MIN_RADIX</span></a> <span class='Operator'>|| </span><a href="imath.c.html#LN1900"><span class='Ref_to_Parameter'>radix</span></a> <span class='Operator'>&GT; </span><a href="imath.h.html#LN83"><span class='Ref_to_Const'>MP_MAX_RADIX</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="imath.c.html#LN46"><span class='Ref_to_Global_Var'>MP_RANGE</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN145"><span class='Ref_to_Macro'>CMPZ</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1900"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Operator'>*</span><a href="imath.c.html#LN1901"><span class='Ref_to_Parameter'>str</span></a><span class='Operator'>++ = </span><a href="imath.c.html#LN299"><span class='Ref_to_Proto'>s_val2ch</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="imath.c.html#LN172"><span class='Ref_to_Global_Var'>mp_flags</span></a> <span class='Operator'>& </span><a href="imath.c.html#LN69"><span class='Ref_to_Const'>MP_CAP_DIGITS</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1917"></a>        <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mpz_t</span></a>       <span class='Declare_Local'>tmp</span><span class='Delimiter'>; 
</span><a name="LN1918"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>h</span><span class='Delimiter'>, 
</span><a name="LN1919"></a>                   <span class='Operator'>*</span><span class='Declare_Local'>t</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1903"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN99"><span class='Ref_to_Proto'>mp_int_init_copy</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1917"><span class='Ref_To_Local'>tmp</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1900"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <a href="imath.c.html#LN1903"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1900"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="imath.c.html#LN51"><span class='Ref_to_Global_Var'>MP_NEG</span></a><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="imath.c.html#LN1901"><span class='Ref_to_Parameter'>str</span></a><span class='Operator'>++ = </span><span class='String'>'-'</span><span class='Delimiter'>; 
</span>            <span class='Operator'>--</span><a href="imath.c.html#LN1901"><span class='Ref_to_Parameter'>limit</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="imath.c.html#LN1918"><span class='Ref_To_Local'>h</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN1901"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Generate digits in reverse order until finished or limit reached */ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>( </span><span class='Comment_Multi_Line'>/* */ </span><span class='Delimiter'>; </span><a href="imath.c.html#LN1901"><span class='Ref_to_Parameter'>limit</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Delimiter'>; </span><span class='Operator'>--</span><a href="imath.c.html#LN1901"><span class='Ref_to_Parameter'>limit</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN1934"></a>            <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>    <span class='Declare_Local'>d</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN1904"><span class='Ref_To_Local'>cmp</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN145"><span class='Ref_to_Macro'>CMPZ</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1917"><span class='Ref_To_Local'>tmp</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <a href="imath.c.html#LN1934"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN243"><span class='Ref_to_Proto'>s_ddiv</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1917"><span class='Ref_To_Local'>tmp</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN1900"><span class='Ref_to_Parameter'>radix</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="imath.c.html#LN1901"><span class='Ref_to_Parameter'>str</span></a><span class='Operator'>++ = </span><a href="imath.c.html#LN299"><span class='Ref_to_Proto'>s_val2ch</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1934"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN172"><span class='Ref_to_Global_Var'>mp_flags</span></a> <span class='Operator'>& </span><a href="imath.c.html#LN69"><span class='Ref_to_Const'>MP_CAP_DIGITS</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="imath.c.html#LN1919"><span class='Ref_To_Local'>t</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN1901"><span class='Ref_to_Parameter'>str</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Put digits back in correct output order */ 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1918"><span class='Ref_To_Local'>h</span></a> <span class='Operator'>&LT; </span><a href="imath.c.html#LN1919"><span class='Ref_To_Local'>t</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN1947"></a>            <span class='Keyword'>char</span>        <span class='Declare_Local'>tc</span> <span class='Operator'>= *</span><a href="imath.c.html#LN1918"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>; 
</span> 
            <span class='Operator'>*</span><a href="imath.c.html#LN1918"><span class='Ref_To_Local'>h</span></a><span class='Operator'>++ = *</span><a href="imath.c.html#LN1919"><span class='Ref_To_Local'>t</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="imath.c.html#LN1919"><span class='Ref_To_Local'>t</span></a><span class='Operator'>-- = </span><a href="imath.c.html#LN1947"><span class='Ref_To_Local'>tc</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="imath.h.html#LN102"><span class='Ref_to_Proto'>mp_int_clear</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN1917"><span class='Ref_To_Local'>tmp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <span class='Operator'>*</span><a href="imath.c.html#LN1901"><span class='Ref_to_Parameter'>str</span></a> <span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1904"><span class='Ref_To_Local'>cmp</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN48"><span class='Ref_to_Global_Var'>MP_TRUNC</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_to_string &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_string_len(z, radix) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN1968"></a><span class='Declare_Function'>mp_int_string_len</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>radix</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1970"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1968"><span class='Ref_to_Parameter'>z</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN1968"><span class='Ref_to_Parameter'>radix</span></a> <span class='Operator'>&LT; </span><a href="imath.h.html#LN82"><span class='Ref_to_Const'>MP_MIN_RADIX</span></a> <span class='Operator'>|| </span><a href="imath.c.html#LN1968"><span class='Ref_to_Parameter'>radix</span></a> <span class='Operator'>&GT; </span><a href="imath.h.html#LN83"><span class='Ref_to_Const'>MP_MAX_RADIX</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="imath.c.html#LN46"><span class='Ref_to_Global_Var'>MP_RANGE</span></a><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN1970"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN287"><span class='Ref_to_Proto'>s_outlen</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1968"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1968"><span class='Ref_to_Parameter'>radix</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* for terminator */ 
</span> 
    <span class='Comment_Multi_Line'>/* Allow for sign marker on negatives */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1968"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="imath.c.html#LN51"><span class='Ref_to_Global_Var'>MP_NEG</span></a><span class='Parentheses'>)</span> 
        <a href="imath.c.html#LN1970"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>+= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN1970"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_read_string(z, radix, *str) */ 
</span> 
<span class='Comment_Multi_Line'>/* Read zero-terminated string into z */ 
</span><a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN1992"></a><span class='Declare_Function'>mp_int_read_string</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>radix</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>str</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="imath.h.html#LN176"><span class='Ref_to_Proto'>mp_int_read_cstring</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN1992"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1992"><span class='Ref_to_Parameter'>radix</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN1992"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Delimiter'>} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_read_cstring(z, radix, *str, **end) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN2003"></a><span class='Declare_Function'>mp_int_read_cstring</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>radix</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>str</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>**</span><span class='Declare_Parameter'>end</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2005"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>ch</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>z</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>str</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>radix</span></a> <span class='Operator'>&LT; </span><a href="imath.h.html#LN82"><span class='Ref_to_Const'>MP_MIN_RADIX</span></a> <span class='Operator'>|| </span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>radix</span></a> <span class='Operator'>&GT; </span><a href="imath.h.html#LN83"><span class='Ref_to_Const'>MP_MAX_RADIX</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="imath.c.html#LN46"><span class='Ref_to_Global_Var'>MP_RANGE</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Skip leading whitespace */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span>isspace<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>str</span></a><span class='Parentheses'>))</span> 
        <span class='Operator'>++</span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Handle leading sign tag (+/-, positive default) */ 
</span>    <span class='Control'>switch</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>str</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <span class='String'>'-'</span><span class='Operator'>: 
</span>            <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN51"><span class='Ref_to_Global_Var'>MP_NEG</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>++</span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <span class='String'>'+'</span><span class='Operator'>: 
</span>            <span class='Operator'>++</span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>;</span>              <span class='Comment_Single_Line'>/* fallthrough */ 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Skip leading zeroes */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN2005"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN296"><span class='Ref_to_Proto'>s_ch2val</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>radix</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Operator'>++</span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Make sure there is enough space for the value */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="imath.c.html#LN186"><span class='Ref_to_Proto'>s_pad</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN292"><span class='Ref_to_Proto'>s_inlen</span></a><span class='Parentheses'>(</span>strlen<span class='Parentheses'>(</span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>str</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>radix</span></a><span class='Parentheses'>)))</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN45"><span class='Ref_to_Global_Var'>MP_MEMORY</span></a><span class='Delimiter'>; 
</span> 
    <a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>z</span></a><span class='Operator'>-&GT;</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>str</span></a> <span class='Operator'>!= </span><span class='String'>'\0'</span> <span class='Operator'>&& </span><span class='Parentheses'>((</span><a href="imath.c.html#LN2005"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN296"><span class='Ref_to_Proto'>s_ch2val</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>radix</span></a><span class='Parentheses'>))</span> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN235"><span class='Ref_to_Proto'>s_dmul</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>radix</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN232"><span class='Ref_to_Proto'>s_dadd</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN2005"><span class='Ref_To_Local'>ch</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Operator'>++</span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="imath.c.html#LN128"><span class='Ref_to_Macro'>CLAMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Override sign for zero, even if negative specified. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN145"><span class='Ref_to_Macro'>CMPZ</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>end</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>end</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Return a truncation error if the string has unprocessed characters 
     * remaining, so the caller can tell if the whole string was done 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="imath.c.html#LN2003"><span class='Ref_to_Parameter'>str</span></a> <span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="imath.c.html#LN48"><span class='Ref_to_Global_Var'>MP_TRUNC</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_read_cstring &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_count_bits(z) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN2072"></a><span class='Declare_Function'>mp_int_count_bits</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2074"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>nbits</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>, 
</span><a name="LN2075"></a>                <span class='Declare_Local'>uz</span><span class='Delimiter'>; 
</span><a name="LN2076"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>    <span class='Declare_Local'>d</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2072"><span class='Ref_to_Parameter'>z</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN2075"><span class='Ref_To_Local'>uz</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2072"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2075"><span class='Ref_To_Local'>uz</span></a> <span class='Operator'>== </span><span class='Number'>1</span> <span class='Operator'>&& </span><a href="imath.c.html#LN2072"><span class='Ref_to_Parameter'>z</span></a><span class='Operator'>-&GT;</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Operator'>--</span><a href="imath.c.html#LN2075"><span class='Ref_To_Local'>uz</span></a><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN2074"><span class='Ref_To_Local'>nbits</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2075"><span class='Ref_To_Local'>uz</span></a> <span class='Operator'>* </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN2076"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2072"><span class='Ref_to_Parameter'>z</span></a><span class='Operator'>-&GT;</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN2075"><span class='Ref_To_Local'>uz</span></a><span class='Delimiter'>]; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2076"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN2076"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>&GT;&GT;= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Operator'>++</span><a href="imath.c.html#LN2074"><span class='Ref_To_Local'>nbits</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN2074"><span class='Ref_To_Local'>nbits</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_count_bits &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_to_binary(z, buf, limit) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN2102"></a><span class='Declare_Function'>mp_int_to_binary</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>buf</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>limit</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2104"></a>    <span class='Keyword'>static const int </span><span class='Declare_Local'>PAD_FOR_2C</span> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
<a name="LN2106"></a>    <a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a>   <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN2107"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>limpos</span> <span class='Operator'>= </span><a href="imath.c.html#LN2102"><span class='Ref_to_Parameter'>limit</span></a><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2102"><span class='Ref_to_Parameter'>z</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN2102"><span class='Ref_to_Parameter'>buf</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN2106"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN307"><span class='Ref_to_Proto'>s_tobin</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2102"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2102"><span class='Ref_to_Parameter'>buf</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="imath.c.html#LN2107"><span class='Ref_To_Local'>limpos</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2104"><span class='Ref_To_Local'>PAD_FOR_2C</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2102"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="imath.c.html#LN51"><span class='Ref_to_Global_Var'>MP_NEG</span></a><span class='Parentheses'>)</span> 
        <a href="imath.c.html#LN302"><span class='Ref_to_Proto'>s_2comp</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2102"><span class='Ref_to_Parameter'>buf</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2107"><span class='Ref_To_Local'>limpos</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN2106"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_read_binary(z, buf, len) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN2124"></a><span class='Declare_Function'>mp_int_read_binary</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>buf</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2126"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>need</span><span class='Delimiter'>, 
</span><a name="LN2127"></a>                <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN2128"></a>    <span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Declare_Local'>tmp</span><span class='Delimiter'>; 
</span><a name="LN2129"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>dz</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2124"><span class='Ref_to_Parameter'>z</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN2124"><span class='Ref_to_Parameter'>buf</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN2124"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Figure out how many digits are needed to represent this value */ 
</span>    <a href="imath.c.html#LN2126"><span class='Ref_To_Local'>need</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="imath.c.html#LN2124"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>* </span>CHAR_BIT<span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Parentheses'>(</span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>))</span> <span class='Operator'>/ </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="imath.c.html#LN186"><span class='Ref_to_Proto'>s_pad</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2124"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2126"><span class='Ref_To_Local'>need</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN45"><span class='Ref_to_Global_Var'>MP_MEMORY</span></a><span class='Delimiter'>; 
</span> 
    <a href="imath.h.html#LN107"><span class='Ref_to_Proto'>mp_int_zero</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2124"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If the high-order bit is set, take the 2's complement before reading 
     * the value (it will be restored afterward) 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2124"><span class='Ref_to_Parameter'>buf</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>&GT;&GT; </span><span class='Parentheses'>(</span>CHAR_BIT <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2124"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN51"><span class='Ref_to_Global_Var'>MP_NEG</span></a><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN302"><span class='Ref_to_Proto'>s_2comp</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2124"><span class='Ref_to_Parameter'>buf</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2124"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="imath.c.html#LN2129"><span class='Ref_To_Local'>dz</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2124"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2128"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2124"><span class='Ref_to_Parameter'>buf</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2127"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2124"><span class='Ref_to_Parameter'>len</span></a><span class='Delimiter'>; </span><a href="imath.c.html#LN2127"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Delimiter'>; </span><span class='Operator'>--</span><a href="imath.c.html#LN2127"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>, </span><span class='Operator'>++</span><a href="imath.c.html#LN2128"><span class='Ref_To_Local'>tmp</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN253"><span class='Ref_to_Proto'>s_qmul</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2124"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a><span class='Parentheses'>) </span>CHAR_BIT<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="imath.c.html#LN2129"><span class='Ref_To_Local'>dz</span></a> <span class='Operator'>|= *</span><a href="imath.c.html#LN2128"><span class='Ref_To_Local'>tmp</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Restore 2's complement if we took it before */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2124"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="imath.c.html#LN51"><span class='Ref_to_Global_Var'>MP_NEG</span></a><span class='Parentheses'>)</span> 
        <a href="imath.c.html#LN302"><span class='Ref_to_Proto'>s_2comp</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2124"><span class='Ref_to_Parameter'>buf</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2124"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_read_binary &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_binary_len(z) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN2169"></a><span class='Declare_Function'>mp_int_binary_len</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2171"></a>    <a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a>   <span class='Declare_Local'>res</span> <span class='Operator'>= </span><a href="imath.h.html#LN180"><span class='Ref_to_Proto'>mp_int_count_bits</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2169"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2172"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>bytes</span> <span class='Operator'>= </span><a href="imath.h.html#LN198"><span class='Ref_to_Proto'>mp_int_unsigned_len</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2169"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2171"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="imath.c.html#LN2171"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN2172"><span class='Ref_To_Local'>bytes</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.c.html#LN2171"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>+ </span><span class='Parentheses'>(</span>CHAR_BIT <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>))</span> <span class='Operator'>/ </span>CHAR_BIT<span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If the highest-order bit falls exactly on a byte boundary, we need to 
     * pad with an extra byte so that the sign will be read correctly when 
     * reading it back in. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2172"><span class='Ref_To_Local'>bytes</span></a> <span class='Operator'>* </span>CHAR_BIT <span class='Operator'>== </span><a href="imath.c.html#LN2171"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>++</span><a href="imath.c.html#LN2172"><span class='Ref_To_Local'>bytes</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN2172"><span class='Ref_To_Local'>bytes</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_binary_len &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_to_unsigned(z, buf, limit) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN2195"></a><span class='Declare_Function'>mp_int_to_unsigned</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>buf</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>limit</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2197"></a>    <span class='Keyword'>static const int </span><span class='Declare_Local'>NO_PADDING</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2195"><span class='Ref_to_Parameter'>z</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN2195"><span class='Ref_to_Parameter'>buf</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN307"><span class='Ref_to_Proto'>s_tobin</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2195"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2195"><span class='Ref_to_Parameter'>buf</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="imath.c.html#LN2195"><span class='Ref_to_Parameter'>limit</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2197"><span class='Ref_To_Local'>NO_PADDING</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_read_unsigned(z, buf, len) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN2209"></a><span class='Declare_Function'>mp_int_read_unsigned</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>buf</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2211"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>need</span><span class='Delimiter'>, 
</span><a name="LN2212"></a>                <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN2213"></a>    <span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Declare_Local'>tmp</span><span class='Delimiter'>; 
</span><a name="LN2214"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>dz</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN73"><span class='Ref_to_Macro'>CHECK</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2209"><span class='Ref_to_Parameter'>z</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN2209"><span class='Ref_to_Parameter'>buf</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="imath.c.html#LN2209"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Figure out how many digits are needed to represent this value */ 
</span>    <a href="imath.c.html#LN2211"><span class='Ref_To_Local'>need</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="imath.c.html#LN2209"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>* </span>CHAR_BIT<span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Parentheses'>(</span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>))</span> <span class='Operator'>/ </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="imath.c.html#LN186"><span class='Ref_to_Proto'>s_pad</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2209"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2211"><span class='Ref_To_Local'>need</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN45"><span class='Ref_to_Global_Var'>MP_MEMORY</span></a><span class='Delimiter'>; 
</span> 
    <a href="imath.h.html#LN107"><span class='Ref_to_Proto'>mp_int_zero</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2209"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN2214"><span class='Ref_To_Local'>dz</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2209"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2213"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2209"><span class='Ref_to_Parameter'>buf</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2212"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2209"><span class='Ref_to_Parameter'>len</span></a><span class='Delimiter'>; </span><a href="imath.c.html#LN2212"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Delimiter'>; </span><span class='Operator'>--</span><a href="imath.c.html#LN2212"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>, </span><span class='Operator'>++</span><a href="imath.c.html#LN2213"><span class='Ref_To_Local'>tmp</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="imath.c.html#LN253"><span class='Ref_to_Proto'>s_qmul</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2209"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span>CHAR_BIT<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="imath.c.html#LN2214"><span class='Ref_To_Local'>dz</span></a> <span class='Operator'>|= *</span><a href="imath.c.html#LN2213"><span class='Ref_To_Local'>tmp</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end mp_int_read_unsigned &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_int_unsigned_len(z) */ 
</span> 
<a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN2240"></a><span class='Declare_Function'>mp_int_unsigned_len</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2242"></a>    <a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a>   <span class='Declare_Local'>res</span> <span class='Operator'>= </span><a href="imath.h.html#LN180"><span class='Ref_to_Proto'>mp_int_count_bits</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2240"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2243"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>bytes</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2242"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="imath.c.html#LN2242"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN2243"><span class='Ref_To_Local'>bytes</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.c.html#LN2242"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>+ </span><span class='Parentheses'>(</span>CHAR_BIT <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>))</span> <span class='Operator'>/ </span>CHAR_BIT<span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN2243"><span class='Ref_To_Local'>bytes</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ mp_error_string(res) */ 
</span> 
<span class='Keyword'>const char </span><span class='Operator'>* 
</span><a name="LN2258"></a><span class='Declare_Function'>mp_error_string</span><span class='Parentheses'>(</span><a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> <span class='Declare_Parameter'>res</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2260"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>ix</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2258"><span class='Ref_to_Parameter'>res</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="imath.c.html#LN54"><span class='Ref_to_Global_Var'>s_unknown_err</span></a><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN2258"><span class='Ref_to_Parameter'>res</span></a> <span class='Operator'>= -</span><a href="imath.c.html#LN2258"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2260"><span class='Ref_To_Local'>ix</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="imath.c.html#LN2260"><span class='Ref_To_Local'>ix</span></a> <span class='Operator'>&LT; </span><a href="imath.c.html#LN2258"><span class='Ref_to_Parameter'>res</span></a> <span class='Operator'>&& </span><a href="imath.c.html#LN55"><span class='Ref_to_Global_Var'>s_error_msg</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN2260"><span class='Ref_To_Local'>ix</span></a><span class='Delimiter'>] </span><span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="imath.c.html#LN2260"><span class='Ref_To_Local'>ix</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN55"><span class='Ref_to_Global_Var'>s_error_msg</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN2260"><span class='Ref_To_Local'>ix</span></a><span class='Delimiter'>] </span><span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="imath.c.html#LN55"><span class='Ref_to_Global_Var'>s_error_msg</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN2260"><span class='Ref_To_Local'>ix</span></a><span class='Delimiter'>]; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN54"><span class='Ref_to_Global_Var'>s_unknown_err</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/*------------------------------------------------------------------------*/ 
/* Private functions for internal use.  These make assumptions.           */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_alloc(num) */ 
</span> 
<span class='Keyword'>static </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>* 
</span><a name="LN2283"></a><span class='Declare_Function'>s_alloc</span><span class='Parentheses'>(</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>num</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2285"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>out</span> <span class='Operator'>= </span><a href="px.h.html#LN43"><span class='Ref_to_Macro'>px_alloc</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2283"><span class='Ref_to_Parameter'>num</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>assert</span><span class='Parentheses'>(</span><a href="imath.c.html#LN2285"><span class='Ref_To_Local'>out</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* for debugging */ 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN2285"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_realloc(old, num) */ 
</span> 
<span class='Keyword'>static </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>* 
</span><a name="LN2297"></a><span class='Declare_Function'>s_realloc</span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>old</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>num</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2299"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>new</span> <span class='Operator'>= </span><a href="px.h.html#LN44"><span class='Ref_to_Macro'>px_realloc</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2297"><span class='Ref_to_Parameter'>old</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2297"><span class='Ref_to_Parameter'>num</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>assert</span><span class='Parentheses'>(</span><span class='Control'>new</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* for debugging */ 
</span> 
    <span class='Control'>return</span> <span class='Control'>new</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_free(ptr) */ 
</span> 
<span class='Directive'>#if</span> <a href="imath.c.html#LN38"><span class='Ref_to_Const'>TRACEABLE_FREE</span></a> 
<span class='Keyword'>static void 
</span><a name="LN2312"></a><span class='Declare_Function'>s_free</span><span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Declare_Parameter'>ptr</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="px.h.html#LN45"><span class='Ref_to_Macro'>px_free</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2312"><span class='Ref_to_Parameter'>ptr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span><span class='Directive'>#endif</span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_pad(z, min) */ 
</span> 
<span class='Keyword'>static int 
</span><a name="LN2323"></a><span class='Declare_Function'>s_pad</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>min</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN66"><span class='Ref_to_Macro'>MP_ALLOC</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2323"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><a href="imath.c.html#LN2323"><span class='Ref_to_Parameter'>min</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span><a name="LN2327"></a>        <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>nsize</span> <span class='Operator'>= </span><a href="imath.c.html#LN112"><span class='Ref_to_Macro'>ROUND_PREC</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2323"><span class='Ref_to_Parameter'>min</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2328"></a>        <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>tmp</span> <span class='Operator'>= </span><a href="imath.c.html#LN2296"><span class='Ref_to_Func'>s_realloc</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2323"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN2327"><span class='Ref_To_Local'>nsize</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2328"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span> 
        <a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2323"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN2328"><span class='Ref_To_Local'>tmp</span></a><span class='Delimiter'>; 
</span>        <a href="imath.h.html#LN66"><span class='Ref_to_Macro'>MP_ALLOC</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2323"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN2327"><span class='Ref_To_Local'>nsize</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_clamp(z) */ 
</span> 
<span class='Directive'>#if</span> <a href="imath.c.html#LN37"><span class='Ref_to_Const'>TRACEABLE_CLAMP</span></a> 
<span class='Keyword'>static void 
</span><a name="LN2346"></a><span class='Declare_Function'>s_clamp</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2348"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>uz</span> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2346"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2349"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>zd</span> <span class='Operator'>= </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2346"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="imath.c.html#LN2348"><span class='Ref_To_Local'>uz</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2348"><span class='Ref_To_Local'>uz</span></a> <span class='Operator'>&GT; </span><span class='Number'>1</span> <span class='Operator'>&& </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="imath.c.html#LN2349"><span class='Ref_To_Local'>zd</span></a><span class='Operator'>-- == </span><span class='Number'>0</span><span class='Parentheses'>))</span> 
        <span class='Operator'>--</span><a href="imath.c.html#LN2348"><span class='Ref_To_Local'>uz</span></a><span class='Delimiter'>; 
</span> 
    <a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2346"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN2348"><span class='Ref_To_Local'>uz</span></a><span class='Delimiter'>; 
} 
</span><span class='Directive'>#endif</span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_fake(z, value, vbuf) */ 
</span> 
<span class='Keyword'>static void 
</span><a name="LN2363"></a><span class='Declare_Function'>s_fake</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>value</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Declare_Parameter'>vbuf</span><span class='Delimiter'>[]</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2365"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>uv</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN200"><span class='Ref_to_Proto'>s_vpack</span></a><span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Delimiter'>, </span><a href="imath.c.html#LN2363"><span class='Ref_to_Parameter'>vbuf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN2363"><span class='Ref_to_Parameter'>z</span></a><span class='Operator'>-&GT;</span><a href="imath.h.html#LN60"><span class='Ref_to_Member'>used</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2365"><span class='Ref_To_Local'>uv</span></a><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN2363"><span class='Ref_to_Parameter'>z</span></a><span class='Operator'>-&GT;</span><a href="imath.h.html#LN59"><span class='Ref_to_Member'>alloc</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN108"><span class='Ref_to_Macro'>MP_VALUE_DIGITS</span></a><span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN2363"><span class='Ref_to_Parameter'>z</span></a><span class='Operator'>-&GT;</span><a href="imath.h.html#LN61"><span class='Ref_to_Member'>sign</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>value </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="imath.c.html#LN51"><span class='Ref_to_Global_Var'>MP_NEG</span></a> <span class='Operator'>: </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN2363"><span class='Ref_to_Parameter'>z</span></a><span class='Operator'>-&GT;</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2363"><span class='Ref_to_Parameter'>vbuf</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_cdig(da, db, len) */ 
</span> 
<span class='Keyword'>static int 
</span><a name="LN2378"></a><span class='Declare_Function'>s_cdig</span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>da</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>db</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2380"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>dat</span> <span class='Operator'>= </span><a href="imath.c.html#LN2378"><span class='Ref_to_Parameter'>da</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN2378"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>, 
</span><a name="LN2381"></a>               <span class='Operator'>*</span><span class='Declare_Local'>dbt</span> <span class='Operator'>= </span><a href="imath.c.html#LN2378"><span class='Ref_to_Parameter'>db</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN2378"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>( </span><span class='Comment_Multi_Line'>/* */ </span><span class='Delimiter'>; </span><a href="imath.c.html#LN2378"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Delimiter'>; </span><span class='Operator'>--</span><a href="imath.c.html#LN2378"><span class='Ref_to_Parameter'>len</span></a><span class='Delimiter'>, </span><span class='Operator'>--</span><a href="imath.c.html#LN2380"><span class='Ref_To_Local'>dat</span></a><span class='Delimiter'>, </span><span class='Operator'>--</span><a href="imath.c.html#LN2381"><span class='Ref_To_Local'>dbt</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="imath.c.html#LN2380"><span class='Ref_To_Local'>dat</span></a> <span class='Operator'>&GT; *</span><a href="imath.c.html#LN2381"><span class='Ref_To_Local'>dbt</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="imath.c.html#LN2380"><span class='Ref_To_Local'>dat</span></a> <span class='Operator'>&LT; *</span><a href="imath.c.html#LN2381"><span class='Ref_To_Local'>dbt</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_vpack(v, t[]) */ 
</span> 
<span class='Keyword'>static int 
</span><a name="LN2399"></a><span class='Declare_Function'>s_vpack</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>v</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Declare_Parameter'>t</span><span class='Delimiter'>[]</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2401"></a>    <span class='Keyword'>unsigned int </span><span class='Declare_Local'>uv</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>unsigned int</span><span class='Parentheses'>) ((</span><a href="imath.c.html#LN2399"><span class='Ref_to_Parameter'>v</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) </span><span class='Operator'>? -</span><a href="imath.c.html#LN2399"><span class='Ref_to_Parameter'>v</span></a> <span class='Operator'>: </span><a href="imath.c.html#LN2399"><span class='Ref_to_Parameter'>v</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2402"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>ndig</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2401"><span class='Ref_To_Local'>uv</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="imath.c.html#LN2399"><span class='Ref_to_Parameter'>t</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN2402"><span class='Ref_To_Local'>ndig</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2401"><span class='Ref_To_Local'>uv</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="imath.c.html#LN2399"><span class='Ref_to_Parameter'>t</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN2402"><span class='Ref_To_Local'>ndig</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN2401"><span class='Ref_To_Local'>uv</span></a><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN2401"><span class='Ref_To_Local'>uv</span></a> <span class='Operator'>&GT;&GT;= </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a> <span class='Operator'>/ </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN2401"><span class='Ref_To_Local'>uv</span></a> <span class='Operator'>&GT;&GT;= </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a> <span class='Operator'>/ </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN2402"><span class='Ref_To_Local'>ndig</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end s_vpack &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_ucmp(a, b) */ 
</span> 
<span class='Keyword'>static int 
</span><a name="LN2424"></a><span class='Declare_Function'>s_ucmp</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>b</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2426"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>ua</span> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2424"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span><a name="LN2427"></a>                <span class='Declare_Local'>ub</span> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2424"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2426"><span class='Ref_To_Local'>ua</span></a> <span class='Operator'>&GT; </span><a href="imath.c.html#LN2427"><span class='Ref_To_Local'>ub</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2427"><span class='Ref_To_Local'>ub</span></a> <span class='Operator'>&GT; </span><a href="imath.c.html#LN2426"><span class='Ref_To_Local'>ua</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN197"><span class='Ref_to_Proto'>s_cdig</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2424"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2424"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN2426"><span class='Ref_To_Local'>ua</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_vcmp(a, v) */ 
</span> 
<span class='Keyword'>static int 
</span><a name="LN2442"></a><span class='Declare_Function'>s_vcmp</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>v</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2444"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>    <span class='Declare_Local'>vdig</span><span class='Delimiter'>[</span><a href="imath.c.html#LN108"><span class='Ref_to_Macro'>MP_VALUE_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2442"><span class='Ref_to_Parameter'>v</span></a><span class='Parentheses'>)</span><span class='Delimiter'>]; 
</span><a name="LN2445"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>ndig</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN2446"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>ua</span> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2442"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN2445"><span class='Ref_To_Local'>ndig</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN200"><span class='Ref_to_Proto'>s_vpack</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2442"><span class='Ref_to_Parameter'>v</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2444"><span class='Ref_To_Local'>vdig</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2446"><span class='Ref_To_Local'>ua</span></a> <span class='Operator'>&GT; </span><a href="imath.c.html#LN2445"><span class='Ref_To_Local'>ndig</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2446"><span class='Ref_To_Local'>ua</span></a> <span class='Operator'>&LT; </span><a href="imath.c.html#LN2445"><span class='Ref_To_Local'>ndig</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN197"><span class='Ref_to_Proto'>s_cdig</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2442"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN2444"><span class='Ref_To_Local'>vdig</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2445"><span class='Ref_To_Local'>ndig</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_uadd(da, db, dc, size_a, size_b) */ 
</span> 
<span class='Keyword'>static </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> 
<a name="LN2463"></a><span class='Declare_Function'>s_uadd</span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>da</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>db</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dc</span><span class='Delimiter'>, 
</span><a name="LN2464"></a>       <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>size_a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>size_b</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2466"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>pos</span><span class='Delimiter'>; 
</span><a name="LN2467"></a>    <a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a>     <span class='Declare_Local'>w</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Insure that da is the longer of the two to simplify later code */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2464"><span class='Ref_to_Parameter'>size_b</span></a> <span class='Operator'>&GT; </span><a href="imath.c.html#LN2464"><span class='Ref_to_Parameter'>size_a</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN139"><span class='Ref_to_Macro'>SWAP</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Delimiter'>, </span><a href="imath.c.html#LN2463"><span class='Ref_to_Parameter'>da</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2463"><span class='Ref_to_Parameter'>db</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN139"><span class='Ref_to_Macro'>SWAP</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2464"><span class='Ref_to_Parameter'>size_a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2464"><span class='Ref_to_Parameter'>size_b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Add corresponding digits until the shorter number runs out */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2466"><span class='Ref_To_Local'>pos</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="imath.c.html#LN2466"><span class='Ref_To_Local'>pos</span></a> <span class='Operator'>&LT; </span><a href="imath.c.html#LN2464"><span class='Ref_to_Parameter'>size_b</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="imath.c.html#LN2466"><span class='Ref_To_Local'>pos</span></a><span class='Delimiter'>, </span><span class='Operator'>++</span><a href="imath.c.html#LN2463"><span class='Ref_to_Parameter'>da</span></a><span class='Delimiter'>, </span><span class='Operator'>++</span><a href="imath.c.html#LN2463"><span class='Ref_to_Parameter'>db</span></a><span class='Delimiter'>, </span><span class='Operator'>++</span><a href="imath.c.html#LN2463"><span class='Ref_to_Parameter'>dc</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN2467"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2467"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>+ </span><span class='Parentheses'>(</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="imath.c.html#LN2463"><span class='Ref_to_Parameter'>da</span></a> <span class='Operator'>+ </span><span class='Parentheses'>(</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="imath.c.html#LN2463"><span class='Ref_to_Parameter'>db</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="imath.c.html#LN2463"><span class='Ref_to_Parameter'>dc</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN159"><span class='Ref_to_Macro'>LOWER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2467"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN2467"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN158"><span class='Ref_to_Macro'>UPPER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2467"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Propagate carries as far as necessary */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>( </span><span class='Comment_Multi_Line'>/* */ </span><span class='Delimiter'>; </span><a href="imath.c.html#LN2466"><span class='Ref_To_Local'>pos</span></a> <span class='Operator'>&LT; </span><a href="imath.c.html#LN2464"><span class='Ref_to_Parameter'>size_a</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="imath.c.html#LN2466"><span class='Ref_To_Local'>pos</span></a><span class='Delimiter'>, </span><span class='Operator'>++</span><a href="imath.c.html#LN2463"><span class='Ref_to_Parameter'>da</span></a><span class='Delimiter'>, </span><span class='Operator'>++</span><a href="imath.c.html#LN2463"><span class='Ref_to_Parameter'>dc</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN2467"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2467"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>+ *</span><a href="imath.c.html#LN2463"><span class='Ref_to_Parameter'>da</span></a><span class='Delimiter'>; 
</span> 
        <span class='Operator'>*</span><a href="imath.c.html#LN2463"><span class='Ref_to_Parameter'>dc</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN159"><span class='Ref_to_Macro'>LOWER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2467"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN2467"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN158"><span class='Ref_to_Macro'>UPPER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2467"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Return carry out */ 
</span>    <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN2467"><span class='Ref_To_Local'>w</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end s_uadd &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_usub(da, db, dc, size_a, size_b) */ 
</span> 
<span class='Keyword'>static void 
</span><a name="LN2502"></a><span class='Declare_Function'>s_usub</span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>da</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>db</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dc</span><span class='Delimiter'>, 
</span><a name="LN2503"></a>       <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>size_a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>size_b</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2505"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>pos</span><span class='Delimiter'>; 
</span><a name="LN2506"></a>    <a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a>     <span class='Declare_Local'>w</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* We assume that |a| &GT;= |b| so this should definitely hold */ 
</span>    <span class='Debug'>assert</span><span class='Parentheses'>(</span><a href="imath.c.html#LN2503"><span class='Ref_to_Parameter'>size_a</span></a> <span class='Operator'>&GT;= </span><a href="imath.c.html#LN2503"><span class='Ref_to_Parameter'>size_b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Subtract corresponding digits and propagate borrow */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2505"><span class='Ref_To_Local'>pos</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="imath.c.html#LN2505"><span class='Ref_To_Local'>pos</span></a> <span class='Operator'>&LT; </span><a href="imath.c.html#LN2503"><span class='Ref_to_Parameter'>size_b</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="imath.c.html#LN2505"><span class='Ref_To_Local'>pos</span></a><span class='Delimiter'>, </span><span class='Operator'>++</span><a href="imath.c.html#LN2502"><span class='Ref_to_Parameter'>da</span></a><span class='Delimiter'>, </span><span class='Operator'>++</span><a href="imath.c.html#LN2502"><span class='Ref_to_Parameter'>db</span></a><span class='Delimiter'>, </span><span class='Operator'>++</span><a href="imath.c.html#LN2502"><span class='Ref_to_Parameter'>dc</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN2506"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>) </span><a href="imath.h.html#LN46"><span class='Ref_to_Const'>MP_DIGIT_MAX</span></a> <span class='Operator'>+ </span><span class='Number'>1</span> <span class='Operator'>+</span>       <span class='Comment_Single_Line'>/* MP_RADIX */ 
</span>             <span class='Parentheses'>(</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="imath.c.html#LN2502"><span class='Ref_to_Parameter'>da</span></a><span class='Parentheses'>)</span> <span class='Operator'>- </span><a href="imath.c.html#LN2506"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>- </span><span class='Parentheses'>(</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="imath.c.html#LN2502"><span class='Ref_to_Parameter'>db</span></a><span class='Delimiter'>; 
</span> 
        <span class='Operator'>*</span><a href="imath.c.html#LN2502"><span class='Ref_to_Parameter'>dc</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN159"><span class='Ref_to_Macro'>LOWER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2506"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN2506"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.c.html#LN158"><span class='Ref_to_Macro'>UPPER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2506"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Finish the subtraction for remaining upper digits of da */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>( </span><span class='Comment_Multi_Line'>/* */ </span><span class='Delimiter'>; </span><a href="imath.c.html#LN2505"><span class='Ref_To_Local'>pos</span></a> <span class='Operator'>&LT; </span><a href="imath.c.html#LN2503"><span class='Ref_to_Parameter'>size_a</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="imath.c.html#LN2505"><span class='Ref_To_Local'>pos</span></a><span class='Delimiter'>, </span><span class='Operator'>++</span><a href="imath.c.html#LN2502"><span class='Ref_to_Parameter'>da</span></a><span class='Delimiter'>, </span><span class='Operator'>++</span><a href="imath.c.html#LN2502"><span class='Ref_to_Parameter'>dc</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN2506"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>) </span><a href="imath.h.html#LN46"><span class='Ref_to_Const'>MP_DIGIT_MAX</span></a> <span class='Operator'>+ </span><span class='Number'>1</span> <span class='Operator'>+</span>       <span class='Comment_Single_Line'>/* MP_RADIX */ 
</span>             <span class='Parentheses'>(</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="imath.c.html#LN2502"><span class='Ref_to_Parameter'>da</span></a><span class='Parentheses'>)</span> <span class='Operator'>- </span><a href="imath.c.html#LN2506"><span class='Ref_To_Local'>w</span></a><span class='Delimiter'>; 
</span> 
        <span class='Operator'>*</span><a href="imath.c.html#LN2502"><span class='Ref_to_Parameter'>dc</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN159"><span class='Ref_to_Macro'>LOWER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2506"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN2506"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.c.html#LN158"><span class='Ref_to_Macro'>UPPER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2506"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* If there is a borrow out at the end, it violates the precondition */ 
</span>    <span class='Debug'>assert</span><span class='Parentheses'>(</span><a href="imath.c.html#LN2506"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end s_usub &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_kmul(da, db, dc, size_a, size_b) */ 
</span> 
<span class='Keyword'>static int 
</span><a name="LN2540"></a><span class='Declare_Function'>s_kmul</span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>da</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>db</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dc</span><span class='Delimiter'>, 
</span><a name="LN2541"></a>       <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>size_a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>size_b</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2543"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>bot_size</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Make sure b is the smaller of the two input values */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2541"><span class='Ref_to_Parameter'>size_b</span></a> <span class='Operator'>&GT; </span><a href="imath.c.html#LN2541"><span class='Ref_to_Parameter'>size_a</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN139"><span class='Ref_to_Macro'>SWAP</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Delimiter'>, </span><a href="imath.c.html#LN2540"><span class='Ref_to_Parameter'>da</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2540"><span class='Ref_to_Parameter'>db</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN139"><span class='Ref_to_Macro'>SWAP</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2541"><span class='Ref_to_Parameter'>size_a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2541"><span class='Ref_to_Parameter'>size_b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Insure that the bottom is the larger half in an odd-length split; the 
     * code below relies on this being true. 
     */ 
</span>    <a href="imath.c.html#LN2543"><span class='Ref_To_Local'>bot_size</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.c.html#LN2541"><span class='Ref_to_Parameter'>size_a</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>/ </span><span class='Number'>2</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If the values are big enough to bother with recursion, use the 
     * Karatsuba algorithm to compute the product; otherwise use the normal 
     * multiplication algorithm 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN169"><span class='Ref_to_Global_Var'>multiply_threshold</span></a> <span class='Operator'>&& 
</span>        <a href="imath.c.html#LN2541"><span class='Ref_to_Parameter'>size_a</span></a> <span class='Operator'>&GT;= </span><a href="imath.c.html#LN169"><span class='Ref_to_Global_Var'>multiply_threshold</span></a> <span class='Operator'>&& 
</span>        <a href="imath.c.html#LN2541"><span class='Ref_to_Parameter'>size_b</span></a> <span class='Operator'>&GT; </span><a href="imath.c.html#LN2543"><span class='Ref_To_Local'>bot_size</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span> 
<a name="LN2568"></a>        <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>t1</span><span class='Delimiter'>, 
</span><a name="LN2569"></a>                   <span class='Operator'>*</span><span class='Declare_Local'>t2</span><span class='Delimiter'>, 
</span><a name="LN2570"></a>                   <span class='Operator'>*</span><span class='Declare_Local'>t3</span><span class='Delimiter'>, 
</span><a name="LN2571"></a>                    <span class='Declare_Local'>carry</span><span class='Delimiter'>; 
</span> 
<a name="LN2573"></a>        <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>a_top</span> <span class='Operator'>= </span><a href="imath.c.html#LN2540"><span class='Ref_to_Parameter'>da</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN2543"><span class='Ref_To_Local'>bot_size</span></a><span class='Delimiter'>; 
</span><a name="LN2574"></a>        <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>b_top</span> <span class='Operator'>= </span><a href="imath.c.html#LN2540"><span class='Ref_to_Parameter'>db</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN2543"><span class='Ref_To_Local'>bot_size</span></a><span class='Delimiter'>; 
</span> 
<a name="LN2576"></a>        <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>at_size</span> <span class='Operator'>= </span><a href="imath.c.html#LN2541"><span class='Ref_to_Parameter'>size_a</span></a> <span class='Operator'>- </span><a href="imath.c.html#LN2543"><span class='Ref_To_Local'>bot_size</span></a><span class='Delimiter'>; 
</span><a name="LN2577"></a>        <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>bt_size</span> <span class='Operator'>= </span><a href="imath.c.html#LN2541"><span class='Ref_to_Parameter'>size_b</span></a> <span class='Operator'>- </span><a href="imath.c.html#LN2543"><span class='Ref_To_Local'>bot_size</span></a><span class='Delimiter'>; 
</span><a name="LN2578"></a>        <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>buf_size</span> <span class='Operator'>= </span><span class='Number'>2</span> <span class='Operator'>* </span><a href="imath.c.html#LN2543"><span class='Ref_To_Local'>bot_size</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Do a single allocation for all three temporary buffers needed; each 
         * buffer must be big enough to hold the product of two bottom halves, 
         * and one buffer needs space for the completed product; twice the 
         * space is plenty. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN2568"><span class='Ref_To_Local'>t1</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN176"><span class='Ref_to_Proto'>s_alloc</span></a><span class='Parentheses'>(</span><span class='Number'>4</span> <span class='Operator'>* </span><a href="imath.c.html#LN2578"><span class='Ref_To_Local'>buf_size</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN2569"><span class='Ref_To_Local'>t2</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2568"><span class='Ref_To_Local'>t1</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN2578"><span class='Ref_To_Local'>buf_size</span></a><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN2570"><span class='Ref_To_Local'>t3</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2569"><span class='Ref_To_Local'>t2</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN2578"><span class='Ref_To_Local'>buf_size</span></a><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN115"><span class='Ref_to_Macro'>ZERO</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2568"><span class='Ref_To_Local'>t1</span></a><span class='Delimiter'>, </span><span class='Number'>4</span> <span class='Operator'>* </span><a href="imath.c.html#LN2578"><span class='Ref_To_Local'>buf_size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * t1 and t2 are initially used as temporaries to compute the inner 
         * product (a1 + a0)(b1 + b0) = a1b1 + a1b0 + a0b1 + a0b0 
         */ 
</span>        <a href="imath.c.html#LN2571"><span class='Ref_To_Local'>carry</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN210"><span class='Ref_to_Proto'>s_uadd</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2540"><span class='Ref_to_Parameter'>da</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2573"><span class='Ref_To_Local'>a_top</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2568"><span class='Ref_To_Local'>t1</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2543"><span class='Ref_To_Local'>bot_size</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2576"><span class='Ref_To_Local'>at_size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* t1 = a1 + a0 */ 
</span>        <a href="imath.c.html#LN2568"><span class='Ref_To_Local'>t1</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN2543"><span class='Ref_To_Local'>bot_size</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="imath.c.html#LN2571"><span class='Ref_To_Local'>carry</span></a><span class='Delimiter'>; 
</span> 
        <a href="imath.c.html#LN2571"><span class='Ref_To_Local'>carry</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN210"><span class='Ref_to_Proto'>s_uadd</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2540"><span class='Ref_to_Parameter'>db</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2574"><span class='Ref_To_Local'>b_top</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2569"><span class='Ref_To_Local'>t2</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2543"><span class='Ref_To_Local'>bot_size</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2577"><span class='Ref_To_Local'>bt_size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* t2 = b1 + b0 */ 
</span>        <a href="imath.c.html#LN2569"><span class='Ref_To_Local'>t2</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN2543"><span class='Ref_To_Local'>bot_size</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="imath.c.html#LN2571"><span class='Ref_To_Local'>carry</span></a><span class='Delimiter'>; 
</span> 
        <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="imath.c.html#LN218"><span class='Ref_to_Proto'>s_kmul</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2568"><span class='Ref_To_Local'>t1</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2569"><span class='Ref_To_Local'>t2</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2570"><span class='Ref_To_Local'>t3</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2543"><span class='Ref_To_Local'>bot_size</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="imath.c.html#LN2543"><span class='Ref_To_Local'>bot_size</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>;</span>  <span class='Comment_Single_Line'>/* t3 = t1 * t2 */ 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Now we'll get t1 = a0b0 and t2 = a1b1, and subtract them out so 
         * that we're left with only the pieces we want:  t3 = a1b0 + a0b1 
         */ 
</span>        <a href="imath.c.html#LN115"><span class='Ref_to_Macro'>ZERO</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2568"><span class='Ref_To_Local'>t1</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2578"><span class='Ref_To_Local'>buf_size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN115"><span class='Ref_to_Macro'>ZERO</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2569"><span class='Ref_To_Local'>t2</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2578"><span class='Ref_To_Local'>buf_size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="imath.c.html#LN218"><span class='Ref_to_Proto'>s_kmul</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2540"><span class='Ref_to_Parameter'>da</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2540"><span class='Ref_to_Parameter'>db</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2568"><span class='Ref_To_Local'>t1</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2543"><span class='Ref_To_Local'>bot_size</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2543"><span class='Ref_To_Local'>bot_size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>  <span class='Comment_Single_Line'>/* t1 = a0 * b0 */ 
</span>        <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="imath.c.html#LN218"><span class='Ref_to_Proto'>s_kmul</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2573"><span class='Ref_To_Local'>a_top</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2574"><span class='Ref_To_Local'>b_top</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2569"><span class='Ref_To_Local'>t2</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2576"><span class='Ref_To_Local'>at_size</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2577"><span class='Ref_To_Local'>bt_size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>      <span class='Comment_Single_Line'>/* t2 = a1 * b1 */ 
</span> 
        <span class='Comment_Multi_Line'>/* Subtract out t1 and t2 to get the inner product */ 
</span>        <a href="imath.c.html#LN214"><span class='Ref_to_Proto'>s_usub</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2570"><span class='Ref_To_Local'>t3</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2568"><span class='Ref_To_Local'>t1</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2570"><span class='Ref_To_Local'>t3</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2578"><span class='Ref_To_Local'>buf_size</span></a> <span class='Operator'>+ </span><span class='Number'>2</span><span class='Delimiter'>, </span><a href="imath.c.html#LN2578"><span class='Ref_To_Local'>buf_size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN214"><span class='Ref_to_Proto'>s_usub</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2570"><span class='Ref_To_Local'>t3</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2569"><span class='Ref_To_Local'>t2</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2570"><span class='Ref_To_Local'>t3</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2578"><span class='Ref_To_Local'>buf_size</span></a> <span class='Operator'>+ </span><span class='Number'>2</span><span class='Delimiter'>, </span><a href="imath.c.html#LN2578"><span class='Ref_To_Local'>buf_size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Assemble the output value */ 
</span>        <a href="imath.c.html#LN119"><span class='Ref_to_Macro'>COPY</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2568"><span class='Ref_To_Local'>t1</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2540"><span class='Ref_to_Parameter'>dc</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2578"><span class='Ref_To_Local'>buf_size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN2571"><span class='Ref_To_Local'>carry</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN210"><span class='Ref_to_Proto'>s_uadd</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2570"><span class='Ref_To_Local'>t3</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2540"><span class='Ref_to_Parameter'>dc</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN2543"><span class='Ref_To_Local'>bot_size</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2540"><span class='Ref_to_Parameter'>dc</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN2543"><span class='Ref_To_Local'>bot_size</span></a><span class='Delimiter'>, 
</span>                       <a href="imath.c.html#LN2578"><span class='Ref_To_Local'>buf_size</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="imath.c.html#LN2578"><span class='Ref_To_Local'>buf_size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Debug'>assert</span><span class='Parentheses'>(</span><a href="imath.c.html#LN2571"><span class='Ref_To_Local'>carry</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="imath.c.html#LN2571"><span class='Ref_To_Local'>carry</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN210"><span class='Ref_to_Proto'>s_uadd</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2569"><span class='Ref_To_Local'>t2</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2540"><span class='Ref_to_Parameter'>dc</span></a> <span class='Operator'>+ </span><span class='Number'>2</span> <span class='Operator'>* </span><a href="imath.c.html#LN2543"><span class='Ref_To_Local'>bot_size</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2540"><span class='Ref_to_Parameter'>dc</span></a> <span class='Operator'>+ </span><span class='Number'>2</span> <span class='Operator'>* </span><a href="imath.c.html#LN2543"><span class='Ref_To_Local'>bot_size</span></a><span class='Delimiter'>, 
</span>                       <a href="imath.c.html#LN2578"><span class='Ref_To_Local'>buf_size</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2578"><span class='Ref_To_Local'>buf_size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Debug'>assert</span><span class='Parentheses'>(</span><a href="imath.c.html#LN2571"><span class='Ref_To_Local'>carry</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="imath.c.html#LN179"><span class='Ref_to_Proto'>s_free</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2568"><span class='Ref_To_Local'>t1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>             <span class='Comment_Multi_Line'>/* note t2 and t3 are just internal pointers 
                                 * to t1 */ 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if multiply_threshold&&s... &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN222"><span class='Ref_to_Proto'>s_umul</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2540"><span class='Ref_to_Parameter'>da</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2540"><span class='Ref_to_Parameter'>db</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2540"><span class='Ref_to_Parameter'>dc</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2541"><span class='Ref_to_Parameter'>size_a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2541"><span class='Ref_to_Parameter'>size_b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end s_kmul &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_umul(da, db, dc, size_a, size_b) */ 
</span> 
<span class='Keyword'>static void 
</span><a name="LN2643"></a><span class='Declare_Function'>s_umul</span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>da</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>db</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dc</span><span class='Delimiter'>, 
</span><a name="LN2644"></a>       <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>size_a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>size_b</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2646"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>a</span><span class='Delimiter'>, 
</span><a name="LN2647"></a>                <span class='Declare_Local'>b</span><span class='Delimiter'>; 
</span><a name="LN2648"></a>    <a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a>     <span class='Declare_Local'>w</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2646"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="imath.c.html#LN2646"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&LT; </span><a href="imath.c.html#LN2644"><span class='Ref_to_Parameter'>size_a</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="imath.c.html#LN2646"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><span class='Operator'>++</span><a href="imath.c.html#LN2643"><span class='Ref_to_Parameter'>dc</span></a><span class='Delimiter'>, </span><span class='Operator'>++</span><a href="imath.c.html#LN2643"><span class='Ref_to_Parameter'>da</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2652"></a>        <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>dct</span> <span class='Operator'>= </span><a href="imath.c.html#LN2643"><span class='Ref_to_Parameter'>dc</span></a><span class='Delimiter'>; 
</span><a name="LN2653"></a>        <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>dbt</span> <span class='Operator'>= </span><a href="imath.c.html#LN2643"><span class='Ref_to_Parameter'>db</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="imath.c.html#LN2643"><span class='Ref_to_Parameter'>da</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
        <a href="imath.c.html#LN2648"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2647"><span class='Ref_To_Local'>b</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="imath.c.html#LN2647"><span class='Ref_To_Local'>b</span></a> <span class='Operator'>&LT; </span><a href="imath.c.html#LN2644"><span class='Ref_to_Parameter'>size_b</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="imath.c.html#LN2647"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><span class='Operator'>++</span><a href="imath.c.html#LN2653"><span class='Ref_To_Local'>dbt</span></a><span class='Delimiter'>, </span><span class='Operator'>++</span><a href="imath.c.html#LN2652"><span class='Ref_To_Local'>dct</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="imath.c.html#LN2648"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="imath.c.html#LN2643"><span class='Ref_to_Parameter'>da</span></a> <span class='Operator'>* </span><span class='Parentheses'>(</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="imath.c.html#LN2653"><span class='Ref_To_Local'>dbt</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN2648"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>+ </span><span class='Parentheses'>(</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="imath.c.html#LN2652"><span class='Ref_To_Local'>dct</span></a><span class='Delimiter'>; 
</span> 
            <span class='Operator'>*</span><a href="imath.c.html#LN2652"><span class='Ref_To_Local'>dct</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN159"><span class='Ref_to_Macro'>LOWER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2648"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN2648"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN158"><span class='Ref_to_Macro'>UPPER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2648"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Operator'>*</span><a href="imath.c.html#LN2652"><span class='Ref_To_Local'>dct</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN2648"><span class='Ref_To_Local'>w</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end s_umul &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_ksqr(da, dc, size_a) */ 
</span> 
<span class='Keyword'>static int 
</span><a name="LN2676"></a><span class='Declare_Function'>s_ksqr</span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>da</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dc</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>size_a</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN169"><span class='Ref_to_Global_Var'>multiply_threshold</span></a> <span class='Operator'>&& </span><a href="imath.c.html#LN2676"><span class='Ref_to_Parameter'>size_a</span></a> <span class='Operator'>&GT; </span><a href="imath.c.html#LN169"><span class='Ref_to_Global_Var'>multiply_threshold</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2680"></a>        <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>bot_size</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.c.html#LN2676"><span class='Ref_to_Parameter'>size_a</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>/ </span><span class='Number'>2</span><span class='Delimiter'>; 
</span><a name="LN2681"></a>        <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>a_top</span> <span class='Operator'>= </span><a href="imath.c.html#LN2676"><span class='Ref_to_Parameter'>da</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN2680"><span class='Ref_To_Local'>bot_size</span></a><span class='Delimiter'>; 
</span><a name="LN2682"></a>        <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>t1</span><span class='Delimiter'>, 
</span><a name="LN2683"></a>                   <span class='Operator'>*</span><span class='Declare_Local'>t2</span><span class='Delimiter'>, 
</span><a name="LN2684"></a>                   <span class='Operator'>*</span><span class='Declare_Local'>t3</span><span class='Delimiter'>; 
</span><a name="LN2685"></a>        <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>at_size</span> <span class='Operator'>= </span><a href="imath.c.html#LN2676"><span class='Ref_to_Parameter'>size_a</span></a> <span class='Operator'>- </span><a href="imath.c.html#LN2680"><span class='Ref_To_Local'>bot_size</span></a><span class='Delimiter'>; 
</span><a name="LN2686"></a>        <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>buf_size</span> <span class='Operator'>= </span><span class='Number'>2</span> <span class='Operator'>* </span><a href="imath.c.html#LN2680"><span class='Ref_To_Local'>bot_size</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN2682"><span class='Ref_To_Local'>t1</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN176"><span class='Ref_to_Proto'>s_alloc</span></a><span class='Parentheses'>(</span><span class='Number'>4</span> <span class='Operator'>* </span><a href="imath.c.html#LN2686"><span class='Ref_To_Local'>buf_size</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN2683"><span class='Ref_To_Local'>t2</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2682"><span class='Ref_To_Local'>t1</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN2686"><span class='Ref_To_Local'>buf_size</span></a><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN2684"><span class='Ref_To_Local'>t3</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2683"><span class='Ref_To_Local'>t2</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN2686"><span class='Ref_To_Local'>buf_size</span></a><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN115"><span class='Ref_to_Macro'>ZERO</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2682"><span class='Ref_To_Local'>t1</span></a><span class='Delimiter'>, </span><span class='Number'>4</span> <span class='Operator'>* </span><a href="imath.c.html#LN2686"><span class='Ref_To_Local'>buf_size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="imath.c.html#LN226"><span class='Ref_to_Proto'>s_ksqr</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2676"><span class='Ref_to_Parameter'>da</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2682"><span class='Ref_To_Local'>t1</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2680"><span class='Ref_To_Local'>bot_size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* t1 = a0 ^ 2 */ 
</span>        <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="imath.c.html#LN226"><span class='Ref_to_Proto'>s_ksqr</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2681"><span class='Ref_To_Local'>a_top</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2683"><span class='Ref_To_Local'>t2</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2685"><span class='Ref_To_Local'>at_size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>      <span class='Comment_Single_Line'>/* t2 = a1 ^ 2 */ 
</span> 
        <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="imath.c.html#LN218"><span class='Ref_to_Proto'>s_kmul</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2676"><span class='Ref_to_Parameter'>da</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2681"><span class='Ref_To_Local'>a_top</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2684"><span class='Ref_To_Local'>t3</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2680"><span class='Ref_To_Local'>bot_size</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2685"><span class='Ref_To_Local'>at_size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* t3 = a0 * a1 */ 
</span> 
        <span class='Comment_Multi_Line'>/* Quick multiply t3 by 2, shifting left (can't overflow) */ 
</span>        <span class='Delimiter'>{ 
</span><a name="LN2701"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>, 
</span><a name="LN2702"></a>                        <span class='Declare_Local'>top</span> <span class='Operator'>= </span><a href="imath.c.html#LN2680"><span class='Ref_To_Local'>bot_size</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN2685"><span class='Ref_To_Local'>at_size</span></a><span class='Delimiter'>; 
</span><a name="LN2703"></a>            <a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a>     <span class='Declare_Local'>w</span><span class='Delimiter'>, 
</span><a name="LN2704"></a>                        <span class='Declare_Local'>save</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2701"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="imath.c.html#LN2701"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="imath.c.html#LN2702"><span class='Ref_To_Local'>top</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="imath.c.html#LN2701"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="imath.c.html#LN2703"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2684"><span class='Ref_To_Local'>t3</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN2701"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>                <a href="imath.c.html#LN2703"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.c.html#LN2703"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>| </span><a href="imath.c.html#LN2704"><span class='Ref_To_Local'>save</span></a><span class='Delimiter'>; 
</span>                <a href="imath.c.html#LN2684"><span class='Ref_To_Local'>t3</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN2701"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="imath.c.html#LN159"><span class='Ref_to_Macro'>LOWER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2703"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="imath.c.html#LN2704"><span class='Ref_To_Local'>save</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN158"><span class='Ref_to_Macro'>UPPER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2703"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <a href="imath.c.html#LN2684"><span class='Ref_To_Local'>t3</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN2701"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="imath.c.html#LN159"><span class='Ref_to_Macro'>LOWER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2704"><span class='Ref_To_Local'>save</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* Assemble the output value */ 
</span>        <a href="imath.c.html#LN119"><span class='Ref_to_Macro'>COPY</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2682"><span class='Ref_To_Local'>t1</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2676"><span class='Ref_to_Parameter'>dc</span></a><span class='Delimiter'>, </span><span class='Number'>2</span> <span class='Operator'>* </span><a href="imath.c.html#LN2680"><span class='Ref_To_Local'>bot_size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="imath.c.html#LN210"><span class='Ref_to_Proto'>s_uadd</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2684"><span class='Ref_To_Local'>t3</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2676"><span class='Ref_to_Parameter'>dc</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN2680"><span class='Ref_To_Local'>bot_size</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2676"><span class='Ref_to_Parameter'>dc</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN2680"><span class='Ref_To_Local'>bot_size</span></a><span class='Delimiter'>, 
</span>                      <a href="imath.c.html#LN2686"><span class='Ref_To_Local'>buf_size</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="imath.c.html#LN2686"><span class='Ref_To_Local'>buf_size</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="imath.c.html#LN210"><span class='Ref_to_Proto'>s_uadd</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2683"><span class='Ref_To_Local'>t2</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2676"><span class='Ref_to_Parameter'>dc</span></a> <span class='Operator'>+ </span><span class='Number'>2</span> <span class='Operator'>* </span><a href="imath.c.html#LN2680"><span class='Ref_To_Local'>bot_size</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2676"><span class='Ref_to_Parameter'>dc</span></a> <span class='Operator'>+ </span><span class='Number'>2</span> <span class='Operator'>* </span><a href="imath.c.html#LN2680"><span class='Ref_To_Local'>bot_size</span></a><span class='Delimiter'>, 
</span>                      <a href="imath.c.html#LN2686"><span class='Ref_To_Local'>buf_size</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2686"><span class='Ref_To_Local'>buf_size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="px.h.html#LN45"><span class='Ref_to_Macro'>px_free</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2682"><span class='Ref_To_Local'>t1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>            <span class='Comment_Multi_Line'>/* note that t2 and t2 are internal pointers 
                                 * only */ 
</span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if multiply_threshold&&s... &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN229"><span class='Ref_to_Proto'>s_usqr</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2676"><span class='Ref_to_Parameter'>da</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2676"><span class='Ref_to_Parameter'>dc</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2676"><span class='Ref_to_Parameter'>size_a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end s_ksqr &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_usqr(da, dc, size_a) */ 
</span> 
<span class='Keyword'>static void 
</span><a name="LN2741"></a><span class='Declare_Function'>s_usqr</span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>da</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dc</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>size_a</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2743"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>i</span><span class='Delimiter'>, 
</span><a name="LN2744"></a>                <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span><a name="LN2745"></a>    <a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a>     <span class='Declare_Local'>w</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2743"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="imath.c.html#LN2743"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="imath.c.html#LN2741"><span class='Ref_to_Parameter'>size_a</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="imath.c.html#LN2743"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2741"><span class='Ref_to_Parameter'>dc</span></a> <span class='Operator'>+= </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Operator'>++</span><a href="imath.c.html#LN2741"><span class='Ref_to_Parameter'>da</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2749"></a>        <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>dct</span> <span class='Operator'>= </span><a href="imath.c.html#LN2741"><span class='Ref_to_Parameter'>dc</span></a><span class='Delimiter'>, 
</span><a name="LN2750"></a>                   <span class='Operator'>*</span><span class='Declare_Local'>dat</span> <span class='Operator'>= </span><a href="imath.c.html#LN2741"><span class='Ref_to_Parameter'>da</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="imath.c.html#LN2741"><span class='Ref_to_Parameter'>da</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Take care of the first digit, no rollover */ 
</span>        <a href="imath.c.html#LN2745"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="imath.c.html#LN2750"><span class='Ref_To_Local'>dat</span></a> <span class='Operator'>* </span><span class='Parentheses'>(</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="imath.c.html#LN2750"><span class='Ref_To_Local'>dat</span></a> <span class='Operator'>+ </span><span class='Parentheses'>(</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="imath.c.html#LN2749"><span class='Ref_To_Local'>dct</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="imath.c.html#LN2749"><span class='Ref_To_Local'>dct</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN159"><span class='Ref_to_Macro'>LOWER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2745"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN2745"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN158"><span class='Ref_to_Macro'>UPPER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2745"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Operator'>++</span><a href="imath.c.html#LN2750"><span class='Ref_To_Local'>dat</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>++</span><a href="imath.c.html#LN2749"><span class='Ref_To_Local'>dct</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2744"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2743"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; </span><a href="imath.c.html#LN2744"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><a href="imath.c.html#LN2741"><span class='Ref_to_Parameter'>size_a</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="imath.c.html#LN2744"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>, </span><span class='Operator'>++</span><a href="imath.c.html#LN2750"><span class='Ref_To_Local'>dat</span></a><span class='Delimiter'>, </span><span class='Operator'>++</span><a href="imath.c.html#LN2749"><span class='Ref_To_Local'>dct</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN2764"></a>            <a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a>     <span class='Declare_Local'>t</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="imath.c.html#LN2741"><span class='Ref_to_Parameter'>da</span></a> <span class='Operator'>* </span><span class='Parentheses'>(</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="imath.c.html#LN2750"><span class='Ref_To_Local'>dat</span></a><span class='Delimiter'>; 
</span><a name="LN2765"></a>            <a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a>     <span class='Declare_Local'>u</span> <span class='Operator'>= </span><a href="imath.c.html#LN2745"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>+ </span><span class='Parentheses'>(</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="imath.c.html#LN2749"><span class='Ref_To_Local'>dct</span></a><span class='Delimiter'>, 
</span><a name="LN2766"></a>                        <span class='Declare_Local'>ov</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Check if doubling t will overflow a word */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN160"><span class='Ref_to_Macro'>HIGH_BIT_SET</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2764"><span class='Ref_To_Local'>t</span></a><span class='Parentheses'>))</span> 
                <a href="imath.c.html#LN2766"><span class='Ref_To_Local'>ov</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
            <a href="imath.c.html#LN2745"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2764"><span class='Ref_To_Local'>t</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN2764"><span class='Ref_To_Local'>t</span></a><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Check if adding u to w will overflow a word */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN161"><span class='Ref_to_Macro'>ADD_WILL_OVERFLOW</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2745"><span class='Ref_To_Local'>w</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2765"><span class='Ref_To_Local'>u</span></a><span class='Parentheses'>))</span> 
                <a href="imath.c.html#LN2766"><span class='Ref_To_Local'>ov</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
            <a href="imath.c.html#LN2745"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>+= </span><a href="imath.c.html#LN2765"><span class='Ref_To_Local'>u</span></a><span class='Delimiter'>; 
</span> 
            <span class='Operator'>*</span><a href="imath.c.html#LN2749"><span class='Ref_To_Local'>dct</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN159"><span class='Ref_to_Macro'>LOWER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2745"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN2745"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN158"><span class='Ref_to_Macro'>UPPER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2745"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2766"><span class='Ref_To_Local'>ov</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="imath.c.html#LN2745"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>+= </span><a href="imath.h.html#LN46"><span class='Ref_to_Const'>MP_DIGIT_MAX</span></a><span class='Delimiter'>;</span>      <span class='Comment_Single_Line'>/* MP_RADIX */ 
</span>                <span class='Operator'>++</span><a href="imath.c.html#LN2745"><span class='Ref_To_Local'>w</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for j=i+1;j&LT;size_a;++j,++... &raquo; </span> 
 
        <a href="imath.c.html#LN2745"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2745"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>+ *</span><a href="imath.c.html#LN2749"><span class='Ref_To_Local'>dct</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="imath.c.html#LN2749"><span class='Ref_To_Local'>dct</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN2745"><span class='Ref_To_Local'>w</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>while</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN2745"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN158"><span class='Ref_to_Macro'>UPPER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2745"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Operator'>++</span><a href="imath.c.html#LN2749"><span class='Ref_To_Local'>dct</span></a><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN2745"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2745"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>+ *</span><a href="imath.c.html#LN2749"><span class='Ref_To_Local'>dct</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="imath.c.html#LN2749"><span class='Ref_To_Local'>dct</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN159"><span class='Ref_to_Macro'>LOWER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2745"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Debug'>assert</span><span class='Parentheses'>(</span><a href="imath.c.html#LN2745"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=0;i&LT;size_a;++i,dc+=... &raquo; </span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end s_usqr &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_dadd(a, b) */ 
</span> 
<span class='Keyword'>static void 
</span><a name="LN2807"></a><span class='Declare_Function'>s_dadd</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Declare_Parameter'>b</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2809"></a>    <a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a>     <span class='Declare_Local'>w</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN2810"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>da</span> <span class='Operator'>= </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2807"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2811"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>ua</span> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2807"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN2809"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="imath.c.html#LN2810"><span class='Ref_To_Local'>da</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN2807"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="imath.c.html#LN2810"><span class='Ref_To_Local'>da</span></a><span class='Operator'>++ = </span><a href="imath.c.html#LN159"><span class='Ref_to_Macro'>LOWER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2809"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN2809"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN158"><span class='Ref_to_Macro'>UPPER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2809"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2811"><span class='Ref_To_Local'>ua</span></a> <span class='Operator'>-= </span><span class='Number'>1</span><span class='Delimiter'>; </span><a href="imath.c.html#LN2811"><span class='Ref_To_Local'>ua</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Delimiter'>; </span><span class='Operator'>--</span><a href="imath.c.html#LN2811"><span class='Ref_To_Local'>ua</span></a><span class='Delimiter'>, </span><span class='Operator'>++</span><a href="imath.c.html#LN2810"><span class='Ref_To_Local'>da</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN2809"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="imath.c.html#LN2810"><span class='Ref_To_Local'>da</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN2809"><span class='Ref_To_Local'>w</span></a><span class='Delimiter'>; 
</span> 
        <span class='Operator'>*</span><a href="imath.c.html#LN2810"><span class='Ref_To_Local'>da</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN159"><span class='Ref_to_Macro'>LOWER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2809"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN2809"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN158"><span class='Ref_to_Macro'>UPPER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2809"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2809"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Operator'>*</span><a href="imath.c.html#LN2810"><span class='Ref_To_Local'>da</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN2809"><span class='Ref_To_Local'>w</span></a><span class='Delimiter'>; 
</span>        <a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2807"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>+= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end s_dadd &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_dmul(a, b) */ 
</span> 
<span class='Keyword'>static void 
</span><a name="LN2837"></a><span class='Declare_Function'>s_dmul</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Declare_Parameter'>b</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2839"></a>    <a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a>     <span class='Declare_Local'>w</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN2840"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>da</span> <span class='Operator'>= </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2837"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2841"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>ua</span> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2837"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2841"><span class='Ref_To_Local'>ua</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN2839"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="imath.c.html#LN2840"><span class='Ref_To_Local'>da</span></a> <span class='Operator'>* </span><a href="imath.c.html#LN2837"><span class='Ref_to_Parameter'>b</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN2839"><span class='Ref_To_Local'>w</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="imath.c.html#LN2840"><span class='Ref_To_Local'>da</span></a><span class='Operator'>++ = </span><a href="imath.c.html#LN159"><span class='Ref_to_Macro'>LOWER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2839"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN2839"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN158"><span class='Ref_to_Macro'>UPPER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2839"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Operator'>--</span><a href="imath.c.html#LN2841"><span class='Ref_To_Local'>ua</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2839"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Operator'>*</span><a href="imath.c.html#LN2840"><span class='Ref_To_Local'>da</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN2839"><span class='Ref_To_Local'>w</span></a><span class='Delimiter'>; 
</span>        <a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2837"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>+= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end s_dmul &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_dbmul(da, b, dc, size_a) */ 
</span> 
<span class='Keyword'>static void 
</span><a name="LN2863"></a><span class='Declare_Function'>s_dbmul</span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>da</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Declare_Parameter'>b</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dc</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>size_a</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2865"></a>    <a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a>     <span class='Declare_Local'>w</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2863"><span class='Ref_to_Parameter'>size_a</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN2865"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="imath.c.html#LN2863"><span class='Ref_to_Parameter'>da</span></a><span class='Operator'>++ * </span><span class='Parentheses'>(</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN2863"><span class='Ref_to_Parameter'>b</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN2865"><span class='Ref_To_Local'>w</span></a><span class='Delimiter'>; 
</span> 
        <span class='Operator'>*</span><a href="imath.c.html#LN2863"><span class='Ref_to_Parameter'>dc</span></a><span class='Operator'>++ = </span><a href="imath.c.html#LN159"><span class='Ref_to_Macro'>LOWER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2865"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN2865"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN158"><span class='Ref_to_Macro'>UPPER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2865"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Operator'>--</span><a href="imath.c.html#LN2863"><span class='Ref_to_Parameter'>size_a</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2865"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="imath.c.html#LN2863"><span class='Ref_to_Parameter'>dc</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN159"><span class='Ref_to_Macro'>LOWER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2865"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_ddiv(da, d, dc, size_a) */ 
</span> 
<span class='Keyword'>static </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> 
<a name="LN2885"></a><span class='Declare_Function'>s_ddiv</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a> <span class='Declare_Parameter'>b</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2887"></a>    <a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a>     <span class='Declare_Local'>w</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>, 
</span><a name="LN2888"></a>                <span class='Declare_Local'>qdigit</span><span class='Delimiter'>; 
</span><a name="LN2889"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>ua</span> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2885"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2890"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>da</span> <span class='Operator'>= </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2885"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="imath.c.html#LN2889"><span class='Ref_To_Local'>ua</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>( </span><span class='Comment_Multi_Line'>/* */ </span><span class='Delimiter'>; </span><a href="imath.c.html#LN2889"><span class='Ref_To_Local'>ua</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Delimiter'>; </span><span class='Operator'>--</span><a href="imath.c.html#LN2889"><span class='Ref_To_Local'>ua</span></a><span class='Delimiter'>, </span><span class='Operator'>--</span><a href="imath.c.html#LN2890"><span class='Ref_To_Local'>da</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN2887"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.c.html#LN2887"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>&LT;&LT; </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a><span class='Parentheses'>) </span><span class='Operator'>| *</span><a href="imath.c.html#LN2890"><span class='Ref_To_Local'>da</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2887"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>&GT;= </span><a href="imath.c.html#LN2885"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="imath.c.html#LN2888"><span class='Ref_To_Local'>qdigit</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2887"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>/ </span><a href="imath.c.html#LN2885"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN2887"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2887"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>% </span><a href="imath.c.html#LN2885"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="imath.c.html#LN2888"><span class='Ref_To_Local'>qdigit</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Operator'>*</span><a href="imath.c.html#LN2890"><span class='Ref_To_Local'>da</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN2888"><span class='Ref_To_Local'>qdigit</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="imath.c.html#LN128"><span class='Ref_to_Macro'>CLAMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2885"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN2887"><span class='Ref_To_Local'>w</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end s_ddiv &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_qdiv(z, p2) */ 
</span> 
<span class='Keyword'>static void 
</span><a name="LN2918"></a><span class='Declare_Function'>s_qdiv</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>p2</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2920"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>ndig</span> <span class='Operator'>= </span><a href="imath.c.html#LN2918"><span class='Ref_to_Parameter'>p2</span></a> <span class='Operator'>/ </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a><span class='Delimiter'>, 
</span><a name="LN2921"></a>                <span class='Declare_Local'>nbits</span> <span class='Operator'>= </span><a href="imath.c.html#LN2918"><span class='Ref_to_Parameter'>p2</span></a> <span class='Operator'>% </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a><span class='Delimiter'>; 
</span><a name="LN2922"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>uz</span> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2918"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2920"><span class='Ref_To_Local'>ndig</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2926"></a>        <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>mark</span><span class='Delimiter'>; 
</span><a name="LN2927"></a>        <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>to</span><span class='Delimiter'>, 
</span><a name="LN2928"></a>                   <span class='Operator'>*</span><span class='Declare_Local'>from</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2920"><span class='Ref_To_Local'>ndig</span></a> <span class='Operator'>&GT;= </span><a href="imath.c.html#LN2922"><span class='Ref_To_Local'>uz</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="imath.h.html#LN107"><span class='Ref_to_Proto'>mp_int_zero</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2918"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="imath.c.html#LN2927"><span class='Ref_To_Local'>to</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2918"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN2928"><span class='Ref_To_Local'>from</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2927"><span class='Ref_To_Local'>to</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN2920"><span class='Ref_To_Local'>ndig</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2926"><span class='Ref_To_Local'>mark</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2920"><span class='Ref_To_Local'>ndig</span></a><span class='Delimiter'>; </span><a href="imath.c.html#LN2926"><span class='Ref_To_Local'>mark</span></a> <span class='Operator'>&LT; </span><a href="imath.c.html#LN2922"><span class='Ref_To_Local'>uz</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="imath.c.html#LN2926"><span class='Ref_To_Local'>mark</span></a><span class='Parentheses'>) 
</span>            <span class='Operator'>*</span><a href="imath.c.html#LN2927"><span class='Ref_To_Local'>to</span></a><span class='Operator'>++ = *</span><a href="imath.c.html#LN2928"><span class='Ref_To_Local'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span> 
        <a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2918"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN2922"><span class='Ref_To_Local'>uz</span></a> <span class='Operator'>- </span><a href="imath.c.html#LN2920"><span class='Ref_To_Local'>ndig</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if ndig &raquo; </span> 
 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2921"><span class='Ref_To_Local'>nbits</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2947"></a>        <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>    <span class='Declare_Local'>d</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>, 
</span><a name="LN2948"></a>                   <span class='Operator'>*</span><span class='Declare_Local'>dz</span><span class='Delimiter'>, 
</span><a name="LN2949"></a>                    <span class='Declare_Local'>save</span><span class='Delimiter'>; 
</span><a name="LN2950"></a>        <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>up</span> <span class='Operator'>= </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a> <span class='Operator'>- </span><a href="imath.c.html#LN2921"><span class='Ref_To_Local'>nbits</span></a><span class='Delimiter'>; 
</span> 
        <a href="imath.c.html#LN2922"><span class='Ref_To_Local'>uz</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2918"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN2948"><span class='Ref_To_Local'>dz</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2918"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="imath.c.html#LN2922"><span class='Ref_To_Local'>uz</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>for</span> <span class='Parentheses'>( </span><span class='Comment_Multi_Line'>/* */ </span><span class='Delimiter'>; </span><a href="imath.c.html#LN2922"><span class='Ref_To_Local'>uz</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Delimiter'>; </span><span class='Operator'>--</span><a href="imath.c.html#LN2922"><span class='Ref_To_Local'>uz</span></a><span class='Delimiter'>, </span><span class='Operator'>--</span><a href="imath.c.html#LN2948"><span class='Ref_To_Local'>dz</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="imath.c.html#LN2949"><span class='Ref_To_Local'>save</span></a> <span class='Operator'>= *</span><a href="imath.c.html#LN2948"><span class='Ref_To_Local'>dz</span></a><span class='Delimiter'>; 
</span> 
            <span class='Operator'>*</span><a href="imath.c.html#LN2948"><span class='Ref_To_Local'>dz</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="imath.c.html#LN2948"><span class='Ref_To_Local'>dz</span></a> <span class='Operator'>&GT;&GT; </span><a href="imath.c.html#LN2921"><span class='Ref_To_Local'>nbits</span></a><span class='Parentheses'>) </span><span class='Operator'>| </span><span class='Parentheses'>(</span><a href="imath.c.html#LN2947"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>&LT;&LT; </span><a href="imath.c.html#LN2950"><span class='Ref_To_Local'>up</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN2947"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2949"><span class='Ref_To_Local'>save</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="imath.c.html#LN128"><span class='Ref_to_Macro'>CLAMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2918"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if nbits &raquo; </span> 
 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2918"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>1</span> <span class='Operator'>&& </span><a href="imath.c.html#LN2918"><span class='Ref_to_Parameter'>z</span></a><span class='Operator'>-&GT;</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2918"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end s_qdiv &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_qmod(z, p2) */ 
</span> 
<span class='Keyword'>static void 
</span><a name="LN2975"></a><span class='Declare_Function'>s_qmod</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>p2</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2977"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>start</span> <span class='Operator'>= </span><a href="imath.c.html#LN2975"><span class='Ref_to_Parameter'>p2</span></a> <span class='Operator'>/ </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>, 
</span><a name="LN2978"></a>                <span class='Declare_Local'>rest</span> <span class='Operator'>= </span><a href="imath.c.html#LN2975"><span class='Ref_to_Parameter'>p2</span></a> <span class='Operator'>% </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a><span class='Delimiter'>; 
</span><a name="LN2979"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>uz</span> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2975"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2980"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>    <span class='Declare_Local'>mask</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Number'>1</span> <span class='Operator'>&LT;&LT; </span><a href="imath.c.html#LN2978"><span class='Ref_To_Local'>rest</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2977"><span class='Ref_To_Local'>start</span></a> <span class='Operator'>&LT;= </span><a href="imath.c.html#LN2979"><span class='Ref_To_Local'>uz</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2975"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN2977"><span class='Ref_To_Local'>start</span></a><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN2975"><span class='Ref_to_Parameter'>z</span></a><span class='Operator'>-&GT;</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN2977"><span class='Ref_To_Local'>start</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>&= </span><a href="imath.c.html#LN2980"><span class='Ref_To_Local'>mask</span></a><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN128"><span class='Ref_to_Macro'>CLAMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2975"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_qmul(z, p2) */ 
</span> 
<span class='Keyword'>static int 
</span><a name="LN2995"></a><span class='Declare_Function'>s_qmul</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>p2</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2997"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>uz</span><span class='Delimiter'>, 
</span><a name="LN2998"></a>                <span class='Declare_Local'>need</span><span class='Delimiter'>, 
</span><a name="LN2999"></a>                <span class='Declare_Local'>rest</span><span class='Delimiter'>, 
</span><a name="LN3000"></a>                <span class='Declare_Local'>extra</span><span class='Delimiter'>, 
</span><a name="LN3001"></a>                <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN3002"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>from</span><span class='Delimiter'>, 
</span><a name="LN3003"></a>               <span class='Operator'>*</span><span class='Declare_Local'>to</span><span class='Delimiter'>, 
</span><a name="LN3004"></a>                <span class='Declare_Local'>d</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2995"><span class='Ref_to_Parameter'>p2</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN2997"><span class='Ref_To_Local'>uz</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2995"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN2998"><span class='Ref_To_Local'>need</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2995"><span class='Ref_to_Parameter'>p2</span></a> <span class='Operator'>/ </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN2999"><span class='Ref_To_Local'>rest</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2995"><span class='Ref_to_Parameter'>p2</span></a> <span class='Operator'>% </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Figure out if we need an extra digit at the top end; this occurs if the 
     * topmost `rest' bits of the high-order digit of z are not zero, meaning 
     * they will be shifted off the end if not preserved 
     */ 
</span>    <a href="imath.c.html#LN3000"><span class='Ref_To_Local'>extra</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2999"><span class='Ref_To_Local'>rest</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3021"></a>        <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>dz</span> <span class='Operator'>= </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2995"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="imath.c.html#LN2997"><span class='Ref_To_Local'>uz</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>*</span><a href="imath.c.html#LN3021"><span class='Ref_To_Local'>dz</span></a> <span class='Operator'>&GT;&GT; </span><span class='Parentheses'>(</span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a> <span class='Operator'>- </span><a href="imath.c.html#LN2999"><span class='Ref_To_Local'>rest</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="imath.c.html#LN3000"><span class='Ref_To_Local'>extra</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="imath.c.html#LN186"><span class='Ref_to_Proto'>s_pad</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2995"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN2997"><span class='Ref_To_Local'>uz</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN2998"><span class='Ref_To_Local'>need</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN3000"><span class='Ref_To_Local'>extra</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If we need to shift by whole digits, do that in one pass, then to back 
     * and shift by partial digits. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2998"><span class='Ref_To_Local'>need</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN3002"><span class='Ref_To_Local'>from</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2995"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="imath.c.html#LN2997"><span class='Ref_To_Local'>uz</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN3003"><span class='Ref_To_Local'>to</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN3002"><span class='Ref_To_Local'>from</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN2998"><span class='Ref_To_Local'>need</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3001"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="imath.c.html#LN3001"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="imath.c.html#LN2997"><span class='Ref_To_Local'>uz</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="imath.c.html#LN3001"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>            <span class='Operator'>*</span><a href="imath.c.html#LN3003"><span class='Ref_To_Local'>to</span></a><span class='Operator'>-- = *</span><a href="imath.c.html#LN3002"><span class='Ref_To_Local'>from</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span> 
        <a href="imath.c.html#LN115"><span class='Ref_to_Macro'>ZERO</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2995"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN2998"><span class='Ref_To_Local'>need</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN2997"><span class='Ref_To_Local'>uz</span></a> <span class='Operator'>+= </span><a href="imath.c.html#LN2998"><span class='Ref_To_Local'>need</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN2999"><span class='Ref_To_Local'>rest</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN3004"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3001"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN2998"><span class='Ref_To_Local'>need</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3002"><span class='Ref_To_Local'>from</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2995"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="imath.c.html#LN2998"><span class='Ref_To_Local'>need</span></a><span class='Delimiter'>; </span><a href="imath.c.html#LN3001"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="imath.c.html#LN2997"><span class='Ref_To_Local'>uz</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="imath.c.html#LN3001"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>, </span><span class='Operator'>++</span><a href="imath.c.html#LN3002"><span class='Ref_To_Local'>from</span></a><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span><a name="LN3051"></a>            <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>    <span class='Declare_Local'>save</span> <span class='Operator'>= *</span><a href="imath.c.html#LN3002"><span class='Ref_To_Local'>from</span></a><span class='Delimiter'>; 
</span> 
            <span class='Operator'>*</span><a href="imath.c.html#LN3002"><span class='Ref_To_Local'>from</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="imath.c.html#LN3002"><span class='Ref_To_Local'>from</span></a> <span class='Operator'>&LT;&LT; </span><a href="imath.c.html#LN2999"><span class='Ref_To_Local'>rest</span></a><span class='Parentheses'>) </span><span class='Operator'>| </span><span class='Parentheses'>(</span><a href="imath.c.html#LN3004"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>&GT;&GT; </span><span class='Parentheses'>(</span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a> <span class='Operator'>- </span><a href="imath.c.html#LN2999"><span class='Ref_To_Local'>rest</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN3004"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN3051"><span class='Ref_To_Local'>save</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="imath.c.html#LN3004"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>&GT;&GT;= </span><span class='Parentheses'>(</span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a> <span class='Operator'>- </span><a href="imath.c.html#LN2999"><span class='Ref_To_Local'>rest</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3004"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="imath.c.html#LN3002"><span class='Ref_To_Local'>from</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN3004"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN2997"><span class='Ref_To_Local'>uz</span></a> <span class='Operator'>+= </span><a href="imath.c.html#LN3000"><span class='Ref_To_Local'>extra</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2995"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN2997"><span class='Ref_To_Local'>uz</span></a><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN128"><span class='Ref_to_Macro'>CLAMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN2995"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end s_qmul &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_qsub(z, p2) */ 
</span> 
<span class='Comment_Multi_Line'>/* Subtract |z| from 2^p2, assuming 2^p2 &GT; |z|, and set z to be positive */ 
</span><span class='Keyword'>static int 
</span><a name="LN3077"></a><span class='Declare_Function'>s_qsub</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>p2</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3079"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>    <span class='Declare_Local'>hi</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Number'>1</span> <span class='Operator'>&LT;&LT; </span><span class='Parentheses'>(</span><a href="imath.c.html#LN3077"><span class='Ref_to_Parameter'>p2</span></a> <span class='Operator'>% </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, 
</span><a name="LN3080"></a>               <span class='Operator'>*</span><span class='Declare_Local'>zp</span><span class='Delimiter'>; 
</span><a name="LN3081"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>tdig</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.c.html#LN3077"><span class='Ref_to_Parameter'>p2</span></a> <span class='Operator'>/ </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span><a name="LN3082"></a>                <span class='Declare_Local'>pos</span><span class='Delimiter'>; 
</span><a name="LN3083"></a>    <a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a>     <span class='Declare_Local'>w</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="imath.c.html#LN186"><span class='Ref_to_Proto'>s_pad</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3077"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3081"><span class='Ref_To_Local'>tdig</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3082"><span class='Ref_To_Local'>pos</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="imath.c.html#LN3080"><span class='Ref_To_Local'>zp</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3077"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="imath.c.html#LN3082"><span class='Ref_To_Local'>pos</span></a> <span class='Operator'>&LT; </span><a href="imath.c.html#LN3081"><span class='Ref_To_Local'>tdig</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="imath.c.html#LN3082"><span class='Ref_To_Local'>pos</span></a><span class='Delimiter'>, </span><span class='Operator'>++</span><a href="imath.c.html#LN3080"><span class='Ref_To_Local'>zp</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN3083"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>) </span><a href="imath.h.html#LN46"><span class='Ref_to_Const'>MP_DIGIT_MAX</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>)</span> <span class='Operator'>- </span><a href="imath.c.html#LN3083"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>- </span><span class='Parentheses'>(</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="imath.c.html#LN3080"><span class='Ref_To_Local'>zp</span></a><span class='Delimiter'>; 
</span> 
        <span class='Operator'>*</span><a href="imath.c.html#LN3080"><span class='Ref_To_Local'>zp</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN159"><span class='Ref_to_Macro'>LOWER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3083"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN3083"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN158"><span class='Ref_to_Macro'>UPPER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3083"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='Number'>0</span> <span class='Operator'>: </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="imath.c.html#LN3083"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>) </span><a href="imath.h.html#LN46"><span class='Ref_to_Const'>MP_DIGIT_MAX</span></a> <span class='Operator'>+ </span><span class='Number'>1</span> <span class='Operator'>+ </span><a href="imath.c.html#LN3079"><span class='Ref_To_Local'>hi</span></a><span class='Parentheses'>)</span> <span class='Operator'>- </span><a href="imath.c.html#LN3083"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>- </span><span class='Parentheses'>(</span><a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="imath.c.html#LN3080"><span class='Ref_To_Local'>zp</span></a><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="imath.c.html#LN3080"><span class='Ref_To_Local'>zp</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN159"><span class='Ref_to_Macro'>LOWER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3083"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>assert</span><span class='Parentheses'>(</span><a href="imath.c.html#LN158"><span class='Ref_to_Macro'>UPPER_HALF</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3083"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; </span><span class='Comment_Single_Line'>/* no borrow out should be possible */ 
</span> 
    <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3077"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN128"><span class='Ref_to_Macro'>CLAMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3077"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end s_qsub &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_dp2k(z) */ 
</span> 
<span class='Keyword'>static int 
</span><a name="LN3112"></a><span class='Declare_Function'>s_dp2k</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3114"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>k</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN3115"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>dp</span> <span class='Operator'>= </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3112"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span><a name="LN3116"></a>                <span class='Declare_Local'>d</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3112"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>1</span> <span class='Operator'>&& *</span><a href="imath.c.html#LN3115"><span class='Ref_To_Local'>dp</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="imath.c.html#LN3115"><span class='Ref_To_Local'>dp</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN3114"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>+= </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>++</span><a href="imath.c.html#LN3115"><span class='Ref_To_Local'>dp</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="imath.c.html#LN3116"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= *</span><a href="imath.c.html#LN3115"><span class='Ref_To_Local'>dp</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN3116"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>& </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN3116"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>&GT;&GT;= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Operator'>++</span><a href="imath.c.html#LN3114"><span class='Ref_To_Local'>k</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN3114"><span class='Ref_To_Local'>k</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end s_dp2k &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_isp2(z) */ 
</span> 
<span class='Keyword'>static int 
</span><a name="LN3142"></a><span class='Declare_Function'>s_isp2</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3144"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>uz</span> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3142"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span><a name="LN3145"></a>                <span class='Declare_Local'>k</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN3146"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>dz</span> <span class='Operator'>= </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3142"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span><a name="LN3147"></a>                <span class='Declare_Local'>d</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3144"><span class='Ref_To_Local'>uz</span></a> <span class='Operator'>&GT; </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="imath.c.html#LN3146"><span class='Ref_To_Local'>dz</span></a><span class='Operator'>++ != </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN3145"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>+= </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>--</span><a href="imath.c.html#LN3144"><span class='Ref_To_Local'>uz</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="imath.c.html#LN3147"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= *</span><a href="imath.c.html#LN3146"><span class='Ref_To_Local'>dz</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3147"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>&GT; </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3147"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>& </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Operator'>++</span><a href="imath.c.html#LN3145"><span class='Ref_To_Local'>k</span></a><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN3147"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>&GT;&GT;= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="imath.c.html#LN3145"><span class='Ref_To_Local'>k</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end s_isp2 &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_2expt(z, k) */ 
</span> 
<span class='Keyword'>static int 
</span><a name="LN3174"></a><span class='Declare_Function'>s_2expt</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>k</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3176"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>ndig</span><span class='Delimiter'>, 
</span><a name="LN3177"></a>                <span class='Declare_Local'>rest</span><span class='Delimiter'>; 
</span><a name="LN3178"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>dz</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN3176"><span class='Ref_To_Local'>ndig</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.c.html#LN3174"><span class='Ref_to_Parameter'>k</span></a> <span class='Operator'>+ </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a><span class='Parentheses'>) </span><span class='Operator'>/ </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN3177"><span class='Ref_To_Local'>rest</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN3174"><span class='Ref_to_Parameter'>k</span></a> <span class='Operator'>% </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="imath.c.html#LN186"><span class='Ref_to_Proto'>s_pad</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3174"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3176"><span class='Ref_To_Local'>ndig</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN3178"><span class='Ref_To_Local'>dz</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3174"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN115"><span class='Ref_to_Macro'>ZERO</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3178"><span class='Ref_To_Local'>dz</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3176"><span class='Ref_To_Local'>ndig</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><span class='Parentheses'>(</span><a href="imath.c.html#LN3178"><span class='Ref_To_Local'>dz</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN3176"><span class='Ref_To_Local'>ndig</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Number'>1</span> <span class='Operator'>&LT;&LT; </span><a href="imath.c.html#LN3177"><span class='Ref_To_Local'>rest</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3174"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN3176"><span class='Ref_To_Local'>ndig</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end s_2expt &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_norm(a, b) */ 
</span> 
<span class='Keyword'>static int 
</span><a name="LN3199"></a><span class='Declare_Function'>s_norm</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>b</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3201"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>    <span class='Declare_Local'>d</span> <span class='Operator'>= </span><a href="imath.c.html#LN3199"><span class='Ref_to_Parameter'>b</span></a><span class='Operator'>-&GT;</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a><span class='Delimiter'>[</span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3199"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span><a name="LN3202"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>k</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3201"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>&LT; </span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a><span class='Parentheses'>)</span> <span class='Parentheses'>((</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a><span class='Parentheses'>) </span><span class='Number'>1</span> <span class='Operator'>&LT;&LT; </span><span class='Parentheses'>(</span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)))</span> 
    <span class='Delimiter'>{</span>                           <span class='Comment_Single_Line'>/* d &LT; (MP_RADIX / 2) */ 
</span>        <a href="imath.c.html#LN3201"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>&LT;&LT;= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Operator'>++</span><a href="imath.c.html#LN3202"><span class='Ref_To_Local'>k</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* These multiplications can't fail */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3202"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="imath.c.html#LN253"><span class='Ref_to_Proto'>s_qmul</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3199"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN3202"><span class='Ref_To_Local'>k</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="imath.c.html#LN253"><span class='Ref_to_Proto'>s_qmul</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3199"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN3202"><span class='Ref_To_Local'>k</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN3202"><span class='Ref_To_Local'>k</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end s_norm &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_brmu(z, m) */ 
</span> 
<span class='Keyword'>static </span><a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN3225"></a><span class='Declare_Function'>s_brmu</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>m</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3227"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>um</span> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3225"><span class='Ref_to_Parameter'>m</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><span class='Number'>2</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="imath.c.html#LN186"><span class='Ref_to_Proto'>s_pad</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3225"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3227"><span class='Ref_To_Local'>um</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN45"><span class='Ref_to_Global_Var'>MP_MEMORY</span></a><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN266"><span class='Ref_to_Proto'>s_2expt</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3225"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a> <span class='Operator'>* </span><a href="imath.c.html#LN3227"><span class='Ref_To_Local'>um</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="imath.h.html#LN119"><span class='Ref_to_Proto'>mp_int_div</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3225"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3225"><span class='Ref_to_Parameter'>m</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3225"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_reduce(x, m, mu, q1, q2) */ 
</span> 
<span class='Keyword'>static int 
</span><a name="LN3241"></a><span class='Declare_Function'>s_reduce</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>x</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>m</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>mu</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>q1</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>q2</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3243"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>um</span> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>m</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span><a name="LN3244"></a>                <span class='Declare_Local'>umb_p1</span><span class='Delimiter'>, 
</span><a name="LN3245"></a>                <span class='Declare_Local'>umb_m1</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN3244"><span class='Ref_To_Local'>umb_p1</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.c.html#LN3243"><span class='Ref_To_Local'>um</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN3245"><span class='Ref_To_Local'>umb_m1</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.c.html#LN3243"><span class='Ref_To_Local'>um</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>x</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>q1</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Compute q2 = floor((floor(x / b^(k-1)) * mu) / b^(k+1)) */ 
</span>    <a href="imath.c.html#LN246"><span class='Ref_to_Proto'>s_qdiv</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>q1</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3245"><span class='Ref_To_Local'>umb_m1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN148"><span class='Ref_to_Macro'>UMUL</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>q1</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>mu</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>q2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN246"><span class='Ref_to_Proto'>s_qdiv</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>q2</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3244"><span class='Ref_To_Local'>umb_p1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Set x = x mod b^(k+1) */ 
</span>    <a href="imath.c.html#LN249"><span class='Ref_to_Proto'>s_qmod</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>x</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3244"><span class='Ref_To_Local'>umb_p1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Now, q is a guess for the quotient a / m. Compute x - q * m mod 
     * b^(k+1), replacing x.  This may be off by a factor of 2m, but no more 
     * than that. 
     */ 
</span>    <a href="imath.c.html#LN148"><span class='Ref_to_Macro'>UMUL</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>q2</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>m</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>q1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN249"><span class='Ref_to_Proto'>s_qmod</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>q1</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3244"><span class='Ref_To_Local'>umb_p1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="imath.h.html#LN112"><span class='Ref_to_Proto'>mp_int_sub</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>x</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>q1</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* can't fail */ 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * The result may be &LT; 0; if it is, add b^(k+1) to pin it in the proper 
     * range. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN145"><span class='Ref_to_Macro'>CMPZ</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> <span class='Operator'>&& !</span><a href="imath.c.html#LN257"><span class='Ref_to_Proto'>s_qsub</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>x</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3244"><span class='Ref_To_Local'>umb_p1</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If x &GT; m, we need to back it off until it is in range. This will be 
     * required at most twice. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN131"><span class='Ref_to_Proto'>mp_int_compare</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>x</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>m</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="imath.h.html#LN112"><span class='Ref_to_Proto'>mp_int_sub</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>x</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>m</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN131"><span class='Ref_to_Proto'>mp_int_compare</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>x</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>m</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="imath.h.html#LN112"><span class='Ref_to_Proto'>mp_int_sub</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>x</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>m</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3241"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* At this point, x has been properly reduced. */ 
</span>    <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end s_reduce &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_embar(a, b, m, mu, c) */ 
</span> 
<span class='Comment_Multi_Line'>/* Perform modular exponentiation using Barrett's method, where mu is 
   the reduction constant for m.  Assumes a &LT; m, b &GT; 0. */ 
</span><span class='Keyword'>static </span><a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN3297"></a><span class='Declare_Function'>s_embar</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>b</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>m</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>mu</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3299"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>db</span><span class='Delimiter'>, 
</span><a name="LN3300"></a>               <span class='Operator'>*</span><span class='Declare_Local'>dbt</span><span class='Delimiter'>, 
</span><a name="LN3301"></a>                <span class='Declare_Local'>umu</span><span class='Delimiter'>, 
</span><a name="LN3302"></a>                <span class='Declare_Local'>d</span><span class='Delimiter'>; 
</span><a name="LN3303"></a>    <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mpz_t</span></a>       <span class='Declare_Local'>temp</span><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>]; 
</span><a name="LN3304"></a>    <a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a>   <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN3305"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>last</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN3301"><span class='Ref_To_Local'>umu</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3297"><span class='Ref_to_Parameter'>mu</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN3299"><span class='Ref_To_Local'>db</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3297"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN3300"><span class='Ref_To_Local'>dbt</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN3299"><span class='Ref_To_Local'>db</span></a> <span class='Operator'>+ </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3297"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3305"><span class='Ref_To_Local'>last</span></a> <span class='Operator'>&LT; </span><span class='Number'>3</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="imath.c.html#LN142"><span class='Ref_to_Macro'>SETUP</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN98"><span class='Ref_to_Proto'>mp_int_init_size</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3305"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Number'>4</span> <span class='Operator'>* </span><a href="imath.c.html#LN3301"><span class='Ref_To_Local'>umu</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN3305"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN115"><span class='Ref_to_Macro'>ZERO</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3305"><span class='Ref_To_Local'>last</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>))</span><span class='Delimiter'>, </span><a href="imath.h.html#LN66"><span class='Ref_to_Macro'>MP_ALLOC</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3305"><span class='Ref_To_Local'>last</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="imath.h.html#LN101"><span class='Ref_to_Proto'>mp_int_set_value</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3297"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Take care of low-order digits */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3299"><span class='Ref_To_Local'>db</span></a> <span class='Operator'>&LT; </span><a href="imath.c.html#LN3300"><span class='Ref_To_Local'>dbt</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3322"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3302"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= *</span><a href="imath.c.html#LN3299"><span class='Ref_To_Local'>db</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3322"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a><span class='Delimiter'>; </span><a href="imath.c.html#LN3322"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Delimiter'>; </span><span class='Operator'>--</span><a href="imath.c.html#LN3322"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3302"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>&GT;&GT;= </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3302"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>& </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* The use of a second temporary avoids allocation */ 
</span>                <a href="imath.c.html#LN148"><span class='Ref_to_Macro'>UMUL</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3297"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3297"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="imath.c.html#LN276"><span class='Ref_to_Proto'>s_reduce</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN3297"><span class='Ref_to_Parameter'>m</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3297"><span class='Ref_to_Parameter'>mu</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)))</span> 
                <span class='Delimiter'>{ 
</span>                    <a href="imath.c.html#LN3304"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN45"><span class='Ref_to_Global_Var'>MP_MEMORY</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN3383"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN3297"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
 
            <a href="imath.c.html#LN154"><span class='Ref_to_Macro'>USQR</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3297"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Debug'>assert</span><span class='Parentheses'>(</span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>))</span> <span class='Operator'>== </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="imath.c.html#LN276"><span class='Ref_to_Proto'>s_reduce</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN3297"><span class='Ref_to_Parameter'>m</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3297"><span class='Ref_to_Parameter'>mu</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)))</span> 
            <span class='Delimiter'>{ 
</span>                <a href="imath.c.html#LN3304"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN45"><span class='Ref_to_Global_Var'>MP_MEMORY</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN3383"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Debug'>assert</span><span class='Parentheses'>(</span><a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>))</span> <span class='Operator'>== </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN3297"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for d=*db,i=MP_DIGIT_BIT;... &raquo; </span> 
 
        <span class='Operator'>++</span><a href="imath.c.html#LN3299"><span class='Ref_To_Local'>db</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while db&LT;dbt &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Take care of highest-order digit */ 
</span>    <a href="imath.c.html#LN3302"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= *</span><a href="imath.c.html#LN3300"><span class='Ref_To_Local'>dbt</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>;;</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3302"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>& </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="imath.c.html#LN148"><span class='Ref_to_Macro'>UMUL</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3297"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3297"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="imath.c.html#LN276"><span class='Ref_to_Proto'>s_reduce</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN3297"><span class='Ref_to_Parameter'>m</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3297"><span class='Ref_to_Parameter'>mu</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)))</span> 
            <span class='Delimiter'>{ 
</span>                <a href="imath.c.html#LN3304"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN45"><span class='Ref_to_Global_Var'>MP_MEMORY</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN3383"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN3297"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="imath.c.html#LN3302"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>&GT;&GT;= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="imath.c.html#LN3302"><span class='Ref_To_Local'>d</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <a href="imath.c.html#LN154"><span class='Ref_to_Macro'>USQR</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3297"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="imath.c.html#LN276"><span class='Ref_to_Proto'>s_reduce</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN3297"><span class='Ref_to_Parameter'>m</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3297"><span class='Ref_to_Parameter'>mu</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="imath.c.html#LN3304"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN45"><span class='Ref_to_Global_Var'>MP_MEMORY</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN3383"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="imath.c.html#LN3297"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for ;; &raquo; </span> 
 
<a name="LN3383"></a><span class='Label'>CLEANUP</span><span class='Operator'>: 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>--</span><a href="imath.c.html#LN3305"><span class='Ref_To_Local'>last</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="imath.h.html#LN102"><span class='Ref_to_Proto'>mp_int_clear</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN141"><span class='Ref_to_Macro'>TEMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3305"><span class='Ref_To_Local'>last</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="imath.c.html#LN3304"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end s_embar &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_udiv(a, b) */ 
</span> 
<span class='Comment_Multi_Line'>/* Precondition:  a &GT;= b and b &GT; 0 
   Postcondition: a' = a / b, b' = a % b 
 */ 
</span><span class='Keyword'>static </span><a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN3398"></a><span class='Declare_Function'>s_udiv</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>b</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3400"></a>    <a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mpz_t</span></a>       <span class='Declare_Local'>q</span><span class='Delimiter'>, 
</span><a name="LN3401"></a>                <span class='Declare_Local'>r</span><span class='Delimiter'>, 
</span><a name="LN3402"></a>                <span class='Declare_Local'>t</span><span class='Delimiter'>; 
</span><a name="LN3403"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>ua</span><span class='Delimiter'>, 
</span><a name="LN3404"></a>                <span class='Declare_Local'>ub</span><span class='Delimiter'>, 
</span><a name="LN3405"></a>                <span class='Declare_Local'>qpos</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN3406"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>da</span><span class='Delimiter'>, 
</span><a name="LN3407"></a>                <span class='Declare_Local'>btop</span><span class='Delimiter'>; 
</span><a name="LN3408"></a>    <a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a>   <span class='Declare_Local'>res</span> <span class='Operator'>= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Delimiter'>; 
</span><a name="LN3409"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>k</span><span class='Delimiter'>, 
</span><a name="LN3410"></a>                <span class='Declare_Local'>skip</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Force signs to positive */ 
</span>    <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3398"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Delimiter'>; 
</span>    <a href="imath.h.html#LN68"><span class='Ref_to_Macro'>MP_SIGN</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3398"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Normalize, per Knuth */ 
</span>    <a href="imath.c.html#LN3409"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN269"><span class='Ref_to_Proto'>s_norm</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3398"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3398"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN3403"><span class='Ref_To_Local'>ua</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3398"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN3404"><span class='Ref_To_Local'>ub</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3398"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN3407"><span class='Ref_To_Local'>btop</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN3398"><span class='Ref_to_Parameter'>b</span></a><span class='Operator'>-&GT;</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN3404"><span class='Ref_To_Local'>ub</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN3408"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN98"><span class='Ref_to_Proto'>mp_int_init_size</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN3400"><span class='Ref_To_Local'>q</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3403"><span class='Ref_To_Local'>ua</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="imath.c.html#LN3408"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="imath.c.html#LN3408"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN98"><span class='Ref_to_Proto'>mp_int_init_size</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN3402"><span class='Ref_To_Local'>t</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3403"><span class='Ref_To_Local'>ua</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="imath.c.html#LN3497"><span class='Ref_to_Label'>CLEANUP</span></a><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN3406"><span class='Ref_To_Local'>da</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3398"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN3401"><span class='Ref_To_Local'>r</span></a><span class='Operator'>.</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN3406"><span class='Ref_To_Local'>da</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN3403"><span class='Ref_To_Local'>ua</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* The contents of r are shared with a */ 
</span>    <a href="imath.c.html#LN3401"><span class='Ref_To_Local'>r</span></a><span class='Operator'>.</span><a href="imath.h.html#LN60"><span class='Ref_to_Member'>used</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN3401"><span class='Ref_To_Local'>r</span></a><span class='Operator'>.</span><a href="imath.h.html#LN61"><span class='Ref_to_Member'>sign</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN52"><span class='Ref_to_Global_Var'>MP_ZPOS</span></a><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN3401"><span class='Ref_To_Local'>r</span></a><span class='Operator'>.</span><a href="imath.h.html#LN59"><span class='Ref_to_Member'>alloc</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN66"><span class='Ref_to_Macro'>MP_ALLOC</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3398"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN115"><span class='Ref_to_Macro'>ZERO</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3402"><span class='Ref_To_Local'>t</span></a><span class='Operator'>.</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3402"><span class='Ref_To_Local'>t</span></a><span class='Operator'>.</span><a href="imath.h.html#LN59"><span class='Ref_to_Member'>alloc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Solve for quotient digits, store in q.digits in reverse order */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3401"><span class='Ref_To_Local'>r</span></a><span class='Operator'>.</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a> <span class='Operator'>&GT;= </span><a href="imath.c.html#LN3406"><span class='Ref_To_Local'>da</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Debug'>assert</span><span class='Parentheses'>(</span><a href="imath.c.html#LN3405"><span class='Ref_To_Local'>qpos</span></a> <span class='Operator'>&LT;= </span><a href="imath.c.html#LN3400"><span class='Ref_To_Local'>q</span></a><span class='Operator'>.</span><a href="imath.h.html#LN59"><span class='Ref_to_Member'>alloc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN203"><span class='Ref_to_Proto'>s_ucmp</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3398"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="imath.c.html#LN3401"><span class='Ref_To_Local'>r</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="imath.c.html#LN3401"><span class='Ref_To_Local'>r</span></a><span class='Operator'>.</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a> <span class='Operator'>-= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN3401"><span class='Ref_To_Local'>r</span></a><span class='Operator'>.</span><a href="imath.h.html#LN60"><span class='Ref_to_Member'>used</span></a> <span class='Operator'>+= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>++</span><a href="imath.c.html#LN3410"><span class='Ref_To_Local'>skip</span></a> <span class='Operator'>&GT; </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>                <a href="imath.c.html#LN3400"><span class='Ref_To_Local'>q</span></a><span class='Operator'>.</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN3405"><span class='Ref_To_Local'>qpos</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
            <a href="imath.c.html#LN128"><span class='Ref_to_Macro'>CLAMP</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN3401"><span class='Ref_To_Local'>r</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span><a name="LN3451"></a>            <a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a>     <span class='Declare_Local'>pfx</span> <span class='Operator'>= </span><a href="imath.c.html#LN3401"><span class='Ref_To_Local'>r</span></a><span class='Operator'>.</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN3401"><span class='Ref_To_Local'>r</span></a><span class='Operator'>.</span><a href="imath.h.html#LN60"><span class='Ref_to_Member'>used</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span><a name="LN3452"></a>            <a href="imath.h.html#LN50"><span class='Ref_to_Typedef'>mp_word</span></a>     <span class='Declare_Local'>qdigit</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3401"><span class='Ref_To_Local'>r</span></a><span class='Operator'>.</span><a href="imath.h.html#LN60"><span class='Ref_to_Member'>used</span></a> <span class='Operator'>&GT; </span><span class='Number'>1</span> <span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="imath.c.html#LN3451"><span class='Ref_To_Local'>pfx</span></a> <span class='Operator'>&LT; </span><a href="imath.c.html#LN3407"><span class='Ref_To_Local'>btop</span></a> <span class='Operator'>|| </span><a href="imath.c.html#LN3401"><span class='Ref_To_Local'>r</span></a><span class='Operator'>.</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN3401"><span class='Ref_To_Local'>r</span></a><span class='Operator'>.</span><a href="imath.h.html#LN60"><span class='Ref_to_Member'>used</span></a> <span class='Operator'>- </span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span>                <a href="imath.c.html#LN3451"><span class='Ref_To_Local'>pfx</span></a> <span class='Operator'>&LT;&LT;= </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a> <span class='Operator'>/ </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>                <a href="imath.c.html#LN3451"><span class='Ref_To_Local'>pfx</span></a> <span class='Operator'>&LT;&LT;= </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a> <span class='Operator'>/ </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>                <a href="imath.c.html#LN3451"><span class='Ref_To_Local'>pfx</span></a> <span class='Operator'>|= </span><a href="imath.c.html#LN3401"><span class='Ref_To_Local'>r</span></a><span class='Operator'>.</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN3401"><span class='Ref_To_Local'>r</span></a><span class='Operator'>.</span><a href="imath.h.html#LN60"><span class='Ref_to_Member'>used</span></a> <span class='Operator'>- </span><span class='Number'>2</span><span class='Delimiter'>]; 
</span>            <span class='Delimiter'>} 
</span> 
            <a href="imath.c.html#LN3452"><span class='Ref_To_Local'>qdigit</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN3451"><span class='Ref_To_Local'>pfx</span></a> <span class='Operator'>/ </span><a href="imath.c.html#LN3407"><span class='Ref_To_Local'>btop</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3452"><span class='Ref_To_Local'>qdigit</span></a> <span class='Operator'>&GT; </span><a href="imath.h.html#LN46"><span class='Ref_to_Const'>MP_DIGIT_MAX</span></a><span class='Parentheses'>) 
</span>                <a href="imath.c.html#LN3452"><span class='Ref_To_Local'>qdigit</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
            <a href="imath.c.html#LN238"><span class='Ref_to_Proto'>s_dbmul</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3398"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN3452"><span class='Ref_To_Local'>qdigit</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3402"><span class='Ref_To_Local'>t</span></a><span class='Operator'>.</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3404"><span class='Ref_To_Local'>ub</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN3402"><span class='Ref_To_Local'>t</span></a><span class='Operator'>.</span><a href="imath.h.html#LN60"><span class='Ref_to_Member'>used</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN3404"><span class='Ref_To_Local'>ub</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN128"><span class='Ref_to_Macro'>CLAMP</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN3402"><span class='Ref_To_Local'>t</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN203"><span class='Ref_to_Proto'>s_ucmp</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN3402"><span class='Ref_To_Local'>t</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="imath.c.html#LN3401"><span class='Ref_To_Local'>r</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Operator'>--</span><a href="imath.c.html#LN3452"><span class='Ref_To_Local'>qdigit</span></a><span class='Delimiter'>; 
</span>                <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="imath.h.html#LN112"><span class='Ref_to_Proto'>mp_int_sub</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN3402"><span class='Ref_To_Local'>t</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3398"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="imath.c.html#LN3402"><span class='Ref_To_Local'>t</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>   <span class='Comment_Single_Line'>/* cannot fail */ 
</span>            <span class='Delimiter'>} 
</span> 
            <a href="imath.c.html#LN214"><span class='Ref_to_Proto'>s_usub</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3401"><span class='Ref_To_Local'>r</span></a><span class='Operator'>.</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3402"><span class='Ref_To_Local'>t</span></a><span class='Operator'>.</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3401"><span class='Ref_To_Local'>r</span></a><span class='Operator'>.</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3401"><span class='Ref_To_Local'>r</span></a><span class='Operator'>.</span><a href="imath.h.html#LN60"><span class='Ref_to_Member'>used</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3402"><span class='Ref_To_Local'>t</span></a><span class='Operator'>.</span><a href="imath.h.html#LN60"><span class='Ref_to_Member'>used</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN128"><span class='Ref_to_Macro'>CLAMP</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN3401"><span class='Ref_To_Local'>r</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="imath.c.html#LN3400"><span class='Ref_To_Local'>q</span></a><span class='Operator'>.</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN3405"><span class='Ref_To_Local'>qpos</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a><span class='Parentheses'>) </span><a href="imath.c.html#LN3452"><span class='Ref_To_Local'>qdigit</span></a><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN115"><span class='Ref_to_Macro'>ZERO</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3402"><span class='Ref_To_Local'>t</span></a><span class='Operator'>.</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3402"><span class='Ref_To_Local'>t</span></a><span class='Operator'>.</span><a href="imath.h.html#LN60"><span class='Ref_to_Member'>used</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN3410"><span class='Ref_To_Local'>skip</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while r.digits&GT;=da &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Put quotient digits in the correct order, and discard extra zeroes */ 
</span>    <a href="imath.c.html#LN3400"><span class='Ref_To_Local'>q</span></a><span class='Operator'>.</span><a href="imath.h.html#LN60"><span class='Ref_to_Member'>used</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN3405"><span class='Ref_To_Local'>qpos</span></a><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN124"><span class='Ref_to_Macro'>REV</span></a><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3400"><span class='Ref_To_Local'>q</span></a><span class='Operator'>.</span><a href="imath.h.html#LN58"><span class='Ref_to_Member'>digits</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3405"><span class='Ref_To_Local'>qpos</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN128"><span class='Ref_to_Macro'>CLAMP</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN3400"><span class='Ref_To_Local'>q</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Denormalize the remainder */ 
</span>    <a href="imath.c.html#LN128"><span class='Ref_to_Macro'>CLAMP</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3398"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3409"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="imath.c.html#LN246"><span class='Ref_to_Proto'>s_qdiv</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3398"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3409"><span class='Ref_To_Local'>k</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3398"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3398"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>          <span class='Comment_Single_Line'>/* ok:  0 &LT;= r &LT; b */ 
</span>    <a href="imath.h.html#LN105"><span class='Ref_to_Proto'>mp_int_copy</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN3400"><span class='Ref_To_Local'>q</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3398"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>         <span class='Comment_Single_Line'>/* ok:  q &LT;= a     */ 
</span> 
    <a href="imath.h.html#LN102"><span class='Ref_to_Proto'>mp_int_clear</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN3402"><span class='Ref_To_Local'>t</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN3497"></a><span class='Label'>CLEANUP</span><span class='Operator'>: 
</span>    <a href="imath.h.html#LN102"><span class='Ref_to_Proto'>mp_int_clear</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="imath.c.html#LN3400"><span class='Ref_To_Local'>q</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="imath.c.html#LN3408"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end s_udiv &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_outlen(z, r) */ 
</span> 
<span class='Comment_Multi_Line'>/* Precondition:  2 &LT;= r &LT; 64 */ 
</span><span class='Keyword'>static int 
</span><a name="LN3508"></a><span class='Declare_Function'>s_outlen</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>r</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3510"></a>    <a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a>   <span class='Declare_Local'>bits</span><span class='Delimiter'>; 
</span><a name="LN3511"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>raw</span><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN3510"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN180"><span class='Ref_to_Proto'>mp_int_count_bits</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3508"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN3511"><span class='Ref_To_Local'>raw</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>double</span><span class='Parentheses'>) </span><a href="imath.c.html#LN3510"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>*</span><a href="imath.c.html#LN84"><span class='Ref_to_Global_Var'>s_log2</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN3508"><span class='Ref_to_Parameter'>r</span></a><span class='Delimiter'>]; 
</span> 
    <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) (</span><a href="imath.c.html#LN3511"><span class='Ref_To_Local'>raw</span></a> <span class='Operator'>+ </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>999999</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_inlen(len, r) */ 
</span> 
<span class='Keyword'>static </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> 
<a name="LN3524"></a><span class='Declare_Function'>s_inlen</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Delimiter'>, </span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a> <span class='Declare_Parameter'>r</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3526"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>raw</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>double</span><span class='Parentheses'>) </span><a href="imath.c.html#LN3524"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>/ </span><a href="imath.c.html#LN84"><span class='Ref_to_Global_Var'>s_log2</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN3524"><span class='Ref_to_Parameter'>r</span></a><span class='Delimiter'>]; 
</span><a name="LN3527"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>bits</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a><span class='Parentheses'>) (</span><a href="imath.c.html#LN3526"><span class='Ref_To_Local'>raw</span></a> <span class='Operator'>+ </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>5</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a><span class='Parentheses'>) ((</span><a href="imath.c.html#LN3527"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>+ </span><span class='Parentheses'>(</span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>))</span> <span class='Operator'>/ </span><a href="imath.h.html#LN79"><span class='Ref_to_Const'>MP_DIGIT_BIT</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_ch2val(c, r) */ 
</span> 
<span class='Keyword'>static int 
</span><a name="LN3537"></a><span class='Declare_Function'>s_ch2val</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Declare_Parameter'>c</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>r</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3539"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>out</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span>isdigit<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="imath.c.html#LN3537"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>))</span> 
        <a href="imath.c.html#LN3539"><span class='Ref_To_Local'>out</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN3537"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>- </span><span class='String'>'0'</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3537"><span class='Ref_to_Parameter'>r</span></a> <span class='Operator'>&GT; </span><span class='Number'>10</span> <span class='Operator'>&& </span>isalpha<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="imath.c.html#LN3537"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>))</span> 
        <a href="imath.c.html#LN3539"><span class='Ref_To_Local'>out</span></a> <span class='Operator'>= </span>toupper<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="imath.c.html#LN3537"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span> <span class='Operator'>- </span><span class='String'>'A'</span> <span class='Operator'>+ </span><span class='Number'>10</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3539"><span class='Ref_To_Local'>out</span></a> <span class='Operator'>&GT;= </span><a href="imath.c.html#LN3537"><span class='Ref_to_Parameter'>r</span></a><span class='Parentheses'>) </span><span class='Operator'>? -</span><span class='Number'>1</span> <span class='Operator'>: </span><a href="imath.c.html#LN3539"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_val2ch(v, caps) */ 
</span> 
<span class='Keyword'>static char 
</span><a name="LN3556"></a><span class='Declare_Function'>s_val2ch</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>v</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>caps</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Debug'>assert</span><span class='Parentheses'>(</span><a href="imath.c.html#LN3556"><span class='Ref_to_Parameter'>v</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3556"><span class='Ref_to_Parameter'>v</span></a> <span class='Operator'>&LT; </span><span class='Number'>10</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="imath.c.html#LN3556"><span class='Ref_to_Parameter'>v</span></a> <span class='Operator'>+ </span><span class='String'>'0'</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span><a name="LN3564"></a>        <span class='Keyword'>char</span>        <span class='Declare_Local'>out</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="imath.c.html#LN3556"><span class='Ref_to_Parameter'>v</span></a> <span class='Operator'>- </span><span class='Number'>10</span><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='String'>'a'</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3556"><span class='Ref_to_Parameter'>caps</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> toupper<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="imath.c.html#LN3564"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <span class='Control'>return</span> <a href="imath.c.html#LN3564"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_2comp(buf, len) */ 
</span> 
<span class='Keyword'>static void 
</span><a name="LN3578"></a><span class='Declare_Function'>s_2comp</span><span class='Parentheses'>(</span><span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>buf</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3580"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN3581"></a>    <span class='Keyword'>unsigned short </span><span class='Declare_Local'>s</span> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3580"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN3578"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; </span><a href="imath.c.html#LN3580"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Delimiter'>; </span><span class='Operator'>--</span><a href="imath.c.html#LN3580"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3585"></a>        <span class='Keyword'>unsigned char </span><span class='Declare_Local'>c</span> <span class='Operator'>= ~</span><a href="imath.c.html#LN3578"><span class='Ref_to_Parameter'>buf</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN3580"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span> 
        <a href="imath.c.html#LN3581"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN3585"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>+ </span><a href="imath.c.html#LN3581"><span class='Ref_To_Local'>s</span></a><span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN3585"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN3581"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>& </span>UCHAR_MAX<span class='Delimiter'>; 
</span>        <a href="imath.c.html#LN3581"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>&GT;&GT;= </span>CHAR_BIT<span class='Delimiter'>; 
</span> 
        <a href="imath.c.html#LN3578"><span class='Ref_to_Parameter'>buf</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN3580"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="imath.c.html#LN3585"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* last carry out is ignored */ 
</span><span class='Delimiter'>} 
</span> 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_tobin(z, buf, *limpos) */ 
</span> 
<span class='Keyword'>static </span><a href="imath.h.html#LN40"><span class='Ref_to_Typedef'>mp_result</span></a> 
<a name="LN3602"></a><span class='Declare_Function'>s_tobin</span><span class='Parentheses'>(</span><a href="imath.h.html#LN56"><span class='Ref_to_Typedef'>mp_int</span></a> <span class='Declare_Parameter'>z</span><span class='Delimiter'>, </span><span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>buf</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>limpos</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>pad</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3604"></a>    <a href="imath.h.html#LN39"><span class='Ref_to_Typedef'>mp_size</span></a>     <span class='Declare_Local'>uz</span><span class='Delimiter'>; 
</span><a name="LN3605"></a>    <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>dz</span><span class='Delimiter'>; 
</span><a name="LN3606"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>pos</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>, 
</span><a name="LN3607"></a>                <span class='Declare_Local'>limit</span> <span class='Operator'>= *</span><a href="imath.c.html#LN3602"><span class='Ref_to_Parameter'>limpos</span></a><span class='Delimiter'>; 
</span> 
    <a href="imath.c.html#LN3604"><span class='Ref_To_Local'>uz</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN67"><span class='Ref_to_Macro'>MP_USED</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3602"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="imath.c.html#LN3605"><span class='Ref_To_Local'>dz</span></a> <span class='Operator'>= </span><a href="imath.h.html#LN65"><span class='Ref_to_Macro'>MP_DIGITS</span></a><span class='Parentheses'>(</span><a href="imath.c.html#LN3602"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3604"><span class='Ref_To_Local'>uz</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="imath.c.html#LN3606"><span class='Ref_To_Local'>pos</span></a> <span class='Operator'>&LT; </span><a href="imath.c.html#LN3607"><span class='Ref_To_Local'>limit</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3613"></a>        <a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a>    <span class='Declare_Local'>d</span> <span class='Operator'>= *</span><a href="imath.c.html#LN3605"><span class='Ref_To_Local'>dz</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span><a name="LN3614"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3614"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="imath.h.html#LN49"><span class='Ref_to_Typedef'>mp_digit</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="imath.c.html#LN3614"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="imath.c.html#LN3606"><span class='Ref_To_Local'>pos</span></a> <span class='Operator'>&LT; </span><a href="imath.c.html#LN3607"><span class='Ref_To_Local'>limit</span></a><span class='Delimiter'>; </span><span class='Operator'>--</span><a href="imath.c.html#LN3614"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="imath.c.html#LN3602"><span class='Ref_to_Parameter'>buf</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN3606"><span class='Ref_To_Local'>pos</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="imath.c.html#LN3613"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>; 
</span>            <a href="imath.c.html#LN3613"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>&GT;&GT;= </span>CHAR_BIT<span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Don't write leading zeroes */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3613"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="imath.c.html#LN3604"><span class='Ref_To_Local'>uz</span></a> <span class='Operator'>== </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>                <a href="imath.c.html#LN3614"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>;</span>          <span class='Comment_Single_Line'>/* exit loop without signaling truncation */ 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* Detect truncation (loop exited with pos &GT;= limit) */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3614"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Operator'>--</span><a href="imath.c.html#LN3604"><span class='Ref_To_Local'>uz</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while uz&GT;0&&pos&LT;limit &raquo; </span> 
 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3602"><span class='Ref_to_Parameter'>pad</span></a> <span class='Operator'>!= </span><span class='Number'>0</span> <span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="imath.c.html#LN3602"><span class='Ref_to_Parameter'>buf</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN3606"><span class='Ref_To_Local'>pos</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>&GT;&GT; </span><span class='Parentheses'>(</span>CHAR_BIT <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3606"><span class='Ref_To_Local'>pos</span></a> <span class='Operator'>&LT; </span><a href="imath.c.html#LN3607"><span class='Ref_To_Local'>limit</span></a><span class='Parentheses'>) 
</span>            <a href="imath.c.html#LN3602"><span class='Ref_to_Parameter'>buf</span></a><span class='Delimiter'>[</span><a href="imath.c.html#LN3606"><span class='Ref_To_Local'>pos</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="imath.c.html#LN3604"><span class='Ref_To_Local'>uz</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Digits are in reverse order, fix that */ 
</span>    <a href="imath.c.html#LN124"><span class='Ref_to_Macro'>REV</span></a><span class='Parentheses'>(</span><span class='Keyword'>unsigned char</span><span class='Delimiter'>, </span><a href="imath.c.html#LN3602"><span class='Ref_to_Parameter'>buf</span></a><span class='Delimiter'>, </span><a href="imath.c.html#LN3606"><span class='Ref_To_Local'>pos</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Return the number of bytes actually written */ 
</span>    <span class='Operator'>*</span><a href="imath.c.html#LN3602"><span class='Ref_to_Parameter'>limpos</span></a> <span class='Operator'>= </span><a href="imath.c.html#LN3606"><span class='Ref_To_Local'>pos</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="imath.c.html#LN3604"><span class='Ref_To_Local'>uz</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="imath.c.html#LN42"><span class='Ref_to_Global_Var'>MP_OK</span></a> <span class='Operator'>: </span><a href="imath.c.html#LN48"><span class='Ref_to_Global_Var'>MP_TRUNC</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end s_tobin &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* {{{ s_print(tag, z) */ 
</span> 
<span class='Directive'>#if</span> <span class='Number'>0</span> 
<span class='Inactive_Code'>void 
s_print(char *tag, mp_int z) 
{ 
    int         i; 
 
    fprintf(stderr, "%s: %c ", tag, 
            (MP_SIGN(z) == MP_NEG) ? '-' : '+'); 
 
    for (i = MP_USED(z) - 1; i &GT;= 0; --i) 
        fprintf(stderr, "%0*X", (int) (MP_DIGIT_BIT / 4), z-&GT;digits[i]); 
 
    fputc('\n', stderr); 
 
} 
 
void 
s_print_buf(char *tag, mp_digit *buf, mp_size num) 
{ 
    int         i; 
 
    fprintf(stderr, "%s: ", tag); 
 
    for (i = num - 1; i &GT;= 0; --i) 
        fprintf(stderr, "%0*X", (int) (MP_DIGIT_BIT / 4), buf[i]); 
 
    fputc('\n', stderr); 
} 
</span><span class='Directive'>#endif</span> 
 
<span class='Comment_Multi_Line'>/* }}} */ 
</span> 
<span class='Comment_Multi_Line'>/* HERE THERE BE DRAGONS */ 
</span></pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>