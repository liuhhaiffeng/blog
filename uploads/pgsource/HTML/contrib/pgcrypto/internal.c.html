<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>contrib\pgcrypto\internal.c</title>
<LINK REL=StyleSheet HREF="../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>contrib\pgcrypto\internal.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:26 2017
</td></tr>
<tr><td><a href='../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
</span><span class='Comment_Multi_Line'>/* 
 * internal.c 
 *      Wrapper for builtin functions 
 * 
 * Copyright (c) 2001 Marko Kreen 
 * All rights reserved. 
 * 
 * Redistribution and use in source and binary forms, with or without 
 * modification, are permitted provided that the following conditions 
 * are met: 
 * 1. Redistributions of source code must retain the above copyright 
 *    notice, this list of conditions and the following disclaimer. 
 * 2. Redistributions in binary form must reproduce the above copyright 
 *    notice, this list of conditions and the following disclaimer in the 
 *    documentation and/or other materials provided with the distribution. 
 * 
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND 
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE 
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE 
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE 
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL 
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS 
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) 
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT 
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY 
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF 
 * SUCH DAMAGE. 
 * 
 * contrib/pgcrypto/internal.c 
 */ 
</span> 
<span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>&LT;time.h&GT;</span> 
 
<span class='Keyword'>#include </span><span class='String'>"px.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"md5.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"sha1.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"blf.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"rijndael.h"</span> 
 
<span class='Comment_Multi_Line'>/* 
 * System reseeds should be separated at least this much. 
 */ 
</span><a name="LN44"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>SYSTEM_RESEED_MIN</span>           <span class='Parentheses'>(</span><span class='Number'>20</span><span class='Operator'>*</span><span class='Number'>60</span><span class='Parentheses'>)</span>     <span class='Comment_Single_Line'>/* 20 min */ 
</span><span class='Comment_Multi_Line'>/* 
 * How often to roll dice. 
 */ 
</span><a name="LN48"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>SYSTEM_RESEED_CHECK_TIME</span>    <span class='Parentheses'>(</span><span class='Number'>10</span><span class='Operator'>*</span><span class='Number'>60</span><span class='Parentheses'>)</span>     <span class='Comment_Single_Line'>/* 10 min */ 
</span><span class='Comment_Multi_Line'>/* 
 * The chance is x/256 that the reseed happens. 
 */ 
</span><a name="LN52"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>SYSTEM_RESEED_CHANCE</span>        <span class='Parentheses'>(</span><span class='Number'>4</span><span class='Parentheses'>) </span><span class='Comment_Single_Line'>/* 256/4 * 10min ~ 10h */ 
</span> 
<span class='Comment_Multi_Line'>/* 
 * If this much time has passed, force reseed. 
 */ 
</span><a name="LN57"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>SYSTEM_RESEED_MAX</span>           <span class='Parentheses'>(</span><span class='Number'>12</span><span class='Operator'>*</span><span class='Number'>60</span><span class='Operator'>*</span><span class='Number'>60</span><span class='Parentheses'>)</span>  <span class='Comment_Single_Line'>/* 12h */ 
</span> 
 
<span class='Directive'>#ifndef</span> <a href="internal.c.html#LN61"><span class='Ref_to_Const'>MD5_DIGEST_LENGTH</span></a> 
<a name="LN61"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>MD5_DIGEST_LENGTH</span> <span class='Number'>16</span> 
<span class='Directive'>#endif</span> 
 
<span class='Directive'>#ifndef</span> <a href="internal.c.html#LN66"><span class='Ref_to_Const'>SHA1_DIGEST_LENGTH</span></a> 
<span class='Directive'>#ifdef</span> <a href="sha1.h.html#LN72"><span class='Ref_to_Const'>SHA1_RESULTLEN</span></a> 
<a name="LN66"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>SHA1_DIGEST_LENGTH</span> <a href="sha1.h.html#LN72"><span class='Ref_to_Const'>SHA1_RESULTLEN</span></a> 
<span class='Directive'>#else</span> 
<a name="LN68"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>SHA1_DIGEST_LENGTH</span> <span class='Number'>20</span> 
<span class='Directive'>#endif</span> 
<span class='Directive'>#endif</span> 
 
<a name="LN72"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>SHA1_BLOCK_SIZE</span> <span class='Number'>64</span> 
<a name="LN73"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>MD5_BLOCK_SIZE</span> <span class='Number'>64</span> 
 
<a name="LN75"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>init_md5</span><span class='Parentheses'>(</span><a href="px.h.html#LN106"><span class='Ref_to_Typedef'>PX_MD</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>h</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN76"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>init_sha1</span><span class='Parentheses'>(</span><a href="px.h.html#LN106"><span class='Ref_to_Typedef'>PX_MD</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>h</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<a name="LN78"></a><span class='Keyword'>void</span>        <span class='Declare_Prototype'>init_sha224</span><span class='Parentheses'>(</span><a href="px.h.html#LN106"><span class='Ref_to_Typedef'>PX_MD</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>h</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN79"></a><span class='Keyword'>void</span>        <span class='Declare_Prototype'>init_sha256</span><span class='Parentheses'>(</span><a href="px.h.html#LN106"><span class='Ref_to_Typedef'>PX_MD</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>h</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN80"></a><span class='Keyword'>void</span>        <span class='Declare_Prototype'>init_sha384</span><span class='Parentheses'>(</span><a href="px.h.html#LN106"><span class='Ref_to_Typedef'>PX_MD</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>h</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN81"></a><span class='Keyword'>void</span>        <span class='Declare_Prototype'>init_sha512</span><span class='Parentheses'>(</span><a href="px.h.html#LN106"><span class='Ref_to_Typedef'>PX_MD</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>h</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<a name="LN83"></a><span class='Control'>struct</span> <span class='Declare_Struct'>int_digest</span> 
<span class='Delimiter'>{ 
</span><a name="LN85"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Member'>name</span><span class='Delimiter'>; 
</span><a name="LN86"></a>    <span class='Keyword'>void</span>        <span class='Parentheses'>(</span><span class='Operator'>*</span><span class='Declare_Member'>init</span><span class='Parentheses'>) (</span><a href="px.h.html#LN106"><span class='Ref_to_Typedef'>PX_MD</span></a> <span class='Operator'>*</span>h<span class='Parentheses'>)</span><span class='Delimiter'>; 
}; 
</span> 
<span class='Keyword'>static const </span><span class='Control'>struct</span> <a href="internal.c.html#LN83"><span class='Ref_to_Struct'>int_digest</span></a> 
<a name="LN90"></a>            <span class='Declare_Var'>int_digest_list</span><span class='Delimiter'>[] </span><span class='Operator'>= </span><span class='Delimiter'>{ 
</span>    <span class='Delimiter'>{</span><span class='String'>"md5"</span><span class='Delimiter'>, </span><a href="internal.c.html#LN75"><span class='Ref_to_Proto'>init_md5</span></a><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"sha1"</span><span class='Delimiter'>, </span><a href="internal.c.html#LN76"><span class='Ref_to_Proto'>init_sha1</span></a><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"sha224"</span><span class='Delimiter'>, </span><a href="internal-sha2.c.html#LN38"><span class='Ref_to_Proto'>init_sha224</span></a><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"sha256"</span><span class='Delimiter'>, </span><a href="internal-sha2.c.html#LN39"><span class='Ref_to_Proto'>init_sha256</span></a><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"sha384"</span><span class='Delimiter'>, </span><a href="internal-sha2.c.html#LN40"><span class='Ref_to_Proto'>init_sha384</span></a><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"sha512"</span><span class='Delimiter'>, </span><a href="internal-sha2.c.html#LN41"><span class='Ref_to_Proto'>init_sha512</span></a><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>} 
}; 
</span> 
<span class='Comment_Multi_Line'>/* MD5 */ 
</span> 
<span class='Keyword'>static unsigned 
</span><a name="LN103"></a><span class='Declare_Function'>int_md5_len</span><span class='Parentheses'>(</span><a href="px.h.html#LN106"><span class='Ref_to_Typedef'>PX_MD</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>h</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="internal.c.html#LN61"><span class='Ref_to_Const'>MD5_DIGEST_LENGTH</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static unsigned 
</span><a name="LN109"></a><span class='Declare_Function'>int_md5_block_len</span><span class='Parentheses'>(</span><a href="px.h.html#LN106"><span class='Ref_to_Typedef'>PX_MD</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>h</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="internal.c.html#LN73"><span class='Ref_to_Const'>MD5_BLOCK_SIZE</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static void 
</span><a name="LN115"></a><span class='Declare_Function'>int_md5_update</span><span class='Parentheses'>(</span><a href="px.h.html#LN106"><span class='Ref_to_Typedef'>PX_MD</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>h</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../../src/include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>data</span><span class='Delimiter'>, </span><span class='Keyword'>unsigned </span><span class='Declare_Parameter'>dlen</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN117"></a>    <a href="md5.h.html#LN69"><span class='Ref_to_Const'>MD5_CTX</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>ctx</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="md5.h.html#LN69"><span class='Ref_to_Const'>MD5_CTX</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="internal.c.html#LN115"><span class='Ref_to_Parameter'>h</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN125"><span class='Ref_to_Member'>p</span></a><span class='Operator'>.</span><a href="px.h.html#LN124"><span class='Ref_to_Member'>ptr</span></a><span class='Delimiter'>; 
</span> 
    <a href="md5.h.html#LN71"><span class='Ref_to_Macro'>MD5Update</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN117"><span class='Ref_To_Local'>ctx</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN115"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN115"><span class='Ref_to_Parameter'>dlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static void 
</span><a name="LN123"></a><span class='Declare_Function'>int_md5_reset</span><span class='Parentheses'>(</span><a href="px.h.html#LN106"><span class='Ref_to_Typedef'>PX_MD</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>h</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN125"></a>    <a href="md5.h.html#LN69"><span class='Ref_to_Const'>MD5_CTX</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>ctx</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="md5.h.html#LN69"><span class='Ref_to_Const'>MD5_CTX</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="internal.c.html#LN123"><span class='Ref_to_Parameter'>h</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN125"><span class='Ref_to_Member'>p</span></a><span class='Operator'>.</span><a href="px.h.html#LN124"><span class='Ref_to_Member'>ptr</span></a><span class='Delimiter'>; 
</span> 
    <a href="md5.h.html#LN70"><span class='Ref_to_Macro'>MD5Init</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN125"><span class='Ref_To_Local'>ctx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static void 
</span><a name="LN131"></a><span class='Declare_Function'>int_md5_finish</span><span class='Parentheses'>(</span><a href="px.h.html#LN106"><span class='Ref_to_Typedef'>PX_MD</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>h</span><span class='Delimiter'>, </span><a href="../../src/include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dst</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN133"></a>    <a href="md5.h.html#LN69"><span class='Ref_to_Const'>MD5_CTX</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>ctx</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="md5.h.html#LN69"><span class='Ref_to_Const'>MD5_CTX</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="internal.c.html#LN131"><span class='Ref_to_Parameter'>h</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN125"><span class='Ref_to_Member'>p</span></a><span class='Operator'>.</span><a href="px.h.html#LN124"><span class='Ref_to_Member'>ptr</span></a><span class='Delimiter'>; 
</span> 
    <a href="md5.h.html#LN72"><span class='Ref_to_Macro'>MD5Final</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN131"><span class='Ref_to_Parameter'>dst</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN133"><span class='Ref_To_Local'>ctx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static void 
</span><a name="LN139"></a><span class='Declare_Function'>int_md5_free</span><span class='Parentheses'>(</span><a href="px.h.html#LN106"><span class='Ref_to_Typedef'>PX_MD</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>h</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN141"></a>    <a href="md5.h.html#LN69"><span class='Ref_to_Const'>MD5_CTX</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>ctx</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="md5.h.html#LN69"><span class='Ref_to_Const'>MD5_CTX</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="internal.c.html#LN139"><span class='Ref_to_Parameter'>h</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN125"><span class='Ref_to_Member'>p</span></a><span class='Operator'>.</span><a href="px.h.html#LN124"><span class='Ref_to_Member'>ptr</span></a><span class='Delimiter'>; 
</span> 
    <a href="px.c.html#LN132"><span class='Ref_to_Func'>px_memset</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN141"><span class='Ref_To_Local'>ctx</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="internal.c.html#LN141"><span class='Ref_To_Local'>ctx</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="px.h.html#LN45"><span class='Ref_to_Macro'>px_free</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN141"><span class='Ref_To_Local'>ctx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="px.h.html#LN45"><span class='Ref_to_Macro'>px_free</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN139"><span class='Ref_to_Parameter'>h</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* SHA1 */ 
</span> 
<span class='Keyword'>static unsigned 
</span><a name="LN151"></a><span class='Declare_Function'>int_sha1_len</span><span class='Parentheses'>(</span><a href="px.h.html#LN106"><span class='Ref_to_Typedef'>PX_MD</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>h</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="internal.c.html#LN66"><span class='Ref_to_Const'>SHA1_DIGEST_LENGTH</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static unsigned 
</span><a name="LN157"></a><span class='Declare_Function'>int_sha1_block_len</span><span class='Parentheses'>(</span><a href="px.h.html#LN106"><span class='Ref_to_Typedef'>PX_MD</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>h</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="internal.c.html#LN72"><span class='Ref_to_Const'>SHA1_BLOCK_SIZE</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static void 
</span><a name="LN163"></a><span class='Declare_Function'>int_sha1_update</span><span class='Parentheses'>(</span><a href="px.h.html#LN106"><span class='Ref_to_Typedef'>PX_MD</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>h</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../../src/include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>data</span><span class='Delimiter'>, </span><span class='Keyword'>unsigned </span><span class='Declare_Parameter'>dlen</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN165"></a>    <a href="sha1.h.html#LN66"><span class='Ref_to_Typedef'>SHA1_CTX</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>ctx</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="sha1.h.html#LN66"><span class='Ref_to_Typedef'>SHA1_CTX</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="internal.c.html#LN163"><span class='Ref_to_Parameter'>h</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN125"><span class='Ref_to_Member'>p</span></a><span class='Operator'>.</span><a href="px.h.html#LN124"><span class='Ref_to_Member'>ptr</span></a><span class='Delimiter'>; 
</span> 
    <a href="sha1.h.html#LN69"><span class='Ref_to_Macro'>SHA1Update</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN165"><span class='Ref_To_Local'>ctx</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN163"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN163"><span class='Ref_to_Parameter'>dlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static void 
</span><a name="LN171"></a><span class='Declare_Function'>int_sha1_reset</span><span class='Parentheses'>(</span><a href="px.h.html#LN106"><span class='Ref_to_Typedef'>PX_MD</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>h</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN173"></a>    <a href="sha1.h.html#LN66"><span class='Ref_to_Typedef'>SHA1_CTX</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>ctx</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="sha1.h.html#LN66"><span class='Ref_to_Typedef'>SHA1_CTX</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="internal.c.html#LN171"><span class='Ref_to_Parameter'>h</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN125"><span class='Ref_to_Member'>p</span></a><span class='Operator'>.</span><a href="px.h.html#LN124"><span class='Ref_to_Member'>ptr</span></a><span class='Delimiter'>; 
</span> 
    <a href="sha1.h.html#LN68"><span class='Ref_to_Macro'>SHA1Init</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN173"><span class='Ref_To_Local'>ctx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static void 
</span><a name="LN179"></a><span class='Declare_Function'>int_sha1_finish</span><span class='Parentheses'>(</span><a href="px.h.html#LN106"><span class='Ref_to_Typedef'>PX_MD</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>h</span><span class='Delimiter'>, </span><a href="../../src/include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dst</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN181"></a>    <a href="sha1.h.html#LN66"><span class='Ref_to_Typedef'>SHA1_CTX</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>ctx</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="sha1.h.html#LN66"><span class='Ref_to_Typedef'>SHA1_CTX</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="internal.c.html#LN179"><span class='Ref_to_Parameter'>h</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN125"><span class='Ref_to_Member'>p</span></a><span class='Operator'>.</span><a href="px.h.html#LN124"><span class='Ref_to_Member'>ptr</span></a><span class='Delimiter'>; 
</span> 
    <a href="sha1.h.html#LN70"><span class='Ref_to_Macro'>SHA1Final</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN179"><span class='Ref_to_Parameter'>dst</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN181"><span class='Ref_To_Local'>ctx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static void 
</span><a name="LN187"></a><span class='Declare_Function'>int_sha1_free</span><span class='Parentheses'>(</span><a href="px.h.html#LN106"><span class='Ref_to_Typedef'>PX_MD</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>h</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN189"></a>    <a href="sha1.h.html#LN66"><span class='Ref_to_Typedef'>SHA1_CTX</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>ctx</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="sha1.h.html#LN66"><span class='Ref_to_Typedef'>SHA1_CTX</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="internal.c.html#LN187"><span class='Ref_to_Parameter'>h</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN125"><span class='Ref_to_Member'>p</span></a><span class='Operator'>.</span><a href="px.h.html#LN124"><span class='Ref_to_Member'>ptr</span></a><span class='Delimiter'>; 
</span> 
    <a href="px.c.html#LN132"><span class='Ref_to_Func'>px_memset</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN189"><span class='Ref_To_Local'>ctx</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="internal.c.html#LN189"><span class='Ref_To_Local'>ctx</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="px.h.html#LN45"><span class='Ref_to_Macro'>px_free</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN189"><span class='Ref_To_Local'>ctx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="px.h.html#LN45"><span class='Ref_to_Macro'>px_free</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN187"><span class='Ref_to_Parameter'>h</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* init functions */ 
</span> 
<span class='Keyword'>static void 
</span><a name="LN199"></a><span class='Declare_Function'>init_md5</span><span class='Parentheses'>(</span><a href="px.h.html#LN106"><span class='Ref_to_Typedef'>PX_MD</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>md</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN201"></a>    <a href="md5.h.html#LN69"><span class='Ref_to_Const'>MD5_CTX</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>ctx</span><span class='Delimiter'>; 
</span> 
    <a href="internal.c.html#LN201"><span class='Ref_To_Local'>ctx</span></a> <span class='Operator'>= </span><a href="px.h.html#LN43"><span class='Ref_to_Macro'>px_alloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="internal.c.html#LN201"><span class='Ref_To_Local'>ctx</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    memset<span class='Parentheses'>(</span><a href="internal.c.html#LN201"><span class='Ref_To_Local'>ctx</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="internal.c.html#LN201"><span class='Ref_To_Local'>ctx</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="internal.c.html#LN199"><span class='Ref_to_Parameter'>md</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN125"><span class='Ref_to_Member'>p</span></a><span class='Operator'>.</span><a href="px.h.html#LN124"><span class='Ref_to_Member'>ptr</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN201"><span class='Ref_To_Local'>ctx</span></a><span class='Delimiter'>; 
</span> 
    <a href="internal.c.html#LN199"><span class='Ref_to_Parameter'>md</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN114"><span class='Ref_to_Member'>result_size</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN102"><span class='Ref_to_Func'>int_md5_len</span></a><span class='Delimiter'>; 
</span>    <a href="internal.c.html#LN199"><span class='Ref_to_Parameter'>md</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN115"><span class='Ref_to_Member'>block_size</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN108"><span class='Ref_to_Func'>int_md5_block_len</span></a><span class='Delimiter'>; 
</span>    <a href="internal.c.html#LN199"><span class='Ref_to_Parameter'>md</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN116"><span class='Ref_to_Member'>reset</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN122"><span class='Ref_to_Func'>int_md5_reset</span></a><span class='Delimiter'>; 
</span>    <a href="internal.c.html#LN199"><span class='Ref_to_Parameter'>md</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN117"><span class='Ref_to_Member'>update</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN114"><span class='Ref_to_Func'>int_md5_update</span></a><span class='Delimiter'>; 
</span>    <a href="internal.c.html#LN199"><span class='Ref_to_Parameter'>md</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN118"><span class='Ref_to_Member'>finish</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN130"><span class='Ref_to_Func'>int_md5_finish</span></a><span class='Delimiter'>; 
</span>    <a href="internal.c.html#LN199"><span class='Ref_to_Parameter'>md</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN119"><span class='Ref_to_Member'>free</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN138"><span class='Ref_to_Func'>int_md5_free</span></a><span class='Delimiter'>; 
</span> 
    <a href="internal.c.html#LN199"><span class='Ref_to_Parameter'>md</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN116"><span class='Ref_to_Member'>reset</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN199"><span class='Ref_to_Parameter'>md</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static void 
</span><a name="LN219"></a><span class='Declare_Function'>init_sha1</span><span class='Parentheses'>(</span><a href="px.h.html#LN106"><span class='Ref_to_Typedef'>PX_MD</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>md</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN221"></a>    <a href="sha1.h.html#LN66"><span class='Ref_to_Typedef'>SHA1_CTX</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>ctx</span><span class='Delimiter'>; 
</span> 
    <a href="internal.c.html#LN221"><span class='Ref_To_Local'>ctx</span></a> <span class='Operator'>= </span><a href="px.h.html#LN43"><span class='Ref_to_Macro'>px_alloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="internal.c.html#LN221"><span class='Ref_To_Local'>ctx</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    memset<span class='Parentheses'>(</span><a href="internal.c.html#LN221"><span class='Ref_To_Local'>ctx</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="internal.c.html#LN221"><span class='Ref_To_Local'>ctx</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="internal.c.html#LN219"><span class='Ref_to_Parameter'>md</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN125"><span class='Ref_to_Member'>p</span></a><span class='Operator'>.</span><a href="px.h.html#LN124"><span class='Ref_to_Member'>ptr</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN221"><span class='Ref_To_Local'>ctx</span></a><span class='Delimiter'>; 
</span> 
    <a href="internal.c.html#LN219"><span class='Ref_to_Parameter'>md</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN114"><span class='Ref_to_Member'>result_size</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN150"><span class='Ref_to_Func'>int_sha1_len</span></a><span class='Delimiter'>; 
</span>    <a href="internal.c.html#LN219"><span class='Ref_to_Parameter'>md</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN115"><span class='Ref_to_Member'>block_size</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN156"><span class='Ref_to_Func'>int_sha1_block_len</span></a><span class='Delimiter'>; 
</span>    <a href="internal.c.html#LN219"><span class='Ref_to_Parameter'>md</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN116"><span class='Ref_to_Member'>reset</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN170"><span class='Ref_to_Func'>int_sha1_reset</span></a><span class='Delimiter'>; 
</span>    <a href="internal.c.html#LN219"><span class='Ref_to_Parameter'>md</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN117"><span class='Ref_to_Member'>update</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN162"><span class='Ref_to_Func'>int_sha1_update</span></a><span class='Delimiter'>; 
</span>    <a href="internal.c.html#LN219"><span class='Ref_to_Parameter'>md</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN118"><span class='Ref_to_Member'>finish</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN178"><span class='Ref_to_Func'>int_sha1_finish</span></a><span class='Delimiter'>; 
</span>    <a href="internal.c.html#LN219"><span class='Ref_to_Parameter'>md</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN119"><span class='Ref_to_Member'>free</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN186"><span class='Ref_to_Func'>int_sha1_free</span></a><span class='Delimiter'>; 
</span> 
    <a href="internal.c.html#LN219"><span class='Ref_to_Parameter'>md</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN116"><span class='Ref_to_Member'>reset</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN219"><span class='Ref_to_Parameter'>md</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * ciphers generally 
 */ 
</span> 
<a name="LN242"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>INT_MAX_KEY</span>     <span class='Parentheses'>(</span><span class='Number'>512</span><span class='Operator'>/</span><span class='Number'>8</span><span class='Parentheses'>) 
</span><a name="LN243"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>INT_MAX_IV</span>      <span class='Parentheses'>(</span><span class='Number'>128</span><span class='Operator'>/</span><span class='Number'>8</span><span class='Parentheses'>) 
</span> 
<a name="LN245"></a><span class='Control'>struct</span> <span class='Declare_Struct'>int_ctx</span> 
<span class='Delimiter'>{ 
</span><a name="LN247"></a>    <a href="../../src/include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a>       <span class='Declare_Member'>keybuf</span><span class='Delimiter'>[</span><a href="internal.c.html#LN242"><span class='Ref_to_Const'>INT_MAX_KEY</span></a><span class='Delimiter'>]; 
</span><a name="LN248"></a>    <a href="../../src/include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a>       <span class='Declare_Member'>iv</span><span class='Delimiter'>[</span><a href="internal.c.html#LN243"><span class='Ref_to_Const'>INT_MAX_IV</span></a><span class='Delimiter'>]; 
</span>    <span class='Control'>union</span> 
    <span class='Delimiter'>{ 
</span><a name="LN251"></a>        <a href="blf.h.html#LN29"><span class='Ref_to_Typedef'>BlowfishContext</span></a> <span class='Declare_Member'>bf</span><span class='Delimiter'>; 
</span><a name="LN252"></a>        <a href="rijndael.h.html#LN32"><span class='Ref_to_Typedef'>rijndael_ctx</span></a> <span class='Declare_Member'>rj</span><span class='Delimiter'>; 
</span><a name="LN253"></a>    <span class='Delimiter'>}</span>           <span class='Declare_Member'>ctx</span><span class='Delimiter'>; 
</span><a name="LN254"></a>    <span class='Keyword'>unsigned</span>    <span class='Declare_Member'>keylen</span><span class='Delimiter'>; 
</span><a name="LN255"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>is_init</span><span class='Delimiter'>; 
</span><a name="LN256"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>mode</span><span class='Delimiter'>; 
}; 
</span> 
<span class='Keyword'>static void 
</span><a name="LN260"></a><span class='Declare_Function'>intctx_free</span><span class='Parentheses'>(</span><a href="px.h.html#LN109"><span class='Ref_to_Typedef'>PX_Cipher</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN262"></a>    <span class='Control'>struct</span> <a href="internal.c.html#LN245"><span class='Ref_to_Struct'>int_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Local'>cx</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="internal.c.html#LN245"><span class='Ref_to_Struct'>int_ctx</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="internal.c.html#LN260"><span class='Ref_to_Parameter'>c</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN164"><span class='Ref_to_Member'>ptr</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="internal.c.html#LN262"><span class='Ref_To_Local'>cx</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="px.c.html#LN132"><span class='Ref_to_Func'>px_memset</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN262"><span class='Ref_To_Local'>cx</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof </span><span class='Operator'>*</span><a href="internal.c.html#LN262"><span class='Ref_To_Local'>cx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="px.h.html#LN45"><span class='Ref_to_Macro'>px_free</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN262"><span class='Ref_To_Local'>cx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="px.h.html#LN45"><span class='Ref_to_Macro'>px_free</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN260"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * AES/rijndael 
 */ 
</span> 
<a name="LN276"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>MODE_ECB</span> <span class='Number'>0</span> 
<a name="LN277"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>MODE_CBC</span> <span class='Number'>1</span> 
 
<span class='Keyword'>static unsigned 
</span><a name="LN280"></a><span class='Declare_Function'>rj_block_size</span><span class='Parentheses'>(</span><a href="px.h.html#LN109"><span class='Ref_to_Typedef'>PX_Cipher</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <span class='Number'>128</span> <span class='Operator'>/ </span><span class='Number'>8</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static unsigned 
</span><a name="LN286"></a><span class='Declare_Function'>rj_key_size</span><span class='Parentheses'>(</span><a href="px.h.html#LN109"><span class='Ref_to_Typedef'>PX_Cipher</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <span class='Number'>256</span> <span class='Operator'>/ </span><span class='Number'>8</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static unsigned 
</span><a name="LN292"></a><span class='Declare_Function'>rj_iv_size</span><span class='Parentheses'>(</span><a href="px.h.html#LN109"><span class='Ref_to_Typedef'>PX_Cipher</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <span class='Number'>128</span> <span class='Operator'>/ </span><span class='Number'>8</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN298"></a><span class='Declare_Function'>rj_init</span><span class='Parentheses'>(</span><a href="px.h.html#LN109"><span class='Ref_to_Typedef'>PX_Cipher</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>c</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../../src/include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>key</span><span class='Delimiter'>, </span><span class='Keyword'>unsigned </span><span class='Declare_Parameter'>klen</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../../src/include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>iv</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN300"></a>    <span class='Control'>struct</span> <a href="internal.c.html#LN245"><span class='Ref_to_Struct'>int_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Local'>cx</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="internal.c.html#LN245"><span class='Ref_to_Struct'>int_ctx</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="internal.c.html#LN298"><span class='Ref_to_Parameter'>c</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN164"><span class='Ref_to_Member'>ptr</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="internal.c.html#LN298"><span class='Ref_to_Parameter'>klen</span></a> <span class='Operator'>&LT;= </span><span class='Number'>128</span> <span class='Operator'>/ </span><span class='Number'>8</span><span class='Parentheses'>) 
</span>        <a href="internal.c.html#LN300"><span class='Ref_To_Local'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN254"><span class='Ref_to_Member'>keylen</span></a> <span class='Operator'>= </span><span class='Number'>128</span> <span class='Operator'>/ </span><span class='Number'>8</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="internal.c.html#LN298"><span class='Ref_to_Parameter'>klen</span></a> <span class='Operator'>&LT;= </span><span class='Number'>192</span> <span class='Operator'>/ </span><span class='Number'>8</span><span class='Parentheses'>) 
</span>        <a href="internal.c.html#LN300"><span class='Ref_To_Local'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN254"><span class='Ref_to_Member'>keylen</span></a> <span class='Operator'>= </span><span class='Number'>192</span> <span class='Operator'>/ </span><span class='Number'>8</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="internal.c.html#LN298"><span class='Ref_to_Parameter'>klen</span></a> <span class='Operator'>&LT;= </span><span class='Number'>256</span> <span class='Operator'>/ </span><span class='Number'>8</span><span class='Parentheses'>) 
</span>        <a href="internal.c.html#LN300"><span class='Ref_To_Local'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN254"><span class='Ref_to_Member'>keylen</span></a> <span class='Operator'>= </span><span class='Number'>256</span> <span class='Operator'>/ </span><span class='Number'>8</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <a href="px.h.html#LN68"><span class='Ref_to_Const'>PXE_KEY_TOO_BIG</span></a><span class='Delimiter'>; 
</span> 
    memcpy<span class='Parentheses'>(</span><span class='Operator'>&</span><a href="internal.c.html#LN300"><span class='Ref_To_Local'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN247"><span class='Ref_to_Member'>keybuf</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN298"><span class='Ref_to_Parameter'>key</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN298"><span class='Ref_to_Parameter'>klen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="internal.c.html#LN298"><span class='Ref_to_Parameter'>iv</span></a><span class='Parentheses'>) 
</span>        memcpy<span class='Parentheses'>(</span><a href="internal.c.html#LN300"><span class='Ref_To_Local'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN248"><span class='Ref_to_Member'>iv</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN298"><span class='Ref_to_Parameter'>iv</span></a><span class='Delimiter'>, </span><span class='Number'>128</span> <span class='Operator'>/ </span><span class='Number'>8</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end rj_init &raquo; </span> 
 
<span class='Keyword'>static int 
</span><a name="LN320"></a><span class='Declare_Function'>rj_real_init</span><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="internal.c.html#LN245"><span class='Ref_to_Struct'>int_ctx</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>cx</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>dir</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="rijndael.h.html#LN53"><span class='Ref_to_Proto'>aes_set_key</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="internal.c.html#LN320"><span class='Ref_to_Parameter'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN253"><span class='Ref_to_Member'>ctx</span></a><span class='Operator'>.</span><a href="internal.c.html#LN252"><span class='Ref_to_Member'>rj</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN320"><span class='Ref_to_Parameter'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN247"><span class='Ref_to_Member'>keybuf</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN320"><span class='Ref_to_Parameter'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN254"><span class='Ref_to_Member'>keylen</span></a> <span class='Operator'>* </span><span class='Number'>8</span><span class='Delimiter'>, </span><a href="internal.c.html#LN320"><span class='Ref_to_Parameter'>dir</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN327"></a><span class='Declare_Function'>rj_encrypt</span><span class='Parentheses'>(</span><a href="px.h.html#LN109"><span class='Ref_to_Typedef'>PX_Cipher</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>c</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../../src/include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>data</span><span class='Delimiter'>, </span><span class='Keyword'>unsigned </span><span class='Declare_Parameter'>dlen</span><span class='Delimiter'>, </span><a href="../../src/include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN329"></a>    <span class='Control'>struct</span> <a href="internal.c.html#LN245"><span class='Ref_to_Struct'>int_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Local'>cx</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="internal.c.html#LN245"><span class='Ref_to_Struct'>int_ctx</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="internal.c.html#LN327"><span class='Ref_to_Parameter'>c</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN164"><span class='Ref_to_Member'>ptr</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="internal.c.html#LN329"><span class='Ref_To_Local'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN255"><span class='Ref_to_Member'>is_init</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="internal.c.html#LN319"><span class='Ref_to_Func'>rj_real_init</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN329"><span class='Ref_To_Local'>cx</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="px.h.html#LN69"><span class='Ref_to_Const'>PXE_CIPHER_INIT</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="internal.c.html#LN327"><span class='Ref_to_Parameter'>dlen</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="internal.c.html#LN327"><span class='Ref_to_Parameter'>dlen</span></a> <span class='Operator'>& </span><span class='Number'>15</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="px.h.html#LN65"><span class='Ref_to_Const'>PXE_NOTBLOCKSIZE</span></a><span class='Delimiter'>; 
</span> 
    memcpy<span class='Parentheses'>(</span><a href="internal.c.html#LN327"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN327"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN327"><span class='Ref_to_Parameter'>dlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="internal.c.html#LN329"><span class='Ref_To_Local'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN256"><span class='Ref_to_Member'>mode</span></a> <span class='Operator'>== </span><a href="internal.c.html#LN277"><span class='Ref_to_Const'>MODE_CBC</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="rijndael.h.html#LN56"><span class='Ref_to_Proto'>aes_cbc_encrypt</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="internal.c.html#LN329"><span class='Ref_To_Local'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN253"><span class='Ref_to_Member'>ctx</span></a><span class='Operator'>.</span><a href="internal.c.html#LN252"><span class='Ref_to_Member'>rj</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN329"><span class='Ref_To_Local'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN248"><span class='Ref_to_Member'>iv</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN327"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN327"><span class='Ref_to_Parameter'>dlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        memcpy<span class='Parentheses'>(</span><a href="internal.c.html#LN329"><span class='Ref_To_Local'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN248"><span class='Ref_to_Member'>iv</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN327"><span class='Ref_to_Parameter'>res</span></a> <span class='Operator'>+ </span><a href="internal.c.html#LN327"><span class='Ref_to_Parameter'>dlen</span></a> <span class='Operator'>- </span><span class='Number'>16</span><span class='Delimiter'>, </span><span class='Number'>16</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
        <a href="rijndael.h.html#LN54"><span class='Ref_to_Proto'>aes_ecb_encrypt</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="internal.c.html#LN329"><span class='Ref_To_Local'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN253"><span class='Ref_to_Member'>ctx</span></a><span class='Operator'>.</span><a href="internal.c.html#LN252"><span class='Ref_to_Member'>rj</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN327"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN327"><span class='Ref_to_Parameter'>dlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end rj_encrypt &raquo; </span> 
 
<span class='Keyword'>static int 
</span><a name="LN357"></a><span class='Declare_Function'>rj_decrypt</span><span class='Parentheses'>(</span><a href="px.h.html#LN109"><span class='Ref_to_Typedef'>PX_Cipher</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>c</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../../src/include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>data</span><span class='Delimiter'>, </span><span class='Keyword'>unsigned </span><span class='Declare_Parameter'>dlen</span><span class='Delimiter'>, </span><a href="../../src/include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN359"></a>    <span class='Control'>struct</span> <a href="internal.c.html#LN245"><span class='Ref_to_Struct'>int_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Local'>cx</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="internal.c.html#LN245"><span class='Ref_to_Struct'>int_ctx</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="internal.c.html#LN357"><span class='Ref_to_Parameter'>c</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN164"><span class='Ref_to_Member'>ptr</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="internal.c.html#LN359"><span class='Ref_To_Local'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN255"><span class='Ref_to_Member'>is_init</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="internal.c.html#LN319"><span class='Ref_to_Func'>rj_real_init</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN359"><span class='Ref_To_Local'>cx</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="px.h.html#LN69"><span class='Ref_to_Const'>PXE_CIPHER_INIT</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="internal.c.html#LN357"><span class='Ref_to_Parameter'>dlen</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="internal.c.html#LN357"><span class='Ref_to_Parameter'>dlen</span></a> <span class='Operator'>& </span><span class='Number'>15</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="px.h.html#LN65"><span class='Ref_to_Const'>PXE_NOTBLOCKSIZE</span></a><span class='Delimiter'>; 
</span> 
    memcpy<span class='Parentheses'>(</span><a href="internal.c.html#LN357"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN357"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN357"><span class='Ref_to_Parameter'>dlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="internal.c.html#LN359"><span class='Ref_To_Local'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN256"><span class='Ref_to_Member'>mode</span></a> <span class='Operator'>== </span><a href="internal.c.html#LN277"><span class='Ref_to_Const'>MODE_CBC</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="rijndael.h.html#LN57"><span class='Ref_to_Proto'>aes_cbc_decrypt</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="internal.c.html#LN359"><span class='Ref_To_Local'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN253"><span class='Ref_to_Member'>ctx</span></a><span class='Operator'>.</span><a href="internal.c.html#LN252"><span class='Ref_to_Member'>rj</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN359"><span class='Ref_To_Local'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN248"><span class='Ref_to_Member'>iv</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN357"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN357"><span class='Ref_to_Parameter'>dlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        memcpy<span class='Parentheses'>(</span><a href="internal.c.html#LN359"><span class='Ref_To_Local'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN248"><span class='Ref_to_Member'>iv</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN357"><span class='Ref_to_Parameter'>data</span></a> <span class='Operator'>+ </span><a href="internal.c.html#LN357"><span class='Ref_to_Parameter'>dlen</span></a> <span class='Operator'>- </span><span class='Number'>16</span><span class='Delimiter'>, </span><span class='Number'>16</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
        <a href="rijndael.h.html#LN55"><span class='Ref_to_Proto'>aes_ecb_decrypt</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="internal.c.html#LN359"><span class='Ref_To_Local'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN253"><span class='Ref_to_Member'>ctx</span></a><span class='Operator'>.</span><a href="internal.c.html#LN252"><span class='Ref_to_Member'>rj</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN357"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN357"><span class='Ref_to_Parameter'>dlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end rj_decrypt &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * initializers 
 */ 
</span> 
<span class='Keyword'>static </span><a href="px.h.html#LN109"><span class='Ref_to_Typedef'>PX_Cipher</span></a> <span class='Operator'>* 
</span><a name="LN389"></a><span class='Declare_Function'>rj_load</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>mode</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN391"></a>    <a href="px.h.html#LN109"><span class='Ref_to_Typedef'>PX_Cipher</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>c</span><span class='Delimiter'>; 
</span><a name="LN392"></a>    <span class='Control'>struct</span> <a href="internal.c.html#LN245"><span class='Ref_to_Struct'>int_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Local'>cx</span><span class='Delimiter'>; 
</span> 
    <a href="internal.c.html#LN391"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= </span><a href="px.h.html#LN43"><span class='Ref_to_Macro'>px_alloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof </span><span class='Operator'>*</span><a href="internal.c.html#LN391"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    memset<span class='Parentheses'>(</span><a href="internal.c.html#LN391"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof </span><span class='Operator'>*</span><a href="internal.c.html#LN391"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="internal.c.html#LN391"><span class='Ref_To_Local'>c</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN155"><span class='Ref_to_Member'>block_size</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN279"><span class='Ref_to_Func'>rj_block_size</span></a><span class='Delimiter'>; 
</span>    <a href="internal.c.html#LN391"><span class='Ref_To_Local'>c</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN156"><span class='Ref_to_Member'>key_size</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN285"><span class='Ref_to_Func'>rj_key_size</span></a><span class='Delimiter'>; 
</span>    <a href="internal.c.html#LN391"><span class='Ref_To_Local'>c</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN157"><span class='Ref_to_Member'>iv_size</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN291"><span class='Ref_to_Func'>rj_iv_size</span></a><span class='Delimiter'>; 
</span>    <a href="internal.c.html#LN391"><span class='Ref_To_Local'>c</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN159"><span class='Ref_to_Member'>init</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN297"><span class='Ref_to_Func'>rj_init</span></a><span class='Delimiter'>; 
</span>    <a href="internal.c.html#LN391"><span class='Ref_To_Local'>c</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN160"><span class='Ref_to_Member'>encrypt</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN326"><span class='Ref_to_Func'>rj_encrypt</span></a><span class='Delimiter'>; 
</span>    <a href="internal.c.html#LN391"><span class='Ref_To_Local'>c</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN161"><span class='Ref_to_Member'>decrypt</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN356"><span class='Ref_to_Func'>rj_decrypt</span></a><span class='Delimiter'>; 
</span>    <a href="internal.c.html#LN391"><span class='Ref_To_Local'>c</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN162"><span class='Ref_to_Member'>free</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN259"><span class='Ref_to_Func'>intctx_free</span></a><span class='Delimiter'>; 
</span> 
    <a href="internal.c.html#LN392"><span class='Ref_To_Local'>cx</span></a> <span class='Operator'>= </span><a href="px.h.html#LN43"><span class='Ref_to_Macro'>px_alloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof </span><span class='Operator'>*</span><a href="internal.c.html#LN392"><span class='Ref_To_Local'>cx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    memset<span class='Parentheses'>(</span><a href="internal.c.html#LN392"><span class='Ref_To_Local'>cx</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof </span><span class='Operator'>*</span><a href="internal.c.html#LN392"><span class='Ref_To_Local'>cx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="internal.c.html#LN392"><span class='Ref_To_Local'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN256"><span class='Ref_to_Member'>mode</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN389"><span class='Ref_to_Parameter'>mode</span></a><span class='Delimiter'>; 
</span> 
    <a href="internal.c.html#LN391"><span class='Ref_To_Local'>c</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN164"><span class='Ref_to_Member'>ptr</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN392"><span class='Ref_To_Local'>cx</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="internal.c.html#LN391"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end rj_load &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * blowfish 
 */ 
</span> 
<span class='Keyword'>static unsigned 
</span><a name="LN418"></a><span class='Declare_Function'>bf_block_size</span><span class='Parentheses'>(</span><a href="px.h.html#LN109"><span class='Ref_to_Typedef'>PX_Cipher</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <span class='Number'>8</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static unsigned 
</span><a name="LN424"></a><span class='Declare_Function'>bf_key_size</span><span class='Parentheses'>(</span><a href="px.h.html#LN109"><span class='Ref_to_Typedef'>PX_Cipher</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <span class='Number'>448</span> <span class='Operator'>/ </span><span class='Number'>8</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static unsigned 
</span><a name="LN430"></a><span class='Declare_Function'>bf_iv_size</span><span class='Parentheses'>(</span><a href="px.h.html#LN109"><span class='Ref_to_Typedef'>PX_Cipher</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <span class='Number'>8</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN436"></a><span class='Declare_Function'>bf_init</span><span class='Parentheses'>(</span><a href="px.h.html#LN109"><span class='Ref_to_Typedef'>PX_Cipher</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>c</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../../src/include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>key</span><span class='Delimiter'>, </span><span class='Keyword'>unsigned </span><span class='Declare_Parameter'>klen</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../../src/include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>iv</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN438"></a>    <span class='Control'>struct</span> <a href="internal.c.html#LN245"><span class='Ref_to_Struct'>int_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Local'>cx</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="internal.c.html#LN245"><span class='Ref_to_Struct'>int_ctx</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="internal.c.html#LN436"><span class='Ref_to_Parameter'>c</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN164"><span class='Ref_to_Member'>ptr</span></a><span class='Delimiter'>; 
</span> 
    <a href="blf.h.html#LN40"><span class='Ref_to_Proto'>blowfish_setkey</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="internal.c.html#LN438"><span class='Ref_To_Local'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN253"><span class='Ref_to_Member'>ctx</span></a><span class='Operator'>.</span><a href="internal.c.html#LN251"><span class='Ref_to_Member'>bf</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN436"><span class='Ref_to_Parameter'>key</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN436"><span class='Ref_to_Parameter'>klen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="internal.c.html#LN436"><span class='Ref_to_Parameter'>iv</span></a><span class='Parentheses'>) 
</span>        <a href="blf.h.html#LN41"><span class='Ref_to_Proto'>blowfish_setiv</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="internal.c.html#LN438"><span class='Ref_To_Local'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN253"><span class='Ref_to_Member'>ctx</span></a><span class='Operator'>.</span><a href="internal.c.html#LN251"><span class='Ref_to_Member'>bf</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN436"><span class='Ref_to_Parameter'>iv</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN448"></a><span class='Declare_Function'>bf_encrypt</span><span class='Parentheses'>(</span><a href="px.h.html#LN109"><span class='Ref_to_Typedef'>PX_Cipher</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>c</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../../src/include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>data</span><span class='Delimiter'>, </span><span class='Keyword'>unsigned </span><span class='Declare_Parameter'>dlen</span><span class='Delimiter'>, </span><a href="../../src/include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN450"></a>    <span class='Control'>struct</span> <a href="internal.c.html#LN245"><span class='Ref_to_Struct'>int_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Local'>cx</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="internal.c.html#LN245"><span class='Ref_to_Struct'>int_ctx</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="internal.c.html#LN448"><span class='Ref_to_Parameter'>c</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN164"><span class='Ref_to_Member'>ptr</span></a><span class='Delimiter'>; 
</span><a name="LN451"></a>    <a href="blf.h.html#LN29"><span class='Ref_to_Typedef'>BlowfishContext</span></a> <span class='Operator'>*</span><span class='Declare_Local'>bfctx</span> <span class='Operator'>= &</span><a href="internal.c.html#LN450"><span class='Ref_To_Local'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN253"><span class='Ref_to_Member'>ctx</span></a><span class='Operator'>.</span><a href="internal.c.html#LN251"><span class='Ref_to_Member'>bf</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="internal.c.html#LN448"><span class='Ref_to_Parameter'>dlen</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="internal.c.html#LN448"><span class='Ref_to_Parameter'>dlen</span></a> <span class='Operator'>& </span><span class='Number'>7</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="px.h.html#LN65"><span class='Ref_to_Const'>PXE_NOTBLOCKSIZE</span></a><span class='Delimiter'>; 
</span> 
    memcpy<span class='Parentheses'>(</span><a href="internal.c.html#LN448"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN448"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN448"><span class='Ref_to_Parameter'>dlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="internal.c.html#LN450"><span class='Ref_To_Local'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN256"><span class='Ref_to_Member'>mode</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="internal.c.html#LN276"><span class='Ref_to_Const'>MODE_ECB</span></a><span class='Operator'>: 
</span>            <a href="blf.h.html#LN44"><span class='Ref_to_Proto'>blowfish_encrypt_ecb</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN448"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN448"><span class='Ref_to_Parameter'>dlen</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN451"><span class='Ref_To_Local'>bfctx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="internal.c.html#LN277"><span class='Ref_to_Const'>MODE_CBC</span></a><span class='Operator'>: 
</span>            <a href="blf.h.html#LN42"><span class='Ref_to_Proto'>blowfish_encrypt_cbc</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN448"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN448"><span class='Ref_to_Parameter'>dlen</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN451"><span class='Ref_To_Local'>bfctx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end bf_encrypt &raquo; </span> 
 
<span class='Keyword'>static int 
</span><a name="LN473"></a><span class='Declare_Function'>bf_decrypt</span><span class='Parentheses'>(</span><a href="px.h.html#LN109"><span class='Ref_to_Typedef'>PX_Cipher</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>c</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../../src/include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>data</span><span class='Delimiter'>, </span><span class='Keyword'>unsigned </span><span class='Declare_Parameter'>dlen</span><span class='Delimiter'>, </span><a href="../../src/include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN475"></a>    <span class='Control'>struct</span> <a href="internal.c.html#LN245"><span class='Ref_to_Struct'>int_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Local'>cx</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="internal.c.html#LN245"><span class='Ref_to_Struct'>int_ctx</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="internal.c.html#LN473"><span class='Ref_to_Parameter'>c</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN164"><span class='Ref_to_Member'>ptr</span></a><span class='Delimiter'>; 
</span><a name="LN476"></a>    <a href="blf.h.html#LN29"><span class='Ref_to_Typedef'>BlowfishContext</span></a> <span class='Operator'>*</span><span class='Declare_Local'>bfctx</span> <span class='Operator'>= &</span><a href="internal.c.html#LN475"><span class='Ref_To_Local'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN253"><span class='Ref_to_Member'>ctx</span></a><span class='Operator'>.</span><a href="internal.c.html#LN251"><span class='Ref_to_Member'>bf</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="internal.c.html#LN473"><span class='Ref_to_Parameter'>dlen</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="internal.c.html#LN473"><span class='Ref_to_Parameter'>dlen</span></a> <span class='Operator'>& </span><span class='Number'>7</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="px.h.html#LN65"><span class='Ref_to_Const'>PXE_NOTBLOCKSIZE</span></a><span class='Delimiter'>; 
</span> 
    memcpy<span class='Parentheses'>(</span><a href="internal.c.html#LN473"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN473"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN473"><span class='Ref_to_Parameter'>dlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="internal.c.html#LN475"><span class='Ref_To_Local'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN256"><span class='Ref_to_Member'>mode</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="internal.c.html#LN276"><span class='Ref_to_Const'>MODE_ECB</span></a><span class='Operator'>: 
</span>            <a href="blf.h.html#LN45"><span class='Ref_to_Proto'>blowfish_decrypt_ecb</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN473"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN473"><span class='Ref_to_Parameter'>dlen</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN476"><span class='Ref_To_Local'>bfctx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="internal.c.html#LN277"><span class='Ref_to_Const'>MODE_CBC</span></a><span class='Operator'>: 
</span>            <a href="blf.h.html#LN43"><span class='Ref_to_Proto'>blowfish_decrypt_cbc</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN473"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN473"><span class='Ref_to_Parameter'>dlen</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN476"><span class='Ref_To_Local'>bfctx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end bf_decrypt &raquo; </span> 
 
<span class='Keyword'>static </span><a href="px.h.html#LN109"><span class='Ref_to_Typedef'>PX_Cipher</span></a> <span class='Operator'>* 
</span><a name="LN498"></a><span class='Declare_Function'>bf_load</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>mode</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN500"></a>    <a href="px.h.html#LN109"><span class='Ref_to_Typedef'>PX_Cipher</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>c</span><span class='Delimiter'>; 
</span><a name="LN501"></a>    <span class='Control'>struct</span> <a href="internal.c.html#LN245"><span class='Ref_to_Struct'>int_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Local'>cx</span><span class='Delimiter'>; 
</span> 
    <a href="internal.c.html#LN500"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= </span><a href="px.h.html#LN43"><span class='Ref_to_Macro'>px_alloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof </span><span class='Operator'>*</span><a href="internal.c.html#LN500"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    memset<span class='Parentheses'>(</span><a href="internal.c.html#LN500"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof </span><span class='Operator'>*</span><a href="internal.c.html#LN500"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="internal.c.html#LN500"><span class='Ref_To_Local'>c</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN155"><span class='Ref_to_Member'>block_size</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN417"><span class='Ref_to_Func'>bf_block_size</span></a><span class='Delimiter'>; 
</span>    <a href="internal.c.html#LN500"><span class='Ref_To_Local'>c</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN156"><span class='Ref_to_Member'>key_size</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN423"><span class='Ref_to_Func'>bf_key_size</span></a><span class='Delimiter'>; 
</span>    <a href="internal.c.html#LN500"><span class='Ref_To_Local'>c</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN157"><span class='Ref_to_Member'>iv_size</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN429"><span class='Ref_to_Func'>bf_iv_size</span></a><span class='Delimiter'>; 
</span>    <a href="internal.c.html#LN500"><span class='Ref_To_Local'>c</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN159"><span class='Ref_to_Member'>init</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN435"><span class='Ref_to_Func'>bf_init</span></a><span class='Delimiter'>; 
</span>    <a href="internal.c.html#LN500"><span class='Ref_To_Local'>c</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN160"><span class='Ref_to_Member'>encrypt</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN447"><span class='Ref_to_Func'>bf_encrypt</span></a><span class='Delimiter'>; 
</span>    <a href="internal.c.html#LN500"><span class='Ref_To_Local'>c</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN161"><span class='Ref_to_Member'>decrypt</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN472"><span class='Ref_to_Func'>bf_decrypt</span></a><span class='Delimiter'>; 
</span>    <a href="internal.c.html#LN500"><span class='Ref_To_Local'>c</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN162"><span class='Ref_to_Member'>free</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN259"><span class='Ref_to_Func'>intctx_free</span></a><span class='Delimiter'>; 
</span> 
    <a href="internal.c.html#LN501"><span class='Ref_To_Local'>cx</span></a> <span class='Operator'>= </span><a href="px.h.html#LN43"><span class='Ref_to_Macro'>px_alloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof </span><span class='Operator'>*</span><a href="internal.c.html#LN501"><span class='Ref_To_Local'>cx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    memset<span class='Parentheses'>(</span><a href="internal.c.html#LN501"><span class='Ref_To_Local'>cx</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof </span><span class='Operator'>*</span><a href="internal.c.html#LN501"><span class='Ref_To_Local'>cx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="internal.c.html#LN501"><span class='Ref_To_Local'>cx</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN256"><span class='Ref_to_Member'>mode</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN498"><span class='Ref_to_Parameter'>mode</span></a><span class='Delimiter'>; 
</span>    <a href="internal.c.html#LN500"><span class='Ref_To_Local'>c</span></a><span class='Operator'>-&GT;</span><a href="px.h.html#LN164"><span class='Ref_to_Member'>ptr</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN501"><span class='Ref_To_Local'>cx</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="internal.c.html#LN500"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end bf_load &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* ciphers */ 
</span> 
<span class='Keyword'>static </span><a href="px.h.html#LN109"><span class='Ref_to_Typedef'>PX_Cipher</span></a> <span class='Operator'>* 
</span><a name="LN524"></a><span class='Declare_Function'>rj_128_ecb</span><span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="internal.c.html#LN388"><span class='Ref_to_Func'>rj_load</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN276"><span class='Ref_to_Const'>MODE_ECB</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static </span><a href="px.h.html#LN109"><span class='Ref_to_Typedef'>PX_Cipher</span></a> <span class='Operator'>* 
</span><a name="LN530"></a><span class='Declare_Function'>rj_128_cbc</span><span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="internal.c.html#LN388"><span class='Ref_to_Func'>rj_load</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN277"><span class='Ref_to_Const'>MODE_CBC</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static </span><a href="px.h.html#LN109"><span class='Ref_to_Typedef'>PX_Cipher</span></a> <span class='Operator'>* 
</span><a name="LN536"></a><span class='Declare_Function'>bf_ecb_load</span><span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="internal.c.html#LN497"><span class='Ref_to_Func'>bf_load</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN276"><span class='Ref_to_Const'>MODE_ECB</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static </span><a href="px.h.html#LN109"><span class='Ref_to_Typedef'>PX_Cipher</span></a> <span class='Operator'>* 
</span><a name="LN542"></a><span class='Declare_Function'>bf_cbc_load</span><span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="internal.c.html#LN497"><span class='Ref_to_Func'>bf_load</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN277"><span class='Ref_to_Const'>MODE_CBC</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a name="LN547"></a><span class='Control'>struct</span> <span class='Declare_Struct'>int_cipher</span> 
<span class='Delimiter'>{ 
</span><a name="LN549"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Member'>name</span><span class='Delimiter'>; 
</span>    <a href="px.h.html#LN109"><span class='Ref_to_Typedef'>PX_Cipher</span></a>  <span class='Operator'>*</span><span class='Parentheses'>(</span><span class='Operator'>*</span>load<span class='Parentheses'>) (</span><span class='Keyword'>void</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
}; 
</span> 
<span class='Keyword'>static const </span><span class='Control'>struct</span> <a href="internal.c.html#LN547"><span class='Ref_to_Struct'>int_cipher</span></a> 
<a name="LN554"></a>            <span class='Declare_Var'>int_ciphers</span><span class='Delimiter'>[] </span><span class='Operator'>= </span><span class='Delimiter'>{ 
</span>    <span class='Delimiter'>{</span><span class='String'>"bf-cbc"</span><span class='Delimiter'>, </span><a href="internal.c.html#LN541"><span class='Ref_to_Func'>bf_cbc_load</span></a><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"bf-ecb"</span><span class='Delimiter'>, </span><a href="internal.c.html#LN535"><span class='Ref_to_Func'>bf_ecb_load</span></a><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"aes-128-cbc"</span><span class='Delimiter'>, </span><a href="internal.c.html#LN529"><span class='Ref_to_Func'>rj_128_cbc</span></a><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"aes-128-ecb"</span><span class='Delimiter'>, </span><a href="internal.c.html#LN523"><span class='Ref_to_Func'>rj_128_ecb</span></a><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>} 
}; 
</span> 
<a name="LN562"></a><span class='Keyword'>static const </span><a href="px.h.html#LN107"><span class='Ref_to_Typedef'>PX_Alias</span></a> <span class='Declare_Var'>int_aliases</span><span class='Delimiter'>[] </span><span class='Operator'>= </span><span class='Delimiter'>{ 
</span>    <span class='Delimiter'>{</span><span class='String'>"bf"</span><span class='Delimiter'>, </span><span class='String'>"bf-cbc"</span><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"blowfish"</span><span class='Delimiter'>, </span><span class='String'>"bf-cbc"</span><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"aes"</span><span class='Delimiter'>, </span><span class='String'>"aes-128-cbc"</span><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"aes-ecb"</span><span class='Delimiter'>, </span><span class='String'>"aes-128-ecb"</span><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"aes-cbc"</span><span class='Delimiter'>, </span><span class='String'>"aes-128-cbc"</span><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"aes-128"</span><span class='Delimiter'>, </span><span class='String'>"aes-128-cbc"</span><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"rijndael"</span><span class='Delimiter'>, </span><span class='String'>"aes-128-cbc"</span><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"rijndael-128"</span><span class='Delimiter'>, </span><span class='String'>"aes-128-cbc"</span><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>} 
}; 
</span> 
<span class='Comment_Multi_Line'>/* PUBLIC FUNCTIONS */ 
</span> 
<span class='Keyword'>int 
</span><a name="LN577"></a><span class='Declare_Function'>px_find_digest</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>name</span><span class='Delimiter'>, </span><a href="px.h.html#LN106"><span class='Ref_to_Typedef'>PX_MD</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>res</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN579"></a>    <span class='Keyword'>const </span><span class='Control'>struct</span> <a href="internal.c.html#LN83"><span class='Ref_to_Struct'>int_digest</span></a> <span class='Operator'>*</span><span class='Declare_Local'>p</span><span class='Delimiter'>; 
</span><a name="LN580"></a>    <a href="px.h.html#LN106"><span class='Ref_to_Typedef'>PX_MD</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>h</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="internal.c.html#LN579"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN90"><span class='Ref_to_Global_Var'>int_digest_list</span></a><span class='Delimiter'>; </span><a href="internal.c.html#LN579"><span class='Ref_To_Local'>p</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN85"><span class='Ref_to_Member'>name</span></a><span class='Delimiter'>; </span><a href="internal.c.html#LN579"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../src/port/pgstrcasecmp.c.html#LN34"><span class='Ref_to_Func'>pg_strcasecmp</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN579"><span class='Ref_To_Local'>p</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN85"><span class='Ref_to_Member'>name</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN577"><span class='Ref_to_Parameter'>name</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="internal.c.html#LN580"><span class='Ref_To_Local'>h</span></a> <span class='Operator'>= </span><a href="px.h.html#LN43"><span class='Ref_to_Macro'>px_alloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="internal.c.html#LN580"><span class='Ref_To_Local'>h</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="internal.c.html#LN579"><span class='Ref_To_Local'>p</span></a><span class='Operator'>-&GT;</span><a href="internal.c.html#LN86"><span class='Ref_to_Member'>init</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN580"><span class='Ref_To_Local'>h</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Operator'>*</span><a href="internal.c.html#LN577"><span class='Ref_to_Parameter'>res</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN580"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>; 
</span> 
            <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="px.h.html#LN63"><span class='Ref_to_Const'>PXE_NO_HASH</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>int 
</span><a name="LN596"></a><span class='Declare_Function'>px_find_cipher</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>name</span><span class='Delimiter'>, </span><a href="px.h.html#LN109"><span class='Ref_to_Typedef'>PX_Cipher</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>res</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN598"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN599"></a>    <a href="px.h.html#LN109"><span class='Ref_to_Typedef'>PX_Cipher</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>c</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <a href="internal.c.html#LN596"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>= </span><a href="px.c.html#LN138"><span class='Ref_to_Func'>px_resolve_alias</span></a><span class='Parentheses'>(</span><a href="internal.c.html#LN562"><span class='Ref_to_Global_Var'>int_aliases</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN596"><span class='Ref_to_Parameter'>name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="internal.c.html#LN598"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="internal.c.html#LN554"><span class='Ref_to_Global_Var'>int_ciphers</span></a><span class='Delimiter'>[</span><a href="internal.c.html#LN598"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="internal.c.html#LN549"><span class='Ref_to_Member'>name</span></a><span class='Delimiter'>; </span><a href="internal.c.html#LN598"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="internal.c.html#LN554"><span class='Ref_to_Global_Var'>int_ciphers</span></a><span class='Delimiter'>[</span><a href="internal.c.html#LN598"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="internal.c.html#LN549"><span class='Ref_to_Member'>name</span></a><span class='Delimiter'>, </span><a href="internal.c.html#LN596"><span class='Ref_to_Parameter'>name</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="internal.c.html#LN599"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN554"><span class='Ref_to_Global_Var'>int_ciphers</span></a><span class='Delimiter'>[</span><a href="internal.c.html#LN598"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span>load<span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="internal.c.html#LN599"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="px.h.html#LN64"><span class='Ref_to_Const'>PXE_NO_CIPHER</span></a><span class='Delimiter'>; 
</span> 
    <span class='Operator'>*</span><a href="internal.c.html#LN596"><span class='Ref_to_Parameter'>res</span></a> <span class='Operator'>= </span><a href="internal.c.html#LN599"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end px_find_cipher &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>