<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\backend\access\brin\brin_inclusion.c</title>
<LINK REL=StyleSheet HREF="../../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\backend\access\brin\brin_inclusion.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:27 2017
</td></tr>
<tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/* 
 * brin_inclusion.c 
 *      Implementation of inclusion opclasses for BRIN 
 * 
 * This module provides framework BRIN support functions for the "inclusion" 
 * operator classes.  A few SQL-level support functions are also required for 
 * each opclass. 
 * 
 * The "inclusion" BRIN strategy is useful for types that support R-Tree 
 * operations.  This implementation is a straight mapping of those operations 
 * to the block-range nature of BRIN, with two exceptions: (a) we explicitly 
 * support "empty" elements: at least with range types, we need to consider 
 * emptiness separately from regular R-Tree strategies; and (b) we need to 
 * consider "unmergeable" elements, that is, a set of elements for whose union 
 * no representation exists.  The only case where that happens as of this 
 * writing is the INET type, where IPv6 values cannot be merged with IPv4 
 * values. 
 * 
 * Portions Copyright (c) 1996-2017, PostgreSQL Global Development Group 
 * Portions Copyright (c) 1994, Regents of the University of California 
 * 
 * IDENTIFICATION 
 *    src/backend/access/brin/brin_inclusion.c 
 */ 
</span><span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>"access/brin_internal.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/brin_tuple.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/genam.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/skey.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_amop.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_type.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/builtins.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/datum.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/lsyscache.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/rel.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/syscache.h"</span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * Additional SQL level support functions 
 * 
 * Procedure numbers must not use values reserved for BRIN itself; see 
 * brin_internal.h. 
 */ 
</span><a name="LN45"></a><span class='Keyword'>#define</span>     <span class='Declare_Constant'>INCLUSION_MAX_PROCNUMS</span>  <span class='Number'>4</span>   <span class='Comment_Single_Line'>/* maximum support procs we need */ 
</span><a name="LN46"></a><span class='Keyword'>#define</span>     <span class='Declare_Constant'>PROCNUM_MERGE</span>           <span class='Number'>11</span>  <span class='Comment_Single_Line'>/* required */ 
</span><a name="LN47"></a><span class='Keyword'>#define</span>     <span class='Declare_Constant'>PROCNUM_MERGEABLE</span>       <span class='Number'>12</span>  <span class='Comment_Single_Line'>/* optional */ 
</span><a name="LN48"></a><span class='Keyword'>#define</span>     <span class='Declare_Constant'>PROCNUM_CONTAINS</span>        <span class='Number'>13</span>  <span class='Comment_Single_Line'>/* optional */ 
</span><a name="LN49"></a><span class='Keyword'>#define</span>     <span class='Declare_Constant'>PROCNUM_EMPTY</span>           <span class='Number'>14</span>  <span class='Comment_Single_Line'>/* optional */ 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * Subtract this from procnum to obtain index in InclusionOpaque arrays 
 * (Must be equal to minimum of private procnums). 
 */ 
</span><a name="LN56"></a><span class='Keyword'>#define</span>     <span class='Declare_Constant'>PROCNUM_BASE</span>            <span class='Number'>11</span> 
 
<span class='Comment_Multi_Line'>/*- 
 * The values stored in the bv_values arrays correspond to: 
 * 
 * 0 - the union of the values in the block range 
 * 1 - whether an empty value is present in any tuple in the block range 
 * 2 - whether the values in the block range cannot be merged (e.g. an IPv6 
 *     address amidst IPv4 addresses). 
 */ 
</span><a name="LN66"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>INCLUSION_UNION</span>             <span class='Number'>0</span> 
<a name="LN67"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>INCLUSION_UNMERGEABLE</span>       <span class='Number'>1</span> 
<a name="LN68"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>INCLUSION_CONTAINS_EMPTY</span>    <span class='Number'>2</span> 
 
 
<a name="LN71"></a><span class='Control'>typedef</span> <span class='Control'>struct</span> <span class='Declare_Struct'>InclusionOpaque</span> 
<span class='Delimiter'>{ 
</span><a name="LN73"></a>    <a href="../../../include/fmgr.h.html#LN55"><span class='Ref_to_Struct'>FmgrInfo</span></a>    <span class='Declare_Member'>extra_procinfos</span><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN45"><span class='Ref_to_Const'>INCLUSION_MAX_PROCNUMS</span></a><span class='Delimiter'>]; 
</span><a name="LN74"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Member'>extra_proc_missing</span><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN45"><span class='Ref_to_Const'>INCLUSION_MAX_PROCNUMS</span></a><span class='Delimiter'>]; 
</span><a name="LN75"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Member'>cached_subtype</span><span class='Delimiter'>; 
</span><a name="LN76"></a>    <a href="../../../include/fmgr.h.html#LN55"><span class='Ref_to_Struct'>FmgrInfo</span></a>    <span class='Declare_Member'>strategy_procinfos</span><span class='Delimiter'>[</span><a href="../../../include/access/stratnum.h.html#LN71"><span class='Ref_to_Const'>RTMaxStrategyNumber</span></a><span class='Delimiter'>]; 
</span><a name="LN77"></a>} <span class='Declare_Typedef'>InclusionOpaque</span><span class='Delimiter'>; 
</span> 
<a name="LN79"></a><span class='Keyword'>static </span><a href="../../../include/fmgr.h.html#LN55"><span class='Ref_to_Struct'>FmgrInfo</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>inclusion_get_procinfo</span><span class='Parentheses'>(</span><a href="../../../include/access/brin_internal.h.html#LN40"><span class='Ref_to_Struct'>BrinDesc</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>bdesc</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a> <span class='Declare_Parameter'>attno</span><span class='Delimiter'>, 
</span><a name="LN80"></a>                       <a href="../../../include/c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a> <span class='Declare_Parameter'>procnum</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN81"></a><span class='Keyword'>static </span><a href="../../../include/fmgr.h.html#LN55"><span class='Ref_to_Struct'>FmgrInfo</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>inclusion_get_strategy_procinfo</span><span class='Parentheses'>(</span><a href="../../../include/access/brin_internal.h.html#LN40"><span class='Ref_to_Struct'>BrinDesc</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>bdesc</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a> <span class='Declare_Parameter'>attno</span><span class='Delimiter'>, 
</span><a name="LN82"></a>                                <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>subtype</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a> <span class='Declare_Parameter'>strategynum</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * BRIN inclusion OpcInfo function 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN89"></a><span class='Declare_Function'>brin_inclusion_opcinfo</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN91"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>typoid</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN92"></a>    <a href="../../../include/access/brin_internal.h.html#LN24"><span class='Ref_to_Struct'>BrinOpcInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN93"></a>    <a href="../../../include/utils/typcache.h.html#LN28"><span class='Ref_to_Struct'>TypeCacheEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>bool_typcache</span> <span class='Operator'>= </span><a href="../../../include/utils/typcache.h.html#LN142"><span class='Ref_to_Proto'>lookup_type_cache</span></a><span class='Parentheses'>(</span><a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN17"><span class='Ref_to_Const'>BOOLOID</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * All members of opaque are initialized lazily; both procinfo arrays 
     * start out as non-initialized by having fn_oid be InvalidOid, and 
     * "missing" to false, by zeroing here.  strategy_procinfos elements can 
     * be invalidated when cached_subtype changes by zeroing fn_oid. 
     * extra_procinfo entries are never invalidated, but if a lookup fails 
     * (which is expected), extra_proc_missing is set to true, indicating not 
     * to look it up again. 
     */ 
</span>    <a href="brin_inclusion.c.html#LN92"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN587"><span class='Ref_to_Macro'>MAXALIGN</span></a><span class='Parentheses'>(</span><a href="../../../include/access/brin_internal.h.html#LN37"><span class='Ref_to_Macro'>SizeofBrinOpcInfo</span></a><span class='Parentheses'>(</span><span class='Number'>3</span><span class='Parentheses'>))</span> <span class='Operator'>+ </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN71"><span class='Ref_to_Struct'>InclusionOpaque</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="brin_inclusion.c.html#LN92"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN27"><span class='Ref_to_Member'>oi_nstored</span></a> <span class='Operator'>= </span><span class='Number'>3</span><span class='Delimiter'>; 
</span>    <a href="brin_inclusion.c.html#LN92"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN30"><span class='Ref_to_Member'>oi_opaque</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN71"><span class='Ref_to_Struct'>InclusionOpaque</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>        <a href="../../../include/c.h.html#LN587"><span class='Ref_to_Macro'>MAXALIGN</span></a><span class='Parentheses'>((</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="brin_inclusion.c.html#LN92"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>+ </span><a href="../../../include/access/brin_internal.h.html#LN37"><span class='Ref_to_Macro'>SizeofBrinOpcInfo</span></a><span class='Parentheses'>(</span><span class='Number'>3</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* the union */ 
</span>    <a href="brin_inclusion.c.html#LN92"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN33"><span class='Ref_to_Member'>oi_typcache</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN66"><span class='Ref_to_Const'>INCLUSION_UNION</span></a><span class='Delimiter'>] </span><span class='Operator'>= 
</span>        <a href="../../../include/utils/typcache.h.html#LN142"><span class='Ref_to_Proto'>lookup_type_cache</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN91"><span class='Ref_To_Local'>typoid</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* includes elements that are not mergeable */ 
</span>    <a href="brin_inclusion.c.html#LN92"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN33"><span class='Ref_to_Member'>oi_typcache</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN67"><span class='Ref_to_Const'>INCLUSION_UNMERGEABLE</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="brin_inclusion.c.html#LN93"><span class='Ref_To_Local'>bool_typcache</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* includes the empty element */ 
</span>    <a href="brin_inclusion.c.html#LN92"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN33"><span class='Ref_to_Member'>oi_typcache</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN68"><span class='Ref_to_Const'>INCLUSION_CONTAINS_EMPTY</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="brin_inclusion.c.html#LN93"><span class='Ref_To_Local'>bool_typcache</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN92"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end brin_inclusion_opcinfo &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * BRIN inclusion add value function 
 * 
 * Examine the given index tuple (which contains partial status of a certain 
 * page range) by comparing it to the given value that comes from another heap 
 * tuple.  If the new value is outside the union specified by the existing 
 * tuple values, update the index tuple and return true.  Otherwise, return 
 * false and do not modify in this case. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN132"></a><span class='Declare_Function'>brin_inclusion_add_value</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN134"></a>    <a href="../../../include/access/brin_internal.h.html#LN40"><span class='Ref_to_Struct'>BrinDesc</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>bdesc</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/access/brin_internal.h.html#LN40"><span class='Ref_to_Struct'>BrinDesc</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN135"></a>    <a href="../../../include/access/brin_tuple.h.html#LN23"><span class='Ref_to_Struct'>BrinValues</span></a> <span class='Operator'>*</span><span class='Declare_Local'>column</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/access/brin_tuple.h.html#LN23"><span class='Ref_to_Struct'>BrinValues</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN136"></a>    <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>newval</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN137"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>isnull</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN238"><span class='Ref_to_Macro'>PG_GETARG_BOOL</span></a><span class='Parentheses'>(</span><span class='Number'>3</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN138"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>colloid</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN162"><span class='Ref_to_Macro'>PG_GET_COLLATION</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span><a name="LN139"></a>    <a href="../../../include/fmgr.h.html#LN55"><span class='Ref_to_Struct'>FmgrInfo</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>finfo</span><span class='Delimiter'>; 
</span><a name="LN140"></a>    <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN141"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>new</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN142"></a>    <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a>  <span class='Declare_Local'>attno</span><span class='Delimiter'>; 
</span><a name="LN143"></a>    <a href="../../../include/catalog/pg_attribute.h.html#LN186"><span class='Ref_to_Typedef'>Form_pg_attribute</span></a> <span class='Declare_Local'>attr</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If the new value is null, we record that we saw it if it's the first 
     * one; otherwise, there's nothing to do. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN137"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN135"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN26"><span class='Ref_to_Member'>bv_hasnulls</span></a><span class='Parentheses'>) 
</span>            <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="brin_inclusion.c.html#LN135"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN26"><span class='Ref_to_Member'>bv_hasnulls</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="brin_inclusion.c.html#LN142"><span class='Ref_To_Local'>attno</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN135"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN25"><span class='Ref_to_Member'>bv_attno</span></a><span class='Delimiter'>; 
</span>    <a href="brin_inclusion.c.html#LN143"><span class='Ref_To_Local'>attr</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN134"><span class='Ref_To_Local'>bdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN49"><span class='Ref_to_Member'>bd_tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/tupdesc.h.html#LN73"><span class='Ref_to_Member'>attrs</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN142"><span class='Ref_To_Local'>attno</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If the recorded value is null, copy the new value (which we know to be 
     * not null), and we're almost done. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN135"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN27"><span class='Ref_to_Member'>bv_allnulls</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="brin_inclusion.c.html#LN135"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN66"><span class='Ref_to_Const'>INCLUSION_UNION</span></a><span class='Delimiter'>] </span><span class='Operator'>= 
</span>            <a href="../../../include/utils/datum.h.html#LN30"><span class='Ref_to_Proto'>datumCopy</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN136"><span class='Ref_To_Local'>newval</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN143"><span class='Ref_To_Local'>attr</span></a><span class='Operator'>-&GT;</span>attbyval<span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN143"><span class='Ref_To_Local'>attr</span></a><span class='Operator'>-&GT;</span>attlen<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="brin_inclusion.c.html#LN135"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN67"><span class='Ref_to_Const'>INCLUSION_UNMERGEABLE</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="brin_inclusion.c.html#LN135"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN68"><span class='Ref_to_Const'>INCLUSION_CONTAINS_EMPTY</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="brin_inclusion.c.html#LN135"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN27"><span class='Ref_to_Member'>bv_allnulls</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Control'>new</span> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * No need for further processing if the block range is marked as 
     * containing unmergeable values. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN135"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN67"><span class='Ref_to_Const'>INCLUSION_UNMERGEABLE</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
        <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If the opclass supports the concept of empty values, test the passed 
     * new value for emptiness; if it returns true, we need to set the 
     * "contains empty" flag in the element (unless already set). 
     */ 
</span>    <a href="brin_inclusion.c.html#LN139"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN79"><span class='Ref_to_Proto'>inclusion_get_procinfo</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN134"><span class='Ref_To_Local'>bdesc</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN142"><span class='Ref_To_Local'>attno</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN49"><span class='Ref_to_Const'>PROCNUM_EMPTY</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN139"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN510"><span class='Ref_to_Proto'>FunctionCall1Coll</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN139"><span class='Ref_To_Local'>finfo</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN138"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN136"><span class='Ref_To_Local'>newval</span></a><span class='Parentheses'>)))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN135"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN68"><span class='Ref_to_Const'>INCLUSION_CONTAINS_EMPTY</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="brin_inclusion.c.html#LN135"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN68"><span class='Ref_to_Const'>INCLUSION_CONTAINS_EMPTY</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Control'>new</span><span class='Parentheses'>) 
</span>        <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Check if the new value is already contained. */ 
</span>    <a href="brin_inclusion.c.html#LN139"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN79"><span class='Ref_to_Proto'>inclusion_get_procinfo</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN134"><span class='Ref_To_Local'>bdesc</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN142"><span class='Ref_To_Local'>attno</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN48"><span class='Ref_to_Const'>PROCNUM_CONTAINS</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN139"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& 
</span>        <a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN512"><span class='Ref_to_Proto'>FunctionCall2Coll</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN139"><span class='Ref_To_Local'>finfo</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN138"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>, 
</span>                                       <a href="brin_inclusion.c.html#LN135"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN66"><span class='Ref_to_Const'>INCLUSION_UNION</span></a><span class='Delimiter'>], 
</span>                                       <a href="brin_inclusion.c.html#LN136"><span class='Ref_To_Local'>newval</span></a><span class='Parentheses'>)))</span> 
        <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Check if the new value is mergeable to the existing union.  If it is 
     * not, mark the value as containing unmergeable elements and get out. 
     * 
     * Note: at this point we could remove the value from the union, since 
     * it's not going to be used any longer.  However, the BRIN framework 
     * doesn't allow for the value not being present.  Improve someday. 
     */ 
</span>    <a href="brin_inclusion.c.html#LN139"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN79"><span class='Ref_to_Proto'>inclusion_get_procinfo</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN134"><span class='Ref_To_Local'>bdesc</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN142"><span class='Ref_To_Local'>attno</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN47"><span class='Ref_to_Const'>PROCNUM_MERGEABLE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN139"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& 
</span>        <span class='Operator'>!</span><a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN512"><span class='Ref_to_Proto'>FunctionCall2Coll</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN139"><span class='Ref_To_Local'>finfo</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN138"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>, 
</span>                                        <a href="brin_inclusion.c.html#LN135"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN66"><span class='Ref_to_Const'>INCLUSION_UNION</span></a><span class='Delimiter'>], 
</span>                                        <a href="brin_inclusion.c.html#LN136"><span class='Ref_To_Local'>newval</span></a><span class='Parentheses'>)))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="brin_inclusion.c.html#LN135"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN67"><span class='Ref_to_Const'>INCLUSION_UNMERGEABLE</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Finally, merge the new value to the existing union. */ 
</span>    <a href="brin_inclusion.c.html#LN139"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN79"><span class='Ref_to_Proto'>inclusion_get_procinfo</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN134"><span class='Ref_To_Local'>bdesc</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN142"><span class='Ref_To_Local'>attno</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN46"><span class='Ref_to_Const'>PROCNUM_MERGE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN139"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="brin_inclusion.c.html#LN140"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN512"><span class='Ref_to_Proto'>FunctionCall2Coll</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN139"><span class='Ref_To_Local'>finfo</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN138"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>, 
</span>                               <a href="brin_inclusion.c.html#LN135"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN66"><span class='Ref_to_Const'>INCLUSION_UNION</span></a><span class='Delimiter'>], </span><a href="brin_inclusion.c.html#LN136"><span class='Ref_To_Local'>newval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="brin_inclusion.c.html#LN143"><span class='Ref_To_Local'>attr</span></a><span class='Operator'>-&GT;</span>attbyval<span class='Parentheses'>) 
</span>        <a href="../../../include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="../../../include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN135"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN66"><span class='Ref_to_Const'>INCLUSION_UNION</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="brin_inclusion.c.html#LN135"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN66"><span class='Ref_to_Const'>INCLUSION_UNION</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="brin_inclusion.c.html#LN140"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end brin_inclusion_add_value &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * BRIN inclusion consistent function 
 * 
 * All of the strategies are optional. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN246"></a><span class='Declare_Function'>brin_inclusion_consistent</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN248"></a>    <a href="../../../include/access/brin_internal.h.html#LN40"><span class='Ref_to_Struct'>BrinDesc</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>bdesc</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/access/brin_internal.h.html#LN40"><span class='Ref_to_Struct'>BrinDesc</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN249"></a>    <a href="../../../include/access/brin_tuple.h.html#LN23"><span class='Ref_to_Struct'>BrinValues</span></a> <span class='Operator'>*</span><span class='Declare_Local'>column</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/access/brin_tuple.h.html#LN23"><span class='Ref_to_Struct'>BrinValues</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN250"></a>    <a href="../../../include/access/skey.h.html#LN74"><span class='Ref_to_Typedef'>ScanKey</span></a>     <span class='Declare_Local'>key</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/access/skey.h.html#LN74"><span class='Ref_to_Typedef'>ScanKey</span></a><span class='Parentheses'>) </span><a href="../../../include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN251"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>colloid</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN162"><span class='Ref_to_Macro'>PG_GET_COLLATION</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, 
</span><a name="LN252"></a>                <span class='Declare_Local'>subtype</span><span class='Delimiter'>; 
</span><a name="LN253"></a>    <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>unionval</span><span class='Delimiter'>; 
</span><a name="LN254"></a>    <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a>  <span class='Declare_Local'>attno</span><span class='Delimiter'>; 
</span><a name="LN255"></a>    <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>query</span><span class='Delimiter'>; 
</span><a name="LN256"></a>    <a href="../../../include/fmgr.h.html#LN55"><span class='Ref_to_Struct'>FmgrInfo</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>finfo</span><span class='Delimiter'>; 
</span><a name="LN257"></a>    <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN250"><span class='Ref_To_Local'>key</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/skey.h.html#LN66"><span class='Ref_to_Member'>sk_attno</span></a> <span class='Operator'>== </span><a href="brin_inclusion.c.html#LN249"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN25"><span class='Ref_to_Member'>bv_attno</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Handle IS NULL/IS NOT NULL tests. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN250"><span class='Ref_To_Local'>key</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/skey.h.html#LN65"><span class='Ref_to_Member'>sk_flags</span></a> <span class='Operator'>& </span><a href="../../../include/access/skey.h.html#LN114"><span class='Ref_to_Const'>SK_ISNULL</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN250"><span class='Ref_To_Local'>key</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/skey.h.html#LN65"><span class='Ref_to_Member'>sk_flags</span></a> <span class='Operator'>& </span><a href="../../../include/access/skey.h.html#LN120"><span class='Ref_to_Const'>SK_SEARCHNULL</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN249"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN27"><span class='Ref_to_Member'>bv_allnulls</span></a> <span class='Operator'>|| </span><a href="brin_inclusion.c.html#LN249"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN26"><span class='Ref_to_Member'>bv_hasnulls</span></a><span class='Parentheses'>) 
</span>                <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * For IS NOT NULL, we can only skip ranges that are known to have 
         * only nulls. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN250"><span class='Ref_To_Local'>key</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/skey.h.html#LN65"><span class='Ref_to_Member'>sk_flags</span></a> <span class='Operator'>& </span><a href="../../../include/access/skey.h.html#LN121"><span class='Ref_to_Const'>SK_SEARCHNOTNULL</span></a><span class='Parentheses'>) 
</span>            <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="brin_inclusion.c.html#LN249"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN27"><span class='Ref_to_Member'>bv_allnulls</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Neither IS NULL nor IS NOT NULL was used; assume all indexable 
         * operators are strict and return false. 
         */ 
</span>        <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if key-&GT;sk_flags&SK_ISNU... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* If it is all nulls, it cannot possibly be consistent. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN249"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN27"><span class='Ref_to_Member'>bv_allnulls</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* It has to be checked, if it contains elements that are not mergeable. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN249"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN67"><span class='Ref_to_Const'>INCLUSION_UNMERGEABLE</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
        <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="brin_inclusion.c.html#LN254"><span class='Ref_To_Local'>attno</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN250"><span class='Ref_To_Local'>key</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/skey.h.html#LN66"><span class='Ref_to_Member'>sk_attno</span></a><span class='Delimiter'>; 
</span>    <a href="brin_inclusion.c.html#LN252"><span class='Ref_To_Local'>subtype</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN250"><span class='Ref_To_Local'>key</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/skey.h.html#LN68"><span class='Ref_to_Member'>sk_subtype</span></a><span class='Delimiter'>; 
</span>    <a href="brin_inclusion.c.html#LN255"><span class='Ref_To_Local'>query</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN250"><span class='Ref_To_Local'>key</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/skey.h.html#LN71"><span class='Ref_to_Member'>sk_argument</span></a><span class='Delimiter'>; 
</span>    <a href="brin_inclusion.c.html#LN253"><span class='Ref_To_Local'>unionval</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN249"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN66"><span class='Ref_to_Const'>INCLUSION_UNION</span></a><span class='Delimiter'>]; 
</span>    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN250"><span class='Ref_To_Local'>key</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/skey.h.html#LN67"><span class='Ref_to_Member'>sk_strategy</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * Placement strategies 
             * 
             * These are implemented by logically negating the result of the 
             * converse placement operator; for this to work, the converse 
             * operator must be part of the opclass.  An error will be thrown 
             * by inclusion_get_strategy_procinfo() if the required strategy 
             * is not part of the opclass. 
             * 
             * These all return false if either argument is empty, so there is 
             * no need to check for empty elements. 
             */ 
</span> 
        <span class='Control'>case</span> <a href="../../../include/access/stratnum.h.html#LN43"><span class='Ref_to_Const'>RTLeftStrategyNumber</span></a><span class='Operator'>: 
</span>            <a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN81"><span class='Ref_to_Proto'>inclusion_get_strategy_procinfo</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN248"><span class='Ref_To_Local'>bdesc</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN254"><span class='Ref_To_Local'>attno</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN252"><span class='Ref_To_Local'>subtype</span></a><span class='Delimiter'>, 
</span>                                                  <a href="../../../include/access/stratnum.h.html#LN46"><span class='Ref_to_Const'>RTOverRightStrategyNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN512"><span class='Ref_to_Proto'>FunctionCall2Coll</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN251"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN253"><span class='Ref_To_Local'>unionval</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN255"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/access/stratnum.h.html#LN44"><span class='Ref_to_Const'>RTOverLeftStrategyNumber</span></a><span class='Operator'>: 
</span>            <a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN81"><span class='Ref_to_Proto'>inclusion_get_strategy_procinfo</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN248"><span class='Ref_To_Local'>bdesc</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN254"><span class='Ref_To_Local'>attno</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN252"><span class='Ref_To_Local'>subtype</span></a><span class='Delimiter'>, 
</span>                                                    <a href="../../../include/access/stratnum.h.html#LN47"><span class='Ref_to_Const'>RTRightStrategyNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN512"><span class='Ref_to_Proto'>FunctionCall2Coll</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN251"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN253"><span class='Ref_To_Local'>unionval</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN255"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/access/stratnum.h.html#LN46"><span class='Ref_to_Const'>RTOverRightStrategyNumber</span></a><span class='Operator'>: 
</span>            <a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN81"><span class='Ref_to_Proto'>inclusion_get_strategy_procinfo</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN248"><span class='Ref_To_Local'>bdesc</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN254"><span class='Ref_To_Local'>attno</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN252"><span class='Ref_To_Local'>subtype</span></a><span class='Delimiter'>, 
</span>                                                    <a href="../../../include/access/stratnum.h.html#LN43"><span class='Ref_to_Const'>RTLeftStrategyNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN512"><span class='Ref_to_Proto'>FunctionCall2Coll</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN251"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN253"><span class='Ref_To_Local'>unionval</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN255"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/access/stratnum.h.html#LN47"><span class='Ref_to_Const'>RTRightStrategyNumber</span></a><span class='Operator'>: 
</span>            <a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN81"><span class='Ref_to_Proto'>inclusion_get_strategy_procinfo</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN248"><span class='Ref_To_Local'>bdesc</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN254"><span class='Ref_To_Local'>attno</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN252"><span class='Ref_To_Local'>subtype</span></a><span class='Delimiter'>, 
</span>                                                    <a href="../../../include/access/stratnum.h.html#LN44"><span class='Ref_to_Const'>RTOverLeftStrategyNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN512"><span class='Ref_to_Proto'>FunctionCall2Coll</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN251"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN253"><span class='Ref_To_Local'>unionval</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN255"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/access/stratnum.h.html#LN52"><span class='Ref_to_Const'>RTBelowStrategyNumber</span></a><span class='Operator'>: 
</span>            <a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN81"><span class='Ref_to_Proto'>inclusion_get_strategy_procinfo</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN248"><span class='Ref_To_Local'>bdesc</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN254"><span class='Ref_To_Local'>attno</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN252"><span class='Ref_To_Local'>subtype</span></a><span class='Delimiter'>, 
</span>                                                  <a href="../../../include/access/stratnum.h.html#LN54"><span class='Ref_to_Const'>RTOverAboveStrategyNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN512"><span class='Ref_to_Proto'>FunctionCall2Coll</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN251"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN253"><span class='Ref_To_Local'>unionval</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN255"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/access/stratnum.h.html#LN51"><span class='Ref_to_Const'>RTOverBelowStrategyNumber</span></a><span class='Operator'>: 
</span>            <a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN81"><span class='Ref_to_Proto'>inclusion_get_strategy_procinfo</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN248"><span class='Ref_To_Local'>bdesc</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN254"><span class='Ref_To_Local'>attno</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN252"><span class='Ref_To_Local'>subtype</span></a><span class='Delimiter'>, 
</span>                                                    <a href="../../../include/access/stratnum.h.html#LN53"><span class='Ref_to_Const'>RTAboveStrategyNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN512"><span class='Ref_to_Proto'>FunctionCall2Coll</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN251"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN253"><span class='Ref_To_Local'>unionval</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN255"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/access/stratnum.h.html#LN54"><span class='Ref_to_Const'>RTOverAboveStrategyNumber</span></a><span class='Operator'>: 
</span>            <a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN81"><span class='Ref_to_Proto'>inclusion_get_strategy_procinfo</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN248"><span class='Ref_To_Local'>bdesc</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN254"><span class='Ref_To_Local'>attno</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN252"><span class='Ref_To_Local'>subtype</span></a><span class='Delimiter'>, 
</span>                                                    <a href="../../../include/access/stratnum.h.html#LN52"><span class='Ref_to_Const'>RTBelowStrategyNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN512"><span class='Ref_to_Proto'>FunctionCall2Coll</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN251"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN253"><span class='Ref_To_Local'>unionval</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN255"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/access/stratnum.h.html#LN53"><span class='Ref_to_Const'>RTAboveStrategyNumber</span></a><span class='Operator'>: 
</span>            <a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN81"><span class='Ref_to_Proto'>inclusion_get_strategy_procinfo</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN248"><span class='Ref_To_Local'>bdesc</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN254"><span class='Ref_To_Local'>attno</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN252"><span class='Ref_To_Local'>subtype</span></a><span class='Delimiter'>, 
</span>                                                  <a href="../../../include/access/stratnum.h.html#LN51"><span class='Ref_to_Const'>RTOverBelowStrategyNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN512"><span class='Ref_to_Proto'>FunctionCall2Coll</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN251"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN253"><span class='Ref_To_Local'>unionval</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN255"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Overlap and contains strategies 
             * 
             * These strategies are simple enough that we can simply call the 
             * operator and return its result.  Empty elements don't change 
             * the result. 
             */ 
</span> 
        <span class='Control'>case</span> <a href="../../../include/access/stratnum.h.html#LN45"><span class='Ref_to_Const'>RTOverlapStrategyNumber</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/access/stratnum.h.html#LN49"><span class='Ref_to_Const'>RTContainsStrategyNumber</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/access/stratnum.h.html#LN55"><span class='Ref_to_Const'>RTOldContainsStrategyNumber</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/access/stratnum.h.html#LN58"><span class='Ref_to_Const'>RTContainsElemStrategyNumber</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/access/stratnum.h.html#LN66"><span class='Ref_to_Const'>RTSubStrategyNumber</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/access/stratnum.h.html#LN67"><span class='Ref_to_Const'>RTSubEqualStrategyNumber</span></a><span class='Operator'>: 
</span>            <a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN81"><span class='Ref_to_Proto'>inclusion_get_strategy_procinfo</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN248"><span class='Ref_To_Local'>bdesc</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN254"><span class='Ref_To_Local'>attno</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN252"><span class='Ref_To_Local'>subtype</span></a><span class='Delimiter'>, 
</span>                                                    <a href="brin_inclusion.c.html#LN250"><span class='Ref_To_Local'>key</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/skey.h.html#LN67"><span class='Ref_to_Member'>sk_strategy</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN512"><span class='Ref_to_Proto'>FunctionCall2Coll</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN251"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN253"><span class='Ref_To_Local'>unionval</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN255"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../../include/fmgr.h.html#LN312"><span class='Ref_to_Macro'>PG_RETURN_DATUM</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Contained by strategies 
             * 
             * We cannot just call the original operator for the contained by 
             * strategies because some elements can be contained even though 
             * the union is not; instead we use the overlap operator. 
             * 
             * We check for empty elements separately as they are not merged 
             * to the union but contained by everything. 
             */ 
</span> 
        <span class='Control'>case</span> <a href="../../../include/access/stratnum.h.html#LN50"><span class='Ref_to_Const'>RTContainedByStrategyNumber</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/access/stratnum.h.html#LN56"><span class='Ref_to_Const'>RTOldContainedByStrategyNumber</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/access/stratnum.h.html#LN68"><span class='Ref_to_Const'>RTSuperStrategyNumber</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/access/stratnum.h.html#LN69"><span class='Ref_to_Const'>RTSuperEqualStrategyNumber</span></a><span class='Operator'>: 
</span>            <a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN81"><span class='Ref_to_Proto'>inclusion_get_strategy_procinfo</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN248"><span class='Ref_To_Local'>bdesc</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN254"><span class='Ref_To_Local'>attno</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN252"><span class='Ref_To_Local'>subtype</span></a><span class='Delimiter'>, 
</span>                                                    <a href="../../../include/access/stratnum.h.html#LN45"><span class='Ref_to_Const'>RTOverlapStrategyNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN512"><span class='Ref_to_Proto'>FunctionCall2Coll</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN251"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN253"><span class='Ref_To_Local'>unionval</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN255"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span> 
                <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="../../../include/fmgr.h.html#LN312"><span class='Ref_to_Macro'>PG_RETURN_DATUM</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN249"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN68"><span class='Ref_to_Const'>INCLUSION_CONTAINS_EMPTY</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Adjacent strategy 
             * 
             * We test for overlap first but to be safe we need to call the 
             * actual adjacent operator also. 
             * 
             * An empty element cannot be adjacent to any other, so there is 
             * no need to check for it. 
             */ 
</span> 
        <span class='Control'>case</span> <a href="../../../include/access/stratnum.h.html#LN59"><span class='Ref_to_Const'>RTAdjacentStrategyNumber</span></a><span class='Operator'>: 
</span>            <a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN81"><span class='Ref_to_Proto'>inclusion_get_strategy_procinfo</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN248"><span class='Ref_To_Local'>bdesc</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN254"><span class='Ref_To_Local'>attno</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN252"><span class='Ref_To_Local'>subtype</span></a><span class='Delimiter'>, 
</span>                                                    <a href="../../../include/access/stratnum.h.html#LN45"><span class='Ref_to_Const'>RTOverlapStrategyNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN512"><span class='Ref_to_Proto'>FunctionCall2Coll</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN251"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN253"><span class='Ref_To_Local'>unionval</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN255"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span> 
                <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN81"><span class='Ref_to_Proto'>inclusion_get_strategy_procinfo</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN248"><span class='Ref_To_Local'>bdesc</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN254"><span class='Ref_To_Local'>attno</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN252"><span class='Ref_To_Local'>subtype</span></a><span class='Delimiter'>, 
</span>                                                    <a href="../../../include/access/stratnum.h.html#LN59"><span class='Ref_to_Const'>RTAdjacentStrategyNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN512"><span class='Ref_to_Proto'>FunctionCall2Coll</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN251"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN253"><span class='Ref_To_Local'>unionval</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN255"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../../include/fmgr.h.html#LN312"><span class='Ref_to_Macro'>PG_RETURN_DATUM</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Basic comparison strategies 
             * 
             * It is straightforward to support the equality strategies with 
             * the contains operator.  Generally, inequality strategies do not 
             * make much sense for the types which will be used with the 
             * inclusion BRIN family of opclasses, but is possible to 
             * implement them with logical negation of the left-of and 
             * right-of operators. 
             * 
             * NB: These strategies cannot be used with geometric datatypes 
             * that use comparison of areas!  The only exception is the "same" 
             * strategy. 
             * 
             * Empty elements are considered to be less than the others.  We 
             * cannot use the empty support function to check the query is an 
             * empty element, because the query can be another data type than 
             * the empty support function argument.  So we will return true, 
             * if there is a possibility that empty elements will change the 
             * result. 
             */ 
</span> 
        <span class='Control'>case</span> <a href="../../../include/access/stratnum.h.html#LN62"><span class='Ref_to_Const'>RTLessStrategyNumber</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/access/stratnum.h.html#LN63"><span class='Ref_to_Const'>RTLessEqualStrategyNumber</span></a><span class='Operator'>: 
</span>            <a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN81"><span class='Ref_to_Proto'>inclusion_get_strategy_procinfo</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN248"><span class='Ref_To_Local'>bdesc</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN254"><span class='Ref_To_Local'>attno</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN252"><span class='Ref_To_Local'>subtype</span></a><span class='Delimiter'>, 
</span>                                                    <a href="../../../include/access/stratnum.h.html#LN47"><span class='Ref_to_Const'>RTRightStrategyNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN512"><span class='Ref_to_Proto'>FunctionCall2Coll</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN251"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN253"><span class='Ref_To_Local'>unionval</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN255"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span> 
                <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="../../../include/fmgr.h.html#LN312"><span class='Ref_to_Macro'>PG_RETURN_DATUM</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN249"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN68"><span class='Ref_to_Const'>INCLUSION_CONTAINS_EMPTY</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/access/stratnum.h.html#LN48"><span class='Ref_to_Const'>RTSameStrategyNumber</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/access/stratnum.h.html#LN60"><span class='Ref_to_Const'>RTEqualStrategyNumber</span></a><span class='Operator'>: 
</span>            <a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN81"><span class='Ref_to_Proto'>inclusion_get_strategy_procinfo</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN248"><span class='Ref_To_Local'>bdesc</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN254"><span class='Ref_To_Local'>attno</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN252"><span class='Ref_To_Local'>subtype</span></a><span class='Delimiter'>, 
</span>                                                    <a href="../../../include/access/stratnum.h.html#LN49"><span class='Ref_to_Const'>RTContainsStrategyNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN512"><span class='Ref_to_Proto'>FunctionCall2Coll</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN251"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN253"><span class='Ref_To_Local'>unionval</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN255"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span> 
                <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="../../../include/fmgr.h.html#LN312"><span class='Ref_to_Macro'>PG_RETURN_DATUM</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN249"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN68"><span class='Ref_to_Const'>INCLUSION_CONTAINS_EMPTY</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/access/stratnum.h.html#LN65"><span class='Ref_to_Const'>RTGreaterEqualStrategyNumber</span></a><span class='Operator'>: 
</span>            <a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN81"><span class='Ref_to_Proto'>inclusion_get_strategy_procinfo</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN248"><span class='Ref_To_Local'>bdesc</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN254"><span class='Ref_To_Local'>attno</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN252"><span class='Ref_To_Local'>subtype</span></a><span class='Delimiter'>, 
</span>                                                    <a href="../../../include/access/stratnum.h.html#LN43"><span class='Ref_to_Const'>RTLeftStrategyNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN512"><span class='Ref_to_Proto'>FunctionCall2Coll</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN251"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN253"><span class='Ref_To_Local'>unionval</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN255"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span> 
                <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="../../../include/fmgr.h.html#LN312"><span class='Ref_to_Macro'>PG_RETURN_DATUM</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN249"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN68"><span class='Ref_to_Const'>INCLUSION_CONTAINS_EMPTY</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/access/stratnum.h.html#LN64"><span class='Ref_to_Const'>RTGreaterStrategyNumber</span></a><span class='Operator'>: 
</span>            <span class='Comment_Multi_Line'>/* no need to check for empty elements */ 
</span>            <a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN81"><span class='Ref_to_Proto'>inclusion_get_strategy_procinfo</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN248"><span class='Ref_To_Local'>bdesc</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN254"><span class='Ref_To_Local'>attno</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN252"><span class='Ref_To_Local'>subtype</span></a><span class='Delimiter'>, 
</span>                                                    <a href="../../../include/access/stratnum.h.html#LN43"><span class='Ref_to_Const'>RTLeftStrategyNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN512"><span class='Ref_to_Proto'>FunctionCall2Coll</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN256"><span class='Ref_To_Local'>finfo</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN251"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN253"><span class='Ref_To_Local'>unionval</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN255"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN257"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>default</span><span class='Operator'>: 
</span>            <span class='Comment_Multi_Line'>/* shouldn't happen */ 
</span>            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"invalid strategy number %d"</span><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN250"><span class='Ref_To_Local'>key</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/skey.h.html#LN67"><span class='Ref_to_Member'>sk_strategy</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch key-&GT;sk_strategy &raquo; </span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end brin_inclusion_consistent &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * BRIN inclusion union function 
 * 
 * Given two BrinValues, update the first of them as a union of the summary 
 * values contained in both.  The second one is untouched. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN496"></a><span class='Declare_Function'>brin_inclusion_union</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN498"></a>    <a href="../../../include/access/brin_internal.h.html#LN40"><span class='Ref_to_Struct'>BrinDesc</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>bdesc</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/access/brin_internal.h.html#LN40"><span class='Ref_to_Struct'>BrinDesc</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN499"></a>    <a href="../../../include/access/brin_tuple.h.html#LN23"><span class='Ref_to_Struct'>BrinValues</span></a> <span class='Operator'>*</span><span class='Declare_Local'>col_a</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/access/brin_tuple.h.html#LN23"><span class='Ref_to_Struct'>BrinValues</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN500"></a>    <a href="../../../include/access/brin_tuple.h.html#LN23"><span class='Ref_to_Struct'>BrinValues</span></a> <span class='Operator'>*</span><span class='Declare_Local'>col_b</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/access/brin_tuple.h.html#LN23"><span class='Ref_to_Struct'>BrinValues</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN501"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>colloid</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN162"><span class='Ref_to_Macro'>PG_GET_COLLATION</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span><a name="LN502"></a>    <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a>  <span class='Declare_Local'>attno</span><span class='Delimiter'>; 
</span><a name="LN503"></a>    <a href="../../../include/catalog/pg_attribute.h.html#LN186"><span class='Ref_to_Typedef'>Form_pg_attribute</span></a> <span class='Declare_Local'>attr</span><span class='Delimiter'>; 
</span><a name="LN504"></a>    <a href="../../../include/fmgr.h.html#LN55"><span class='Ref_to_Struct'>FmgrInfo</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>finfo</span><span class='Delimiter'>; 
</span><a name="LN505"></a>    <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN499"><span class='Ref_To_Local'>col_a</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN25"><span class='Ref_to_Member'>bv_attno</span></a> <span class='Operator'>== </span><a href="brin_inclusion.c.html#LN500"><span class='Ref_To_Local'>col_b</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN25"><span class='Ref_to_Member'>bv_attno</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Adjust "hasnulls". */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="brin_inclusion.c.html#LN499"><span class='Ref_To_Local'>col_a</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN26"><span class='Ref_to_Member'>bv_hasnulls</span></a> <span class='Operator'>&& </span><a href="brin_inclusion.c.html#LN500"><span class='Ref_To_Local'>col_b</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN26"><span class='Ref_to_Member'>bv_hasnulls</span></a><span class='Parentheses'>) 
</span>        <a href="brin_inclusion.c.html#LN499"><span class='Ref_To_Local'>col_a</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN26"><span class='Ref_to_Member'>bv_hasnulls</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* If there are no values in B, there's nothing left to do. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN500"><span class='Ref_To_Local'>col_b</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN27"><span class='Ref_to_Member'>bv_allnulls</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/fmgr.h.html#LN308"><span class='Ref_to_Macro'>PG_RETURN_VOID</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="brin_inclusion.c.html#LN502"><span class='Ref_To_Local'>attno</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN499"><span class='Ref_To_Local'>col_a</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN25"><span class='Ref_to_Member'>bv_attno</span></a><span class='Delimiter'>; 
</span>    <a href="brin_inclusion.c.html#LN503"><span class='Ref_To_Local'>attr</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN498"><span class='Ref_To_Local'>bdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN49"><span class='Ref_to_Member'>bd_tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/tupdesc.h.html#LN73"><span class='Ref_to_Member'>attrs</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN502"><span class='Ref_To_Local'>attno</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Adjust "allnulls".  If A doesn't have values, just copy the values from 
     * B into A, and we're done.  We cannot run the operators in this case, 
     * because values in A might contain garbage.  Note we already established 
     * that B contains values. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN499"><span class='Ref_To_Local'>col_a</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN27"><span class='Ref_to_Member'>bv_allnulls</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="brin_inclusion.c.html#LN499"><span class='Ref_To_Local'>col_a</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN27"><span class='Ref_to_Member'>bv_allnulls</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="brin_inclusion.c.html#LN499"><span class='Ref_To_Local'>col_a</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN66"><span class='Ref_to_Const'>INCLUSION_UNION</span></a><span class='Delimiter'>] </span><span class='Operator'>= 
</span>            <a href="../../../include/utils/datum.h.html#LN30"><span class='Ref_to_Proto'>datumCopy</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN500"><span class='Ref_To_Local'>col_b</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN66"><span class='Ref_to_Const'>INCLUSION_UNION</span></a><span class='Delimiter'>], 
</span>                      <a href="brin_inclusion.c.html#LN503"><span class='Ref_To_Local'>attr</span></a><span class='Operator'>-&GT;</span>attbyval<span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN503"><span class='Ref_To_Local'>attr</span></a><span class='Operator'>-&GT;</span>attlen<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="brin_inclusion.c.html#LN499"><span class='Ref_To_Local'>col_a</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN67"><span class='Ref_to_Const'>INCLUSION_UNMERGEABLE</span></a><span class='Delimiter'>] </span><span class='Operator'>= 
</span>            <a href="brin_inclusion.c.html#LN500"><span class='Ref_To_Local'>col_b</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN67"><span class='Ref_to_Const'>INCLUSION_UNMERGEABLE</span></a><span class='Delimiter'>]; 
</span>        <a href="brin_inclusion.c.html#LN499"><span class='Ref_To_Local'>col_a</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN68"><span class='Ref_to_Const'>INCLUSION_CONTAINS_EMPTY</span></a><span class='Delimiter'>] </span><span class='Operator'>= 
</span>            <a href="brin_inclusion.c.html#LN500"><span class='Ref_To_Local'>col_b</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN68"><span class='Ref_to_Const'>INCLUSION_CONTAINS_EMPTY</span></a><span class='Delimiter'>]; 
</span>        <a href="../../../include/fmgr.h.html#LN308"><span class='Ref_to_Macro'>PG_RETURN_VOID</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* If B includes empty elements, mark A similarly, if needed. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN499"><span class='Ref_To_Local'>col_a</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN68"><span class='Ref_to_Const'>INCLUSION_CONTAINS_EMPTY</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>        <a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN500"><span class='Ref_To_Local'>col_b</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN68"><span class='Ref_to_Const'>INCLUSION_CONTAINS_EMPTY</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
        <a href="brin_inclusion.c.html#LN499"><span class='Ref_To_Local'>col_a</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN68"><span class='Ref_to_Const'>INCLUSION_CONTAINS_EMPTY</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Check if A includes elements that are not mergeable. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN499"><span class='Ref_To_Local'>col_a</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN67"><span class='Ref_to_Const'>INCLUSION_UNMERGEABLE</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
        <a href="../../../include/fmgr.h.html#LN308"><span class='Ref_to_Macro'>PG_RETURN_VOID</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* If B includes elements that are not mergeable, mark A similarly. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN500"><span class='Ref_To_Local'>col_b</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN67"><span class='Ref_to_Const'>INCLUSION_UNMERGEABLE</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="brin_inclusion.c.html#LN499"><span class='Ref_To_Local'>col_a</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN67"><span class='Ref_to_Const'>INCLUSION_UNMERGEABLE</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/fmgr.h.html#LN308"><span class='Ref_to_Macro'>PG_RETURN_VOID</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Check if A and B are mergeable; if not, mark A unmergeable. */ 
</span>    <a href="brin_inclusion.c.html#LN504"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN79"><span class='Ref_to_Proto'>inclusion_get_procinfo</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN498"><span class='Ref_To_Local'>bdesc</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN502"><span class='Ref_To_Local'>attno</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN47"><span class='Ref_to_Const'>PROCNUM_MERGEABLE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN504"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& 
</span>        <span class='Operator'>!</span><a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN512"><span class='Ref_to_Proto'>FunctionCall2Coll</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN504"><span class='Ref_To_Local'>finfo</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN501"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>, 
</span>                                        <a href="brin_inclusion.c.html#LN499"><span class='Ref_To_Local'>col_a</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN66"><span class='Ref_to_Const'>INCLUSION_UNION</span></a><span class='Delimiter'>], 
</span>                                        <a href="brin_inclusion.c.html#LN500"><span class='Ref_To_Local'>col_b</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN66"><span class='Ref_to_Const'>INCLUSION_UNION</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="brin_inclusion.c.html#LN499"><span class='Ref_To_Local'>col_a</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN67"><span class='Ref_to_Const'>INCLUSION_UNMERGEABLE</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/fmgr.h.html#LN308"><span class='Ref_to_Macro'>PG_RETURN_VOID</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Finally, merge B to A. */ 
</span>    <a href="brin_inclusion.c.html#LN504"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN79"><span class='Ref_to_Proto'>inclusion_get_procinfo</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN498"><span class='Ref_To_Local'>bdesc</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN502"><span class='Ref_To_Local'>attno</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN46"><span class='Ref_to_Const'>PROCNUM_MERGE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN504"><span class='Ref_To_Local'>finfo</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="brin_inclusion.c.html#LN505"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN512"><span class='Ref_to_Proto'>FunctionCall2Coll</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN504"><span class='Ref_To_Local'>finfo</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN501"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>, 
</span>                               <a href="brin_inclusion.c.html#LN499"><span class='Ref_To_Local'>col_a</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN66"><span class='Ref_to_Const'>INCLUSION_UNION</span></a><span class='Delimiter'>], 
</span>                               <a href="brin_inclusion.c.html#LN500"><span class='Ref_To_Local'>col_b</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN66"><span class='Ref_to_Const'>INCLUSION_UNION</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="brin_inclusion.c.html#LN503"><span class='Ref_To_Local'>attr</span></a><span class='Operator'>-&GT;</span>attbyval<span class='Parentheses'>) 
</span>        <a href="../../../include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="../../../include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN499"><span class='Ref_To_Local'>col_a</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN66"><span class='Ref_to_Const'>INCLUSION_UNION</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="brin_inclusion.c.html#LN499"><span class='Ref_To_Local'>col_a</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN66"><span class='Ref_to_Const'>INCLUSION_UNION</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="brin_inclusion.c.html#LN505"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN308"><span class='Ref_to_Macro'>PG_RETURN_VOID</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end brin_inclusion_union &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Cache and return inclusion opclass support procedure 
 * 
 * Return the procedure corresponding to the given function support number 
 * or null if it is not exists. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/fmgr.h.html#LN55"><span class='Ref_to_Struct'>FmgrInfo</span></a> <span class='Operator'>* 
</span><a name="LN586"></a><span class='Declare_Function'>inclusion_get_procinfo</span><span class='Parentheses'>(</span><a href="../../../include/access/brin_internal.h.html#LN40"><span class='Ref_to_Struct'>BrinDesc</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>bdesc</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a> <span class='Declare_Parameter'>attno</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a> <span class='Declare_Parameter'>procnum</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN588"></a>    <a href="brin_inclusion.c.html#LN71"><span class='Ref_to_Struct'>InclusionOpaque</span></a> <span class='Operator'>*</span><span class='Declare_Local'>opaque</span><span class='Delimiter'>; 
</span><a name="LN589"></a>    <a href="../../../include/c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a>      <span class='Declare_Local'>basenum</span> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN586"><span class='Ref_to_Parameter'>procnum</span></a> <span class='Operator'>- </span><a href="brin_inclusion.c.html#LN56"><span class='Ref_to_Const'>PROCNUM_BASE</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We cache these in the opaque struct, to avoid repetitive syscache 
     * lookups. 
     */ 
</span>    <a href="brin_inclusion.c.html#LN588"><span class='Ref_To_Local'>opaque</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN71"><span class='Ref_to_Struct'>InclusionOpaque</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="brin_inclusion.c.html#LN586"><span class='Ref_to_Parameter'>bdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN58"><span class='Ref_to_Member'>bd_info</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN586"><span class='Ref_to_Parameter'>attno</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN30"><span class='Ref_to_Member'>oi_opaque</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If we already searched for this proc and didn't find it, don't bother 
     * searching again. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN588"><span class='Ref_To_Local'>opaque</span></a><span class='Operator'>-&GT;</span><a href="brin_inclusion.c.html#LN74"><span class='Ref_to_Member'>extra_proc_missing</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN589"><span class='Ref_To_Local'>basenum</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN588"><span class='Ref_To_Local'>opaque</span></a><span class='Operator'>-&GT;</span><a href="brin_inclusion.c.html#LN73"><span class='Ref_to_Member'>extra_procinfos</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN589"><span class='Ref_To_Local'>basenum</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/fmgr.h.html#LN58"><span class='Ref_to_Member'>fn_oid</span></a> <span class='Operator'>== </span><a href="../../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN539"><span class='Ref_to_Macro'>RegProcedureIsValid</span></a><span class='Parentheses'>(</span><a href="../../../include/access/genam.h.html#LN172"><span class='Ref_to_Proto'>index_getprocid</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN586"><span class='Ref_to_Parameter'>bdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN46"><span class='Ref_to_Member'>bd_index</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN586"><span class='Ref_to_Parameter'>attno</span></a><span class='Delimiter'>, 
</span>                                                <a href="brin_inclusion.c.html#LN586"><span class='Ref_to_Parameter'>procnum</span></a><span class='Parentheses'>)))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="../../../include/fmgr.h.html#LN109"><span class='Ref_to_Proto'>fmgr_info_copy</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="brin_inclusion.c.html#LN588"><span class='Ref_To_Local'>opaque</span></a><span class='Operator'>-&GT;</span><a href="brin_inclusion.c.html#LN73"><span class='Ref_to_Member'>extra_procinfos</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN589"><span class='Ref_To_Local'>basenum</span></a><span class='Delimiter'>], 
</span>                           <a href="../../../include/access/genam.h.html#LN174"><span class='Ref_to_Proto'>index_getprocinfo</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN586"><span class='Ref_to_Parameter'>bdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN46"><span class='Ref_to_Member'>bd_index</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN586"><span class='Ref_to_Parameter'>attno</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN586"><span class='Ref_to_Parameter'>procnum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                           <a href="brin_inclusion.c.html#LN586"><span class='Ref_to_Parameter'>bdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN43"><span class='Ref_to_Member'>bd_context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="brin_inclusion.c.html#LN588"><span class='Ref_To_Local'>opaque</span></a><span class='Operator'>-&GT;</span><a href="brin_inclusion.c.html#LN74"><span class='Ref_to_Member'>extra_proc_missing</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN589"><span class='Ref_To_Local'>basenum</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <span class='Operator'>&</span><a href="brin_inclusion.c.html#LN588"><span class='Ref_To_Local'>opaque</span></a><span class='Operator'>-&GT;</span><a href="brin_inclusion.c.html#LN73"><span class='Ref_to_Member'>extra_procinfos</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN589"><span class='Ref_To_Local'>basenum</span></a><span class='Delimiter'>]; 
}</span><span class='Auto_Annotations'> &laquo; end inclusion_get_procinfo &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Cache and return the procedure of the given strategy 
 * 
 * Return the procedure corresponding to the given sub-type and strategy 
 * number.  The data type of the index will be used as the left hand side of 
 * the operator and the given sub-type will be used as the right hand side. 
 * Throws an error if the pg_amop row does not exist, but that should not 
 * happen with a properly configured opclass. 
 * 
 * It always throws an error when the data type of the opclass is different 
 * from the data type of the column or the expression.  That happens when the 
 * column data type has implicit cast to the opclass data type.  We don't 
 * bother casting types, because this situation can easily be avoided by 
 * setting storage data type to that of the opclass.  The same problem does not 
 * apply to the data type of the right hand side, because the type in the 
 * ScanKey always matches the opclass' one. 
 * 
 * Note: this function mirrors minmax_get_strategy_procinfo; if changes are 
 * made here, see that function too. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/fmgr.h.html#LN55"><span class='Ref_to_Struct'>FmgrInfo</span></a> <span class='Operator'>* 
</span><a name="LN644"></a><span class='Declare_Function'>inclusion_get_strategy_procinfo</span><span class='Parentheses'>(</span><a href="../../../include/access/brin_internal.h.html#LN40"><span class='Ref_to_Struct'>BrinDesc</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>bdesc</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a> <span class='Declare_Parameter'>attno</span><span class='Delimiter'>, </span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>subtype</span><span class='Delimiter'>, 
</span><a name="LN645"></a>                                <a href="../../../include/c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a> <span class='Declare_Parameter'>strategynum</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN647"></a>    <a href="brin_inclusion.c.html#LN71"><span class='Ref_to_Struct'>InclusionOpaque</span></a> <span class='Operator'>*</span><span class='Declare_Local'>opaque</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN645"><span class='Ref_to_Parameter'>strategynum</span></a> <span class='Operator'>&GT;= </span><span class='Number'>1</span> <span class='Operator'>&& 
</span>           <a href="brin_inclusion.c.html#LN645"><span class='Ref_to_Parameter'>strategynum</span></a> <span class='Operator'>&LT;= </span><a href="../../../include/access/stratnum.h.html#LN71"><span class='Ref_to_Const'>RTMaxStrategyNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="brin_inclusion.c.html#LN647"><span class='Ref_To_Local'>opaque</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN71"><span class='Ref_to_Struct'>InclusionOpaque</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="brin_inclusion.c.html#LN644"><span class='Ref_to_Parameter'>bdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN58"><span class='Ref_to_Member'>bd_info</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN644"><span class='Ref_to_Parameter'>attno</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN30"><span class='Ref_to_Member'>oi_opaque</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We cache the procedures for the last sub-type in the opaque struct, to 
     * avoid repetitive syscache lookups.  If the sub-type is changed, 
     * invalidate all the cached entries. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN647"><span class='Ref_To_Local'>opaque</span></a><span class='Operator'>-&GT;</span><a href="brin_inclusion.c.html#LN75"><span class='Ref_to_Member'>cached_subtype</span></a> <span class='Operator'>!= </span><a href="brin_inclusion.c.html#LN644"><span class='Ref_to_Parameter'>subtype</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN661"></a>        <a href="../../../include/c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a>      <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN661"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; </span><a href="brin_inclusion.c.html#LN661"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT;= </span><a href="../../../include/access/stratnum.h.html#LN71"><span class='Ref_to_Const'>RTMaxStrategyNumber</span></a><span class='Delimiter'>; </span><a href="brin_inclusion.c.html#LN661"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>            <a href="brin_inclusion.c.html#LN647"><span class='Ref_To_Local'>opaque</span></a><span class='Operator'>-&GT;</span><a href="brin_inclusion.c.html#LN76"><span class='Ref_to_Member'>strategy_procinfos</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN661"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/fmgr.h.html#LN58"><span class='Ref_to_Member'>fn_oid</span></a> <span class='Operator'>= </span><a href="../../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>        <a href="brin_inclusion.c.html#LN647"><span class='Ref_To_Local'>opaque</span></a><span class='Operator'>-&GT;</span><a href="brin_inclusion.c.html#LN75"><span class='Ref_to_Member'>cached_subtype</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN644"><span class='Ref_to_Parameter'>subtype</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN647"><span class='Ref_To_Local'>opaque</span></a><span class='Operator'>-&GT;</span><a href="brin_inclusion.c.html#LN76"><span class='Ref_to_Member'>strategy_procinfos</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN645"><span class='Ref_to_Parameter'>strategynum</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/fmgr.h.html#LN58"><span class='Ref_to_Member'>fn_oid</span></a> <span class='Operator'>== </span><a href="../../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN670"></a>        <a href="../../../include/catalog/pg_attribute.h.html#LN186"><span class='Ref_to_Typedef'>Form_pg_attribute</span></a> <span class='Declare_Local'>attr</span><span class='Delimiter'>; 
</span><a name="LN671"></a>        <a href="../../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tuple</span><span class='Delimiter'>; 
</span><a name="LN672"></a>        <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>opfamily</span><span class='Delimiter'>, 
</span><a name="LN673"></a>                    <span class='Declare_Local'>oprid</span><span class='Delimiter'>; 
</span><a name="LN674"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>isNull</span><span class='Delimiter'>; 
</span> 
        <a href="brin_inclusion.c.html#LN672"><span class='Ref_To_Local'>opfamily</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN644"><span class='Ref_to_Parameter'>bdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN46"><span class='Ref_to_Member'>bd_index</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/rel.h.html#LN181"><span class='Ref_to_Member'>rd_opfamily</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN644"><span class='Ref_to_Parameter'>attno</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span>        <a href="brin_inclusion.c.html#LN670"><span class='Ref_To_Local'>attr</span></a> <span class='Operator'>= </span><a href="brin_inclusion.c.html#LN644"><span class='Ref_to_Parameter'>bdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN49"><span class='Ref_to_Member'>bd_tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/tupdesc.h.html#LN73"><span class='Ref_to_Member'>attrs</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN644"><span class='Ref_to_Parameter'>attno</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span>        <a href="brin_inclusion.c.html#LN671"><span class='Ref_To_Local'>tuple</span></a> <span class='Operator'>= </span><a href="../../../include/utils/syscache.h.html#LN161"><span class='Ref_to_Macro'>SearchSysCache4</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/syscache.h.html#LN37"><span class='Ref_to_EnumConst'>AMOPSTRATEGY</span></a><span class='Delimiter'>, </span><a href="../../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN672"><span class='Ref_To_Local'>opfamily</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                <a href="../../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN670"><span class='Ref_To_Local'>attr</span></a><span class='Operator'>-&GT;</span>atttypid<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                <a href="../../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN644"><span class='Ref_to_Parameter'>subtype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                <a href="../../../include/postgres.h.html#LN456"><span class='Ref_to_Macro'>Int16GetDatum</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN645"><span class='Ref_to_Parameter'>strategynum</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN671"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>))</span> 
            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"missing operator %d(%u,%u) in opfamily %u"</span><span class='Delimiter'>, 
</span>                 <a href="brin_inclusion.c.html#LN645"><span class='Ref_to_Parameter'>strategynum</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN670"><span class='Ref_To_Local'>attr</span></a><span class='Operator'>-&GT;</span>atttypid<span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN644"><span class='Ref_to_Parameter'>subtype</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN672"><span class='Ref_To_Local'>opfamily</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="brin_inclusion.c.html#LN673"><span class='Ref_To_Local'>oprid</span></a> <span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN505"><span class='Ref_to_Macro'>DatumGetObjectId</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/syscache.h.html#LN133"><span class='Ref_to_Proto'>SysCacheGetAttr</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/syscache.h.html#LN37"><span class='Ref_to_EnumConst'>AMOPSTRATEGY</span></a><span class='Delimiter'>, </span><a href="brin_inclusion.c.html#LN671"><span class='Ref_To_Local'>tuple</span></a><span class='Delimiter'>, 
</span>                                             <a href="../../../include/catalog/pg_amop.h.html#LN88"><span class='Ref_to_Const'>Anum_pg_amop_amopopr</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="brin_inclusion.c.html#LN674"><span class='Ref_To_Local'>isNull</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN671"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="brin_inclusion.c.html#LN674"><span class='Ref_To_Local'>isNull</span></a> <span class='Operator'>&& </span><a href="../../../include/c.h.html#LN539"><span class='Ref_to_Macro'>RegProcedureIsValid</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN673"><span class='Ref_To_Local'>oprid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <a href="../../../include/fmgr.h.html#LN99"><span class='Ref_to_Proto'>fmgr_info_cxt</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/lsyscache.h.html#LN98"><span class='Ref_to_Proto'>get_opcode</span></a><span class='Parentheses'>(</span><a href="brin_inclusion.c.html#LN673"><span class='Ref_To_Local'>oprid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                      <span class='Operator'>&</span><a href="brin_inclusion.c.html#LN647"><span class='Ref_To_Local'>opaque</span></a><span class='Operator'>-&GT;</span><a href="brin_inclusion.c.html#LN76"><span class='Ref_to_Member'>strategy_procinfos</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN645"><span class='Ref_to_Parameter'>strategynum</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>], 
</span>                      <a href="brin_inclusion.c.html#LN644"><span class='Ref_to_Parameter'>bdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN43"><span class='Ref_to_Member'>bd_context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if opaque-&GT;strategy_proc... &raquo; </span> 
 
    <span class='Control'>return</span> <span class='Operator'>&</span><a href="brin_inclusion.c.html#LN647"><span class='Ref_To_Local'>opaque</span></a><span class='Operator'>-&GT;</span><a href="brin_inclusion.c.html#LN76"><span class='Ref_to_Member'>strategy_procinfos</span></a><span class='Delimiter'>[</span><a href="brin_inclusion.c.html#LN645"><span class='Ref_to_Parameter'>strategynum</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]; 
}</span><span class='Auto_Annotations'> &laquo; end inclusion_get_strategy_procinfo &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>