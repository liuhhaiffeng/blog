<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\backend\access\brin\brin_tuple.c</title>
<LINK REL=StyleSheet HREF="../../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\backend\access\brin\brin_tuple.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:27 2017
</td></tr>
<tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/* 
 * brin_tuples.c 
 *      Method implementations for tuples in BRIN indexes. 
 * 
 * Intended usage is that code outside this file only deals with 
 * BrinMemTuples, and convert to and from the on-disk representation through 
 * functions in this file. 
 * 
 * NOTES 
 * 
 * A BRIN tuple is similar to a heap tuple, with a few key differences.  The 
 * first interesting difference is that the tuple header is much simpler, only 
 * containing its total length and a small area for flags.  Also, the stored 
 * data does not match the relation tuple descriptor exactly: for each 
 * attribute in the descriptor, the index tuple carries an arbitrary number 
 * of values, depending on the opclass. 
 * 
 * Also, for each column of the index relation there are two null bits: one 
 * (hasnulls) stores whether any tuple within the page range has that column 
 * set to null; the other one (allnulls) stores whether the column values are 
 * all null.  If allnulls is true, then the tuple data area does not contain 
 * values for that column at all; whereas it does if the hasnulls is set. 
 * Note the size of the null bitmask may not be the same as that of the 
 * datum array. 
 * 
 * Portions Copyright (c) 1996-2017, PostgreSQL Global Development Group 
 * Portions Copyright (c) 1994, Regents of the University of California 
 * 
 * IDENTIFICATION 
 *    src/backend/access/brin/brin_tuple.c 
 */ 
</span><span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>"access/htup_details.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/brin_tuple.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/tupdesc.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/tupmacs.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/datum.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/memutils.h"</span> 
 
 
<a name="LN41"></a><span class='Keyword'>static inline void </span><span class='Declare_Prototype'>brin_deconstruct_tuple</span><span class='Parentheses'>(</span><a href="../../../include/access/brin_internal.h.html#LN40"><span class='Ref_to_Struct'>BrinDesc</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>brdesc</span><span class='Delimiter'>, 
</span><a name="LN42"></a>                       <span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>tp</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>nullbits</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>nulls</span><span class='Delimiter'>, 
</span><a name="LN43"></a>                       <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>values</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>allnulls</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>hasnulls</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * Return a tuple descriptor used for on-disk storage of BRIN tuples. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a> 
<a name="LN50"></a><span class='Declare_Function'>brtuple_disk_tupdesc</span><span class='Parentheses'>(</span><a href="../../../include/access/brin_internal.h.html#LN40"><span class='Ref_to_Struct'>BrinDesc</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>brdesc</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* We cache these in the BrinDesc */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN50"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN52"><span class='Ref_to_Member'>bd_disktdesc</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN55"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN56"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span><a name="LN57"></a>        <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a>  <span class='Declare_Local'>attno</span> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span><a name="LN58"></a>        <a href="../../../include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a>   <span class='Declare_Local'>tupdesc</span><span class='Delimiter'>; 
</span><a name="LN59"></a>        <a href="../../../include/utils/palloc.h.html#LN35"><span class='Ref_to_Typedef'>MemoryContext</span></a> <span class='Declare_Local'>oldcxt</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* make sure it's in the bdesc's context */ 
</span>        <a href="brin_tuple.c.html#LN59"><span class='Ref_To_Local'>oldcxt</span></a> <span class='Operator'>= </span><a href="../../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN50"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN43"><span class='Ref_to_Member'>bd_context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="brin_tuple.c.html#LN58"><span class='Ref_To_Local'>tupdesc</span></a> <span class='Operator'>= </span><a href="../common/tupdesc.c.html#LN39"><span class='Ref_to_Func'>CreateTemplateTupleDesc</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN50"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN55"><span class='Ref_to_Member'>bd_totalstored</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN55"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="brin_tuple.c.html#LN55"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="brin_tuple.c.html#LN50"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN49"><span class='Ref_to_Member'>bd_tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Delimiter'>; </span><a href="brin_tuple.c.html#LN55"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN56"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="brin_tuple.c.html#LN56"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><a href="brin_tuple.c.html#LN50"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN58"><span class='Ref_to_Member'>bd_info</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN55"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN27"><span class='Ref_to_Member'>oi_nstored</span></a><span class='Delimiter'>; </span><a href="brin_tuple.c.html#LN56"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>                <a href="../../../include/access/tupdesc.h.html#LN114"><span class='Ref_to_Proto'>TupleDescInitEntry</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN58"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, </span><a href="brin_tuple.c.html#LN57"><span class='Ref_To_Local'>attno</span></a><span class='Operator'>++</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                                 <a href="brin_tuple.c.html#LN50"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN58"><span class='Ref_to_Member'>bd_info</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN55"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN33"><span class='Ref_to_Member'>oi_typcache</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN56"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span><a href="../../../include/utils/typcache.h.html#LN31"><span class='Ref_to_Member'>type_id</span></a><span class='Delimiter'>, 
</span>                                   <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="../../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN59"><span class='Ref_To_Local'>oldcxt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="brin_tuple.c.html#LN50"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN52"><span class='Ref_to_Member'>bd_disktdesc</span></a> <span class='Operator'>= </span><a href="brin_tuple.c.html#LN58"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if brdesc-&GT;bd_disktdesc=... &raquo; </span> 
 
    <span class='Control'>return</span> <a href="brin_tuple.c.html#LN50"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN52"><span class='Ref_to_Member'>bd_disktdesc</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end brtuple_disk_tupdesc &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Generate a new on-disk tuple to be inserted in a BRIN index. 
 * 
 * See brin_form_placeholder_tuple if you touch this. 
 */ 
</span><a href="../../../include/access/brin_tuple.h.html#LN53"><span class='Ref_to_Struct'>BrinTuple</span></a> <span class='Operator'>* 
</span><a name="LN88"></a><span class='Declare_Function'>brin_form_tuple</span><span class='Parentheses'>(</span><a href="../../../include/access/brin_internal.h.html#LN40"><span class='Ref_to_Struct'>BrinDesc</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>brdesc</span><span class='Delimiter'>, </span><a href="../../../include/storage/block.h.html#LN30"><span class='Ref_to_Typedef'>BlockNumber</span></a> <span class='Declare_Parameter'>blkno</span><span class='Delimiter'>, </span><a href="../../../include/access/brin_tuple.h.html#LN35"><span class='Ref_to_Struct'>BrinMemTuple</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tuple</span><span class='Delimiter'>, 
</span><a name="LN89"></a>                <a href="../../../include/c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>size</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN91"></a>    <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>values</span><span class='Delimiter'>; 
</span><a name="LN92"></a>    <span class='Keyword'>bool</span>       <span class='Operator'>*</span><span class='Declare_Local'>nulls</span><span class='Delimiter'>; 
</span><a name="LN93"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>anynulls</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN94"></a>    <a href="../../../include/access/brin_tuple.h.html#LN53"><span class='Ref_to_Struct'>BrinTuple</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>rettuple</span><span class='Delimiter'>; 
</span><a name="LN95"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>keyno</span><span class='Delimiter'>; 
</span><a name="LN96"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>idxattno</span><span class='Delimiter'>; 
</span><a name="LN97"></a>    <a href="../../../include/c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a>      <span class='Declare_Local'>phony_infomask</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN98"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>phony_nullbitmap</span><span class='Delimiter'>; 
</span><a name="LN99"></a>    <a href="../../../include/c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a>        <span class='Declare_Local'>len</span><span class='Delimiter'>, 
</span><a name="LN100"></a>                <span class='Declare_Local'>hoff</span><span class='Delimiter'>, 
</span><a name="LN101"></a>                <span class='Declare_Local'>data_len</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN88"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN55"><span class='Ref_to_Member'>bd_totalstored</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="brin_tuple.c.html#LN91"><span class='Ref_To_Local'>values</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="brin_tuple.c.html#LN88"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN55"><span class='Ref_to_Member'>bd_totalstored</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="brin_tuple.c.html#LN92"><span class='Ref_To_Local'>nulls</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Keyword'>bool</span><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="brin_tuple.c.html#LN88"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN55"><span class='Ref_to_Member'>bd_totalstored</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="brin_tuple.c.html#LN98"><span class='Ref_To_Local'>phony_nullbitmap</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>        <a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="../../../include/access/htup_details.h.html#LN547"><span class='Ref_to_Macro'>BITMAPLEN</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN88"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN55"><span class='Ref_to_Member'>bd_totalstored</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Set up the values/nulls arrays for heap_fill_tuple 
     */ 
</span>    <a href="brin_tuple.c.html#LN96"><span class='Ref_To_Local'>idxattno</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN95"><span class='Ref_To_Local'>keyno</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="brin_tuple.c.html#LN95"><span class='Ref_To_Local'>keyno</span></a> <span class='Operator'>&LT; </span><a href="brin_tuple.c.html#LN88"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN49"><span class='Ref_to_Member'>bd_tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Delimiter'>; </span><a href="brin_tuple.c.html#LN95"><span class='Ref_To_Local'>keyno</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN116"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>datumno</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * "allnulls" is set when there's no nonnull value in any row in the 
         * column; when this happens, there is no data to store.  Thus set the 
         * nullable bits for all data elements of this column and we're done. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN88"><span class='Ref_to_Parameter'>tuple</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN45"><span class='Ref_to_Member'>bt_columns</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN95"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/access/brin_tuple.h.html#LN27"><span class='Ref_to_Member'>bv_allnulls</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN116"><span class='Ref_To_Local'>datumno</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                 <a href="brin_tuple.c.html#LN116"><span class='Ref_To_Local'>datumno</span></a> <span class='Operator'>&LT; </span><a href="brin_tuple.c.html#LN88"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN58"><span class='Ref_to_Member'>bd_info</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN95"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN27"><span class='Ref_to_Member'>oi_nstored</span></a><span class='Delimiter'>; 
</span>                 <a href="brin_tuple.c.html#LN116"><span class='Ref_To_Local'>datumno</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>                <a href="brin_tuple.c.html#LN92"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN96"><span class='Ref_To_Local'>idxattno</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <a href="brin_tuple.c.html#LN93"><span class='Ref_To_Local'>anynulls</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * The "hasnulls" bit is set when there are some null values in the 
         * data.  We still need to store a real value, but the presence of 
         * this means we need a null bitmap. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN88"><span class='Ref_to_Parameter'>tuple</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN45"><span class='Ref_to_Member'>bt_columns</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN95"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/access/brin_tuple.h.html#LN26"><span class='Ref_to_Member'>bv_hasnulls</span></a><span class='Parentheses'>) 
</span>            <a href="brin_tuple.c.html#LN93"><span class='Ref_To_Local'>anynulls</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN116"><span class='Ref_To_Local'>datumno</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>             <a href="brin_tuple.c.html#LN116"><span class='Ref_To_Local'>datumno</span></a> <span class='Operator'>&LT; </span><a href="brin_tuple.c.html#LN88"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN58"><span class='Ref_to_Member'>bd_info</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN95"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN27"><span class='Ref_to_Member'>oi_nstored</span></a><span class='Delimiter'>; 
</span>             <a href="brin_tuple.c.html#LN116"><span class='Ref_To_Local'>datumno</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>            <a href="brin_tuple.c.html#LN91"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN96"><span class='Ref_To_Local'>idxattno</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="brin_tuple.c.html#LN88"><span class='Ref_to_Parameter'>tuple</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN45"><span class='Ref_to_Member'>bt_columns</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN95"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN116"><span class='Ref_To_Local'>datumno</span></a><span class='Delimiter'>]; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for keyno=0;keyno&LT;brdesc-... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Assert we did not overrun temp arrays */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN96"><span class='Ref_To_Local'>idxattno</span></a> <span class='Operator'>&LT;= </span><a href="brin_tuple.c.html#LN88"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN55"><span class='Ref_to_Member'>bd_totalstored</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* compute total space needed */ 
</span>    <a href="brin_tuple.c.html#LN99"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="../../../include/access/brin_tuple.h.html#LN70"><span class='Ref_to_Const'>SizeOfBrinTuple</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN93"><span class='Ref_To_Local'>anynulls</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * We need a double-length bitmap on an on-disk BRIN index tuple; the 
         * first half stores the "allnulls" bits, the second stores 
         * "hasnulls". 
         */ 
</span>        <a href="brin_tuple.c.html#LN99"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>+= </span><a href="../../../include/access/htup_details.h.html#LN547"><span class='Ref_to_Macro'>BITMAPLEN</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN88"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN49"><span class='Ref_to_Member'>bd_tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a> <span class='Operator'>* </span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="brin_tuple.c.html#LN99"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="brin_tuple.c.html#LN100"><span class='Ref_To_Local'>hoff</span></a> <span class='Operator'>= </span><a href="../../../include/c.h.html#LN587"><span class='Ref_to_Macro'>MAXALIGN</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN99"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="brin_tuple.c.html#LN101"><span class='Ref_To_Local'>data_len</span></a> <span class='Operator'>= </span><a href="../common/heaptuple.c.html#LN83"><span class='Ref_to_Func'>heap_compute_data_size</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN49"><span class='Ref_to_Func'>brtuple_disk_tupdesc</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN88"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                      <a href="brin_tuple.c.html#LN91"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>, </span><a href="brin_tuple.c.html#LN92"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="brin_tuple.c.html#LN99"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>+= </span><a href="brin_tuple.c.html#LN101"><span class='Ref_To_Local'>data_len</span></a><span class='Delimiter'>; 
</span> 
    <a href="brin_tuple.c.html#LN99"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="../../../include/c.h.html#LN587"><span class='Ref_to_Macro'>MAXALIGN</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN99"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="brin_tuple.c.html#LN94"><span class='Ref_To_Local'>rettuple</span></a> <span class='Operator'>= </span><a href="../../../include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN99"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="brin_tuple.c.html#LN94"><span class='Ref_To_Local'>rettuple</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN56"><span class='Ref_to_Member'>bt_blkno</span></a> <span class='Operator'>= </span><a href="brin_tuple.c.html#LN88"><span class='Ref_to_Parameter'>blkno</span></a><span class='Delimiter'>; 
</span>    <a href="brin_tuple.c.html#LN94"><span class='Ref_To_Local'>rettuple</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN67"><span class='Ref_to_Member'>bt_info</span></a> <span class='Operator'>= </span><a href="brin_tuple.c.html#LN100"><span class='Ref_To_Local'>hoff</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Assert that hoff fits in the space available */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>((</span><a href="brin_tuple.c.html#LN94"><span class='Ref_To_Local'>rettuple</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN67"><span class='Ref_to_Member'>bt_info</span></a> <span class='Operator'>& </span><a href="../../../include/access/brin_tuple.h.html#LN75"><span class='Ref_to_Const'>BRIN_OFFSET_MASK</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="brin_tuple.c.html#LN100"><span class='Ref_To_Local'>hoff</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * The infomask and null bitmap as computed by heap_fill_tuple are useless 
     * to us.  However, that function will not accept a null infomask; and we 
     * need to pass a valid null bitmap so that it will correctly skip 
     * outputting null attributes in the data area. 
     */ 
</span>    <a href="../common/heaptuple.c.html#LN144"><span class='Ref_to_Func'>heap_fill_tuple</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN49"><span class='Ref_to_Func'>brtuple_disk_tupdesc</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN88"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                    <a href="brin_tuple.c.html#LN91"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>, 
</span>                    <a href="brin_tuple.c.html#LN92"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="brin_tuple.c.html#LN94"><span class='Ref_To_Local'>rettuple</span></a> <span class='Operator'>+ </span><a href="brin_tuple.c.html#LN100"><span class='Ref_To_Local'>hoff</span></a><span class='Delimiter'>, 
</span>                    <a href="brin_tuple.c.html#LN101"><span class='Ref_To_Local'>data_len</span></a><span class='Delimiter'>, 
</span>                    <span class='Operator'>&</span><a href="brin_tuple.c.html#LN97"><span class='Ref_To_Local'>phony_infomask</span></a><span class='Delimiter'>, 
</span>                    <a href="brin_tuple.c.html#LN98"><span class='Ref_To_Local'>phony_nullbitmap</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* done with these */ 
</span>    <a href="../../../include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN91"><span class='Ref_To_Local'>values</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN92"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN98"><span class='Ref_To_Local'>phony_nullbitmap</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Now fill in the real null bitmasks.  allnulls first. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN93"><span class='Ref_To_Local'>anynulls</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN201"></a>        <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>bitP</span><span class='Delimiter'>; 
</span><a name="LN202"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>bitmask</span><span class='Delimiter'>; 
</span> 
        <a href="brin_tuple.c.html#LN94"><span class='Ref_To_Local'>rettuple</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN67"><span class='Ref_to_Member'>bt_info</span></a> <span class='Operator'>|= </span><a href="../../../include/access/brin_tuple.h.html#LN78"><span class='Ref_to_Const'>BRIN_NULLS_MASK</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Note that we reverse the sense of null bits in this module: we 
         * store a 1 for a null attribute rather than a 0.  So we must reverse 
         * the sense of the att_isnull test in br_deconstruct_tuple as well. 
         */ 
</span>        <a href="brin_tuple.c.html#LN201"><span class='Ref_To_Local'>bitP</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a> <span class='Operator'>*</span><span class='Parentheses'>)</span> <span class='Parentheses'>((</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="brin_tuple.c.html#LN94"><span class='Ref_To_Local'>rettuple</span></a> <span class='Operator'>+ </span><a href="../../../include/access/brin_tuple.h.html#LN70"><span class='Ref_to_Const'>SizeOfBrinTuple</span></a><span class='Parentheses'>))</span> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <a href="brin_tuple.c.html#LN202"><span class='Ref_To_Local'>bitmask</span></a> <span class='Operator'>= </span><a href="../../../include/c.h.html#LN971"><span class='Ref_to_Const'>HIGHBIT</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN95"><span class='Ref_To_Local'>keyno</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="brin_tuple.c.html#LN95"><span class='Ref_To_Local'>keyno</span></a> <span class='Operator'>&LT; </span><a href="brin_tuple.c.html#LN88"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN49"><span class='Ref_to_Member'>bd_tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Delimiter'>; </span><a href="brin_tuple.c.html#LN95"><span class='Ref_To_Local'>keyno</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN202"><span class='Ref_To_Local'>bitmask</span></a> <span class='Operator'>!= </span><a href="../../../include/c.h.html#LN971"><span class='Ref_to_Const'>HIGHBIT</span></a><span class='Parentheses'>) 
</span>                <a href="brin_tuple.c.html#LN202"><span class='Ref_To_Local'>bitmask</span></a> <span class='Operator'>&LT;&LT;= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <a href="brin_tuple.c.html#LN201"><span class='Ref_To_Local'>bitP</span></a> <span class='Operator'>+= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                <span class='Operator'>*</span><a href="brin_tuple.c.html#LN201"><span class='Ref_To_Local'>bitP</span></a> <span class='Operator'>= </span><span class='Number'>0x0</span><span class='Delimiter'>; 
</span>                <a href="brin_tuple.c.html#LN202"><span class='Ref_To_Local'>bitmask</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="brin_tuple.c.html#LN88"><span class='Ref_to_Parameter'>tuple</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN45"><span class='Ref_to_Member'>bt_columns</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN95"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/access/brin_tuple.h.html#LN27"><span class='Ref_to_Member'>bv_allnulls</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
            <span class='Operator'>*</span><a href="brin_tuple.c.html#LN201"><span class='Ref_To_Local'>bitP</span></a> <span class='Operator'>|= </span><a href="brin_tuple.c.html#LN202"><span class='Ref_To_Local'>bitmask</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Comment_Multi_Line'>/* hasnulls bits follow */ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN95"><span class='Ref_To_Local'>keyno</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="brin_tuple.c.html#LN95"><span class='Ref_To_Local'>keyno</span></a> <span class='Operator'>&LT; </span><a href="brin_tuple.c.html#LN88"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN49"><span class='Ref_to_Member'>bd_tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Delimiter'>; </span><a href="brin_tuple.c.html#LN95"><span class='Ref_To_Local'>keyno</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN202"><span class='Ref_To_Local'>bitmask</span></a> <span class='Operator'>!= </span><a href="../../../include/c.h.html#LN971"><span class='Ref_to_Const'>HIGHBIT</span></a><span class='Parentheses'>) 
</span>                <a href="brin_tuple.c.html#LN202"><span class='Ref_To_Local'>bitmask</span></a> <span class='Operator'>&LT;&LT;= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <a href="brin_tuple.c.html#LN201"><span class='Ref_To_Local'>bitP</span></a> <span class='Operator'>+= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                <span class='Operator'>*</span><a href="brin_tuple.c.html#LN201"><span class='Ref_To_Local'>bitP</span></a> <span class='Operator'>= </span><span class='Number'>0x0</span><span class='Delimiter'>; 
</span>                <a href="brin_tuple.c.html#LN202"><span class='Ref_To_Local'>bitmask</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="brin_tuple.c.html#LN88"><span class='Ref_to_Parameter'>tuple</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN45"><span class='Ref_to_Member'>bt_columns</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN95"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/access/brin_tuple.h.html#LN26"><span class='Ref_to_Member'>bv_hasnulls</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
            <span class='Operator'>*</span><a href="brin_tuple.c.html#LN201"><span class='Ref_To_Local'>bitP</span></a> <span class='Operator'>|= </span><a href="brin_tuple.c.html#LN202"><span class='Ref_To_Local'>bitmask</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="brin_tuple.c.html#LN201"><span class='Ref_To_Local'>bitP</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a> <span class='Operator'>*</span><span class='Parentheses'>) (</span><a href="brin_tuple.c.html#LN94"><span class='Ref_To_Local'>rettuple</span></a> <span class='Operator'>+ </span><a href="../../../include/access/brin_tuple.h.html#LN70"><span class='Ref_to_Const'>SizeOfBrinTuple</span></a><span class='Parentheses'>))</span> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if anynulls &raquo; </span> 
 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN88"><span class='Ref_to_Parameter'>tuple</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN37"><span class='Ref_to_Member'>bt_placeholder</span></a><span class='Parentheses'>) 
</span>        <a href="brin_tuple.c.html#LN94"><span class='Ref_To_Local'>rettuple</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN67"><span class='Ref_to_Member'>bt_info</span></a> <span class='Operator'>|= </span><a href="../../../include/access/brin_tuple.h.html#LN77"><span class='Ref_to_Const'>BRIN_PLACEHOLDER_MASK</span></a><span class='Delimiter'>; 
</span> 
    <span class='Operator'>*</span><a href="brin_tuple.c.html#LN89"><span class='Ref_to_Parameter'>size</span></a> <span class='Operator'>= </span><a href="brin_tuple.c.html#LN99"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="brin_tuple.c.html#LN94"><span class='Ref_To_Local'>rettuple</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end brin_form_tuple &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Generate a new on-disk tuple with no data values, marked as placeholder. 
 * 
 * This is a cut-down version of brin_form_tuple. 
 */ 
</span><a href="../../../include/access/brin_tuple.h.html#LN53"><span class='Ref_to_Struct'>BrinTuple</span></a> <span class='Operator'>* 
</span><a name="LN262"></a><span class='Declare_Function'>brin_form_placeholder_tuple</span><span class='Parentheses'>(</span><a href="../../../include/access/brin_internal.h.html#LN40"><span class='Ref_to_Struct'>BrinDesc</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>brdesc</span><span class='Delimiter'>, </span><a href="../../../include/storage/block.h.html#LN30"><span class='Ref_to_Typedef'>BlockNumber</span></a> <span class='Declare_Parameter'>blkno</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>size</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN264"></a>    <a href="../../../include/c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a>        <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span><a name="LN265"></a>    <a href="../../../include/c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a>        <span class='Declare_Local'>hoff</span><span class='Delimiter'>; 
</span><a name="LN266"></a>    <a href="../../../include/access/brin_tuple.h.html#LN53"><span class='Ref_to_Struct'>BrinTuple</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>rettuple</span><span class='Delimiter'>; 
</span><a name="LN267"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>keyno</span><span class='Delimiter'>; 
</span><a name="LN268"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>bitP</span><span class='Delimiter'>; 
</span><a name="LN269"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>bitmask</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* compute total space needed: always add nulls */ 
</span>    <a href="brin_tuple.c.html#LN264"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="../../../include/access/brin_tuple.h.html#LN70"><span class='Ref_to_Const'>SizeOfBrinTuple</span></a><span class='Delimiter'>; 
</span>    <a href="brin_tuple.c.html#LN264"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>+= </span><a href="../../../include/access/htup_details.h.html#LN547"><span class='Ref_to_Macro'>BITMAPLEN</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN262"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN49"><span class='Ref_to_Member'>bd_tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a> <span class='Operator'>* </span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="brin_tuple.c.html#LN264"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="brin_tuple.c.html#LN265"><span class='Ref_To_Local'>hoff</span></a> <span class='Operator'>= </span><a href="../../../include/c.h.html#LN587"><span class='Ref_to_Macro'>MAXALIGN</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN264"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="brin_tuple.c.html#LN266"><span class='Ref_To_Local'>rettuple</span></a> <span class='Operator'>= </span><a href="../../../include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN264"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="brin_tuple.c.html#LN266"><span class='Ref_To_Local'>rettuple</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN56"><span class='Ref_to_Member'>bt_blkno</span></a> <span class='Operator'>= </span><a href="brin_tuple.c.html#LN262"><span class='Ref_to_Parameter'>blkno</span></a><span class='Delimiter'>; 
</span>    <a href="brin_tuple.c.html#LN266"><span class='Ref_To_Local'>rettuple</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN67"><span class='Ref_to_Member'>bt_info</span></a> <span class='Operator'>= </span><a href="brin_tuple.c.html#LN265"><span class='Ref_To_Local'>hoff</span></a><span class='Delimiter'>; 
</span>    <a href="brin_tuple.c.html#LN266"><span class='Ref_To_Local'>rettuple</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN67"><span class='Ref_to_Member'>bt_info</span></a> <span class='Operator'>|= </span><a href="../../../include/access/brin_tuple.h.html#LN78"><span class='Ref_to_Const'>BRIN_NULLS_MASK</span></a> <span class='Operator'>| </span><a href="../../../include/access/brin_tuple.h.html#LN77"><span class='Ref_to_Const'>BRIN_PLACEHOLDER_MASK</span></a><span class='Delimiter'>; 
</span> 
    <a href="brin_tuple.c.html#LN268"><span class='Ref_To_Local'>bitP</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a> <span class='Operator'>*</span><span class='Parentheses'>)</span> <span class='Parentheses'>((</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="brin_tuple.c.html#LN266"><span class='Ref_To_Local'>rettuple</span></a> <span class='Operator'>+ </span><a href="../../../include/access/brin_tuple.h.html#LN70"><span class='Ref_to_Const'>SizeOfBrinTuple</span></a><span class='Parentheses'>))</span> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="brin_tuple.c.html#LN269"><span class='Ref_To_Local'>bitmask</span></a> <span class='Operator'>= </span><a href="../../../include/c.h.html#LN971"><span class='Ref_to_Const'>HIGHBIT</span></a><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* set allnulls true for all attributes */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN267"><span class='Ref_To_Local'>keyno</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="brin_tuple.c.html#LN267"><span class='Ref_To_Local'>keyno</span></a> <span class='Operator'>&LT; </span><a href="brin_tuple.c.html#LN262"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN49"><span class='Ref_to_Member'>bd_tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Delimiter'>; </span><a href="brin_tuple.c.html#LN267"><span class='Ref_To_Local'>keyno</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN269"><span class='Ref_To_Local'>bitmask</span></a> <span class='Operator'>!= </span><a href="../../../include/c.h.html#LN971"><span class='Ref_to_Const'>HIGHBIT</span></a><span class='Parentheses'>) 
</span>            <a href="brin_tuple.c.html#LN269"><span class='Ref_To_Local'>bitmask</span></a> <span class='Operator'>&LT;&LT;= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="brin_tuple.c.html#LN268"><span class='Ref_To_Local'>bitP</span></a> <span class='Operator'>+= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="brin_tuple.c.html#LN268"><span class='Ref_To_Local'>bitP</span></a> <span class='Operator'>= </span><span class='Number'>0x0</span><span class='Delimiter'>; 
</span>            <a href="brin_tuple.c.html#LN269"><span class='Ref_To_Local'>bitmask</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Operator'>*</span><a href="brin_tuple.c.html#LN268"><span class='Ref_To_Local'>bitP</span></a> <span class='Operator'>|= </span><a href="brin_tuple.c.html#LN269"><span class='Ref_To_Local'>bitmask</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* no need to set hasnulls */ 
</span> 
    <span class='Operator'>*</span><a href="brin_tuple.c.html#LN262"><span class='Ref_to_Parameter'>size</span></a> <span class='Operator'>= </span><a href="brin_tuple.c.html#LN264"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="brin_tuple.c.html#LN266"><span class='Ref_To_Local'>rettuple</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end brin_form_placeholder_tuple &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Free a tuple created by brin_form_tuple 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN307"></a><span class='Declare_Function'>brin_free_tuple</span><span class='Parentheses'>(</span><a href="../../../include/access/brin_tuple.h.html#LN53"><span class='Ref_to_Struct'>BrinTuple</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tuple</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="../../../include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN307"><span class='Ref_to_Parameter'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Given a brin tuple of size len, create a copy of it.  If 'dest' is not 
 * NULL, its size is destsz, and can be used as output buffer; if the tuple 
 * to be copied does not fit, it is enlarged by repalloc, and the size is 
 * updated to match.  This avoids palloc/free cycles when many brin tuples 
 * are being processed in loops. 
 */ 
</span><a href="../../../include/access/brin_tuple.h.html#LN53"><span class='Ref_to_Struct'>BrinTuple</span></a> <span class='Operator'>* 
</span><a name="LN320"></a><span class='Declare_Function'>brin_copy_tuple</span><span class='Parentheses'>(</span><a href="../../../include/access/brin_tuple.h.html#LN53"><span class='Ref_to_Struct'>BrinTuple</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tuple</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a> <span class='Declare_Parameter'>len</span><span class='Delimiter'>, </span><a href="../../../include/access/brin_tuple.h.html#LN53"><span class='Ref_to_Struct'>BrinTuple</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dest</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>destsz</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="brin_tuple.c.html#LN320"><span class='Ref_to_Parameter'>destsz</span></a> <span class='Operator'>|| *</span><a href="brin_tuple.c.html#LN320"><span class='Ref_to_Parameter'>destsz</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="brin_tuple.c.html#LN320"><span class='Ref_to_Parameter'>dest</span></a> <span class='Operator'>= </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN320"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN320"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT; *</span><a href="brin_tuple.c.html#LN320"><span class='Ref_to_Parameter'>destsz</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="brin_tuple.c.html#LN320"><span class='Ref_to_Parameter'>dest</span></a> <span class='Operator'>= </span><a href="../../../include/common/fe_memutils.h.html#LN36"><span class='Ref_to_Proto'>repalloc</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN320"><span class='Ref_to_Parameter'>dest</span></a><span class='Delimiter'>, </span><a href="brin_tuple.c.html#LN320"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="brin_tuple.c.html#LN320"><span class='Ref_to_Parameter'>destsz</span></a> <span class='Operator'>= </span><a href="brin_tuple.c.html#LN320"><span class='Ref_to_Parameter'>len</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    memcpy<span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN320"><span class='Ref_to_Parameter'>dest</span></a><span class='Delimiter'>, </span><a href="brin_tuple.c.html#LN320"><span class='Ref_to_Parameter'>tuple</span></a><span class='Delimiter'>, </span><a href="brin_tuple.c.html#LN320"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="brin_tuple.c.html#LN320"><span class='Ref_to_Parameter'>dest</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Return whether two BrinTuples are bitwise identical. 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN339"></a><span class='Declare_Function'>brin_tuples_equal</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="../../../include/access/brin_tuple.h.html#LN53"><span class='Ref_to_Struct'>BrinTuple</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a> <span class='Declare_Parameter'>alen</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../../../include/access/brin_tuple.h.html#LN53"><span class='Ref_to_Struct'>BrinTuple</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>b</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a> <span class='Declare_Parameter'>blen</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN339"><span class='Ref_to_Parameter'>alen</span></a> <span class='Operator'>!= </span><a href="brin_tuple.c.html#LN339"><span class='Ref_to_Parameter'>blen</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>memcmp<span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN339"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="brin_tuple.c.html#LN339"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="brin_tuple.c.html#LN339"><span class='Ref_to_Parameter'>alen</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Create a new BrinMemTuple from scratch, and initialize it to an empty 
 * state. 
 * 
 * Note: we don't provide any means to free a deformed tuple, so make sure to 
 * use a temporary memory context. 
 */ 
</span><a href="../../../include/access/brin_tuple.h.html#LN35"><span class='Ref_to_Struct'>BrinMemTuple</span></a> <span class='Operator'>* 
</span><a name="LN356"></a><span class='Declare_Function'>brin_new_memtuple</span><span class='Parentheses'>(</span><a href="../../../include/access/brin_internal.h.html#LN40"><span class='Ref_to_Struct'>BrinDesc</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>brdesc</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN358"></a>    <a href="../../../include/access/brin_tuple.h.html#LN35"><span class='Ref_to_Struct'>BrinMemTuple</span></a> <span class='Operator'>*</span><span class='Declare_Local'>dtup</span><span class='Delimiter'>; 
</span><a name="LN359"></a>    <span class='Keyword'>long</span>        <span class='Declare_Local'>basesize</span><span class='Delimiter'>; 
</span> 
    <a href="brin_tuple.c.html#LN359"><span class='Ref_To_Local'>basesize</span></a> <span class='Operator'>= </span><a href="../../../include/c.h.html#LN587"><span class='Ref_to_Macro'>MAXALIGN</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/access/brin_tuple.h.html#LN35"><span class='Ref_to_Struct'>BrinMemTuple</span></a><span class='Parentheses'>) </span><span class='Operator'>+ 
</span>                        <span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/access/brin_tuple.h.html#LN23"><span class='Ref_to_Struct'>BrinValues</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="brin_tuple.c.html#LN356"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN49"><span class='Ref_to_Member'>bd_tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="brin_tuple.c.html#LN358"><span class='Ref_To_Local'>dtup</span></a> <span class='Operator'>= </span><a href="../../../include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN359"><span class='Ref_To_Local'>basesize</span></a> <span class='Operator'>+ </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="brin_tuple.c.html#LN356"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN55"><span class='Ref_to_Member'>bd_totalstored</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="brin_tuple.c.html#LN358"><span class='Ref_To_Local'>dtup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN41"><span class='Ref_to_Member'>bt_values</span></a> <span class='Operator'>= </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="brin_tuple.c.html#LN356"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN55"><span class='Ref_to_Member'>bd_totalstored</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="brin_tuple.c.html#LN358"><span class='Ref_To_Local'>dtup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN42"><span class='Ref_to_Member'>bt_allnulls</span></a> <span class='Operator'>= </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Keyword'>bool</span><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="brin_tuple.c.html#LN356"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN49"><span class='Ref_to_Member'>bd_tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="brin_tuple.c.html#LN358"><span class='Ref_To_Local'>dtup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN43"><span class='Ref_to_Member'>bt_hasnulls</span></a> <span class='Operator'>= </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Keyword'>bool</span><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="brin_tuple.c.html#LN356"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN49"><span class='Ref_to_Member'>bd_tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="brin_tuple.c.html#LN358"><span class='Ref_To_Local'>dtup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN39"><span class='Ref_to_Member'>bt_context</span></a> <span class='Operator'>= </span><a href="../../../include/utils/memutils.h.html#LN145"><span class='Ref_to_Proto'>AllocSetContextCreate</span></a><span class='Parentheses'>(</span><a href="../../utils/mmgr/mcxt.c.html#LN36"><span class='Ref_to_Global_Var'>CurrentMemoryContext</span></a><span class='Delimiter'>, 
</span>                                             <span class='String'>"brin dtuple"</span><span class='Delimiter'>, 
</span>                                             <a href="../../../include/utils/memutils.h.html#LN164"><span class='Ref_to_Const'>ALLOCSET_DEFAULT_SIZES</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/access/brin_tuple.h.html#LN96"><span class='Ref_to_Proto'>brin_memtuple_initialize</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN358"><span class='Ref_To_Local'>dtup</span></a><span class='Delimiter'>, </span><a href="brin_tuple.c.html#LN356"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="brin_tuple.c.html#LN358"><span class='Ref_To_Local'>dtup</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end brin_new_memtuple &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Reset a BrinMemTuple to initial state.  We return the same tuple, for 
 * notational convenience. 
 */ 
</span><a href="../../../include/access/brin_tuple.h.html#LN35"><span class='Ref_to_Struct'>BrinMemTuple</span></a> <span class='Operator'>* 
</span><a name="LN383"></a><span class='Declare_Function'>brin_memtuple_initialize</span><span class='Parentheses'>(</span><a href="../../../include/access/brin_tuple.h.html#LN35"><span class='Ref_to_Struct'>BrinMemTuple</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dtuple</span><span class='Delimiter'>, </span><a href="../../../include/access/brin_internal.h.html#LN40"><span class='Ref_to_Struct'>BrinDesc</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>brdesc</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN385"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN386"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>currdatum</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/memutils.h.html#LN73"><span class='Ref_to_Proto'>MemoryContextReset</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN383"><span class='Ref_to_Parameter'>dtuple</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN39"><span class='Ref_to_Member'>bt_context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="brin_tuple.c.html#LN386"><span class='Ref_To_Local'>currdatum</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="brin_tuple.c.html#LN383"><span class='Ref_to_Parameter'>dtuple</span></a> <span class='Operator'>+ 
</span>        <a href="../../../include/c.h.html#LN587"><span class='Ref_to_Macro'>MAXALIGN</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/access/brin_tuple.h.html#LN35"><span class='Ref_to_Struct'>BrinMemTuple</span></a><span class='Parentheses'>) </span><span class='Operator'>+ 
</span>                 <span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/access/brin_tuple.h.html#LN23"><span class='Ref_to_Struct'>BrinValues</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="brin_tuple.c.html#LN383"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN49"><span class='Ref_to_Member'>bd_tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN385"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="brin_tuple.c.html#LN385"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="brin_tuple.c.html#LN383"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN49"><span class='Ref_to_Member'>bd_tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Delimiter'>; </span><a href="brin_tuple.c.html#LN385"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="brin_tuple.c.html#LN383"><span class='Ref_to_Parameter'>dtuple</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN45"><span class='Ref_to_Member'>bt_columns</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN385"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/access/brin_tuple.h.html#LN27"><span class='Ref_to_Member'>bv_allnulls</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <a href="brin_tuple.c.html#LN383"><span class='Ref_to_Parameter'>dtuple</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN45"><span class='Ref_to_Member'>bt_columns</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN385"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/access/brin_tuple.h.html#LN26"><span class='Ref_to_Member'>bv_hasnulls</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
        <a href="brin_tuple.c.html#LN383"><span class='Ref_to_Parameter'>dtuple</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN45"><span class='Ref_to_Member'>bt_columns</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN385"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/access/brin_tuple.h.html#LN25"><span class='Ref_to_Member'>bv_attno</span></a> <span class='Operator'>= </span><a href="brin_tuple.c.html#LN385"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <a href="brin_tuple.c.html#LN383"><span class='Ref_to_Parameter'>dtuple</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN45"><span class='Ref_to_Member'>bt_columns</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN385"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/access/brin_tuple.h.html#LN27"><span class='Ref_to_Member'>bv_allnulls</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <a href="brin_tuple.c.html#LN383"><span class='Ref_to_Parameter'>dtuple</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN45"><span class='Ref_to_Member'>bt_columns</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN385"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/access/brin_tuple.h.html#LN26"><span class='Ref_to_Member'>bv_hasnulls</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="brin_tuple.c.html#LN383"><span class='Ref_to_Parameter'>dtuple</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN45"><span class='Ref_to_Member'>bt_columns</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN385"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="brin_tuple.c.html#LN386"><span class='Ref_To_Local'>currdatum</span></a><span class='Delimiter'>; 
</span>        <a href="brin_tuple.c.html#LN386"><span class='Ref_To_Local'>currdatum</span></a> <span class='Operator'>+= </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="brin_tuple.c.html#LN383"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN58"><span class='Ref_to_Member'>bd_info</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN385"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN27"><span class='Ref_to_Member'>oi_nstored</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="brin_tuple.c.html#LN383"><span class='Ref_to_Parameter'>dtuple</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end brin_memtuple_initialize &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Convert a BrinTuple back to a BrinMemTuple.  This is the reverse of 
 * brin_form_tuple. 
 * 
 * As an optimization, the caller can pass a previously allocated 'dMemtuple'. 
 * This avoids having to allocate it here, which can be useful when this 
 * function is called many times in a loop.  It is caller's responsibility 
 * that the given BrinMemTuple matches what we need here. 
 * 
 * Note we don't need the "on disk tupdesc" here; we rely on our own routine to 
 * deconstruct the tuple from the on-disk format. 
 */ 
</span><a href="../../../include/access/brin_tuple.h.html#LN35"><span class='Ref_to_Struct'>BrinMemTuple</span></a> <span class='Operator'>* 
</span><a name="LN421"></a><span class='Declare_Function'>brin_deform_tuple</span><span class='Parentheses'>(</span><a href="../../../include/access/brin_internal.h.html#LN40"><span class='Ref_to_Struct'>BrinDesc</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>brdesc</span><span class='Delimiter'>, </span><a href="../../../include/access/brin_tuple.h.html#LN53"><span class='Ref_to_Struct'>BrinTuple</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tuple</span><span class='Delimiter'>, </span><a href="../../../include/access/brin_tuple.h.html#LN35"><span class='Ref_to_Struct'>BrinMemTuple</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dMemtuple</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN423"></a>    <a href="../../../include/access/brin_tuple.h.html#LN35"><span class='Ref_to_Struct'>BrinMemTuple</span></a> <span class='Operator'>*</span><span class='Declare_Local'>dtup</span><span class='Delimiter'>; 
</span><a name="LN424"></a>    <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>values</span><span class='Delimiter'>; 
</span><a name="LN425"></a>    <span class='Keyword'>bool</span>       <span class='Operator'>*</span><span class='Declare_Local'>allnulls</span><span class='Delimiter'>; 
</span><a name="LN426"></a>    <span class='Keyword'>bool</span>       <span class='Operator'>*</span><span class='Declare_Local'>hasnulls</span><span class='Delimiter'>; 
</span><a name="LN427"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>tp</span><span class='Delimiter'>; 
</span><a name="LN428"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>nullbits</span><span class='Delimiter'>; 
</span><a name="LN429"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>keyno</span><span class='Delimiter'>; 
</span><a name="LN430"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>valueno</span><span class='Delimiter'>; 
</span><a name="LN431"></a>    <a href="../../../include/utils/palloc.h.html#LN35"><span class='Ref_to_Typedef'>MemoryContext</span></a> <span class='Declare_Local'>oldcxt</span><span class='Delimiter'>; 
</span> 
    <a href="brin_tuple.c.html#LN423"><span class='Ref_To_Local'>dtup</span></a> <span class='Operator'>= </span><a href="brin_tuple.c.html#LN421"><span class='Ref_to_Parameter'>dMemtuple</span></a> <span class='Operator'>? </span><a href="../../../include/access/brin_tuple.h.html#LN96"><span class='Ref_to_Proto'>brin_memtuple_initialize</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN421"><span class='Ref_to_Parameter'>dMemtuple</span></a><span class='Delimiter'>, </span><a href="brin_tuple.c.html#LN421"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Parentheses'>) </span><span class='Operator'>: 
</span>        <a href="../../../include/access/brin_tuple.h.html#LN95"><span class='Ref_to_Proto'>brin_new_memtuple</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN421"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/access/brin_tuple.h.html#LN82"><span class='Ref_to_Macro'>BrinTupleIsPlaceholder</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN421"><span class='Ref_to_Parameter'>tuple</span></a><span class='Parentheses'>))</span> 
        <a href="brin_tuple.c.html#LN423"><span class='Ref_To_Local'>dtup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN37"><span class='Ref_to_Member'>bt_placeholder</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <a href="brin_tuple.c.html#LN423"><span class='Ref_To_Local'>dtup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN38"><span class='Ref_to_Member'>bt_blkno</span></a> <span class='Operator'>= </span><a href="brin_tuple.c.html#LN421"><span class='Ref_to_Parameter'>tuple</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN56"><span class='Ref_to_Member'>bt_blkno</span></a><span class='Delimiter'>; 
</span> 
    <a href="brin_tuple.c.html#LN424"><span class='Ref_To_Local'>values</span></a> <span class='Operator'>= </span><a href="brin_tuple.c.html#LN423"><span class='Ref_To_Local'>dtup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN41"><span class='Ref_to_Member'>bt_values</span></a><span class='Delimiter'>; 
</span>    <a href="brin_tuple.c.html#LN425"><span class='Ref_To_Local'>allnulls</span></a> <span class='Operator'>= </span><a href="brin_tuple.c.html#LN423"><span class='Ref_To_Local'>dtup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN42"><span class='Ref_to_Member'>bt_allnulls</span></a><span class='Delimiter'>; 
</span>    <a href="brin_tuple.c.html#LN426"><span class='Ref_To_Local'>hasnulls</span></a> <span class='Operator'>= </span><a href="brin_tuple.c.html#LN423"><span class='Ref_To_Local'>dtup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN43"><span class='Ref_to_Member'>bt_hasnulls</span></a><span class='Delimiter'>; 
</span> 
    <a href="brin_tuple.c.html#LN427"><span class='Ref_To_Local'>tp</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="brin_tuple.c.html#LN421"><span class='Ref_to_Parameter'>tuple</span></a> <span class='Operator'>+ </span><a href="../../../include/access/brin_tuple.h.html#LN80"><span class='Ref_to_Macro'>BrinTupleDataOffset</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN421"><span class='Ref_to_Parameter'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/access/brin_tuple.h.html#LN81"><span class='Ref_to_Macro'>BrinTupleHasNulls</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN421"><span class='Ref_to_Parameter'>tuple</span></a><span class='Parentheses'>))</span> 
        <a href="brin_tuple.c.html#LN428"><span class='Ref_To_Local'>nullbits</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a> <span class='Operator'>*</span><span class='Parentheses'>) ((</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="brin_tuple.c.html#LN421"><span class='Ref_to_Parameter'>tuple</span></a> <span class='Operator'>+ </span><a href="../../../include/access/brin_tuple.h.html#LN70"><span class='Ref_to_Const'>SizeOfBrinTuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="brin_tuple.c.html#LN428"><span class='Ref_To_Local'>nullbits</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="brin_tuple.c.html#LN41"><span class='Ref_to_Proto'>brin_deconstruct_tuple</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN421"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Delimiter'>, 
</span>                           <a href="brin_tuple.c.html#LN427"><span class='Ref_To_Local'>tp</span></a><span class='Delimiter'>, </span><a href="brin_tuple.c.html#LN428"><span class='Ref_To_Local'>nullbits</span></a><span class='Delimiter'>, </span><a href="../../../include/access/brin_tuple.h.html#LN81"><span class='Ref_to_Macro'>BrinTupleHasNulls</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN421"><span class='Ref_to_Parameter'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                           <a href="brin_tuple.c.html#LN424"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>, </span><a href="brin_tuple.c.html#LN425"><span class='Ref_To_Local'>allnulls</span></a><span class='Delimiter'>, </span><a href="brin_tuple.c.html#LN426"><span class='Ref_To_Local'>hasnulls</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Iterate to assign each of the values to the corresponding item in the 
     * values array of each column.  The copies occur in the tuple's context. 
     */ 
</span>    <a href="brin_tuple.c.html#LN431"><span class='Ref_To_Local'>oldcxt</span></a> <span class='Operator'>= </span><a href="../../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN423"><span class='Ref_To_Local'>dtup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN39"><span class='Ref_to_Member'>bt_context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN430"><span class='Ref_To_Local'>valueno</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="brin_tuple.c.html#LN429"><span class='Ref_To_Local'>keyno</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="brin_tuple.c.html#LN429"><span class='Ref_To_Local'>keyno</span></a> <span class='Operator'>&LT; </span><a href="brin_tuple.c.html#LN421"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN49"><span class='Ref_to_Member'>bd_tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Delimiter'>; </span><a href="brin_tuple.c.html#LN429"><span class='Ref_To_Local'>keyno</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN461"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN425"><span class='Ref_To_Local'>allnulls</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN429"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="brin_tuple.c.html#LN430"><span class='Ref_To_Local'>valueno</span></a> <span class='Operator'>+= </span><a href="brin_tuple.c.html#LN421"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN58"><span class='Ref_to_Member'>bd_info</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN429"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN27"><span class='Ref_to_Member'>oi_nstored</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * We would like to skip datumCopy'ing the values datum in some cases, 
         * caller permitting ... 
         */ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN461"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="brin_tuple.c.html#LN461"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="brin_tuple.c.html#LN421"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN58"><span class='Ref_to_Member'>bd_info</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN429"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN27"><span class='Ref_to_Member'>oi_nstored</span></a><span class='Delimiter'>; </span><a href="brin_tuple.c.html#LN461"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>            <a href="brin_tuple.c.html#LN423"><span class='Ref_To_Local'>dtup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN45"><span class='Ref_to_Member'>bt_columns</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN429"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/access/brin_tuple.h.html#LN28"><span class='Ref_to_Member'>bv_values</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN461"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= 
</span>                <a href="../../../include/utils/datum.h.html#LN30"><span class='Ref_to_Proto'>datumCopy</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN424"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN430"><span class='Ref_To_Local'>valueno</span></a><span class='Operator'>++</span><span class='Delimiter'>], 
</span>                          <a href="brin_tuple.c.html#LN421"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN58"><span class='Ref_to_Member'>bd_info</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN429"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN33"><span class='Ref_to_Member'>oi_typcache</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN461"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span><a href="../../../include/utils/typcache.h.html#LN35"><span class='Ref_to_Member'>typbyval</span></a><span class='Delimiter'>, 
</span>                          <a href="brin_tuple.c.html#LN421"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN58"><span class='Ref_to_Member'>bd_info</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN429"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN33"><span class='Ref_to_Member'>oi_typcache</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN461"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span><a href="../../../include/utils/typcache.h.html#LN34"><span class='Ref_to_Member'>typlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="brin_tuple.c.html#LN423"><span class='Ref_To_Local'>dtup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN45"><span class='Ref_to_Member'>bt_columns</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN429"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/access/brin_tuple.h.html#LN26"><span class='Ref_to_Member'>bv_hasnulls</span></a> <span class='Operator'>= </span><a href="brin_tuple.c.html#LN426"><span class='Ref_To_Local'>hasnulls</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN429"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>]; 
</span>        <a href="brin_tuple.c.html#LN423"><span class='Ref_To_Local'>dtup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_tuple.h.html#LN45"><span class='Ref_to_Member'>bt_columns</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN429"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/access/brin_tuple.h.html#LN27"><span class='Ref_to_Member'>bv_allnulls</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for valueno=0,keyno=0;key... &raquo; </span> 
 
    <a href="../../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN431"><span class='Ref_To_Local'>oldcxt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="brin_tuple.c.html#LN423"><span class='Ref_To_Local'>dtup</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end brin_deform_tuple &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * brin_deconstruct_tuple 
 *      Guts of attribute extraction from an on-disk BRIN tuple. 
 * 
 * Its arguments are: 
 *  brdesc      BRIN descriptor for the stored tuple 
 *  tp          pointer to the tuple data area 
 *  nullbits    pointer to the tuple nulls bitmask 
 *  nulls       "has nulls" bit in tuple infomask 
 *  values      output values, array of size brdesc-&GT;bd_totalstored 
 *  allnulls    output "allnulls", size brdesc-&GT;bd_tupdesc-&GT;natts 
 *  hasnulls    output "hasnulls", size brdesc-&GT;bd_tupdesc-&GT;natts 
 * 
 * Output arrays must have been allocated by caller. 
 */ 
</span><span class='Keyword'>static inline void 
</span><a name="LN504"></a><span class='Declare_Function'>brin_deconstruct_tuple</span><span class='Parentheses'>(</span><a href="../../../include/access/brin_internal.h.html#LN40"><span class='Ref_to_Struct'>BrinDesc</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>brdesc</span><span class='Delimiter'>, 
</span><a name="LN505"></a>                       <span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>tp</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>nullbits</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>nulls</span><span class='Delimiter'>, 
</span><a name="LN506"></a>                       <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>values</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>allnulls</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>hasnulls</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN508"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>attnum</span><span class='Delimiter'>; 
</span><a name="LN509"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>stored</span><span class='Delimiter'>; 
</span><a name="LN510"></a>    <a href="../../../include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a>   <span class='Declare_Local'>diskdsc</span><span class='Delimiter'>; 
</span><a name="LN511"></a>    <span class='Keyword'>long</span>        <span class='Declare_Local'>off</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * First iterate to natts to obtain both null flags for each attribute. 
     * Note that we reverse the sense of the att_isnull test, because we store 
     * 1 for a null value (rather than a 1 for a not null value as is the 
     * att_isnull convention used elsewhere.)  See brin_form_tuple. 
     */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN508"><span class='Ref_To_Local'>attnum</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="brin_tuple.c.html#LN508"><span class='Ref_To_Local'>attnum</span></a> <span class='Operator'>&LT; </span><a href="brin_tuple.c.html#LN504"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN49"><span class='Ref_to_Member'>bd_tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Delimiter'>; </span><a href="brin_tuple.c.html#LN508"><span class='Ref_To_Local'>attnum</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * the "all nulls" bit means that all values in the page range for 
         * this column are nulls.  Therefore there are no values in the tuple 
         * data area. 
         */ 
</span>        <a href="brin_tuple.c.html#LN506"><span class='Ref_to_Parameter'>allnulls</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN508"><span class='Ref_To_Local'>attnum</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="brin_tuple.c.html#LN505"><span class='Ref_to_Parameter'>nulls</span></a> <span class='Operator'>&& !</span><a href="../../../include/access/tupmacs.h.html#LN20"><span class='Ref_to_Macro'>att_isnull</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN508"><span class='Ref_To_Local'>attnum</span></a><span class='Delimiter'>, </span><a href="brin_tuple.c.html#LN505"><span class='Ref_to_Parameter'>nullbits</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * the "has nulls" bit means that some tuples have nulls, but others 
         * have not-null values.  Therefore we know the tuple contains data 
         * for this column. 
         * 
         * The hasnulls bits follow the allnulls bits in the same bitmask. 
         */ 
</span>        <a href="brin_tuple.c.html#LN506"><span class='Ref_to_Parameter'>hasnulls</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN508"><span class='Ref_To_Local'>attnum</span></a><span class='Delimiter'>] </span><span class='Operator'>= 
</span>            <a href="brin_tuple.c.html#LN505"><span class='Ref_to_Parameter'>nulls</span></a> <span class='Operator'>&& !</span><a href="../../../include/access/tupmacs.h.html#LN20"><span class='Ref_to_Macro'>att_isnull</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN504"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN49"><span class='Ref_to_Member'>bd_tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a> <span class='Operator'>+ </span><a href="brin_tuple.c.html#LN508"><span class='Ref_To_Local'>attnum</span></a><span class='Delimiter'>, </span><a href="brin_tuple.c.html#LN505"><span class='Ref_to_Parameter'>nullbits</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Iterate to obtain each attribute's stored values.  Note that since we 
     * may reuse attribute entries for more than one column, we cannot cache 
     * offsets here. 
     */ 
</span>    <a href="brin_tuple.c.html#LN510"><span class='Ref_To_Local'>diskdsc</span></a> <span class='Operator'>= </span><a href="brin_tuple.c.html#LN49"><span class='Ref_to_Func'>brtuple_disk_tupdesc</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN504"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="brin_tuple.c.html#LN509"><span class='Ref_To_Local'>stored</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="brin_tuple.c.html#LN511"><span class='Ref_To_Local'>off</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN508"><span class='Ref_To_Local'>attnum</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="brin_tuple.c.html#LN508"><span class='Ref_To_Local'>attnum</span></a> <span class='Operator'>&LT; </span><a href="brin_tuple.c.html#LN504"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN49"><span class='Ref_to_Member'>bd_tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Delimiter'>; </span><a href="brin_tuple.c.html#LN508"><span class='Ref_To_Local'>attnum</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN549"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>datumno</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN506"><span class='Ref_to_Parameter'>allnulls</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN508"><span class='Ref_To_Local'>attnum</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="brin_tuple.c.html#LN509"><span class='Ref_To_Local'>stored</span></a> <span class='Operator'>+= </span><a href="brin_tuple.c.html#LN504"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN58"><span class='Ref_to_Member'>bd_info</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN508"><span class='Ref_To_Local'>attnum</span></a><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN27"><span class='Ref_to_Member'>oi_nstored</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN549"><span class='Ref_To_Local'>datumno</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>             <a href="brin_tuple.c.html#LN549"><span class='Ref_To_Local'>datumno</span></a> <span class='Operator'>&LT; </span><a href="brin_tuple.c.html#LN504"><span class='Ref_to_Parameter'>brdesc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN58"><span class='Ref_to_Member'>bd_info</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN508"><span class='Ref_To_Local'>attnum</span></a><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span><a href="../../../include/access/brin_internal.h.html#LN27"><span class='Ref_to_Member'>oi_nstored</span></a><span class='Delimiter'>; 
</span>             <a href="brin_tuple.c.html#LN549"><span class='Ref_To_Local'>datumno</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN561"></a>            <a href="../../../include/catalog/pg_attribute.h.html#LN186"><span class='Ref_to_Typedef'>Form_pg_attribute</span></a> <span class='Declare_Local'>thisatt</span> <span class='Operator'>= </span><a href="brin_tuple.c.html#LN510"><span class='Ref_To_Local'>diskdsc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/access/tupdesc.h.html#LN73"><span class='Ref_to_Member'>attrs</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN509"><span class='Ref_To_Local'>stored</span></a><span class='Delimiter'>]; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN561"><span class='Ref_To_Local'>thisatt</span></a><span class='Operator'>-&GT;</span>attlen <span class='Operator'>== -</span><span class='Number'>1</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="brin_tuple.c.html#LN511"><span class='Ref_To_Local'>off</span></a> <span class='Operator'>= </span><a href="../../../include/access/tupmacs.h.html#LN121"><span class='Ref_to_Macro'>att_align_pointer</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN511"><span class='Ref_To_Local'>off</span></a><span class='Delimiter'>, </span><a href="brin_tuple.c.html#LN561"><span class='Ref_To_Local'>thisatt</span></a><span class='Operator'>-&GT;</span>attalign<span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, 
</span>                                        <a href="brin_tuple.c.html#LN505"><span class='Ref_to_Parameter'>tp</span></a> <span class='Operator'>+ </span><a href="brin_tuple.c.html#LN511"><span class='Ref_To_Local'>off</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* not varlena, so safe to use att_align_nominal */ 
</span>                <a href="brin_tuple.c.html#LN511"><span class='Ref_To_Local'>off</span></a> <span class='Operator'>= </span><a href="../../../include/access/tupmacs.h.html#LN143"><span class='Ref_to_Macro'>att_align_nominal</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN511"><span class='Ref_To_Local'>off</span></a><span class='Delimiter'>, </span><a href="brin_tuple.c.html#LN561"><span class='Ref_To_Local'>thisatt</span></a><span class='Operator'>-&GT;</span>attalign<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <a href="brin_tuple.c.html#LN506"><span class='Ref_to_Parameter'>values</span></a><span class='Delimiter'>[</span><a href="brin_tuple.c.html#LN509"><span class='Ref_To_Local'>stored</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/access/tupmacs.h.html#LN36"><span class='Ref_to_Macro'>fetchatt</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN561"><span class='Ref_To_Local'>thisatt</span></a><span class='Delimiter'>, </span><a href="brin_tuple.c.html#LN505"><span class='Ref_to_Parameter'>tp</span></a> <span class='Operator'>+ </span><a href="brin_tuple.c.html#LN511"><span class='Ref_To_Local'>off</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="brin_tuple.c.html#LN511"><span class='Ref_To_Local'>off</span></a> <span class='Operator'>= </span><a href="../../../include/access/tupmacs.h.html#LN171"><span class='Ref_to_Macro'>att_addlength_pointer</span></a><span class='Parentheses'>(</span><a href="brin_tuple.c.html#LN511"><span class='Ref_To_Local'>off</span></a><span class='Delimiter'>, </span><a href="brin_tuple.c.html#LN561"><span class='Ref_To_Local'>thisatt</span></a><span class='Operator'>-&GT;</span>attlen<span class='Delimiter'>, </span><a href="brin_tuple.c.html#LN505"><span class='Ref_to_Parameter'>tp</span></a> <span class='Operator'>+ </span><a href="brin_tuple.c.html#LN511"><span class='Ref_To_Local'>off</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for datumno=0;datumno&LT;brd... &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for attnum=0;attnum&LT;brdes... &raquo; </span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end brin_deconstruct_tuple &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>