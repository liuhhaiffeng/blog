<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\backend\catalog\namespace.c</title>
<LINK REL=StyleSheet HREF="../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\backend\catalog\namespace.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:32 2017
</td></tr>
<tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
</span><span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * namespace.c 
 *    code to support accessing and searching namespaces 
 * 
 * This is separate from pg_namespace.c, which contains the routines that 
 * directly manipulate the pg_namespace system catalog.  This module 
 * provides routines associated with defining a "namespace search path" 
 * and implementing search-path-controlled searches. 
 * 
 * 
 * Portions Copyright (c) 1996-2017, PostgreSQL Global Development Group 
 * Portions Copyright (c) 1994, Regents of the University of California 
 * 
 * IDENTIFICATION 
 *    src/backend/catalog/namespace.c 
 * 
 *------------------------------------------------------------------------- 
 */ 
</span><span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>"access/htup_details.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/parallel.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/xact.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/xlog.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/dependency.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/objectaccess.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_authid.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_collation.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_conversion.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_conversion_fn.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_namespace.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_opclass.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_operator.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_opfamily.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_proc.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_statistic_ext.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_ts_config.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_ts_dict.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_ts_parser.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_ts_template.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_type.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"commands/dbcommands.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"funcapi.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"mb/pg_wchar.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"miscadmin.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"nodes/makefuncs.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parse_func.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"storage/ipc.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"storage/lmgr.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"storage/sinval.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/acl.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/builtins.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/catcache.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/guc.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/inval.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/lsyscache.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/memutils.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/syscache.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/varlena.h"</span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * The namespace search path is a possibly-empty list of namespace OIDs. 
 * In addition to the explicit list, implicitly-searched namespaces 
 * may be included: 
 * 
 * 1. If a TEMP table namespace has been initialized in this session, it 
 * is implicitly searched first.  (The only time this doesn't happen is 
 * when we are obeying an override search path spec that says not to use the 
 * temp namespace, or the temp namespace is included in the explicit list.) 
 * 
 * 2. The system catalog namespace is always searched.  If the system 
 * namespace is present in the explicit path then it will be searched in 
 * the specified order; otherwise it will be searched after TEMP tables and 
 * *before* the explicit list.  (It might seem that the system namespace 
 * should be implicitly last, but this behavior appears to be required by 
 * SQL99.  Also, this provides a way to search the system namespace first 
 * without thereby making it the default creation target namespace.) 
 * 
 * For security reasons, searches using the search path will ignore the temp 
 * namespace when searching for any object type other than relations and 
 * types.  (We must allow types since temp tables have rowtypes.) 
 * 
 * The default creation target namespace is always the first element of the 
 * explicit list.  If the explicit list is empty, there is no default target. 
 * 
 * The textual specification of search_path can include "$user" to refer to 
 * the namespace named the same as the current user, if any.  (This is just 
 * ignored if there is no such namespace.)  Also, it can include "pg_temp" 
 * to refer to the current backend's temp namespace.  This is usually also 
 * ignorable if the temp namespace hasn't been set up, but there's a special 
 * case: if "pg_temp" appears first then it should be the default creation 
 * target.  We kluge this case a little bit so that the temp namespace isn't 
 * set up until the first attempt to create something in it.  (The reason for 
 * klugery is that we can't create the temp namespace outside a transaction, 
 * but initial GUC processing of search_path happens outside a transaction.) 
 * activeTempCreationPending is TRUE if "pg_temp" appears first in the string 
 * but is not reflected in activeCreationNamespace because the namespace isn't 
 * set up yet. 
 * 
 * In bootstrap mode, the search path is set equal to "pg_catalog", so that 
 * the system namespace is the only one searched or inserted into. 
 * initdb is also careful to set search_path to "pg_catalog" for its 
 * post-bootstrap standalone backend runs.  Otherwise the default search 
 * path is determined by GUC.  The factory default path contains the PUBLIC 
 * namespace (if it exists), preceded by the user's personal namespace 
 * (if one exists). 
 * 
 * We support a stack of "override" search path settings for use within 
 * specific sections of backend code.  namespace_search_path is ignored 
 * whenever the override stack is nonempty.  activeSearchPath is always 
 * the actually active path; it points either to the search list of the 
 * topmost stack entry, or to baseSearchPath which is the list derived 
 * from namespace_search_path. 
 * 
 * If baseSearchPathValid is false, then baseSearchPath (and other 
 * derived variables) need to be recomputed from namespace_search_path. 
 * We mark it invalid upon an assignment to namespace_search_path or receipt 
 * of a syscache invalidation event for pg_namespace.  The recomputation 
 * is done during the next non-overridden lookup attempt.  Note that an 
 * override spec is never subject to recomputation. 
 * 
 * Any namespaces mentioned in namespace_search_path that are not readable 
 * by the current user ID are simply left out of baseSearchPath; so 
 * we have to be willing to recompute the path when current userid changes. 
 * namespaceUser is the userid the path has been computed for. 
 * 
 * Note: all data pointed to by these List variables is in TopMemoryContext. 
 */ 
</span> 
<span class='Comment_Multi_Line'>/* These variables define the actually active state: */ 
</span> 
<a name="LN133"></a><span class='Keyword'>static </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Var'>activeSearchPath</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* default place to create stuff; if InvalidOid, no default */ 
</span><a name="LN136"></a><span class='Keyword'>static </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>  <span class='Declare_Var'>activeCreationNamespace</span> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* if TRUE, activeCreationNamespace is wrong, it should be temp namespace */ 
</span><a name="LN139"></a><span class='Keyword'>static bool </span><span class='Declare_Var'>activeTempCreationPending</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* These variables are the values last derived from namespace_search_path: */ 
</span> 
<a name="LN143"></a><span class='Keyword'>static </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Var'>baseSearchPath</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
<a name="LN145"></a><span class='Keyword'>static </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>  <span class='Declare_Var'>baseCreationNamespace</span> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span> 
<a name="LN147"></a><span class='Keyword'>static bool </span><span class='Declare_Var'>baseTempCreationPending</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
<a name="LN149"></a><span class='Keyword'>static </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>  <span class='Declare_Var'>namespaceUser</span> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* The above four values are valid only if baseSearchPathValid */ 
</span><a name="LN152"></a><span class='Keyword'>static bool </span><span class='Declare_Var'>baseSearchPathValid</span> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Override requests are remembered in a stack of OverrideStackEntry structs */ 
</span> 
<span class='Control'>typedef</span> <span class='Control'>struct</span> 
<span class='Delimiter'>{ 
</span><a name="LN158"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Member'>searchPath</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* the desired search path */ 
</span><a name="LN159"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Member'>creationNamespace</span><span class='Delimiter'>;</span>      <span class='Comment_Single_Line'>/* the desired creation namespace */ 
</span><a name="LN160"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>nestLevel</span><span class='Delimiter'>;</span>      <span class='Comment_Single_Line'>/* subtransaction nesting level */ 
</span><a name="LN161"></a><span class='Delimiter'>} </span><span class='Declare_Typedef'>OverrideStackEntry</span><span class='Delimiter'>; 
</span> 
<a name="LN163"></a><span class='Keyword'>static </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Var'>overrideStack</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* 
 * myTempNamespace is InvalidOid until and unless a TEMP namespace is set up 
 * in a particular backend session (this happens when a CREATE TEMP TABLE 
 * command is first executed).  Thereafter it's the OID of the temp namespace. 
 * 
 * myTempToastNamespace is the OID of the namespace for my temp tables' toast 
 * tables.  It is set when myTempNamespace is, and is InvalidOid before that. 
 * 
 * myTempNamespaceSubID shows whether we've created the TEMP namespace in the 
 * current subtransaction.  The flag propagates up the subtransaction tree, 
 * so the main transaction will correctly recognize the flag if all 
 * intermediate subtransactions commit.  When it is InvalidSubTransactionId, 
 * we either haven't made the TEMP namespace yet, or have successfully 
 * committed its creation, depending on whether myTempNamespace is valid. 
 */ 
</span><a name="LN180"></a><span class='Keyword'>static </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>  <span class='Declare_Var'>myTempNamespace</span> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span> 
<a name="LN182"></a><span class='Keyword'>static </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>  <span class='Declare_Var'>myTempToastNamespace</span> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span> 
<a name="LN184"></a><span class='Keyword'>static </span><a href="../../include/c.h.html#LN400"><span class='Ref_to_Typedef'>SubTransactionId</span></a> <span class='Declare_Var'>myTempNamespaceSubID</span> <span class='Operator'>= </span><a href="../../include/c.h.html#LN402"><span class='Ref_to_Const'>InvalidSubTransactionId</span></a><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* 
 * This is the user's textual search path specification --- it's the value 
 * of the GUC variable 'search_path'. 
 */ 
</span><a name="LN190"></a><span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Var'>namespace_search_path</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* Local functions */ 
</span><a name="LN194"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>recomputeNamespacePath</span><span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN195"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>InitTempTableNamespace</span><span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN196"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>RemoveTempRelations</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>tempNamespaceId</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN197"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>RemoveTempRelationsCallback</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>code</span><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Declare_Parameter'>arg</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN198"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>NamespaceCallback</span><span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Declare_Parameter'>arg</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>cacheid</span><span class='Delimiter'>, </span><a href="../../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a> <span class='Declare_Parameter'>hashvalue</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN199"></a><span class='Keyword'>static bool </span><span class='Declare_Prototype'>MatchNamedCall</span><span class='Parentheses'>(</span><a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a> <span class='Declare_Parameter'>proctup</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>nargs</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>argnames</span><span class='Delimiter'>, 
</span><a name="LN200"></a>               <span class='Keyword'>int </span><span class='Operator'>**</span><span class='Declare_Parameter'>argnumbers</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * RangeVarGetRelid 
 *      Given a RangeVar describing an existing relation, 
 *      select the proper namespace and look up the relation OID. 
 * 
 * If the schema or relation is not found, return InvalidOid if missing_ok 
 * = true, otherwise raise an error. 
 * 
 * If nowait = true, throw an error if we'd have to wait for a lock. 
 * 
 * Callback allows caller to check permissions or acquire additional locks 
 * prior to grabbing the relation lock. 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN217"></a><span class='Declare_Function'>RangeVarGetRelidExtended</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="../../include/nodes/primnodes.h.html#LN62"><span class='Ref_to_Struct'>RangeVar</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>relation</span><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN25"><span class='Ref_to_Typedef'>LOCKMODE</span></a> <span class='Declare_Parameter'>lockmode</span><span class='Delimiter'>, 
</span><a name="LN218"></a>                         <span class='Keyword'>bool </span><span class='Declare_Parameter'>missing_ok</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>nowait</span><span class='Delimiter'>, 
</span><a name="LN219"></a>                       <a href="../../include/catalog/namespace.h.html#LN49"><span class='Ref_to_Typedef'>RangeVarGetRelidCallback</span></a> <span class='Declare_Parameter'>callback</span><span class='Delimiter'>, </span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Declare_Parameter'>callback_arg</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN221"></a>    <a href="../../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a>      <span class='Declare_Local'>inval_count</span><span class='Delimiter'>; 
</span><a name="LN222"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>relId</span><span class='Delimiter'>; 
</span><a name="LN223"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>oldRelId</span> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span><a name="LN224"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>retry</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We check the catalog name and then ignore it. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN65"><span class='Ref_to_Member'>catalogname</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN65"><span class='Ref_to_Member'>catalogname</span></a><span class='Delimiter'>, </span><a href="../../include/commands/dbcommands.h.html#LN29"><span class='Ref_to_Proto'>get_database_name</span></a><span class='Parentheses'>(</span><a href="../utils/init/globals.c.html#LN76"><span class='Ref_to_Global_Var'>MyDatabaseId</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cross-database references are not implemented: \"%s.%s.%s\""</span><span class='Delimiter'>, 
</span>                            <a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN65"><span class='Ref_to_Member'>catalogname</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a><span class='Delimiter'>, 
</span>                            <a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * DDL operations can change the results of a name lookup.  Since all such 
     * operations will generate invalidation messages, we keep track of 
     * whether any such messages show up while we're performing the operation, 
     * and retry until either (1) no more invalidation messages show up or (2) 
     * the answer doesn't change. 
     * 
     * But if lockmode = NoLock, then we assume that either the caller is OK 
     * with the answer changing under them, or that they already hold some 
     * appropriate lock, and therefore return the first answer we get without 
     * checking for invalidation messages.  Also, if the requested lock is 
     * already held, LockRelationOid will not AcceptInvalidationMessages, so 
     * we may fail to notice a change.  We could protect against that case by 
     * calling AcceptInvalidationMessages() before beginning this loop, but 
     * that would add a significant amount overhead, so for now we don't. 
     */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>;;</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Remember this value, so that, after looking up the relation name 
         * and locking its OID, we can check whether any invalidation messages 
         * have been processed that might require a do-over. 
         */ 
</span>        <a href="namespace.c.html#LN221"><span class='Ref_To_Local'>inval_count</span></a> <span class='Operator'>= </span><a href="../storage/ipc/sinval.c.html#LN25"><span class='Ref_to_Global_Var'>SharedInvalidMessageCounter</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Some non-default relpersistence value may have been specified.  The 
         * parser never generates such a RangeVar in simple DML, but it can 
         * happen in contexts such as "CREATE TEMP TABLE foo (f1 int PRIMARY 
         * KEY)".  Such a command will generate an added CREATE INDEX 
         * operation, which must be careful to find the temp table, even when 
         * pg_temp is not first in the search path. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN70"><span class='Ref_to_Member'>relpersistence</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_class.h.html#LN171"><span class='Ref_to_Const'>RELPERSISTENCE_TEMP</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>))</span> 
                <a href="namespace.c.html#LN222"><span class='Ref_To_Local'>relId</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* this probably can't happen? */ 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span><a name="LN280"></a>                    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span><span class='Delimiter'>; 
</span> 
                    <a href="namespace.c.html#LN280"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN113"><span class='Ref_to_Proto'>LookupExplicitNamespace</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN218"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * For missing_ok, allow a non-existent schema name to 
                     * return InvalidOid. 
                     */ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN280"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>!= </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>) 
</span>                        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_TABLE_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"temporary tables cannot specify a schema name"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span> 
                <a href="namespace.c.html#LN222"><span class='Ref_To_Local'>relId</span></a> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN123"><span class='Ref_to_Proto'>get_relname_relid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if relation-&GT;relpersiste... &raquo; </span> 
        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN299"></a>            <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* use exact schema given */ 
</span>            <a href="namespace.c.html#LN299"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN113"><span class='Ref_to_Proto'>LookupExplicitNamespace</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN218"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN218"><span class='Ref_to_Parameter'>missing_ok</span></a> <span class='Operator'>&& !</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN299"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span> 
                <a href="namespace.c.html#LN222"><span class='Ref_To_Local'>relId</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="namespace.c.html#LN222"><span class='Ref_To_Local'>relId</span></a> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN123"><span class='Ref_to_Proto'>get_relname_relid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN299"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* search the namespace path */ 
</span>            <a href="namespace.c.html#LN222"><span class='Ref_To_Local'>relId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN64"><span class='Ref_to_Proto'>RelnameGetRelid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Invoke caller-supplied callback, if any. 
         * 
         * This callback is a good place to check permissions: we haven't 
         * taken the table lock yet (and it's really best to check permissions 
         * before locking anything!), but we've gotten far enough to know what 
         * OID we think we should lock.  Of course, concurrent DDL might 
         * change things while we're waiting for the lock, but in that case 
         * the callback will be invoked again for the new OID. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN219"><span class='Ref_to_Parameter'>callback</span></a><span class='Parentheses'>) 
</span>            <a href="namespace.c.html#LN219"><span class='Ref_to_Parameter'>callback</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>relation</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN222"><span class='Ref_To_Local'>relId</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN223"><span class='Ref_To_Local'>oldRelId</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN219"><span class='Ref_to_Parameter'>callback_arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If no lock requested, we assume the caller knows what they're 
         * doing.  They should have already acquired a heavyweight lock on 
         * this relation earlier in the processing of this same statement, so 
         * it wouldn't be appropriate to AcceptInvalidationMessages() here, as 
         * that might pull the rug out from under them. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>lockmode</span></a> <span class='Operator'>== </span><a href="../../include/storage/lockdefs.h.html#LN33"><span class='Ref_to_Const'>NoLock</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If, upon retry, we get back the same OID we did last time, then the 
         * invalidation messages we processed did not change the final answer. 
         * So we're done. 
         * 
         * If we got a different OID, we've locked the relation that used to 
         * have this name rather than the one that does now.  So release the 
         * lock. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN224"><span class='Ref_To_Local'>retry</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN222"><span class='Ref_To_Local'>relId</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN223"><span class='Ref_To_Local'>oldRelId</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN223"><span class='Ref_To_Local'>oldRelId</span></a><span class='Parentheses'>))</span> 
                <a href="../../include/storage/lmgr.h.html#LN42"><span class='Ref_to_Proto'>UnlockRelationOid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN223"><span class='Ref_To_Local'>oldRelId</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>lockmode</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Lock relation.  This will also accept any pending invalidation 
         * messages.  If we got back InvalidOid, indicating not found, then 
         * there's nothing to lock, but we accept invalidation messages 
         * anyway, to flush any negative catcache entries that may be 
         * lingering. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN222"><span class='Ref_To_Local'>relId</span></a><span class='Parentheses'>))</span> 
            <a href="../../include/utils/inval.h.html#LN25"><span class='Ref_to_Proto'>AcceptInvalidationMessages</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="namespace.c.html#LN218"><span class='Ref_to_Parameter'>nowait</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/storage/lmgr.h.html#LN39"><span class='Ref_to_Proto'>LockRelationOid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN222"><span class='Ref_To_Local'>relId</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>lockmode</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/storage/lmgr.h.html#LN40"><span class='Ref_to_Proto'>ConditionalLockRelationOid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN222"><span class='Ref_To_Local'>relId</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>lockmode</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_LOCK_NOT_AVAILABLE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"could not obtain lock on relation \"%s.%s\""</span><span class='Delimiter'>, 
</span>                                <a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_LOCK_NOT_AVAILABLE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"could not obtain lock on relation \"%s\""</span><span class='Delimiter'>, 
</span>                                <a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If no invalidation message were processed, we're done! 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN221"><span class='Ref_To_Local'>inval_count</span></a> <span class='Operator'>== </span><a href="../storage/ipc/sinval.c.html#LN25"><span class='Ref_to_Global_Var'>SharedInvalidMessageCounter</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Something may have changed.  Let's repeat the name lookup, to make 
         * sure this name still references the same relation it did 
         * previously. 
         */ 
</span>        <a href="namespace.c.html#LN224"><span class='Ref_To_Local'>retry</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN223"><span class='Ref_To_Local'>oldRelId</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN222"><span class='Ref_To_Local'>relId</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for ;; &raquo; </span> 
 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN222"><span class='Ref_To_Local'>relId</span></a><span class='Parentheses'>) </span><span class='Operator'>&& !</span><a href="namespace.c.html#LN218"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span><a href="../../bin/scripts/vacuumdb.c.html#LN25"><span class='Ref_to_Const'>ERRCODE_UNDEFINED_TABLE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"relation \"%s.%s\" does not exist"</span><span class='Delimiter'>, 
</span>                            <a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span><a href="../../bin/scripts/vacuumdb.c.html#LN25"><span class='Ref_to_Const'>ERRCODE_UNDEFINED_TABLE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"relation \"%s\" does not exist"</span><span class='Delimiter'>, 
</span>                            <a href="namespace.c.html#LN217"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="namespace.c.html#LN222"><span class='Ref_To_Local'>relId</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end RangeVarGetRelidExtended &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * RangeVarGetCreationNamespace 
 *      Given a RangeVar describing a to-be-created relation, 
 *      choose which namespace to create it in. 
 * 
 * Note: calling this may result in a CommandCounterIncrement operation. 
 * That will happen on the first request for a temp table in any particular 
 * backend run; we will need to either create or clean out the temp schema. 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN420"></a><span class='Declare_Function'>RangeVarGetCreationNamespace</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="../../include/nodes/primnodes.h.html#LN62"><span class='Ref_to_Struct'>RangeVar</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>newRelation</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN422"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We check the catalog name and then ignore it. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN420"><span class='Ref_to_Parameter'>newRelation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN65"><span class='Ref_to_Member'>catalogname</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="namespace.c.html#LN420"><span class='Ref_to_Parameter'>newRelation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN65"><span class='Ref_to_Member'>catalogname</span></a><span class='Delimiter'>, </span><a href="../../include/commands/dbcommands.h.html#LN29"><span class='Ref_to_Proto'>get_database_name</span></a><span class='Parentheses'>(</span><a href="../utils/init/globals.c.html#LN76"><span class='Ref_to_Global_Var'>MyDatabaseId</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cross-database references are not implemented: \"%s.%s.%s\""</span><span class='Delimiter'>, 
</span>                            <a href="namespace.c.html#LN420"><span class='Ref_to_Parameter'>newRelation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN65"><span class='Ref_to_Member'>catalogname</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN420"><span class='Ref_to_Parameter'>newRelation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a><span class='Delimiter'>, 
</span>                            <a href="namespace.c.html#LN420"><span class='Ref_to_Parameter'>newRelation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN420"><span class='Ref_to_Parameter'>newRelation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* check for pg_temp alias */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="namespace.c.html#LN420"><span class='Ref_to_Parameter'>newRelation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a><span class='Delimiter'>, </span><span class='String'>"pg_temp"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Initialize temp namespace if first time through */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>))</span> 
                <a href="namespace.c.html#LN195"><span class='Ref_to_Proto'>InitTempTableNamespace</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Comment_Multi_Line'>/* use exact schema given */ 
</span>        <a href="namespace.c.html#LN422"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN114"><span class='Ref_to_Proto'>get_namespace_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN420"><span class='Ref_to_Parameter'>newRelation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* we do not check for USAGE rights here! */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN420"><span class='Ref_to_Parameter'>newRelation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN70"><span class='Ref_to_Member'>relpersistence</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_class.h.html#LN171"><span class='Ref_to_Const'>RELPERSISTENCE_TEMP</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Initialize temp namespace if first time through */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>))</span> 
            <a href="namespace.c.html#LN195"><span class='Ref_to_Proto'>InitTempTableNamespace</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* use the default creation namespace */ 
</span>        <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN139"><span class='Ref_to_Global_Var'>activeTempCreationPending</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Need to initialize temp namespace */ 
</span>            <a href="namespace.c.html#LN195"><span class='Ref_to_Proto'>InitTempTableNamespace</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="namespace.c.html#LN422"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN136"><span class='Ref_to_Global_Var'>activeCreationNamespace</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN422"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_SCHEMA<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"no schema has been selected to create in"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Note: callers will check for CREATE rights when appropriate */ 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN422"><span class='Ref_To_Local'>namespaceId</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end RangeVarGetCreationNamespace &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * RangeVarGetAndCheckCreationNamespace 
 * 
 * This function returns the OID of the namespace in which a new relation 
 * with a given name should be created.  If the user does not have CREATE 
 * permission on the target namespace, this function will instead signal 
 * an ERROR. 
 * 
 * If non-NULL, *existing_oid is set to the OID of any existing relation with 
 * the same name which already exists in that namespace, or to InvalidOid if 
 * no such relation exists. 
 * 
 * If lockmode != NoLock, the specified lock mode is acquired on the existing 
 * relation, if any, provided that the current user owns the target relation. 
 * However, if lockmode != NoLock and the user does not own the target 
 * relation, we throw an ERROR, as we must not try to lock relations the 
 * user does not have permissions on. 
 * 
 * As a side effect, this function acquires AccessShareLock on the target 
 * namespace.  Without this, the namespace could be dropped before our 
 * transaction commits, leaving behind relations with relnamespace pointing 
 * to a no-longer-existent namespace. 
 * 
 * As a further side-effect, if the selected namespace is a temporary namespace, 
 * we mark the RangeVar as RELPERSISTENCE_TEMP. 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN507"></a><span class='Declare_Function'>RangeVarGetAndCheckCreationNamespace</span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN62"><span class='Ref_to_Struct'>RangeVar</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>relation</span><span class='Delimiter'>, 
</span><a name="LN508"></a>                                     <a href="../../include/storage/lockdefs.h.html#LN25"><span class='Ref_to_Typedef'>LOCKMODE</span></a> <span class='Declare_Parameter'>lockmode</span><span class='Delimiter'>, 
</span><a name="LN509"></a>                                     <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>existing_relation_id</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN511"></a>    <a href="../../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a>      <span class='Declare_Local'>inval_count</span><span class='Delimiter'>; 
</span><a name="LN512"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>relid</span><span class='Delimiter'>; 
</span><a name="LN513"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>oldrelid</span> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span><a name="LN514"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>nspid</span><span class='Delimiter'>; 
</span><a name="LN515"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>oldnspid</span> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span><a name="LN516"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>retry</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We check the catalog name and then ignore it. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN507"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN65"><span class='Ref_to_Member'>catalogname</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="namespace.c.html#LN507"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN65"><span class='Ref_to_Member'>catalogname</span></a><span class='Delimiter'>, </span><a href="../../include/commands/dbcommands.h.html#LN29"><span class='Ref_to_Proto'>get_database_name</span></a><span class='Parentheses'>(</span><a href="../utils/init/globals.c.html#LN76"><span class='Ref_to_Global_Var'>MyDatabaseId</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cross-database references are not implemented: \"%s.%s.%s\""</span><span class='Delimiter'>, 
</span>                            <a href="namespace.c.html#LN507"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN65"><span class='Ref_to_Member'>catalogname</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN507"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a><span class='Delimiter'>, 
</span>                            <a href="namespace.c.html#LN507"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * As in RangeVarGetRelidExtended(), we guard against concurrent DDL 
     * operations by tracking whether any invalidation messages are processed 
     * while we're doing the name lookups and acquiring locks.  See comments 
     * in that function for a more detailed explanation of this logic. 
     */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>;;</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN539"></a>        <a href="../../include/utils/acl.h.html#LN169"><span class='Ref_to_Typedef'>AclResult</span></a>   <span class='Declare_Local'>aclresult</span><span class='Delimiter'>; 
</span> 
        <a href="namespace.c.html#LN511"><span class='Ref_To_Local'>inval_count</span></a> <span class='Operator'>= </span><a href="../storage/ipc/sinval.c.html#LN25"><span class='Ref_to_Global_Var'>SharedInvalidMessageCounter</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Look up creation namespace and check for existing relation. */ 
</span>        <a href="namespace.c.html#LN514"><span class='Ref_To_Local'>nspid</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN59"><span class='Ref_to_Proto'>RangeVarGetCreationNamespace</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN507"><span class='Ref_to_Parameter'>relation</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN514"><span class='Ref_To_Local'>nspid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN509"><span class='Ref_to_Parameter'>existing_relation_id</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>            <a href="namespace.c.html#LN512"><span class='Ref_To_Local'>relid</span></a> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN123"><span class='Ref_to_Proto'>get_relname_relid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN507"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN514"><span class='Ref_To_Local'>nspid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="namespace.c.html#LN512"><span class='Ref_To_Local'>relid</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * In bootstrap processing mode, we don't bother with permissions or 
         * locking.  Permissions might not be working yet, and locking is 
         * unnecessary. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/miscadmin.h.html#LN369"><span class='Ref_to_Macro'>IsBootstrapProcessingMode</span></a><span class='Parentheses'>())</span> 
            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Check namespace permissions. */ 
</span>        <a href="namespace.c.html#LN539"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>= </span><a href="../../include/utils/acl.h.html#LN289"><span class='Ref_to_Proto'>pg_namespace_aclcheck</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN514"><span class='Ref_To_Local'>nspid</span></a><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN81"><span class='Ref_to_Const'>ACL_CREATE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN539"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>!= </span><a href="../../include/utils/acl.h.html#LN171"><span class='Ref_to_EnumConst'>ACLCHECK_OK</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/acl.h.html#LN295"><span class='Ref_to_Proto'>aclcheck_error</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN539"><span class='Ref_To_Local'>aclresult</span></a><span class='Delimiter'>, </span><a href="../../include/utils/acl.h.html#LN189"><span class='Ref_to_EnumConst'>ACL_KIND_NAMESPACE</span></a><span class='Delimiter'>, 
</span>                           <a href="../../include/utils/lsyscache.h.html#LN175"><span class='Ref_to_Proto'>get_namespace_name</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN514"><span class='Ref_To_Local'>nspid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN516"><span class='Ref_To_Local'>retry</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* If nothing changed, we're done. */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN512"><span class='Ref_To_Local'>relid</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN513"><span class='Ref_To_Local'>oldrelid</span></a> <span class='Operator'>&& </span><a href="namespace.c.html#LN514"><span class='Ref_To_Local'>nspid</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN515"><span class='Ref_To_Local'>oldnspid</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* If creation namespace has changed, give up old lock. */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN514"><span class='Ref_To_Local'>nspid</span></a> <span class='Operator'>!= </span><a href="namespace.c.html#LN515"><span class='Ref_To_Local'>oldnspid</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/storage/lmgr.h.html#LN89"><span class='Ref_to_Proto'>UnlockDatabaseObject</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_namespace.h.html#LN33"><span class='Ref_to_Const'>NamespaceRelationId</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN515"><span class='Ref_To_Local'>oldnspid</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, 
</span>                                     <a href="../../include/storage/lockdefs.h.html#LN35"><span class='Ref_to_Const'>AccessShareLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* If name points to something different, give up old lock. */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN512"><span class='Ref_To_Local'>relid</span></a> <span class='Operator'>!= </span><a href="namespace.c.html#LN513"><span class='Ref_To_Local'>oldrelid</span></a> <span class='Operator'>&& </span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN513"><span class='Ref_To_Local'>oldrelid</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><a href="namespace.c.html#LN508"><span class='Ref_to_Parameter'>lockmode</span></a> <span class='Operator'>!= </span><a href="../../include/storage/lockdefs.h.html#LN33"><span class='Ref_to_Const'>NoLock</span></a><span class='Parentheses'>)</span> 
                <a href="../../include/storage/lmgr.h.html#LN42"><span class='Ref_to_Proto'>UnlockRelationOid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN513"><span class='Ref_To_Local'>oldrelid</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN508"><span class='Ref_to_Parameter'>lockmode</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* Lock namespace. */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN514"><span class='Ref_To_Local'>nspid</span></a> <span class='Operator'>!= </span><a href="namespace.c.html#LN515"><span class='Ref_To_Local'>oldnspid</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/storage/lmgr.h.html#LN87"><span class='Ref_to_Proto'>LockDatabaseObject</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_namespace.h.html#LN33"><span class='Ref_to_Const'>NamespaceRelationId</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN514"><span class='Ref_To_Local'>nspid</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN35"><span class='Ref_to_Const'>AccessShareLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Lock relation, if required if and we have permission. */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN508"><span class='Ref_to_Parameter'>lockmode</span></a> <span class='Operator'>!= </span><a href="../../include/storage/lockdefs.h.html#LN33"><span class='Ref_to_Const'>NoLock</span></a> <span class='Operator'>&& </span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN512"><span class='Ref_To_Local'>relid</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/acl.h.html#LN308"><span class='Ref_to_Proto'>pg_class_ownercheck</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN512"><span class='Ref_To_Local'>relid</span></a><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()))</span> 
                <a href="../../include/utils/acl.h.html#LN295"><span class='Ref_to_Proto'>aclcheck_error</span></a><span class='Parentheses'>(</span><a href="../../include/utils/acl.h.html#LN173"><span class='Ref_to_EnumConst'>ACLCHECK_NOT_OWNER</span></a><span class='Delimiter'>, </span><a href="../../include/utils/acl.h.html#LN181"><span class='Ref_to_EnumConst'>ACL_KIND_CLASS</span></a><span class='Delimiter'>, 
</span>                               <a href="namespace.c.html#LN507"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN512"><span class='Ref_To_Local'>relid</span></a> <span class='Operator'>!= </span><a href="namespace.c.html#LN513"><span class='Ref_To_Local'>oldrelid</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/storage/lmgr.h.html#LN39"><span class='Ref_to_Proto'>LockRelationOid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN512"><span class='Ref_To_Local'>relid</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN508"><span class='Ref_to_Parameter'>lockmode</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* If no invalidation message were processed, we're done! */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN511"><span class='Ref_To_Local'>inval_count</span></a> <span class='Operator'>== </span><a href="../storage/ipc/sinval.c.html#LN25"><span class='Ref_to_Global_Var'>SharedInvalidMessageCounter</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Something may have changed, so recheck our work. */ 
</span>        <a href="namespace.c.html#LN516"><span class='Ref_To_Local'>retry</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN513"><span class='Ref_To_Local'>oldrelid</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN512"><span class='Ref_To_Local'>relid</span></a><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN515"><span class='Ref_To_Local'>oldnspid</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN514"><span class='Ref_To_Local'>nspid</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for ;; &raquo; </span> 
 
    <a href="../../include/catalog/namespace.h.html#LN63"><span class='Ref_to_Proto'>RangeVarAdjustRelationPersistence</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN507"><span class='Ref_to_Parameter'>relation</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN514"><span class='Ref_To_Local'>nspid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN509"><span class='Ref_to_Parameter'>existing_relation_id</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="namespace.c.html#LN509"><span class='Ref_to_Parameter'>existing_relation_id</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN512"><span class='Ref_To_Local'>relid</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="namespace.c.html#LN514"><span class='Ref_To_Local'>nspid</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end RangeVarGetAndCheckCreationNamespace &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Adjust the relpersistence for an about-to-be-created relation based on the 
 * creation namespace, and throw an error for invalid combinations. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN614"></a><span class='Declare_Function'>RangeVarAdjustRelationPersistence</span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN62"><span class='Ref_to_Struct'>RangeVar</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>newRelation</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>nspid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN614"><span class='Ref_to_Parameter'>newRelation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN70"><span class='Ref_to_Member'>relpersistence</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../include/catalog/pg_class.h.html#LN171"><span class='Ref_to_Const'>RELPERSISTENCE_TEMP</span></a><span class='Operator'>: 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/catalog/namespace.h.html#LN125"><span class='Ref_to_Proto'>isTempOrTempToastNamespace</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN614"><span class='Ref_to_Parameter'>nspid</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN126"><span class='Ref_to_Proto'>isAnyTempNamespace</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN614"><span class='Ref_to_Parameter'>nspid</span></a><span class='Parentheses'>))</span> 
                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_TABLE_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot create relations in temporary schemas of other sessions"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <span class='Control'>else</span> 
                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_TABLE_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot create temporary relation in non-temporary schema"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/catalog/pg_class.h.html#LN169"><span class='Ref_to_Const'>RELPERSISTENCE_PERMANENT</span></a><span class='Operator'>: 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN125"><span class='Ref_to_Proto'>isTempOrTempToastNamespace</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN614"><span class='Ref_to_Parameter'>nspid</span></a><span class='Parentheses'>))</span> 
                <a href="namespace.c.html#LN614"><span class='Ref_to_Parameter'>newRelation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN70"><span class='Ref_to_Member'>relpersistence</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_class.h.html#LN171"><span class='Ref_to_Const'>RELPERSISTENCE_TEMP</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN126"><span class='Ref_to_Proto'>isAnyTempNamespace</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN614"><span class='Ref_to_Parameter'>nspid</span></a><span class='Parentheses'>))</span> 
                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_TABLE_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot create relations in temporary schemas of other sessions"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN126"><span class='Ref_to_Proto'>isAnyTempNamespace</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN614"><span class='Ref_to_Parameter'>nspid</span></a><span class='Parentheses'>))</span> 
                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_TABLE_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"only temporary relations may be created in temporary schemas"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch newRelation-&GT;relpersi... &raquo; </span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end RangeVarAdjustRelationPersistence &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * RelnameGetRelid 
 *      Try to resolve an unqualified relation name. 
 *      Returns OID if relation found in search path, else InvalidOid. 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN653"></a><span class='Declare_Function'>RelnameGetRelid</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>relname</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN655"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>relid</span><span class='Delimiter'>; 
</span><a name="LN656"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN656"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN662"></a>        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN656"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="namespace.c.html#LN655"><span class='Ref_To_Local'>relid</span></a> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN123"><span class='Ref_to_Proto'>get_relname_relid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN653"><span class='Ref_to_Parameter'>relname</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN662"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN655"><span class='Ref_To_Local'>relid</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="namespace.c.html#LN655"><span class='Ref_To_Local'>relid</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Not found in path */ 
</span>    <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end RelnameGetRelid &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * RelationIsVisible 
 *      Determine whether a relation (identified by OID) is visible in the 
 *      current search path.  Visible means "would be found by searching 
 *      for the unqualified relation name". 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN681"></a><span class='Declare_Function'>RelationIsVisible</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>relid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN683"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>reltup</span><span class='Delimiter'>; 
</span><a name="LN684"></a>    <a href="../../include/catalog/pg_class.h.html#LN94"><span class='Ref_to_Typedef'>Form_pg_class</span></a> <span class='Declare_Local'>relform</span><span class='Delimiter'>; 
</span><a name="LN685"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>relnamespace</span><span class='Delimiter'>; 
</span><a name="LN686"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>visible</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN683"><span class='Ref_To_Local'>reltup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN83"><span class='Ref_to_EnumConst'>RELOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN681"><span class='Ref_to_Parameter'>relid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN683"><span class='Ref_To_Local'>reltup</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for relation %u"</span><span class='Delimiter'>, </span><a href="namespace.c.html#LN681"><span class='Ref_to_Parameter'>relid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN684"><span class='Ref_To_Local'>relform</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_class.h.html#LN94"><span class='Ref_to_Typedef'>Form_pg_class</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN683"><span class='Ref_To_Local'>reltup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Quick check: if it ain't in the path at all, it ain't visible. Items in 
     * the system namespace are surely in the path and so we needn't even do 
     * list_member_oid() for them. 
     */ 
</span>    <a href="namespace.c.html#LN685"><span class='Ref_To_Local'>relnamespace</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN684"><span class='Ref_To_Local'>relform</span></a><span class='Operator'>-&GT;</span>relnamespace<span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN685"><span class='Ref_To_Local'>relnamespace</span></a> <span class='Operator'>!= </span><a href="../../include/catalog/pg_namespace.h.html#LN70"><span class='Ref_to_Const'>PG_CATALOG_NAMESPACE</span></a> <span class='Operator'>&& 
</span>        <span class='Operator'>!</span><a href="../../include/nodes/pg_list.h.html#LN231"><span class='Ref_to_Proto'>list_member_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN685"><span class='Ref_To_Local'>relnamespace</span></a><span class='Parentheses'>))</span> 
        <a href="namespace.c.html#LN686"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * If it is in the path, it might still not be visible; it could be 
         * hidden by another relation of the same name earlier in the path. So 
         * we must do a slow check for conflicting relations. 
         */ 
</span><a name="LN711"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>relname</span> <span class='Operator'>= </span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN684"><span class='Ref_To_Local'>relform</span></a><span class='Operator'>-&GT;</span>relname<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN712"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
        <a href="namespace.c.html#LN686"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN712"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN717"></a>            <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN712"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN717"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN685"><span class='Ref_To_Local'>relnamespace</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Found it first in path */ 
</span>                <a href="namespace.c.html#LN686"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="../../include/utils/lsyscache.h.html#LN123"><span class='Ref_to_Proto'>get_relname_relid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN711"><span class='Ref_To_Local'>relname</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN717"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>)))</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Found something else first in path */ 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN683"><span class='Ref_To_Local'>reltup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN686"><span class='Ref_To_Local'>visible</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end RelationIsVisible &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * TypenameGetTypid 
 *      Try to resolve an unqualified datatype name. 
 *      Returns OID if type found in search path, else InvalidOid. 
 * 
 * This is essentially the same as RelnameGetRelid. 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN747"></a><span class='Declare_Function'>TypenameGetTypid</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>typname</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN749"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>typid</span><span class='Delimiter'>; 
</span><a name="LN750"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN750"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN756"></a>        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN750"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="namespace.c.html#LN749"><span class='Ref_To_Local'>typid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN184"><span class='Ref_to_Macro'>GetSysCacheOid2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN106"><span class='Ref_to_EnumConst'>TYPENAMENSP</span></a><span class='Delimiter'>, 
</span>                                <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN747"><span class='Ref_to_Parameter'>typname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN756"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN749"><span class='Ref_To_Local'>typid</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="namespace.c.html#LN749"><span class='Ref_To_Local'>typid</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Not found in path */ 
</span>    <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end TypenameGetTypid &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * TypeIsVisible 
 *      Determine whether a type (identified by OID) is visible in the 
 *      current search path.  Visible means "would be found by searching 
 *      for the unqualified type name". 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN776"></a><span class='Declare_Function'>TypeIsVisible</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>typid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN778"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>typtup</span><span class='Delimiter'>; 
</span><a name="LN779"></a>    <a href="../../include/catalog/pg_type.h.html#LN232"><span class='Ref_to_Typedef'>Form_pg_type</span></a> <span class='Declare_Local'>typform</span><span class='Delimiter'>; 
</span><a name="LN780"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>typnamespace</span><span class='Delimiter'>; 
</span><a name="LN781"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>visible</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN778"><span class='Ref_To_Local'>typtup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN107"><span class='Ref_to_EnumConst'>TYPEOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN776"><span class='Ref_to_Parameter'>typid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN778"><span class='Ref_To_Local'>typtup</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for type %u"</span><span class='Delimiter'>, </span><a href="namespace.c.html#LN776"><span class='Ref_to_Parameter'>typid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN779"><span class='Ref_To_Local'>typform</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_type.h.html#LN232"><span class='Ref_to_Typedef'>Form_pg_type</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN778"><span class='Ref_To_Local'>typtup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Quick check: if it ain't in the path at all, it ain't visible. Items in 
     * the system namespace are surely in the path and so we needn't even do 
     * list_member_oid() for them. 
     */ 
</span>    <a href="namespace.c.html#LN780"><span class='Ref_To_Local'>typnamespace</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN779"><span class='Ref_To_Local'>typform</span></a><span class='Operator'>-&GT;</span>typnamespace<span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN780"><span class='Ref_To_Local'>typnamespace</span></a> <span class='Operator'>!= </span><a href="../../include/catalog/pg_namespace.h.html#LN70"><span class='Ref_to_Const'>PG_CATALOG_NAMESPACE</span></a> <span class='Operator'>&& 
</span>        <span class='Operator'>!</span><a href="../../include/nodes/pg_list.h.html#LN231"><span class='Ref_to_Proto'>list_member_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN780"><span class='Ref_To_Local'>typnamespace</span></a><span class='Parentheses'>))</span> 
        <a href="namespace.c.html#LN781"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * If it is in the path, it might still not be visible; it could be 
         * hidden by another type of the same name earlier in the path. So we 
         * must do a slow check for conflicting types. 
         */ 
</span><a name="LN806"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>typname</span> <span class='Operator'>= </span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN779"><span class='Ref_To_Local'>typform</span></a><span class='Operator'>-&GT;</span>typname<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN807"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
        <a href="namespace.c.html#LN781"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN807"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN812"></a>            <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN807"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN812"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN780"><span class='Ref_To_Local'>typnamespace</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Found it first in path */ 
</span>                <a href="namespace.c.html#LN781"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN175"><span class='Ref_to_Macro'>SearchSysCacheExists2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN106"><span class='Ref_to_EnumConst'>TYPENAMENSP</span></a><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN806"><span class='Ref_To_Local'>typname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN812"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>)))</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Found something else first in path */ 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN778"><span class='Ref_To_Local'>typtup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN781"><span class='Ref_To_Local'>visible</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end TypeIsVisible &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * FuncnameGetCandidates 
 *      Given a possibly-qualified function name and argument count, 
 *      retrieve a list of the possible matches. 
 * 
 * If nargs is -1, we return all functions matching the given name, 
 * regardless of argument count.  (argnames must be NIL, and expand_variadic 
 * and expand_defaults must be false, in this case.) 
 * 
 * If argnames isn't NIL, we are considering a named- or mixed-notation call, 
 * and only functions having all the listed argument names will be returned. 
 * (We assume that length(argnames) &LT;= nargs and all the passed-in names are 
 * distinct.)  The returned structs will include an argnumbers array showing 
 * the actual argument index for each logical argument position. 
 * 
 * If expand_variadic is true, then variadic functions having the same number 
 * or fewer arguments will be retrieved, with the variadic argument and any 
 * additional argument positions filled with the variadic element type. 
 * nvargs in the returned struct is set to the number of such arguments. 
 * If expand_variadic is false, variadic arguments are not treated specially, 
 * and the returned nvargs will always be zero. 
 * 
 * If expand_defaults is true, functions that could match after insertion of 
 * default argument values will also be retrieved.  In this case the returned 
 * structs could have nargs &GT; passed-in nargs, and ndargs is set to the number 
 * of additional args (which can be retrieved from the function's 
 * proargdefaults entry). 
 * 
 * It is not possible for nvargs and ndargs to both be nonzero in the same 
 * list entry, since default insertion allows matches to functions with more 
 * than nargs arguments while the variadic transformation requires the same 
 * number or less. 
 * 
 * When argnames isn't NIL, the returned args[] type arrays are not ordered 
 * according to the functions' declarations, but rather according to the call: 
 * first any positional arguments, then the named arguments, then defaulted 
 * arguments (if needed and allowed by expand_defaults).  The argnumbers[] 
 * array can be used to map this back to the catalog information. 
 * argnumbers[k] is set to the proargtypes index of the k'th call argument. 
 * 
 * We search a single namespace if the function name is qualified, else 
 * all namespaces in the search path.  In the multiple-namespace case, 
 * we arrange for entries in earlier namespaces to mask identical entries in 
 * later namespaces. 
 * 
 * When expanding variadics, we arrange for non-variadic functions to mask 
 * variadic ones if the expanded argument list is the same.  It is still 
 * possible for there to be conflicts between different variadic functions, 
 * however. 
 * 
 * It is guaranteed that the return list will never contain multiple entries 
 * with identical argument lists.  When expand_defaults is true, the entries 
 * could have more than nargs positions, but we still guarantee that they are 
 * distinct in the first nargs positions.  However, if argnames isn't NIL or 
 * either expand_variadic or expand_defaults is true, there might be multiple 
 * candidate functions that expand to identical argument lists.  Rather than 
 * throw error here, we report such situations by returning a single entry 
 * with oid = 0 that represents a set of such conflicting candidates. 
 * The caller might end up discarding such an entry anyway, but if it selects 
 * such an entry it should react as though the call were ambiguous. 
 * 
 * If missing_ok is true, an empty list (NULL) is returned if the name was 
 * schema- qualified with a schema that does not exist.  Likewise if no 
 * candidate is found for other reasons. 
 */ 
</span><a href="../../include/catalog/namespace.h.html#LN27"><span class='Ref_to_Typedef'>FuncCandidateList</span></a> 
<a name="LN902"></a><span class='Declare_Function'>FuncnameGetCandidates</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>names</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>nargs</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>argnames</span><span class='Delimiter'>, 
</span><a name="LN903"></a>                      <span class='Keyword'>bool </span><span class='Declare_Parameter'>expand_variadic</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>expand_defaults</span><span class='Delimiter'>, 
</span><a name="LN904"></a>                      <span class='Keyword'>bool </span><span class='Declare_Parameter'>missing_ok</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN906"></a>    <a href="../../include/catalog/namespace.h.html#LN27"><span class='Ref_to_Typedef'>FuncCandidateList</span></a> <span class='Declare_Local'>resultList</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN907"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>any_special</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN908"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>schemaname</span><span class='Delimiter'>; 
</span><a name="LN909"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>funcname</span><span class='Delimiter'>; 
</span><a name="LN910"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span><span class='Delimiter'>; 
</span><a name="LN911"></a>    <a href="../../include/utils/catcache.h.html#LN119"><span class='Ref_to_Typedef'>CatCList</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>catlist</span><span class='Delimiter'>; 
</span><a name="LN912"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* check for caller error */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="namespace.c.html#LN902"><span class='Ref_to_Parameter'>nargs</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span> <span class='Operator'>|| !</span><span class='Parentheses'>(</span><a href="namespace.c.html#LN903"><span class='Ref_to_Parameter'>expand_variadic</span></a> <span class='Operator'>| </span><a href="namespace.c.html#LN903"><span class='Ref_to_Parameter'>expand_defaults</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* deconstruct the name list */ 
</span>    <a href="../../include/catalog/namespace.h.html#LN109"><span class='Ref_to_Proto'>DeconstructQualifiedName</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN902"><span class='Ref_to_Parameter'>names</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="namespace.c.html#LN908"><span class='Ref_To_Local'>schemaname</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="namespace.c.html#LN909"><span class='Ref_To_Local'>funcname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN908"><span class='Ref_To_Local'>schemaname</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* use exact schema given */ 
</span>        <a href="namespace.c.html#LN910"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN113"><span class='Ref_to_Proto'>LookupExplicitNamespace</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN908"><span class='Ref_To_Local'>schemaname</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN904"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN910"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* flag to indicate we need namespace search */ 
</span>        <a href="namespace.c.html#LN910"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Search syscache by name only */ 
</span>    <a href="namespace.c.html#LN911"><span class='Ref_To_Local'>catlist</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN200"><span class='Ref_to_Macro'>SearchSysCacheList1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN75"><span class='Ref_to_EnumConst'>PROCNAMEARGSNSP</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN583"><span class='Ref_to_Macro'>CStringGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN909"><span class='Ref_To_Local'>funcname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN912"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="namespace.c.html#LN912"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="namespace.c.html#LN911"><span class='Ref_To_Local'>catlist</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/catcache.h.html#LN153"><span class='Ref_to_Member'>n_members</span></a><span class='Delimiter'>; </span><a href="namespace.c.html#LN912"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN939"></a>        <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>proctup</span> <span class='Operator'>= &</span><a href="namespace.c.html#LN911"><span class='Ref_To_Local'>catlist</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/catcache.h.html#LN154"><span class='Ref_to_Member'>members</span></a><span class='Delimiter'>[</span><a href="namespace.c.html#LN912"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span><a href="../../include/utils/catcache.h.html#LN115"><span class='Ref_to_Member'>tuple</span></a><span class='Delimiter'>; 
</span><a name="LN940"></a>        <a href="../../include/catalog/pg_proc.h.html#LN82"><span class='Ref_to_Typedef'>Form_pg_proc</span></a> <span class='Declare_Local'>procform</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_proc.h.html#LN82"><span class='Ref_to_Typedef'>Form_pg_proc</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN939"><span class='Ref_To_Local'>proctup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN941"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>pronargs</span> <span class='Operator'>= </span><a href="namespace.c.html#LN940"><span class='Ref_To_Local'>procform</span></a><span class='Operator'>-&GT;</span>pronargs<span class='Delimiter'>; 
</span><a name="LN942"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>effective_nargs</span><span class='Delimiter'>; 
</span><a name="LN943"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>pathpos</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN944"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>variadic</span><span class='Delimiter'>; 
</span><a name="LN945"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>use_defaults</span><span class='Delimiter'>; 
</span><a name="LN946"></a>        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>va_elem_type</span><span class='Delimiter'>; 
</span><a name="LN947"></a>        <span class='Keyword'>int</span>        <span class='Operator'>*</span><span class='Declare_Local'>argnumbers</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN948"></a>        <a href="../../include/catalog/namespace.h.html#LN27"><span class='Ref_to_Typedef'>FuncCandidateList</span></a> <span class='Declare_Local'>newResult</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN910"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Consider only procs in specified namespace */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN940"><span class='Ref_To_Local'>procform</span></a><span class='Operator'>-&GT;</span>pronamespace <span class='Operator'>!= </span><a href="namespace.c.html#LN910"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * Consider only procs that are in the search path and are not in 
             * the temp namespace. 
             */ 
</span><a name="LN962"></a>            <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>nsp</span><span class='Delimiter'>; 
</span> 
            <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN962"><span class='Ref_To_Local'>nsp</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN940"><span class='Ref_To_Local'>procform</span></a><span class='Operator'>-&GT;</span>pronamespace <span class='Operator'>== </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN962"><span class='Ref_To_Local'>nsp</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>                    <a href="namespace.c.html#LN940"><span class='Ref_To_Local'>procform</span></a><span class='Operator'>-&GT;</span>pronamespace <span class='Operator'>!= </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>)</span> 
                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <a href="namespace.c.html#LN943"><span class='Ref_To_Local'>pathpos</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN962"><span class='Ref_To_Local'>nsp</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* proc is not in search path */ 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN902"><span class='Ref_to_Parameter'>argnames</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * Call uses named or mixed notation 
             * 
             * Named or mixed notation can match a variadic function only if 
             * expand_variadic is off; otherwise there is no way to match the 
             * presumed-nameless parameters expanded from the variadic array. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN940"><span class='Ref_To_Local'>procform</span></a><span class='Operator'>-&GT;</span>provariadic<span class='Parentheses'>) </span><span class='Operator'>&& </span><a href="namespace.c.html#LN903"><span class='Ref_to_Parameter'>expand_variadic</span></a><span class='Parentheses'>)</span> 
                <span class='Control'>continue</span><span class='Delimiter'>; 
</span>            <a href="namespace.c.html#LN946"><span class='Ref_To_Local'>va_elem_type</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>            <a href="namespace.c.html#LN944"><span class='Ref_To_Local'>variadic</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Check argument count. 
             */ 
</span>            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="namespace.c.html#LN902"><span class='Ref_to_Parameter'>nargs</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; </span><span class='Comment_Single_Line'>/* -1 not supported with argnames */ 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN941"><span class='Ref_To_Local'>pronargs</span></a> <span class='Operator'>&GT; </span><a href="namespace.c.html#LN902"><span class='Ref_to_Parameter'>nargs</span></a> <span class='Operator'>&& </span><a href="namespace.c.html#LN903"><span class='Ref_to_Parameter'>expand_defaults</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Ignore if not enough default expressions */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN902"><span class='Ref_to_Parameter'>nargs</span></a> <span class='Operator'>+ </span><a href="namespace.c.html#LN940"><span class='Ref_To_Local'>procform</span></a><span class='Operator'>-&GT;</span>pronargdefaults <span class='Operator'>&LT; </span><a href="namespace.c.html#LN941"><span class='Ref_To_Local'>pronargs</span></a><span class='Parentheses'>) 
</span>                    <span class='Control'>continue</span><span class='Delimiter'>; 
</span>                <a href="namespace.c.html#LN945"><span class='Ref_To_Local'>use_defaults</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
                <a href="namespace.c.html#LN945"><span class='Ref_To_Local'>use_defaults</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Ignore if it doesn't match requested argument count */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN941"><span class='Ref_To_Local'>pronargs</span></a> <span class='Operator'>!= </span><a href="namespace.c.html#LN902"><span class='Ref_to_Parameter'>nargs</span></a> <span class='Operator'>&& !</span><a href="namespace.c.html#LN945"><span class='Ref_To_Local'>use_defaults</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Check for argument name match, generate positional mapping */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="namespace.c.html#LN199"><span class='Ref_to_Proto'>MatchNamedCall</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN939"><span class='Ref_To_Local'>proctup</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN902"><span class='Ref_to_Parameter'>nargs</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN902"><span class='Ref_to_Parameter'>argnames</span></a><span class='Delimiter'>, 
</span>                                <span class='Operator'>&</span><a href="namespace.c.html#LN947"><span class='Ref_To_Local'>argnumbers</span></a><span class='Parentheses'>))</span> 
                <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Named argument matching is always "special" */ 
</span>            <a href="namespace.c.html#LN907"><span class='Ref_To_Local'>any_special</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if argnames!=NIL &raquo; </span> 
        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * Call uses positional notation 
             * 
             * Check if function is variadic, and get variadic element type if 
             * so.  If expand_variadic is false, we should just ignore 
             * variadic-ness. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN941"><span class='Ref_To_Local'>pronargs</span></a> <span class='Operator'>&LT;= </span><a href="namespace.c.html#LN902"><span class='Ref_to_Parameter'>nargs</span></a> <span class='Operator'>&& </span><a href="namespace.c.html#LN903"><span class='Ref_to_Parameter'>expand_variadic</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="namespace.c.html#LN946"><span class='Ref_To_Local'>va_elem_type</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN940"><span class='Ref_To_Local'>procform</span></a><span class='Operator'>-&GT;</span>provariadic<span class='Delimiter'>; 
</span>                <a href="namespace.c.html#LN944"><span class='Ref_To_Local'>variadic</span></a> <span class='Operator'>= </span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN946"><span class='Ref_To_Local'>va_elem_type</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="namespace.c.html#LN907"><span class='Ref_To_Local'>any_special</span></a> <span class='Operator'>|= </span><a href="namespace.c.html#LN944"><span class='Ref_To_Local'>variadic</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <a href="namespace.c.html#LN946"><span class='Ref_To_Local'>va_elem_type</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>                <a href="namespace.c.html#LN944"><span class='Ref_To_Local'>variadic</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Check if function can match by using parameter defaults. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN941"><span class='Ref_To_Local'>pronargs</span></a> <span class='Operator'>&GT; </span><a href="namespace.c.html#LN902"><span class='Ref_to_Parameter'>nargs</span></a> <span class='Operator'>&& </span><a href="namespace.c.html#LN903"><span class='Ref_to_Parameter'>expand_defaults</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Ignore if not enough default expressions */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN902"><span class='Ref_to_Parameter'>nargs</span></a> <span class='Operator'>+ </span><a href="namespace.c.html#LN940"><span class='Ref_To_Local'>procform</span></a><span class='Operator'>-&GT;</span>pronargdefaults <span class='Operator'>&LT; </span><a href="namespace.c.html#LN941"><span class='Ref_To_Local'>pronargs</span></a><span class='Parentheses'>) 
</span>                    <span class='Control'>continue</span><span class='Delimiter'>; 
</span>                <a href="namespace.c.html#LN945"><span class='Ref_To_Local'>use_defaults</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="namespace.c.html#LN907"><span class='Ref_To_Local'>any_special</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
                <a href="namespace.c.html#LN945"><span class='Ref_To_Local'>use_defaults</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Ignore if it doesn't match requested argument count */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN902"><span class='Ref_to_Parameter'>nargs</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="namespace.c.html#LN941"><span class='Ref_To_Local'>pronargs</span></a> <span class='Operator'>!= </span><a href="namespace.c.html#LN902"><span class='Ref_to_Parameter'>nargs</span></a> <span class='Operator'>&& !</span><a href="namespace.c.html#LN944"><span class='Ref_To_Local'>variadic</span></a> <span class='Operator'>&& !</span><a href="namespace.c.html#LN945"><span class='Ref_To_Local'>use_defaults</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
        <span class='Comment_Multi_Line'>/* 
         * We must compute the effective argument list so that we can easily 
         * compare it to earlier results.  We waste a palloc cycle if it gets 
         * masked by an earlier result, but really that's a pretty infrequent 
         * case so it's not worth worrying about. 
         */ 
</span>        <a href="namespace.c.html#LN942"><span class='Ref_To_Local'>effective_nargs</span></a> <span class='Operator'>= </span><a href="../../interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN941"><span class='Ref_To_Local'>pronargs</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN902"><span class='Ref_to_Parameter'>nargs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN948"><span class='Ref_To_Local'>newResult</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN27"><span class='Ref_to_Typedef'>FuncCandidateList</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="../../include/c.h.html#LN554"><span class='Ref_to_Macro'>offsetof</span></a><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="../../include/catalog/namespace.h.html#LN27"><span class='Ref_to_Struct'>_FuncCandidateList</span></a><span class='Delimiter'>, </span><a href="../../pl/plperl/ppport.h.html#LN4358"><span class='Ref_to_Global_Var'>args</span></a><span class='Parentheses'>) </span><span class='Operator'>+ 
</span>                   <a href="namespace.c.html#LN942"><span class='Ref_To_Local'>effective_nargs</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN948"><span class='Ref_To_Local'>newResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN30"><span class='Ref_to_Member'>pathpos</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN943"><span class='Ref_To_Local'>pathpos</span></a><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN948"><span class='Ref_To_Local'>newResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN31"><span class='Ref_to_Member'>oid</span></a> <span class='Operator'>= </span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN939"><span class='Ref_To_Local'>proctup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN948"><span class='Ref_To_Local'>newResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN32"><span class='Ref_to_Member'>nargs</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN942"><span class='Ref_To_Local'>effective_nargs</span></a><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN948"><span class='Ref_To_Local'>newResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN35"><span class='Ref_to_Member'>argnumbers</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN947"><span class='Ref_To_Local'>argnumbers</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN947"><span class='Ref_To_Local'>argnumbers</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Re-order the argument types into call's logical order */ 
</span><a name="LN1073"></a>            <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>proargtypes</span> <span class='Operator'>= </span><a href="namespace.c.html#LN940"><span class='Ref_To_Local'>procform</span></a><span class='Operator'>-&GT;</span>proargtypes<span class='Operator'>.</span>values<span class='Delimiter'>; 
</span><a name="LN1074"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1074"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="namespace.c.html#LN1074"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="namespace.c.html#LN941"><span class='Ref_To_Local'>pronargs</span></a><span class='Delimiter'>; </span><a href="namespace.c.html#LN1074"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>                <a href="namespace.c.html#LN948"><span class='Ref_To_Local'>newResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN36"><span class='Ref_to_Member'>args</span></a><span class='Delimiter'>[</span><a href="namespace.c.html#LN1074"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="namespace.c.html#LN1073"><span class='Ref_To_Local'>proargtypes</span></a><span class='Delimiter'>[</span><a href="namespace.c.html#LN947"><span class='Ref_To_Local'>argnumbers</span></a><span class='Delimiter'>[</span><a href="namespace.c.html#LN1074"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]]; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Simple positional case, just copy proargtypes as-is */ 
</span>            memcpy<span class='Parentheses'>(</span><a href="namespace.c.html#LN948"><span class='Ref_To_Local'>newResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN36"><span class='Ref_to_Member'>args</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN940"><span class='Ref_To_Local'>procform</span></a><span class='Operator'>-&GT;</span>proargtypes<span class='Operator'>.</span>values<span class='Delimiter'>, 
</span>                   <a href="namespace.c.html#LN941"><span class='Ref_To_Local'>pronargs</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN944"><span class='Ref_To_Local'>variadic</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN1087"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
            <a href="namespace.c.html#LN948"><span class='Ref_To_Local'>newResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN33"><span class='Ref_to_Member'>nvargs</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN942"><span class='Ref_To_Local'>effective_nargs</span></a> <span class='Operator'>- </span><a href="namespace.c.html#LN941"><span class='Ref_To_Local'>pronargs</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* Expand variadic argument into N copies of element type */ 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1087"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN941"><span class='Ref_To_Local'>pronargs</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; </span><a href="namespace.c.html#LN1087"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="namespace.c.html#LN942"><span class='Ref_To_Local'>effective_nargs</span></a><span class='Delimiter'>; </span><a href="namespace.c.html#LN1087"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>                <a href="namespace.c.html#LN948"><span class='Ref_To_Local'>newResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN36"><span class='Ref_to_Member'>args</span></a><span class='Delimiter'>[</span><a href="namespace.c.html#LN1087"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="namespace.c.html#LN946"><span class='Ref_To_Local'>va_elem_type</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
            <a href="namespace.c.html#LN948"><span class='Ref_To_Local'>newResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN33"><span class='Ref_to_Member'>nvargs</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN948"><span class='Ref_To_Local'>newResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN34"><span class='Ref_to_Member'>ndargs</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN945"><span class='Ref_To_Local'>use_defaults</span></a> <span class='Operator'>? </span><a href="namespace.c.html#LN941"><span class='Ref_To_Local'>pronargs</span></a> <span class='Operator'>- </span><a href="namespace.c.html#LN902"><span class='Ref_to_Parameter'>nargs</span></a> <span class='Operator'>: </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Does it have the same arguments as something we already accepted? 
         * If so, decide what to do to avoid returning duplicate argument 
         * lists.  We can skip this check for the single-namespace case if no 
         * special (named, variadic or defaults) match has been made, since 
         * then the unique index on pg_proc guarantees all the matches have 
         * different argument lists. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN906"><span class='Ref_To_Local'>resultList</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& 
</span>            <span class='Parentheses'>(</span><a href="namespace.c.html#LN907"><span class='Ref_To_Local'>any_special</span></a> <span class='Operator'>|| !</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN910"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>)))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * If we have an ordered list from SearchSysCacheList (the normal 
             * case), then any conflicting proc must immediately adjoin this 
             * one in the list, so we only need to look at the newest result 
             * item.  If we have an unordered list, we have to scan the whole 
             * result list.  Also, if either the current candidate or any 
             * previous candidate is a special match, we can't assume that 
             * conflicts are adjacent. 
             * 
             * We ignore defaulted arguments in deciding what is a match. 
             */ 
</span><a name="LN1120"></a>            <a href="../../include/catalog/namespace.h.html#LN27"><span class='Ref_to_Typedef'>FuncCandidateList</span></a> <span class='Declare_Local'>prevResult</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN911"><span class='Ref_To_Local'>catlist</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/catcache.h.html#LN149"><span class='Ref_to_Member'>ordered</span></a> <span class='Operator'>&& !</span><a href="namespace.c.html#LN907"><span class='Ref_To_Local'>any_special</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* ndargs must be 0 if !any_special */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN942"><span class='Ref_To_Local'>effective_nargs</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN906"><span class='Ref_To_Local'>resultList</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN32"><span class='Ref_to_Member'>nargs</span></a> <span class='Operator'>&& 
</span>                    memcmp<span class='Parentheses'>(</span><a href="namespace.c.html#LN948"><span class='Ref_To_Local'>newResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN36"><span class='Ref_to_Member'>args</span></a><span class='Delimiter'>, 
</span>                           <a href="namespace.c.html#LN906"><span class='Ref_To_Local'>resultList</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN36"><span class='Ref_to_Member'>args</span></a><span class='Delimiter'>, 
</span>                           <a href="namespace.c.html#LN942"><span class='Ref_To_Local'>effective_nargs</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                    <a href="namespace.c.html#LN1120"><span class='Ref_To_Local'>prevResult</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN906"><span class='Ref_To_Local'>resultList</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>else</span> 
                    <a href="namespace.c.html#LN1120"><span class='Ref_To_Local'>prevResult</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span><a name="LN1135"></a>                <span class='Keyword'>int</span>         <span class='Declare_Local'>cmp_nargs</span> <span class='Operator'>= </span><a href="namespace.c.html#LN948"><span class='Ref_To_Local'>newResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN32"><span class='Ref_to_Member'>nargs</span></a> <span class='Operator'>- </span><a href="namespace.c.html#LN948"><span class='Ref_To_Local'>newResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN34"><span class='Ref_to_Member'>ndargs</span></a><span class='Delimiter'>; 
</span> 
                <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1120"><span class='Ref_To_Local'>prevResult</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN906"><span class='Ref_To_Local'>resultList</span></a><span class='Delimiter'>; 
</span>                     <a href="namespace.c.html#LN1120"><span class='Ref_To_Local'>prevResult</span></a><span class='Delimiter'>; 
</span>                     <a href="namespace.c.html#LN1120"><span class='Ref_To_Local'>prevResult</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN1120"><span class='Ref_To_Local'>prevResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN29"><span class='Ref_to_Member'>next</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1135"><span class='Ref_To_Local'>cmp_nargs</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN1120"><span class='Ref_To_Local'>prevResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN32"><span class='Ref_to_Member'>nargs</span></a> <span class='Operator'>- </span><a href="namespace.c.html#LN1120"><span class='Ref_To_Local'>prevResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN34"><span class='Ref_to_Member'>ndargs</span></a> <span class='Operator'>&& 
</span>                        memcmp<span class='Parentheses'>(</span><a href="namespace.c.html#LN948"><span class='Ref_To_Local'>newResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN36"><span class='Ref_to_Member'>args</span></a><span class='Delimiter'>, 
</span>                               <a href="namespace.c.html#LN1120"><span class='Ref_To_Local'>prevResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN36"><span class='Ref_to_Member'>args</span></a><span class='Delimiter'>, 
</span>                               <a href="namespace.c.html#LN1135"><span class='Ref_To_Local'>cmp_nargs</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                        <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1120"><span class='Ref_To_Local'>prevResult</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* 
                 * We have a match with a previous result.  Decide which one 
                 * to keep, or mark it ambiguous if we can't decide.  The 
                 * logic here is preference &GT; 0 means prefer the old result, 
                 * preference &LT; 0 means prefer the new, preference = 0 means 
                 * ambiguous. 
                 */ 
</span><a name="LN1158"></a>                <span class='Keyword'>int</span>         <span class='Declare_Local'>preference</span><span class='Delimiter'>; 
</span> 
                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN943"><span class='Ref_To_Local'>pathpos</span></a> <span class='Operator'>!= </span><a href="namespace.c.html#LN1120"><span class='Ref_To_Local'>prevResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN30"><span class='Ref_to_Member'>pathpos</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Comment_Multi_Line'>/* 
                     * Prefer the one that's earlier in the search path. 
                     */ 
</span>                    <a href="namespace.c.html#LN1158"><span class='Ref_To_Local'>preference</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN943"><span class='Ref_To_Local'>pathpos</span></a> <span class='Operator'>- </span><a href="namespace.c.html#LN1120"><span class='Ref_To_Local'>prevResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN30"><span class='Ref_to_Member'>pathpos</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN944"><span class='Ref_To_Local'>variadic</span></a> <span class='Operator'>&& </span><a href="namespace.c.html#LN1120"><span class='Ref_To_Local'>prevResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN33"><span class='Ref_to_Member'>nvargs</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Comment_Multi_Line'>/* 
                     * With variadic functions we could have, for example, 
                     * both foo(numeric) and foo(variadic numeric[]) in the 
                     * same namespace; if so we prefer the non-variadic match 
                     * on efficiency grounds. 
                     */ 
</span>                    <a href="namespace.c.html#LN1158"><span class='Ref_To_Local'>preference</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="namespace.c.html#LN944"><span class='Ref_To_Local'>variadic</span></a> <span class='Operator'>&& </span><a href="namespace.c.html#LN1120"><span class='Ref_To_Local'>prevResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN33"><span class='Ref_to_Member'>nvargs</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <a href="namespace.c.html#LN1158"><span class='Ref_To_Local'>preference</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                <span class='Delimiter'>{ 
</span>                    <span class='Comment_Multi_Line'>/*---------- 
                     * We can't decide.  This can happen with, for example, 
                     * both foo(numeric, variadic numeric[]) and 
                     * foo(variadic numeric[]) in the same namespace, or 
                     * both foo(int) and foo (int, int default something) 
                     * in the same namespace, or both foo(a int, b text) 
                     * and foo(b text, a int) in the same namespace. 
                     *---------- 
                     */ 
</span>                    <a href="namespace.c.html#LN1158"><span class='Ref_To_Local'>preference</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span> 
                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1158"><span class='Ref_To_Local'>preference</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Comment_Multi_Line'>/* keep previous result */ 
</span>                    <a href="../../include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN948"><span class='Ref_To_Local'>newResult</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>continue</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1158"><span class='Ref_To_Local'>preference</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Comment_Multi_Line'>/* remove previous result from the list */ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1120"><span class='Ref_To_Local'>prevResult</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN906"><span class='Ref_To_Local'>resultList</span></a><span class='Parentheses'>) 
</span>                        <a href="namespace.c.html#LN906"><span class='Ref_To_Local'>resultList</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN1120"><span class='Ref_To_Local'>prevResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN29"><span class='Ref_to_Member'>next</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>else</span> 
                    <span class='Delimiter'>{ 
</span><a name="LN1208"></a>                        <a href="../../include/catalog/namespace.h.html#LN27"><span class='Ref_to_Typedef'>FuncCandidateList</span></a> <span class='Declare_Local'>prevPrevResult</span><span class='Delimiter'>; 
</span> 
                        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1208"><span class='Ref_To_Local'>prevPrevResult</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN906"><span class='Ref_To_Local'>resultList</span></a><span class='Delimiter'>; 
</span>                             <a href="namespace.c.html#LN1208"><span class='Ref_To_Local'>prevPrevResult</span></a><span class='Delimiter'>; 
</span>                             <a href="namespace.c.html#LN1208"><span class='Ref_To_Local'>prevPrevResult</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN1208"><span class='Ref_To_Local'>prevPrevResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN29"><span class='Ref_to_Member'>next</span></a><span class='Parentheses'>) 
</span>                        <span class='Delimiter'>{ 
</span>                            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1120"><span class='Ref_To_Local'>prevResult</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN1208"><span class='Ref_To_Local'>prevPrevResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN29"><span class='Ref_to_Member'>next</span></a><span class='Parentheses'>) 
</span>                            <span class='Delimiter'>{ 
</span>                                <a href="namespace.c.html#LN1208"><span class='Ref_To_Local'>prevPrevResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN29"><span class='Ref_to_Member'>next</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN1120"><span class='Ref_To_Local'>prevResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN29"><span class='Ref_to_Member'>next</span></a><span class='Delimiter'>; 
</span>                                <span class='Control'>break</span><span class='Delimiter'>; 
</span>                            <span class='Delimiter'>} 
</span>                        <span class='Delimiter'>} 
</span>                        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="namespace.c.html#LN1208"><span class='Ref_To_Local'>prevPrevResult</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><span class='Comment_Single_Line'>/* assert we found it */ 
</span>                    <span class='Delimiter'>} 
</span>                    <a href="../../include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1120"><span class='Ref_To_Local'>prevResult</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* fall through to add newResult to list */ 
</span>                <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if preference&LT;0 &raquo; </span> 
                <span class='Control'>else</span> 
                <span class='Delimiter'>{ 
</span>                    <span class='Comment_Multi_Line'>/* mark old result as ambiguous, discard new */ 
</span>                    <a href="namespace.c.html#LN1120"><span class='Ref_To_Local'>prevResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN31"><span class='Ref_to_Member'>oid</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>                    <a href="../../include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN948"><span class='Ref_To_Local'>newResult</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>continue</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if prevResult &raquo; </span> 
        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if resultList!=NULL&&(an... &raquo; </span> 
 
        <span class='Comment_Multi_Line'>/* 
         * Okay to add it to result list 
         */ 
</span>        <a href="namespace.c.html#LN948"><span class='Ref_To_Local'>newResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN29"><span class='Ref_to_Member'>next</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN906"><span class='Ref_To_Local'>resultList</span></a><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN906"><span class='Ref_To_Local'>resultList</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN948"><span class='Ref_To_Local'>newResult</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=0;i&LT;catlist-&GT;n_memb... &raquo; </span> 
 
    <a href="../../include/utils/syscache.h.html#LN209"><span class='Ref_to_Macro'>ReleaseSysCacheList</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN911"><span class='Ref_To_Local'>catlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN906"><span class='Ref_To_Local'>resultList</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end FuncnameGetCandidates &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * MatchNamedCall 
 *      Given a pg_proc heap tuple and a call's list of argument names, 
 *      check whether the function could match the call. 
 * 
 * The call could match if all supplied argument names are accepted by 
 * the function, in positions after the last positional argument, and there 
 * are defaults for all unsupplied arguments. 
 * 
 * The number of positional arguments is nargs - list_length(argnames). 
 * Note caller has already done basic checks on argument count. 
 * 
 * On match, return true and fill *argnumbers with a palloc'd array showing 
 * the mapping from call argument positions to actual function argument 
 * numbers.  Defaulted arguments are included in this map, at positions 
 * after the last supplied argument. 
 */ 
</span><span class='Keyword'>static bool 
</span><a name="LN1265"></a><span class='Declare_Function'>MatchNamedCall</span><span class='Parentheses'>(</span><a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a> <span class='Declare_Parameter'>proctup</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>nargs</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>argnames</span><span class='Delimiter'>, 
</span><a name="LN1266"></a>               <span class='Keyword'>int </span><span class='Operator'>**</span><span class='Declare_Parameter'>argnumbers</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1268"></a>    <a href="../../include/catalog/pg_proc.h.html#LN82"><span class='Ref_to_Typedef'>Form_pg_proc</span></a> <span class='Declare_Local'>procform</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_proc.h.html#LN82"><span class='Ref_to_Typedef'>Form_pg_proc</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1265"><span class='Ref_to_Parameter'>proctup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1269"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>pronargs</span> <span class='Operator'>= </span><a href="namespace.c.html#LN1268"><span class='Ref_To_Local'>procform</span></a><span class='Operator'>-&GT;</span>pronargs<span class='Delimiter'>; 
</span><a name="LN1270"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>numposargs</span> <span class='Operator'>= </span><a href="namespace.c.html#LN1265"><span class='Ref_to_Parameter'>nargs</span></a> <span class='Operator'>- </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1265"><span class='Ref_to_Parameter'>argnames</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1271"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>pronallargs</span><span class='Delimiter'>; 
</span><a name="LN1272"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>p_argtypes</span><span class='Delimiter'>; 
</span><a name="LN1273"></a>    <span class='Keyword'>char</span>      <span class='Operator'>**</span><span class='Declare_Local'>p_argnames</span><span class='Delimiter'>; 
</span><a name="LN1274"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>p_argmodes</span><span class='Delimiter'>; 
</span><a name="LN1275"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>arggiven</span><span class='Delimiter'>[</span><a href="../../include/pg_config_manual.h.html#LN36"><span class='Ref_to_Const'>FUNC_MAX_ARGS</span></a><span class='Delimiter'>]; 
</span><a name="LN1276"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>isnull</span><span class='Delimiter'>; 
</span><a name="LN1277"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>ap</span><span class='Delimiter'>;</span>             <span class='Comment_Single_Line'>/* call args position */ 
</span><a name="LN1278"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>pp</span><span class='Delimiter'>;</span>             <span class='Comment_Single_Line'>/* proargs position */ 
</span><a name="LN1279"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="namespace.c.html#LN1265"><span class='Ref_to_Parameter'>argnames</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="namespace.c.html#LN1270"><span class='Ref_To_Local'>numposargs</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="namespace.c.html#LN1265"><span class='Ref_to_Parameter'>nargs</span></a> <span class='Operator'>&LT;= </span><a href="namespace.c.html#LN1269"><span class='Ref_To_Local'>pronargs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Ignore this function if its proargnames is null */ 
</span>    <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="../../include/utils/syscache.h.html#LN133"><span class='Ref_to_Proto'>SysCacheGetAttr</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN76"><span class='Ref_to_EnumConst'>PROCOID</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN1265"><span class='Ref_to_Parameter'>proctup</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/pg_proc.h.html#LN111"><span class='Ref_to_Const'>Anum_pg_proc_proargnames</span></a><span class='Delimiter'>, 
</span>                           <span class='Operator'>&</span><a href="namespace.c.html#LN1276"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1276"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* OK, let's extract the argument names and types */ 
</span>    <a href="namespace.c.html#LN1271"><span class='Ref_To_Local'>pronallargs</span></a> <span class='Operator'>= </span><a href="../../include/funcapi.h.html#LN171"><span class='Ref_to_Proto'>get_func_arg_info</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1265"><span class='Ref_to_Parameter'>proctup</span></a><span class='Delimiter'>, 
</span>                                    <span class='Operator'>&</span><a href="namespace.c.html#LN1272"><span class='Ref_To_Local'>p_argtypes</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="namespace.c.html#LN1273"><span class='Ref_To_Local'>p_argnames</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="namespace.c.html#LN1274"><span class='Ref_To_Local'>p_argmodes</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="namespace.c.html#LN1273"><span class='Ref_To_Local'>p_argnames</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* initialize state for matching */ 
</span>    <span class='Operator'>*</span><a href="namespace.c.html#LN1266"><span class='Ref_to_Parameter'>argnumbers</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1269"><span class='Ref_To_Local'>pronargs</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    memset<span class='Parentheses'>(</span><a href="namespace.c.html#LN1275"><span class='Ref_To_Local'>arggiven</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><a href="namespace.c.html#LN1269"><span class='Ref_To_Local'>pronargs</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Keyword'>bool</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* there are numposargs positional args before the named args */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1277"><span class='Ref_To_Local'>ap</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="namespace.c.html#LN1277"><span class='Ref_To_Local'>ap</span></a> <span class='Operator'>&LT; </span><a href="namespace.c.html#LN1270"><span class='Ref_To_Local'>numposargs</span></a><span class='Delimiter'>; </span><a href="namespace.c.html#LN1277"><span class='Ref_To_Local'>ap</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="namespace.c.html#LN1266"><span class='Ref_to_Parameter'>argnumbers</span></a><span class='Parentheses'>)</span><span class='Delimiter'>[</span><a href="namespace.c.html#LN1277"><span class='Ref_To_Local'>ap</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="namespace.c.html#LN1277"><span class='Ref_To_Local'>ap</span></a><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN1275"><span class='Ref_To_Local'>arggiven</span></a><span class='Delimiter'>[</span><a href="namespace.c.html#LN1277"><span class='Ref_To_Local'>ap</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* now examine the named args */ 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1279"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN1265"><span class='Ref_to_Parameter'>argnames</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1310"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>argname</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1279"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1311"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>found</span><span class='Delimiter'>; 
</span><a name="LN1312"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
        <a href="namespace.c.html#LN1278"><span class='Ref_To_Local'>pp</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN1311"><span class='Ref_To_Local'>found</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1312"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="namespace.c.html#LN1312"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="namespace.c.html#LN1271"><span class='Ref_To_Local'>pronallargs</span></a><span class='Delimiter'>; </span><a href="namespace.c.html#LN1312"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* consider only input parameters */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1274"><span class='Ref_To_Local'>p_argmodes</span></a> <span class='Operator'>&& 
</span>                <span class='Parentheses'>(</span><a href="namespace.c.html#LN1274"><span class='Ref_To_Local'>p_argmodes</span></a><span class='Delimiter'>[</span><a href="namespace.c.html#LN1312"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>!= </span><a href="../../include/nodes/parsenodes.h.html#LN2723"><span class='Ref_to_EnumConst'>FUNC_PARAM_IN</span></a> <span class='Operator'>&& 
</span>                 <a href="namespace.c.html#LN1274"><span class='Ref_To_Local'>p_argmodes</span></a><span class='Delimiter'>[</span><a href="namespace.c.html#LN1312"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>!= </span><a href="../../include/nodes/parsenodes.h.html#LN2725"><span class='Ref_to_EnumConst'>FUNC_PARAM_INOUT</span></a> <span class='Operator'>&& 
</span>                 <a href="namespace.c.html#LN1274"><span class='Ref_To_Local'>p_argmodes</span></a><span class='Delimiter'>[</span><a href="namespace.c.html#LN1312"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>!= </span><a href="../../include/nodes/parsenodes.h.html#LN2726"><span class='Ref_to_EnumConst'>FUNC_PARAM_VARIADIC</span></a><span class='Parentheses'>))</span> 
                <span class='Control'>continue</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1273"><span class='Ref_To_Local'>p_argnames</span></a><span class='Delimiter'>[</span><a href="namespace.c.html#LN1312"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>&& </span>strcmp<span class='Parentheses'>(</span><a href="namespace.c.html#LN1273"><span class='Ref_To_Local'>p_argnames</span></a><span class='Delimiter'>[</span><a href="namespace.c.html#LN1312"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>], </span><a href="namespace.c.html#LN1310"><span class='Ref_To_Local'>argname</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* fail if argname matches a positional argument */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1275"><span class='Ref_To_Local'>arggiven</span></a><span class='Delimiter'>[</span><a href="namespace.c.html#LN1278"><span class='Ref_To_Local'>pp</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>                    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                <a href="namespace.c.html#LN1275"><span class='Ref_To_Local'>arggiven</span></a><span class='Delimiter'>[</span><a href="namespace.c.html#LN1278"><span class='Ref_To_Local'>pp</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="namespace.c.html#LN1266"><span class='Ref_to_Parameter'>argnumbers</span></a><span class='Parentheses'>)</span><span class='Delimiter'>[</span><a href="namespace.c.html#LN1277"><span class='Ref_To_Local'>ap</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="namespace.c.html#LN1278"><span class='Ref_To_Local'>pp</span></a><span class='Delimiter'>; 
</span>                <a href="namespace.c.html#LN1311"><span class='Ref_To_Local'>found</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Comment_Multi_Line'>/* increase pp only for input parameters */ 
</span>            <a href="namespace.c.html#LN1278"><span class='Ref_To_Local'>pp</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=0;i&LT;pronallargs;i++ &raquo; </span> 
        <span class='Comment_Multi_Line'>/* if name isn't in proargnames, fail */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="namespace.c.html#LN1311"><span class='Ref_To_Local'>found</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN1277"><span class='Ref_To_Local'>ap</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="namespace.c.html#LN1277"><span class='Ref_To_Local'>ap</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN1265"><span class='Ref_to_Parameter'>nargs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* processed all actual parameters */ 
</span> 
    <span class='Comment_Multi_Line'>/* Check for default arguments */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1265"><span class='Ref_to_Parameter'>nargs</span></a> <span class='Operator'>&LT; </span><a href="namespace.c.html#LN1269"><span class='Ref_To_Local'>pronargs</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1348"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>first_arg_with_default</span> <span class='Operator'>= </span><a href="namespace.c.html#LN1269"><span class='Ref_To_Local'>pronargs</span></a> <span class='Operator'>- </span><a href="namespace.c.html#LN1268"><span class='Ref_To_Local'>procform</span></a><span class='Operator'>-&GT;</span>pronargdefaults<span class='Delimiter'>; 
</span> 
        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1278"><span class='Ref_To_Local'>pp</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN1270"><span class='Ref_To_Local'>numposargs</span></a><span class='Delimiter'>; </span><a href="namespace.c.html#LN1278"><span class='Ref_To_Local'>pp</span></a> <span class='Operator'>&LT; </span><a href="namespace.c.html#LN1269"><span class='Ref_To_Local'>pronargs</span></a><span class='Delimiter'>; </span><a href="namespace.c.html#LN1278"><span class='Ref_To_Local'>pp</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1275"><span class='Ref_To_Local'>arggiven</span></a><span class='Delimiter'>[</span><a href="namespace.c.html#LN1278"><span class='Ref_To_Local'>pp</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* fail if arg not given and no default available */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1278"><span class='Ref_To_Local'>pp</span></a> <span class='Operator'>&LT; </span><a href="namespace.c.html#LN1348"><span class='Ref_To_Local'>first_arg_with_default</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="namespace.c.html#LN1266"><span class='Ref_to_Parameter'>argnumbers</span></a><span class='Parentheses'>)</span><span class='Delimiter'>[</span><a href="namespace.c.html#LN1277"><span class='Ref_To_Local'>ap</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="namespace.c.html#LN1278"><span class='Ref_To_Local'>pp</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="namespace.c.html#LN1277"><span class='Ref_To_Local'>ap</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN1269"><span class='Ref_To_Local'>pronargs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* processed all function parameters */ 
</span> 
    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end MatchNamedCall &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * FunctionIsVisible 
 *      Determine whether a function (identified by OID) is visible in the 
 *      current search path.  Visible means "would be found by searching 
 *      for the unqualified function name with exact argument matches". 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN1373"></a><span class='Declare_Function'>FunctionIsVisible</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>funcid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1375"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>proctup</span><span class='Delimiter'>; 
</span><a name="LN1376"></a>    <a href="../../include/catalog/pg_proc.h.html#LN82"><span class='Ref_to_Typedef'>Form_pg_proc</span></a> <span class='Declare_Local'>procform</span><span class='Delimiter'>; 
</span><a name="LN1377"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>pronamespace</span><span class='Delimiter'>; 
</span><a name="LN1378"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>visible</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN1375"><span class='Ref_To_Local'>proctup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN76"><span class='Ref_to_EnumConst'>PROCOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1373"><span class='Ref_to_Parameter'>funcid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1375"><span class='Ref_To_Local'>proctup</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for function %u"</span><span class='Delimiter'>, </span><a href="namespace.c.html#LN1373"><span class='Ref_to_Parameter'>funcid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN1376"><span class='Ref_To_Local'>procform</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_proc.h.html#LN82"><span class='Ref_to_Typedef'>Form_pg_proc</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1375"><span class='Ref_To_Local'>proctup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Quick check: if it ain't in the path at all, it ain't visible. Items in 
     * the system namespace are surely in the path and so we needn't even do 
     * list_member_oid() for them. 
     */ 
</span>    <a href="namespace.c.html#LN1377"><span class='Ref_To_Local'>pronamespace</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN1376"><span class='Ref_To_Local'>procform</span></a><span class='Operator'>-&GT;</span>pronamespace<span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1377"><span class='Ref_To_Local'>pronamespace</span></a> <span class='Operator'>!= </span><a href="../../include/catalog/pg_namespace.h.html#LN70"><span class='Ref_to_Const'>PG_CATALOG_NAMESPACE</span></a> <span class='Operator'>&& 
</span>        <span class='Operator'>!</span><a href="../../include/nodes/pg_list.h.html#LN231"><span class='Ref_to_Proto'>list_member_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN1377"><span class='Ref_To_Local'>pronamespace</span></a><span class='Parentheses'>))</span> 
        <a href="namespace.c.html#LN1378"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * If it is in the path, it might still not be visible; it could be 
         * hidden by another proc of the same name and arguments earlier in 
         * the path.  So we must do a slow check to see if this is the same 
         * proc that would be found by FuncnameGetCandidates. 
         */ 
</span><a name="LN1404"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>proname</span> <span class='Operator'>= </span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1376"><span class='Ref_To_Local'>procform</span></a><span class='Operator'>-&GT;</span>proname<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1405"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>nargs</span> <span class='Operator'>= </span><a href="namespace.c.html#LN1376"><span class='Ref_To_Local'>procform</span></a><span class='Operator'>-&GT;</span>pronargs<span class='Delimiter'>; 
</span><a name="LN1406"></a>        <a href="../../include/catalog/namespace.h.html#LN27"><span class='Ref_to_Typedef'>FuncCandidateList</span></a> <span class='Declare_Local'>clist</span><span class='Delimiter'>; 
</span> 
        <a href="namespace.c.html#LN1378"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
        <a href="namespace.c.html#LN1406"><span class='Ref_To_Local'>clist</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN70"><span class='Ref_to_Proto'>FuncnameGetCandidates</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN138"><span class='Ref_to_Macro'>list_make1</span></a><span class='Parentheses'>(</span><a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1404"><span class='Ref_To_Local'>proname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, 
</span>                                      <a href="namespace.c.html#LN1405"><span class='Ref_To_Local'>nargs</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>; </span><a href="namespace.c.html#LN1406"><span class='Ref_To_Local'>clist</span></a><span class='Delimiter'>; </span><a href="namespace.c.html#LN1406"><span class='Ref_To_Local'>clist</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN1406"><span class='Ref_To_Local'>clist</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN29"><span class='Ref_to_Member'>next</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span>memcmp<span class='Parentheses'>(</span><a href="namespace.c.html#LN1406"><span class='Ref_To_Local'>clist</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN36"><span class='Ref_to_Member'>args</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN1376"><span class='Ref_To_Local'>procform</span></a><span class='Operator'>-&GT;</span>proargtypes<span class='Operator'>.</span>values<span class='Delimiter'>, 
</span>                       <a href="namespace.c.html#LN1405"><span class='Ref_To_Local'>nargs</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Found the expected entry; is it the right proc? */ 
</span>                <a href="namespace.c.html#LN1378"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="namespace.c.html#LN1406"><span class='Ref_To_Local'>clist</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN31"><span class='Ref_to_Member'>oid</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN1373"><span class='Ref_to_Parameter'>funcid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1375"><span class='Ref_To_Local'>proctup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN1378"><span class='Ref_To_Local'>visible</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end FunctionIsVisible &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * OpernameGetOprid 
 *      Given a possibly-qualified operator name and exact input datatypes, 
 *      look up the operator.  Returns InvalidOid if not found. 
 * 
 * Pass oprleft = InvalidOid for a prefix op, oprright = InvalidOid for 
 * a postfix op. 
 * 
 * If the operator name is not schema-qualified, it is sought in the current 
 * namespace search path.  If the name is schema-qualified and the given 
 * schema does not exist, InvalidOid is returned. 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN1444"></a><span class='Declare_Function'>OpernameGetOprid</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>names</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>oprleft</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>oprright</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1446"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>schemaname</span><span class='Delimiter'>; 
</span><a name="LN1447"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>opername</span><span class='Delimiter'>; 
</span><a name="LN1448"></a>    <a href="../../include/utils/catcache.h.html#LN119"><span class='Ref_to_Typedef'>CatCList</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>catlist</span><span class='Delimiter'>; 
</span><a name="LN1449"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* deconstruct the name list */ 
</span>    <a href="../../include/catalog/namespace.h.html#LN109"><span class='Ref_to_Proto'>DeconstructQualifiedName</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1444"><span class='Ref_to_Parameter'>names</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="namespace.c.html#LN1446"><span class='Ref_To_Local'>schemaname</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="namespace.c.html#LN1447"><span class='Ref_To_Local'>opername</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1446"><span class='Ref_To_Local'>schemaname</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* search only in exact schema given */ 
</span><a name="LN1457"></a>        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span><span class='Delimiter'>; 
</span> 
        <a href="namespace.c.html#LN1457"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN113"><span class='Ref_to_Proto'>LookupExplicitNamespace</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1446"><span class='Ref_To_Local'>schemaname</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1457"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN1462"></a>            <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>opertup</span><span class='Delimiter'>; 
</span> 
            <a href="namespace.c.html#LN1462"><span class='Ref_To_Local'>opertup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN161"><span class='Ref_to_Macro'>SearchSysCache4</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN70"><span class='Ref_to_EnumConst'>OPERNAMENSP</span></a><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN583"><span class='Ref_to_Macro'>CStringGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1447"><span class='Ref_To_Local'>opername</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1444"><span class='Ref_to_Parameter'>oprleft</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1444"><span class='Ref_to_Parameter'>oprright</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1457"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1462"><span class='Ref_To_Local'>opertup</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span><a name="LN1471"></a>                <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>result</span> <span class='Operator'>= </span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1462"><span class='Ref_To_Local'>opertup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1462"><span class='Ref_To_Local'>opertup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>return</span> <a href="namespace.c.html#LN1471"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if schemaname &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Search syscache by name and argument types */ 
</span>    <a href="namespace.c.html#LN1448"><span class='Ref_To_Local'>catlist</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN204"><span class='Ref_to_Macro'>SearchSysCacheList3</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN70"><span class='Ref_to_EnumConst'>OPERNAMENSP</span></a><span class='Delimiter'>, 
</span>                                  <a href="../../include/postgres.h.html#LN583"><span class='Ref_to_Macro'>CStringGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1447"><span class='Ref_To_Local'>opername</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                  <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1444"><span class='Ref_to_Parameter'>oprleft</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                  <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1444"><span class='Ref_to_Parameter'>oprright</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1448"><span class='Ref_To_Local'>catlist</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/catcache.h.html#LN153"><span class='Ref_to_Member'>n_members</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* no hope, fall out early */ 
</span>        <a href="../../include/utils/syscache.h.html#LN209"><span class='Ref_to_Macro'>ReleaseSysCacheList</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1448"><span class='Ref_To_Local'>catlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We have to find the list member that is first in the search path, if 
     * there's more than one.  This doubly-nested loop looks ugly, but in 
     * practice there should usually be few catlist members. 
     */ 
</span>    <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1449"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1503"></a>        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1449"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1504"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1503"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* do not look in temp namespace */ 
</span> 
        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1504"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="namespace.c.html#LN1504"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="namespace.c.html#LN1448"><span class='Ref_To_Local'>catlist</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/catcache.h.html#LN153"><span class='Ref_to_Member'>n_members</span></a><span class='Delimiter'>; </span><a href="namespace.c.html#LN1504"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN1511"></a>            <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>opertup</span> <span class='Operator'>= &</span><a href="namespace.c.html#LN1448"><span class='Ref_To_Local'>catlist</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/catcache.h.html#LN154"><span class='Ref_to_Member'>members</span></a><span class='Delimiter'>[</span><a href="namespace.c.html#LN1504"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span><a href="../../include/utils/catcache.h.html#LN115"><span class='Ref_to_Member'>tuple</span></a><span class='Delimiter'>; 
</span><a name="LN1512"></a>            <a href="../../include/catalog/pg_operator.h.html#LN56"><span class='Ref_to_Typedef'>Form_pg_operator</span></a> <span class='Declare_Local'>operform</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_operator.h.html#LN56"><span class='Ref_to_Typedef'>Form_pg_operator</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1511"><span class='Ref_To_Local'>opertup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1512"><span class='Ref_To_Local'>operform</span></a><span class='Operator'>-&GT;</span>oprnamespace <span class='Operator'>== </span><a href="namespace.c.html#LN1503"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN1516"></a>                <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>result</span> <span class='Operator'>= </span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1511"><span class='Ref_To_Local'>opertup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <a href="../../include/utils/syscache.h.html#LN209"><span class='Ref_to_Macro'>ReleaseSysCacheList</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1448"><span class='Ref_To_Local'>catlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>return</span> <a href="namespace.c.html#LN1516"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../include/utils/syscache.h.html#LN209"><span class='Ref_to_Macro'>ReleaseSysCacheList</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1448"><span class='Ref_To_Local'>catlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end OpernameGetOprid &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * OpernameGetCandidates 
 *      Given a possibly-qualified operator name and operator kind, 
 *      retrieve a list of the possible matches. 
 * 
 * If oprkind is '\0', we return all operators matching the given name, 
 * regardless of arguments. 
 * 
 * We search a single namespace if the operator name is qualified, else 
 * all namespaces in the search path.  The return list will never contain 
 * multiple entries with identical argument lists --- in the multiple- 
 * namespace case, we arrange for entries in earlier namespaces to mask 
 * identical entries in later namespaces. 
 * 
 * The returned items always have two args[] entries --- one or the other 
 * will be InvalidOid for a prefix or postfix oprkind.  nargs is 2, too. 
 */ 
</span><a href="../../include/catalog/namespace.h.html#LN27"><span class='Ref_to_Typedef'>FuncCandidateList</span></a> 
<a name="LN1546"></a><span class='Declare_Function'>OpernameGetCandidates</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>names</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Declare_Parameter'>oprkind</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>missing_schema_ok</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1548"></a>    <a href="../../include/catalog/namespace.h.html#LN27"><span class='Ref_to_Typedef'>FuncCandidateList</span></a> <span class='Declare_Local'>resultList</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN1549"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>resultSpace</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN1550"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>nextResult</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN1551"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>schemaname</span><span class='Delimiter'>; 
</span><a name="LN1552"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>opername</span><span class='Delimiter'>; 
</span><a name="LN1553"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span><span class='Delimiter'>; 
</span><a name="LN1554"></a>    <a href="../../include/utils/catcache.h.html#LN119"><span class='Ref_to_Typedef'>CatCList</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>catlist</span><span class='Delimiter'>; 
</span><a name="LN1555"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* deconstruct the name list */ 
</span>    <a href="../../include/catalog/namespace.h.html#LN109"><span class='Ref_to_Proto'>DeconstructQualifiedName</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1546"><span class='Ref_to_Parameter'>names</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="namespace.c.html#LN1551"><span class='Ref_To_Local'>schemaname</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="namespace.c.html#LN1552"><span class='Ref_To_Local'>opername</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1551"><span class='Ref_To_Local'>schemaname</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* use exact schema given */ 
</span>        <a href="namespace.c.html#LN1553"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN113"><span class='Ref_to_Proto'>LookupExplicitNamespace</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1551"><span class='Ref_To_Local'>schemaname</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN1546"><span class='Ref_to_Parameter'>missing_schema_ok</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1546"><span class='Ref_to_Parameter'>missing_schema_ok</span></a> <span class='Operator'>&& !</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1553"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* flag to indicate we need namespace search */ 
</span>        <a href="namespace.c.html#LN1553"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Search syscache by name only */ 
</span>    <a href="namespace.c.html#LN1554"><span class='Ref_To_Local'>catlist</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN200"><span class='Ref_to_Macro'>SearchSysCacheList1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN70"><span class='Ref_to_EnumConst'>OPERNAMENSP</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN583"><span class='Ref_to_Macro'>CStringGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1552"><span class='Ref_To_Local'>opername</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * In typical scenarios, most if not all of the operators found by the 
     * catcache search will end up getting returned; and there can be quite a 
     * few, for common operator names such as '=' or '+'.  To reduce the time 
     * spent in palloc, we allocate the result space as an array large enough 
     * to hold all the operators.  The original coding of this routine did a 
     * separate palloc for each operator, but profiling revealed that the 
     * pallocs used an unreasonably large fraction of parsing time. 
     */ 
</span><a name="LN1586"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>SPACE_PER_OP</span> <a href="../../include/c.h.html#LN587"><span class='Ref_to_Macro'>MAXALIGN</span></a><span class='Parentheses'>(</span><a href="../../include/c.h.html#LN554"><span class='Ref_to_Macro'>offsetof</span></a><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="../../include/catalog/namespace.h.html#LN27"><span class='Ref_to_Struct'>_FuncCandidateList</span></a><span class='Delimiter'>, </span><a href="../../pl/plperl/ppport.h.html#LN4358"><span class='Ref_to_Global_Var'>args</span></a><span class='Parentheses'>) </span><span class='Operator'>+ \ 
</span>                              <span class='Number'>2</span> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>))</span> 
 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1554"><span class='Ref_To_Local'>catlist</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/catcache.h.html#LN153"><span class='Ref_to_Member'>n_members</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="namespace.c.html#LN1549"><span class='Ref_To_Local'>resultSpace</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1554"><span class='Ref_To_Local'>catlist</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/catcache.h.html#LN153"><span class='Ref_to_Member'>n_members</span></a> <span class='Operator'>* </span><a href="namespace.c.html#LN1586"><span class='Ref_to_Const'>SPACE_PER_OP</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1555"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="namespace.c.html#LN1555"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="namespace.c.html#LN1554"><span class='Ref_To_Local'>catlist</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/catcache.h.html#LN153"><span class='Ref_to_Member'>n_members</span></a><span class='Delimiter'>; </span><a href="namespace.c.html#LN1555"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1594"></a>        <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>opertup</span> <span class='Operator'>= &</span><a href="namespace.c.html#LN1554"><span class='Ref_To_Local'>catlist</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/catcache.h.html#LN154"><span class='Ref_to_Member'>members</span></a><span class='Delimiter'>[</span><a href="namespace.c.html#LN1555"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span><a href="../../include/utils/catcache.h.html#LN115"><span class='Ref_to_Member'>tuple</span></a><span class='Delimiter'>; 
</span><a name="LN1595"></a>        <a href="../../include/catalog/pg_operator.h.html#LN56"><span class='Ref_to_Typedef'>Form_pg_operator</span></a> <span class='Declare_Local'>operform</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_operator.h.html#LN56"><span class='Ref_to_Typedef'>Form_pg_operator</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1594"><span class='Ref_To_Local'>opertup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1596"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>pathpos</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN1597"></a>        <a href="../../include/catalog/namespace.h.html#LN27"><span class='Ref_to_Typedef'>FuncCandidateList</span></a> <span class='Declare_Local'>newResult</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Ignore operators of wrong kind, if specific kind requested */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1546"><span class='Ref_to_Parameter'>oprkind</span></a> <span class='Operator'>&& </span><a href="namespace.c.html#LN1595"><span class='Ref_To_Local'>operform</span></a><span class='Operator'>-&GT;</span>oprkind <span class='Operator'>!= </span><a href="namespace.c.html#LN1546"><span class='Ref_to_Parameter'>oprkind</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1553"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Consider only opers in specified namespace */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1595"><span class='Ref_To_Local'>operform</span></a><span class='Operator'>-&GT;</span>oprnamespace <span class='Operator'>!= </span><a href="namespace.c.html#LN1553"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* No need to check args, they must all be different */ 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * Consider only opers that are in the search path and are not in 
             * the temp namespace. 
             */ 
</span><a name="LN1616"></a>            <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>nsp</span><span class='Delimiter'>; 
</span> 
            <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1616"><span class='Ref_To_Local'>nsp</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1595"><span class='Ref_To_Local'>operform</span></a><span class='Operator'>-&GT;</span>oprnamespace <span class='Operator'>== </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1616"><span class='Ref_To_Local'>nsp</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>                    <a href="namespace.c.html#LN1595"><span class='Ref_To_Local'>operform</span></a><span class='Operator'>-&GT;</span>oprnamespace <span class='Operator'>!= </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>)</span> 
                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <a href="namespace.c.html#LN1596"><span class='Ref_To_Local'>pathpos</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1616"><span class='Ref_To_Local'>nsp</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* oper is not in search path */ 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Okay, it's in the search path, but does it have the same 
             * arguments as something we already accepted?  If so, keep only 
             * the one that appears earlier in the search path. 
             * 
             * If we have an ordered list from SearchSysCacheList (the normal 
             * case), then any conflicting oper must immediately adjoin this 
             * one in the list, so we only need to look at the newest result 
             * item.  If we have an unordered list, we have to scan the whole 
             * result list. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1548"><span class='Ref_To_Local'>resultList</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN1641"></a>                <a href="../../include/catalog/namespace.h.html#LN27"><span class='Ref_to_Typedef'>FuncCandidateList</span></a> <span class='Declare_Local'>prevResult</span><span class='Delimiter'>; 
</span> 
                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1554"><span class='Ref_To_Local'>catlist</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/catcache.h.html#LN149"><span class='Ref_to_Member'>ordered</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1595"><span class='Ref_To_Local'>operform</span></a><span class='Operator'>-&GT;</span>oprleft <span class='Operator'>== </span><a href="namespace.c.html#LN1548"><span class='Ref_To_Local'>resultList</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN36"><span class='Ref_to_Member'>args</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>&& 
</span>                        <a href="namespace.c.html#LN1595"><span class='Ref_To_Local'>operform</span></a><span class='Operator'>-&GT;</span>oprright <span class='Operator'>== </span><a href="namespace.c.html#LN1548"><span class='Ref_To_Local'>resultList</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN36"><span class='Ref_to_Member'>args</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>                        <a href="namespace.c.html#LN1641"><span class='Ref_To_Local'>prevResult</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN1548"><span class='Ref_To_Local'>resultList</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>else</span> 
                        <a href="namespace.c.html#LN1641"><span class='Ref_To_Local'>prevResult</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                <span class='Delimiter'>{ 
</span>                    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1641"><span class='Ref_To_Local'>prevResult</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN1548"><span class='Ref_To_Local'>resultList</span></a><span class='Delimiter'>; 
</span>                         <a href="namespace.c.html#LN1641"><span class='Ref_To_Local'>prevResult</span></a><span class='Delimiter'>; 
</span>                         <a href="namespace.c.html#LN1641"><span class='Ref_To_Local'>prevResult</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN1641"><span class='Ref_To_Local'>prevResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN29"><span class='Ref_to_Member'>next</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1595"><span class='Ref_To_Local'>operform</span></a><span class='Operator'>-&GT;</span>oprleft <span class='Operator'>== </span><a href="namespace.c.html#LN1641"><span class='Ref_To_Local'>prevResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN36"><span class='Ref_to_Member'>args</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>&& 
</span>                            <a href="namespace.c.html#LN1595"><span class='Ref_To_Local'>operform</span></a><span class='Operator'>-&GT;</span>oprright <span class='Operator'>== </span><a href="namespace.c.html#LN1641"><span class='Ref_To_Local'>prevResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN36"><span class='Ref_to_Member'>args</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>                            <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1641"><span class='Ref_To_Local'>prevResult</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Comment_Multi_Line'>/* We have a match with a previous result */ 
</span>                    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="namespace.c.html#LN1596"><span class='Ref_To_Local'>pathpos</span></a> <span class='Operator'>!= </span><a href="namespace.c.html#LN1641"><span class='Ref_To_Local'>prevResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN30"><span class='Ref_to_Member'>pathpos</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1596"><span class='Ref_To_Local'>pathpos</span></a> <span class='Operator'>&GT; </span><a href="namespace.c.html#LN1641"><span class='Ref_To_Local'>prevResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN30"><span class='Ref_to_Member'>pathpos</span></a><span class='Parentheses'>) 
</span>                        <span class='Control'>continue</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* keep previous result */ 
</span>                    <span class='Comment_Multi_Line'>/* replace previous result */ 
</span>                    <a href="namespace.c.html#LN1641"><span class='Ref_To_Local'>prevResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN30"><span class='Ref_to_Member'>pathpos</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN1596"><span class='Ref_To_Local'>pathpos</span></a><span class='Delimiter'>; 
</span>                    <a href="namespace.c.html#LN1641"><span class='Ref_To_Local'>prevResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN31"><span class='Ref_to_Member'>oid</span></a> <span class='Operator'>= </span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1594"><span class='Ref_To_Local'>opertup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>continue</span><span class='Delimiter'>;</span>   <span class='Comment_Single_Line'>/* args are same, of course */ 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if resultList &raquo; </span> 
        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
        <span class='Comment_Multi_Line'>/* 
         * Okay to add it to result list 
         */ 
</span>        <a href="namespace.c.html#LN1597"><span class='Ref_To_Local'>newResult</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN27"><span class='Ref_to_Typedef'>FuncCandidateList</span></a><span class='Parentheses'>) (</span><a href="namespace.c.html#LN1549"><span class='Ref_To_Local'>resultSpace</span></a> <span class='Operator'>+ </span><a href="namespace.c.html#LN1550"><span class='Ref_To_Local'>nextResult</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN1550"><span class='Ref_To_Local'>nextResult</span></a> <span class='Operator'>+= </span><a href="namespace.c.html#LN1586"><span class='Ref_to_Const'>SPACE_PER_OP</span></a><span class='Delimiter'>; 
</span> 
        <a href="namespace.c.html#LN1597"><span class='Ref_To_Local'>newResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN30"><span class='Ref_to_Member'>pathpos</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN1596"><span class='Ref_To_Local'>pathpos</span></a><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN1597"><span class='Ref_To_Local'>newResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN31"><span class='Ref_to_Member'>oid</span></a> <span class='Operator'>= </span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1594"><span class='Ref_To_Local'>opertup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN1597"><span class='Ref_To_Local'>newResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN32"><span class='Ref_to_Member'>nargs</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN1597"><span class='Ref_To_Local'>newResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN33"><span class='Ref_to_Member'>nvargs</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN1597"><span class='Ref_To_Local'>newResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN34"><span class='Ref_to_Member'>ndargs</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN1597"><span class='Ref_To_Local'>newResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN35"><span class='Ref_to_Member'>argnumbers</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN1597"><span class='Ref_To_Local'>newResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN36"><span class='Ref_to_Member'>args</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="namespace.c.html#LN1595"><span class='Ref_To_Local'>operform</span></a><span class='Operator'>-&GT;</span>oprleft<span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN1597"><span class='Ref_To_Local'>newResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN36"><span class='Ref_to_Member'>args</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="namespace.c.html#LN1595"><span class='Ref_To_Local'>operform</span></a><span class='Operator'>-&GT;</span>oprright<span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN1597"><span class='Ref_To_Local'>newResult</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN29"><span class='Ref_to_Member'>next</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN1548"><span class='Ref_To_Local'>resultList</span></a><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN1548"><span class='Ref_To_Local'>resultList</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN1597"><span class='Ref_To_Local'>newResult</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=0;i&LT;catlist-&GT;n_memb... &raquo; </span> 
 
    <a href="../../include/utils/syscache.h.html#LN209"><span class='Ref_to_Macro'>ReleaseSysCacheList</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1554"><span class='Ref_To_Local'>catlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN1548"><span class='Ref_To_Local'>resultList</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end OpernameGetCandidates &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * OperatorIsVisible 
 *      Determine whether an operator (identified by OID) is visible in the 
 *      current search path.  Visible means "would be found by searching 
 *      for the unqualified operator name with exact argument matches". 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN1706"></a><span class='Declare_Function'>OperatorIsVisible</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>oprid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1708"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>oprtup</span><span class='Delimiter'>; 
</span><a name="LN1709"></a>    <a href="../../include/catalog/pg_operator.h.html#LN56"><span class='Ref_to_Typedef'>Form_pg_operator</span></a> <span class='Declare_Local'>oprform</span><span class='Delimiter'>; 
</span><a name="LN1710"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>oprnamespace</span><span class='Delimiter'>; 
</span><a name="LN1711"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>visible</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN1708"><span class='Ref_To_Local'>oprtup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN71"><span class='Ref_to_EnumConst'>OPEROID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1706"><span class='Ref_to_Parameter'>oprid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1708"><span class='Ref_To_Local'>oprtup</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for operator %u"</span><span class='Delimiter'>, </span><a href="namespace.c.html#LN1706"><span class='Ref_to_Parameter'>oprid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN1709"><span class='Ref_To_Local'>oprform</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_operator.h.html#LN56"><span class='Ref_to_Typedef'>Form_pg_operator</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1708"><span class='Ref_To_Local'>oprtup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Quick check: if it ain't in the path at all, it ain't visible. Items in 
     * the system namespace are surely in the path and so we needn't even do 
     * list_member_oid() for them. 
     */ 
</span>    <a href="namespace.c.html#LN1710"><span class='Ref_To_Local'>oprnamespace</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN1709"><span class='Ref_To_Local'>oprform</span></a><span class='Operator'>-&GT;</span>oprnamespace<span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1710"><span class='Ref_To_Local'>oprnamespace</span></a> <span class='Operator'>!= </span><a href="../../include/catalog/pg_namespace.h.html#LN70"><span class='Ref_to_Const'>PG_CATALOG_NAMESPACE</span></a> <span class='Operator'>&& 
</span>        <span class='Operator'>!</span><a href="../../include/nodes/pg_list.h.html#LN231"><span class='Ref_to_Proto'>list_member_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN1710"><span class='Ref_To_Local'>oprnamespace</span></a><span class='Parentheses'>))</span> 
        <a href="namespace.c.html#LN1711"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * If it is in the path, it might still not be visible; it could be 
         * hidden by another operator of the same name and arguments earlier 
         * in the path.  So we must do a slow check to see if this is the same 
         * operator that would be found by OpernameGetOprid. 
         */ 
</span><a name="LN1737"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>oprname</span> <span class='Operator'>= </span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1709"><span class='Ref_To_Local'>oprform</span></a><span class='Operator'>-&GT;</span>oprname<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="namespace.c.html#LN1711"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN77"><span class='Ref_to_Proto'>OpernameGetOprid</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN138"><span class='Ref_to_Macro'>list_make1</span></a><span class='Parentheses'>(</span><a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1737"><span class='Ref_To_Local'>oprname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, 
</span>                                    <a href="namespace.c.html#LN1709"><span class='Ref_To_Local'>oprform</span></a><span class='Operator'>-&GT;</span>oprleft<span class='Delimiter'>, </span><a href="namespace.c.html#LN1709"><span class='Ref_To_Local'>oprform</span></a><span class='Operator'>-&GT;</span>oprright<span class='Parentheses'>)</span> 
                   <span class='Operator'>== </span><a href="namespace.c.html#LN1706"><span class='Ref_to_Parameter'>oprid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1708"><span class='Ref_To_Local'>oprtup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN1711"><span class='Ref_To_Local'>visible</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end OperatorIsVisible &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * OpclassnameGetOpcid 
 *      Try to resolve an unqualified index opclass name. 
 *      Returns OID if opclass found in search path, else InvalidOid. 
 * 
 * This is essentially the same as TypenameGetTypid, but we have to have 
 * an extra argument for the index AM OID. 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN1759"></a><span class='Declare_Function'>OpclassnameGetOpcid</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>amid</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>opcname</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1761"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>opcid</span><span class='Delimiter'>; 
</span><a name="LN1762"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1762"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1768"></a>        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1762"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1768"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* do not look in temp namespace */ 
</span> 
        <a href="namespace.c.html#LN1761"><span class='Ref_To_Local'>opcid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN186"><span class='Ref_to_Macro'>GetSysCacheOid3</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN46"><span class='Ref_to_EnumConst'>CLAAMNAMENSP</span></a><span class='Delimiter'>, 
</span>                                <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1759"><span class='Ref_to_Parameter'>amid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1759"><span class='Ref_to_Parameter'>opcname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1768"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1761"><span class='Ref_To_Local'>opcid</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="namespace.c.html#LN1761"><span class='Ref_To_Local'>opcid</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Not found in path */ 
</span>    <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end OpclassnameGetOpcid &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * OpclassIsVisible 
 *      Determine whether an opclass (identified by OID) is visible in the 
 *      current search path.  Visible means "would be found by searching 
 *      for the unqualified opclass name". 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN1792"></a><span class='Declare_Function'>OpclassIsVisible</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>opcid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1794"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>opctup</span><span class='Delimiter'>; 
</span><a name="LN1795"></a>    <a href="../../include/catalog/pg_opclass.h.html#LN67"><span class='Ref_to_Typedef'>Form_pg_opclass</span></a> <span class='Declare_Local'>opcform</span><span class='Delimiter'>; 
</span><a name="LN1796"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>opcnamespace</span><span class='Delimiter'>; 
</span><a name="LN1797"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>visible</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN1794"><span class='Ref_To_Local'>opctup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN47"><span class='Ref_to_EnumConst'>CLAOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1792"><span class='Ref_to_Parameter'>opcid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1794"><span class='Ref_To_Local'>opctup</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for opclass %u"</span><span class='Delimiter'>, </span><a href="namespace.c.html#LN1792"><span class='Ref_to_Parameter'>opcid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN1795"><span class='Ref_To_Local'>opcform</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_opclass.h.html#LN67"><span class='Ref_to_Typedef'>Form_pg_opclass</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1794"><span class='Ref_To_Local'>opctup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Quick check: if it ain't in the path at all, it ain't visible. Items in 
     * the system namespace are surely in the path and so we needn't even do 
     * list_member_oid() for them. 
     */ 
</span>    <a href="namespace.c.html#LN1796"><span class='Ref_To_Local'>opcnamespace</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN1795"><span class='Ref_To_Local'>opcform</span></a><span class='Operator'>-&GT;</span>opcnamespace<span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1796"><span class='Ref_To_Local'>opcnamespace</span></a> <span class='Operator'>!= </span><a href="../../include/catalog/pg_namespace.h.html#LN70"><span class='Ref_to_Const'>PG_CATALOG_NAMESPACE</span></a> <span class='Operator'>&& 
</span>        <span class='Operator'>!</span><a href="../../include/nodes/pg_list.h.html#LN231"><span class='Ref_to_Proto'>list_member_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN1796"><span class='Ref_To_Local'>opcnamespace</span></a><span class='Parentheses'>))</span> 
        <a href="namespace.c.html#LN1797"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * If it is in the path, it might still not be visible; it could be 
         * hidden by another opclass of the same name earlier in the path. So 
         * we must do a slow check to see if this opclass would be found by 
         * OpclassnameGetOpcid. 
         */ 
</span><a name="LN1823"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>opcname</span> <span class='Operator'>= </span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1795"><span class='Ref_To_Local'>opcform</span></a><span class='Operator'>-&GT;</span>opcname<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="namespace.c.html#LN1797"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN82"><span class='Ref_to_Proto'>OpclassnameGetOpcid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1795"><span class='Ref_To_Local'>opcform</span></a><span class='Operator'>-&GT;</span>opcmethod<span class='Delimiter'>, </span><a href="namespace.c.html#LN1823"><span class='Ref_To_Local'>opcname</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="namespace.c.html#LN1792"><span class='Ref_to_Parameter'>opcid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1794"><span class='Ref_To_Local'>opctup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN1797"><span class='Ref_To_Local'>visible</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end OpclassIsVisible &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * OpfamilynameGetOpfid 
 *      Try to resolve an unqualified index opfamily name. 
 *      Returns OID if opfamily found in search path, else InvalidOid. 
 * 
 * This is essentially the same as TypenameGetTypid, but we have to have 
 * an extra argument for the index AM OID. 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN1842"></a><span class='Declare_Function'>OpfamilynameGetOpfid</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>amid</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>opfname</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1844"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>opfid</span><span class='Delimiter'>; 
</span><a name="LN1845"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1845"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1851"></a>        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1845"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1851"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* do not look in temp namespace */ 
</span> 
        <a href="namespace.c.html#LN1844"><span class='Ref_To_Local'>opfid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN186"><span class='Ref_to_Macro'>GetSysCacheOid3</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN72"><span class='Ref_to_EnumConst'>OPFAMILYAMNAMENSP</span></a><span class='Delimiter'>, 
</span>                                <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1842"><span class='Ref_to_Parameter'>amid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1842"><span class='Ref_to_Parameter'>opfname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1851"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1844"><span class='Ref_To_Local'>opfid</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="namespace.c.html#LN1844"><span class='Ref_To_Local'>opfid</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Not found in path */ 
</span>    <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end OpfamilynameGetOpfid &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * OpfamilyIsVisible 
 *      Determine whether an opfamily (identified by OID) is visible in the 
 *      current search path.  Visible means "would be found by searching 
 *      for the unqualified opfamily name". 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN1875"></a><span class='Declare_Function'>OpfamilyIsVisible</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>opfid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1877"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>opftup</span><span class='Delimiter'>; 
</span><a name="LN1878"></a>    <a href="../../include/catalog/pg_opfamily.h.html#LN43"><span class='Ref_to_Typedef'>Form_pg_opfamily</span></a> <span class='Declare_Local'>opfform</span><span class='Delimiter'>; 
</span><a name="LN1879"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>opfnamespace</span><span class='Delimiter'>; 
</span><a name="LN1880"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>visible</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN1877"><span class='Ref_To_Local'>opftup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN73"><span class='Ref_to_EnumConst'>OPFAMILYOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1875"><span class='Ref_to_Parameter'>opfid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1877"><span class='Ref_To_Local'>opftup</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for opfamily %u"</span><span class='Delimiter'>, </span><a href="namespace.c.html#LN1875"><span class='Ref_to_Parameter'>opfid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN1878"><span class='Ref_To_Local'>opfform</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_opfamily.h.html#LN43"><span class='Ref_to_Typedef'>Form_pg_opfamily</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1877"><span class='Ref_To_Local'>opftup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Quick check: if it ain't in the path at all, it ain't visible. Items in 
     * the system namespace are surely in the path and so we needn't even do 
     * list_member_oid() for them. 
     */ 
</span>    <a href="namespace.c.html#LN1879"><span class='Ref_To_Local'>opfnamespace</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN1878"><span class='Ref_To_Local'>opfform</span></a><span class='Operator'>-&GT;</span>opfnamespace<span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1879"><span class='Ref_To_Local'>opfnamespace</span></a> <span class='Operator'>!= </span><a href="../../include/catalog/pg_namespace.h.html#LN70"><span class='Ref_to_Const'>PG_CATALOG_NAMESPACE</span></a> <span class='Operator'>&& 
</span>        <span class='Operator'>!</span><a href="../../include/nodes/pg_list.h.html#LN231"><span class='Ref_to_Proto'>list_member_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN1879"><span class='Ref_To_Local'>opfnamespace</span></a><span class='Parentheses'>))</span> 
        <a href="namespace.c.html#LN1880"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * If it is in the path, it might still not be visible; it could be 
         * hidden by another opfamily of the same name earlier in the path. So 
         * we must do a slow check to see if this opfamily would be found by 
         * OpfamilynameGetOpfid. 
         */ 
</span><a name="LN1906"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>opfname</span> <span class='Operator'>= </span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1878"><span class='Ref_To_Local'>opfform</span></a><span class='Operator'>-&GT;</span>opfname<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="namespace.c.html#LN1880"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN85"><span class='Ref_to_Proto'>OpfamilynameGetOpfid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1878"><span class='Ref_To_Local'>opfform</span></a><span class='Operator'>-&GT;</span>opfmethod<span class='Delimiter'>, </span><a href="namespace.c.html#LN1906"><span class='Ref_To_Local'>opfname</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="namespace.c.html#LN1875"><span class='Ref_to_Parameter'>opfid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1877"><span class='Ref_To_Local'>opftup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN1880"><span class='Ref_To_Local'>visible</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end OpfamilyIsVisible &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * CollationGetCollid 
 *      Try to resolve an unqualified collation name. 
 *      Returns OID if collation found in search path, else InvalidOid. 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN1922"></a><span class='Declare_Function'>CollationGetCollid</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>collname</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1924"></a>    <a href="../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>dbencoding</span> <span class='Operator'>= </span><a href="../../include/mb/pg_wchar.h.html#LN545"><span class='Ref_to_Proto'>GetDatabaseEncoding</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span><a name="LN1925"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1925"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1931"></a>        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1925"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1932"></a>        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>collid</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1931"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* do not look in temp namespace */ 
</span> 
        <span class='Comment_Multi_Line'>/* Check for database-encoding-specific entry */ 
</span>        <a href="namespace.c.html#LN1932"><span class='Ref_To_Local'>collid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN186"><span class='Ref_to_Macro'>GetSysCacheOid3</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN48"><span class='Ref_to_EnumConst'>COLLNAMEENCNSP</span></a><span class='Delimiter'>, 
</span>                                 <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1922"><span class='Ref_to_Parameter'>collname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                 <a href="../../include/postgres.h.html#LN484"><span class='Ref_to_Macro'>Int32GetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1924"><span class='Ref_To_Local'>dbencoding</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                 <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1931"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1932"><span class='Ref_To_Local'>collid</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="namespace.c.html#LN1932"><span class='Ref_To_Local'>collid</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Check for any-encoding entry */ 
</span>        <a href="namespace.c.html#LN1932"><span class='Ref_To_Local'>collid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN186"><span class='Ref_to_Macro'>GetSysCacheOid3</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN48"><span class='Ref_to_EnumConst'>COLLNAMEENCNSP</span></a><span class='Delimiter'>, 
</span>                                 <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1922"><span class='Ref_to_Parameter'>collname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                 <a href="../../include/postgres.h.html#LN484"><span class='Ref_to_Macro'>Int32GetDatum</span></a><span class='Parentheses'>(</span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                 <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1931"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1932"><span class='Ref_To_Local'>collid</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="namespace.c.html#LN1932"><span class='Ref_To_Local'>collid</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Not found in path */ 
</span>    <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end CollationGetCollid &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * CollationIsVisible 
 *      Determine whether a collation (identified by OID) is visible in the 
 *      current search path.  Visible means "would be found by searching 
 *      for the unqualified collation name". 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN1965"></a><span class='Declare_Function'>CollationIsVisible</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>collid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1967"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>colltup</span><span class='Delimiter'>; 
</span><a name="LN1968"></a>    <a href="../../include/catalog/pg_collation.h.html#LN51"><span class='Ref_to_Typedef'>Form_pg_collation</span></a> <span class='Declare_Local'>collform</span><span class='Delimiter'>; 
</span><a name="LN1969"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>collnamespace</span><span class='Delimiter'>; 
</span><a name="LN1970"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>visible</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN1967"><span class='Ref_To_Local'>colltup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN49"><span class='Ref_to_EnumConst'>COLLOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1965"><span class='Ref_to_Parameter'>collid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1967"><span class='Ref_To_Local'>colltup</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for collation %u"</span><span class='Delimiter'>, </span><a href="namespace.c.html#LN1965"><span class='Ref_to_Parameter'>collid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN1968"><span class='Ref_To_Local'>collform</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_collation.h.html#LN51"><span class='Ref_to_Typedef'>Form_pg_collation</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1967"><span class='Ref_To_Local'>colltup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Quick check: if it ain't in the path at all, it ain't visible. Items in 
     * the system namespace are surely in the path and so we needn't even do 
     * list_member_oid() for them. 
     */ 
</span>    <a href="namespace.c.html#LN1969"><span class='Ref_To_Local'>collnamespace</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN1968"><span class='Ref_To_Local'>collform</span></a><span class='Operator'>-&GT;</span>collnamespace<span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN1969"><span class='Ref_To_Local'>collnamespace</span></a> <span class='Operator'>!= </span><a href="../../include/catalog/pg_namespace.h.html#LN70"><span class='Ref_to_Const'>PG_CATALOG_NAMESPACE</span></a> <span class='Operator'>&& 
</span>        <span class='Operator'>!</span><a href="../../include/nodes/pg_list.h.html#LN231"><span class='Ref_to_Proto'>list_member_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN1969"><span class='Ref_To_Local'>collnamespace</span></a><span class='Parentheses'>))</span> 
        <a href="namespace.c.html#LN1970"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * If it is in the path, it might still not be visible; it could be 
         * hidden by another conversion of the same name earlier in the path. 
         * So we must do a slow check to see if this conversion would be found 
         * by CollationGetCollid. 
         */ 
</span><a name="LN1996"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>collname</span> <span class='Operator'>= </span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1968"><span class='Ref_To_Local'>collform</span></a><span class='Operator'>-&GT;</span>collname<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="namespace.c.html#LN1970"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN88"><span class='Ref_to_Proto'>CollationGetCollid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1996"><span class='Ref_To_Local'>collname</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="namespace.c.html#LN1965"><span class='Ref_to_Parameter'>collid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN1967"><span class='Ref_To_Local'>colltup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN1970"><span class='Ref_To_Local'>visible</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end CollationIsVisible &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * ConversionGetConid 
 *      Try to resolve an unqualified conversion name. 
 *      Returns OID if conversion found in search path, else InvalidOid. 
 * 
 * This is essentially the same as RelnameGetRelid. 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN2015"></a><span class='Declare_Function'>ConversionGetConid</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>conname</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2017"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>conid</span><span class='Delimiter'>; 
</span><a name="LN2018"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2018"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2024"></a>        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2018"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2024"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* do not look in temp namespace */ 
</span> 
        <a href="namespace.c.html#LN2017"><span class='Ref_To_Local'>conid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN184"><span class='Ref_to_Macro'>GetSysCacheOid2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN51"><span class='Ref_to_EnumConst'>CONNAMENSP</span></a><span class='Delimiter'>, 
</span>                                <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2015"><span class='Ref_to_Parameter'>conname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2024"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2017"><span class='Ref_To_Local'>conid</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="namespace.c.html#LN2017"><span class='Ref_To_Local'>conid</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Not found in path */ 
</span>    <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end ConversionGetConid &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * ConversionIsVisible 
 *      Determine whether a conversion (identified by OID) is visible in the 
 *      current search path.  Visible means "would be found by searching 
 *      for the unqualified conversion name". 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN2047"></a><span class='Declare_Function'>ConversionIsVisible</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>conid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2049"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>contup</span><span class='Delimiter'>; 
</span><a name="LN2050"></a>    <a href="../../include/catalog/pg_conversion.h.html#LN55"><span class='Ref_to_Typedef'>Form_pg_conversion</span></a> <span class='Declare_Local'>conform</span><span class='Delimiter'>; 
</span><a name="LN2051"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>connamespace</span><span class='Delimiter'>; 
</span><a name="LN2052"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>visible</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN2049"><span class='Ref_To_Local'>contup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN53"><span class='Ref_to_EnumConst'>CONVOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2047"><span class='Ref_to_Parameter'>conid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2049"><span class='Ref_To_Local'>contup</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for conversion %u"</span><span class='Delimiter'>, </span><a href="namespace.c.html#LN2047"><span class='Ref_to_Parameter'>conid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN2050"><span class='Ref_To_Local'>conform</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_conversion.h.html#LN55"><span class='Ref_to_Typedef'>Form_pg_conversion</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2049"><span class='Ref_To_Local'>contup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Quick check: if it ain't in the path at all, it ain't visible. Items in 
     * the system namespace are surely in the path and so we needn't even do 
     * list_member_oid() for them. 
     */ 
</span>    <a href="namespace.c.html#LN2051"><span class='Ref_To_Local'>connamespace</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN2050"><span class='Ref_To_Local'>conform</span></a><span class='Operator'>-&GT;</span>connamespace<span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2051"><span class='Ref_To_Local'>connamespace</span></a> <span class='Operator'>!= </span><a href="../../include/catalog/pg_namespace.h.html#LN70"><span class='Ref_to_Const'>PG_CATALOG_NAMESPACE</span></a> <span class='Operator'>&& 
</span>        <span class='Operator'>!</span><a href="../../include/nodes/pg_list.h.html#LN231"><span class='Ref_to_Proto'>list_member_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN2051"><span class='Ref_To_Local'>connamespace</span></a><span class='Parentheses'>))</span> 
        <a href="namespace.c.html#LN2052"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * If it is in the path, it might still not be visible; it could be 
         * hidden by another conversion of the same name earlier in the path. 
         * So we must do a slow check to see if this conversion would be found 
         * by ConversionGetConid. 
         */ 
</span><a name="LN2078"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>conname</span> <span class='Operator'>= </span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2050"><span class='Ref_To_Local'>conform</span></a><span class='Operator'>-&GT;</span>conname<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="namespace.c.html#LN2052"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN91"><span class='Ref_to_Proto'>ConversionGetConid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2078"><span class='Ref_To_Local'>conname</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="namespace.c.html#LN2047"><span class='Ref_to_Parameter'>conid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2049"><span class='Ref_To_Local'>contup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN2052"><span class='Ref_To_Local'>visible</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end ConversionIsVisible &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * get_statistics_object_oid - find a statistics object by possibly qualified name 
 * 
 * If not found, returns InvalidOid if missing_ok, else throws error 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN2094"></a><span class='Declare_Function'>get_statistics_object_oid</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>names</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>missing_ok</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2096"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>schemaname</span><span class='Delimiter'>; 
</span><a name="LN2097"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>stats_name</span><span class='Delimiter'>; 
</span><a name="LN2098"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span><span class='Delimiter'>; 
</span><a name="LN2099"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>stats_oid</span> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span><a name="LN2100"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* deconstruct the name list */ 
</span>    <a href="../../include/catalog/namespace.h.html#LN109"><span class='Ref_to_Proto'>DeconstructQualifiedName</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2094"><span class='Ref_to_Parameter'>names</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="namespace.c.html#LN2096"><span class='Ref_To_Local'>schemaname</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="namespace.c.html#LN2097"><span class='Ref_To_Local'>stats_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2096"><span class='Ref_To_Local'>schemaname</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* use exact schema given */ 
</span>        <a href="namespace.c.html#LN2098"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN113"><span class='Ref_to_Proto'>LookupExplicitNamespace</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2096"><span class='Ref_To_Local'>schemaname</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN2094"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2094"><span class='Ref_to_Parameter'>missing_ok</span></a> <span class='Operator'>&& !</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2098"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span> 
            <a href="namespace.c.html#LN2099"><span class='Ref_To_Local'>stats_oid</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="namespace.c.html#LN2099"><span class='Ref_To_Local'>stats_oid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN184"><span class='Ref_to_Macro'>GetSysCacheOid2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN88"><span class='Ref_to_EnumConst'>STATEXTNAMENSP</span></a><span class='Delimiter'>, 
</span>                                        <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2097"><span class='Ref_To_Local'>stats_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                        <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2098"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* search for it in search path */ 
</span>        <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2100"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="namespace.c.html#LN2098"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2100"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2098"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* do not look in temp namespace */ 
</span>            <a href="namespace.c.html#LN2099"><span class='Ref_To_Local'>stats_oid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN184"><span class='Ref_to_Macro'>GetSysCacheOid2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN88"><span class='Ref_to_EnumConst'>STATEXTNAMENSP</span></a><span class='Delimiter'>, 
</span>                                        <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2097"><span class='Ref_To_Local'>stats_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                        <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2098"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2099"><span class='Ref_To_Local'>stats_oid</span></a><span class='Parentheses'>))</span> 
                <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2099"><span class='Ref_To_Local'>stats_oid</span></a><span class='Parentheses'>) </span><span class='Operator'>&& !</span><a href="namespace.c.html#LN2094"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>)</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_OBJECT<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"statistics object \"%s\" does not exist"</span><span class='Delimiter'>, 
</span>                        <a href="../../include/catalog/namespace.h.html#LN120"><span class='Ref_to_Proto'>NameListToString</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2094"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN2099"><span class='Ref_To_Local'>stats_oid</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end get_statistics_object_oid &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * StatisticsObjIsVisible 
 *      Determine whether a statistics object (identified by OID) is visible in 
 *      the current search path.  Visible means "would be found by searching 
 *      for the unqualified statistics object name". 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN2151"></a><span class='Declare_Function'>StatisticsObjIsVisible</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>relid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2153"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>stxtup</span><span class='Delimiter'>; 
</span><a name="LN2154"></a>    <a href="../../include/catalog/pg_statistic_ext.h.html#LN60"><span class='Ref_to_Typedef'>Form_pg_statistic_ext</span></a> <span class='Declare_Local'>stxform</span><span class='Delimiter'>; 
</span><a name="LN2155"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>stxnamespace</span><span class='Delimiter'>; 
</span><a name="LN2156"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>visible</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN2153"><span class='Ref_To_Local'>stxtup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN89"><span class='Ref_to_EnumConst'>STATEXTOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2151"><span class='Ref_to_Parameter'>relid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2153"><span class='Ref_To_Local'>stxtup</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for statistics object %u"</span><span class='Delimiter'>, </span><a href="namespace.c.html#LN2151"><span class='Ref_to_Parameter'>relid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN2154"><span class='Ref_To_Local'>stxform</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_statistic_ext.h.html#LN60"><span class='Ref_to_Typedef'>Form_pg_statistic_ext</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2153"><span class='Ref_To_Local'>stxtup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Quick check: if it ain't in the path at all, it ain't visible. Items in 
     * the system namespace are surely in the path and so we needn't even do 
     * list_member_oid() for them. 
     */ 
</span>    <a href="namespace.c.html#LN2155"><span class='Ref_To_Local'>stxnamespace</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN2154"><span class='Ref_To_Local'>stxform</span></a><span class='Operator'>-&GT;</span>stxnamespace<span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2155"><span class='Ref_To_Local'>stxnamespace</span></a> <span class='Operator'>!= </span><a href="../../include/catalog/pg_namespace.h.html#LN70"><span class='Ref_to_Const'>PG_CATALOG_NAMESPACE</span></a> <span class='Operator'>&& 
</span>        <span class='Operator'>!</span><a href="../../include/nodes/pg_list.h.html#LN231"><span class='Ref_to_Proto'>list_member_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN2155"><span class='Ref_To_Local'>stxnamespace</span></a><span class='Parentheses'>))</span> 
        <a href="namespace.c.html#LN2156"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * If it is in the path, it might still not be visible; it could be 
         * hidden by another statistics object of the same name earlier in the 
         * path. So we must do a slow check for conflicting objects. 
         */ 
</span><a name="LN2181"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>stxname</span> <span class='Operator'>= </span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2154"><span class='Ref_To_Local'>stxform</span></a><span class='Operator'>-&GT;</span>stxname<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2182"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
        <a href="namespace.c.html#LN2156"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2182"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN2187"></a>            <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2182"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2187"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN2155"><span class='Ref_To_Local'>stxnamespace</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Found it first in path */ 
</span>                <a href="namespace.c.html#LN2156"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN175"><span class='Ref_to_Macro'>SearchSysCacheExists2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN88"><span class='Ref_to_EnumConst'>STATEXTNAMENSP</span></a><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2181"><span class='Ref_To_Local'>stxname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2187"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>)))</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Found something else first in path */ 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2153"><span class='Ref_To_Local'>stxtup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN2156"><span class='Ref_To_Local'>visible</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end StatisticsObjIsVisible &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * get_ts_parser_oid - find a TS parser by possibly qualified name 
 * 
 * If not found, returns InvalidOid if missing_ok, else throws error 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN2216"></a><span class='Declare_Function'>get_ts_parser_oid</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>names</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>missing_ok</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2218"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>schemaname</span><span class='Delimiter'>; 
</span><a name="LN2219"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>parser_name</span><span class='Delimiter'>; 
</span><a name="LN2220"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span><span class='Delimiter'>; 
</span><a name="LN2221"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>prsoid</span> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span><a name="LN2222"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* deconstruct the name list */ 
</span>    <a href="../../include/catalog/namespace.h.html#LN109"><span class='Ref_to_Proto'>DeconstructQualifiedName</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2216"><span class='Ref_to_Parameter'>names</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="namespace.c.html#LN2218"><span class='Ref_To_Local'>schemaname</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="namespace.c.html#LN2219"><span class='Ref_To_Local'>parser_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2218"><span class='Ref_To_Local'>schemaname</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* use exact schema given */ 
</span>        <a href="namespace.c.html#LN2220"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN113"><span class='Ref_to_Proto'>LookupExplicitNamespace</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2218"><span class='Ref_To_Local'>schemaname</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN2216"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2216"><span class='Ref_to_Parameter'>missing_ok</span></a> <span class='Operator'>&& !</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2220"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span> 
            <a href="namespace.c.html#LN2221"><span class='Ref_To_Local'>prsoid</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="namespace.c.html#LN2221"><span class='Ref_To_Local'>prsoid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN184"><span class='Ref_to_Macro'>GetSysCacheOid2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN102"><span class='Ref_to_EnumConst'>TSPARSERNAMENSP</span></a><span class='Delimiter'>, 
</span>                                     <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2219"><span class='Ref_To_Local'>parser_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                     <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2220"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* search for it in search path */ 
</span>        <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2222"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="namespace.c.html#LN2220"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2222"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2220"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* do not look in temp namespace */ 
</span> 
            <a href="namespace.c.html#LN2221"><span class='Ref_To_Local'>prsoid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN184"><span class='Ref_to_Macro'>GetSysCacheOid2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN102"><span class='Ref_to_EnumConst'>TSPARSERNAMENSP</span></a><span class='Delimiter'>, 
</span>                                     <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2219"><span class='Ref_To_Local'>parser_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                     <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2220"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2221"><span class='Ref_To_Local'>prsoid</span></a><span class='Parentheses'>))</span> 
                <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2221"><span class='Ref_To_Local'>prsoid</span></a><span class='Parentheses'>) </span><span class='Operator'>&& !</span><a href="namespace.c.html#LN2216"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>)</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_OBJECT<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"text search parser \"%s\" does not exist"</span><span class='Delimiter'>, 
</span>                        <a href="../../include/catalog/namespace.h.html#LN120"><span class='Ref_to_Proto'>NameListToString</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2216"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN2221"><span class='Ref_To_Local'>prsoid</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end get_ts_parser_oid &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * TSParserIsVisible 
 *      Determine whether a parser (identified by OID) is visible in the 
 *      current search path.  Visible means "would be found by searching 
 *      for the unqualified parser name". 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN2274"></a><span class='Declare_Function'>TSParserIsVisible</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>prsId</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2276"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tup</span><span class='Delimiter'>; 
</span><a name="LN2277"></a>    <a href="../../include/catalog/pg_ts_parser.h.html#LN43"><span class='Ref_to_Typedef'>Form_pg_ts_parser</span></a> <span class='Declare_Local'>form</span><span class='Delimiter'>; 
</span><a name="LN2278"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespace</span><span class='Delimiter'>; 
</span><a name="LN2279"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>visible</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN2276"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN103"><span class='Ref_to_EnumConst'>TSPARSEROID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2274"><span class='Ref_to_Parameter'>prsId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2276"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for text search parser %u"</span><span class='Delimiter'>, </span><a href="namespace.c.html#LN2274"><span class='Ref_to_Parameter'>prsId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN2277"><span class='Ref_To_Local'>form</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_parser.h.html#LN43"><span class='Ref_to_Typedef'>Form_pg_ts_parser</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2276"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Quick check: if it ain't in the path at all, it ain't visible. Items in 
     * the system namespace are surely in the path and so we needn't even do 
     * list_member_oid() for them. 
     */ 
</span>    <span class='Control'>namespace</span> <span class='Operator'>= </span><a href="namespace.c.html#LN2277"><span class='Ref_To_Local'>form</span></a><span class='Operator'>-&GT;</span>prsnamespace<span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Control'>namespace</span> <span class='Operator'>!= </span><a href="../../include/catalog/pg_namespace.h.html#LN70"><span class='Ref_to_Const'>PG_CATALOG_NAMESPACE</span></a> <span class='Operator'>&& 
</span>        <span class='Operator'>!</span><a href="../../include/nodes/pg_list.h.html#LN231"><span class='Ref_to_Proto'>list_member_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Delimiter'>, </span><span class='Control'>namespace</span><span class='Parentheses'>))</span> 
        <a href="namespace.c.html#LN2279"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * If it is in the path, it might still not be visible; it could be 
         * hidden by another parser of the same name earlier in the path. So 
         * we must do a slow check for conflicting parsers. 
         */ 
</span><a name="LN2304"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>name</span> <span class='Operator'>= </span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2277"><span class='Ref_To_Local'>form</span></a><span class='Operator'>-&GT;</span>prsname<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2305"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
        <a href="namespace.c.html#LN2279"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2305"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN2310"></a>            <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2305"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2310"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* do not look in temp namespace */ 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2310"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>== </span><span class='Control'>namespace</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Found it first in path */ 
</span>                <a href="namespace.c.html#LN2279"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN175"><span class='Ref_to_Macro'>SearchSysCacheExists2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN102"><span class='Ref_to_EnumConst'>TSPARSERNAMENSP</span></a><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2304"><span class='Ref_To_Local'>name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2310"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>)))</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Found something else first in path */ 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2276"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN2279"><span class='Ref_To_Local'>visible</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end TSParserIsVisible &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * get_ts_dict_oid - find a TS dictionary by possibly qualified name 
 * 
 * If not found, returns InvalidOid if failOK, else throws error 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN2342"></a><span class='Declare_Function'>get_ts_dict_oid</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>names</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>missing_ok</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2344"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>schemaname</span><span class='Delimiter'>; 
</span><a name="LN2345"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>dict_name</span><span class='Delimiter'>; 
</span><a name="LN2346"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span><span class='Delimiter'>; 
</span><a name="LN2347"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>dictoid</span> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span><a name="LN2348"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* deconstruct the name list */ 
</span>    <a href="../../include/catalog/namespace.h.html#LN109"><span class='Ref_to_Proto'>DeconstructQualifiedName</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2342"><span class='Ref_to_Parameter'>names</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="namespace.c.html#LN2344"><span class='Ref_To_Local'>schemaname</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="namespace.c.html#LN2345"><span class='Ref_To_Local'>dict_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2344"><span class='Ref_To_Local'>schemaname</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* use exact schema given */ 
</span>        <a href="namespace.c.html#LN2346"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN113"><span class='Ref_to_Proto'>LookupExplicitNamespace</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2344"><span class='Ref_To_Local'>schemaname</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN2342"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2342"><span class='Ref_to_Parameter'>missing_ok</span></a> <span class='Operator'>&& !</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2346"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span> 
            <a href="namespace.c.html#LN2347"><span class='Ref_To_Local'>dictoid</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="namespace.c.html#LN2347"><span class='Ref_To_Local'>dictoid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN184"><span class='Ref_to_Macro'>GetSysCacheOid2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN100"><span class='Ref_to_EnumConst'>TSDICTNAMENSP</span></a><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2345"><span class='Ref_To_Local'>dict_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2346"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* search for it in search path */ 
</span>        <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2348"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="namespace.c.html#LN2346"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2348"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2346"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* do not look in temp namespace */ 
</span> 
            <a href="namespace.c.html#LN2347"><span class='Ref_To_Local'>dictoid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN184"><span class='Ref_to_Macro'>GetSysCacheOid2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN100"><span class='Ref_to_EnumConst'>TSDICTNAMENSP</span></a><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2345"><span class='Ref_To_Local'>dict_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2346"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2347"><span class='Ref_To_Local'>dictoid</span></a><span class='Parentheses'>))</span> 
                <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2347"><span class='Ref_To_Local'>dictoid</span></a><span class='Parentheses'>) </span><span class='Operator'>&& !</span><a href="namespace.c.html#LN2342"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>)</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_OBJECT<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"text search dictionary \"%s\" does not exist"</span><span class='Delimiter'>, 
</span>                        <a href="../../include/catalog/namespace.h.html#LN120"><span class='Ref_to_Proto'>NameListToString</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2342"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN2347"><span class='Ref_To_Local'>dictoid</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end get_ts_dict_oid &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * TSDictionaryIsVisible 
 *      Determine whether a dictionary (identified by OID) is visible in the 
 *      current search path.  Visible means "would be found by searching 
 *      for the unqualified dictionary name". 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN2400"></a><span class='Declare_Function'>TSDictionaryIsVisible</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>dictId</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2402"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tup</span><span class='Delimiter'>; 
</span><a name="LN2403"></a>    <a href="../../include/catalog/pg_ts_dict.h.html#LN44"><span class='Ref_to_Typedef'>Form_pg_ts_dict</span></a> <span class='Declare_Local'>form</span><span class='Delimiter'>; 
</span><a name="LN2404"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespace</span><span class='Delimiter'>; 
</span><a name="LN2405"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>visible</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN2402"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN101"><span class='Ref_to_EnumConst'>TSDICTOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2400"><span class='Ref_to_Parameter'>dictId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2402"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for text search dictionary %u"</span><span class='Delimiter'>, 
</span>             <a href="namespace.c.html#LN2400"><span class='Ref_to_Parameter'>dictId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN2403"><span class='Ref_To_Local'>form</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_dict.h.html#LN44"><span class='Ref_to_Typedef'>Form_pg_ts_dict</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2402"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Quick check: if it ain't in the path at all, it ain't visible. Items in 
     * the system namespace are surely in the path and so we needn't even do 
     * list_member_oid() for them. 
     */ 
</span>    <span class='Control'>namespace</span> <span class='Operator'>= </span><a href="namespace.c.html#LN2403"><span class='Ref_To_Local'>form</span></a><span class='Operator'>-&GT;</span>dictnamespace<span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Control'>namespace</span> <span class='Operator'>!= </span><a href="../../include/catalog/pg_namespace.h.html#LN70"><span class='Ref_to_Const'>PG_CATALOG_NAMESPACE</span></a> <span class='Operator'>&& 
</span>        <span class='Operator'>!</span><a href="../../include/nodes/pg_list.h.html#LN231"><span class='Ref_to_Proto'>list_member_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Delimiter'>, </span><span class='Control'>namespace</span><span class='Parentheses'>))</span> 
        <a href="namespace.c.html#LN2405"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * If it is in the path, it might still not be visible; it could be 
         * hidden by another dictionary of the same name earlier in the path. 
         * So we must do a slow check for conflicting dictionaries. 
         */ 
</span><a name="LN2431"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>name</span> <span class='Operator'>= </span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2403"><span class='Ref_To_Local'>form</span></a><span class='Operator'>-&GT;</span>dictname<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2432"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
        <a href="namespace.c.html#LN2405"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2432"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN2437"></a>            <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2432"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2437"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* do not look in temp namespace */ 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2437"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>== </span><span class='Control'>namespace</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Found it first in path */ 
</span>                <a href="namespace.c.html#LN2405"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN175"><span class='Ref_to_Macro'>SearchSysCacheExists2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN100"><span class='Ref_to_EnumConst'>TSDICTNAMENSP</span></a><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2431"><span class='Ref_To_Local'>name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2437"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>)))</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Found something else first in path */ 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2402"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN2405"><span class='Ref_To_Local'>visible</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end TSDictionaryIsVisible &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * get_ts_template_oid - find a TS template by possibly qualified name 
 * 
 * If not found, returns InvalidOid if missing_ok, else throws error 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN2469"></a><span class='Declare_Function'>get_ts_template_oid</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>names</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>missing_ok</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2471"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>schemaname</span><span class='Delimiter'>; 
</span><a name="LN2472"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>template_name</span><span class='Delimiter'>; 
</span><a name="LN2473"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span><span class='Delimiter'>; 
</span><a name="LN2474"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>tmploid</span> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span><a name="LN2475"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* deconstruct the name list */ 
</span>    <a href="../../include/catalog/namespace.h.html#LN109"><span class='Ref_to_Proto'>DeconstructQualifiedName</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2469"><span class='Ref_to_Parameter'>names</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="namespace.c.html#LN2471"><span class='Ref_To_Local'>schemaname</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="namespace.c.html#LN2472"><span class='Ref_To_Local'>template_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2471"><span class='Ref_To_Local'>schemaname</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* use exact schema given */ 
</span>        <a href="namespace.c.html#LN2473"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN113"><span class='Ref_to_Proto'>LookupExplicitNamespace</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2471"><span class='Ref_To_Local'>schemaname</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN2469"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2469"><span class='Ref_to_Parameter'>missing_ok</span></a> <span class='Operator'>&& !</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2473"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span> 
            <a href="namespace.c.html#LN2474"><span class='Ref_To_Local'>tmploid</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="namespace.c.html#LN2474"><span class='Ref_To_Local'>tmploid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN184"><span class='Ref_to_Macro'>GetSysCacheOid2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN104"><span class='Ref_to_EnumConst'>TSTEMPLATENAMENSP</span></a><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2472"><span class='Ref_To_Local'>template_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2473"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* search for it in search path */ 
</span>        <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2475"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="namespace.c.html#LN2473"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2475"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2473"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* do not look in temp namespace */ 
</span> 
            <a href="namespace.c.html#LN2474"><span class='Ref_To_Local'>tmploid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN184"><span class='Ref_to_Macro'>GetSysCacheOid2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN104"><span class='Ref_to_EnumConst'>TSTEMPLATENAMENSP</span></a><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2472"><span class='Ref_To_Local'>template_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2473"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2474"><span class='Ref_To_Local'>tmploid</span></a><span class='Parentheses'>))</span> 
                <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2474"><span class='Ref_To_Local'>tmploid</span></a><span class='Parentheses'>) </span><span class='Operator'>&& !</span><a href="namespace.c.html#LN2469"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>)</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_OBJECT<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"text search template \"%s\" does not exist"</span><span class='Delimiter'>, 
</span>                        <a href="../../include/catalog/namespace.h.html#LN120"><span class='Ref_to_Proto'>NameListToString</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2469"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN2474"><span class='Ref_To_Local'>tmploid</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end get_ts_template_oid &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * TSTemplateIsVisible 
 *      Determine whether a template (identified by OID) is visible in the 
 *      current search path.  Visible means "would be found by searching 
 *      for the unqualified template name". 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN2527"></a><span class='Declare_Function'>TSTemplateIsVisible</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>tmplId</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2529"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tup</span><span class='Delimiter'>; 
</span><a name="LN2530"></a>    <a href="../../include/catalog/pg_ts_template.h.html#LN40"><span class='Ref_to_Typedef'>Form_pg_ts_template</span></a> <span class='Declare_Local'>form</span><span class='Delimiter'>; 
</span><a name="LN2531"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespace</span><span class='Delimiter'>; 
</span><a name="LN2532"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>visible</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN2529"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN105"><span class='Ref_to_EnumConst'>TSTEMPLATEOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2527"><span class='Ref_to_Parameter'>tmplId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2529"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for text search template %u"</span><span class='Delimiter'>, </span><a href="namespace.c.html#LN2527"><span class='Ref_to_Parameter'>tmplId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN2530"><span class='Ref_To_Local'>form</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_template.h.html#LN40"><span class='Ref_to_Typedef'>Form_pg_ts_template</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2529"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Quick check: if it ain't in the path at all, it ain't visible. Items in 
     * the system namespace are surely in the path and so we needn't even do 
     * list_member_oid() for them. 
     */ 
</span>    <span class='Control'>namespace</span> <span class='Operator'>= </span><a href="namespace.c.html#LN2530"><span class='Ref_To_Local'>form</span></a><span class='Operator'>-&GT;</span>tmplnamespace<span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Control'>namespace</span> <span class='Operator'>!= </span><a href="../../include/catalog/pg_namespace.h.html#LN70"><span class='Ref_to_Const'>PG_CATALOG_NAMESPACE</span></a> <span class='Operator'>&& 
</span>        <span class='Operator'>!</span><a href="../../include/nodes/pg_list.h.html#LN231"><span class='Ref_to_Proto'>list_member_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Delimiter'>, </span><span class='Control'>namespace</span><span class='Parentheses'>))</span> 
        <a href="namespace.c.html#LN2532"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * If it is in the path, it might still not be visible; it could be 
         * hidden by another template of the same name earlier in the path. So 
         * we must do a slow check for conflicting templates. 
         */ 
</span><a name="LN2557"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>name</span> <span class='Operator'>= </span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2530"><span class='Ref_To_Local'>form</span></a><span class='Operator'>-&GT;</span>tmplname<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2558"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
        <a href="namespace.c.html#LN2532"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2558"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN2563"></a>            <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2558"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2563"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* do not look in temp namespace */ 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2563"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>== </span><span class='Control'>namespace</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Found it first in path */ 
</span>                <a href="namespace.c.html#LN2532"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN175"><span class='Ref_to_Macro'>SearchSysCacheExists2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN104"><span class='Ref_to_EnumConst'>TSTEMPLATENAMENSP</span></a><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2557"><span class='Ref_To_Local'>name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2563"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>)))</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Found something else first in path */ 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2529"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN2532"><span class='Ref_To_Local'>visible</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end TSTemplateIsVisible &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * get_ts_config_oid - find a TS config by possibly qualified name 
 * 
 * If not found, returns InvalidOid if missing_ok, else throws error 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN2595"></a><span class='Declare_Function'>get_ts_config_oid</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>names</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>missing_ok</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2597"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>schemaname</span><span class='Delimiter'>; 
</span><a name="LN2598"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>config_name</span><span class='Delimiter'>; 
</span><a name="LN2599"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span><span class='Delimiter'>; 
</span><a name="LN2600"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>cfgoid</span> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span><a name="LN2601"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* deconstruct the name list */ 
</span>    <a href="../../include/catalog/namespace.h.html#LN109"><span class='Ref_to_Proto'>DeconstructQualifiedName</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2595"><span class='Ref_to_Parameter'>names</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="namespace.c.html#LN2597"><span class='Ref_To_Local'>schemaname</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="namespace.c.html#LN2598"><span class='Ref_To_Local'>config_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2597"><span class='Ref_To_Local'>schemaname</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* use exact schema given */ 
</span>        <a href="namespace.c.html#LN2599"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN113"><span class='Ref_to_Proto'>LookupExplicitNamespace</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2597"><span class='Ref_To_Local'>schemaname</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN2595"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2595"><span class='Ref_to_Parameter'>missing_ok</span></a> <span class='Operator'>&& !</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2599"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span> 
            <a href="namespace.c.html#LN2600"><span class='Ref_To_Local'>cfgoid</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="namespace.c.html#LN2600"><span class='Ref_To_Local'>cfgoid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN184"><span class='Ref_to_Macro'>GetSysCacheOid2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN98"><span class='Ref_to_EnumConst'>TSCONFIGNAMENSP</span></a><span class='Delimiter'>, 
</span>                                     <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2598"><span class='Ref_To_Local'>config_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                     <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2599"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* search for it in search path */ 
</span>        <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2601"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="namespace.c.html#LN2599"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2601"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2599"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* do not look in temp namespace */ 
</span> 
            <a href="namespace.c.html#LN2600"><span class='Ref_To_Local'>cfgoid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN184"><span class='Ref_to_Macro'>GetSysCacheOid2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN98"><span class='Ref_to_EnumConst'>TSCONFIGNAMENSP</span></a><span class='Delimiter'>, 
</span>                                     <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2598"><span class='Ref_To_Local'>config_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                     <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2599"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2600"><span class='Ref_To_Local'>cfgoid</span></a><span class='Parentheses'>))</span> 
                <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2600"><span class='Ref_To_Local'>cfgoid</span></a><span class='Parentheses'>) </span><span class='Operator'>&& !</span><a href="namespace.c.html#LN2595"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>)</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_OBJECT<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"text search configuration \"%s\" does not exist"</span><span class='Delimiter'>, 
</span>                        <a href="../../include/catalog/namespace.h.html#LN120"><span class='Ref_to_Proto'>NameListToString</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2595"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN2600"><span class='Ref_To_Local'>cfgoid</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end get_ts_config_oid &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * TSConfigIsVisible 
 *      Determine whether a text search configuration (identified by OID) 
 *      is visible in the current search path.  Visible means "would be found 
 *      by searching for the unqualified text search configuration name". 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN2653"></a><span class='Declare_Function'>TSConfigIsVisible</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>cfgid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2655"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tup</span><span class='Delimiter'>; 
</span><a name="LN2656"></a>    <a href="../../include/catalog/pg_ts_config.h.html#LN40"><span class='Ref_to_Typedef'>Form_pg_ts_config</span></a> <span class='Declare_Local'>form</span><span class='Delimiter'>; 
</span><a name="LN2657"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespace</span><span class='Delimiter'>; 
</span><a name="LN2658"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>visible</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN2655"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN99"><span class='Ref_to_EnumConst'>TSCONFIGOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2653"><span class='Ref_to_Parameter'>cfgid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2655"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for text search configuration %u"</span><span class='Delimiter'>, 
</span>             <a href="namespace.c.html#LN2653"><span class='Ref_to_Parameter'>cfgid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN2656"><span class='Ref_To_Local'>form</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_config.h.html#LN40"><span class='Ref_to_Typedef'>Form_pg_ts_config</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2655"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Quick check: if it ain't in the path at all, it ain't visible. Items in 
     * the system namespace are surely in the path and so we needn't even do 
     * list_member_oid() for them. 
     */ 
</span>    <span class='Control'>namespace</span> <span class='Operator'>= </span><a href="namespace.c.html#LN2656"><span class='Ref_To_Local'>form</span></a><span class='Operator'>-&GT;</span>cfgnamespace<span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Control'>namespace</span> <span class='Operator'>!= </span><a href="../../include/catalog/pg_namespace.h.html#LN70"><span class='Ref_to_Const'>PG_CATALOG_NAMESPACE</span></a> <span class='Operator'>&& 
</span>        <span class='Operator'>!</span><a href="../../include/nodes/pg_list.h.html#LN231"><span class='Ref_to_Proto'>list_member_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Delimiter'>, </span><span class='Control'>namespace</span><span class='Parentheses'>))</span> 
        <a href="namespace.c.html#LN2658"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * If it is in the path, it might still not be visible; it could be 
         * hidden by another configuration of the same name earlier in the 
         * path. So we must do a slow check for conflicting configurations. 
         */ 
</span><a name="LN2684"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>name</span> <span class='Operator'>= </span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2656"><span class='Ref_To_Local'>form</span></a><span class='Operator'>-&GT;</span>cfgname<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2685"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
        <a href="namespace.c.html#LN2658"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2685"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN2690"></a>            <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2685"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2690"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* do not look in temp namespace */ 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2690"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>== </span><span class='Control'>namespace</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Found it first in path */ 
</span>                <a href="namespace.c.html#LN2658"><span class='Ref_To_Local'>visible</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN175"><span class='Ref_to_Macro'>SearchSysCacheExists2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN98"><span class='Ref_to_EnumConst'>TSCONFIGNAMENSP</span></a><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2684"><span class='Ref_To_Local'>name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2690"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>)))</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Found something else first in path */ 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2655"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN2658"><span class='Ref_To_Local'>visible</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end TSConfigIsVisible &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * DeconstructQualifiedName 
 *      Given a possibly-qualified name expressed as a list of String nodes, 
 *      extract the schema name and object name. 
 * 
 * *nspname_p is set to NULL if there is no explicit schema name. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN2725"></a><span class='Declare_Function'>DeconstructQualifiedName</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>names</span><span class='Delimiter'>, 
</span><a name="LN2726"></a>                         <span class='Keyword'>char </span><span class='Operator'>**</span><span class='Declare_Parameter'>nspname_p</span><span class='Delimiter'>, 
</span><a name="LN2727"></a>                         <span class='Keyword'>char </span><span class='Operator'>**</span><span class='Declare_Parameter'>objname_p</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2729"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>catalogname</span><span class='Delimiter'>; 
</span><a name="LN2730"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>schemaname</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN2731"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>objname</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2725"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <span class='Number'>1</span><span class='Operator'>: 
</span>            <a href="namespace.c.html#LN2731"><span class='Ref_To_Local'>objname</span></a> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2725"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <span class='Number'>2</span><span class='Operator'>: 
</span>            <a href="namespace.c.html#LN2730"><span class='Ref_To_Local'>schemaname</span></a> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2725"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="namespace.c.html#LN2731"><span class='Ref_To_Local'>objname</span></a> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN115"><span class='Ref_to_Macro'>lsecond</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2725"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <span class='Number'>3</span><span class='Operator'>: 
</span>            <a href="namespace.c.html#LN2729"><span class='Ref_To_Local'>catalogname</span></a> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2725"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="namespace.c.html#LN2730"><span class='Ref_To_Local'>schemaname</span></a> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN115"><span class='Ref_to_Macro'>lsecond</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2725"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="namespace.c.html#LN2731"><span class='Ref_To_Local'>objname</span></a> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN120"><span class='Ref_to_Macro'>lthird</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2725"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * We check the catalog name and then ignore it. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="namespace.c.html#LN2729"><span class='Ref_To_Local'>catalogname</span></a><span class='Delimiter'>, </span><a href="../../include/commands/dbcommands.h.html#LN29"><span class='Ref_to_Proto'>get_database_name</span></a><span class='Parentheses'>(</span><a href="../utils/init/globals.c.html#LN76"><span class='Ref_to_Global_Var'>MyDatabaseId</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                  <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cross-database references are not implemented: %s"</span><span class='Delimiter'>, 
</span>                         <a href="../../include/catalog/namespace.h.html#LN120"><span class='Ref_to_Proto'>NameListToString</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2725"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"improper qualified name (too many dotted names): %s"</span><span class='Delimiter'>, 
</span>                       <a href="../../include/catalog/namespace.h.html#LN120"><span class='Ref_to_Proto'>NameListToString</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2725"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch list_length(names) &raquo; </span> 
 
    <span class='Operator'>*</span><a href="namespace.c.html#LN2726"><span class='Ref_to_Parameter'>nspname_p</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN2730"><span class='Ref_To_Local'>schemaname</span></a><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="namespace.c.html#LN2727"><span class='Ref_to_Parameter'>objname_p</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN2731"><span class='Ref_To_Local'>objname</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end DeconstructQualifiedName &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * LookupNamespaceNoError 
 *      Look up a schema name. 
 * 
 * Returns the namespace OID, or InvalidOid if not found. 
 * 
 * Note this does NOT perform any permissions check --- callers are 
 * responsible for being sure that an appropriate check is made. 
 * In the majority of cases LookupExplicitNamespace is preferable. 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN2779"></a><span class='Declare_Function'>LookupNamespaceNoError</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>nspname</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* check for pg_temp alias */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="namespace.c.html#LN2779"><span class='Ref_to_Parameter'>nspname</span></a><span class='Delimiter'>, </span><span class='String'>"pg_temp"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="../../include/catalog/objectaccess.h.html#LN173"><span class='Ref_to_Macro'>InvokeNamespaceSearchHook</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Since this is used only for looking up existing objects, there is 
         * no point in trying to initialize the temp namespace here; and doing 
         * so might create problems for some callers. Just report "not found". 
         */ 
</span>        <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="../../include/catalog/namespace.h.html#LN114"><span class='Ref_to_Proto'>get_namespace_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2779"><span class='Ref_to_Parameter'>nspname</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end LookupNamespaceNoError &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * LookupExplicitNamespace 
 *      Process an explicitly-specified schema name: look up the schema 
 *      and verify we have USAGE (lookup) rights in it. 
 * 
 * Returns the namespace OID 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN2809"></a><span class='Declare_Function'>LookupExplicitNamespace</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>nspname</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>missing_ok</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2811"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span><span class='Delimiter'>; 
</span><a name="LN2812"></a>    <a href="../../include/utils/acl.h.html#LN169"><span class='Ref_to_Typedef'>AclResult</span></a>   <span class='Declare_Local'>aclresult</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* check for pg_temp alias */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="namespace.c.html#LN2809"><span class='Ref_to_Parameter'>nspname</span></a><span class='Delimiter'>, </span><span class='String'>"pg_temp"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Since this is used only for looking up existing objects, there is 
         * no point in trying to initialize the temp namespace here; and doing 
         * so might create problems for some callers --- just fall through. 
         */ 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="namespace.c.html#LN2811"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN114"><span class='Ref_to_Proto'>get_namespace_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2809"><span class='Ref_to_Parameter'>nspname</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN2809"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2809"><span class='Ref_to_Parameter'>missing_ok</span></a> <span class='Operator'>&& !</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2811"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN2812"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>= </span><a href="../../include/utils/acl.h.html#LN289"><span class='Ref_to_Proto'>pg_namespace_aclcheck</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2811"><span class='Ref_To_Local'>namespaceId</span></a><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN79"><span class='Ref_to_Const'>ACL_USAGE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2812"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>!= </span><a href="../../include/utils/acl.h.html#LN171"><span class='Ref_to_EnumConst'>ACLCHECK_OK</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/acl.h.html#LN295"><span class='Ref_to_Proto'>aclcheck_error</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2812"><span class='Ref_To_Local'>aclresult</span></a><span class='Delimiter'>, </span><a href="../../include/utils/acl.h.html#LN189"><span class='Ref_to_EnumConst'>ACL_KIND_NAMESPACE</span></a><span class='Delimiter'>, 
</span>                       <a href="namespace.c.html#LN2809"><span class='Ref_to_Parameter'>nspname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* Schema search hook for this lookup */ 
</span>    <a href="../../include/catalog/objectaccess.h.html#LN173"><span class='Ref_to_Macro'>InvokeNamespaceSearchHook</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2811"><span class='Ref_To_Local'>namespaceId</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN2811"><span class='Ref_To_Local'>namespaceId</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end LookupExplicitNamespace &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * LookupCreationNamespace 
 *      Look up the schema and verify we have CREATE rights on it. 
 * 
 * This is just like LookupExplicitNamespace except for the different 
 * permission check, and that we are willing to create pg_temp if needed. 
 * 
 * Note: calling this may result in a CommandCounterIncrement operation, 
 * if we have to create or clean out the temp namespace. 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN2852"></a><span class='Declare_Function'>LookupCreationNamespace</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>nspname</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2854"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span><span class='Delimiter'>; 
</span><a name="LN2855"></a>    <a href="../../include/utils/acl.h.html#LN169"><span class='Ref_to_Typedef'>AclResult</span></a>   <span class='Declare_Local'>aclresult</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* check for pg_temp alias */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="namespace.c.html#LN2852"><span class='Ref_to_Parameter'>nspname</span></a><span class='Delimiter'>, </span><span class='String'>"pg_temp"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Initialize temp namespace if first time through */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>))</span> 
            <a href="namespace.c.html#LN195"><span class='Ref_to_Proto'>InitTempTableNamespace</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="namespace.c.html#LN2854"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN114"><span class='Ref_to_Proto'>get_namespace_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2852"><span class='Ref_to_Parameter'>nspname</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN2855"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>= </span><a href="../../include/utils/acl.h.html#LN289"><span class='Ref_to_Proto'>pg_namespace_aclcheck</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2854"><span class='Ref_To_Local'>namespaceId</span></a><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN81"><span class='Ref_to_Const'>ACL_CREATE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2855"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>!= </span><a href="../../include/utils/acl.h.html#LN171"><span class='Ref_to_EnumConst'>ACLCHECK_OK</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/acl.h.html#LN295"><span class='Ref_to_Proto'>aclcheck_error</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2855"><span class='Ref_To_Local'>aclresult</span></a><span class='Delimiter'>, </span><a href="../../include/utils/acl.h.html#LN189"><span class='Ref_to_EnumConst'>ACL_KIND_NAMESPACE</span></a><span class='Delimiter'>, 
</span>                       <a href="namespace.c.html#LN2852"><span class='Ref_to_Parameter'>nspname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN2854"><span class='Ref_To_Local'>namespaceId</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end LookupCreationNamespace &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Common checks on switching namespaces. 
 * 
 * We complain if either the old or new namespaces is a temporary schema 
 * (or temporary toast schema), or if either the old or new namespaces is the 
 * TOAST schema. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN2884"></a><span class='Declare_Function'>CheckSetNamespace</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>oldNspOid</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>nspOid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* disallow renaming into or out of temp schemas */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN126"><span class='Ref_to_Proto'>isAnyTempNamespace</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2884"><span class='Ref_to_Parameter'>nspOid</span></a><span class='Parentheses'>) </span><span class='Operator'>|| </span><a href="../../include/catalog/namespace.h.html#LN126"><span class='Ref_to_Proto'>isAnyTempNamespace</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2884"><span class='Ref_to_Parameter'>oldNspOid</span></a><span class='Parentheses'>))</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>            <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot move objects into or out of temporary schemas"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* same for TOAST schema */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2884"><span class='Ref_to_Parameter'>nspOid</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_namespace.h.html#LN73"><span class='Ref_to_Const'>PG_TOAST_NAMESPACE</span></a> <span class='Operator'>|| </span><a href="namespace.c.html#LN2884"><span class='Ref_to_Parameter'>oldNspOid</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_namespace.h.html#LN73"><span class='Ref_to_Const'>PG_TOAST_NAMESPACE</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot move objects into or out of TOAST schema"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * QualifiedNameGetCreationNamespace 
 *      Given a possibly-qualified name for an object (in List-of-Values 
 *      format), determine what namespace the object should be created in. 
 *      Also extract and return the object name (last component of list). 
 * 
 * Note: this does not apply any permissions check.  Callers must check 
 * for CREATE rights on the selected namespace when appropriate. 
 * 
 * Note: calling this may result in a CommandCounterIncrement operation, 
 * if we have to create or clean out the temp namespace. 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN2912"></a><span class='Declare_Function'>QualifiedNameGetCreationNamespace</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>names</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>**</span><span class='Declare_Parameter'>objname_p</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2914"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>schemaname</span><span class='Delimiter'>; 
</span><a name="LN2915"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* deconstruct the name list */ 
</span>    <a href="../../include/catalog/namespace.h.html#LN109"><span class='Ref_to_Proto'>DeconstructQualifiedName</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2912"><span class='Ref_to_Parameter'>names</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="namespace.c.html#LN2914"><span class='Ref_To_Local'>schemaname</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN2912"><span class='Ref_to_Parameter'>objname_p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN2914"><span class='Ref_To_Local'>schemaname</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* check for pg_temp alias */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="namespace.c.html#LN2914"><span class='Ref_To_Local'>schemaname</span></a><span class='Delimiter'>, </span><span class='String'>"pg_temp"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Initialize temp namespace if first time through */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>))</span> 
                <a href="namespace.c.html#LN195"><span class='Ref_to_Proto'>InitTempTableNamespace</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Comment_Multi_Line'>/* use exact schema given */ 
</span>        <a href="namespace.c.html#LN2915"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN114"><span class='Ref_to_Proto'>get_namespace_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2914"><span class='Ref_To_Local'>schemaname</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* we do not check for USAGE rights here! */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* use the default creation namespace */ 
</span>        <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN139"><span class='Ref_to_Global_Var'>activeTempCreationPending</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Need to initialize temp namespace */ 
</span>            <a href="namespace.c.html#LN195"><span class='Ref_to_Proto'>InitTempTableNamespace</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="namespace.c.html#LN2915"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN136"><span class='Ref_to_Global_Var'>activeCreationNamespace</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2915"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_SCHEMA<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"no schema has been selected to create in"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN2915"><span class='Ref_To_Local'>namespaceId</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end QualifiedNameGetCreationNamespace &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * get_namespace_oid - given a namespace name, look up the OID 
 * 
 * If missing_ok is false, throw an error if namespace name not found.  If 
 * true, just return InvalidOid. 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN2961"></a><span class='Declare_Function'>get_namespace_oid</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>nspname</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>missing_ok</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2963"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>oid</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN2963"><span class='Ref_To_Local'>oid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN182"><span class='Ref_to_Macro'>GetSysCacheOid1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN68"><span class='Ref_to_EnumConst'>NAMESPACENAME</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN583"><span class='Ref_to_Macro'>CStringGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2961"><span class='Ref_to_Parameter'>nspname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2963"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>) </span><span class='Operator'>&& !</span><a href="namespace.c.html#LN2961"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>)</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_SCHEMA<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"schema \"%s\" does not exist"</span><span class='Delimiter'>, </span><a href="namespace.c.html#LN2961"><span class='Ref_to_Parameter'>nspname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN2963"><span class='Ref_To_Local'>oid</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * makeRangeVarFromNameList 
 *      Utility routine to convert a qualified-name list into RangeVar form. 
 */ 
</span><a href="../../include/nodes/primnodes.h.html#LN62"><span class='Ref_to_Struct'>RangeVar</span></a> <span class='Operator'>* 
</span><a name="LN2979"></a><span class='Declare_Function'>makeRangeVarFromNameList</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>names</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2981"></a>    <a href="../../include/nodes/primnodes.h.html#LN62"><span class='Ref_to_Struct'>RangeVar</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>rel</span> <span class='Operator'>= </span><a href="../../include/nodes/makefuncs.h.html#LN68"><span class='Ref_to_Proto'>makeRangeVar</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2979"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <span class='Number'>1</span><span class='Operator'>: 
</span>            <a href="namespace.c.html#LN2981"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2979"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <span class='Number'>2</span><span class='Operator'>: 
</span>            <a href="namespace.c.html#LN2981"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2979"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="namespace.c.html#LN2981"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN115"><span class='Ref_to_Macro'>lsecond</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2979"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <span class='Number'>3</span><span class='Operator'>: 
</span>            <a href="namespace.c.html#LN2981"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN65"><span class='Ref_to_Member'>catalogname</span></a> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2979"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="namespace.c.html#LN2981"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN115"><span class='Ref_to_Macro'>lsecond</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2979"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="namespace.c.html#LN2981"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN120"><span class='Ref_to_Macro'>lthird</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2979"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"improper relation name (too many dotted names): %s"</span><span class='Delimiter'>, 
</span>                        <a href="../../include/catalog/namespace.h.html#LN120"><span class='Ref_to_Proto'>NameListToString</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN2979"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch list_length(names) &raquo; </span> 
 
    <span class='Control'>return</span> <a href="namespace.c.html#LN2981"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end makeRangeVarFromNameList &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * NameListToString 
 *      Utility routine to convert a qualified-name list into a string. 
 * 
 * This is used primarily to form error messages, and so we do not quote 
 * the list elements, for the sake of legibility. 
 * 
 * In most scenarios the list elements should always be Value strings, 
 * but we also allow A_Star for the convenience of ColumnRef processing. 
 */ 
</span><span class='Keyword'>char </span><span class='Operator'>* 
</span><a name="LN3019"></a><span class='Declare_Function'>NameListToString</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>names</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3021"></a>    <a href="../../include/lib/stringinfo.h.html#LN34"><span class='Ref_to_Struct'>StringInfoData</span></a> <span class='Declare_Local'>string</span><span class='Delimiter'>; 
</span><a name="LN3022"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <a href="../lib/stringinfo.c.html#LN44"><span class='Ref_to_Func'>initStringInfo</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="namespace.c.html#LN3021"><span class='Ref_To_Local'>string</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3022"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN3019"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3028"></a>        <a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>name</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3022"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3022"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/pg_list.h.html#LN75"><span class='Ref_to_Func'>list_head</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3019"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>))</span> 
            <a href="../replication/syncrep_scanner.l.html#LN76"><span class='Ref_to_Proto'>appendStringInfoChar</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="namespace.c.html#LN3021"><span class='Ref_To_Local'>string</span></a><span class='Delimiter'>, </span><span class='String'>'.'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3028"><span class='Ref_To_Local'>name</span></a><span class='Delimiter'>, </span>String<span class='Parentheses'>))</span> 
            <a href="../../bin/pg_waldump/compat.c.html#LN79"><span class='Ref_to_Func'>appendStringInfoString</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="namespace.c.html#LN3021"><span class='Ref_To_Local'>string</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3028"><span class='Ref_To_Local'>name</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3028"><span class='Ref_To_Local'>name</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN367"><span class='Ref_to_Struct'>A_Star</span></a><span class='Parentheses'>))</span> 
            <a href="../replication/syncrep_scanner.l.html#LN76"><span class='Ref_to_Proto'>appendStringInfoChar</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="namespace.c.html#LN3021"><span class='Ref_To_Local'>string</span></a><span class='Delimiter'>, </span><span class='String'>'*'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unexpected node type in name list: %d"</span><span class='Delimiter'>, 
</span>                 <span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="../../include/nodes/nodes.h.html#LN513"><span class='Ref_to_Macro'>nodeTag</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3028"><span class='Ref_To_Local'>name</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN3021"><span class='Ref_To_Local'>string</span></a><span class='Operator'>.</span><a href="../../include/lib/stringinfo.h.html#LN36"><span class='Ref_to_Member'>data</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end NameListToString &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * NameListToQuotedString 
 *      Utility routine to convert a qualified-name list into a string. 
 * 
 * Same as above except that names will be double-quoted where necessary, 
 * so the string could be re-parsed (eg, by textToQualifiedNameList). 
 */ 
</span><span class='Keyword'>char </span><span class='Operator'>* 
</span><a name="LN3053"></a><span class='Declare_Function'>NameListToQuotedString</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>names</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3055"></a>    <a href="../../include/lib/stringinfo.h.html#LN34"><span class='Ref_to_Struct'>StringInfoData</span></a> <span class='Declare_Local'>string</span><span class='Delimiter'>; 
</span><a name="LN3056"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <a href="../lib/stringinfo.c.html#LN44"><span class='Ref_to_Func'>initStringInfo</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="namespace.c.html#LN3055"><span class='Ref_To_Local'>string</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3056"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN3053"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3056"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/pg_list.h.html#LN75"><span class='Ref_to_Func'>list_head</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3053"><span class='Ref_to_Parameter'>names</span></a><span class='Parentheses'>))</span> 
            <a href="../replication/syncrep_scanner.l.html#LN76"><span class='Ref_to_Proto'>appendStringInfoChar</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="namespace.c.html#LN3055"><span class='Ref_To_Local'>string</span></a><span class='Delimiter'>, </span><span class='String'>'.'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../bin/pg_waldump/compat.c.html#LN79"><span class='Ref_to_Func'>appendStringInfoString</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="namespace.c.html#LN3055"><span class='Ref_To_Local'>string</span></a><span class='Delimiter'>, </span><a href="../../include/utils/builtins.h.html#LN77"><span class='Ref_to_Proto'>quote_identifier</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3056"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN3055"><span class='Ref_To_Local'>string</span></a><span class='Operator'>.</span><a href="../../include/lib/stringinfo.h.html#LN36"><span class='Ref_to_Member'>data</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * isTempNamespace - is the given namespace my temporary-table namespace? 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN3074"></a><span class='Declare_Function'>isTempNamespace</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>namespaceId</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN3074"><span class='Ref_to_Parameter'>namespaceId</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * isTempToastNamespace - is the given namespace my temporary-toast-table 
 *      namespace? 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN3086"></a><span class='Declare_Function'>isTempToastNamespace</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>namespaceId</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN182"><span class='Ref_to_Global_Var'>myTempToastNamespace</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><a href="namespace.c.html#LN182"><span class='Ref_to_Global_Var'>myTempToastNamespace</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN3086"><span class='Ref_to_Parameter'>namespaceId</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * isTempOrTempToastNamespace - is the given namespace my temporary-table 
 *      namespace or my temporary-toast-table namespace? 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN3098"></a><span class='Declare_Function'>isTempOrTempToastNamespace</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>namespaceId</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>     <span class='Parentheses'>(</span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN3098"><span class='Ref_to_Parameter'>namespaceId</span></a> <span class='Operator'>|| </span><a href="namespace.c.html#LN182"><span class='Ref_to_Global_Var'>myTempToastNamespace</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN3098"><span class='Ref_to_Parameter'>namespaceId</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * isAnyTempNamespace - is the given namespace a temporary-table namespace 
 * (either my own, or another backend's)?  Temporary-toast-table namespaces 
 * are included, too. 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN3112"></a><span class='Declare_Function'>isAnyTempNamespace</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>namespaceId</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3114"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN3115"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>nspname</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* True if the namespace name starts with "pg_temp_" or "pg_toast_temp_" */ 
</span>    <a href="namespace.c.html#LN3115"><span class='Ref_To_Local'>nspname</span></a> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN175"><span class='Ref_to_Proto'>get_namespace_name</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3112"><span class='Ref_to_Parameter'>namespaceId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="namespace.c.html#LN3115"><span class='Ref_To_Local'>nspname</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* no such namespace? */ 
</span>    <a href="namespace.c.html#LN3114"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span>strncmp<span class='Parentheses'>(</span><a href="namespace.c.html#LN3115"><span class='Ref_To_Local'>nspname</span></a><span class='Delimiter'>, </span><span class='String'>"pg_temp_"</span><span class='Delimiter'>, </span><span class='Number'>8</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> <span class='Operator'>|| 
</span>        <span class='Parentheses'>(</span>strncmp<span class='Parentheses'>(</span><a href="namespace.c.html#LN3115"><span class='Ref_To_Local'>nspname</span></a><span class='Delimiter'>, </span><span class='String'>"pg_toast_temp_"</span><span class='Delimiter'>, </span><span class='Number'>14</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3115"><span class='Ref_To_Local'>nspname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="namespace.c.html#LN3114"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * isOtherTempNamespace - is the given namespace some other backend's 
 * temporary-table namespace (including temporary-toast-table namespaces)? 
 * 
 * Note: for most purposes in the C code, this function is obsolete.  Use 
 * RELATION_IS_OTHER_TEMP() instead to detect non-local temp relations. 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN3135"></a><span class='Declare_Function'>isOtherTempNamespace</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>namespaceId</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* If it's my own temp namespace, say "false" */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN125"><span class='Ref_to_Proto'>isTempOrTempToastNamespace</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3135"><span class='Ref_to_Parameter'>namespaceId</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* Else, if it's any temp namespace, say "true" */ 
</span>    <span class='Control'>return</span> <a href="../../include/catalog/namespace.h.html#LN126"><span class='Ref_to_Proto'>isAnyTempNamespace</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3135"><span class='Ref_to_Parameter'>namespaceId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * GetTempNamespaceBackendId - if the given namespace is a temporary-table 
 * namespace (either my own, or another backend's), return the BackendId 
 * that owns it.  Temporary-toast-table namespaces are included, too. 
 * If it isn't a temp namespace, return InvalidBackendId. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN3151"></a><span class='Declare_Function'>GetTempNamespaceBackendId</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>namespaceId</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3153"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN3154"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>nspname</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* See if the namespace name starts with "pg_temp_" or "pg_toast_temp_" */ 
</span>    <a href="namespace.c.html#LN3154"><span class='Ref_To_Local'>nspname</span></a> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN175"><span class='Ref_to_Proto'>get_namespace_name</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3151"><span class='Ref_to_Parameter'>namespaceId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="namespace.c.html#LN3154"><span class='Ref_To_Local'>nspname</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="../../include/storage/backendid.h.html#LN22"><span class='Ref_to_Const'>InvalidBackendId</span></a><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* no such namespace? */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>strncmp<span class='Parentheses'>(</span><a href="namespace.c.html#LN3154"><span class='Ref_To_Local'>nspname</span></a><span class='Delimiter'>, </span><span class='String'>"pg_temp_"</span><span class='Delimiter'>, </span><span class='Number'>8</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="namespace.c.html#LN3153"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span>atoi<span class='Parentheses'>(</span><a href="namespace.c.html#LN3154"><span class='Ref_To_Local'>nspname</span></a> <span class='Operator'>+ </span><span class='Number'>8</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strncmp<span class='Parentheses'>(</span><a href="namespace.c.html#LN3154"><span class='Ref_To_Local'>nspname</span></a><span class='Delimiter'>, </span><span class='String'>"pg_toast_temp_"</span><span class='Delimiter'>, </span><span class='Number'>14</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="namespace.c.html#LN3153"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span>atoi<span class='Parentheses'>(</span><a href="namespace.c.html#LN3154"><span class='Ref_To_Local'>nspname</span></a> <span class='Operator'>+ </span><span class='Number'>14</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="namespace.c.html#LN3153"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/storage/backendid.h.html#LN22"><span class='Ref_to_Const'>InvalidBackendId</span></a><span class='Delimiter'>; 
</span>    <a href="../../include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3154"><span class='Ref_To_Local'>nspname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="namespace.c.html#LN3153"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * GetTempToastNamespace - get the OID of my temporary-toast-table namespace, 
 * which must already be assigned.  (This is only used when creating a toast 
 * table for a temp table, so we must have already done InitTempTableNamespace) 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN3176"></a><span class='Declare_Function'>GetTempToastNamespace</span><span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN182"><span class='Ref_to_Global_Var'>myTempToastNamespace</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="namespace.c.html#LN182"><span class='Ref_to_Global_Var'>myTempToastNamespace</span></a><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * GetTempNamespaceState - fetch status of session's temporary namespace 
 * 
 * This is used for conveying state to a parallel worker, and is not meant 
 * for general-purpose access. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN3190"></a><span class='Declare_Function'>GetTempNamespaceState</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tempNamespaceId</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tempToastNamespaceId</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* Return namespace OIDs, or 0 if session has not created temp namespace */ 
</span>    <span class='Operator'>*</span><a href="namespace.c.html#LN3190"><span class='Ref_to_Parameter'>tempNamespaceId</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="namespace.c.html#LN3190"><span class='Ref_to_Parameter'>tempToastNamespaceId</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN182"><span class='Ref_to_Global_Var'>myTempToastNamespace</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * SetTempNamespaceState - set status of session's temporary namespace 
 * 
 * This is used for conveying state to a parallel worker, and is not meant for 
 * general-purpose access.  By transferring these namespace OIDs to workers, 
 * we ensure they will have the same notion of the search path as their leader 
 * does. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN3206"></a><span class='Declare_Function'>SetTempNamespaceState</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>tempNamespaceId</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>tempToastNamespaceId</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* Worker should not have created its own namespaces ... */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a> <span class='Operator'>== </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="namespace.c.html#LN182"><span class='Ref_to_Global_Var'>myTempToastNamespace</span></a> <span class='Operator'>== </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="namespace.c.html#LN184"><span class='Ref_to_Global_Var'>myTempNamespaceSubID</span></a> <span class='Operator'>== </span><a href="../../include/c.h.html#LN402"><span class='Ref_to_Const'>InvalidSubTransactionId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Assign same namespace OIDs that leader has */ 
</span>    <a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN3206"><span class='Ref_to_Parameter'>tempNamespaceId</span></a><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN182"><span class='Ref_to_Global_Var'>myTempToastNamespace</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN3206"><span class='Ref_to_Parameter'>tempToastNamespaceId</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * It's fine to leave myTempNamespaceSubID == InvalidSubTransactionId. 
     * Even if the namespace is new so far as the leader is concerned, it's 
     * not new to the worker, and we certainly wouldn't want the worker trying 
     * to destroy it. 
     */ 
</span> 
    <a href="namespace.c.html#LN152"><span class='Ref_to_Global_Var'>baseSearchPathValid</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* may need to rebuild list */ 
</span><span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end SetTempNamespaceState &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * GetOverrideSearchPath - fetch current search path definition in form 
 * used by PushOverrideSearchPath. 
 * 
 * The result structure is allocated in the specified memory context 
 * (which might or might not be equal to CurrentMemoryContext); but any 
 * junk created by revalidation calculations will be in CurrentMemoryContext. 
 */ 
</span><a href="../../include/catalog/namespace.h.html#LN42"><span class='Ref_to_Struct'>OverrideSearchPath</span></a> <span class='Operator'>* 
</span><a name="LN3237"></a><span class='Declare_Function'>GetOverrideSearchPath</span><span class='Parentheses'>(</span><a href="../../include/utils/palloc.h.html#LN35"><span class='Ref_to_Typedef'>MemoryContext</span></a> <span class='Declare_Parameter'>context</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3239"></a>    <a href="../../include/catalog/namespace.h.html#LN42"><span class='Ref_to_Struct'>OverrideSearchPath</span></a> <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN3240"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>schemas</span><span class='Delimiter'>; 
</span><a name="LN3241"></a>    <a href="../../include/utils/palloc.h.html#LN35"><span class='Ref_to_Typedef'>MemoryContext</span></a> <span class='Declare_Local'>oldcxt</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN3241"><span class='Ref_To_Local'>oldcxt</span></a> <span class='Operator'>= </span><a href="../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3237"><span class='Ref_to_Parameter'>context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN3239"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN42"><span class='Ref_to_Struct'>OverrideSearchPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN42"><span class='Ref_to_Struct'>OverrideSearchPath</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN3240"><span class='Ref_To_Local'>schemas</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN268"><span class='Ref_to_Proto'>list_copy</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3240"><span class='Ref_To_Local'>schemas</span></a> <span class='Operator'>&& </span><a href="../../include/nodes/pg_list.h.html#LN112"><span class='Ref_to_Macro'>linitial_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3240"><span class='Ref_To_Local'>schemas</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="namespace.c.html#LN136"><span class='Ref_to_Global_Var'>activeCreationNamespace</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN112"><span class='Ref_to_Macro'>linitial_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3240"><span class='Ref_To_Local'>schemas</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>)</span> 
            <a href="namespace.c.html#LN3239"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN46"><span class='Ref_to_Member'>addTemp</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN112"><span class='Ref_to_Macro'>linitial_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3240"><span class='Ref_To_Local'>schemas</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="../../include/catalog/pg_namespace.h.html#LN70"><span class='Ref_to_Const'>PG_CATALOG_NAMESPACE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="namespace.c.html#LN3239"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN45"><span class='Ref_to_Member'>addCatalog</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="namespace.c.html#LN3240"><span class='Ref_To_Local'>schemas</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN237"><span class='Ref_to_Proto'>list_delete_first</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3240"><span class='Ref_To_Local'>schemas</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="namespace.c.html#LN3239"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN44"><span class='Ref_to_Member'>schemas</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN3240"><span class='Ref_To_Local'>schemas</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3241"><span class='Ref_To_Local'>oldcxt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN3239"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end GetOverrideSearchPath &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * CopyOverrideSearchPath - copy the specified OverrideSearchPath. 
 * 
 * The result structure is allocated in CurrentMemoryContext. 
 */ 
</span><a href="../../include/catalog/namespace.h.html#LN42"><span class='Ref_to_Struct'>OverrideSearchPath</span></a> <span class='Operator'>* 
</span><a name="LN3273"></a><span class='Declare_Function'>CopyOverrideSearchPath</span><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN42"><span class='Ref_to_Struct'>OverrideSearchPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3275"></a>    <a href="../../include/catalog/namespace.h.html#LN42"><span class='Ref_to_Struct'>OverrideSearchPath</span></a> <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN3275"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN42"><span class='Ref_to_Struct'>OverrideSearchPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN42"><span class='Ref_to_Struct'>OverrideSearchPath</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN3275"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN44"><span class='Ref_to_Member'>schemas</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN268"><span class='Ref_to_Proto'>list_copy</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3273"><span class='Ref_to_Parameter'>path</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN44"><span class='Ref_to_Member'>schemas</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN3275"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN45"><span class='Ref_to_Member'>addCatalog</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN3273"><span class='Ref_to_Parameter'>path</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN45"><span class='Ref_to_Member'>addCatalog</span></a><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN3275"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN46"><span class='Ref_to_Member'>addTemp</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN3273"><span class='Ref_to_Parameter'>path</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN46"><span class='Ref_to_Member'>addTemp</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN3275"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * OverrideSearchPathMatchesCurrent - does path match current setting? 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN3289"></a><span class='Declare_Function'>OverrideSearchPathMatchesCurrent</span><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN42"><span class='Ref_to_Struct'>OverrideSearchPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3291"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>, 
</span><a name="LN3292"></a>               <span class='Operator'>*</span><span class='Declare_Local'>lcp</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* We scan down the activeSearchPath to see if it matches the input. */ 
</span>    <a href="namespace.c.html#LN3291"><span class='Ref_To_Local'>lc</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN75"><span class='Ref_to_Func'>list_head</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* If path-&GT;addTemp, first item should be my temp namespace. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3289"><span class='Ref_to_Parameter'>path</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN46"><span class='Ref_to_Member'>addTemp</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3291"><span class='Ref_To_Local'>lc</span></a> <span class='Operator'>&& </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3291"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>)</span> 
            <a href="namespace.c.html#LN3291"><span class='Ref_To_Local'>lc</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN104"><span class='Ref_to_Macro'>lnext</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3291"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* If path-&GT;addCatalog, next item should be pg_catalog. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3289"><span class='Ref_to_Parameter'>path</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN45"><span class='Ref_to_Member'>addCatalog</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3291"><span class='Ref_To_Local'>lc</span></a> <span class='Operator'>&& </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3291"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="../../include/catalog/pg_namespace.h.html#LN70"><span class='Ref_to_Const'>PG_CATALOG_NAMESPACE</span></a><span class='Parentheses'>)</span> 
            <a href="namespace.c.html#LN3291"><span class='Ref_To_Local'>lc</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN104"><span class='Ref_to_Macro'>lnext</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3291"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* We should now be looking at the activeCreationNamespace. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN136"><span class='Ref_to_Global_Var'>activeCreationNamespace</span></a> <span class='Operator'>!= </span><span class='Parentheses'>(</span><a href="namespace.c.html#LN3291"><span class='Ref_To_Local'>lc</span></a> <span class='Operator'>? </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3291"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>) </span><span class='Operator'>: </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* The remainder of activeSearchPath should match path-&GT;schemas. */ 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3292"><span class='Ref_To_Local'>lcp</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN3289"><span class='Ref_to_Parameter'>path</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN44"><span class='Ref_to_Member'>schemas</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3291"><span class='Ref_To_Local'>lc</span></a> <span class='Operator'>&& </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3291"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3292"><span class='Ref_To_Local'>lcp</span></a><span class='Parentheses'>))</span> 
            <a href="namespace.c.html#LN3291"><span class='Ref_To_Local'>lc</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN104"><span class='Ref_to_Macro'>lnext</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3291"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3291"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end OverrideSearchPathMatchesCurrent &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * PushOverrideSearchPath - temporarily override the search path 
 * 
 * We allow nested overrides, hence the push/pop terminology.  The GUC 
 * search_path variable is ignored while an override is active. 
 * 
 * It's possible that newpath-&GT;useTemp is set but there is no longer any 
 * active temp namespace, if the path was saved during a transaction that 
 * created a temp namespace and was later rolled back.  In that case we just 
 * ignore useTemp.  A plausible alternative would be to create a new temp 
 * namespace, but for existing callers that's not necessary because an empty 
 * temp namespace wouldn't affect their results anyway. 
 * 
 * It's also worth noting that other schemas listed in newpath might not 
 * exist anymore either.  We don't worry about this because OIDs that match 
 * no existing namespace will simply not produce any hits during searches. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN3349"></a><span class='Declare_Function'>PushOverrideSearchPath</span><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN42"><span class='Ref_to_Struct'>OverrideSearchPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>newpath</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3351"></a>    <a href="namespace.c.html#LN156"><span class='Ref_to_Typedef'>OverrideStackEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>entry</span><span class='Delimiter'>; 
</span><a name="LN3352"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>oidlist</span><span class='Delimiter'>; 
</span><a name="LN3353"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>firstNS</span><span class='Delimiter'>; 
</span><a name="LN3354"></a>    <a href="../../include/utils/palloc.h.html#LN35"><span class='Ref_to_Typedef'>MemoryContext</span></a> <span class='Declare_Local'>oldcxt</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Copy the list for safekeeping, and insert implicitly-searched 
     * namespaces as needed.  This code should track recomputeNamespacePath. 
     */ 
</span>    <a href="namespace.c.html#LN3354"><span class='Ref_To_Local'>oldcxt</span></a> <span class='Operator'>= </span><a href="../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="../utils/mmgr/mcxt.c.html#LN42"><span class='Ref_to_Global_Var'>TopMemoryContext</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN3352"><span class='Ref_To_Local'>oidlist</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN268"><span class='Ref_to_Proto'>list_copy</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3349"><span class='Ref_to_Parameter'>newpath</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN44"><span class='Ref_to_Member'>schemas</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Remember the first member of the explicit list. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3352"><span class='Ref_To_Local'>oidlist</span></a> <span class='Operator'>== </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>        <a href="namespace.c.html#LN3353"><span class='Ref_To_Local'>firstNS</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="namespace.c.html#LN3353"><span class='Ref_To_Local'>firstNS</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN112"><span class='Ref_to_Macro'>linitial_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3352"><span class='Ref_To_Local'>oidlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Add any implicitly-searched namespaces to the list.  Note these go on 
     * the front, not the back; also notice that we do not check USAGE 
     * permissions for these. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3349"><span class='Ref_to_Parameter'>newpath</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN45"><span class='Ref_to_Member'>addCatalog</span></a><span class='Parentheses'>) 
</span>        <a href="namespace.c.html#LN3352"><span class='Ref_To_Local'>oidlist</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN217"><span class='Ref_to_Proto'>lcons_oid</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_namespace.h.html#LN70"><span class='Ref_to_Const'>PG_CATALOG_NAMESPACE</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN3352"><span class='Ref_To_Local'>oidlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3349"><span class='Ref_to_Parameter'>newpath</span></a><span class='Operator'>-&GT;</span><a href="../../include/catalog/namespace.h.html#LN46"><span class='Ref_to_Member'>addTemp</span></a> <span class='Operator'>&& </span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>))</span> 
        <a href="namespace.c.html#LN3352"><span class='Ref_To_Local'>oidlist</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN217"><span class='Ref_to_Proto'>lcons_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN3352"><span class='Ref_To_Local'>oidlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Build the new stack entry, then insert it at the head of the list. 
     */ 
</span>    <a href="namespace.c.html#LN3351"><span class='Ref_To_Local'>entry</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="namespace.c.html#LN156"><span class='Ref_to_Typedef'>OverrideStackEntry</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="namespace.c.html#LN156"><span class='Ref_to_Typedef'>OverrideStackEntry</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN3351"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="namespace.c.html#LN158"><span class='Ref_to_Member'>searchPath</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN3352"><span class='Ref_To_Local'>oidlist</span></a><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN3351"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="namespace.c.html#LN159"><span class='Ref_to_Member'>creationNamespace</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN3353"><span class='Ref_To_Local'>firstNS</span></a><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN3351"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="namespace.c.html#LN160"><span class='Ref_to_Member'>nestLevel</span></a> <span class='Operator'>= </span><a href="../../include/access/xact.h.html#LN344"><span class='Ref_to_Proto'>GetCurrentTransactionNestLevel</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN163"><span class='Ref_to_Global_Var'>overrideStack</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN215"><span class='Ref_to_Proto'>lcons</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3351"><span class='Ref_To_Local'>entry</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN163"><span class='Ref_to_Global_Var'>overrideStack</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* And make it active. */ 
</span>    <a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN3351"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="namespace.c.html#LN158"><span class='Ref_to_Member'>searchPath</span></a><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN136"><span class='Ref_to_Global_Var'>activeCreationNamespace</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN3351"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="namespace.c.html#LN159"><span class='Ref_to_Member'>creationNamespace</span></a><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN139"><span class='Ref_to_Global_Var'>activeTempCreationPending</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>;</span>  <span class='Comment_Single_Line'>/* XXX is this OK? */ 
</span> 
    <a href="../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3354"><span class='Ref_To_Local'>oldcxt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PushOverrideSearchPath &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * PopOverrideSearchPath - undo a previous PushOverrideSearchPath 
 * 
 * Any push during a (sub)transaction will be popped automatically at abort. 
 * But it's caller error if a push isn't popped in normal control flow. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN3408"></a><span class='Declare_Function'>PopOverrideSearchPath</span><span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3410"></a>    <a href="namespace.c.html#LN156"><span class='Ref_to_Typedef'>OverrideStackEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>entry</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Sanity checks. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN163"><span class='Ref_to_Global_Var'>overrideStack</span></a> <span class='Operator'>== </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"bogus PopOverrideSearchPath call"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN3410"><span class='Ref_To_Local'>entry</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="namespace.c.html#LN156"><span class='Ref_to_Typedef'>OverrideStackEntry</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN163"><span class='Ref_to_Global_Var'>overrideStack</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3410"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="namespace.c.html#LN160"><span class='Ref_to_Member'>nestLevel</span></a> <span class='Operator'>!= </span><a href="../../include/access/xact.h.html#LN344"><span class='Ref_to_Proto'>GetCurrentTransactionNestLevel</span></a><span class='Parentheses'>())</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"bogus PopOverrideSearchPath call"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Pop the stack and free storage. */ 
</span>    <a href="namespace.c.html#LN163"><span class='Ref_to_Global_Var'>overrideStack</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN237"><span class='Ref_to_Proto'>list_delete_first</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN163"><span class='Ref_to_Global_Var'>overrideStack</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/nodes/pg_list.h.html#LN265"><span class='Ref_to_Proto'>list_free</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3410"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="namespace.c.html#LN158"><span class='Ref_to_Member'>searchPath</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3410"><span class='Ref_To_Local'>entry</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Activate the next level down. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN163"><span class='Ref_to_Global_Var'>overrideStack</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="namespace.c.html#LN3410"><span class='Ref_To_Local'>entry</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="namespace.c.html#LN156"><span class='Ref_to_Typedef'>OverrideStackEntry</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN163"><span class='Ref_to_Global_Var'>overrideStack</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN3410"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="namespace.c.html#LN158"><span class='Ref_to_Member'>searchPath</span></a><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN136"><span class='Ref_to_Global_Var'>activeCreationNamespace</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN3410"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="namespace.c.html#LN159"><span class='Ref_to_Member'>creationNamespace</span></a><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN139"><span class='Ref_to_Global_Var'>activeTempCreationPending</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>;</span>      <span class='Comment_Single_Line'>/* XXX is this OK? */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* If not baseSearchPathValid, this is useless but harmless */ 
</span>        <a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN143"><span class='Ref_to_Global_Var'>baseSearchPath</span></a><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN136"><span class='Ref_to_Global_Var'>activeCreationNamespace</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN145"><span class='Ref_to_Global_Var'>baseCreationNamespace</span></a><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN139"><span class='Ref_to_Global_Var'>activeTempCreationPending</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN147"><span class='Ref_to_Global_Var'>baseTempCreationPending</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end PopOverrideSearchPath &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * get_collation_oid - find a collation by possibly qualified name 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN3446"></a><span class='Declare_Function'>get_collation_oid</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>name</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>missing_ok</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3448"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>schemaname</span><span class='Delimiter'>; 
</span><a name="LN3449"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>collation_name</span><span class='Delimiter'>; 
</span><a name="LN3450"></a>    <a href="../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>dbencoding</span> <span class='Operator'>= </span><a href="../../include/mb/pg_wchar.h.html#LN545"><span class='Ref_to_Proto'>GetDatabaseEncoding</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span><a name="LN3451"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span><span class='Delimiter'>; 
</span><a name="LN3452"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>colloid</span><span class='Delimiter'>; 
</span><a name="LN3453"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* deconstruct the name list */ 
</span>    <a href="../../include/catalog/namespace.h.html#LN109"><span class='Ref_to_Proto'>DeconstructQualifiedName</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3446"><span class='Ref_to_Parameter'>name</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="namespace.c.html#LN3448"><span class='Ref_To_Local'>schemaname</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="namespace.c.html#LN3449"><span class='Ref_To_Local'>collation_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3448"><span class='Ref_To_Local'>schemaname</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* use exact schema given */ 
</span>        <a href="namespace.c.html#LN3451"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN113"><span class='Ref_to_Proto'>LookupExplicitNamespace</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3448"><span class='Ref_To_Local'>schemaname</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN3446"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3446"><span class='Ref_to_Parameter'>missing_ok</span></a> <span class='Operator'>&& !</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3451"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* first try for encoding-specific entry, then any-encoding */ 
</span>        <a href="namespace.c.html#LN3452"><span class='Ref_To_Local'>colloid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN186"><span class='Ref_to_Macro'>GetSysCacheOid3</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN48"><span class='Ref_to_EnumConst'>COLLNAMEENCNSP</span></a><span class='Delimiter'>, 
</span>                                  <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3449"><span class='Ref_To_Local'>collation_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                  <a href="../../include/postgres.h.html#LN484"><span class='Ref_to_Macro'>Int32GetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3450"><span class='Ref_To_Local'>dbencoding</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                  <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3451"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3452"><span class='Ref_To_Local'>colloid</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="namespace.c.html#LN3452"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN3452"><span class='Ref_To_Local'>colloid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN186"><span class='Ref_to_Macro'>GetSysCacheOid3</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN48"><span class='Ref_to_EnumConst'>COLLNAMEENCNSP</span></a><span class='Delimiter'>, 
</span>                                  <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3449"><span class='Ref_To_Local'>collation_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                  <a href="../../include/postgres.h.html#LN484"><span class='Ref_to_Macro'>Int32GetDatum</span></a><span class='Parentheses'>(</span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                  <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3451"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3452"><span class='Ref_To_Local'>colloid</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="namespace.c.html#LN3452"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if schemaname &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* search for it in search path */ 
</span>        <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3453"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="namespace.c.html#LN3451"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3453"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3451"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* do not look in temp namespace */ 
</span> 
            <a href="namespace.c.html#LN3452"><span class='Ref_To_Local'>colloid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN186"><span class='Ref_to_Macro'>GetSysCacheOid3</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN48"><span class='Ref_to_EnumConst'>COLLNAMEENCNSP</span></a><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3449"><span class='Ref_To_Local'>collation_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN484"><span class='Ref_to_Macro'>Int32GetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3450"><span class='Ref_To_Local'>dbencoding</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3451"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3452"><span class='Ref_To_Local'>colloid</span></a><span class='Parentheses'>))</span> 
                <span class='Control'>return</span> <a href="namespace.c.html#LN3452"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>; 
</span>            <a href="namespace.c.html#LN3452"><span class='Ref_To_Local'>colloid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN186"><span class='Ref_to_Macro'>GetSysCacheOid3</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN48"><span class='Ref_to_EnumConst'>COLLNAMEENCNSP</span></a><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3449"><span class='Ref_To_Local'>collation_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN484"><span class='Ref_to_Macro'>Int32GetDatum</span></a><span class='Parentheses'>(</span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3451"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3452"><span class='Ref_To_Local'>colloid</span></a><span class='Parentheses'>))</span> 
                <span class='Control'>return</span> <a href="namespace.c.html#LN3452"><span class='Ref_To_Local'>colloid</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Not found in path */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="namespace.c.html#LN3446"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_OBJECT<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"collation \"%s\" for encoding \"%s\" does not exist"</span><span class='Delimiter'>, 
</span>                        <a href="../../include/catalog/namespace.h.html#LN120"><span class='Ref_to_Proto'>NameListToString</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3446"><span class='Ref_to_Parameter'>name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../../include/mb/pg_wchar.h.html#LN546"><span class='Ref_to_Proto'>GetDatabaseEncodingName</span></a><span class='Parentheses'>())))</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end get_collation_oid &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * get_conversion_oid - find a conversion by possibly qualified name 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN3519"></a><span class='Declare_Function'>get_conversion_oid</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>name</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>missing_ok</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3521"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>schemaname</span><span class='Delimiter'>; 
</span><a name="LN3522"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>conversion_name</span><span class='Delimiter'>; 
</span><a name="LN3523"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span><span class='Delimiter'>; 
</span><a name="LN3524"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>conoid</span> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span><a name="LN3525"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* deconstruct the name list */ 
</span>    <a href="../../include/catalog/namespace.h.html#LN109"><span class='Ref_to_Proto'>DeconstructQualifiedName</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3519"><span class='Ref_to_Parameter'>name</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="namespace.c.html#LN3521"><span class='Ref_To_Local'>schemaname</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="namespace.c.html#LN3522"><span class='Ref_To_Local'>conversion_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3521"><span class='Ref_To_Local'>schemaname</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* use exact schema given */ 
</span>        <a href="namespace.c.html#LN3523"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN113"><span class='Ref_to_Proto'>LookupExplicitNamespace</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3521"><span class='Ref_To_Local'>schemaname</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN3519"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3519"><span class='Ref_to_Parameter'>missing_ok</span></a> <span class='Operator'>&& !</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3523"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span> 
            <a href="namespace.c.html#LN3524"><span class='Ref_To_Local'>conoid</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="namespace.c.html#LN3524"><span class='Ref_To_Local'>conoid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN184"><span class='Ref_to_Macro'>GetSysCacheOid2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN51"><span class='Ref_to_EnumConst'>CONNAMENSP</span></a><span class='Delimiter'>, 
</span>                                     <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3522"><span class='Ref_To_Local'>conversion_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                     <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3523"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* search for it in search path */ 
</span>        <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3525"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="namespace.c.html#LN3523"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3525"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3523"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* do not look in temp namespace */ 
</span> 
            <a href="namespace.c.html#LN3524"><span class='Ref_To_Local'>conoid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN184"><span class='Ref_to_Macro'>GetSysCacheOid2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN51"><span class='Ref_to_EnumConst'>CONNAMENSP</span></a><span class='Delimiter'>, 
</span>                                     <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3522"><span class='Ref_To_Local'>conversion_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                     <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3523"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3524"><span class='Ref_To_Local'>conoid</span></a><span class='Parentheses'>))</span> 
                <span class='Control'>return</span> <a href="namespace.c.html#LN3524"><span class='Ref_To_Local'>conoid</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Not found in path */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3524"><span class='Ref_To_Local'>conoid</span></a><span class='Parentheses'>) </span><span class='Operator'>&& !</span><a href="namespace.c.html#LN3519"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>)</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_OBJECT<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"conversion \"%s\" does not exist"</span><span class='Delimiter'>, 
</span>                        <a href="../../include/catalog/namespace.h.html#LN120"><span class='Ref_to_Proto'>NameListToString</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3519"><span class='Ref_to_Parameter'>name</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="namespace.c.html#LN3524"><span class='Ref_To_Local'>conoid</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end get_conversion_oid &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * FindDefaultConversionProc - find default encoding conversion proc 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN3574"></a><span class='Declare_Function'>FindDefaultConversionProc</span><span class='Parentheses'>(</span><a href="../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Declare_Parameter'>for_encoding</span><span class='Delimiter'>, </span><a href="../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Declare_Parameter'>to_encoding</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3576"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>proc</span><span class='Delimiter'>; 
</span><a name="LN3577"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3577"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3583"></a>        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3577"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3583"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* do not look in temp namespace */ 
</span> 
        <a href="namespace.c.html#LN3576"><span class='Ref_To_Local'>proc</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_conversion_fn.h.html#LN24"><span class='Ref_to_Proto'>FindDefaultConversion</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3583"><span class='Ref_To_Local'>namespaceId</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN3574"><span class='Ref_to_Parameter'>for_encoding</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN3574"><span class='Ref_to_Parameter'>to_encoding</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3576"><span class='Ref_To_Local'>proc</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="namespace.c.html#LN3576"><span class='Ref_To_Local'>proc</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Not found in path */ 
</span>    <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end FindDefaultConversionProc &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * recomputeNamespacePath - recompute path derived variables if needed. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN3601"></a><span class='Declare_Function'>recomputeNamespacePath</span><span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3603"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>roleid</span> <span class='Operator'>= </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span><a name="LN3604"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>rawname</span><span class='Delimiter'>; 
</span><a name="LN3605"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>namelist</span><span class='Delimiter'>; 
</span><a name="LN3606"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>oidlist</span><span class='Delimiter'>; 
</span><a name="LN3607"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>newpath</span><span class='Delimiter'>; 
</span><a name="LN3608"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span><a name="LN3609"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>temp_missing</span><span class='Delimiter'>; 
</span><a name="LN3610"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>firstNS</span><span class='Delimiter'>; 
</span><a name="LN3611"></a>    <a href="../../include/utils/palloc.h.html#LN35"><span class='Ref_to_Typedef'>MemoryContext</span></a> <span class='Declare_Local'>oldcxt</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Do nothing if an override search spec is active. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN163"><span class='Ref_to_Global_Var'>overrideStack</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Do nothing if path is already valid. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN152"><span class='Ref_to_Global_Var'>baseSearchPathValid</span></a> <span class='Operator'>&& </span><a href="namespace.c.html#LN149"><span class='Ref_to_Global_Var'>namespaceUser</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN3603"><span class='Ref_To_Local'>roleid</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Need a modifiable copy of namespace_search_path string */ 
</span>    <a href="namespace.c.html#LN3604"><span class='Ref_To_Local'>rawname</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN190"><span class='Ref_to_Global_Var'>namespace_search_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Parse string into list of identifiers */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/varlena.h.html#LN29"><span class='Ref_to_Proto'>SplitIdentifierString</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3604"><span class='Ref_To_Local'>rawname</span></a><span class='Delimiter'>, </span><span class='String'>','</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="namespace.c.html#LN3605"><span class='Ref_To_Local'>namelist</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* syntax error in name list */ 
</span>        <span class='Comment_Multi_Line'>/* this should not happen if GUC checked check_search_path */ 
</span>        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"invalid list syntax"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Convert the list of names to a list of OIDs.  If any names are not 
     * recognizable or we don't have read access, just leave them out of the 
     * list.  (We can't raise an error, since the search_path setting has 
     * already been accepted.)  Don't make duplicate entries, either. 
     */ 
</span>    <a href="namespace.c.html#LN3606"><span class='Ref_To_Local'>oidlist</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN3609"><span class='Ref_To_Local'>temp_missing</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3608"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN3605"><span class='Ref_To_Local'>namelist</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3642"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>curname</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3608"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN3643"></a>        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="namespace.c.html#LN3642"><span class='Ref_To_Local'>curname</span></a><span class='Delimiter'>, </span><span class='String'>"$user"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* $user --- substitute namespace matching user name, if any */ 
</span><a name="LN3648"></a>            <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tuple</span><span class='Delimiter'>; 
</span> 
            <a href="namespace.c.html#LN3648"><span class='Ref_To_Local'>tuple</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN44"><span class='Ref_to_EnumConst'>AUTHOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3603"><span class='Ref_To_Local'>roleid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3648"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span><a name="LN3653"></a>                <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>rname</span><span class='Delimiter'>; 
</span> 
                <a href="namespace.c.html#LN3653"><span class='Ref_To_Local'>rname</span></a> <span class='Operator'>= </span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(((</span><a href="../../include/catalog/pg_authid.h.html#LN71"><span class='Ref_to_Typedef'>Form_pg_authid</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3648"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>rolname<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="namespace.c.html#LN3643"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN114"><span class='Ref_to_Proto'>get_namespace_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3653"><span class='Ref_To_Local'>rname</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3648"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3643"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>                    <span class='Operator'>!</span><a href="../../include/nodes/pg_list.h.html#LN231"><span class='Ref_to_Proto'>list_member_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3606"><span class='Ref_To_Local'>oidlist</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN3643"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>                    <a href="../../include/utils/acl.h.html#LN289"><span class='Ref_to_Proto'>pg_namespace_aclcheck</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3643"><span class='Ref_To_Local'>namespaceId</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN3603"><span class='Ref_To_Local'>roleid</span></a><span class='Delimiter'>, 
</span>                                          <a href="../../include/nodes/parsenodes.h.html#LN79"><span class='Ref_to_Const'>ACL_USAGE</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="../../include/utils/acl.h.html#LN171"><span class='Ref_to_EnumConst'>ACLCHECK_OK</span></a> <span class='Operator'>&& 
</span>                    <a href="../../include/catalog/objectaccess.h.html#LN173"><span class='Ref_to_Macro'>InvokeNamespaceSearchHook</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3643"><span class='Ref_To_Local'>namespaceId</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>))</span> 
                    <a href="namespace.c.html#LN3606"><span class='Ref_To_Local'>oidlist</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN162"><span class='Ref_to_Func'>lappend_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3606"><span class='Ref_To_Local'>oidlist</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN3643"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if strcmp(curname,"$user... &raquo; </span> 
        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="namespace.c.html#LN3642"><span class='Ref_To_Local'>curname</span></a><span class='Delimiter'>, </span><span class='String'>"pg_temp"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* pg_temp --- substitute temp namespace, if any */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/nodes/pg_list.h.html#LN231"><span class='Ref_to_Proto'>list_member_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3606"><span class='Ref_To_Local'>oidlist</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>                    <a href="../../include/catalog/objectaccess.h.html#LN173"><span class='Ref_to_Macro'>InvokeNamespaceSearchHook</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>))</span> 
                    <a href="namespace.c.html#LN3606"><span class='Ref_To_Local'>oidlist</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN162"><span class='Ref_to_Func'>lappend_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3606"><span class='Ref_To_Local'>oidlist</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* If it ought to be the creation namespace, set flag */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3606"><span class='Ref_To_Local'>oidlist</span></a> <span class='Operator'>== </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>                    <a href="namespace.c.html#LN3609"><span class='Ref_To_Local'>temp_missing</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* normal namespace reference */ 
</span>            <a href="namespace.c.html#LN3643"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN114"><span class='Ref_to_Proto'>get_namespace_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3642"><span class='Ref_To_Local'>curname</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3643"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>                <span class='Operator'>!</span><a href="../../include/nodes/pg_list.h.html#LN231"><span class='Ref_to_Proto'>list_member_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3606"><span class='Ref_To_Local'>oidlist</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN3643"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>                <a href="../../include/utils/acl.h.html#LN289"><span class='Ref_to_Proto'>pg_namespace_aclcheck</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3643"><span class='Ref_To_Local'>namespaceId</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN3603"><span class='Ref_To_Local'>roleid</span></a><span class='Delimiter'>, 
</span>                                      <a href="../../include/nodes/parsenodes.h.html#LN79"><span class='Ref_to_Const'>ACL_USAGE</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="../../include/utils/acl.h.html#LN171"><span class='Ref_to_EnumConst'>ACLCHECK_OK</span></a> <span class='Operator'>&& 
</span>                <a href="../../include/catalog/objectaccess.h.html#LN173"><span class='Ref_to_Macro'>InvokeNamespaceSearchHook</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3643"><span class='Ref_To_Local'>namespaceId</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>))</span> 
                <a href="namespace.c.html#LN3606"><span class='Ref_To_Local'>oidlist</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN162"><span class='Ref_to_Func'>lappend_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3606"><span class='Ref_To_Local'>oidlist</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN3643"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Remember the first member of the explicit list.  (Note: this is 
     * nominally wrong if temp_missing, but we need it anyway to distinguish 
     * explicit from implicit mention of pg_catalog.) 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3606"><span class='Ref_To_Local'>oidlist</span></a> <span class='Operator'>== </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>        <a href="namespace.c.html#LN3610"><span class='Ref_To_Local'>firstNS</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="namespace.c.html#LN3610"><span class='Ref_To_Local'>firstNS</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN112"><span class='Ref_to_Macro'>linitial_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3606"><span class='Ref_To_Local'>oidlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Add any implicitly-searched namespaces to the list.  Note these go on 
     * the front, not the back; also notice that we do not check USAGE 
     * permissions for these. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/nodes/pg_list.h.html#LN231"><span class='Ref_to_Proto'>list_member_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3606"><span class='Ref_To_Local'>oidlist</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/pg_namespace.h.html#LN70"><span class='Ref_to_Const'>PG_CATALOG_NAMESPACE</span></a><span class='Parentheses'>))</span> 
        <a href="namespace.c.html#LN3606"><span class='Ref_To_Local'>oidlist</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN217"><span class='Ref_to_Proto'>lcons_oid</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_namespace.h.html#LN70"><span class='Ref_to_Const'>PG_CATALOG_NAMESPACE</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN3606"><span class='Ref_To_Local'>oidlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>        <span class='Operator'>!</span><a href="../../include/nodes/pg_list.h.html#LN231"><span class='Ref_to_Proto'>list_member_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3606"><span class='Ref_To_Local'>oidlist</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>))</span> 
        <a href="namespace.c.html#LN3606"><span class='Ref_To_Local'>oidlist</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN217"><span class='Ref_to_Proto'>lcons_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN3606"><span class='Ref_To_Local'>oidlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Now that we've successfully built the new list of namespace OIDs, save 
     * it in permanent storage. 
     */ 
</span>    <a href="namespace.c.html#LN3611"><span class='Ref_To_Local'>oldcxt</span></a> <span class='Operator'>= </span><a href="../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="../utils/mmgr/mcxt.c.html#LN42"><span class='Ref_to_Global_Var'>TopMemoryContext</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN3607"><span class='Ref_To_Local'>newpath</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN268"><span class='Ref_to_Proto'>list_copy</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3606"><span class='Ref_To_Local'>oidlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3611"><span class='Ref_To_Local'>oldcxt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Now safe to assign to state variables. */ 
</span>    <a href="../../include/nodes/pg_list.h.html#LN265"><span class='Ref_to_Proto'>list_free</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN143"><span class='Ref_to_Global_Var'>baseSearchPath</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN143"><span class='Ref_to_Global_Var'>baseSearchPath</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN3607"><span class='Ref_To_Local'>newpath</span></a><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN145"><span class='Ref_to_Global_Var'>baseCreationNamespace</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN3610"><span class='Ref_To_Local'>firstNS</span></a><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN147"><span class='Ref_to_Global_Var'>baseTempCreationPending</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN3609"><span class='Ref_To_Local'>temp_missing</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Mark the path valid. */ 
</span>    <a href="namespace.c.html#LN152"><span class='Ref_to_Global_Var'>baseSearchPathValid</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN149"><span class='Ref_to_Global_Var'>namespaceUser</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN3603"><span class='Ref_To_Local'>roleid</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* And make it active. */ 
</span>    <a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN143"><span class='Ref_to_Global_Var'>baseSearchPath</span></a><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN136"><span class='Ref_to_Global_Var'>activeCreationNamespace</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN145"><span class='Ref_to_Global_Var'>baseCreationNamespace</span></a><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN139"><span class='Ref_to_Global_Var'>activeTempCreationPending</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN147"><span class='Ref_to_Global_Var'>baseTempCreationPending</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Clean up. */ 
</span>    <a href="../../include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3604"><span class='Ref_To_Local'>rawname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/nodes/pg_list.h.html#LN265"><span class='Ref_to_Proto'>list_free</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3605"><span class='Ref_To_Local'>namelist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/nodes/pg_list.h.html#LN265"><span class='Ref_to_Proto'>list_free</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3606"><span class='Ref_To_Local'>oidlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end recomputeNamespacePath &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * InitTempTableNamespace 
 *      Initialize temp table namespace on first use in a particular backend 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN3751"></a><span class='Declare_Function'>InitTempTableNamespace</span><span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3753"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>namespaceName</span><span class='Delimiter'>[</span><a href="../../interfaces/ecpg/include/sqlda-native.h.html#LN15"><span class='Ref_to_Const'>NAMEDATALEN</span></a><span class='Delimiter'>]; 
</span><a name="LN3754"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span><span class='Delimiter'>; 
</span><a name="LN3755"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>toastspaceId</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * First, do permission check to see if we are authorized to make temp 
     * tables.  We use a nonstandard error message here since "databasename: 
     * permission denied" might be a tad cryptic. 
     * 
     * Note that ACL_CREATE_TEMP rights are rechecked in pg_namespace_aclmask; 
     * that's necessary since current user ID could change during the session. 
     * But there's no need to make the namespace in the first place until a 
     * temp table creation request is made by someone with appropriate rights. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/utils/acl.h.html#LN284"><span class='Ref_to_Proto'>pg_database_aclcheck</span></a><span class='Parentheses'>(</span><a href="../utils/init/globals.c.html#LN76"><span class='Ref_to_Global_Var'>MyDatabaseId</span></a><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, 
</span>                             <a href="../../include/nodes/parsenodes.h.html#LN82"><span class='Ref_to_Const'>ACL_CREATE_TEMP</span></a><span class='Parentheses'>)</span> <span class='Operator'>!= </span><a href="../../include/utils/acl.h.html#LN171"><span class='Ref_to_EnumConst'>ACLCHECK_OK</span></a><span class='Parentheses'>)</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INSUFFICIENT_PRIVILEGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"permission denied to create temporary tables in database \"%s\""</span><span class='Delimiter'>, 
</span>                        <a href="../../include/commands/dbcommands.h.html#LN29"><span class='Ref_to_Proto'>get_database_name</span></a><span class='Parentheses'>(</span><a href="../utils/init/globals.c.html#LN76"><span class='Ref_to_Global_Var'>MyDatabaseId</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Do not allow a Hot Standby slave session to make temp tables.  Aside 
     * from problems with modifying the system catalogs, there is a naming 
     * conflict: pg_temp_N belongs to the session with BackendId N on the 
     * master, not to a slave session with the same BackendId.  We should not 
     * be able to get here anyway due to XactReadOnly checks, but let's just 
     * make real sure.  Note that this also backstops various operations that 
     * allow XactReadOnly transactions to modify temp tables; they'd need 
     * RecoveryInProgress checks if not for this. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/access/xlog.h.html#LN242"><span class='Ref_to_Proto'>RecoveryInProgress</span></a><span class='Parentheses'>())</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_READ_ONLY_SQL_TRANSACTION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot create temporary tables during recovery"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Parallel workers can't create temporary tables, either. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/access/parallel.h.html#LN51"><span class='Ref_to_Macro'>IsParallelWorker</span></a><span class='Parentheses'>())</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_READ_ONLY_SQL_TRANSACTION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot create temporary tables during a parallel operation"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="../../pl/plperl/plperl.h.html#LN60"><span class='Ref_to_Macro'>snprintf</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3753"><span class='Ref_To_Local'>namespaceName</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="namespace.c.html#LN3753"><span class='Ref_To_Local'>namespaceName</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='String'>"pg_temp_%d"</span><span class='Delimiter'>, </span><a href="../utils/init/globals.c.html#LN72"><span class='Ref_to_Global_Var'>MyBackendId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN3754"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN114"><span class='Ref_to_Proto'>get_namespace_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3753"><span class='Ref_To_Local'>namespaceName</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3754"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * First use of this temp namespace in this database; create it. The 
         * temp namespaces are always owned by the superuser.  We leave their 
         * permissions at default --- i.e., no access except to superuser --- 
         * to ensure that unprivileged users can't peek at other backends' 
         * temp tables.  This works because the places that access the temp 
         * namespace for my own backend skip permissions checks on it. 
         */ 
</span>        <a href="namespace.c.html#LN3754"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="pg_namespace.c.html#LN40"><span class='Ref_to_Func'>NamespaceCreate</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3753"><span class='Ref_To_Local'>namespaceName</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/pg_authid.h.html#LN101"><span class='Ref_to_Const'>BOOTSTRAP_SUPERUSERID</span></a><span class='Delimiter'>, 
</span>                                      <span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* Advance command counter to make namespace visible */ 
</span>        <a href="../../include/access/xact.h.html#LN346"><span class='Ref_to_Proto'>CommandCounterIncrement</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * If the namespace already exists, clean it out (in case the former 
         * owner crashed without doing so). 
         */ 
</span>        <a href="namespace.c.html#LN196"><span class='Ref_to_Proto'>RemoveTempRelations</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3754"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If the corresponding toast-table namespace doesn't exist yet, create 
     * it. (We assume there is no need to clean it out if it does exist, since 
     * dropping a parent table should make its toast table go away.) 
     */ 
</span>    <a href="../../pl/plperl/plperl.h.html#LN60"><span class='Ref_to_Macro'>snprintf</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3753"><span class='Ref_To_Local'>namespaceName</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="namespace.c.html#LN3753"><span class='Ref_To_Local'>namespaceName</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='String'>"pg_toast_temp_%d"</span><span class='Delimiter'>, 
</span>             <a href="../utils/init/globals.c.html#LN72"><span class='Ref_to_Global_Var'>MyBackendId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN3755"><span class='Ref_To_Local'>toastspaceId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN114"><span class='Ref_to_Proto'>get_namespace_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3753"><span class='Ref_To_Local'>namespaceName</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3755"><span class='Ref_To_Local'>toastspaceId</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="namespace.c.html#LN3755"><span class='Ref_To_Local'>toastspaceId</span></a> <span class='Operator'>= </span><a href="pg_namespace.c.html#LN40"><span class='Ref_to_Func'>NamespaceCreate</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3753"><span class='Ref_To_Local'>namespaceName</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/pg_authid.h.html#LN101"><span class='Ref_to_Const'>BOOTSTRAP_SUPERUSERID</span></a><span class='Delimiter'>, 
</span>                                       <span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* Advance command counter to make namespace visible */ 
</span>        <a href="../../include/access/xact.h.html#LN346"><span class='Ref_to_Proto'>CommandCounterIncrement</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Okay, we've prepared the temp namespace ... but it's not committed yet, 
     * so all our work could be undone by transaction rollback.  Set flag for 
     * AtEOXact_Namespace to know what to do. 
     */ 
</span>    <a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN3754"><span class='Ref_To_Local'>namespaceId</span></a><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN182"><span class='Ref_to_Global_Var'>myTempToastNamespace</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN3755"><span class='Ref_To_Local'>toastspaceId</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* It should not be done already. */ 
</span>    <a href="../../include/c.h.html#LN677"><span class='Ref_to_Macro'>AssertState</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN184"><span class='Ref_to_Global_Var'>myTempNamespaceSubID</span></a> <span class='Operator'>== </span><a href="../../include/c.h.html#LN402"><span class='Ref_to_Const'>InvalidSubTransactionId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN184"><span class='Ref_to_Global_Var'>myTempNamespaceSubID</span></a> <span class='Operator'>= </span><a href="../../include/access/xact.h.html#LN336"><span class='Ref_to_Proto'>GetCurrentSubTransactionId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN152"><span class='Ref_to_Global_Var'>baseSearchPathValid</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* need to rebuild list */ 
</span><span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end InitTempTableNamespace &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * End-of-transaction cleanup for namespaces. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN3860"></a><span class='Declare_Function'>AtEOXact_Namespace</span><span class='Parentheses'>(</span><span class='Keyword'>bool </span><span class='Declare_Parameter'>isCommit</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>parallel</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* 
     * If we abort the transaction in which a temp namespace was selected, 
     * we'll have to do any creation or cleanout work over again.  So, just 
     * forget the namespace entirely until next time.  On the other hand, if 
     * we commit then register an exit callback to clean out the temp tables 
     * at backend shutdown.  (We only want to register the callback once per 
     * session, so this is a good place to do it.) 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN184"><span class='Ref_to_Global_Var'>myTempNamespaceSubID</span></a> <span class='Operator'>!= </span><a href="../../include/c.h.html#LN402"><span class='Ref_to_Const'>InvalidSubTransactionId</span></a> <span class='Operator'>&& !</span><a href="namespace.c.html#LN3860"><span class='Ref_to_Parameter'>parallel</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3860"><span class='Ref_to_Parameter'>isCommit</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/storage/ipc.h.html#LN70"><span class='Ref_to_Proto'>before_shmem_exit</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN197"><span class='Ref_to_Proto'>RemoveTempRelationsCallback</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>            <a href="namespace.c.html#LN182"><span class='Ref_to_Global_Var'>myTempToastNamespace</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>            <a href="namespace.c.html#LN152"><span class='Ref_to_Global_Var'>baseSearchPathValid</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* need to rebuild list */ 
</span>        <span class='Delimiter'>} 
</span>        <a href="namespace.c.html#LN184"><span class='Ref_to_Global_Var'>myTempNamespaceSubID</span></a> <span class='Operator'>= </span><a href="../../include/c.h.html#LN402"><span class='Ref_to_Const'>InvalidSubTransactionId</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Clean up if someone failed to do PopOverrideSearchPath 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN163"><span class='Ref_to_Global_Var'>overrideStack</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3860"><span class='Ref_to_Parameter'>isCommit</span></a><span class='Parentheses'>) 
</span>            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN39"><span class='Ref_to_Const'>WARNING</span></a><span class='Delimiter'>, </span><span class='String'>"leaked override search path"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN163"><span class='Ref_to_Global_Var'>overrideStack</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN3892"></a>            <a href="namespace.c.html#LN156"><span class='Ref_to_Typedef'>OverrideStackEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>entry</span><span class='Delimiter'>; 
</span> 
            <a href="namespace.c.html#LN3892"><span class='Ref_To_Local'>entry</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="namespace.c.html#LN156"><span class='Ref_to_Typedef'>OverrideStackEntry</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN163"><span class='Ref_to_Global_Var'>overrideStack</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="namespace.c.html#LN163"><span class='Ref_to_Global_Var'>overrideStack</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN237"><span class='Ref_to_Proto'>list_delete_first</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN163"><span class='Ref_to_Global_Var'>overrideStack</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../include/nodes/pg_list.h.html#LN265"><span class='Ref_to_Proto'>list_free</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3892"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="namespace.c.html#LN158"><span class='Ref_to_Member'>searchPath</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3892"><span class='Ref_To_Local'>entry</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Comment_Multi_Line'>/* If not baseSearchPathValid, this is useless but harmless */ 
</span>        <a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN143"><span class='Ref_to_Global_Var'>baseSearchPath</span></a><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN136"><span class='Ref_to_Global_Var'>activeCreationNamespace</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN145"><span class='Ref_to_Global_Var'>baseCreationNamespace</span></a><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN139"><span class='Ref_to_Global_Var'>activeTempCreationPending</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN147"><span class='Ref_to_Global_Var'>baseTempCreationPending</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end AtEOXact_Namespace &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * AtEOSubXact_Namespace 
 * 
 * At subtransaction commit, propagate the temp-namespace-creation 
 * flag to the parent subtransaction. 
 * 
 * At subtransaction abort, forget the flag if we set it up. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN3915"></a><span class='Declare_Function'>AtEOSubXact_Namespace</span><span class='Parentheses'>(</span><span class='Keyword'>bool </span><span class='Declare_Parameter'>isCommit</span><span class='Delimiter'>, </span><a href="../../include/c.h.html#LN400"><span class='Ref_to_Typedef'>SubTransactionId</span></a> <span class='Declare_Parameter'>mySubid</span><span class='Delimiter'>, 
</span><a name="LN3916"></a>                      <a href="../../include/c.h.html#LN400"><span class='Ref_to_Typedef'>SubTransactionId</span></a> <span class='Declare_Parameter'>parentSubid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3918"></a>    <a href="namespace.c.html#LN156"><span class='Ref_to_Typedef'>OverrideStackEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>entry</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN184"><span class='Ref_to_Global_Var'>myTempNamespaceSubID</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN3915"><span class='Ref_to_Parameter'>mySubid</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3915"><span class='Ref_to_Parameter'>isCommit</span></a><span class='Parentheses'>) 
</span>            <a href="namespace.c.html#LN184"><span class='Ref_to_Global_Var'>myTempNamespaceSubID</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN3916"><span class='Ref_to_Parameter'>parentSubid</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="namespace.c.html#LN184"><span class='Ref_to_Global_Var'>myTempNamespaceSubID</span></a> <span class='Operator'>= </span><a href="../../include/c.h.html#LN402"><span class='Ref_to_Const'>InvalidSubTransactionId</span></a><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* TEMP namespace creation failed, so reset state */ 
</span>            <a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>            <a href="namespace.c.html#LN182"><span class='Ref_to_Global_Var'>myTempToastNamespace</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>            <a href="namespace.c.html#LN152"><span class='Ref_to_Global_Var'>baseSearchPathValid</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* need to rebuild list */ 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Clean up if someone failed to do PopOverrideSearchPath 
     */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN163"><span class='Ref_to_Global_Var'>overrideStack</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="namespace.c.html#LN3918"><span class='Ref_To_Local'>entry</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="namespace.c.html#LN156"><span class='Ref_to_Typedef'>OverrideStackEntry</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN163"><span class='Ref_to_Global_Var'>overrideStack</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3918"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="namespace.c.html#LN160"><span class='Ref_to_Member'>nestLevel</span></a> <span class='Operator'>&LT; </span><a href="../../include/access/xact.h.html#LN344"><span class='Ref_to_Proto'>GetCurrentTransactionNestLevel</span></a><span class='Parentheses'>())</span> 
            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN3915"><span class='Ref_to_Parameter'>isCommit</span></a><span class='Parentheses'>) 
</span>            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN39"><span class='Ref_to_Const'>WARNING</span></a><span class='Delimiter'>, </span><span class='String'>"leaked override search path"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN163"><span class='Ref_to_Global_Var'>overrideStack</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN237"><span class='Ref_to_Proto'>list_delete_first</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN163"><span class='Ref_to_Global_Var'>overrideStack</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../include/nodes/pg_list.h.html#LN265"><span class='Ref_to_Proto'>list_free</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3918"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="namespace.c.html#LN158"><span class='Ref_to_Member'>searchPath</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN3918"><span class='Ref_To_Local'>entry</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Activate the next level down. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN163"><span class='Ref_to_Global_Var'>overrideStack</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="namespace.c.html#LN3918"><span class='Ref_To_Local'>entry</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="namespace.c.html#LN156"><span class='Ref_to_Typedef'>OverrideStackEntry</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN163"><span class='Ref_to_Global_Var'>overrideStack</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN3918"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="namespace.c.html#LN158"><span class='Ref_to_Member'>searchPath</span></a><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN136"><span class='Ref_to_Global_Var'>activeCreationNamespace</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN3918"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="namespace.c.html#LN159"><span class='Ref_to_Member'>creationNamespace</span></a><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN139"><span class='Ref_to_Global_Var'>activeTempCreationPending</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>;</span>      <span class='Comment_Single_Line'>/* XXX is this OK? */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* If not baseSearchPathValid, this is useless but harmless */ 
</span>        <a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN143"><span class='Ref_to_Global_Var'>baseSearchPath</span></a><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN136"><span class='Ref_to_Global_Var'>activeCreationNamespace</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN145"><span class='Ref_to_Global_Var'>baseCreationNamespace</span></a><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN139"><span class='Ref_to_Global_Var'>activeTempCreationPending</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN147"><span class='Ref_to_Global_Var'>baseTempCreationPending</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end AtEOSubXact_Namespace &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Remove all relations in the specified temp namespace. 
 * 
 * This is called at backend shutdown (if we made any temp relations). 
 * It is also called when we begin using a pre-existing temp namespace, 
 * in order to clean out any relations that might have been created by 
 * a crashed backend. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN3975"></a><span class='Declare_Function'>RemoveTempRelations</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>tempNamespaceId</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3977"></a>    <a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> <span class='Declare_Local'>object</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We want to get rid of everything in the target namespace, but not the 
     * namespace itself (deleting it only to recreate it later would be a 
     * waste of cycles).  Hence, specify SKIP_ORIGINAL.  It's also an INTERNAL 
     * deletion, and we want to not drop any extensions that might happen to 
     * own temp objects. 
     */ 
</span>    <a href="namespace.c.html#LN3977"><span class='Ref_To_Local'>object</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_namespace.h.html#LN33"><span class='Ref_to_Const'>NamespaceRelationId</span></a><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN3977"><span class='Ref_To_Local'>object</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN3975"><span class='Ref_to_Parameter'>tempNamespaceId</span></a><span class='Delimiter'>; 
</span>    <a href="namespace.c.html#LN3977"><span class='Ref_To_Local'>object</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/catalog/dependency.h.html#LN182"><span class='Ref_to_Proto'>performDeletion</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="namespace.c.html#LN3977"><span class='Ref_To_Local'>object</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN1655"><span class='Ref_to_EnumConst'>DROP_CASCADE</span></a><span class='Delimiter'>, 
</span>                    <a href="../../include/catalog/dependency.h.html#LN173"><span class='Ref_to_Const'>PERFORM_DELETION_INTERNAL</span></a> <span class='Operator'>| 
</span>                    <a href="../../include/catalog/dependency.h.html#LN175"><span class='Ref_to_Const'>PERFORM_DELETION_QUIETLY</span></a> <span class='Operator'>| 
</span>                    <a href="../../include/catalog/dependency.h.html#LN176"><span class='Ref_to_Const'>PERFORM_DELETION_SKIP_ORIGINAL</span></a> <span class='Operator'>| 
</span>                    <a href="../../include/catalog/dependency.h.html#LN177"><span class='Ref_to_Const'>PERFORM_DELETION_SKIP_EXTENSIONS</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end RemoveTempRelations &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Callback to remove temp relations at backend exit. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN4001"></a><span class='Declare_Function'>RemoveTempRelationsCallback</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>code</span><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Declare_Parameter'>arg</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>))</span>    <span class='Comment_Single_Line'>/* should always be true */ 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Need to ensure we have a usable transaction. */ 
</span>        <a href="../../include/access/xact.h.html#LN369"><span class='Ref_to_Proto'>AbortOutOfAnyTransaction</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <a href="../../include/access/xact.h.html#LN348"><span class='Ref_to_Proto'>StartTransactionCommand</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
        <a href="namespace.c.html#LN196"><span class='Ref_to_Proto'>RemoveTempRelations</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/access/xact.h.html#LN349"><span class='Ref_to_Proto'>CommitTransactionCommand</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Remove all temp tables from the temporary namespace. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN4019"></a><span class='Declare_Function'>ResetTempTableNamespace</span><span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>))</span> 
        <a href="namespace.c.html#LN196"><span class='Ref_to_Proto'>RemoveTempRelations</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * Routines for handling the GUC variable 'search_path'. 
 */ 
</span> 
<span class='Comment_Multi_Line'>/* check_hook: validate new search_path value */ 
</span><span class='Keyword'>bool 
</span><a name="LN4032"></a><span class='Declare_Function'>check_search_path</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>**</span><span class='Declare_Parameter'>newval</span><span class='Delimiter'>, </span><span class='Keyword'>void </span><span class='Operator'>**</span><span class='Declare_Parameter'>extra</span><span class='Delimiter'>, </span><a href="../../include/utils/guc.h.html#LN104"><span class='Ref_to_Typedef'>GucSource</span></a> <span class='Declare_Parameter'>source</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4034"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>rawname</span><span class='Delimiter'>; 
</span><a name="LN4035"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>namelist</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Need a modifiable copy of string */ 
</span>    <a href="namespace.c.html#LN4034"><span class='Ref_To_Local'>rawname</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="namespace.c.html#LN4032"><span class='Ref_to_Parameter'>newval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Parse string into list of identifiers */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/varlena.h.html#LN29"><span class='Ref_to_Proto'>SplitIdentifierString</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4034"><span class='Ref_To_Local'>rawname</span></a><span class='Delimiter'>, </span><span class='String'>','</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="namespace.c.html#LN4035"><span class='Ref_To_Local'>namelist</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* syntax error in name list */ 
</span>        <a href="../../include/utils/guc.h.html#LN406"><span class='Ref_to_Const'>GUC_check_errdetail</span></a><span class='Parentheses'>(</span><span class='String'>"List syntax is invalid."</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4034"><span class='Ref_To_Local'>rawname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../include/nodes/pg_list.h.html#LN265"><span class='Ref_to_Proto'>list_free</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4035"><span class='Ref_To_Local'>namelist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We used to try to check that the named schemas exist, but there are 
     * many valid use-cases for having search_path settings that include 
     * schemas that don't exist; and often, we are not inside a transaction 
     * here and so can't consult the system catalogs anyway.  So now, the only 
     * requirement is syntactic validity of the identifier list. 
     */ 
</span> 
    <a href="../../include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4034"><span class='Ref_To_Local'>rawname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/nodes/pg_list.h.html#LN265"><span class='Ref_to_Proto'>list_free</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4035"><span class='Ref_To_Local'>namelist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end check_search_path &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* assign_hook: do extra actions as needed */ 
</span><span class='Keyword'>void 
</span><a name="LN4066"></a><span class='Declare_Function'>assign_search_path</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>newval</span><span class='Delimiter'>, </span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Declare_Parameter'>extra</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* 
     * We mark the path as needing recomputation, but don't do anything until 
     * it's needed.  This avoids trying to do database access during GUC 
     * initialization, or outside a transaction. 
     */ 
</span>    <a href="namespace.c.html#LN152"><span class='Ref_to_Global_Var'>baseSearchPathValid</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * InitializeSearchPath: initialize module during InitPostgres. 
 * 
 * This is called after we are up enough to be able to do catalog lookups. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN4082"></a><span class='Declare_Function'>InitializeSearchPath</span><span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/miscadmin.h.html#LN369"><span class='Ref_to_Macro'>IsBootstrapProcessingMode</span></a><span class='Parentheses'>())</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * In bootstrap mode, the search path must be 'pg_catalog' so that 
         * tables are created in the proper namespace; ignore the GUC setting. 
         */ 
</span><a name="LN4090"></a>        <a href="../../include/utils/palloc.h.html#LN35"><span class='Ref_to_Typedef'>MemoryContext</span></a> <span class='Declare_Local'>oldcxt</span><span class='Delimiter'>; 
</span> 
        <a href="namespace.c.html#LN4090"><span class='Ref_To_Local'>oldcxt</span></a> <span class='Operator'>= </span><a href="../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="../utils/mmgr/mcxt.c.html#LN42"><span class='Ref_to_Global_Var'>TopMemoryContext</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN143"><span class='Ref_to_Global_Var'>baseSearchPath</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN150"><span class='Ref_to_Macro'>list_make1_oid</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_namespace.h.html#LN70"><span class='Ref_to_Const'>PG_CATALOG_NAMESPACE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4090"><span class='Ref_To_Local'>oldcxt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN145"><span class='Ref_to_Global_Var'>baseCreationNamespace</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_namespace.h.html#LN70"><span class='Ref_to_Const'>PG_CATALOG_NAMESPACE</span></a><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN147"><span class='Ref_to_Global_Var'>baseTempCreationPending</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN152"><span class='Ref_to_Global_Var'>baseSearchPathValid</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN149"><span class='Ref_to_Global_Var'>namespaceUser</span></a> <span class='Operator'>= </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN143"><span class='Ref_to_Global_Var'>baseSearchPath</span></a><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN136"><span class='Ref_to_Global_Var'>activeCreationNamespace</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN145"><span class='Ref_to_Global_Var'>baseCreationNamespace</span></a><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN139"><span class='Ref_to_Global_Var'>activeTempCreationPending</span></a> <span class='Operator'>= </span><a href="namespace.c.html#LN147"><span class='Ref_to_Global_Var'>baseTempCreationPending</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * In normal mode, arrange for a callback on any syscache invalidation 
         * of pg_namespace rows. 
         */ 
</span>        <a href="../../include/utils/inval.h.html#LN55"><span class='Ref_to_Proto'>CacheRegisterSyscacheCallback</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN69"><span class='Ref_to_EnumConst'>NAMESPACEOID</span></a><span class='Delimiter'>, 
</span>                                      <a href="namespace.c.html#LN198"><span class='Ref_to_Proto'>NamespaceCallback</span></a><span class='Delimiter'>, 
</span>                                      <span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>) </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* Force search path to be recomputed on next use */ 
</span>        <a href="namespace.c.html#LN152"><span class='Ref_to_Global_Var'>baseSearchPathValid</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end InitializeSearchPath &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * NamespaceCallback 
 *      Syscache inval callback function 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN4122"></a><span class='Declare_Function'>NamespaceCallback</span><span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Declare_Parameter'>arg</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>cacheid</span><span class='Delimiter'>, </span><a href="../../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a> <span class='Declare_Parameter'>hashvalue</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* Force search path to be recomputed on next use */ 
</span>    <a href="namespace.c.html#LN152"><span class='Ref_to_Global_Var'>baseSearchPathValid</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Fetch the active search path. The return value is a palloc'ed list 
 * of OIDs; the caller is responsible for freeing this storage as 
 * appropriate. 
 * 
 * The returned list includes the implicitly-prepended namespaces only if 
 * includeImplicit is true. 
 * 
 * Note: calling this may result in a CommandCounterIncrement operation, 
 * if we have to create or clean out the temp namespace. 
 */ 
</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>* 
</span><a name="LN4140"></a><span class='Declare_Function'>fetch_search_path</span><span class='Parentheses'>(</span><span class='Keyword'>bool </span><span class='Declare_Parameter'>includeImplicit</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4142"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If the temp namespace should be first, force it to exist.  This is so 
     * that callers can trust the result to reflect the actual default 
     * creation namespace.  It's a bit bogus to do this here, since 
     * current_schema() is supposedly a stable function without side-effects, 
     * but the alternatives seem worse. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN139"><span class='Ref_to_Global_Var'>activeTempCreationPending</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="namespace.c.html#LN195"><span class='Ref_to_Proto'>InitTempTableNamespace</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="namespace.c.html#LN4142"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN268"><span class='Ref_to_Proto'>list_copy</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="namespace.c.html#LN4140"><span class='Ref_to_Parameter'>includeImplicit</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN4142"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>&& </span><a href="../../include/nodes/pg_list.h.html#LN112"><span class='Ref_to_Macro'>linitial_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4142"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="namespace.c.html#LN136"><span class='Ref_to_Global_Var'>activeCreationNamespace</span></a><span class='Parentheses'>)</span> 
            <a href="namespace.c.html#LN4142"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN237"><span class='Ref_to_Proto'>list_delete_first</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4142"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN4142"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end fetch_search_path &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Fetch the active search path into a caller-allocated array of OIDs. 
 * Returns the number of path entries.  (If this is more than sarray_len, 
 * then the data didn't fit and is not all stored.) 
 * 
 * The returned list always includes the implicitly-prepended namespaces, 
 * but never includes the temp namespace.  (This is suitable for existing 
 * users, which would want to ignore the temp namespace anyway.)  This 
 * definition allows us to not worry about initializing the temp namespace. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN4180"></a><span class='Declare_Function'>fetch_search_path_array</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>sarray</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>sarray_len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4182"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>count</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN4183"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <a href="namespace.c.html#LN194"><span class='Ref_to_Proto'>recomputeNamespacePath</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4183"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="namespace.c.html#LN133"><span class='Ref_to_Global_Var'>activeSearchPath</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN4189"></a>        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4183"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN4189"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>== </span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* do not include temp namespace */ 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="namespace.c.html#LN4182"><span class='Ref_To_Local'>count</span></a> <span class='Operator'>&LT; </span><a href="namespace.c.html#LN4180"><span class='Ref_to_Parameter'>sarray_len</span></a><span class='Parentheses'>) 
</span>            <a href="namespace.c.html#LN4180"><span class='Ref_to_Parameter'>sarray</span></a><span class='Delimiter'>[</span><a href="namespace.c.html#LN4182"><span class='Ref_To_Local'>count</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="namespace.c.html#LN4189"><span class='Ref_To_Local'>namespaceId</span></a><span class='Delimiter'>; 
</span>        <a href="namespace.c.html#LN4182"><span class='Ref_To_Local'>count</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="namespace.c.html#LN4182"><span class='Ref_To_Local'>count</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end fetch_search_path_array &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * Export the FooIsVisible functions as SQL-callable functions. 
 * 
 * Note: as of Postgres 8.4, these will silently return NULL if called on 
 * a nonexistent object OID, rather than failing.  This is to avoid race 
 * condition errors when a query that's scanning a catalog using an MVCC 
 * snapshot uses one of these functions.  The underlying IsVisible functions 
 * always use an up-to-date snapshot and so might see the object as already 
 * gone when it's still visible to the transaction snapshot.  (There is no race 
 * condition in the current coding because we don't accept sinval messages 
 * between the SearchSysCacheExists test and the subsequent lookup.) 
 */ 
</span> 
<a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN4217"></a><span class='Declare_Function'>pg_table_is_visible</span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4219"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>oid</span> <span class='Operator'>= </span><a href="../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/syscache.h.html#LN173"><span class='Ref_to_Macro'>SearchSysCacheExists1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN83"><span class='Ref_to_EnumConst'>RELOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4219"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>)))</span> 
        <a href="../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN65"><span class='Ref_to_Proto'>RelationIsVisible</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4219"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN4228"></a><span class='Declare_Function'>pg_type_is_visible</span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4230"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>oid</span> <span class='Operator'>= </span><a href="../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/syscache.h.html#LN173"><span class='Ref_to_Macro'>SearchSysCacheExists1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN107"><span class='Ref_to_EnumConst'>TYPEOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4230"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>)))</span> 
        <a href="../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN68"><span class='Ref_to_Proto'>TypeIsVisible</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4230"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN4239"></a><span class='Declare_Function'>pg_function_is_visible</span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4241"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>oid</span> <span class='Operator'>= </span><a href="../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/syscache.h.html#LN173"><span class='Ref_to_Macro'>SearchSysCacheExists1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN76"><span class='Ref_to_EnumConst'>PROCOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4241"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>)))</span> 
        <a href="../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN75"><span class='Ref_to_Proto'>FunctionIsVisible</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4241"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN4250"></a><span class='Declare_Function'>pg_operator_is_visible</span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4252"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>oid</span> <span class='Operator'>= </span><a href="../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/syscache.h.html#LN173"><span class='Ref_to_Macro'>SearchSysCacheExists1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN71"><span class='Ref_to_EnumConst'>OPEROID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4252"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>)))</span> 
        <a href="../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN80"><span class='Ref_to_Proto'>OperatorIsVisible</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4252"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN4261"></a><span class='Declare_Function'>pg_opclass_is_visible</span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4263"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>oid</span> <span class='Operator'>= </span><a href="../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/syscache.h.html#LN173"><span class='Ref_to_Macro'>SearchSysCacheExists1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN47"><span class='Ref_to_EnumConst'>CLAOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4263"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>)))</span> 
        <a href="../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN83"><span class='Ref_to_Proto'>OpclassIsVisible</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4263"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN4272"></a><span class='Declare_Function'>pg_opfamily_is_visible</span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4274"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>oid</span> <span class='Operator'>= </span><a href="../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/syscache.h.html#LN173"><span class='Ref_to_Macro'>SearchSysCacheExists1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN73"><span class='Ref_to_EnumConst'>OPFAMILYOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4274"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>)))</span> 
        <a href="../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN86"><span class='Ref_to_Proto'>OpfamilyIsVisible</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4274"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN4283"></a><span class='Declare_Function'>pg_collation_is_visible</span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4285"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>oid</span> <span class='Operator'>= </span><a href="../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/syscache.h.html#LN173"><span class='Ref_to_Macro'>SearchSysCacheExists1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN49"><span class='Ref_to_EnumConst'>COLLOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4285"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>)))</span> 
        <a href="../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN89"><span class='Ref_to_Proto'>CollationIsVisible</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4285"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN4294"></a><span class='Declare_Function'>pg_conversion_is_visible</span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4296"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>oid</span> <span class='Operator'>= </span><a href="../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/syscache.h.html#LN173"><span class='Ref_to_Macro'>SearchSysCacheExists1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN53"><span class='Ref_to_EnumConst'>CONVOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4296"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>)))</span> 
        <a href="../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN92"><span class='Ref_to_Proto'>ConversionIsVisible</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4296"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN4305"></a><span class='Declare_Function'>pg_statistics_obj_is_visible</span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4307"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>oid</span> <span class='Operator'>= </span><a href="../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/syscache.h.html#LN173"><span class='Ref_to_Macro'>SearchSysCacheExists1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN89"><span class='Ref_to_EnumConst'>STATEXTOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4307"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>)))</span> 
        <a href="../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN95"><span class='Ref_to_Proto'>StatisticsObjIsVisible</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4307"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN4316"></a><span class='Declare_Function'>pg_ts_parser_is_visible</span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4318"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>oid</span> <span class='Operator'>= </span><a href="../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/syscache.h.html#LN173"><span class='Ref_to_Macro'>SearchSysCacheExists1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN103"><span class='Ref_to_EnumConst'>TSPARSEROID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4318"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>)))</span> 
        <a href="../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN98"><span class='Ref_to_Proto'>TSParserIsVisible</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4318"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN4327"></a><span class='Declare_Function'>pg_ts_dict_is_visible</span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4329"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>oid</span> <span class='Operator'>= </span><a href="../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/syscache.h.html#LN173"><span class='Ref_to_Macro'>SearchSysCacheExists1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN101"><span class='Ref_to_EnumConst'>TSDICTOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4329"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>)))</span> 
        <a href="../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN101"><span class='Ref_to_Proto'>TSDictionaryIsVisible</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4329"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN4338"></a><span class='Declare_Function'>pg_ts_template_is_visible</span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4340"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>oid</span> <span class='Operator'>= </span><a href="../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/syscache.h.html#LN173"><span class='Ref_to_Macro'>SearchSysCacheExists1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN105"><span class='Ref_to_EnumConst'>TSTEMPLATEOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4340"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>)))</span> 
        <a href="../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN104"><span class='Ref_to_Proto'>TSTemplateIsVisible</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4340"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN4349"></a><span class='Declare_Function'>pg_ts_config_is_visible</span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4351"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>oid</span> <span class='Operator'>= </span><a href="../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/syscache.h.html#LN173"><span class='Ref_to_Macro'>SearchSysCacheExists1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN99"><span class='Ref_to_EnumConst'>TSCONFIGOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4351"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>)))</span> 
        <a href="../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN107"><span class='Ref_to_Proto'>TSConfigIsVisible</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4351"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN4360"></a><span class='Declare_Function'>pg_my_temp_schema</span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="../../include/fmgr.h.html#LN319"><span class='Ref_to_Macro'>PG_RETURN_OID</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN180"><span class='Ref_to_Global_Var'>myTempNamespace</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN4366"></a><span class='Declare_Function'>pg_is_other_temp_schema</span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4368"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>oid</span> <span class='Operator'>= </span><a href="../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/namespace.h.html#LN127"><span class='Ref_to_Proto'>isOtherTempNamespace</span></a><span class='Parentheses'>(</span><a href="namespace.c.html#LN4368"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span></pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>