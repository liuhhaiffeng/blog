<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\backend\catalog\pg_proc.c</title>
<LINK REL=StyleSheet HREF="../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\backend\catalog\pg_proc.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:33 2017
</td></tr>
<tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * pg_proc.c 
 *    routines to support manipulation of the pg_proc relation 
 * 
 * Portions Copyright (c) 1996-2017, PostgreSQL Global Development Group 
 * Portions Copyright (c) 1994, Regents of the University of California 
 * 
 * 
 * IDENTIFICATION 
 *    src/backend/catalog/pg_proc.c 
 * 
 *------------------------------------------------------------------------- 
 */ 
</span><span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>"access/htup_details.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/xact.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/dependency.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/indexing.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/objectaccess.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_language.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_namespace.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_proc.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_proc_fn.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_transform.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_type.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"commands/defrem.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"executor/functions.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"funcapi.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"mb/pg_wchar.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"miscadmin.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"nodes/nodeFuncs.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parse_type.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"tcop/pquery.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"tcop/tcopprot.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/acl.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/builtins.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/lsyscache.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/regproc.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/rel.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/syscache.h"</span> 
 
 
<span class='Control'>typedef</span> <span class='Control'>struct</span> 
<span class='Delimiter'>{ 
</span><a name="LN46"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Member'>proname</span><span class='Delimiter'>; 
</span><a name="LN47"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Member'>prosrc</span><span class='Delimiter'>; 
</span><a name="LN48"></a>} <span class='Declare_Typedef'>parse_error_callback_arg</span><span class='Delimiter'>; 
</span> 
<a name="LN50"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>sql_function_parse_error_callback</span><span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Declare_Parameter'>arg</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN51"></a><span class='Keyword'>static int </span><span class='Declare_Prototype'>match_prosrc_to_query</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>prosrc</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>queryText</span><span class='Delimiter'>, 
</span><a name="LN52"></a>                      <span class='Keyword'>int </span><span class='Declare_Parameter'>cursorpos</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN53"></a><span class='Keyword'>static bool </span><span class='Declare_Prototype'>match_prosrc_to_literal</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>prosrc</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>literal</span><span class='Delimiter'>, 
</span><a name="LN54"></a>                        <span class='Keyword'>int </span><span class='Declare_Parameter'>cursorpos</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>newcursorpos</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* ---------------------------------------------------------------- 
 *      ProcedureCreate 
 * 
 * Note: allParameterTypes, parameterModes, parameterNames, trftypes, and proconfig 
 * are either arrays of the proper types or NULL.  We declare them Datum, 
 * not "ArrayType *", to avoid importing array.h into pg_proc_fn.h. 
 * ---------------------------------------------------------------- 
 */ 
</span><a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> 
<a name="LN66"></a><span class='Declare_Function'>ProcedureCreate</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>procedureName</span><span class='Delimiter'>, 
</span><a name="LN67"></a>                <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>procNamespace</span><span class='Delimiter'>, 
</span><a name="LN68"></a>                <span class='Keyword'>bool </span><span class='Declare_Parameter'>replace</span><span class='Delimiter'>, 
</span><a name="LN69"></a>                <span class='Keyword'>bool </span><span class='Declare_Parameter'>returnsSet</span><span class='Delimiter'>, 
</span><a name="LN70"></a>                <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>returnType</span><span class='Delimiter'>, 
</span><a name="LN71"></a>                <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>proowner</span><span class='Delimiter'>, 
</span><a name="LN72"></a>                <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>languageObjectId</span><span class='Delimiter'>, 
</span><a name="LN73"></a>                <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>languageValidator</span><span class='Delimiter'>, 
</span><a name="LN74"></a>                <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>prosrc</span><span class='Delimiter'>, 
</span><a name="LN75"></a>                <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>probin</span><span class='Delimiter'>, 
</span><a name="LN76"></a>                <span class='Keyword'>bool </span><span class='Declare_Parameter'>isAgg</span><span class='Delimiter'>, 
</span><a name="LN77"></a>                <span class='Keyword'>bool </span><span class='Declare_Parameter'>isWindowFunc</span><span class='Delimiter'>, 
</span><a name="LN78"></a>                <span class='Keyword'>bool </span><span class='Declare_Parameter'>security_definer</span><span class='Delimiter'>, 
</span><a name="LN79"></a>                <span class='Keyword'>bool </span><span class='Declare_Parameter'>isLeakProof</span><span class='Delimiter'>, 
</span><a name="LN80"></a>                <span class='Keyword'>bool </span><span class='Declare_Parameter'>isStrict</span><span class='Delimiter'>, 
</span><a name="LN81"></a>                <span class='Keyword'>char </span><span class='Declare_Parameter'>volatility</span><span class='Delimiter'>, 
</span><a name="LN82"></a>                <span class='Keyword'>char </span><span class='Declare_Parameter'>parallel</span><span class='Delimiter'>, 
</span><a name="LN83"></a>                <a href="../../include/c.h.html#LN477"><span class='Ref_to_Typedef'>oidvector</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>parameterTypes</span><span class='Delimiter'>, 
</span><a name="LN84"></a>                <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Declare_Parameter'>allParameterTypes</span><span class='Delimiter'>, 
</span><a name="LN85"></a>                <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Declare_Parameter'>parameterModes</span><span class='Delimiter'>, 
</span><a name="LN86"></a>                <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Declare_Parameter'>parameterNames</span><span class='Delimiter'>, 
</span><a name="LN87"></a>                <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>parameterDefaults</span><span class='Delimiter'>, 
</span><a name="LN88"></a>                <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Declare_Parameter'>trftypes</span><span class='Delimiter'>, 
</span><a name="LN89"></a>                <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Declare_Parameter'>proconfig</span><span class='Delimiter'>, 
</span><a name="LN90"></a>                <a href="../../include/c.h.html#LN379"><span class='Ref_to_Typedef'>float4</span></a> <span class='Declare_Parameter'>procost</span><span class='Delimiter'>, 
</span><a name="LN91"></a>                <a href="../../include/c.h.html#LN379"><span class='Ref_to_Typedef'>float4</span></a> <span class='Declare_Parameter'>prorows</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN93"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>retval</span><span class='Delimiter'>; 
</span><a name="LN94"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>parameterCount</span><span class='Delimiter'>; 
</span><a name="LN95"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>allParamCount</span><span class='Delimiter'>; 
</span><a name="LN96"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>allParams</span><span class='Delimiter'>; 
</span><a name="LN97"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>paramModes</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN98"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>genericInParam</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN99"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>genericOutParam</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN100"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>anyrangeInParam</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN101"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>anyrangeOutParam</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN102"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>internalInParam</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN103"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>internalOutParam</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN104"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>variadicType</span> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span><a name="LN105"></a>    <a href="../../include/utils/acl.h.html#LN98"><span class='Ref_to_Typedef'>Acl</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>proacl</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN106"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>rel</span><span class='Delimiter'>; 
</span><a name="LN107"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tup</span><span class='Delimiter'>; 
</span><a name="LN108"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>oldtup</span><span class='Delimiter'>; 
</span><a name="LN109"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>nulls</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN88"><span class='Ref_to_Const'>Natts_pg_proc</span></a><span class='Delimiter'>]; 
</span><a name="LN110"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>values</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN88"><span class='Ref_to_Const'>Natts_pg_proc</span></a><span class='Delimiter'>]; 
</span><a name="LN111"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>replaces</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN88"><span class='Ref_to_Const'>Natts_pg_proc</span></a><span class='Delimiter'>]; 
</span><a name="LN112"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>relid</span><span class='Delimiter'>; 
</span><a name="LN113"></a>    <a href="../../include/c.h.html#LN492"><span class='Ref_to_Typedef'>NameData</span></a>    <span class='Declare_Local'>procname</span><span class='Delimiter'>; 
</span><a name="LN114"></a>    <a href="../../include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a>   <span class='Declare_Local'>tupDesc</span><span class='Delimiter'>; 
</span><a name="LN115"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>is_update</span><span class='Delimiter'>; 
</span><a name="LN116"></a>    <a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> <span class='Declare_Local'>myself</span><span class='Delimiter'>, 
</span><a name="LN117"></a>                <span class='Declare_Local'>referenced</span><span class='Delimiter'>; 
</span><a name="LN118"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN119"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>trfid</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * sanity checks 
     */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../include/c.h.html#LN525"><span class='Ref_to_Macro'>PointerIsValid</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN74"><span class='Ref_to_Parameter'>prosrc</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="pg_proc.c.html#LN94"><span class='Ref_To_Local'>parameterCount</span></a> <span class='Operator'>= </span><a href="pg_proc.c.html#LN83"><span class='Ref_to_Parameter'>parameterTypes</span></a><span class='Operator'>-&GT;</span><a href="../../include/c.h.html#LN483"><span class='Ref_to_Member'>dim1</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN94"><span class='Ref_To_Local'>parameterCount</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="pg_proc.c.html#LN94"><span class='Ref_To_Local'>parameterCount</span></a> <span class='Operator'>&GT; </span><a href="../../include/pg_config_manual.h.html#LN36"><span class='Ref_to_Const'>FUNC_MAX_ARGS</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_TOO_MANY_ARGUMENTS<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN848"><span class='Ref_to_Func'>errmsg_plural</span></a><span class='Parentheses'>(</span><span class='String'>"functions cannot have more than %d argument"</span><span class='Delimiter'>, 
</span>                               <span class='String'>"functions cannot have more than %d arguments"</span><span class='Delimiter'>, 
</span>                               <a href="../../include/pg_config_manual.h.html#LN36"><span class='Ref_to_Const'>FUNC_MAX_ARGS</span></a><span class='Delimiter'>, 
</span>                               <a href="../../include/pg_config_manual.h.html#LN36"><span class='Ref_to_Const'>FUNC_MAX_ARGS</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* note: the above is correct, we do NOT count output arguments */ 
</span> 
    <span class='Comment_Multi_Line'>/* Deconstruct array inputs */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN84"><span class='Ref_to_Parameter'>allParameterTypes</span></a> <span class='Operator'>!= </span><a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * We expect the array to be a 1-D OID array; verify that. We don't 
         * need to use deconstruct_array() since the array data is just going 
         * to look like a C array of OID values. 
         */ 
</span><a name="LN144"></a>        <a href="../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>allParamArray</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN84"><span class='Ref_to_Parameter'>allParameterTypes</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="pg_proc.c.html#LN95"><span class='Ref_To_Local'>allParamCount</span></a> <span class='Operator'>= </span><a href="../../include/utils/array.h.html#LN274"><span class='Ref_to_Macro'>ARR_DIMS</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN144"><span class='Ref_To_Local'>allParamArray</span></a><span class='Parentheses'>)</span><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/utils/array.h.html#LN270"><span class='Ref_to_Macro'>ARR_NDIM</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN144"><span class='Ref_To_Local'>allParamArray</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>1</span> <span class='Operator'>|| 
</span>            <a href="pg_proc.c.html#LN95"><span class='Ref_To_Local'>allParamCount</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>            <a href="../../include/utils/array.h.html#LN271"><span class='Ref_to_Macro'>ARR_HASNULL</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN144"><span class='Ref_To_Local'>allParamArray</span></a><span class='Parentheses'>) </span><span class='Operator'>|| 
</span>            <a href="../../include/utils/array.h.html#LN272"><span class='Ref_to_Macro'>ARR_ELEMTYPE</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN144"><span class='Ref_To_Local'>allParamArray</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="../../interfaces/ecpg/ecpglib/pg_type.h.html#LN27"><span class='Ref_to_Const'>OIDOID</span></a><span class='Parentheses'>)</span> 
            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"allParameterTypes is not a 1-D Oid array"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="pg_proc.c.html#LN96"><span class='Ref_To_Local'>allParams</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/utils/array.h.html#LN302"><span class='Ref_to_Macro'>ARR_DATA_PTR</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN144"><span class='Ref_To_Local'>allParamArray</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN95"><span class='Ref_To_Local'>allParamCount</span></a> <span class='Operator'>&GT;= </span><a href="pg_proc.c.html#LN94"><span class='Ref_To_Local'>parameterCount</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* we assume caller got the contents right */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="pg_proc.c.html#LN95"><span class='Ref_To_Local'>allParamCount</span></a> <span class='Operator'>= </span><a href="pg_proc.c.html#LN94"><span class='Ref_To_Local'>parameterCount</span></a><span class='Delimiter'>; 
</span>        <a href="pg_proc.c.html#LN96"><span class='Ref_To_Local'>allParams</span></a> <span class='Operator'>= </span><a href="pg_proc.c.html#LN83"><span class='Ref_to_Parameter'>parameterTypes</span></a><span class='Operator'>-&GT;</span><a href="../../include/c.h.html#LN485"><span class='Ref_to_Member'>values</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN85"><span class='Ref_to_Parameter'>parameterModes</span></a> <span class='Operator'>!= </span><a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * We expect the array to be a 1-D CHAR array; verify that. We don't 
         * need to use deconstruct_array() since the array data is just going 
         * to look like a C array of char values. 
         */ 
</span><a name="LN169"></a>        <a href="../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>modesArray</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN85"><span class='Ref_to_Parameter'>parameterModes</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/utils/array.h.html#LN270"><span class='Ref_to_Macro'>ARR_NDIM</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN169"><span class='Ref_To_Local'>modesArray</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>1</span> <span class='Operator'>|| 
</span>            <a href="../../include/utils/array.h.html#LN274"><span class='Ref_to_Macro'>ARR_DIMS</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN169"><span class='Ref_To_Local'>modesArray</span></a><span class='Parentheses'>)</span><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>!= </span><a href="pg_proc.c.html#LN95"><span class='Ref_To_Local'>allParamCount</span></a> <span class='Operator'>|| 
</span>            <a href="../../include/utils/array.h.html#LN271"><span class='Ref_to_Macro'>ARR_HASNULL</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN169"><span class='Ref_To_Local'>modesArray</span></a><span class='Parentheses'>) </span><span class='Operator'>|| 
</span>            <a href="../../include/utils/array.h.html#LN272"><span class='Ref_to_Macro'>ARR_ELEMTYPE</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN169"><span class='Ref_To_Local'>modesArray</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="../../interfaces/ecpg/ecpglib/pg_type.h.html#LN19"><span class='Ref_to_Const'>CHAROID</span></a><span class='Parentheses'>)</span> 
            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"parameterModes is not a 1-D char array"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="pg_proc.c.html#LN97"><span class='Ref_To_Local'>paramModes</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/utils/array.h.html#LN302"><span class='Ref_to_Macro'>ARR_DATA_PTR</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN169"><span class='Ref_To_Local'>modesArray</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Detect whether we have polymorphic or INTERNAL arguments.  The first 
     * loop checks input arguments, the second output arguments. 
     */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="pg_proc.c.html#LN94"><span class='Ref_To_Local'>parameterCount</span></a><span class='Delimiter'>; </span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN83"><span class='Ref_to_Parameter'>parameterTypes</span></a><span class='Operator'>-&GT;</span><a href="../../include/c.h.html#LN485"><span class='Ref_to_Member'>values</span></a><span class='Delimiter'>[</span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>case</span> <a href="../../include/catalog/pg_type.h.html#LN687"><span class='Ref_to_Const'>ANYARRAYOID</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../include/catalog/pg_type.h.html#LN701"><span class='Ref_to_Const'>ANYELEMENTOID</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../include/catalog/pg_type.h.html#LN703"><span class='Ref_to_Const'>ANYNONARRAYOID</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../include/catalog/pg_type.h.html#LN705"><span class='Ref_to_Const'>ANYENUMOID</span></a><span class='Operator'>: 
</span>                <a href="pg_proc.c.html#LN98"><span class='Ref_To_Local'>genericInParam</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="../../include/catalog/pg_type.h.html#LN713"><span class='Ref_to_Const'>ANYRANGEOID</span></a><span class='Operator'>: 
</span>                <a href="pg_proc.c.html#LN98"><span class='Ref_To_Local'>genericInParam</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="pg_proc.c.html#LN100"><span class='Ref_To_Local'>anyrangeInParam</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="../../include/catalog/pg_type.h.html#LN697"><span class='Ref_to_Const'>INTERNALOID</span></a><span class='Operator'>: 
</span>                <a href="pg_proc.c.html#LN102"><span class='Ref_To_Local'>internalInParam</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN84"><span class='Ref_to_Parameter'>allParameterTypes</span></a> <span class='Operator'>!= </span><a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="pg_proc.c.html#LN95"><span class='Ref_To_Local'>allParamCount</span></a><span class='Delimiter'>; </span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN97"><span class='Ref_To_Local'>paramModes</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| 
</span>                <a href="pg_proc.c.html#LN97"><span class='Ref_To_Local'>paramModes</span></a><span class='Delimiter'>[</span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>== </span><a href="../../include/catalog/pg_proc.h.html#LN5500"><span class='Ref_to_Const'>PROARGMODE_IN</span></a> <span class='Operator'>|| 
</span>                <a href="pg_proc.c.html#LN97"><span class='Ref_To_Local'>paramModes</span></a><span class='Delimiter'>[</span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>== </span><a href="../../include/catalog/pg_proc.h.html#LN5503"><span class='Ref_to_Const'>PROARGMODE_VARIADIC</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* ignore input-only params */ 
</span> 
            <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN96"><span class='Ref_To_Local'>allParams</span></a><span class='Delimiter'>[</span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>case</span> <a href="../../include/catalog/pg_type.h.html#LN687"><span class='Ref_to_Const'>ANYARRAYOID</span></a><span class='Operator'>: 
</span>                <span class='Control'>case</span> <a href="../../include/catalog/pg_type.h.html#LN701"><span class='Ref_to_Const'>ANYELEMENTOID</span></a><span class='Operator'>: 
</span>                <span class='Control'>case</span> <a href="../../include/catalog/pg_type.h.html#LN703"><span class='Ref_to_Const'>ANYNONARRAYOID</span></a><span class='Operator'>: 
</span>                <span class='Control'>case</span> <a href="../../include/catalog/pg_type.h.html#LN705"><span class='Ref_to_Const'>ANYENUMOID</span></a><span class='Operator'>: 
</span>                    <a href="pg_proc.c.html#LN99"><span class='Ref_To_Local'>genericOutParam</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Control'>case</span> <a href="../../include/catalog/pg_type.h.html#LN713"><span class='Ref_to_Const'>ANYRANGEOID</span></a><span class='Operator'>: 
</span>                    <a href="pg_proc.c.html#LN99"><span class='Ref_To_Local'>genericOutParam</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                    <a href="pg_proc.c.html#LN101"><span class='Ref_To_Local'>anyrangeOutParam</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Control'>case</span> <a href="../../include/catalog/pg_type.h.html#LN697"><span class='Ref_to_Const'>INTERNALOID</span></a><span class='Operator'>: 
</span>                    <a href="pg_proc.c.html#LN103"><span class='Ref_To_Local'>internalOutParam</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=0;i&LT;allParamCount;i... &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if allParameterTypes!=Po... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* 
     * Do not allow polymorphic return type unless at least one input argument 
     * is polymorphic.  ANYRANGE return type is even stricter: must have an 
     * ANYRANGE input (since we can't deduce the specific range type from 
     * ANYELEMENT).  Also, do not allow return type INTERNAL unless at least 
     * one input argument is INTERNAL. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="../../include/catalog/pg_type.h.html#LN744"><span class='Ref_to_Macro'>IsPolymorphicType</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN70"><span class='Ref_to_Parameter'>returnType</span></a><span class='Parentheses'>) </span><span class='Operator'>|| </span><a href="pg_proc.c.html#LN99"><span class='Ref_To_Local'>genericOutParam</span></a><span class='Parentheses'>)</span> 
        <span class='Operator'>&& !</span><a href="pg_proc.c.html#LN98"><span class='Ref_To_Local'>genericInParam</span></a><span class='Parentheses'>)</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_FUNCTION_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot determine result data type"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN871"><span class='Ref_to_Func'>errdetail</span></a><span class='Parentheses'>(</span><span class='String'>"A function returning a polymorphic type must have at least one polymorphic argument."</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="pg_proc.c.html#LN70"><span class='Ref_to_Parameter'>returnType</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_type.h.html#LN713"><span class='Ref_to_Const'>ANYRANGEOID</span></a> <span class='Operator'>|| </span><a href="pg_proc.c.html#LN101"><span class='Ref_To_Local'>anyrangeOutParam</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>        <span class='Operator'>!</span><a href="pg_proc.c.html#LN100"><span class='Ref_To_Local'>anyrangeInParam</span></a><span class='Parentheses'>)</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_FUNCTION_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot determine result data type"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN871"><span class='Ref_to_Func'>errdetail</span></a><span class='Parentheses'>(</span><span class='String'>"A function returning \"anyrange\" must have at least one \"anyrange\" argument."</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="pg_proc.c.html#LN70"><span class='Ref_to_Parameter'>returnType</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_type.h.html#LN697"><span class='Ref_to_Const'>INTERNALOID</span></a> <span class='Operator'>|| </span><a href="pg_proc.c.html#LN103"><span class='Ref_To_Local'>internalOutParam</span></a><span class='Parentheses'>) </span><span class='Operator'>&& !</span><a href="pg_proc.c.html#LN102"><span class='Ref_To_Local'>internalInParam</span></a><span class='Parentheses'>)</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_FUNCTION_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"unsafe use of pseudo-type \"internal\""</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN871"><span class='Ref_to_Func'>errdetail</span></a><span class='Parentheses'>(</span><span class='String'>"A function returning \"internal\" must have at least one \"internal\" argument."</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * don't allow functions of complex types that have the same name as 
     * existing attributes of the type 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN94"><span class='Ref_To_Local'>parameterCount</span></a> <span class='Operator'>== </span><span class='Number'>1</span> <span class='Operator'>&& 
</span>        <a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN83"><span class='Ref_to_Parameter'>parameterTypes</span></a><span class='Operator'>-&GT;</span><a href="../../include/c.h.html#LN485"><span class='Ref_to_Member'>values</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span> <span class='Operator'>&& 
</span>        <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN112"><span class='Ref_To_Local'>relid</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_type.h.html#LN47"><span class='Ref_to_Proto'>typeidTypeRelid</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN83"><span class='Ref_to_Parameter'>parameterTypes</span></a><span class='Operator'>-&GT;</span><a href="../../include/c.h.html#LN485"><span class='Ref_to_Member'>values</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a> <span class='Operator'>&& 
</span>        <a href="../../include/utils/lsyscache.h.html#LN87"><span class='Ref_to_Proto'>get_attnum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN112"><span class='Ref_To_Local'>relid</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN66"><span class='Ref_to_Parameter'>procedureName</span></a><span class='Parentheses'>)</span> <span class='Operator'>!= </span><a href="../../include/access/attnum.h.html#LN22"><span class='Ref_to_Const'>InvalidAttrNumber</span></a><span class='Parentheses'>)</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DUPLICATE_COLUMN<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"\"%s\" is already an attribute of type %s"</span><span class='Delimiter'>, 
</span>                        <a href="pg_proc.c.html#LN66"><span class='Ref_to_Parameter'>procedureName</span></a><span class='Delimiter'>, 
</span>                        <a href="../utils/adt/format_type.c.html#LN92"><span class='Ref_to_Func'>format_type_be</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN83"><span class='Ref_to_Parameter'>parameterTypes</span></a><span class='Operator'>-&GT;</span><a href="../../include/c.h.html#LN485"><span class='Ref_to_Member'>values</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN97"><span class='Ref_To_Local'>paramModes</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Only the last input parameter can be variadic; if it is, save its 
         * element type.  Errors here are just elog since caller should have 
         * checked this already. 
         */ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="pg_proc.c.html#LN95"><span class='Ref_To_Local'>allParamCount</span></a><span class='Delimiter'>; </span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN97"><span class='Ref_To_Local'>paramModes</span></a><span class='Delimiter'>[</span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>case</span> <a href="../../include/catalog/pg_proc.h.html#LN5500"><span class='Ref_to_Const'>PROARGMODE_IN</span></a><span class='Operator'>: 
</span>                <span class='Control'>case</span> <a href="../../include/catalog/pg_proc.h.html#LN5502"><span class='Ref_to_Const'>PROARGMODE_INOUT</span></a><span class='Operator'>: 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN104"><span class='Ref_To_Local'>variadicType</span></a><span class='Parentheses'>))</span> 
                        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"variadic parameter must be last"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Control'>case</span> <a href="../../include/catalog/pg_proc.h.html#LN5501"><span class='Ref_to_Const'>PROARGMODE_OUT</span></a><span class='Operator'>: 
</span>                <span class='Control'>case</span> <a href="../../include/catalog/pg_proc.h.html#LN5504"><span class='Ref_to_Const'>PROARGMODE_TABLE</span></a><span class='Operator'>: 
</span>                    <span class='Comment_Multi_Line'>/* okay */ 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Control'>case</span> <a href="../../include/catalog/pg_proc.h.html#LN5503"><span class='Ref_to_Const'>PROARGMODE_VARIADIC</span></a><span class='Operator'>: 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN104"><span class='Ref_To_Local'>variadicType</span></a><span class='Parentheses'>))</span> 
                        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"variadic parameter must be last"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN96"><span class='Ref_To_Local'>allParams</span></a><span class='Delimiter'>[</span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <span class='Control'>case</span> <a href="../../include/catalog/pg_type.h.html#LN685"><span class='Ref_to_Const'>ANYOID</span></a><span class='Operator'>: 
</span>                            <a href="pg_proc.c.html#LN104"><span class='Ref_To_Local'>variadicType</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_type.h.html#LN685"><span class='Ref_to_Const'>ANYOID</span></a><span class='Delimiter'>; 
</span>                            <span class='Control'>break</span><span class='Delimiter'>; 
</span>                        <span class='Control'>case</span> <a href="../../include/catalog/pg_type.h.html#LN687"><span class='Ref_to_Const'>ANYARRAYOID</span></a><span class='Operator'>: 
</span>                            <a href="pg_proc.c.html#LN104"><span class='Ref_To_Local'>variadicType</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_type.h.html#LN701"><span class='Ref_to_Const'>ANYELEMENTOID</span></a><span class='Delimiter'>; 
</span>                            <span class='Control'>break</span><span class='Delimiter'>; 
</span>                        <span class='Control'>default</span><span class='Operator'>: 
</span>                            <a href="pg_proc.c.html#LN104"><span class='Ref_To_Local'>variadicType</span></a> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN157"><span class='Ref_to_Proto'>get_element_type</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN96"><span class='Ref_To_Local'>allParams</span></a><span class='Delimiter'>[</span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN104"><span class='Ref_To_Local'>variadicType</span></a><span class='Parentheses'>))</span> 
                                <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"variadic parameter is not an array"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                            <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Control'>default</span><span class='Operator'>: 
</span>                    <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"invalid parameter mode '%c'"</span><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN97"><span class='Ref_To_Local'>paramModes</span></a><span class='Delimiter'>[</span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch paramModes[i] &raquo; </span> 
        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=0;i&LT;allParamCount;i... &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if paramModes!=NULL &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* 
     * All seems OK; prepare the data to be inserted into pg_proc. 
     */ 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="../../include/catalog/pg_proc.h.html#LN88"><span class='Ref_to_Const'>Natts_pg_proc</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pg_proc.c.html#LN109"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>) </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="pg_proc.c.html#LN111"><span class='Ref_To_Local'>replaces</span></a><span class='Delimiter'>[</span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../include/utils/builtins.h.html#LN40"><span class='Ref_to_Proto'>namestrcpy</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="pg_proc.c.html#LN113"><span class='Ref_To_Local'>procname</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN66"><span class='Ref_to_Parameter'>procedureName</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN89"><span class='Ref_to_Const'>Anum_pg_proc_proname</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN600"><span class='Ref_to_Macro'>NameGetDatum</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="pg_proc.c.html#LN113"><span class='Ref_To_Local'>procname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN90"><span class='Ref_to_Const'>Anum_pg_proc_pronamespace</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN67"><span class='Ref_to_Parameter'>procNamespace</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN91"><span class='Ref_to_Const'>Anum_pg_proc_proowner</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN71"><span class='Ref_to_Parameter'>proowner</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN92"><span class='Ref_to_Const'>Anum_pg_proc_prolang</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN72"><span class='Ref_to_Parameter'>languageObjectId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN93"><span class='Ref_to_Const'>Anum_pg_proc_procost</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN696"><span class='Ref_to_Func'>Float4GetDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN90"><span class='Ref_to_Parameter'>procost</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN94"><span class='Ref_to_Const'>Anum_pg_proc_prorows</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN696"><span class='Ref_to_Func'>Float4GetDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN91"><span class='Ref_to_Parameter'>prorows</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN95"><span class='Ref_to_Const'>Anum_pg_proc_provariadic</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN104"><span class='Ref_To_Local'>variadicType</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN96"><span class='Ref_to_Const'>Anum_pg_proc_protransform</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN97"><span class='Ref_to_Const'>Anum_pg_proc_proisagg</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN76"><span class='Ref_to_Parameter'>isAgg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN98"><span class='Ref_to_Const'>Anum_pg_proc_proiswindow</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN77"><span class='Ref_to_Parameter'>isWindowFunc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN99"><span class='Ref_to_Const'>Anum_pg_proc_prosecdef</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN78"><span class='Ref_to_Parameter'>security_definer</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN100"><span class='Ref_to_Const'>Anum_pg_proc_proleakproof</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN79"><span class='Ref_to_Parameter'>isLeakProof</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN101"><span class='Ref_to_Const'>Anum_pg_proc_proisstrict</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN80"><span class='Ref_to_Parameter'>isStrict</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN102"><span class='Ref_to_Const'>Anum_pg_proc_proretset</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN69"><span class='Ref_to_Parameter'>returnsSet</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN103"><span class='Ref_to_Const'>Anum_pg_proc_provolatile</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN421"><span class='Ref_to_Macro'>CharGetDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN81"><span class='Ref_to_Parameter'>volatility</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN104"><span class='Ref_to_Const'>Anum_pg_proc_proparallel</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN421"><span class='Ref_to_Macro'>CharGetDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN82"><span class='Ref_to_Parameter'>parallel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN105"><span class='Ref_to_Const'>Anum_pg_proc_pronargs</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN470"><span class='Ref_to_Macro'>UInt16GetDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN94"><span class='Ref_To_Local'>parameterCount</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN106"><span class='Ref_to_Const'>Anum_pg_proc_pronargdefaults</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN470"><span class='Ref_to_Macro'>UInt16GetDatum</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN87"><span class='Ref_to_Parameter'>parameterDefaults</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN107"><span class='Ref_to_Const'>Anum_pg_proc_prorettype</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN70"><span class='Ref_to_Parameter'>returnType</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN108"><span class='Ref_to_Const'>Anum_pg_proc_proargtypes</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN83"><span class='Ref_to_Parameter'>parameterTypes</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN84"><span class='Ref_to_Parameter'>allParameterTypes</span></a> <span class='Operator'>!= </span><a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Parentheses'>))</span> 
        <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN109"><span class='Ref_to_Const'>Anum_pg_proc_proallargtypes</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="pg_proc.c.html#LN84"><span class='Ref_to_Parameter'>allParameterTypes</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="pg_proc.c.html#LN109"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN109"><span class='Ref_to_Const'>Anum_pg_proc_proallargtypes</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN85"><span class='Ref_to_Parameter'>parameterModes</span></a> <span class='Operator'>!= </span><a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Parentheses'>))</span> 
        <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN110"><span class='Ref_to_Const'>Anum_pg_proc_proargmodes</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="pg_proc.c.html#LN85"><span class='Ref_to_Parameter'>parameterModes</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="pg_proc.c.html#LN109"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN110"><span class='Ref_to_Const'>Anum_pg_proc_proargmodes</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN86"><span class='Ref_to_Parameter'>parameterNames</span></a> <span class='Operator'>!= </span><a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Parentheses'>))</span> 
        <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN111"><span class='Ref_to_Const'>Anum_pg_proc_proargnames</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="pg_proc.c.html#LN86"><span class='Ref_to_Parameter'>parameterNames</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="pg_proc.c.html#LN109"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN111"><span class='Ref_to_Const'>Anum_pg_proc_proargnames</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN87"><span class='Ref_to_Parameter'>parameterDefaults</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>        <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN112"><span class='Ref_to_Const'>Anum_pg_proc_proargdefaults</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/utils/builtins.h.html#LN90"><span class='Ref_to_Macro'>CStringGetTextDatum</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN598"><span class='Ref_to_Proto'>nodeToString</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN87"><span class='Ref_to_Parameter'>parameterDefaults</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="pg_proc.c.html#LN109"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN112"><span class='Ref_to_Const'>Anum_pg_proc_proargdefaults</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN88"><span class='Ref_to_Parameter'>trftypes</span></a> <span class='Operator'>!= </span><a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Parentheses'>))</span> 
        <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN113"><span class='Ref_to_Const'>Anum_pg_proc_protrftypes</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="pg_proc.c.html#LN88"><span class='Ref_to_Parameter'>trftypes</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="pg_proc.c.html#LN109"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN113"><span class='Ref_to_Const'>Anum_pg_proc_protrftypes</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN114"><span class='Ref_to_Const'>Anum_pg_proc_prosrc</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/utils/builtins.h.html#LN90"><span class='Ref_to_Macro'>CStringGetTextDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN74"><span class='Ref_to_Parameter'>prosrc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN75"><span class='Ref_to_Parameter'>probin</span></a><span class='Parentheses'>) 
</span>        <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN115"><span class='Ref_to_Const'>Anum_pg_proc_probin</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/utils/builtins.h.html#LN90"><span class='Ref_to_Macro'>CStringGetTextDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN75"><span class='Ref_to_Parameter'>probin</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="pg_proc.c.html#LN109"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN115"><span class='Ref_to_Const'>Anum_pg_proc_probin</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN89"><span class='Ref_to_Parameter'>proconfig</span></a> <span class='Operator'>!= </span><a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Parentheses'>))</span> 
        <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN116"><span class='Ref_to_Const'>Anum_pg_proc_proconfig</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="pg_proc.c.html#LN89"><span class='Ref_to_Parameter'>proconfig</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="pg_proc.c.html#LN109"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN116"><span class='Ref_to_Const'>Anum_pg_proc_proconfig</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* proacl will be determined later */ 
</span> 
    <a href="pg_proc.c.html#LN106"><span class='Ref_To_Local'>rel</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN91"><span class='Ref_to_Proto'>heap_open</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_proc.h.html#LN32"><span class='Ref_to_Const'>ProcedureRelationId</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN114"><span class='Ref_To_Local'>tupDesc</span></a> <span class='Operator'>= </span><a href="../../include/utils/rel.h.html#LN428"><span class='Ref_to_Macro'>RelationGetDescr</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN106"><span class='Ref_To_Local'>rel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Check for pre-existing definition */ 
</span>    <a href="pg_proc.c.html#LN108"><span class='Ref_To_Local'>oldtup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN159"><span class='Ref_to_Macro'>SearchSysCache3</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN75"><span class='Ref_to_EnumConst'>PROCNAMEARGSNSP</span></a><span class='Delimiter'>, 
</span>                             <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN66"><span class='Ref_to_Parameter'>procedureName</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN83"><span class='Ref_to_Parameter'>parameterTypes</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN67"><span class='Ref_to_Parameter'>procNamespace</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN108"><span class='Ref_To_Local'>oldtup</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* There is one; okay to replace it? */ 
</span><a name="LN392"></a>        <a href="../../include/catalog/pg_proc.h.html#LN82"><span class='Ref_to_Typedef'>Form_pg_proc</span></a> <span class='Declare_Local'>oldproc</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_proc.h.html#LN82"><span class='Ref_to_Typedef'>Form_pg_proc</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN108"><span class='Ref_To_Local'>oldtup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN393"></a>        <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>proargnames</span><span class='Delimiter'>; 
</span><a name="LN394"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>isnull</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="pg_proc.c.html#LN68"><span class='Ref_to_Parameter'>replace</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DUPLICATE_FUNCTION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>            <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"function \"%s\" already exists with same argument types"</span><span class='Delimiter'>, 
</span>                   <a href="pg_proc.c.html#LN66"><span class='Ref_to_Parameter'>procedureName</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/acl.h.html#LN311"><span class='Ref_to_Proto'>pg_proc_ownercheck</span></a><span class='Parentheses'>(</span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN108"><span class='Ref_To_Local'>oldtup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN71"><span class='Ref_to_Parameter'>proowner</span></a><span class='Parentheses'>))</span> 
            <a href="../../include/utils/acl.h.html#LN295"><span class='Ref_to_Proto'>aclcheck_error</span></a><span class='Parentheses'>(</span><a href="../../include/utils/acl.h.html#LN173"><span class='Ref_to_EnumConst'>ACLCHECK_NOT_OWNER</span></a><span class='Delimiter'>, </span><a href="../../include/utils/acl.h.html#LN184"><span class='Ref_to_EnumConst'>ACL_KIND_PROC</span></a><span class='Delimiter'>, 
</span>                           <a href="pg_proc.c.html#LN66"><span class='Ref_to_Parameter'>procedureName</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Not okay to change the return type of the existing proc, since 
         * existing rules, views, etc may depend on the return type. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN70"><span class='Ref_to_Parameter'>returnType</span></a> <span class='Operator'>!= </span><a href="pg_proc.c.html#LN392"><span class='Ref_To_Local'>oldproc</span></a><span class='Operator'>-&GT;</span>prorettype <span class='Operator'>|| 
</span>            <a href="pg_proc.c.html#LN69"><span class='Ref_to_Parameter'>returnsSet</span></a> <span class='Operator'>!= </span><a href="pg_proc.c.html#LN392"><span class='Ref_To_Local'>oldproc</span></a><span class='Operator'>-&GT;</span>proretset<span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_FUNCTION_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot change return type of existing function"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN985"><span class='Ref_to_Func'>errhint</span></a><span class='Parentheses'>(</span><span class='String'>"Use DROP FUNCTION %s first."</span><span class='Delimiter'>, 
</span>                             <a href="../../include/utils/regproc.h.html#LN18"><span class='Ref_to_Proto'>format_procedure</span></a><span class='Parentheses'>(</span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN108"><span class='Ref_To_Local'>oldtup</span></a><span class='Parentheses'>)))))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If it returns RECORD, check for possible change of record type 
         * implied by OUT parameters 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN70"><span class='Ref_to_Parameter'>returnType</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_type.h.html#LN679"><span class='Ref_to_Const'>RECORDOID</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN423"></a>            <a href="../../include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a>   <span class='Declare_Local'>olddesc</span><span class='Delimiter'>; 
</span><a name="LN424"></a>            <a href="../../include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a>   <span class='Declare_Local'>newdesc</span><span class='Delimiter'>; 
</span> 
            <a href="pg_proc.c.html#LN423"><span class='Ref_To_Local'>olddesc</span></a> <span class='Operator'>= </span><a href="../../include/funcapi.h.html#LN184"><span class='Ref_to_Proto'>build_function_result_tupdesc_t</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN108"><span class='Ref_To_Local'>oldtup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="pg_proc.c.html#LN424"><span class='Ref_To_Local'>newdesc</span></a> <span class='Operator'>= </span><a href="../../include/funcapi.h.html#LN181"><span class='Ref_to_Proto'>build_function_result_tupdesc_d</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN84"><span class='Ref_to_Parameter'>allParameterTypes</span></a><span class='Delimiter'>, 
</span>                                                      <a href="pg_proc.c.html#LN85"><span class='Ref_to_Parameter'>parameterModes</span></a><span class='Delimiter'>, 
</span>                                                      <a href="pg_proc.c.html#LN86"><span class='Ref_to_Parameter'>parameterNames</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN423"><span class='Ref_To_Local'>olddesc</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="pg_proc.c.html#LN424"><span class='Ref_To_Local'>newdesc</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                 <span class='Comment_Multi_Line'>/* ok, both are runtime-defined RECORDs */ </span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN423"><span class='Ref_To_Local'>olddesc</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span><a href="pg_proc.c.html#LN424"><span class='Ref_To_Local'>newdesc</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| 
</span>                     <span class='Operator'>!</span><a href="../../include/access/tupdesc.h.html#LN112"><span class='Ref_to_Proto'>equalTupleDescs</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN423"><span class='Ref_To_Local'>olddesc</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN424"><span class='Ref_To_Local'>newdesc</span></a><span class='Parentheses'>))</span> 
                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_FUNCTION_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                    <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot change return type of existing function"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                <a href="../utils/error/elog.c.html#LN871"><span class='Ref_to_Func'>errdetail</span></a><span class='Parentheses'>(</span><span class='String'>"Row type defined by OUT parameters is different."</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN985"><span class='Ref_to_Func'>errhint</span></a><span class='Parentheses'>(</span><span class='String'>"Use DROP FUNCTION %s first."</span><span class='Delimiter'>, 
</span>                                 <a href="../../include/utils/regproc.h.html#LN18"><span class='Ref_to_Proto'>format_procedure</span></a><span class='Parentheses'>(</span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN108"><span class='Ref_To_Local'>oldtup</span></a><span class='Parentheses'>)))))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if returnType==RECORDOID &raquo; </span> 
 
        <span class='Comment_Multi_Line'>/* 
         * If there were any named input parameters, check to make sure the 
         * names have not been changed, as this could break existing calls. We 
         * allow adding names to formerly unnamed parameters, though. 
         */ 
</span>        <a href="pg_proc.c.html#LN393"><span class='Ref_To_Local'>proargnames</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN133"><span class='Ref_to_Proto'>SysCacheGetAttr</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN75"><span class='Ref_to_EnumConst'>PROCNAMEARGSNSP</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN108"><span class='Ref_To_Local'>oldtup</span></a><span class='Delimiter'>, 
</span>                                      <a href="../../include/catalog/pg_proc.h.html#LN111"><span class='Ref_to_Const'>Anum_pg_proc_proargnames</span></a><span class='Delimiter'>, 
</span>                                      <span class='Operator'>&</span><a href="pg_proc.c.html#LN394"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="pg_proc.c.html#LN394"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN452"></a>            <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>proargmodes</span><span class='Delimiter'>; 
</span><a name="LN453"></a>            <span class='Keyword'>char</span>      <span class='Operator'>**</span><span class='Declare_Local'>old_arg_names</span><span class='Delimiter'>; 
</span><a name="LN454"></a>            <span class='Keyword'>char</span>      <span class='Operator'>**</span><span class='Declare_Local'>new_arg_names</span><span class='Delimiter'>; 
</span><a name="LN455"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>n_old_arg_names</span><span class='Delimiter'>; 
</span><a name="LN456"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>n_new_arg_names</span><span class='Delimiter'>; 
</span><a name="LN457"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span> 
            <a href="pg_proc.c.html#LN452"><span class='Ref_To_Local'>proargmodes</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN133"><span class='Ref_to_Proto'>SysCacheGetAttr</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN75"><span class='Ref_to_EnumConst'>PROCNAMEARGSNSP</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN108"><span class='Ref_To_Local'>oldtup</span></a><span class='Delimiter'>, 
</span>                                          <a href="../../include/catalog/pg_proc.h.html#LN110"><span class='Ref_to_Const'>Anum_pg_proc_proargmodes</span></a><span class='Delimiter'>, 
</span>                                          <span class='Operator'>&</span><a href="pg_proc.c.html#LN394"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN394"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>) 
</span>                <a href="pg_proc.c.html#LN452"><span class='Ref_To_Local'>proargmodes</span></a> <span class='Operator'>= </span><a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* just to be sure */ 
</span> 
            <a href="pg_proc.c.html#LN455"><span class='Ref_To_Local'>n_old_arg_names</span></a> <span class='Operator'>= </span><a href="../../include/funcapi.h.html#LN175"><span class='Ref_to_Proto'>get_func_input_arg_names</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN393"><span class='Ref_To_Local'>proargnames</span></a><span class='Delimiter'>, 
</span>                                                       <a href="pg_proc.c.html#LN452"><span class='Ref_To_Local'>proargmodes</span></a><span class='Delimiter'>, 
</span>                                                       <span class='Operator'>&</span><a href="pg_proc.c.html#LN453"><span class='Ref_To_Local'>old_arg_names</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="pg_proc.c.html#LN456"><span class='Ref_To_Local'>n_new_arg_names</span></a> <span class='Operator'>= </span><a href="../../include/funcapi.h.html#LN175"><span class='Ref_to_Proto'>get_func_input_arg_names</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN86"><span class='Ref_to_Parameter'>parameterNames</span></a><span class='Delimiter'>, 
</span>                                                       <a href="pg_proc.c.html#LN85"><span class='Ref_to_Parameter'>parameterModes</span></a><span class='Delimiter'>, 
</span>                                                       <span class='Operator'>&</span><a href="pg_proc.c.html#LN454"><span class='Ref_To_Local'>new_arg_names</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN457"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="pg_proc.c.html#LN457"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><a href="pg_proc.c.html#LN455"><span class='Ref_To_Local'>n_old_arg_names</span></a><span class='Delimiter'>; </span><a href="pg_proc.c.html#LN457"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN453"><span class='Ref_To_Local'>old_arg_names</span></a><span class='Delimiter'>[</span><a href="pg_proc.c.html#LN457"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                    <span class='Control'>continue</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN457"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&GT;= </span><a href="pg_proc.c.html#LN456"><span class='Ref_To_Local'>n_new_arg_names</span></a> <span class='Operator'>|| </span><a href="pg_proc.c.html#LN454"><span class='Ref_To_Local'>new_arg_names</span></a><span class='Delimiter'>[</span><a href="pg_proc.c.html#LN457"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| 
</span>                    strcmp<span class='Parentheses'>(</span><a href="pg_proc.c.html#LN453"><span class='Ref_To_Local'>old_arg_names</span></a><span class='Delimiter'>[</span><a href="pg_proc.c.html#LN457"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>], </span><a href="pg_proc.c.html#LN454"><span class='Ref_To_Local'>new_arg_names</span></a><span class='Delimiter'>[</span><a href="pg_proc.c.html#LN457"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_FUNCTION_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                       <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot change name of input parameter \"%s\""</span><span class='Delimiter'>, 
</span>                              <a href="pg_proc.c.html#LN453"><span class='Ref_To_Local'>old_arg_names</span></a><span class='Delimiter'>[</span><a href="pg_proc.c.html#LN457"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN985"><span class='Ref_to_Func'>errhint</span></a><span class='Parentheses'>(</span><span class='String'>"Use DROP FUNCTION %s first."</span><span class='Delimiter'>, 
</span>                                <a href="../../include/utils/regproc.h.html#LN18"><span class='Ref_to_Proto'>format_procedure</span></a><span class='Parentheses'>(</span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN108"><span class='Ref_To_Local'>oldtup</span></a><span class='Parentheses'>)))))</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if !isnull &raquo; </span> 
 
        <span class='Comment_Multi_Line'>/* 
         * If there are existing defaults, check compatibility: redefinition 
         * must not remove any defaults nor change their types.  (Removing a 
         * default might cause a function to fail to satisfy an existing call. 
         * Changing type would only be possible if the associated parameter is 
         * polymorphic, and in such cases a change of default type might alter 
         * the resolved output type of existing calls.) 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN392"><span class='Ref_To_Local'>oldproc</span></a><span class='Operator'>-&GT;</span>pronargdefaults <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN496"></a>            <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>proargdefaults</span><span class='Delimiter'>; 
</span><a name="LN497"></a>            <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>oldDefaults</span><span class='Delimiter'>; 
</span><a name="LN498"></a>            <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>oldlc</span><span class='Delimiter'>; 
</span><a name="LN499"></a>            <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>newlc</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN87"><span class='Ref_to_Parameter'>parameterDefaults</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><a href="pg_proc.c.html#LN392"><span class='Ref_To_Local'>oldproc</span></a><span class='Operator'>-&GT;</span>pronargdefaults<span class='Parentheses'>)</span> 
                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_FUNCTION_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot remove parameter defaults from existing function"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN985"><span class='Ref_to_Func'>errhint</span></a><span class='Parentheses'>(</span><span class='String'>"Use DROP FUNCTION %s first."</span><span class='Delimiter'>, 
</span>                                 <a href="../../include/utils/regproc.h.html#LN18"><span class='Ref_to_Proto'>format_procedure</span></a><span class='Parentheses'>(</span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN108"><span class='Ref_To_Local'>oldtup</span></a><span class='Parentheses'>)))))</span><span class='Delimiter'>; 
</span> 
            <a href="pg_proc.c.html#LN496"><span class='Ref_To_Local'>proargdefaults</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN133"><span class='Ref_to_Proto'>SysCacheGetAttr</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN75"><span class='Ref_to_EnumConst'>PROCNAMEARGSNSP</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN108"><span class='Ref_To_Local'>oldtup</span></a><span class='Delimiter'>, 
</span>                                             <a href="../../include/catalog/pg_proc.h.html#LN112"><span class='Ref_to_Const'>Anum_pg_proc_proargdefaults</span></a><span class='Delimiter'>, 
</span>                                             <span class='Operator'>&</span><a href="pg_proc.c.html#LN394"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="pg_proc.c.html#LN394"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="pg_proc.c.html#LN497"><span class='Ref_To_Local'>oldDefaults</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN575"><span class='Ref_to_Macro'>castNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a><span class='Delimiter'>, </span><a href="../nodes/read.c.html#LN36"><span class='Ref_to_Func'>stringToNode</span></a><span class='Parentheses'>(</span><a href="../../include/utils/builtins.h.html#LN91"><span class='Ref_to_Macro'>TextDatumGetCString</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN496"><span class='Ref_To_Local'>proargdefaults</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN497"><span class='Ref_To_Local'>oldDefaults</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="pg_proc.c.html#LN392"><span class='Ref_To_Local'>oldproc</span></a><span class='Operator'>-&GT;</span>pronargdefaults<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* new list can have more defaults than old, advance over 'em */ 
</span>            <a href="pg_proc.c.html#LN499"><span class='Ref_To_Local'>newlc</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN75"><span class='Ref_to_Func'>list_head</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN87"><span class='Ref_to_Parameter'>parameterDefaults</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN87"><span class='Ref_to_Parameter'>parameterDefaults</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="pg_proc.c.html#LN392"><span class='Ref_To_Local'>oldproc</span></a><span class='Operator'>-&GT;</span>pronargdefaults<span class='Delimiter'>; 
</span>                 <a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                 <a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a><span class='Operator'>--</span><span class='Parentheses'>)</span> 
                <a href="pg_proc.c.html#LN499"><span class='Ref_To_Local'>newlc</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN104"><span class='Ref_to_Macro'>lnext</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN499"><span class='Ref_To_Local'>newlc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN498"><span class='Ref_To_Local'>oldlc</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN497"><span class='Ref_To_Local'>oldDefaults</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN524"></a>                <a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>oldDef</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN498"><span class='Ref_To_Local'>oldlc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN525"></a>                <a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>newDef</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN499"><span class='Ref_To_Local'>newlc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodeFuncs.h.html#LN31"><span class='Ref_to_Proto'>exprType</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN524"><span class='Ref_To_Local'>oldDef</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="../../include/nodes/nodeFuncs.h.html#LN31"><span class='Ref_to_Proto'>exprType</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN525"><span class='Ref_To_Local'>newDef</span></a><span class='Parentheses'>))</span> 
                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_FUNCTION_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot change data type of existing parameter default value"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN985"><span class='Ref_to_Func'>errhint</span></a><span class='Parentheses'>(</span><span class='String'>"Use DROP FUNCTION %s first."</span><span class='Delimiter'>, 
</span>                                <a href="../../include/utils/regproc.h.html#LN18"><span class='Ref_to_Proto'>format_procedure</span></a><span class='Parentheses'>(</span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN108"><span class='Ref_To_Local'>oldtup</span></a><span class='Parentheses'>)))))</span><span class='Delimiter'>; 
</span>                <a href="pg_proc.c.html#LN499"><span class='Ref_To_Local'>newlc</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN104"><span class='Ref_to_Macro'>lnext</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN499"><span class='Ref_To_Local'>newlc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if oldproc-&GT;pronargdefau... &raquo; </span> 
 
        <span class='Comment_Multi_Line'>/* Can't change aggregate or window-function status, either */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN392"><span class='Ref_To_Local'>oldproc</span></a><span class='Operator'>-&GT;</span>proisagg <span class='Operator'>!= </span><a href="pg_proc.c.html#LN76"><span class='Ref_to_Parameter'>isAgg</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN392"><span class='Ref_To_Local'>oldproc</span></a><span class='Operator'>-&GT;</span>proisagg<span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_WRONG_OBJECT_TYPE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"function \"%s\" is an aggregate function"</span><span class='Delimiter'>, 
</span>                                <a href="pg_proc.c.html#LN66"><span class='Ref_to_Parameter'>procedureName</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_WRONG_OBJECT_TYPE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                       <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"function \"%s\" is not an aggregate function"</span><span class='Delimiter'>, 
</span>                              <a href="pg_proc.c.html#LN66"><span class='Ref_to_Parameter'>procedureName</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN392"><span class='Ref_To_Local'>oldproc</span></a><span class='Operator'>-&GT;</span>proiswindow <span class='Operator'>!= </span><a href="pg_proc.c.html#LN77"><span class='Ref_to_Parameter'>isWindowFunc</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN392"><span class='Ref_To_Local'>oldproc</span></a><span class='Operator'>-&GT;</span>proiswindow<span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_WRONG_OBJECT_TYPE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"function \"%s\" is a window function"</span><span class='Delimiter'>, 
</span>                                <a href="pg_proc.c.html#LN66"><span class='Ref_to_Parameter'>procedureName</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_WRONG_OBJECT_TYPE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"function \"%s\" is not a window function"</span><span class='Delimiter'>, 
</span>                                <a href="pg_proc.c.html#LN66"><span class='Ref_to_Parameter'>procedureName</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Do not change existing ownership or permissions, either.  Note 
         * dependency-update code below has to agree with this decision. 
         */ 
</span>        <a href="pg_proc.c.html#LN111"><span class='Ref_To_Local'>replaces</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN91"><span class='Ref_to_Const'>Anum_pg_proc_proowner</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="pg_proc.c.html#LN111"><span class='Ref_To_Local'>replaces</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN117"><span class='Ref_to_Const'>Anum_pg_proc_proacl</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Okay, do it... */ 
</span>        <a href="pg_proc.c.html#LN107"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="../access/common/heaptuple.c.html#LN789"><span class='Ref_to_Func'>heap_modify_tuple</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN108"><span class='Ref_To_Local'>oldtup</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN114"><span class='Ref_To_Local'>tupDesc</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN109"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN111"><span class='Ref_To_Local'>replaces</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../include/catalog/indexing.h.html#LN35"><span class='Ref_to_Proto'>CatalogTupleUpdate</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN106"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="pg_proc.c.html#LN107"><span class='Ref_To_Local'>tup</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/htup.h.html#LN64"><span class='Ref_to_Member'>t_self</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN107"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN108"><span class='Ref_To_Local'>oldtup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="pg_proc.c.html#LN115"><span class='Ref_To_Local'>is_update</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if HeapTupleIsValid(oldt... &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Creating a new procedure */ 
</span> 
        <span class='Comment_Multi_Line'>/* First, get default permissions and set up proacl */ 
</span>        <a href="pg_proc.c.html#LN105"><span class='Ref_To_Local'>proacl</span></a> <span class='Operator'>= </span><a href="../../include/utils/acl.h.html#LN212"><span class='Ref_to_Proto'>get_user_default_acl</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN1820"><span class='Ref_to_EnumConst'>ACL_OBJECT_FUNCTION</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN71"><span class='Ref_to_Parameter'>proowner</span></a><span class='Delimiter'>, 
</span>                                      <a href="pg_proc.c.html#LN67"><span class='Ref_to_Parameter'>procNamespace</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN105"><span class='Ref_To_Local'>proacl</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>            <a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN117"><span class='Ref_to_Const'>Anum_pg_proc_proacl</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN105"><span class='Ref_To_Local'>proacl</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="pg_proc.c.html#LN109"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN117"><span class='Ref_to_Const'>Anum_pg_proc_proacl</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
        <a href="pg_proc.c.html#LN107"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="../access/common/heaptuple.c.html#LN690"><span class='Ref_to_Func'>heap_form_tuple</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN114"><span class='Ref_To_Local'>tupDesc</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN110"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN109"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../include/catalog/indexing.h.html#LN32"><span class='Ref_to_Proto'>CatalogTupleInsert</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN106"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN107"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="pg_proc.c.html#LN115"><span class='Ref_To_Local'>is_update</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
 
    <a href="pg_proc.c.html#LN93"><span class='Ref_To_Local'>retval</span></a> <span class='Operator'>= </span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN107"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Create dependencies for the new function.  If we are updating an 
     * existing function, first delete any existing pg_depend entries. 
     * (However, since we are not changing ownership or permissions, the 
     * shared dependencies do *not* need to change, and we leave them alone.) 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN115"><span class='Ref_To_Local'>is_update</span></a><span class='Parentheses'>) 
</span>        <a href="pg_depend.c.html#LN189"><span class='Ref_to_Func'>deleteDependencyRecordsFor</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_proc.h.html#LN32"><span class='Ref_to_Const'>ProcedureRelationId</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN93"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="pg_proc.c.html#LN116"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_proc.h.html#LN32"><span class='Ref_to_Const'>ProcedureRelationId</span></a><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN116"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="pg_proc.c.html#LN93"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN116"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on namespace */ 
</span>    <a href="pg_proc.c.html#LN117"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_namespace.h.html#LN33"><span class='Ref_to_Const'>NamespaceRelationId</span></a><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN117"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="pg_proc.c.html#LN67"><span class='Ref_to_Parameter'>procNamespace</span></a><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN117"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="pg_depend.c.html#LN42"><span class='Ref_to_Func'>recordDependencyOn</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="pg_proc.c.html#LN116"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="pg_proc.c.html#LN117"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on implementation language */ 
</span>    <a href="pg_proc.c.html#LN117"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_language.h.html#LN28"><span class='Ref_to_Const'>LanguageRelationId</span></a><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN117"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="pg_proc.c.html#LN72"><span class='Ref_to_Parameter'>languageObjectId</span></a><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN117"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="pg_depend.c.html#LN42"><span class='Ref_to_Func'>recordDependencyOn</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="pg_proc.c.html#LN116"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="pg_proc.c.html#LN117"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on return type */ 
</span>    <a href="pg_proc.c.html#LN117"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_type.h.html#LN33"><span class='Ref_to_Const'>TypeRelationId</span></a><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN117"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="pg_proc.c.html#LN70"><span class='Ref_to_Parameter'>returnType</span></a><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN117"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="pg_depend.c.html#LN42"><span class='Ref_to_Func'>recordDependencyOn</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="pg_proc.c.html#LN116"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="pg_proc.c.html#LN117"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on transform used by return type, if any */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="pg_proc.c.html#LN119"><span class='Ref_To_Local'>trfid</span></a> <span class='Operator'>= </span><a href="../../include/commands/defrem.h.html#LN62"><span class='Ref_to_Proto'>get_transform_oid</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN70"><span class='Ref_to_Parameter'>returnType</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN72"><span class='Ref_to_Parameter'>languageObjectId</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="pg_proc.c.html#LN117"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_transform.h.html#LN24"><span class='Ref_to_Const'>TransformRelationId</span></a><span class='Delimiter'>; 
</span>        <a href="pg_proc.c.html#LN117"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="pg_proc.c.html#LN119"><span class='Ref_To_Local'>trfid</span></a><span class='Delimiter'>; 
</span>        <a href="pg_proc.c.html#LN117"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="pg_depend.c.html#LN42"><span class='Ref_to_Func'>recordDependencyOn</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="pg_proc.c.html#LN116"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="pg_proc.c.html#LN117"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on parameter types */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="pg_proc.c.html#LN95"><span class='Ref_To_Local'>allParamCount</span></a><span class='Delimiter'>; </span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pg_proc.c.html#LN117"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_type.h.html#LN33"><span class='Ref_to_Const'>TypeRelationId</span></a><span class='Delimiter'>; 
</span>        <a href="pg_proc.c.html#LN117"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="pg_proc.c.html#LN96"><span class='Ref_To_Local'>allParams</span></a><span class='Delimiter'>[</span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>        <a href="pg_proc.c.html#LN117"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="pg_depend.c.html#LN42"><span class='Ref_to_Func'>recordDependencyOn</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="pg_proc.c.html#LN116"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="pg_proc.c.html#LN117"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* dependency on transform used by parameter type, if any */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="pg_proc.c.html#LN119"><span class='Ref_To_Local'>trfid</span></a> <span class='Operator'>= </span><a href="../../include/commands/defrem.h.html#LN62"><span class='Ref_to_Proto'>get_transform_oid</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN96"><span class='Ref_To_Local'>allParams</span></a><span class='Delimiter'>[</span><a href="pg_proc.c.html#LN118"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>], </span><a href="pg_proc.c.html#LN72"><span class='Ref_to_Parameter'>languageObjectId</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="pg_proc.c.html#LN117"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_transform.h.html#LN24"><span class='Ref_to_Const'>TransformRelationId</span></a><span class='Delimiter'>; 
</span>            <a href="pg_proc.c.html#LN117"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="pg_proc.c.html#LN119"><span class='Ref_To_Local'>trfid</span></a><span class='Delimiter'>; 
</span>            <a href="pg_proc.c.html#LN117"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <a href="pg_depend.c.html#LN42"><span class='Ref_to_Func'>recordDependencyOn</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="pg_proc.c.html#LN116"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="pg_proc.c.html#LN117"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on parameter default expressions */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN87"><span class='Ref_to_Parameter'>parameterDefaults</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/catalog/dependency.h.html#LN188"><span class='Ref_to_Proto'>recordDependencyOnExpr</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="pg_proc.c.html#LN116"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="pg_proc.c.html#LN87"><span class='Ref_to_Parameter'>parameterDefaults</span></a><span class='Delimiter'>, 
</span>                               <a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on owner */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="pg_proc.c.html#LN115"><span class='Ref_To_Local'>is_update</span></a><span class='Parentheses'>) 
</span>        <a href="pg_shdepend.c.html#LN157"><span class='Ref_to_Func'>recordDependencyOnOwner</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_proc.h.html#LN32"><span class='Ref_to_Const'>ProcedureRelationId</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN93"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN71"><span class='Ref_to_Parameter'>proowner</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on any roles mentioned in ACL */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="pg_proc.c.html#LN115"><span class='Ref_To_Local'>is_update</span></a> <span class='Operator'>&& </span><a href="pg_proc.c.html#LN105"><span class='Ref_To_Local'>proacl</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN669"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>nnewmembers</span><span class='Delimiter'>; 
</span><a name="LN670"></a>        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>newmembers</span><span class='Delimiter'>; 
</span> 
        <a href="pg_proc.c.html#LN669"><span class='Ref_To_Local'>nnewmembers</span></a> <span class='Operator'>= </span><a href="../../include/utils/acl.h.html#LN227"><span class='Ref_to_Proto'>aclmembers</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN105"><span class='Ref_To_Local'>proacl</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="pg_proc.c.html#LN670"><span class='Ref_To_Local'>newmembers</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../include/catalog/dependency.h.html#LN262"><span class='Ref_to_Proto'>updateAclDependencies</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_proc.h.html#LN32"><span class='Ref_to_Const'>ProcedureRelationId</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN93"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, 
</span>                              <a href="pg_proc.c.html#LN71"><span class='Ref_to_Parameter'>proowner</span></a><span class='Delimiter'>, 
</span>                              <span class='Number'>0</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                              <a href="pg_proc.c.html#LN669"><span class='Ref_To_Local'>nnewmembers</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN670"><span class='Ref_To_Local'>newmembers</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on extension */ 
</span>    <a href="pg_depend.c.html#LN137"><span class='Ref_to_Func'>recordDependencyOnCurrentExtension</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="pg_proc.c.html#LN116"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN115"><span class='Ref_To_Local'>is_update</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/htup_details.h.html#LN815"><span class='Ref_to_Proto'>heap_freetuple</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN107"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Post creation hook for new function */ 
</span>    <a href="../../include/catalog/objectaccess.h.html#LN144"><span class='Ref_to_Macro'>InvokeObjectPostCreateHook</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_proc.h.html#LN32"><span class='Ref_to_Const'>ProcedureRelationId</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN93"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN106"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Verify function body */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN73"><span class='Ref_to_Parameter'>languageValidator</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN692"></a>        <a href="../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>set_items</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN693"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>save_nestlevel</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Advance command counter so new tuple can be seen by validator */ 
</span>        <a href="../../include/access/xact.h.html#LN346"><span class='Ref_to_Proto'>CommandCounterIncrement</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Set per-function configuration parameters so that the validation is 
         * done with the environment the function expects.  However, if 
         * check_function_bodies is off, we don't do this, because that would 
         * create dump ordering hazards that pg_dump doesn't know how to deal 
         * with.  (For example, a SET clause might refer to a not-yet-created 
         * text search configuration.)  This means that the validator 
         * shouldn't complain about anything that might depend on a GUC 
         * parameter when check_function_bodies is off. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../utils/misc/guc.c.html#LN446"><span class='Ref_to_Global_Var'>check_function_bodies</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="pg_proc.c.html#LN692"><span class='Ref_To_Local'>set_items</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN89"><span class='Ref_to_Parameter'>proconfig</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN692"><span class='Ref_To_Local'>set_items</span></a><span class='Parentheses'>)</span>      <span class='Comment_Single_Line'>/* Need a new GUC nesting level */ 
</span>            <span class='Delimiter'>{ 
</span>                <a href="pg_proc.c.html#LN693"><span class='Ref_To_Local'>save_nestlevel</span></a> <span class='Operator'>= </span><a href="../../include/utils/guc.h.html#LN354"><span class='Ref_to_Proto'>NewGUCNestLevel</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>                <a href="../../include/utils/guc.h.html#LN378"><span class='Ref_to_Proto'>ProcessGUCArray</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN692"><span class='Ref_To_Local'>set_items</span></a><span class='Delimiter'>, 
</span>                                <span class='Parentheses'>(</span><a href="../utils/misc/superuser.c.html#LN45"><span class='Ref_to_Func'>superuser</span></a><span class='Parentheses'>() </span><span class='Operator'>? </span><a href="../../include/utils/guc.h.html#LN74"><span class='Ref_to_EnumConst'>PGC_SUSET</span></a> <span class='Operator'>: </span><a href="../../include/utils/guc.h.html#LN75"><span class='Ref_to_EnumConst'>PGC_USERSET</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                <a href="../../include/utils/guc.h.html#LN119"><span class='Ref_to_EnumConst'>PGC_S_SESSION</span></a><span class='Delimiter'>, 
</span>                                <a href="../../include/utils/guc.h.html#LN195"><span class='Ref_to_EnumConst'>GUC_ACTION_SAVE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="../../include/fmgr.h.html#LN621"><span class='Ref_to_Macro'>OidFunctionCall1</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN73"><span class='Ref_to_Parameter'>languageValidator</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN93"><span class='Ref_To_Local'>retval</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN692"><span class='Ref_To_Local'>set_items</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/guc.h.html#LN355"><span class='Ref_to_Proto'>AtEOXact_GUC</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN693"><span class='Ref_To_Local'>save_nestlevel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if OidIsValid(languageVa... &raquo; </span> 
 
    <span class='Control'>return</span> <a href="pg_proc.c.html#LN116"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end ProcedureCreate &raquo; </span> 
 
 
 
<span class='Comment_Multi_Line'>/* 
 * Validator for internal functions 
 * 
 * Check that the given internal function name (the "prosrc" value) is 
 * a known builtin function. 
 */ 
</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN739"></a><span class='Declare_Function'>fmgr_internal_validator</span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN741"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>funcoid</span> <span class='Operator'>= </span><a href="../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN742"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tuple</span><span class='Delimiter'>; 
</span><a name="LN743"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>isnull</span><span class='Delimiter'>; 
</span><a name="LN744"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>tmp</span><span class='Delimiter'>; 
</span><a name="LN745"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>prosrc</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/fmgr.h.html#LN668"><span class='Ref_to_Proto'>CheckFunctionValidatorAccess</span></a><span class='Parentheses'>(</span>fcinfo<span class='Operator'>-&GT;</span>flinfo<span class='Operator'>-&GT;</span>fn_oid<span class='Delimiter'>, </span><a href="pg_proc.c.html#LN741"><span class='Ref_To_Local'>funcoid</span></a><span class='Parentheses'>))</span> 
        <a href="../../include/fmgr.h.html#LN308"><span class='Ref_to_Macro'>PG_RETURN_VOID</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We do not honor check_function_bodies since it's unlikely the function 
     * name will be found later if it isn't there now. 
     */ 
</span> 
    <a href="pg_proc.c.html#LN742"><span class='Ref_To_Local'>tuple</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN76"><span class='Ref_to_EnumConst'>PROCOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN741"><span class='Ref_To_Local'>funcoid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN742"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for function %u"</span><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN741"><span class='Ref_To_Local'>funcoid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="pg_proc.c.html#LN744"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN133"><span class='Ref_to_Proto'>SysCacheGetAttr</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN76"><span class='Ref_to_EnumConst'>PROCOID</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN742"><span class='Ref_To_Local'>tuple</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/pg_proc.h.html#LN114"><span class='Ref_to_Const'>Anum_pg_proc_prosrc</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="pg_proc.c.html#LN743"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN743"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>) 
</span>        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"null prosrc"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN745"><span class='Ref_To_Local'>prosrc</span></a> <span class='Operator'>= </span><a href="../../include/utils/builtins.h.html#LN91"><span class='Ref_to_Macro'>TextDatumGetCString</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN744"><span class='Ref_To_Local'>tmp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../utils/fmgr/fmgr.c.html#LN537"><span class='Ref_to_Func'>fmgr_internal_function</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN745"><span class='Ref_To_Local'>prosrc</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Parentheses'>)</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_FUNCTION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"there is no built-in function named \"%s\""</span><span class='Delimiter'>, 
</span>                        <a href="pg_proc.c.html#LN745"><span class='Ref_To_Local'>prosrc</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN742"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/fmgr.h.html#LN308"><span class='Ref_to_Macro'>PG_RETURN_VOID</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end fmgr_internal_validator &raquo; </span> 
 
 
 
<span class='Comment_Multi_Line'>/* 
 * Validator for C language functions 
 * 
 * Make sure that the library file exists, is loadable, and contains 
 * the specified link symbol. Also check for a valid function 
 * information record. 
 */ 
</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN785"></a><span class='Declare_Function'>fmgr_c_validator</span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN787"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>funcoid</span> <span class='Operator'>= </span><a href="../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN788"></a>    <span class='Keyword'>void</span>       <span class='Operator'>*</span><span class='Declare_Local'>libraryhandle</span><span class='Delimiter'>; 
</span><a name="LN789"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tuple</span><span class='Delimiter'>; 
</span><a name="LN790"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>isnull</span><span class='Delimiter'>; 
</span><a name="LN791"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>tmp</span><span class='Delimiter'>; 
</span><a name="LN792"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>prosrc</span><span class='Delimiter'>; 
</span><a name="LN793"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>probin</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/fmgr.h.html#LN668"><span class='Ref_to_Proto'>CheckFunctionValidatorAccess</span></a><span class='Parentheses'>(</span>fcinfo<span class='Operator'>-&GT;</span>flinfo<span class='Operator'>-&GT;</span>fn_oid<span class='Delimiter'>, </span><a href="pg_proc.c.html#LN787"><span class='Ref_To_Local'>funcoid</span></a><span class='Parentheses'>))</span> 
        <a href="../../include/fmgr.h.html#LN308"><span class='Ref_to_Macro'>PG_RETURN_VOID</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * It'd be most consistent to skip the check if !check_function_bodies, 
     * but the purpose of that switch is to be helpful for pg_dump loading, 
     * and for pg_dump loading it's much better if we *do* check. 
     */ 
</span> 
    <a href="pg_proc.c.html#LN789"><span class='Ref_To_Local'>tuple</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN76"><span class='Ref_to_EnumConst'>PROCOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN787"><span class='Ref_To_Local'>funcoid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN789"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for function %u"</span><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN787"><span class='Ref_To_Local'>funcoid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="pg_proc.c.html#LN791"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN133"><span class='Ref_to_Proto'>SysCacheGetAttr</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN76"><span class='Ref_to_EnumConst'>PROCOID</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN789"><span class='Ref_To_Local'>tuple</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/pg_proc.h.html#LN114"><span class='Ref_to_Const'>Anum_pg_proc_prosrc</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="pg_proc.c.html#LN790"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN790"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>) 
</span>        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"null prosrc for C function %u"</span><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN787"><span class='Ref_To_Local'>funcoid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN792"><span class='Ref_To_Local'>prosrc</span></a> <span class='Operator'>= </span><a href="../../include/utils/builtins.h.html#LN91"><span class='Ref_to_Macro'>TextDatumGetCString</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN791"><span class='Ref_To_Local'>tmp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="pg_proc.c.html#LN791"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN133"><span class='Ref_to_Proto'>SysCacheGetAttr</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN76"><span class='Ref_to_EnumConst'>PROCOID</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN789"><span class='Ref_To_Local'>tuple</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/pg_proc.h.html#LN115"><span class='Ref_to_Const'>Anum_pg_proc_probin</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="pg_proc.c.html#LN790"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN790"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>) 
</span>        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"null probin for C function %u"</span><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN787"><span class='Ref_To_Local'>funcoid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN793"><span class='Ref_To_Local'>probin</span></a> <span class='Operator'>= </span><a href="../../include/utils/builtins.h.html#LN91"><span class='Ref_to_Macro'>TextDatumGetCString</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN791"><span class='Ref_To_Local'>tmp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="../utils/fmgr/dfmgr.c.html#LN92"><span class='Ref_to_Func'>load_external_function</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN793"><span class='Ref_To_Local'>probin</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN792"><span class='Ref_To_Local'>prosrc</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="pg_proc.c.html#LN788"><span class='Ref_To_Local'>libraryhandle</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="../utils/fmgr/fmgr.c.html#LN382"><span class='Ref_to_Func'>fetch_finfo_record</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN788"><span class='Ref_To_Local'>libraryhandle</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN792"><span class='Ref_To_Local'>prosrc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN789"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/fmgr.h.html#LN308"><span class='Ref_to_Macro'>PG_RETURN_VOID</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end fmgr_c_validator &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * Validator for SQL language functions 
 * 
 * Parse it here in order to be sure that it contains no syntax errors. 
 */ 
</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN833"></a><span class='Declare_Function'>fmgr_sql_validator</span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN835"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>funcoid</span> <span class='Operator'>= </span><a href="../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN836"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tuple</span><span class='Delimiter'>; 
</span><a name="LN837"></a>    <a href="../../include/catalog/pg_proc.h.html#LN82"><span class='Ref_to_Typedef'>Form_pg_proc</span></a> <span class='Declare_Local'>proc</span><span class='Delimiter'>; 
</span><a name="LN838"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>raw_parsetree_list</span><span class='Delimiter'>; 
</span><a name="LN839"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>querytree_list</span><span class='Delimiter'>; 
</span><a name="LN840"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span><a name="LN841"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>isnull</span><span class='Delimiter'>; 
</span><a name="LN842"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>tmp</span><span class='Delimiter'>; 
</span><a name="LN843"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>prosrc</span><span class='Delimiter'>; 
</span><a name="LN844"></a>    <a href="pg_proc.c.html#LN44"><span class='Ref_to_Typedef'>parse_error_callback_arg</span></a> <span class='Declare_Local'>callback_arg</span><span class='Delimiter'>; 
</span><a name="LN845"></a>    ErrorContextCallback <span class='Declare_Local'>sqlerrcontext</span><span class='Delimiter'>; 
</span><a name="LN846"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>haspolyarg</span><span class='Delimiter'>; 
</span><a name="LN847"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/fmgr.h.html#LN668"><span class='Ref_to_Proto'>CheckFunctionValidatorAccess</span></a><span class='Parentheses'>(</span>fcinfo<span class='Operator'>-&GT;</span>flinfo<span class='Operator'>-&GT;</span>fn_oid<span class='Delimiter'>, </span><a href="pg_proc.c.html#LN835"><span class='Ref_To_Local'>funcoid</span></a><span class='Parentheses'>))</span> 
        <a href="../../include/fmgr.h.html#LN308"><span class='Ref_to_Macro'>PG_RETURN_VOID</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="pg_proc.c.html#LN836"><span class='Ref_To_Local'>tuple</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN76"><span class='Ref_to_EnumConst'>PROCOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN835"><span class='Ref_To_Local'>funcoid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN836"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for function %u"</span><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN835"><span class='Ref_To_Local'>funcoid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN837"><span class='Ref_To_Local'>proc</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_proc.h.html#LN82"><span class='Ref_to_Typedef'>Form_pg_proc</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN836"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Disallow pseudotype result */ 
</span>    <span class='Comment_Multi_Line'>/* except for RECORD, VOID, or polymorphic */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/utils/lsyscache.h.html#LN149"><span class='Ref_to_Proto'>get_typtype</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN837"><span class='Ref_To_Local'>proc</span></a><span class='Operator'>-&GT;</span>prorettype<span class='Parentheses'>) </span><span class='Operator'>== </span><a href="../../include/catalog/pg_type.h.html#LN723"><span class='Ref_to_Const'>TYPTYPE_PSEUDO</span></a> <span class='Operator'>&& 
</span>        <a href="pg_proc.c.html#LN837"><span class='Ref_To_Local'>proc</span></a><span class='Operator'>-&GT;</span>prorettype <span class='Operator'>!= </span><a href="../../include/catalog/pg_type.h.html#LN679"><span class='Ref_to_Const'>RECORDOID</span></a> <span class='Operator'>&& 
</span>        <a href="pg_proc.c.html#LN837"><span class='Ref_To_Local'>proc</span></a><span class='Operator'>-&GT;</span>prorettype <span class='Operator'>!= </span><a href="../../include/catalog/pg_type.h.html#LN689"><span class='Ref_to_Const'>VOIDOID</span></a> <span class='Operator'>&& 
</span>        <span class='Operator'>!</span><a href="../../include/catalog/pg_type.h.html#LN744"><span class='Ref_to_Macro'>IsPolymorphicType</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN837"><span class='Ref_To_Local'>proc</span></a><span class='Operator'>-&GT;</span>prorettype<span class='Parentheses'>))</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_FUNCTION_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"SQL functions cannot return type %s"</span><span class='Delimiter'>, 
</span>                        <a href="../utils/adt/format_type.c.html#LN92"><span class='Ref_to_Func'>format_type_be</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN837"><span class='Ref_To_Local'>proc</span></a><span class='Operator'>-&GT;</span>prorettype<span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Disallow pseudotypes in arguments */ 
</span>    <span class='Comment_Multi_Line'>/* except for polymorphic */ 
</span>    <a href="pg_proc.c.html#LN846"><span class='Ref_To_Local'>haspolyarg</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN847"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="pg_proc.c.html#LN847"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="pg_proc.c.html#LN837"><span class='Ref_To_Local'>proc</span></a><span class='Operator'>-&GT;</span>pronargs<span class='Delimiter'>; </span><a href="pg_proc.c.html#LN847"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/utils/lsyscache.h.html#LN149"><span class='Ref_to_Proto'>get_typtype</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN837"><span class='Ref_To_Local'>proc</span></a><span class='Operator'>-&GT;</span>proargtypes<span class='Operator'>.</span>values<span class='Delimiter'>[</span><a href="pg_proc.c.html#LN847"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="../../include/catalog/pg_type.h.html#LN723"><span class='Ref_to_Const'>TYPTYPE_PSEUDO</span></a><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/catalog/pg_type.h.html#LN744"><span class='Ref_to_Macro'>IsPolymorphicType</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN837"><span class='Ref_To_Local'>proc</span></a><span class='Operator'>-&GT;</span>proargtypes<span class='Operator'>.</span>values<span class='Delimiter'>[</span><a href="pg_proc.c.html#LN847"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
                <a href="pg_proc.c.html#LN846"><span class='Ref_To_Local'>haspolyarg</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_FUNCTION_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"SQL functions cannot have arguments of type %s"</span><span class='Delimiter'>, 
</span>                            <a href="../utils/adt/format_type.c.html#LN92"><span class='Ref_to_Func'>format_type_be</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN837"><span class='Ref_To_Local'>proc</span></a><span class='Operator'>-&GT;</span>proargtypes<span class='Operator'>.</span>values<span class='Delimiter'>[</span><a href="pg_proc.c.html#LN847"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Postpone body checks if !check_function_bodies */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../utils/misc/guc.c.html#LN446"><span class='Ref_to_Global_Var'>check_function_bodies</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pg_proc.c.html#LN842"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN133"><span class='Ref_to_Proto'>SysCacheGetAttr</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN76"><span class='Ref_to_EnumConst'>PROCOID</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN836"><span class='Ref_To_Local'>tuple</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/pg_proc.h.html#LN114"><span class='Ref_to_Const'>Anum_pg_proc_prosrc</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="pg_proc.c.html#LN841"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN841"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>) 
</span>            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"null prosrc"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="pg_proc.c.html#LN843"><span class='Ref_To_Local'>prosrc</span></a> <span class='Operator'>= </span><a href="../../include/utils/builtins.h.html#LN91"><span class='Ref_to_Macro'>TextDatumGetCString</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN842"><span class='Ref_To_Local'>tmp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Setup error traceback support for ereport(). 
         */ 
</span>        <a href="pg_proc.c.html#LN844"><span class='Ref_To_Local'>callback_arg</span></a><span class='Operator'>.</span><a href="pg_proc.c.html#LN46"><span class='Ref_to_Member'>proname</span></a> <span class='Operator'>= </span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN837"><span class='Ref_To_Local'>proc</span></a><span class='Operator'>-&GT;</span>proname<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="pg_proc.c.html#LN844"><span class='Ref_To_Local'>callback_arg</span></a><span class='Operator'>.</span><a href="pg_proc.c.html#LN47"><span class='Ref_to_Member'>prosrc</span></a> <span class='Operator'>= </span><a href="pg_proc.c.html#LN843"><span class='Ref_To_Local'>prosrc</span></a><span class='Delimiter'>; 
</span> 
        <a href="pg_proc.c.html#LN845"><span class='Ref_To_Local'>sqlerrcontext</span></a><span class='Operator'>.</span>callback <span class='Operator'>= </span><a href="pg_proc.c.html#LN50"><span class='Ref_to_Proto'>sql_function_parse_error_callback</span></a><span class='Delimiter'>; 
</span>        <a href="pg_proc.c.html#LN845"><span class='Ref_To_Local'>sqlerrcontext</span></a><span class='Operator'>.</span>arg <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="pg_proc.c.html#LN844"><span class='Ref_To_Local'>callback_arg</span></a><span class='Delimiter'>; 
</span>        <a href="pg_proc.c.html#LN845"><span class='Ref_To_Local'>sqlerrcontext</span></a><span class='Operator'>.</span>previous <span class='Operator'>= </span><a href="../utils/error/elog.c.html#LN87"><span class='Ref_to_Global_Var'>error_context_stack</span></a><span class='Delimiter'>; 
</span>        <a href="../utils/error/elog.c.html#LN87"><span class='Ref_to_Global_Var'>error_context_stack</span></a> <span class='Operator'>= &</span><a href="pg_proc.c.html#LN845"><span class='Ref_To_Local'>sqlerrcontext</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * We can't do full prechecking of the function definition if there 
         * are any polymorphic input types, because actual datatypes of 
         * expression results will be unresolvable.  The check will be done at 
         * runtime instead. 
         * 
         * We can run the text through the raw parser though; this will at 
         * least catch silly syntactic errors. 
         */ 
</span>        <a href="pg_proc.c.html#LN838"><span class='Ref_To_Local'>raw_parsetree_list</span></a> <span class='Operator'>= </span><a href="../../include/tcop/tcopprot.h.html#LN49"><span class='Ref_to_Proto'>pg_parse_query</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN843"><span class='Ref_To_Local'>prosrc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="pg_proc.c.html#LN846"><span class='Ref_To_Local'>haspolyarg</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * OK to do full precheck: analyze and rewrite the queries, then 
             * verify the result type. 
             */ 
</span><a name="LN922"></a>            <a href="../../include/executor/functions.h.html#LN20"><span class='Ref_to_Typedef'>SQLFunctionParseInfoPtr</span></a> <span class='Declare_Local'>pinfo</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* But first, set up parameter information */ 
</span>            <a href="pg_proc.c.html#LN922"><span class='Ref_To_Local'>pinfo</span></a> <span class='Operator'>= </span><a href="../../include/executor/functions.h.html#LN24"><span class='Ref_to_Proto'>prepare_sql_fn_parse_info</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN836"><span class='Ref_To_Local'>tuple</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="pg_proc.c.html#LN839"><span class='Ref_To_Local'>querytree_list</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>            <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN840"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN838"><span class='Ref_To_Local'>raw_parsetree_list</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN930"></a>                <a href="../../include/nodes/parsenodes.h.html#LN1396"><span class='Ref_to_Struct'>RawStmt</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>parsetree</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN108"><span class='Ref_to_Macro'>lfirst_node</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN1396"><span class='Ref_to_Struct'>RawStmt</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN840"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN931"></a>                <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>querytree_sublist</span><span class='Delimiter'>; 
</span> 
                <a href="pg_proc.c.html#LN931"><span class='Ref_To_Local'>querytree_sublist</span></a> <span class='Operator'>= </span><a href="../../include/tcop/tcopprot.h.html#LN54"><span class='Ref_to_Proto'>pg_analyze_and_rewrite_params</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN930"><span class='Ref_To_Local'>parsetree</span></a><span class='Delimiter'>, 
</span>                                                                  <a href="pg_proc.c.html#LN843"><span class='Ref_To_Local'>prosrc</span></a><span class='Delimiter'>, 
</span>                                       <span class='Parentheses'>(</span><a href="../../include/nodes/params.h.html#LN65"><span class='Ref_to_Typedef'>ParserSetupHook</span></a><span class='Parentheses'>) </span><a href="../../include/executor/functions.h.html#LN28"><span class='Ref_to_Proto'>sql_fn_parser_setup</span></a><span class='Delimiter'>, 
</span>                                                                  <a href="pg_proc.c.html#LN922"><span class='Ref_To_Local'>pinfo</span></a><span class='Delimiter'>, 
</span>                                                                  <span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="pg_proc.c.html#LN839"><span class='Ref_To_Local'>querytree_list</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN219"><span class='Ref_to_Proto'>list_concat</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN839"><span class='Ref_To_Local'>querytree_list</span></a><span class='Delimiter'>, 
</span>                                             <a href="pg_proc.c.html#LN931"><span class='Ref_To_Local'>querytree_sublist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="../../include/executor/functions.h.html#LN31"><span class='Ref_to_Proto'>check_sql_fn_retval</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN835"><span class='Ref_To_Local'>funcoid</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN837"><span class='Ref_To_Local'>proc</span></a><span class='Operator'>-&GT;</span>prorettype<span class='Delimiter'>, 
</span>                                       <a href="pg_proc.c.html#LN839"><span class='Ref_To_Local'>querytree_list</span></a><span class='Delimiter'>, 
</span>                                       <span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if !haspolyarg &raquo; </span> 
 
        <a href="../utils/error/elog.c.html#LN87"><span class='Ref_to_Global_Var'>error_context_stack</span></a> <span class='Operator'>= </span><a href="pg_proc.c.html#LN845"><span class='Ref_To_Local'>sqlerrcontext</span></a><span class='Operator'>.</span>previous<span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if check_function_bodies &raquo; </span> 
 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN836"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/fmgr.h.html#LN308"><span class='Ref_to_Macro'>PG_RETURN_VOID</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end fmgr_sql_validator &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Error context callback for handling errors in SQL function definitions 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN959"></a><span class='Declare_Function'>sql_function_parse_error_callback</span><span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Declare_Parameter'>arg</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN961"></a>    <a href="pg_proc.c.html#LN44"><span class='Ref_to_Typedef'>parse_error_callback_arg</span></a> <span class='Operator'>*</span><span class='Declare_Local'>callback_arg</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN44"><span class='Ref_to_Typedef'>parse_error_callback_arg</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="pg_proc.c.html#LN959"><span class='Ref_to_Parameter'>arg</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* See if it's a syntax error; if so, transpose to CREATE FUNCTION */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/catalog/pg_proc_fn.h.html#LN46"><span class='Ref_to_Proto'>function_parse_error_transpose</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN961"><span class='Ref_To_Local'>callback_arg</span></a><span class='Operator'>-&GT;</span><a href="pg_proc.c.html#LN47"><span class='Ref_to_Member'>prosrc</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* If it's not a syntax error, push info onto context stack */ 
</span>        errcontext<span class='Parentheses'>(</span><span class='String'>"SQL function \"%s\""</span><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN961"><span class='Ref_To_Local'>callback_arg</span></a><span class='Operator'>-&GT;</span><a href="pg_proc.c.html#LN46"><span class='Ref_to_Member'>proname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Adjust a syntax error occurring inside the function body of a CREATE 
 * FUNCTION or DO command.  This can be used by any function validator or 
 * anonymous-block handler, not only for SQL-language functions. 
 * It is assumed that the syntax error position is initially relative to the 
 * function body string (as passed in).  If possible, we adjust the position 
 * to reference the original command text; if we can't manage that, we set 
 * up an "internal query" syntax error instead. 
 * 
 * Returns true if a syntax error was processed, false if not. 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN983"></a><span class='Declare_Function'>function_parse_error_transpose</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>prosrc</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN985"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>origerrposition</span><span class='Delimiter'>; 
</span><a name="LN986"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>newerrposition</span><span class='Delimiter'>; 
</span><a name="LN987"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>queryText</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Nothing to do unless we are dealing with a syntax error that has a 
     * cursor position. 
     * 
     * Some PLs may prefer to report the error position as an internal error 
     * to begin with, so check that too. 
     */ 
</span>    <a href="pg_proc.c.html#LN985"><span class='Ref_To_Local'>origerrposition</span></a> <span class='Operator'>= </span><a href="../utils/error/elog.c.html#LN1255"><span class='Ref_to_Func'>geterrposition</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN985"><span class='Ref_To_Local'>origerrposition</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pg_proc.c.html#LN985"><span class='Ref_To_Local'>origerrposition</span></a> <span class='Operator'>= </span><a href="../utils/error/elog.c.html#LN1272"><span class='Ref_to_Func'>getinternalerrposition</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN985"><span class='Ref_To_Local'>origerrposition</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* We can get the original query text from the active portal (hack...) */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../tcop/pquery.c.html#LN34"><span class='Ref_to_Global_Var'>ActivePortal</span></a> <span class='Operator'>&& </span><a href="../tcop/pquery.c.html#LN34"><span class='Ref_to_Global_Var'>ActivePortal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN147"><span class='Ref_to_Member'>status</span></a> <span class='Operator'>== </span><a href="../../include/utils/portal.h.html#LN106"><span class='Ref_to_EnumConst'>PORTAL_ACTIVE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pg_proc.c.html#LN987"><span class='Ref_To_Local'>queryText</span></a> <span class='Operator'>= </span><a href="../tcop/pquery.c.html#LN34"><span class='Ref_to_Global_Var'>ActivePortal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN133"><span class='Ref_to_Member'>sourceText</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Try to locate the prosrc in the original text */ 
</span>    <a href="pg_proc.c.html#LN986"><span class='Ref_To_Local'>newerrposition</span></a> <span class='Operator'>= </span><a href="pg_proc.c.html#LN51"><span class='Ref_to_Proto'>match_prosrc_to_query</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN983"><span class='Ref_to_Parameter'>prosrc</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN987"><span class='Ref_To_Local'>queryText</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN985"><span class='Ref_To_Local'>origerrposition</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN986"><span class='Ref_To_Local'>newerrposition</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Successful, so fix error position to reference original query */ 
</span>        <a href="../utils/error/elog.c.html#LN1123"><span class='Ref_to_Func'>errposition</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN986"><span class='Ref_To_Local'>newerrposition</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* Get rid of any report of the error as an "internal query" */ 
</span>        <a href="../utils/error/elog.c.html#LN1139"><span class='Ref_to_Func'>internalerrposition</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../utils/error/elog.c.html#LN1159"><span class='Ref_to_Func'>internalerrquery</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * If unsuccessful, convert the position to an internal position 
         * marker and give the function text as the internal query. 
         */ 
</span>        <a href="../utils/error/elog.c.html#LN1123"><span class='Ref_to_Func'>errposition</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../utils/error/elog.c.html#LN1139"><span class='Ref_to_Func'>internalerrposition</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN985"><span class='Ref_To_Local'>origerrposition</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../utils/error/elog.c.html#LN1159"><span class='Ref_to_Func'>internalerrquery</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN983"><span class='Ref_to_Parameter'>prosrc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end function_parse_error_transpose &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Try to locate the string literal containing the function body in the 
 * given text of the CREATE FUNCTION or DO command.  If successful, return 
 * the character (not byte) index within the command corresponding to the 
 * given character index within the literal.  If not successful, return 0. 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN1040"></a><span class='Declare_Function'>match_prosrc_to_query</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>prosrc</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>queryText</span><span class='Delimiter'>, 
</span><a name="LN1041"></a>                      <span class='Keyword'>int </span><span class='Declare_Parameter'>cursorpos</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* 
     * Rather than fully parsing the original command, we just scan the 
     * command looking for $prosrc$ or 'prosrc'.  This could be fooled (though 
     * not in any very probable scenarios), so fail if we find more than one 
     * match. 
     */ 
</span><a name="LN1049"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>prosrclen</span> <span class='Operator'>= </span>strlen<span class='Parentheses'>(</span><a href="pg_proc.c.html#LN1040"><span class='Ref_to_Parameter'>prosrc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1050"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>querylen</span> <span class='Operator'>= </span>strlen<span class='Parentheses'>(</span><a href="pg_proc.c.html#LN1040"><span class='Ref_to_Parameter'>queryText</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1051"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>matchpos</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN1052"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>curpos</span><span class='Delimiter'>; 
</span><a name="LN1053"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>newcursorpos</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN1052"><span class='Ref_To_Local'>curpos</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="pg_proc.c.html#LN1052"><span class='Ref_To_Local'>curpos</span></a> <span class='Operator'>&LT; </span><a href="pg_proc.c.html#LN1050"><span class='Ref_To_Local'>querylen</span></a> <span class='Operator'>- </span><a href="pg_proc.c.html#LN1049"><span class='Ref_To_Local'>prosrclen</span></a><span class='Delimiter'>; </span><a href="pg_proc.c.html#LN1052"><span class='Ref_To_Local'>curpos</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN1040"><span class='Ref_to_Parameter'>queryText</span></a><span class='Delimiter'>[</span><a href="pg_proc.c.html#LN1052"><span class='Ref_To_Local'>curpos</span></a><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'$'</span> <span class='Operator'>&& 
</span>            strncmp<span class='Parentheses'>(</span><a href="pg_proc.c.html#LN1040"><span class='Ref_to_Parameter'>prosrc</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="pg_proc.c.html#LN1040"><span class='Ref_to_Parameter'>queryText</span></a><span class='Delimiter'>[</span><a href="pg_proc.c.html#LN1052"><span class='Ref_To_Local'>curpos</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>], </span><a href="pg_proc.c.html#LN1049"><span class='Ref_To_Local'>prosrclen</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>&& 
</span>            <a href="pg_proc.c.html#LN1040"><span class='Ref_to_Parameter'>queryText</span></a><span class='Delimiter'>[</span><a href="pg_proc.c.html#LN1052"><span class='Ref_To_Local'>curpos</span></a> <span class='Operator'>+ </span><span class='Number'>1</span> <span class='Operator'>+ </span><a href="pg_proc.c.html#LN1049"><span class='Ref_To_Local'>prosrclen</span></a><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'$'</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * Found a $foo$ match.  Since there are no embedded quoting 
             * characters in a dollar-quoted literal, we don't have to do any 
             * fancy arithmetic; just offset by the starting position. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN1051"><span class='Ref_To_Local'>matchpos</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* multiple matches, fail */ 
</span>            <a href="pg_proc.c.html#LN1051"><span class='Ref_To_Local'>matchpos</span></a> <span class='Operator'>= </span><a href="../../include/mb/pg_wchar.h.html#LN529"><span class='Ref_to_Proto'>pg_mbstrlen_with_len</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN1040"><span class='Ref_to_Parameter'>queryText</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN1052"><span class='Ref_To_Local'>curpos</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>                <span class='Operator'>+ </span><a href="pg_proc.c.html#LN1041"><span class='Ref_to_Parameter'>cursorpos</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN1040"><span class='Ref_to_Parameter'>queryText</span></a><span class='Delimiter'>[</span><a href="pg_proc.c.html#LN1052"><span class='Ref_To_Local'>curpos</span></a><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'\''</span> <span class='Operator'>&& 
</span>                 <a href="pg_proc.c.html#LN53"><span class='Ref_to_Proto'>match_prosrc_to_literal</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN1040"><span class='Ref_to_Parameter'>prosrc</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="pg_proc.c.html#LN1040"><span class='Ref_to_Parameter'>queryText</span></a><span class='Delimiter'>[</span><a href="pg_proc.c.html#LN1052"><span class='Ref_To_Local'>curpos</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>], 
</span>                                         <a href="pg_proc.c.html#LN1041"><span class='Ref_to_Parameter'>cursorpos</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="pg_proc.c.html#LN1053"><span class='Ref_To_Local'>newcursorpos</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * Found a 'foo' match.  match_prosrc_to_literal() has adjusted 
             * for any quotes or backslashes embedded in the literal. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN1051"><span class='Ref_To_Local'>matchpos</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* multiple matches, fail */ 
</span>            <a href="pg_proc.c.html#LN1051"><span class='Ref_To_Local'>matchpos</span></a> <span class='Operator'>= </span><a href="../../include/mb/pg_wchar.h.html#LN529"><span class='Ref_to_Proto'>pg_mbstrlen_with_len</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN1040"><span class='Ref_to_Parameter'>queryText</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN1052"><span class='Ref_To_Local'>curpos</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>                <span class='Operator'>+ </span><a href="pg_proc.c.html#LN1053"><span class='Ref_To_Local'>newcursorpos</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for curpos=0;curpos&LT;query... &raquo; </span> 
 
    <span class='Control'>return</span> <a href="pg_proc.c.html#LN1051"><span class='Ref_To_Local'>matchpos</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end match_prosrc_to_query &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Try to match the given source text to a single-quoted literal. 
 * If successful, adjust newcursorpos to correspond to the character 
 * (not byte) index corresponding to cursorpos in the source text. 
 * 
 * At entry, literal points just past a ' character.  We must check for the 
 * trailing quote. 
 */ 
</span><span class='Keyword'>static bool 
</span><a name="LN1098"></a><span class='Declare_Function'>match_prosrc_to_literal</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>prosrc</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>literal</span><span class='Delimiter'>, 
</span><a name="LN1099"></a>                        <span class='Keyword'>int </span><span class='Declare_Parameter'>cursorpos</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>newcursorpos</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1101"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>newcp</span> <span class='Operator'>= </span><a href="pg_proc.c.html#LN1099"><span class='Ref_to_Parameter'>cursorpos</span></a><span class='Delimiter'>; 
</span><a name="LN1102"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>chlen</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * This implementation handles backslashes and doubled quotes in the 
     * string literal.  It does not handle the SQL syntax for literals 
     * continued across line boundaries. 
     * 
     * We do the comparison a character at a time, not a byte at a time, so 
     * that we can do the correct cursorpos math. 
     */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="pg_proc.c.html#LN1098"><span class='Ref_to_Parameter'>prosrc</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pg_proc.c.html#LN1099"><span class='Ref_to_Parameter'>cursorpos</span></a><span class='Operator'>--</span><span class='Delimiter'>;</span>            <span class='Comment_Single_Line'>/* characters left before cursor */ 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Check for backslashes and doubled quotes in the literal; adjust 
         * newcp when one is found before the cursor. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="pg_proc.c.html#LN1098"><span class='Ref_to_Parameter'>literal</span></a> <span class='Operator'>== </span><span class='String'>'\\'</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="pg_proc.c.html#LN1098"><span class='Ref_to_Parameter'>literal</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN1099"><span class='Ref_to_Parameter'>cursorpos</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                <a href="pg_proc.c.html#LN1101"><span class='Ref_To_Local'>newcp</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="pg_proc.c.html#LN1098"><span class='Ref_to_Parameter'>literal</span></a> <span class='Operator'>== </span><span class='String'>'\''</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN1098"><span class='Ref_to_Parameter'>literal</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>!= </span><span class='String'>'\''</span><span class='Parentheses'>) 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="pg_proc.c.html#LN1148"><span class='Ref_to_Label'>fail</span></a><span class='Delimiter'>; 
</span>            <a href="pg_proc.c.html#LN1098"><span class='Ref_to_Parameter'>literal</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN1099"><span class='Ref_to_Parameter'>cursorpos</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                <a href="pg_proc.c.html#LN1101"><span class='Ref_To_Local'>newcp</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="pg_proc.c.html#LN1102"><span class='Ref_To_Local'>chlen</span></a> <span class='Operator'>= </span><a href="../../include/mb/pg_wchar.h.html#LN521"><span class='Ref_to_Proto'>pg_mblen</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN1098"><span class='Ref_to_Parameter'>prosrc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>strncmp<span class='Parentheses'>(</span><a href="pg_proc.c.html#LN1098"><span class='Ref_to_Parameter'>prosrc</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN1098"><span class='Ref_to_Parameter'>literal</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN1102"><span class='Ref_To_Local'>chlen</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="pg_proc.c.html#LN1148"><span class='Ref_to_Label'>fail</span></a><span class='Delimiter'>; 
</span>        <a href="pg_proc.c.html#LN1098"><span class='Ref_to_Parameter'>prosrc</span></a> <span class='Operator'>+= </span><a href="pg_proc.c.html#LN1102"><span class='Ref_To_Local'>chlen</span></a><span class='Delimiter'>; 
</span>        <a href="pg_proc.c.html#LN1098"><span class='Ref_to_Parameter'>literal</span></a> <span class='Operator'>+= </span><a href="pg_proc.c.html#LN1102"><span class='Ref_To_Local'>chlen</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while *prosrc &raquo; </span> 
 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="pg_proc.c.html#LN1098"><span class='Ref_to_Parameter'>literal</span></a> <span class='Operator'>== </span><span class='String'>'\''</span> <span class='Operator'>&& </span><a href="pg_proc.c.html#LN1098"><span class='Ref_to_Parameter'>literal</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>!= </span><span class='String'>'\''</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* success */ 
</span>        <span class='Operator'>*</span><a href="pg_proc.c.html#LN1099"><span class='Ref_to_Parameter'>newcursorpos</span></a> <span class='Operator'>= </span><a href="pg_proc.c.html#LN1101"><span class='Ref_To_Local'>newcp</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
<a name="LN1148"></a><span class='Label'>fail</span><span class='Operator'>: 
</span>    <span class='Comment_Multi_Line'>/* Must set *newcursorpos to suppress compiler warning */ 
</span>    <span class='Operator'>*</span><a href="pg_proc.c.html#LN1099"><span class='Ref_to_Parameter'>newcursorpos</span></a> <span class='Operator'>= </span><a href="pg_proc.c.html#LN1101"><span class='Ref_To_Local'>newcp</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end match_prosrc_to_literal &raquo; </span> 
 
<a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>* 
</span><a name="LN1155"></a><span class='Declare_Function'>oid_array_to_list</span><span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Declare_Parameter'>datum</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1157"></a>    <a href="../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>array</span> <span class='Operator'>= </span><a href="../../include/utils/array.h.html#LN241"><span class='Ref_to_Macro'>DatumGetArrayTypeP</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN1155"><span class='Ref_to_Parameter'>datum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1158"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>values</span><span class='Delimiter'>; 
</span><a name="LN1159"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>nelems</span><span class='Delimiter'>; 
</span><a name="LN1160"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN1161"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>result</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/array.h.html#LN382"><span class='Ref_to_Proto'>deconstruct_array</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN1157"><span class='Ref_To_Local'>array</span></a><span class='Delimiter'>, 
</span>                      <a href="../../interfaces/ecpg/ecpglib/pg_type.h.html#LN27"><span class='Ref_to_Const'>OIDOID</span></a><span class='Delimiter'>, 
</span>                      <span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='String'>'i'</span><span class='Delimiter'>, 
</span>                      <span class='Operator'>&</span><a href="pg_proc.c.html#LN1158"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="pg_proc.c.html#LN1159"><span class='Ref_To_Local'>nelems</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="pg_proc.c.html#LN1160"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="pg_proc.c.html#LN1160"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="pg_proc.c.html#LN1159"><span class='Ref_To_Local'>nelems</span></a><span class='Delimiter'>; </span><a href="pg_proc.c.html#LN1160"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <a href="pg_proc.c.html#LN1161"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN162"><span class='Ref_to_Func'>lappend_oid</span></a><span class='Parentheses'>(</span><a href="pg_proc.c.html#LN1161"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="pg_proc.c.html#LN1158"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="pg_proc.c.html#LN1160"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="pg_proc.c.html#LN1161"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
} 
</span></pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>