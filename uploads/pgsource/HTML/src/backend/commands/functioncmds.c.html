<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\backend\commands\functioncmds.c</title>
<LINK REL=StyleSheet HREF="../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\backend\commands\functioncmds.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:35 2017
</td></tr>
<tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
</span><span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * functioncmds.c 
 * 
 *    Routines for CREATE and DROP FUNCTION commands and CREATE and DROP 
 *    CAST commands. 
 * 
 * Portions Copyright (c) 1996-2017, PostgreSQL Global Development Group 
 * Portions Copyright (c) 1994, Regents of the University of California 
 * 
 * 
 * IDENTIFICATION 
 *    src/backend/commands/functioncmds.c 
 * 
 * DESCRIPTION 
 *    These routines take the parse tree and pick out the 
 *    appropriate arguments/flags, and pass the results to the 
 *    corresponding "FooDefine" routines (in src/catalog) that do 
 *    the actual catalog-munging.  These routines also verify permission 
 *    of the user to execute the command. 
 * 
 * NOTES 
 *    These things must be defined and committed in the following order: 
 *      "create function": 
 *              input/output, recv/send procedures 
 *      "create type": 
 *              type 
 *      "create operator": 
 *              operators 
 * 
 *------------------------------------------------------------------------- 
 */ 
</span><span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>"access/genam.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/heapam.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/htup_details.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/sysattr.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/dependency.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/indexing.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/objectaccess.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_aggregate.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_cast.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_language.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_namespace.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_proc.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_proc_fn.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_transform.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_type.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_type_fn.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"commands/alter.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"commands/defrem.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"commands/proclang.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"miscadmin.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/var.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parse_coerce.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parse_collate.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parse_expr.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parse_func.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parse_type.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/acl.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/builtins.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/fmgroids.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/guc.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/lsyscache.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/rel.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/syscache.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/tqual.h"</span> 
 
<span class='Comment_Multi_Line'>/* 
 *   Examine the RETURNS clause of the CREATE FUNCTION statement 
 *   and return information about it as *prorettype_p and *returnsSet. 
 * 
 * This is more complex than the average typename lookup because we want to 
 * allow a shell type to be used, or even created if the specified return type 
 * doesn't exist yet.  (Without this, there's no way to define the I/O procs 
 * for a new type.)  But SQL function creation won't cope, so error out if 
 * the target language is SQL.  (We do this here, not in the SQL-function 
 * validator, so as not to produce a NOTICE and then an ERROR for the same 
 * condition.) 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN82"></a><span class='Declare_Function'>compute_return_type</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN205"><span class='Ref_to_Struct'>TypeName</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>returnType</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>languageOid</span><span class='Delimiter'>, 
</span><a name="LN83"></a>                    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>prorettype_p</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>returnsSet_p</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN85"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>rettype</span><span class='Delimiter'>; 
</span><a name="LN86"></a>    <a href="../../include/parser/parse_type.h.html#LN19"><span class='Ref_to_Typedef'>Type</span></a>        <span class='Declare_Local'>typtup</span><span class='Delimiter'>; 
</span><a name="LN87"></a>    <a href="../../include/utils/acl.h.html#LN169"><span class='Ref_to_Typedef'>AclResult</span></a>   <span class='Declare_Local'>aclresult</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN86"><span class='Ref_To_Local'>typtup</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_type.h.html#LN21"><span class='Ref_to_Proto'>LookupTypeName</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN82"><span class='Ref_to_Parameter'>returnType</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN86"><span class='Ref_To_Local'>typtup</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><span class='Parentheses'>((</span><a href="../../include/catalog/pg_type.h.html#LN232"><span class='Ref_to_Typedef'>Form_pg_type</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN86"><span class='Ref_To_Local'>typtup</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>typisdefined<span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN82"><span class='Ref_to_Parameter'>languageOid</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_language.h.html#LN79"><span class='Ref_to_Const'>SQLlanguageId</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_FUNCTION_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"SQL function cannot return shell type %s"</span><span class='Delimiter'>, 
</span>                                <a href="../../include/parser/parse_type.h.html#LN31"><span class='Ref_to_Proto'>TypeNameToString</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN82"><span class='Ref_to_Parameter'>returnType</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN36"><span class='Ref_to_Const'>NOTICE</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_WRONG_OBJECT_TYPE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"return type %s is only a shell"</span><span class='Delimiter'>, 
</span>                                <a href="../../include/parser/parse_type.h.html#LN31"><span class='Ref_to_Proto'>TypeNameToString</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN82"><span class='Ref_to_Parameter'>returnType</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="functioncmds.c.html#LN85"><span class='Ref_To_Local'>rettype</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_type.h.html#LN39"><span class='Ref_to_Proto'>typeTypeId</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN86"><span class='Ref_To_Local'>typtup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN86"><span class='Ref_To_Local'>typtup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span><a name="LN111"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>typnam</span> <span class='Operator'>= </span><a href="../../include/parser/parse_type.h.html#LN31"><span class='Ref_to_Proto'>TypeNameToString</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN82"><span class='Ref_to_Parameter'>returnType</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN112"></a>        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span><span class='Delimiter'>; 
</span><a name="LN113"></a>        <a href="../../include/utils/acl.h.html#LN169"><span class='Ref_to_Typedef'>AclResult</span></a>   <span class='Declare_Local'>aclresult</span><span class='Delimiter'>; 
</span><a name="LN114"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>typname</span><span class='Delimiter'>; 
</span><a name="LN115"></a>        <a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> <span class='Declare_Local'>address</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Only C-coded functions can be I/O functions.  We enforce this 
         * restriction here mainly to prevent littering the catalogs with 
         * shell types due to simple typos in user-defined function 
         * definitions. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN82"><span class='Ref_to_Parameter'>languageOid</span></a> <span class='Operator'>!= </span><a href="../../include/catalog/pg_language.h.html#LN73"><span class='Ref_to_Const'>INTERNALlanguageId</span></a> <span class='Operator'>&& 
</span>            <a href="functioncmds.c.html#LN82"><span class='Ref_to_Parameter'>languageOid</span></a> <span class='Operator'>!= </span><a href="../../include/catalog/pg_language.h.html#LN76"><span class='Ref_to_Const'>ClanguageId</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_OBJECT<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"type \"%s\" does not exist"</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN111"><span class='Ref_To_Local'>typnam</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Reject if there's typmod decoration, too */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN82"><span class='Ref_to_Parameter'>returnType</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN212"><span class='Ref_to_Member'>typmods</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>            <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"type modifier cannot be specified for shell type \"%s\""</span><span class='Delimiter'>, 
</span>                   <a href="functioncmds.c.html#LN111"><span class='Ref_To_Local'>typnam</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Otherwise, go ahead and make a shell type */ 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN36"><span class='Ref_to_Const'>NOTICE</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_OBJECT<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"type \"%s\" is not yet defined"</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN111"><span class='Ref_To_Local'>typnam</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN871"><span class='Ref_to_Func'>errdetail</span></a><span class='Parentheses'>(</span><span class='String'>"Creating a shell type definition."</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN112"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN118"><span class='Ref_to_Proto'>QualifiedNameGetCreationNamespace</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN82"><span class='Ref_to_Parameter'>returnType</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN208"><span class='Ref_to_Member'>names</span></a><span class='Delimiter'>, 
</span>                                                        <span class='Operator'>&</span><a href="functioncmds.c.html#LN114"><span class='Ref_To_Local'>typname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN113"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>= </span><a href="../../include/utils/acl.h.html#LN289"><span class='Ref_to_Proto'>pg_namespace_aclcheck</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN112"><span class='Ref_To_Local'>namespaceId</span></a><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, 
</span>                                          <a href="../../include/nodes/parsenodes.h.html#LN81"><span class='Ref_to_Const'>ACL_CREATE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN113"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>!= </span><a href="../../include/utils/acl.h.html#LN171"><span class='Ref_to_EnumConst'>ACLCHECK_OK</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/acl.h.html#LN295"><span class='Ref_to_Proto'>aclcheck_error</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN113"><span class='Ref_To_Local'>aclresult</span></a><span class='Delimiter'>, </span><a href="../../include/utils/acl.h.html#LN189"><span class='Ref_to_EnumConst'>ACL_KIND_NAMESPACE</span></a><span class='Delimiter'>, 
</span>                           <a href="../../include/utils/lsyscache.h.html#LN175"><span class='Ref_to_Proto'>get_namespace_name</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN112"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN115"><span class='Ref_To_Local'>address</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_type_fn.h.html#LN20"><span class='Ref_to_Proto'>TypeShellMake</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN114"><span class='Ref_To_Local'>typname</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN112"><span class='Ref_To_Local'>namespaceId</span></a><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>())</span><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN85"><span class='Ref_To_Local'>rettype</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN115"><span class='Ref_To_Local'>address</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a><span class='Delimiter'>; 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN85"><span class='Ref_To_Local'>rettype</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <a href="functioncmds.c.html#LN87"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>= </span><a href="../../include/utils/acl.h.html#LN293"><span class='Ref_to_Proto'>pg_type_aclcheck</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN85"><span class='Ref_To_Local'>rettype</span></a><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN79"><span class='Ref_to_Const'>ACL_USAGE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN87"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>!= </span><a href="../../include/utils/acl.h.html#LN171"><span class='Ref_to_EnumConst'>ACLCHECK_OK</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/acl.h.html#LN301"><span class='Ref_to_Proto'>aclcheck_error_type</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN87"><span class='Ref_To_Local'>aclresult</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN85"><span class='Ref_To_Local'>rettype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Operator'>*</span><a href="functioncmds.c.html#LN83"><span class='Ref_to_Parameter'>prorettype_p</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN85"><span class='Ref_To_Local'>rettype</span></a><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="functioncmds.c.html#LN83"><span class='Ref_to_Parameter'>returnsSet_p</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN82"><span class='Ref_to_Parameter'>returnType</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN210"><span class='Ref_to_Member'>setof</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end compute_return_type &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Interpret the function parameter list of a CREATE FUNCTION or 
 * CREATE AGGREGATE statement. 
 * 
 * Input parameters: 
 * parameters: list of FunctionParameter structs 
 * languageOid: OID of function language (InvalidOid if it's CREATE AGGREGATE) 
 * is_aggregate: needed only to determine error handling 
 * 
 * Results are stored into output parameters.  parameterTypes must always 
 * be created, but the other arrays are set to NULL if not needed. 
 * variadicArgType is set to the variadic array type if there's a VARIADIC 
 * parameter (there can be only one); or to InvalidOid if not. 
 * requiredResultType is set to InvalidOid if there are no OUT parameters, 
 * else it is set to the OID of the implied result type. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN178"></a><span class='Declare_Function'>interpret_function_parameter_list</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, 
</span><a name="LN179"></a>                                  <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>parameters</span><span class='Delimiter'>, 
</span><a name="LN180"></a>                                  <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>languageOid</span><span class='Delimiter'>, 
</span><a name="LN181"></a>                                  <span class='Keyword'>bool </span><span class='Declare_Parameter'>is_aggregate</span><span class='Delimiter'>, 
</span><a name="LN182"></a>                                  <a href="../../include/c.h.html#LN477"><span class='Ref_to_Typedef'>oidvector</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>parameterTypes</span><span class='Delimiter'>, 
</span><a name="LN183"></a>                                  <a href="../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>allParameterTypes</span><span class='Delimiter'>, 
</span><a name="LN184"></a>                                  <a href="../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>parameterModes</span><span class='Delimiter'>, 
</span><a name="LN185"></a>                                  <a href="../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>parameterNames</span><span class='Delimiter'>, 
</span><a name="LN186"></a>                                  <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>parameterDefaults</span><span class='Delimiter'>, 
</span><a name="LN187"></a>                                  <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>variadicArgType</span><span class='Delimiter'>, 
</span><a name="LN188"></a>                                  <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>requiredResultType</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN190"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>parameterCount</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN179"><span class='Ref_to_Parameter'>parameters</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN191"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>inTypes</span><span class='Delimiter'>; 
</span><a name="LN192"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>inCount</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN193"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>allTypes</span><span class='Delimiter'>; 
</span><a name="LN194"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>paramModes</span><span class='Delimiter'>; 
</span><a name="LN195"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>paramNames</span><span class='Delimiter'>; 
</span><a name="LN196"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>outCount</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN197"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>varCount</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN198"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>have_names</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN199"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>have_defaults</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN200"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>x</span><span class='Delimiter'>; 
</span><a name="LN201"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Operator'>*</span><a href="functioncmds.c.html#LN187"><span class='Ref_to_Parameter'>variadicArgType</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>;</span>      <span class='Comment_Single_Line'>/* default result */ 
</span>    <span class='Operator'>*</span><a href="functioncmds.c.html#LN188"><span class='Ref_to_Parameter'>requiredResultType</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>;</span>   <span class='Comment_Single_Line'>/* default result */ 
</span> 
    <a href="functioncmds.c.html#LN191"><span class='Ref_To_Local'>inTypes</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN190"><span class='Ref_To_Local'>parameterCount</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN193"><span class='Ref_To_Local'>allTypes</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN190"><span class='Ref_To_Local'>parameterCount</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN194"><span class='Ref_To_Local'>paramModes</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN190"><span class='Ref_To_Local'>parameterCount</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN195"><span class='Ref_To_Local'>paramNames</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN190"><span class='Ref_To_Local'>parameterCount</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="functioncmds.c.html#LN186"><span class='Ref_to_Parameter'>parameterDefaults</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Scan the list and extract data into work arrays */ 
</span>    <a href="functioncmds.c.html#LN201"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN200"><span class='Ref_To_Local'>x</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN179"><span class='Ref_to_Parameter'>parameters</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN216"></a>        <a href="../../include/nodes/parsenodes.h.html#LN2730"><span class='Ref_to_Struct'>FunctionParameter</span></a> <span class='Operator'>*</span><span class='Declare_Local'>fp</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2730"><span class='Ref_to_Struct'>FunctionParameter</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN200"><span class='Ref_To_Local'>x</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN217"></a>        <a href="../../include/nodes/parsenodes.h.html#LN205"><span class='Ref_to_Struct'>TypeName</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>t</span> <span class='Operator'>= </span><a href="functioncmds.c.html#LN216"><span class='Ref_To_Local'>fp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2734"><span class='Ref_to_Member'>argType</span></a><span class='Delimiter'>; 
</span><a name="LN218"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>isinput</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN219"></a>        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>toid</span><span class='Delimiter'>; 
</span><a name="LN220"></a>        <a href="../../include/parser/parse_type.h.html#LN19"><span class='Ref_to_Typedef'>Type</span></a>        <span class='Declare_Local'>typtup</span><span class='Delimiter'>; 
</span><a name="LN221"></a>        <a href="../../include/utils/acl.h.html#LN169"><span class='Ref_to_Typedef'>AclResult</span></a>   <span class='Declare_Local'>aclresult</span><span class='Delimiter'>; 
</span> 
        <a href="functioncmds.c.html#LN220"><span class='Ref_To_Local'>typtup</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_type.h.html#LN21"><span class='Ref_to_Proto'>LookupTypeName</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN217"><span class='Ref_To_Local'>t</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN220"><span class='Ref_To_Local'>typtup</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><span class='Parentheses'>((</span><a href="../../include/catalog/pg_type.h.html#LN232"><span class='Ref_to_Typedef'>Form_pg_type</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN220"><span class='Ref_To_Local'>typtup</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>typisdefined<span class='Parentheses'>)</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* As above, hard error if language is SQL */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN180"><span class='Ref_to_Parameter'>languageOid</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_language.h.html#LN79"><span class='Ref_to_Const'>SQLlanguageId</span></a><span class='Parentheses'>) 
</span>                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_FUNCTION_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                           <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"SQL function cannot accept shell type %s"</span><span class='Delimiter'>, 
</span>                                  <a href="../../include/parser/parse_type.h.html#LN31"><span class='Ref_to_Proto'>TypeNameToString</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN217"><span class='Ref_To_Local'>t</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>                <span class='Comment_Multi_Line'>/* We don't allow creating aggregates on shell types either */ 
</span>                <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN181"><span class='Ref_to_Parameter'>is_aggregate</span></a><span class='Parentheses'>) 
</span>                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_FUNCTION_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"aggregate cannot accept shell type %s"</span><span class='Delimiter'>, 
</span>                                    <a href="../../include/parser/parse_type.h.html#LN31"><span class='Ref_to_Proto'>TypeNameToString</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN217"><span class='Ref_To_Local'>t</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>                <span class='Control'>else</span> 
                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN36"><span class='Ref_to_Const'>NOTICE</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_WRONG_OBJECT_TYPE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"argument type %s is only a shell"</span><span class='Delimiter'>, 
</span>                                    <a href="../../include/parser/parse_type.h.html#LN31"><span class='Ref_to_Proto'>TypeNameToString</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN217"><span class='Ref_To_Local'>t</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if !((Form_pg_type)GETST... &raquo; </span> 
            <a href="functioncmds.c.html#LN219"><span class='Ref_To_Local'>toid</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_type.h.html#LN39"><span class='Ref_to_Proto'>typeTypeId</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN220"><span class='Ref_To_Local'>typtup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN220"><span class='Ref_To_Local'>typtup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if typtup &raquo; </span> 
        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_OBJECT<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"type %s does not exist"</span><span class='Delimiter'>, 
</span>                            <a href="../../include/parser/parse_type.h.html#LN31"><span class='Ref_to_Proto'>TypeNameToString</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN217"><span class='Ref_To_Local'>t</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>            <a href="functioncmds.c.html#LN219"><span class='Ref_To_Local'>toid</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>;</span>  <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="functioncmds.c.html#LN221"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>= </span><a href="../../include/utils/acl.h.html#LN293"><span class='Ref_to_Proto'>pg_type_aclcheck</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN219"><span class='Ref_To_Local'>toid</span></a><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN79"><span class='Ref_to_Const'>ACL_USAGE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN221"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>!= </span><a href="../../include/utils/acl.h.html#LN171"><span class='Ref_to_EnumConst'>ACLCHECK_OK</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/acl.h.html#LN301"><span class='Ref_to_Proto'>aclcheck_error_type</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN221"><span class='Ref_To_Local'>aclresult</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN219"><span class='Ref_To_Local'>toid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN217"><span class='Ref_To_Local'>t</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN210"><span class='Ref_to_Member'>setof</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN181"><span class='Ref_to_Parameter'>is_aggregate</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_FUNCTION_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"aggregates cannot accept set arguments"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_FUNCTION_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"functions cannot accept set arguments"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* handle input parameters */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN216"><span class='Ref_To_Local'>fp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2735"><span class='Ref_to_Member'>mode</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/parsenodes.h.html#LN2724"><span class='Ref_to_EnumConst'>FUNC_PARAM_OUT</span></a> <span class='Operator'>&& </span><a href="functioncmds.c.html#LN216"><span class='Ref_To_Local'>fp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2735"><span class='Ref_to_Member'>mode</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/parsenodes.h.html#LN2727"><span class='Ref_to_EnumConst'>FUNC_PARAM_TABLE</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* other input parameters can't follow a VARIADIC parameter */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN197"><span class='Ref_To_Local'>varCount</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_FUNCTION_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"VARIADIC parameter must be the last input parameter"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <a href="functioncmds.c.html#LN191"><span class='Ref_To_Local'>inTypes</span></a><span class='Delimiter'>[</span><a href="functioncmds.c.html#LN192"><span class='Ref_To_Local'>inCount</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="functioncmds.c.html#LN219"><span class='Ref_To_Local'>toid</span></a><span class='Delimiter'>; 
</span>            <a href="functioncmds.c.html#LN218"><span class='Ref_To_Local'>isinput</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* handle output parameters */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN216"><span class='Ref_To_Local'>fp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2735"><span class='Ref_to_Member'>mode</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/parsenodes.h.html#LN2723"><span class='Ref_to_EnumConst'>FUNC_PARAM_IN</span></a> <span class='Operator'>&& </span><a href="functioncmds.c.html#LN216"><span class='Ref_To_Local'>fp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2735"><span class='Ref_to_Member'>mode</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/parsenodes.h.html#LN2726"><span class='Ref_to_EnumConst'>FUNC_PARAM_VARIADIC</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN196"><span class='Ref_To_Local'>outCount</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span>  <span class='Comment_Single_Line'>/* save first output param's type */ 
</span>                <span class='Operator'>*</span><a href="functioncmds.c.html#LN188"><span class='Ref_to_Parameter'>requiredResultType</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN219"><span class='Ref_To_Local'>toid</span></a><span class='Delimiter'>; 
</span>            <a href="functioncmds.c.html#LN196"><span class='Ref_To_Local'>outCount</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN216"><span class='Ref_To_Local'>fp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2735"><span class='Ref_to_Member'>mode</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN2726"><span class='Ref_to_EnumConst'>FUNC_PARAM_VARIADIC</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="functioncmds.c.html#LN187"><span class='Ref_to_Parameter'>variadicArgType</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN219"><span class='Ref_To_Local'>toid</span></a><span class='Delimiter'>; 
</span>            <a href="functioncmds.c.html#LN197"><span class='Ref_To_Local'>varCount</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* validate variadic parameter type */ 
</span>            <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN219"><span class='Ref_To_Local'>toid</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>case</span> <a href="../../include/catalog/pg_type.h.html#LN687"><span class='Ref_to_Const'>ANYARRAYOID</span></a><span class='Operator'>: 
</span>                <span class='Control'>case</span> <a href="../../include/catalog/pg_type.h.html#LN685"><span class='Ref_to_Const'>ANYOID</span></a><span class='Operator'>: 
</span>                    <span class='Comment_Multi_Line'>/* okay */ 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Control'>default</span><span class='Operator'>: 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="../../include/utils/lsyscache.h.html#LN157"><span class='Ref_to_Proto'>get_element_type</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN219"><span class='Ref_To_Local'>toid</span></a><span class='Parentheses'>)))</span> 
                        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_FUNCTION_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"VARIADIC parameter must be an array"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="functioncmds.c.html#LN193"><span class='Ref_To_Local'>allTypes</span></a><span class='Delimiter'>[</span><a href="functioncmds.c.html#LN201"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN219"><span class='Ref_To_Local'>toid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="functioncmds.c.html#LN194"><span class='Ref_To_Local'>paramModes</span></a><span class='Delimiter'>[</span><a href="functioncmds.c.html#LN201"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN421"><span class='Ref_to_Macro'>CharGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN216"><span class='Ref_To_Local'>fp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2735"><span class='Ref_to_Member'>mode</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN216"><span class='Ref_To_Local'>fp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2733"><span class='Ref_to_Member'>name</span></a> <span class='Operator'>&& </span><a href="functioncmds.c.html#LN216"><span class='Ref_To_Local'>fp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2733"><span class='Ref_to_Member'>name</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN320"></a>            <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>px</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * As of Postgres 9.0 we disallow using the same name for two 
             * input or two output function parameters.  Depending on the 
             * function's language, conflicting input and output names might 
             * be bad too, but we leave it to the PL to complain if so. 
             */ 
</span>            <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN320"><span class='Ref_To_Local'>px</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN179"><span class='Ref_to_Parameter'>parameters</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN330"></a>                <a href="../../include/nodes/parsenodes.h.html#LN2730"><span class='Ref_to_Struct'>FunctionParameter</span></a> <span class='Operator'>*</span><span class='Declare_Local'>prevfp</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2730"><span class='Ref_to_Struct'>FunctionParameter</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN320"><span class='Ref_To_Local'>px</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN330"><span class='Ref_To_Local'>prevfp</span></a> <span class='Operator'>== </span><a href="functioncmds.c.html#LN216"><span class='Ref_To_Local'>fp</span></a><span class='Parentheses'>) 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Comment_Multi_Line'>/* pure in doesn't conflict with pure out */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="functioncmds.c.html#LN216"><span class='Ref_To_Local'>fp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2735"><span class='Ref_to_Member'>mode</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN2723"><span class='Ref_to_EnumConst'>FUNC_PARAM_IN</span></a> <span class='Operator'>|| 
</span>                     <a href="functioncmds.c.html#LN216"><span class='Ref_To_Local'>fp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2735"><span class='Ref_to_Member'>mode</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN2726"><span class='Ref_to_EnumConst'>FUNC_PARAM_VARIADIC</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>                    <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN330"><span class='Ref_To_Local'>prevfp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2735"><span class='Ref_to_Member'>mode</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN2724"><span class='Ref_to_EnumConst'>FUNC_PARAM_OUT</span></a> <span class='Operator'>|| 
</span>                     <a href="functioncmds.c.html#LN330"><span class='Ref_To_Local'>prevfp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2735"><span class='Ref_to_Member'>mode</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN2727"><span class='Ref_to_EnumConst'>FUNC_PARAM_TABLE</span></a><span class='Parentheses'>))</span> 
                    <span class='Control'>continue</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="functioncmds.c.html#LN330"><span class='Ref_To_Local'>prevfp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2735"><span class='Ref_to_Member'>mode</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN2723"><span class='Ref_to_EnumConst'>FUNC_PARAM_IN</span></a> <span class='Operator'>|| 
</span>                     <a href="functioncmds.c.html#LN330"><span class='Ref_To_Local'>prevfp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2735"><span class='Ref_to_Member'>mode</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN2726"><span class='Ref_to_EnumConst'>FUNC_PARAM_VARIADIC</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>                    <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN216"><span class='Ref_To_Local'>fp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2735"><span class='Ref_to_Member'>mode</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN2724"><span class='Ref_to_EnumConst'>FUNC_PARAM_OUT</span></a> <span class='Operator'>|| 
</span>                     <a href="functioncmds.c.html#LN216"><span class='Ref_To_Local'>fp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2735"><span class='Ref_to_Member'>mode</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN2727"><span class='Ref_to_EnumConst'>FUNC_PARAM_TABLE</span></a><span class='Parentheses'>))</span> 
                    <span class='Control'>continue</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN330"><span class='Ref_To_Local'>prevfp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2733"><span class='Ref_to_Member'>name</span></a> <span class='Operator'>&& </span><a href="functioncmds.c.html#LN330"><span class='Ref_To_Local'>prevfp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2733"><span class='Ref_to_Member'>name</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>&& 
</span>                    strcmp<span class='Parentheses'>(</span><a href="functioncmds.c.html#LN330"><span class='Ref_To_Local'>prevfp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2733"><span class='Ref_to_Member'>name</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN216"><span class='Ref_To_Local'>fp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2733"><span class='Ref_to_Member'>name</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_FUNCTION_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                          <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"parameter name \"%s\" used more than once"</span><span class='Delimiter'>, 
</span>                                 <a href="functioncmds.c.html#LN216"><span class='Ref_To_Local'>fp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2733"><span class='Ref_to_Member'>name</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <a href="functioncmds.c.html#LN195"><span class='Ref_To_Local'>paramNames</span></a><span class='Delimiter'>[</span><a href="functioncmds.c.html#LN201"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/utils/builtins.h.html#LN90"><span class='Ref_to_Macro'>CStringGetTextDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN216"><span class='Ref_To_Local'>fp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2733"><span class='Ref_to_Member'>name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="functioncmds.c.html#LN198"><span class='Ref_To_Local'>have_names</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if fp-&GT;name&&fp-&GT;name[0] &raquo; </span> 
 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN216"><span class='Ref_To_Local'>fp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2736"><span class='Ref_to_Member'>defexpr</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN359"></a>            <a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>def</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="functioncmds.c.html#LN218"><span class='Ref_To_Local'>isinput</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_FUNCTION_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                   <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"only input parameters can have default values"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
            <a href="functioncmds.c.html#LN359"><span class='Ref_To_Local'>def</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_expr.h.html#LN21"><span class='Ref_to_Proto'>transformExpr</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN178"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN216"><span class='Ref_To_Local'>fp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2736"><span class='Ref_to_Member'>defexpr</span></a><span class='Delimiter'>, 
</span>                                <a href="../../include/parser/parse_node.h.html#LN62"><span class='Ref_to_EnumConst'>EXPR_KIND_FUNCTION_DEFAULT</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="functioncmds.c.html#LN359"><span class='Ref_To_Local'>def</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_coerce.h.html#LN56"><span class='Ref_to_Proto'>coerce_to_specific_type</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN178"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN359"><span class='Ref_To_Local'>def</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN219"><span class='Ref_To_Local'>toid</span></a><span class='Delimiter'>, </span><span class='String'>"DEFAULT"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../include/parser/parse_collate.h.html#LN22"><span class='Ref_to_Proto'>assign_expr_collations</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN178"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN359"><span class='Ref_To_Local'>def</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Make sure no variables are referred to (this is probably dead 
             * code now that add_missing_from is history). 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN178"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>                <a href="../../include/optimizer/var.h.html#LN33"><span class='Ref_to_Proto'>contain_var_clause</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN359"><span class='Ref_To_Local'>def</span></a><span class='Parentheses'>))</span> 
                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_COLUMN_REFERENCE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot use table references in parameter default value"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * transformExpr() should have already rejected subqueries, 
             * aggregates, and window functions, based on the EXPR_KIND_ for a 
             * default expression. 
             * 
             * It can't return a set either --- but coerce_to_specific_type 
             * already checked that for us. 
             * 
             * Note: the point of these restrictions is to ensure that an 
             * expression that, on its face, hasn't got subplans, aggregates, 
             * etc cannot suddenly have them after function default arguments 
             * are inserted. 
             */ 
</span> 
            <span class='Operator'>*</span><a href="functioncmds.c.html#LN186"><span class='Ref_to_Parameter'>parameterDefaults</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="functioncmds.c.html#LN186"><span class='Ref_to_Parameter'>parameterDefaults</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN359"><span class='Ref_To_Local'>def</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="functioncmds.c.html#LN199"><span class='Ref_To_Local'>have_defaults</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if fp-&GT;defexpr &raquo; </span> 
        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN218"><span class='Ref_To_Local'>isinput</span></a> <span class='Operator'>&& </span><a href="functioncmds.c.html#LN199"><span class='Ref_To_Local'>have_defaults</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_FUNCTION_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"input parameters after one with a default value must also have defaults"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="functioncmds.c.html#LN201"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Now construct the proper outputs as needed */ 
</span>    <span class='Operator'>*</span><a href="functioncmds.c.html#LN182"><span class='Ref_to_Parameter'>parameterTypes</span></a> <span class='Operator'>= </span><a href="../../include/utils/builtins.h.html#LN67"><span class='Ref_to_Proto'>buildoidvector</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN191"><span class='Ref_To_Local'>inTypes</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN192"><span class='Ref_To_Local'>inCount</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN196"><span class='Ref_To_Local'>outCount</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="functioncmds.c.html#LN197"><span class='Ref_To_Local'>varCount</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Operator'>*</span><a href="functioncmds.c.html#LN183"><span class='Ref_to_Parameter'>allParameterTypes</span></a> <span class='Operator'>= </span><a href="../../include/utils/array.h.html#LN369"><span class='Ref_to_Proto'>construct_array</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN193"><span class='Ref_To_Local'>allTypes</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN190"><span class='Ref_To_Local'>parameterCount</span></a><span class='Delimiter'>, </span><a href="../../interfaces/ecpg/ecpglib/pg_type.h.html#LN27"><span class='Ref_to_Const'>OIDOID</span></a><span class='Delimiter'>, 
</span>                                             <span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='String'>'i'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="functioncmds.c.html#LN184"><span class='Ref_to_Parameter'>parameterModes</span></a> <span class='Operator'>= </span><a href="../../include/utils/array.h.html#LN369"><span class='Ref_to_Proto'>construct_array</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN194"><span class='Ref_To_Local'>paramModes</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN190"><span class='Ref_To_Local'>parameterCount</span></a><span class='Delimiter'>, </span><a href="../../interfaces/ecpg/ecpglib/pg_type.h.html#LN19"><span class='Ref_to_Const'>CHAROID</span></a><span class='Delimiter'>, 
</span>                                          <span class='Number'>1</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='String'>'c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN196"><span class='Ref_To_Local'>outCount</span></a> <span class='Operator'>&GT; </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>            <span class='Operator'>*</span><a href="functioncmds.c.html#LN188"><span class='Ref_to_Parameter'>requiredResultType</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_type.h.html#LN679"><span class='Ref_to_Const'>RECORDOID</span></a><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* otherwise we set requiredResultType correctly above */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Operator'>*</span><a href="functioncmds.c.html#LN183"><span class='Ref_to_Parameter'>allParameterTypes</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="functioncmds.c.html#LN184"><span class='Ref_to_Parameter'>parameterModes</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN198"><span class='Ref_To_Local'>have_names</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN201"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="functioncmds.c.html#LN201"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="functioncmds.c.html#LN190"><span class='Ref_To_Local'>parameterCount</span></a><span class='Delimiter'>; </span><a href="functioncmds.c.html#LN201"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN195"><span class='Ref_To_Local'>paramNames</span></a><span class='Delimiter'>[</span><a href="functioncmds.c.html#LN201"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>== </span><a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Parentheses'>))</span> 
                <a href="functioncmds.c.html#LN195"><span class='Ref_To_Local'>paramNames</span></a><span class='Delimiter'>[</span><a href="functioncmds.c.html#LN201"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/utils/builtins.h.html#LN90"><span class='Ref_to_Macro'>CStringGetTextDatum</span></a><span class='Parentheses'>(</span><span class='String'>""</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Operator'>*</span><a href="functioncmds.c.html#LN185"><span class='Ref_to_Parameter'>parameterNames</span></a> <span class='Operator'>= </span><a href="../../include/utils/array.h.html#LN369"><span class='Ref_to_Proto'>construct_array</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN195"><span class='Ref_To_Local'>paramNames</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN190"><span class='Ref_To_Local'>parameterCount</span></a><span class='Delimiter'>, </span><a href="../../interfaces/ecpg/ecpglib/pg_type.h.html#LN26"><span class='Ref_to_Const'>TEXTOID</span></a><span class='Delimiter'>, 
</span>                                          <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='String'>'i'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
        <span class='Operator'>*</span><a href="functioncmds.c.html#LN185"><span class='Ref_to_Parameter'>parameterNames</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end interpret_function_parameter_list &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * Recognize one of the options that can be passed to both CREATE 
 * FUNCTION and ALTER FUNCTION and return it via one of the out 
 * parameters. Returns true if the passed option was recognized. If 
 * the out parameter we were going to assign to points to non-NULL, 
 * raise a duplicate-clause error.  (We don't try to detect duplicate 
 * SET parameters though --- if you're redundant, the last one wins.) 
 */ 
</span><span class='Keyword'>static bool 
</span><a name="LN452"></a><span class='Declare_Function'>compute_common_attribute</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, 
</span><a name="LN453"></a>                         <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>defel</span><span class='Delimiter'>, 
</span><a name="LN454"></a>                         <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>volatility_item</span><span class='Delimiter'>, 
</span><a name="LN455"></a>                         <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>strict_item</span><span class='Delimiter'>, 
</span><a name="LN456"></a>                         <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>security_item</span><span class='Delimiter'>, 
</span><a name="LN457"></a>                         <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>leakproof_item</span><span class='Delimiter'>, 
</span><a name="LN458"></a>                         <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>set_items</span><span class='Delimiter'>, 
</span><a name="LN459"></a>                         <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>cost_item</span><span class='Delimiter'>, 
</span><a name="LN460"></a>                         <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>rows_item</span><span class='Delimiter'>, 
</span><a name="LN461"></a>                         <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>parallel_item</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="functioncmds.c.html#LN453"><span class='Ref_to_Parameter'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"volatility"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="functioncmds.c.html#LN454"><span class='Ref_to_Parameter'>volatility_item</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="functioncmds.c.html#LN522"><span class='Ref_to_Label'>duplicate_error</span></a><span class='Delimiter'>; 
</span> 
        <span class='Operator'>*</span><a href="functioncmds.c.html#LN454"><span class='Ref_to_Parameter'>volatility_item</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN453"><span class='Ref_to_Parameter'>defel</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="functioncmds.c.html#LN453"><span class='Ref_to_Parameter'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"strict"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="functioncmds.c.html#LN455"><span class='Ref_to_Parameter'>strict_item</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="functioncmds.c.html#LN522"><span class='Ref_to_Label'>duplicate_error</span></a><span class='Delimiter'>; 
</span> 
        <span class='Operator'>*</span><a href="functioncmds.c.html#LN455"><span class='Ref_to_Parameter'>strict_item</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN453"><span class='Ref_to_Parameter'>defel</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="functioncmds.c.html#LN453"><span class='Ref_to_Parameter'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"security"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="functioncmds.c.html#LN456"><span class='Ref_to_Parameter'>security_item</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="functioncmds.c.html#LN522"><span class='Ref_to_Label'>duplicate_error</span></a><span class='Delimiter'>; 
</span> 
        <span class='Operator'>*</span><a href="functioncmds.c.html#LN456"><span class='Ref_to_Parameter'>security_item</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN453"><span class='Ref_to_Parameter'>defel</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="functioncmds.c.html#LN453"><span class='Ref_to_Parameter'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"leakproof"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="functioncmds.c.html#LN457"><span class='Ref_to_Parameter'>leakproof_item</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="functioncmds.c.html#LN522"><span class='Ref_to_Label'>duplicate_error</span></a><span class='Delimiter'>; 
</span> 
        <span class='Operator'>*</span><a href="functioncmds.c.html#LN457"><span class='Ref_to_Parameter'>leakproof_item</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN453"><span class='Ref_to_Parameter'>defel</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="functioncmds.c.html#LN453"><span class='Ref_to_Parameter'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"set"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Operator'>*</span><a href="functioncmds.c.html#LN458"><span class='Ref_to_Parameter'>set_items</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="functioncmds.c.html#LN458"><span class='Ref_to_Parameter'>set_items</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN453"><span class='Ref_to_Parameter'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN720"><span class='Ref_to_Member'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="functioncmds.c.html#LN453"><span class='Ref_to_Parameter'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"cost"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="functioncmds.c.html#LN459"><span class='Ref_to_Parameter'>cost_item</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="functioncmds.c.html#LN522"><span class='Ref_to_Label'>duplicate_error</span></a><span class='Delimiter'>; 
</span> 
        <span class='Operator'>*</span><a href="functioncmds.c.html#LN459"><span class='Ref_to_Parameter'>cost_item</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN453"><span class='Ref_to_Parameter'>defel</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="functioncmds.c.html#LN453"><span class='Ref_to_Parameter'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"rows"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="functioncmds.c.html#LN460"><span class='Ref_to_Parameter'>rows_item</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="functioncmds.c.html#LN522"><span class='Ref_to_Label'>duplicate_error</span></a><span class='Delimiter'>; 
</span> 
        <span class='Operator'>*</span><a href="functioncmds.c.html#LN460"><span class='Ref_to_Parameter'>rows_item</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN453"><span class='Ref_to_Parameter'>defel</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="functioncmds.c.html#LN453"><span class='Ref_to_Parameter'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"parallel"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="functioncmds.c.html#LN461"><span class='Ref_to_Parameter'>parallel_item</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="functioncmds.c.html#LN522"><span class='Ref_to_Label'>duplicate_error</span></a><span class='Delimiter'>; 
</span> 
        <span class='Operator'>*</span><a href="functioncmds.c.html#LN461"><span class='Ref_to_Parameter'>parallel_item</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN453"><span class='Ref_to_Parameter'>defel</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Recognized an option */ 
</span>    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
<a name="LN522"></a><span class='Label'>duplicate_error</span><span class='Operator'>: 
</span>    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"conflicting or redundant options"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>             <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN452"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN453"><span class='Ref_to_Parameter'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN722"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>;</span>               <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span><span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end compute_common_attribute &raquo; </span> 
 
<span class='Keyword'>static char 
</span><a name="LN531"></a><span class='Declare_Function'>interpret_func_volatility</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>defel</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN533"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>str</span> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN531"><span class='Ref_to_Parameter'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN720"><span class='Ref_to_Member'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="functioncmds.c.html#LN533"><span class='Ref_To_Local'>str</span></a><span class='Delimiter'>, </span><span class='String'>"immutable"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="../../include/catalog/pg_proc.h.html#LN5482"><span class='Ref_to_Const'>PROVOLATILE_IMMUTABLE</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="functioncmds.c.html#LN533"><span class='Ref_To_Local'>str</span></a><span class='Delimiter'>, </span><span class='String'>"stable"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="../../include/catalog/pg_proc.h.html#LN5483"><span class='Ref_to_Const'>PROVOLATILE_STABLE</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="functioncmds.c.html#LN533"><span class='Ref_To_Local'>str</span></a><span class='Delimiter'>, </span><span class='String'>"volatile"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="../../include/catalog/pg_proc.h.html#LN5484"><span class='Ref_to_Const'>PROVOLATILE_VOLATILE</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"invalid volatility \"%s\""</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN533"><span class='Ref_To_Local'>str</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>;</span>               <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span>    <span class='Delimiter'>} 
} 
</span> 
<span class='Keyword'>static char 
</span><a name="LN549"></a><span class='Declare_Function'>interpret_func_parallel</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>defel</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN551"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>str</span> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN549"><span class='Ref_to_Parameter'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN720"><span class='Ref_to_Member'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="functioncmds.c.html#LN551"><span class='Ref_To_Local'>str</span></a><span class='Delimiter'>, </span><span class='String'>"safe"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="../../include/catalog/pg_proc.h.html#LN5491"><span class='Ref_to_Const'>PROPARALLEL_SAFE</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="functioncmds.c.html#LN551"><span class='Ref_To_Local'>str</span></a><span class='Delimiter'>, </span><span class='String'>"unsafe"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="../../include/catalog/pg_proc.h.html#LN5493"><span class='Ref_to_Const'>PROPARALLEL_UNSAFE</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="functioncmds.c.html#LN551"><span class='Ref_To_Local'>str</span></a><span class='Delimiter'>, </span><span class='String'>"restricted"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="../../include/catalog/pg_proc.h.html#LN5492"><span class='Ref_to_Const'>PROPARALLEL_RESTRICTED</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"parameter \"parallel\" must be SAFE, RESTRICTED, or UNSAFE"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="../../include/catalog/pg_proc.h.html#LN5493"><span class='Ref_to_Const'>PROPARALLEL_UNSAFE</span></a><span class='Delimiter'>;</span>      <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span>    <span class='Delimiter'>} 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Update a proconfig value according to a list of VariableSetStmt items. 
 * 
 * The input and result may be NULL to signify a null entry. 
 */ 
</span><span class='Keyword'>static </span><a href="../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>* 
</span><a name="LN574"></a><span class='Declare_Function'>update_proconfig_value</span><span class='Parentheses'>(</span><a href="../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>set_items</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN576"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN576"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN574"><span class='Ref_to_Parameter'>set_items</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN580"></a>        <a href="../../include/nodes/parsenodes.h.html#LN1942"><span class='Ref_to_Struct'>VariableSetStmt</span></a> <span class='Operator'>*</span><span class='Declare_Local'>sstmt</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN108"><span class='Ref_to_Macro'>lfirst_node</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN1942"><span class='Ref_to_Struct'>VariableSetStmt</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN576"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN580"><span class='Ref_To_Local'>sstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1945"><span class='Ref_to_Member'>kind</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN1939"><span class='Ref_to_EnumConst'>VAR_RESET_ALL</span></a><span class='Parentheses'>) 
</span>            <a href="functioncmds.c.html#LN574"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span><a name="LN586"></a>            <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>valuestr</span> <span class='Operator'>= </span><a href="../../include/utils/guc.h.html#LN376"><span class='Ref_to_Proto'>ExtractSetVariableArgs</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN580"><span class='Ref_To_Local'>sstmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN586"><span class='Ref_To_Local'>valuestr</span></a><span class='Parentheses'>) 
</span>                <a href="functioncmds.c.html#LN574"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>= </span><a href="../../include/utils/guc.h.html#LN380"><span class='Ref_to_Proto'>GUCArrayAdd</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN574"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN580"><span class='Ref_To_Local'>sstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1946"><span class='Ref_to_Member'>name</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN586"><span class='Ref_To_Local'>valuestr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span>    <span class='Comment_Single_Line'>/* RESET */ 
</span>                <a href="functioncmds.c.html#LN574"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>= </span><a href="../../include/utils/guc.h.html#LN381"><span class='Ref_to_Proto'>GUCArrayDelete</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN574"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN580"><span class='Ref_To_Local'>sstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1946"><span class='Ref_to_Member'>name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="functioncmds.c.html#LN574"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end update_proconfig_value &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * Dissect the list of options assembled in gram.y into function 
 * attributes. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN604"></a><span class='Declare_Function'>compute_attributes_sql_style</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, 
</span><a name="LN605"></a>                             <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>options</span><span class='Delimiter'>, 
</span><a name="LN606"></a>                             <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>as</span><span class='Delimiter'>, 
</span><a name="LN607"></a>                             <span class='Keyword'>char </span><span class='Operator'>**</span><span class='Declare_Parameter'>language</span><span class='Delimiter'>, 
</span><a name="LN608"></a>                             <a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>transform</span><span class='Delimiter'>, 
</span><a name="LN609"></a>                             <span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>windowfunc_p</span><span class='Delimiter'>, 
</span><a name="LN610"></a>                             <span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>volatility_p</span><span class='Delimiter'>, 
</span><a name="LN611"></a>                             <span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>strict_p</span><span class='Delimiter'>, 
</span><a name="LN612"></a>                             <span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>security_definer</span><span class='Delimiter'>, 
</span><a name="LN613"></a>                             <span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>leakproof_p</span><span class='Delimiter'>, 
</span><a name="LN614"></a>                             <a href="../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>proconfig</span><span class='Delimiter'>, 
</span><a name="LN615"></a>                             <a href="../../include/c.h.html#LN379"><span class='Ref_to_Typedef'>float4</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>procost</span><span class='Delimiter'>, 
</span><a name="LN616"></a>                             <a href="../../include/c.h.html#LN379"><span class='Ref_to_Typedef'>float4</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>prorows</span><span class='Delimiter'>, 
</span><a name="LN617"></a>                             <span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>parallel_p</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN619"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>option</span><span class='Delimiter'>; 
</span><a name="LN620"></a>    <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>as_item</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN621"></a>    <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>language_item</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN622"></a>    <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>transform_item</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN623"></a>    <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>windowfunc_item</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN624"></a>    <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>volatility_item</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN625"></a>    <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>strict_item</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN626"></a>    <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>security_item</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN627"></a>    <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>leakproof_item</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN628"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>set_items</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN629"></a>    <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>cost_item</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN630"></a>    <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>rows_item</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN631"></a>    <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>parallel_item</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN619"><span class='Ref_To_Local'>option</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN605"><span class='Ref_to_Parameter'>options</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN635"></a>        <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>defel</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN619"><span class='Ref_To_Local'>option</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="functioncmds.c.html#LN635"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"as"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN620"><span class='Ref_To_Local'>as_item</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"conflicting or redundant options"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN604"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN635"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN722"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <a href="functioncmds.c.html#LN620"><span class='Ref_To_Local'>as_item</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN635"><span class='Ref_To_Local'>defel</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="functioncmds.c.html#LN635"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"language"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN621"><span class='Ref_To_Local'>language_item</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"conflicting or redundant options"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN604"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN635"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN722"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <a href="functioncmds.c.html#LN621"><span class='Ref_To_Local'>language_item</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN635"><span class='Ref_To_Local'>defel</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="functioncmds.c.html#LN635"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"transform"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN622"><span class='Ref_To_Local'>transform_item</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"conflicting or redundant options"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN604"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN635"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN722"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <a href="functioncmds.c.html#LN622"><span class='Ref_To_Local'>transform_item</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN635"><span class='Ref_To_Local'>defel</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="functioncmds.c.html#LN635"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"window"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN623"><span class='Ref_To_Local'>windowfunc_item</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"conflicting or redundant options"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN604"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN635"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN722"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <a href="functioncmds.c.html#LN623"><span class='Ref_To_Local'>windowfunc_item</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN635"><span class='Ref_To_Local'>defel</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN451"><span class='Ref_to_Func'>compute_common_attribute</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN604"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, 
</span>                                          <a href="functioncmds.c.html#LN635"><span class='Ref_To_Local'>defel</span></a><span class='Delimiter'>, 
</span>                                          <span class='Operator'>&</span><a href="functioncmds.c.html#LN624"><span class='Ref_To_Local'>volatility_item</span></a><span class='Delimiter'>, 
</span>                                          <span class='Operator'>&</span><a href="functioncmds.c.html#LN625"><span class='Ref_To_Local'>strict_item</span></a><span class='Delimiter'>, 
</span>                                          <span class='Operator'>&</span><a href="functioncmds.c.html#LN626"><span class='Ref_To_Local'>security_item</span></a><span class='Delimiter'>, 
</span>                                          <span class='Operator'>&</span><a href="functioncmds.c.html#LN627"><span class='Ref_To_Local'>leakproof_item</span></a><span class='Delimiter'>, 
</span>                                          <span class='Operator'>&</span><a href="functioncmds.c.html#LN628"><span class='Ref_To_Local'>set_items</span></a><span class='Delimiter'>, 
</span>                                          <span class='Operator'>&</span><a href="functioncmds.c.html#LN629"><span class='Ref_To_Local'>cost_item</span></a><span class='Delimiter'>, 
</span>                                          <span class='Operator'>&</span><a href="functioncmds.c.html#LN630"><span class='Ref_To_Local'>rows_item</span></a><span class='Delimiter'>, 
</span>                                          <span class='Operator'>&</span><a href="functioncmds.c.html#LN631"><span class='Ref_To_Local'>parallel_item</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* recognized common option */ 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"option \"%s\" not recognized"</span><span class='Delimiter'>, 
</span>                 <a href="functioncmds.c.html#LN635"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* process required items */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN620"><span class='Ref_To_Local'>as_item</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="functioncmds.c.html#LN606"><span class='Ref_to_Parameter'>as</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="functioncmds.c.html#LN620"><span class='Ref_To_Local'>as_item</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN720"><span class='Ref_to_Member'>arg</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_FUNCTION_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"no function body specified"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="functioncmds.c.html#LN606"><span class='Ref_to_Parameter'>as</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>;</span>              <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN621"><span class='Ref_To_Local'>language_item</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="functioncmds.c.html#LN607"><span class='Ref_to_Parameter'>language</span></a> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN621"><span class='Ref_To_Local'>language_item</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN720"><span class='Ref_to_Member'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_FUNCTION_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"no language specified"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="functioncmds.c.html#LN607"><span class='Ref_to_Parameter'>language</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* process optional items */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN622"><span class='Ref_To_Local'>transform_item</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="functioncmds.c.html#LN608"><span class='Ref_to_Parameter'>transform</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN622"><span class='Ref_To_Local'>transform_item</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN720"><span class='Ref_to_Member'>arg</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN623"><span class='Ref_To_Local'>windowfunc_item</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="functioncmds.c.html#LN609"><span class='Ref_to_Parameter'>windowfunc_p</span></a> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN51"><span class='Ref_to_Macro'>intVal</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN623"><span class='Ref_To_Local'>windowfunc_item</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN720"><span class='Ref_to_Member'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN624"><span class='Ref_To_Local'>volatility_item</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="functioncmds.c.html#LN610"><span class='Ref_to_Parameter'>volatility_p</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN530"><span class='Ref_to_Func'>interpret_func_volatility</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN624"><span class='Ref_To_Local'>volatility_item</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN625"><span class='Ref_To_Local'>strict_item</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="functioncmds.c.html#LN611"><span class='Ref_to_Parameter'>strict_p</span></a> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN51"><span class='Ref_to_Macro'>intVal</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN625"><span class='Ref_To_Local'>strict_item</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN720"><span class='Ref_to_Member'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN626"><span class='Ref_To_Local'>security_item</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="functioncmds.c.html#LN612"><span class='Ref_to_Parameter'>security_definer</span></a> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN51"><span class='Ref_to_Macro'>intVal</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN626"><span class='Ref_To_Local'>security_item</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN720"><span class='Ref_to_Member'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN627"><span class='Ref_To_Local'>leakproof_item</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="functioncmds.c.html#LN613"><span class='Ref_to_Parameter'>leakproof_p</span></a> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN51"><span class='Ref_to_Macro'>intVal</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN627"><span class='Ref_To_Local'>leakproof_item</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN720"><span class='Ref_to_Member'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN628"><span class='Ref_To_Local'>set_items</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="functioncmds.c.html#LN614"><span class='Ref_to_Parameter'>proconfig</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN573"><span class='Ref_to_Func'>update_proconfig_value</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN628"><span class='Ref_To_Local'>set_items</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN629"><span class='Ref_To_Local'>cost_item</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Operator'>*</span><a href="functioncmds.c.html#LN615"><span class='Ref_to_Parameter'>procost</span></a> <span class='Operator'>= </span><a href="define.c.html#LN83"><span class='Ref_to_Func'>defGetNumeric</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN629"><span class='Ref_To_Local'>cost_item</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="functioncmds.c.html#LN615"><span class='Ref_to_Parameter'>procost</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"COST must be positive"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN630"><span class='Ref_To_Local'>rows_item</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Operator'>*</span><a href="functioncmds.c.html#LN616"><span class='Ref_to_Parameter'>prorows</span></a> <span class='Operator'>= </span><a href="define.c.html#LN83"><span class='Ref_to_Func'>defGetNumeric</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN630"><span class='Ref_To_Local'>rows_item</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="functioncmds.c.html#LN616"><span class='Ref_to_Parameter'>prorows</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"ROWS must be positive"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN631"><span class='Ref_To_Local'>parallel_item</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="functioncmds.c.html#LN617"><span class='Ref_to_Parameter'>parallel_p</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN548"><span class='Ref_to_Func'>interpret_func_parallel</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN631"><span class='Ref_To_Local'>parallel_item</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end compute_attributes_sql_style &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/*------------- 
 *   Interpret the parameters *parameters and return their contents via 
 *   *isStrict_p and *volatility_p. 
 * 
 *  These parameters supply optional information about a function. 
 *  All have defaults if not specified. Parameters: 
 * 
 *   * isStrict means the function should not be called when any NULL 
 *     inputs are present; instead a NULL result value should be assumed. 
 * 
 *   * volatility tells the optimizer whether the function's result can 
 *     be assumed to be repeatable over multiple evaluations. 
 *------------ 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN764"></a><span class='Declare_Function'>compute_attributes_with_style</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>parameters</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>isStrict_p</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>volatility_p</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN766"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>pl</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN766"><span class='Ref_To_Local'>pl</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN764"><span class='Ref_to_Parameter'>parameters</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN770"></a>        <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>param</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN766"><span class='Ref_To_Local'>pl</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../port/pgstrcasecmp.c.html#LN34"><span class='Ref_to_Func'>pg_strcasecmp</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN770"><span class='Ref_To_Local'>param</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"isstrict"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Operator'>*</span><a href="functioncmds.c.html#LN764"><span class='Ref_to_Parameter'>isStrict_p</span></a> <span class='Operator'>= </span><a href="define.c.html#LN109"><span class='Ref_to_Func'>defGetBoolean</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN770"><span class='Ref_To_Local'>param</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../port/pgstrcasecmp.c.html#LN34"><span class='Ref_to_Func'>pg_strcasecmp</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN770"><span class='Ref_To_Local'>param</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"iscachable"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* obsolete spelling of isImmutable */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="define.c.html#LN109"><span class='Ref_to_Func'>defGetBoolean</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN770"><span class='Ref_To_Local'>param</span></a><span class='Parentheses'>))</span> 
                <span class='Operator'>*</span><a href="functioncmds.c.html#LN764"><span class='Ref_to_Parameter'>volatility_p</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_proc.h.html#LN5482"><span class='Ref_to_Const'>PROVOLATILE_IMMUTABLE</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN39"><span class='Ref_to_Const'>WARNING</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"unrecognized function attribute \"%s\" ignored"</span><span class='Delimiter'>, 
</span>                            <a href="functioncmds.c.html#LN770"><span class='Ref_To_Local'>param</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN764"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN770"><span class='Ref_To_Local'>param</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN722"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end compute_attributes_with_style &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * For a dynamically linked C language object, the form of the clause is 
 * 
 *     AS &LT;object file name&GT; [, &LT;link symbol name&GT; ] 
 * 
 * In all other cases 
 * 
 *     AS &LT;object reference, or sql code&GT; 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN800"></a><span class='Declare_Function'>interpret_AS_clause</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>languageOid</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>languageName</span><span class='Delimiter'>, 
</span><a name="LN801"></a>                    <span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>funcname</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>as</span><span class='Delimiter'>, 
</span><a name="LN802"></a>                    <span class='Keyword'>char </span><span class='Operator'>**</span><span class='Declare_Parameter'>prosrc_str_p</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>**</span><span class='Declare_Parameter'>probin_str_p</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN801"><span class='Ref_to_Parameter'>as</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN800"><span class='Ref_to_Parameter'>languageOid</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_language.h.html#LN76"><span class='Ref_to_Const'>ClanguageId</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * For "C" language, store the file name in probin and, when given, 
         * the link symbol name in prosrc.  If link symbol is omitted, 
         * substitute procedure name.  We also allow link symbol to be 
         * specified as "-", since that was the habit in PG versions before 
         * 8.4, and there might be dump files out there that don't translate 
         * that back to "omitted". 
         */ 
</span>        <span class='Operator'>*</span><a href="functioncmds.c.html#LN802"><span class='Ref_to_Parameter'>probin_str_p</span></a> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN801"><span class='Ref_to_Parameter'>as</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN801"><span class='Ref_to_Parameter'>as</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
            <span class='Operator'>*</span><a href="functioncmds.c.html#LN802"><span class='Ref_to_Parameter'>prosrc_str_p</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN801"><span class='Ref_to_Parameter'>funcname</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="functioncmds.c.html#LN802"><span class='Ref_to_Parameter'>prosrc_str_p</span></a> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN115"><span class='Ref_to_Macro'>lsecond</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN801"><span class='Ref_to_Parameter'>as</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><span class='Operator'>*</span><a href="functioncmds.c.html#LN802"><span class='Ref_to_Parameter'>prosrc_str_p</span></a><span class='Delimiter'>, </span><span class='String'>"-"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Operator'>*</span><a href="functioncmds.c.html#LN802"><span class='Ref_to_Parameter'>prosrc_str_p</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN801"><span class='Ref_to_Parameter'>funcname</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if languageOid==Clanguag... &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Everything else wants the given string in prosrc. */ 
</span>        <span class='Operator'>*</span><a href="functioncmds.c.html#LN802"><span class='Ref_to_Parameter'>prosrc_str_p</span></a> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN801"><span class='Ref_to_Parameter'>as</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="functioncmds.c.html#LN802"><span class='Ref_to_Parameter'>probin_str_p</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN801"><span class='Ref_to_Parameter'>as</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_FUNCTION_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"only one AS item needed for language \"%s\""</span><span class='Delimiter'>, 
</span>                            <a href="functioncmds.c.html#LN800"><span class='Ref_to_Parameter'>languageName</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN800"><span class='Ref_to_Parameter'>languageOid</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_language.h.html#LN73"><span class='Ref_to_Const'>INTERNALlanguageId</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * In PostgreSQL versions before 6.5, the SQL name of the created 
             * function could not be different from the internal name, and 
             * "prosrc" wasn't used.  So there is code out there that does 
             * CREATE FUNCTION xyz AS '' LANGUAGE internal. To preserve some 
             * modicum of backwards compatibility, accept an empty "prosrc" 
             * value as meaning the supplied SQL function name. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span>strlen<span class='Parentheses'>(</span><span class='Operator'>*</span><a href="functioncmds.c.html#LN802"><span class='Ref_to_Parameter'>prosrc_str_p</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Operator'>*</span><a href="functioncmds.c.html#LN802"><span class='Ref_to_Parameter'>prosrc_str_p</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN801"><span class='Ref_to_Parameter'>funcname</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end interpret_AS_clause &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * CreateFunction 
 *   Execute a CREATE FUNCTION utility statement. 
 */ 
</span><a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> 
<a name="LN860"></a><span class='Declare_Function'>CreateFunction</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN2709"><span class='Ref_to_Struct'>CreateFunctionStmt</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>stmt</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN862"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>probin_str</span><span class='Delimiter'>; 
</span><a name="LN863"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>prosrc_str</span><span class='Delimiter'>; 
</span><a name="LN864"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>prorettype</span><span class='Delimiter'>; 
</span><a name="LN865"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>returnsSet</span><span class='Delimiter'>; 
</span><a name="LN866"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>language</span><span class='Delimiter'>; 
</span><a name="LN867"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>languageOid</span><span class='Delimiter'>; 
</span><a name="LN868"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>languageValidator</span><span class='Delimiter'>; 
</span><a name="LN869"></a>    <a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>transformDefElem</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN870"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>funcname</span><span class='Delimiter'>; 
</span><a name="LN871"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span><span class='Delimiter'>; 
</span><a name="LN872"></a>    <a href="../../include/utils/acl.h.html#LN169"><span class='Ref_to_Typedef'>AclResult</span></a>   <span class='Declare_Local'>aclresult</span><span class='Delimiter'>; 
</span><a name="LN873"></a>    <a href="../../include/c.h.html#LN477"><span class='Ref_to_Typedef'>oidvector</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>parameterTypes</span><span class='Delimiter'>; 
</span><a name="LN874"></a>    <a href="../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>allParameterTypes</span><span class='Delimiter'>; 
</span><a name="LN875"></a>    <a href="../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>parameterModes</span><span class='Delimiter'>; 
</span><a name="LN876"></a>    <a href="../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>parameterNames</span><span class='Delimiter'>; 
</span><a name="LN877"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>parameterDefaults</span><span class='Delimiter'>; 
</span><a name="LN878"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>variadicArgType</span><span class='Delimiter'>; 
</span><a name="LN879"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>trftypes_list</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN880"></a>    <a href="../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>trftypes</span><span class='Delimiter'>; 
</span><a name="LN881"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>requiredResultType</span><span class='Delimiter'>; 
</span><a name="LN882"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>isWindowFunc</span><span class='Delimiter'>, 
</span><a name="LN883"></a>                <span class='Declare_Local'>isStrict</span><span class='Delimiter'>, 
</span><a name="LN884"></a>                <span class='Declare_Local'>security</span><span class='Delimiter'>, 
</span><a name="LN885"></a>                <span class='Declare_Local'>isLeakProof</span><span class='Delimiter'>; 
</span><a name="LN886"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>volatility</span><span class='Delimiter'>; 
</span><a name="LN887"></a>    <a href="../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>proconfig</span><span class='Delimiter'>; 
</span><a name="LN888"></a>    <a href="../../include/c.h.html#LN379"><span class='Ref_to_Typedef'>float4</span></a>      <span class='Declare_Local'>procost</span><span class='Delimiter'>; 
</span><a name="LN889"></a>    <a href="../../include/c.h.html#LN379"><span class='Ref_to_Typedef'>float4</span></a>      <span class='Declare_Local'>prorows</span><span class='Delimiter'>; 
</span><a name="LN890"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>languageTuple</span><span class='Delimiter'>; 
</span><a name="LN891"></a>    <a href="../../include/catalog/pg_language.h.html#LN50"><span class='Ref_to_Typedef'>Form_pg_language</span></a> <span class='Declare_Local'>languageStruct</span><span class='Delimiter'>; 
</span><a name="LN892"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>as_clause</span><span class='Delimiter'>; 
</span><a name="LN893"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>parallel</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Convert list of names to a name and namespace */ 
</span>    <a href="functioncmds.c.html#LN871"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN118"><span class='Ref_to_Proto'>QualifiedNameGetCreationNamespace</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN860"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2713"><span class='Ref_to_Member'>funcname</span></a><span class='Delimiter'>, 
</span>                                                    <span class='Operator'>&</span><a href="functioncmds.c.html#LN870"><span class='Ref_To_Local'>funcname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Check we have creation rights in target namespace */ 
</span>    <a href="functioncmds.c.html#LN872"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>= </span><a href="../../include/utils/acl.h.html#LN289"><span class='Ref_to_Proto'>pg_namespace_aclcheck</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN871"><span class='Ref_To_Local'>namespaceId</span></a><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN81"><span class='Ref_to_Const'>ACL_CREATE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN872"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>!= </span><a href="../../include/utils/acl.h.html#LN171"><span class='Ref_to_EnumConst'>ACLCHECK_OK</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/acl.h.html#LN295"><span class='Ref_to_Proto'>aclcheck_error</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN872"><span class='Ref_To_Local'>aclresult</span></a><span class='Delimiter'>, </span><a href="../../include/utils/acl.h.html#LN189"><span class='Ref_to_EnumConst'>ACL_KIND_NAMESPACE</span></a><span class='Delimiter'>, 
</span>                       <a href="../../include/utils/lsyscache.h.html#LN175"><span class='Ref_to_Proto'>get_namespace_name</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN871"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* default attributes */ 
</span>    <a href="functioncmds.c.html#LN882"><span class='Ref_To_Local'>isWindowFunc</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN883"><span class='Ref_To_Local'>isStrict</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN884"><span class='Ref_To_Local'>security</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN885"><span class='Ref_To_Local'>isLeakProof</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN886"><span class='Ref_To_Local'>volatility</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_proc.h.html#LN5484"><span class='Ref_to_Const'>PROVOLATILE_VOLATILE</span></a><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN887"><span class='Ref_To_Local'>proconfig</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN888"><span class='Ref_To_Local'>procost</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>;</span>               <span class='Comment_Single_Line'>/* indicates not set */ 
</span>    <a href="functioncmds.c.html#LN889"><span class='Ref_To_Local'>prorows</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>;</span>               <span class='Comment_Single_Line'>/* indicates not set */ 
</span>    <a href="functioncmds.c.html#LN893"><span class='Ref_To_Local'>parallel</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_proc.h.html#LN5493"><span class='Ref_to_Const'>PROPARALLEL_UNSAFE</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* override attributes from explicit list */ 
</span>    <a href="functioncmds.c.html#LN603"><span class='Ref_to_Func'>compute_attributes_sql_style</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN860"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, 
</span>                                 <a href="functioncmds.c.html#LN860"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2716"><span class='Ref_to_Member'>options</span></a><span class='Delimiter'>, 
</span>                                 <span class='Operator'>&</span><a href="functioncmds.c.html#LN892"><span class='Ref_To_Local'>as_clause</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN866"><span class='Ref_To_Local'>language</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN869"><span class='Ref_To_Local'>transformDefElem</span></a><span class='Delimiter'>, 
</span>                                 <span class='Operator'>&</span><a href="functioncmds.c.html#LN882"><span class='Ref_To_Local'>isWindowFunc</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN886"><span class='Ref_To_Local'>volatility</span></a><span class='Delimiter'>, 
</span>                                 <span class='Operator'>&</span><a href="functioncmds.c.html#LN883"><span class='Ref_To_Local'>isStrict</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN884"><span class='Ref_To_Local'>security</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN885"><span class='Ref_To_Local'>isLeakProof</span></a><span class='Delimiter'>, 
</span>                                 <span class='Operator'>&</span><a href="functioncmds.c.html#LN887"><span class='Ref_To_Local'>proconfig</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN888"><span class='Ref_To_Local'>procost</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN889"><span class='Ref_To_Local'>prorows</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN893"><span class='Ref_To_Local'>parallel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Look up the language and validate permissions */ 
</span>    <a href="functioncmds.c.html#LN890"><span class='Ref_To_Local'>languageTuple</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN66"><span class='Ref_to_EnumConst'>LANGNAME</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN866"><span class='Ref_To_Local'>language</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN890"><span class='Ref_To_Local'>languageTuple</span></a><span class='Parentheses'>))</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_OBJECT<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"language \"%s\" does not exist"</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN866"><span class='Ref_To_Local'>language</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <span class='Parentheses'>(</span><a href="../../include/commands/proclang.h.html#LN19"><span class='Ref_to_Proto'>PLTemplateExists</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN866"><span class='Ref_To_Local'>language</span></a><span class='Parentheses'>) </span><span class='Operator'>? 
</span>                  <a href="../utils/error/elog.c.html#LN985"><span class='Ref_to_Func'>errhint</span></a><span class='Parentheses'>(</span><span class='String'>"Use CREATE LANGUAGE to load the language into the database."</span><span class='Parentheses'>) </span><span class='Operator'>: </span><span class='Number'>0</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN867"><span class='Ref_To_Local'>languageOid</span></a> <span class='Operator'>= </span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN890"><span class='Ref_To_Local'>languageTuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN891"><span class='Ref_To_Local'>languageStruct</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_language.h.html#LN50"><span class='Ref_to_Typedef'>Form_pg_language</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN890"><span class='Ref_To_Local'>languageTuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN891"><span class='Ref_To_Local'>languageStruct</span></a><span class='Operator'>-&GT;</span>lanpltrusted<span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* if trusted language, need USAGE privilege */ 
</span><a name="LN939"></a>        <a href="../../include/utils/acl.h.html#LN169"><span class='Ref_to_Typedef'>AclResult</span></a>   <span class='Declare_Local'>aclresult</span><span class='Delimiter'>; 
</span> 
        <a href="functioncmds.c.html#LN939"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>= </span><a href="../../include/utils/acl.h.html#LN286"><span class='Ref_to_Proto'>pg_language_aclcheck</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN867"><span class='Ref_To_Local'>languageOid</span></a><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN79"><span class='Ref_to_Const'>ACL_USAGE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN939"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>!= </span><a href="../../include/utils/acl.h.html#LN171"><span class='Ref_to_EnumConst'>ACLCHECK_OK</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/acl.h.html#LN295"><span class='Ref_to_Proto'>aclcheck_error</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN939"><span class='Ref_To_Local'>aclresult</span></a><span class='Delimiter'>, </span><a href="../../include/utils/acl.h.html#LN187"><span class='Ref_to_EnumConst'>ACL_KIND_LANGUAGE</span></a><span class='Delimiter'>, 
</span>                           <a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN891"><span class='Ref_To_Local'>languageStruct</span></a><span class='Operator'>-&GT;</span>lanname<span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* if untrusted language, must be superuser */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../utils/misc/superuser.c.html#LN45"><span class='Ref_to_Func'>superuser</span></a><span class='Parentheses'>())</span> 
            <a href="../../include/utils/acl.h.html#LN295"><span class='Ref_to_Proto'>aclcheck_error</span></a><span class='Parentheses'>(</span><a href="../../include/utils/acl.h.html#LN172"><span class='Ref_to_EnumConst'>ACLCHECK_NO_PRIV</span></a><span class='Delimiter'>, </span><a href="../../include/utils/acl.h.html#LN187"><span class='Ref_to_EnumConst'>ACL_KIND_LANGUAGE</span></a><span class='Delimiter'>, 
</span>                           <a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN891"><span class='Ref_To_Local'>languageStruct</span></a><span class='Operator'>-&GT;</span>lanname<span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="functioncmds.c.html#LN868"><span class='Ref_To_Local'>languageValidator</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN891"><span class='Ref_To_Local'>languageStruct</span></a><span class='Operator'>-&GT;</span>lanvalidator<span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN890"><span class='Ref_To_Local'>languageTuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Only superuser is allowed to create leakproof functions because 
     * leakproof functions can see tuples which have not yet been filtered out 
     * by security barrier views or row level security policies. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN885"><span class='Ref_To_Local'>isLeakProof</span></a> <span class='Operator'>&& !</span><a href="../utils/misc/superuser.c.html#LN45"><span class='Ref_to_Func'>superuser</span></a><span class='Parentheses'>())</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INSUFFICIENT_PRIVILEGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"only superuser can define a leakproof function"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN869"><span class='Ref_To_Local'>transformDefElem</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN970"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN970"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/nodes.h.html#LN575"><span class='Ref_to_Macro'>castNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN869"><span class='Ref_To_Local'>transformDefElem</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN974"></a>            <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>typeid</span> <span class='Operator'>= </span><a href="../../include/parser/parse_type.h.html#LN27"><span class='Ref_to_Proto'>typenameTypeId</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                                                <a href="../../include/nodes/pg_list.h.html#LN108"><span class='Ref_to_Macro'>lfirst_node</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN205"><span class='Ref_to_Struct'>TypeName</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN970"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span><a name="LN976"></a>            <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>elt</span> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN160"><span class='Ref_to_Proto'>get_base_element_type</span></a><span class='Parentheses'>(</span><span class='Keyword'>typeid</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Keyword'>typeid </span><span class='Operator'>= </span><a href="functioncmds.c.html#LN976"><span class='Ref_To_Local'>elt</span></a> <span class='Operator'>? </span><a href="functioncmds.c.html#LN976"><span class='Ref_To_Local'>elt</span></a> <span class='Operator'>: </span><span class='Keyword'>typeid</span><span class='Delimiter'>; 
</span> 
            <a href="../../include/commands/defrem.h.html#LN62"><span class='Ref_to_Proto'>get_transform_oid</span></a><span class='Parentheses'>(</span><span class='Keyword'>typeid</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN867"><span class='Ref_To_Local'>languageOid</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="functioncmds.c.html#LN879"><span class='Ref_To_Local'>trftypes_list</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN162"><span class='Ref_to_Func'>lappend_oid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN879"><span class='Ref_To_Local'>trftypes_list</span></a><span class='Delimiter'>, </span><span class='Keyword'>typeid</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Convert remaining parameters of CREATE to form wanted by 
     * ProcedureCreate. 
     */ 
</span>    <a href="../../include/commands/defrem.h.html#LN63"><span class='Ref_to_Proto'>interpret_function_parameter_list</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN860"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, 
</span>                                      <a href="functioncmds.c.html#LN860"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2714"><span class='Ref_to_Member'>parameters</span></a><span class='Delimiter'>, 
</span>                                      <a href="functioncmds.c.html#LN867"><span class='Ref_To_Local'>languageOid</span></a><span class='Delimiter'>, 
</span>                                      <span class='Boolean'>false</span><span class='Delimiter'>,</span>    <span class='Comment_Single_Line'>/* not an aggregate */ 
</span>                                      <span class='Operator'>&</span><a href="functioncmds.c.html#LN873"><span class='Ref_To_Local'>parameterTypes</span></a><span class='Delimiter'>, 
</span>                                      <span class='Operator'>&</span><a href="functioncmds.c.html#LN874"><span class='Ref_To_Local'>allParameterTypes</span></a><span class='Delimiter'>, 
</span>                                      <span class='Operator'>&</span><a href="functioncmds.c.html#LN875"><span class='Ref_To_Local'>parameterModes</span></a><span class='Delimiter'>, 
</span>                                      <span class='Operator'>&</span><a href="functioncmds.c.html#LN876"><span class='Ref_To_Local'>parameterNames</span></a><span class='Delimiter'>, 
</span>                                      <span class='Operator'>&</span><a href="functioncmds.c.html#LN877"><span class='Ref_To_Local'>parameterDefaults</span></a><span class='Delimiter'>, 
</span>                                      <span class='Operator'>&</span><a href="functioncmds.c.html#LN878"><span class='Ref_To_Local'>variadicArgType</span></a><span class='Delimiter'>, 
</span>                                      <span class='Operator'>&</span><a href="functioncmds.c.html#LN881"><span class='Ref_To_Local'>requiredResultType</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN860"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2715"><span class='Ref_to_Member'>returnType</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* explicit RETURNS clause */ 
</span>        <a href="functioncmds.c.html#LN81"><span class='Ref_to_Func'>compute_return_type</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN860"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2715"><span class='Ref_to_Member'>returnType</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN867"><span class='Ref_To_Local'>languageOid</span></a><span class='Delimiter'>, 
</span>                            <span class='Operator'>&</span><a href="functioncmds.c.html#LN864"><span class='Ref_To_Local'>prorettype</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN865"><span class='Ref_To_Local'>returnsSet</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN881"><span class='Ref_To_Local'>requiredResultType</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><a href="functioncmds.c.html#LN864"><span class='Ref_To_Local'>prorettype</span></a> <span class='Operator'>!= </span><a href="functioncmds.c.html#LN881"><span class='Ref_To_Local'>requiredResultType</span></a><span class='Parentheses'>)</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_FUNCTION_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"function result type must be %s because of OUT parameters"</span><span class='Delimiter'>, 
</span>                            <a href="../utils/adt/format_type.c.html#LN92"><span class='Ref_to_Func'>format_type_be</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN881"><span class='Ref_To_Local'>requiredResultType</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN881"><span class='Ref_To_Local'>requiredResultType</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* default RETURNS clause from OUT parameters */ 
</span>        <a href="functioncmds.c.html#LN864"><span class='Ref_To_Local'>prorettype</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN881"><span class='Ref_To_Local'>requiredResultType</span></a><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN865"><span class='Ref_To_Local'>returnsSet</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_FUNCTION_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"function result type must be specified"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* Alternative possibility: default to RETURNS VOID */ 
</span>        <a href="functioncmds.c.html#LN864"><span class='Ref_To_Local'>prorettype</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_type.h.html#LN689"><span class='Ref_to_Const'>VOIDOID</span></a><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN865"><span class='Ref_To_Local'>returnsSet</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN879"><span class='Ref_To_Local'>trftypes_list</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1030"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span><a name="LN1031"></a>        <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>arr</span><span class='Delimiter'>; 
</span><a name="LN1032"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
        <a href="functioncmds.c.html#LN1031"><span class='Ref_To_Local'>arr</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN879"><span class='Ref_To_Local'>trftypes_list</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN1032"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1030"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN879"><span class='Ref_To_Local'>trftypes_list</span></a><span class='Parentheses'>) 
</span><a name="LN1037"></a>            <span class='Declare_Local'>arr</span><span class='Delimiter'>[</span><a href="functioncmds.c.html#LN1032"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1030"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN880"><span class='Ref_To_Local'>trftypes</span></a> <span class='Operator'>= </span><a href="../../include/utils/array.h.html#LN369"><span class='Ref_to_Proto'>construct_array</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1031"><span class='Ref_To_Local'>arr</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN879"><span class='Ref_To_Local'>trftypes_list</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                   <a href="../../interfaces/ecpg/ecpglib/pg_type.h.html#LN27"><span class='Ref_to_Const'>OIDOID</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='String'>'i'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* store SQL NULL instead of empty array */ 
</span>        <a href="functioncmds.c.html#LN880"><span class='Ref_To_Local'>trftypes</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="functioncmds.c.html#LN763"><span class='Ref_to_Func'>compute_attributes_with_style</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN860"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN860"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2717"><span class='Ref_to_Member'>withClause</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN883"><span class='Ref_To_Local'>isStrict</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN886"><span class='Ref_To_Local'>volatility</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN799"><span class='Ref_to_Func'>interpret_AS_clause</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN867"><span class='Ref_To_Local'>languageOid</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN866"><span class='Ref_To_Local'>language</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN870"><span class='Ref_To_Local'>funcname</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN892"><span class='Ref_To_Local'>as_clause</span></a><span class='Delimiter'>, 
</span>                        <span class='Operator'>&</span><a href="functioncmds.c.html#LN863"><span class='Ref_To_Local'>prosrc_str</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN862"><span class='Ref_To_Local'>probin_str</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Set default values for COST and ROWS depending on other parameters; 
     * reject ROWS if it's not returnsSet.  NB: pg_dump knows these default 
     * values, keep it in sync if you change them. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN888"><span class='Ref_To_Local'>procost</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* SQL and PL-language functions are assumed more expensive */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN867"><span class='Ref_To_Local'>languageOid</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_language.h.html#LN73"><span class='Ref_to_Const'>INTERNALlanguageId</span></a> <span class='Operator'>|| 
</span>            <a href="functioncmds.c.html#LN867"><span class='Ref_To_Local'>languageOid</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_language.h.html#LN76"><span class='Ref_to_Const'>ClanguageId</span></a><span class='Parentheses'>) 
</span>            <a href="functioncmds.c.html#LN888"><span class='Ref_To_Local'>procost</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="functioncmds.c.html#LN888"><span class='Ref_To_Local'>procost</span></a> <span class='Operator'>= </span><span class='Number'>100</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN889"><span class='Ref_To_Local'>prorows</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN865"><span class='Ref_To_Local'>returnsSet</span></a><span class='Parentheses'>) 
</span>            <a href="functioncmds.c.html#LN889"><span class='Ref_To_Local'>prorows</span></a> <span class='Operator'>= </span><span class='Number'>1000</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="functioncmds.c.html#LN889"><span class='Ref_To_Local'>prorows</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* dummy value if not returnsSet */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="functioncmds.c.html#LN865"><span class='Ref_To_Local'>returnsSet</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"ROWS is not applicable when function does not return a set"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * And now that we have all the parameters, and know we're permitted to do 
     * so, go ahead and create the function. 
     */ 
</span>    <span class='Control'>return</span> <a href="../../include/catalog/pg_proc_fn.h.html#LN19"><span class='Ref_to_Proto'>ProcedureCreate</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN870"><span class='Ref_To_Local'>funcname</span></a><span class='Delimiter'>, 
</span>                           <a href="functioncmds.c.html#LN871"><span class='Ref_To_Local'>namespaceId</span></a><span class='Delimiter'>, 
</span>                           <a href="functioncmds.c.html#LN860"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2712"><span class='Ref_to_Member'>replace</span></a><span class='Delimiter'>, 
</span>                           <a href="functioncmds.c.html#LN865"><span class='Ref_To_Local'>returnsSet</span></a><span class='Delimiter'>, 
</span>                           <a href="functioncmds.c.html#LN864"><span class='Ref_To_Local'>prorettype</span></a><span class='Delimiter'>, 
</span>                           <a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, 
</span>                           <a href="functioncmds.c.html#LN867"><span class='Ref_To_Local'>languageOid</span></a><span class='Delimiter'>, 
</span>                           <a href="functioncmds.c.html#LN868"><span class='Ref_To_Local'>languageValidator</span></a><span class='Delimiter'>, 
</span>                           <a href="functioncmds.c.html#LN863"><span class='Ref_To_Local'>prosrc_str</span></a><span class='Delimiter'>,</span>  <span class='Comment_Single_Line'>/* converted to text later */ 
</span>                           <a href="functioncmds.c.html#LN862"><span class='Ref_To_Local'>probin_str</span></a><span class='Delimiter'>,</span>  <span class='Comment_Single_Line'>/* converted to text later */ 
</span>                           <span class='Boolean'>false</span><span class='Delimiter'>,</span>       <span class='Comment_Single_Line'>/* not an aggregate */ 
</span>                           <a href="functioncmds.c.html#LN882"><span class='Ref_To_Local'>isWindowFunc</span></a><span class='Delimiter'>, 
</span>                           <a href="functioncmds.c.html#LN884"><span class='Ref_To_Local'>security</span></a><span class='Delimiter'>, 
</span>                           <a href="functioncmds.c.html#LN885"><span class='Ref_To_Local'>isLeakProof</span></a><span class='Delimiter'>, 
</span>                           <a href="functioncmds.c.html#LN883"><span class='Ref_To_Local'>isStrict</span></a><span class='Delimiter'>, 
</span>                           <a href="functioncmds.c.html#LN886"><span class='Ref_To_Local'>volatility</span></a><span class='Delimiter'>, 
</span>                           <a href="functioncmds.c.html#LN893"><span class='Ref_To_Local'>parallel</span></a><span class='Delimiter'>, 
</span>                           <a href="functioncmds.c.html#LN873"><span class='Ref_To_Local'>parameterTypes</span></a><span class='Delimiter'>, 
</span>                           <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN874"><span class='Ref_To_Local'>allParameterTypes</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                           <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN875"><span class='Ref_To_Local'>parameterModes</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                           <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN876"><span class='Ref_To_Local'>parameterNames</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                           <a href="functioncmds.c.html#LN877"><span class='Ref_To_Local'>parameterDefaults</span></a><span class='Delimiter'>, 
</span>                           <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN880"><span class='Ref_To_Local'>trftypes</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                           <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN887"><span class='Ref_To_Local'>proconfig</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                           <a href="functioncmds.c.html#LN888"><span class='Ref_To_Local'>procost</span></a><span class='Delimiter'>, 
</span>                           <a href="functioncmds.c.html#LN889"><span class='Ref_To_Local'>prorows</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end CreateFunction &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Guts of function deletion. 
 * 
 * Note: this is also used for aggregate deletion, since the OIDs of 
 * both functions and aggregates point to pg_proc. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN1117"></a><span class='Declare_Function'>RemoveFunctionById</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>funcOid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1119"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>relation</span><span class='Delimiter'>; 
</span><a name="LN1120"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tup</span><span class='Delimiter'>; 
</span><a name="LN1121"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>isagg</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Delete the pg_proc tuple. 
     */ 
</span>    <a href="functioncmds.c.html#LN1119"><span class='Ref_To_Local'>relation</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN91"><span class='Ref_to_Proto'>heap_open</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_proc.h.html#LN32"><span class='Ref_to_Const'>ProcedureRelationId</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN1120"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN76"><span class='Ref_to_EnumConst'>PROCOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1117"><span class='Ref_to_Parameter'>funcOid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1120"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>))</span> <span class='Comment_Single_Line'>/* should not happen */ 
</span>        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for function %u"</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1117"><span class='Ref_to_Parameter'>funcOid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN1121"><span class='Ref_To_Local'>isagg</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="../../include/catalog/pg_proc.h.html#LN82"><span class='Ref_to_Typedef'>Form_pg_proc</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1120"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>proisagg<span class='Delimiter'>; 
</span> 
    <a href="../../include/catalog/indexing.h.html#LN40"><span class='Ref_to_Proto'>CatalogTupleDelete</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1119"><span class='Ref_To_Local'>relation</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1120"><span class='Ref_To_Local'>tup</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/htup.h.html#LN64"><span class='Ref_to_Member'>t_self</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1120"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1119"><span class='Ref_To_Local'>relation</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If there's a pg_aggregate tuple, delete that too. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1121"><span class='Ref_To_Local'>isagg</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="functioncmds.c.html#LN1119"><span class='Ref_To_Local'>relation</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN91"><span class='Ref_to_Proto'>heap_open</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_aggregate.h.html#LN52"><span class='Ref_to_Const'>AggregateRelationId</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="functioncmds.c.html#LN1120"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN33"><span class='Ref_to_EnumConst'>AGGFNOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1117"><span class='Ref_to_Parameter'>funcOid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1120"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>))</span>     <span class='Comment_Single_Line'>/* should not happen */ 
</span>            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for pg_aggregate tuple for function %u"</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1117"><span class='Ref_to_Parameter'>funcOid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/catalog/indexing.h.html#LN40"><span class='Ref_to_Proto'>CatalogTupleDelete</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1119"><span class='Ref_To_Local'>relation</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1120"><span class='Ref_To_Local'>tup</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/htup.h.html#LN64"><span class='Ref_to_Member'>t_self</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1120"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1119"><span class='Ref_To_Local'>relation</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end RemoveFunctionById &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Implements the ALTER FUNCTION utility command (except for the 
 * RENAME and OWNER clauses, which are handled as part of the generic 
 * ALTER framework). 
 */ 
</span><a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> 
<a name="LN1165"></a><span class='Declare_Function'>AlterFunction</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN2739"><span class='Ref_to_Struct'>AlterFunctionStmt</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>stmt</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1167"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tup</span><span class='Delimiter'>; 
</span><a name="LN1168"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>funcOid</span><span class='Delimiter'>; 
</span><a name="LN1169"></a>    <a href="../../include/catalog/pg_proc.h.html#LN82"><span class='Ref_to_Typedef'>Form_pg_proc</span></a> <span class='Declare_Local'>procForm</span><span class='Delimiter'>; 
</span><a name="LN1170"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>rel</span><span class='Delimiter'>; 
</span><a name="LN1171"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span><a name="LN1172"></a>    <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>volatility_item</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN1173"></a>    <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>strict_item</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN1174"></a>    <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>security_def_item</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN1175"></a>    <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>leakproof_item</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN1176"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>set_items</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN1177"></a>    <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>cost_item</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN1178"></a>    <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>rows_item</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN1179"></a>    <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>parallel_item</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN1180"></a>    <a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> <span class='Declare_Local'>address</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN1170"><span class='Ref_To_Local'>rel</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN91"><span class='Ref_to_Proto'>heap_open</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_proc.h.html#LN32"><span class='Ref_to_Const'>ProcedureRelationId</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN1168"><span class='Ref_To_Local'>funcOid</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_func.h.html#LN64"><span class='Ref_to_Proto'>LookupFuncWithArgs</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1165"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2742"><span class='Ref_to_Member'>func</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN1167"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN164"><span class='Ref_to_Macro'>SearchSysCacheCopy1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN76"><span class='Ref_to_EnumConst'>PROCOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1168"><span class='Ref_To_Local'>funcOid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1167"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>))</span> <span class='Comment_Single_Line'>/* should not happen */ 
</span>        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for function %u"</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1168"><span class='Ref_To_Local'>funcOid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN1169"><span class='Ref_To_Local'>procForm</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_proc.h.html#LN82"><span class='Ref_to_Typedef'>Form_pg_proc</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1167"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Permission check: must own function */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/acl.h.html#LN311"><span class='Ref_to_Proto'>pg_proc_ownercheck</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1168"><span class='Ref_To_Local'>funcOid</span></a><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()))</span> 
        <a href="../../include/utils/acl.h.html#LN295"><span class='Ref_to_Proto'>aclcheck_error</span></a><span class='Parentheses'>(</span><a href="../../include/utils/acl.h.html#LN173"><span class='Ref_to_EnumConst'>ACLCHECK_NOT_OWNER</span></a><span class='Delimiter'>, </span><a href="../../include/utils/acl.h.html#LN184"><span class='Ref_to_EnumConst'>ACL_KIND_PROC</span></a><span class='Delimiter'>, 
</span>                       <a href="../../include/catalog/namespace.h.html#LN120"><span class='Ref_to_Proto'>NameListToString</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1165"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2742"><span class='Ref_to_Member'>func</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1851"><span class='Ref_to_Member'>objname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1169"><span class='Ref_To_Local'>procForm</span></a><span class='Operator'>-&GT;</span>proisagg<span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_WRONG_OBJECT_TYPE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"\"%s\" is an aggregate function"</span><span class='Delimiter'>, 
</span>                        <a href="../../include/catalog/namespace.h.html#LN120"><span class='Ref_to_Proto'>NameListToString</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1165"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2742"><span class='Ref_to_Member'>func</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1851"><span class='Ref_to_Member'>objname</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Examine requested actions. */ 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1171"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1165"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2743"><span class='Ref_to_Member'>actions</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1206"></a>        <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>defel</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1171"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN451"><span class='Ref_to_Func'>compute_common_attribute</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1165"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, 
</span>                                     <a href="functioncmds.c.html#LN1206"><span class='Ref_To_Local'>defel</span></a><span class='Delimiter'>, 
</span>                                     <span class='Operator'>&</span><a href="functioncmds.c.html#LN1172"><span class='Ref_To_Local'>volatility_item</span></a><span class='Delimiter'>, 
</span>                                     <span class='Operator'>&</span><a href="functioncmds.c.html#LN1173"><span class='Ref_To_Local'>strict_item</span></a><span class='Delimiter'>, 
</span>                                     <span class='Operator'>&</span><a href="functioncmds.c.html#LN1174"><span class='Ref_To_Local'>security_def_item</span></a><span class='Delimiter'>, 
</span>                                     <span class='Operator'>&</span><a href="functioncmds.c.html#LN1175"><span class='Ref_To_Local'>leakproof_item</span></a><span class='Delimiter'>, 
</span>                                     <span class='Operator'>&</span><a href="functioncmds.c.html#LN1176"><span class='Ref_To_Local'>set_items</span></a><span class='Delimiter'>, 
</span>                                     <span class='Operator'>&</span><a href="functioncmds.c.html#LN1177"><span class='Ref_To_Local'>cost_item</span></a><span class='Delimiter'>, 
</span>                                     <span class='Operator'>&</span><a href="functioncmds.c.html#LN1178"><span class='Ref_To_Local'>rows_item</span></a><span class='Delimiter'>, 
</span>                                     <span class='Operator'>&</span><a href="functioncmds.c.html#LN1179"><span class='Ref_To_Local'>parallel_item</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Boolean'>false</span><span class='Parentheses'>)</span> 
            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"option \"%s\" not recognized"</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1206"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1172"><span class='Ref_To_Local'>volatility_item</span></a><span class='Parentheses'>) 
</span>        <a href="functioncmds.c.html#LN1169"><span class='Ref_To_Local'>procForm</span></a><span class='Operator'>-&GT;</span>provolatile <span class='Operator'>= </span><a href="functioncmds.c.html#LN530"><span class='Ref_to_Func'>interpret_func_volatility</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1172"><span class='Ref_To_Local'>volatility_item</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1173"><span class='Ref_To_Local'>strict_item</span></a><span class='Parentheses'>) 
</span>        <a href="functioncmds.c.html#LN1169"><span class='Ref_To_Local'>procForm</span></a><span class='Operator'>-&GT;</span>proisstrict <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN51"><span class='Ref_to_Macro'>intVal</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1173"><span class='Ref_To_Local'>strict_item</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN720"><span class='Ref_to_Member'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1174"><span class='Ref_To_Local'>security_def_item</span></a><span class='Parentheses'>) 
</span>        <a href="functioncmds.c.html#LN1169"><span class='Ref_To_Local'>procForm</span></a><span class='Operator'>-&GT;</span>prosecdef <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN51"><span class='Ref_to_Macro'>intVal</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1174"><span class='Ref_To_Local'>security_def_item</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN720"><span class='Ref_to_Member'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1175"><span class='Ref_To_Local'>leakproof_item</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="functioncmds.c.html#LN1169"><span class='Ref_To_Local'>procForm</span></a><span class='Operator'>-&GT;</span>proleakproof <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN51"><span class='Ref_to_Macro'>intVal</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1175"><span class='Ref_To_Local'>leakproof_item</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN720"><span class='Ref_to_Member'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1169"><span class='Ref_To_Local'>procForm</span></a><span class='Operator'>-&GT;</span>proleakproof <span class='Operator'>&& !</span><a href="../utils/misc/superuser.c.html#LN45"><span class='Ref_to_Func'>superuser</span></a><span class='Parentheses'>())</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INSUFFICIENT_PRIVILEGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                  <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"only superuser can define a leakproof function"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1177"><span class='Ref_To_Local'>cost_item</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="functioncmds.c.html#LN1169"><span class='Ref_To_Local'>procForm</span></a><span class='Operator'>-&GT;</span>procost <span class='Operator'>= </span><a href="define.c.html#LN83"><span class='Ref_to_Func'>defGetNumeric</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1177"><span class='Ref_To_Local'>cost_item</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1169"><span class='Ref_To_Local'>procForm</span></a><span class='Operator'>-&GT;</span>procost <span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"COST must be positive"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1178"><span class='Ref_To_Local'>rows_item</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="functioncmds.c.html#LN1169"><span class='Ref_To_Local'>procForm</span></a><span class='Operator'>-&GT;</span>prorows <span class='Operator'>= </span><a href="define.c.html#LN83"><span class='Ref_to_Func'>defGetNumeric</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1178"><span class='Ref_To_Local'>rows_item</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1169"><span class='Ref_To_Local'>procForm</span></a><span class='Operator'>-&GT;</span>prorows <span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"ROWS must be positive"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="functioncmds.c.html#LN1169"><span class='Ref_To_Local'>procForm</span></a><span class='Operator'>-&GT;</span>proretset<span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"ROWS is not applicable when function does not return a set"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1176"><span class='Ref_To_Local'>set_items</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1257"></a>        <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>datum</span><span class='Delimiter'>; 
</span><a name="LN1258"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>isnull</span><span class='Delimiter'>; 
</span><a name="LN1259"></a>        <a href="../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>a</span><span class='Delimiter'>; 
</span><a name="LN1260"></a>        <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>repl_val</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN88"><span class='Ref_to_Const'>Natts_pg_proc</span></a><span class='Delimiter'>]; 
</span><a name="LN1261"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>repl_null</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN88"><span class='Ref_to_Const'>Natts_pg_proc</span></a><span class='Delimiter'>]; 
</span><a name="LN1262"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>repl_repl</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN88"><span class='Ref_to_Const'>Natts_pg_proc</span></a><span class='Delimiter'>]; 
</span> 
        <span class='Comment_Multi_Line'>/* extract existing proconfig setting */ 
</span>        <a href="functioncmds.c.html#LN1257"><span class='Ref_To_Local'>datum</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN133"><span class='Ref_to_Proto'>SysCacheGetAttr</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN76"><span class='Ref_to_EnumConst'>PROCOID</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1167"><span class='Ref_To_Local'>tup</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/pg_proc.h.html#LN116"><span class='Ref_to_Const'>Anum_pg_proc_proconfig</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1258"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN1259"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN1258"><span class='Ref_To_Local'>isnull</span></a> <span class='Operator'>? </span><span class='Null_Value'>NULL </span><span class='Operator'>: </span><a href="../../include/utils/array.h.html#LN241"><span class='Ref_to_Macro'>DatumGetArrayTypeP</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1257"><span class='Ref_To_Local'>datum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* update according to each SET or RESET item, left to right */ 
</span>        <a href="functioncmds.c.html#LN1259"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN573"><span class='Ref_to_Func'>update_proconfig_value</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1259"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1176"><span class='Ref_To_Local'>set_items</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* update the tuple */ 
</span>        memset<span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1262"><span class='Ref_To_Local'>repl_repl</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1262"><span class='Ref_To_Local'>repl_repl</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN1262"><span class='Ref_To_Local'>repl_repl</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN116"><span class='Ref_to_Const'>Anum_pg_proc_proconfig</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1259"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="functioncmds.c.html#LN1260"><span class='Ref_To_Local'>repl_val</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN116"><span class='Ref_to_Const'>Anum_pg_proc_proconfig</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>) </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <a href="functioncmds.c.html#LN1261"><span class='Ref_To_Local'>repl_null</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN116"><span class='Ref_to_Const'>Anum_pg_proc_proconfig</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="functioncmds.c.html#LN1260"><span class='Ref_To_Local'>repl_val</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN116"><span class='Ref_to_Const'>Anum_pg_proc_proconfig</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1259"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="functioncmds.c.html#LN1261"><span class='Ref_To_Local'>repl_null</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_proc.h.html#LN116"><span class='Ref_to_Const'>Anum_pg_proc_proconfig</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="functioncmds.c.html#LN1167"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="../access/common/heaptuple.c.html#LN789"><span class='Ref_to_Func'>heap_modify_tuple</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1167"><span class='Ref_To_Local'>tup</span></a><span class='Delimiter'>, </span><a href="../../include/utils/rel.h.html#LN428"><span class='Ref_to_Macro'>RelationGetDescr</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1170"><span class='Ref_To_Local'>rel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                <a href="functioncmds.c.html#LN1260"><span class='Ref_To_Local'>repl_val</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1261"><span class='Ref_To_Local'>repl_null</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1262"><span class='Ref_To_Local'>repl_repl</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if set_items &raquo; </span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1179"><span class='Ref_To_Local'>parallel_item</span></a><span class='Parentheses'>) 
</span>        <a href="functioncmds.c.html#LN1169"><span class='Ref_To_Local'>procForm</span></a><span class='Operator'>-&GT;</span>proparallel <span class='Operator'>= </span><a href="functioncmds.c.html#LN548"><span class='Ref_to_Func'>interpret_func_parallel</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1179"><span class='Ref_To_Local'>parallel_item</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Do the update */ 
</span>    <a href="../../include/catalog/indexing.h.html#LN35"><span class='Ref_to_Proto'>CatalogTupleUpdate</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1170"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1167"><span class='Ref_To_Local'>tup</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/htup.h.html#LN64"><span class='Ref_to_Member'>t_self</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1167"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/catalog/objectaccess.h.html#LN162"><span class='Ref_to_Macro'>InvokeObjectPostAlterHook</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_proc.h.html#LN32"><span class='Ref_to_Const'>ProcedureRelationId</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1168"><span class='Ref_To_Local'>funcOid</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/catalog/objectaddress.h.html#LN39"><span class='Ref_to_Macro'>ObjectAddressSet</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1180"><span class='Ref_To_Local'>address</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/pg_proc.h.html#LN32"><span class='Ref_to_Const'>ProcedureRelationId</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1168"><span class='Ref_To_Local'>funcOid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1170"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN33"><span class='Ref_to_Const'>NoLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/access/htup_details.h.html#LN815"><span class='Ref_to_Proto'>heap_freetuple</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1167"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="functioncmds.c.html#LN1180"><span class='Ref_To_Local'>address</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end AlterFunction &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * SetFunctionReturnType - change declared return type of a function 
 * 
 * This is presently only used for adjusting legacy functions that return 
 * OPAQUE to return whatever we find their correct definition should be. 
 * The caller should emit a suitable warning explaining what we did. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN1313"></a><span class='Declare_Function'>SetFunctionReturnType</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>funcOid</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>newRetType</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1315"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>pg_proc_rel</span><span class='Delimiter'>; 
</span><a name="LN1316"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tup</span><span class='Delimiter'>; 
</span><a name="LN1317"></a>    <a href="../../include/catalog/pg_proc.h.html#LN82"><span class='Ref_to_Typedef'>Form_pg_proc</span></a> <span class='Declare_Local'>procForm</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN1315"><span class='Ref_To_Local'>pg_proc_rel</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN91"><span class='Ref_to_Proto'>heap_open</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_proc.h.html#LN32"><span class='Ref_to_Const'>ProcedureRelationId</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN1316"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN164"><span class='Ref_to_Macro'>SearchSysCacheCopy1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN76"><span class='Ref_to_EnumConst'>PROCOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1313"><span class='Ref_to_Parameter'>funcOid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1316"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>))</span> <span class='Comment_Single_Line'>/* should not happen */ 
</span>        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for function %u"</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1313"><span class='Ref_to_Parameter'>funcOid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1317"><span class='Ref_To_Local'>procForm</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_proc.h.html#LN82"><span class='Ref_to_Typedef'>Form_pg_proc</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1316"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1317"><span class='Ref_To_Local'>procForm</span></a><span class='Operator'>-&GT;</span>prorettype <span class='Operator'>!= </span><a href="../../include/catalog/pg_type.h.html#LN699"><span class='Ref_to_Const'>OPAQUEOID</span></a><span class='Parentheses'>)</span>      <span class='Comment_Single_Line'>/* caller messed up */ 
</span>        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"function %u doesn't return OPAQUE"</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1313"><span class='Ref_to_Parameter'>funcOid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* okay to overwrite copied tuple */ 
</span>    <a href="functioncmds.c.html#LN1317"><span class='Ref_To_Local'>procForm</span></a><span class='Operator'>-&GT;</span>prorettype <span class='Operator'>= </span><a href="functioncmds.c.html#LN1313"><span class='Ref_to_Parameter'>newRetType</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* update the catalog and its indexes */ 
</span>    <a href="../../include/catalog/indexing.h.html#LN35"><span class='Ref_to_Proto'>CatalogTupleUpdate</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1315"><span class='Ref_To_Local'>pg_proc_rel</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1316"><span class='Ref_To_Local'>tup</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/htup.h.html#LN64"><span class='Ref_to_Member'>t_self</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1316"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1315"><span class='Ref_To_Local'>pg_proc_rel</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end SetFunctionReturnType &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * SetFunctionArgType - change declared argument type of a function 
 * 
 * As above, but change an argument's type. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN1345"></a><span class='Declare_Function'>SetFunctionArgType</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>funcOid</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>argIndex</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>newArgType</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1347"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>pg_proc_rel</span><span class='Delimiter'>; 
</span><a name="LN1348"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tup</span><span class='Delimiter'>; 
</span><a name="LN1349"></a>    <a href="../../include/catalog/pg_proc.h.html#LN82"><span class='Ref_to_Typedef'>Form_pg_proc</span></a> <span class='Declare_Local'>procForm</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN1347"><span class='Ref_To_Local'>pg_proc_rel</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN91"><span class='Ref_to_Proto'>heap_open</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_proc.h.html#LN32"><span class='Ref_to_Const'>ProcedureRelationId</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN1348"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN164"><span class='Ref_to_Macro'>SearchSysCacheCopy1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN76"><span class='Ref_to_EnumConst'>PROCOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1345"><span class='Ref_to_Parameter'>funcOid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1348"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>))</span> <span class='Comment_Single_Line'>/* should not happen */ 
</span>        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for function %u"</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1345"><span class='Ref_to_Parameter'>funcOid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1349"><span class='Ref_To_Local'>procForm</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_proc.h.html#LN82"><span class='Ref_to_Typedef'>Form_pg_proc</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1348"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1345"><span class='Ref_to_Parameter'>argIndex</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="functioncmds.c.html#LN1345"><span class='Ref_to_Parameter'>argIndex</span></a> <span class='Operator'>&GT;= </span><a href="functioncmds.c.html#LN1349"><span class='Ref_To_Local'>procForm</span></a><span class='Operator'>-&GT;</span>pronargs <span class='Operator'>|| 
</span>        <a href="functioncmds.c.html#LN1349"><span class='Ref_To_Local'>procForm</span></a><span class='Operator'>-&GT;</span>proargtypes<span class='Operator'>.</span>values<span class='Delimiter'>[</span><a href="functioncmds.c.html#LN1345"><span class='Ref_to_Parameter'>argIndex</span></a><span class='Delimiter'>] </span><span class='Operator'>!= </span><a href="../../include/catalog/pg_type.h.html#LN699"><span class='Ref_to_Const'>OPAQUEOID</span></a><span class='Parentheses'>) 
</span>        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"function %u doesn't take OPAQUE"</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1345"><span class='Ref_to_Parameter'>funcOid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* okay to overwrite copied tuple */ 
</span>    <a href="functioncmds.c.html#LN1349"><span class='Ref_To_Local'>procForm</span></a><span class='Operator'>-&GT;</span>proargtypes<span class='Operator'>.</span>values<span class='Delimiter'>[</span><a href="functioncmds.c.html#LN1345"><span class='Ref_to_Parameter'>argIndex</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="functioncmds.c.html#LN1345"><span class='Ref_to_Parameter'>newArgType</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* update the catalog and its indexes */ 
</span>    <a href="../../include/catalog/indexing.h.html#LN35"><span class='Ref_to_Proto'>CatalogTupleUpdate</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1347"><span class='Ref_To_Local'>pg_proc_rel</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1348"><span class='Ref_To_Local'>tup</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/htup.h.html#LN64"><span class='Ref_to_Member'>t_self</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1348"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1347"><span class='Ref_To_Local'>pg_proc_rel</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end SetFunctionArgType &raquo; </span> 
 
 
 
<span class='Comment_Multi_Line'>/* 
 * CREATE CAST 
 */ 
</span><a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> 
<a name="LN1377"></a><span class='Declare_Function'>CreateCast</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN3226"><span class='Ref_to_Struct'>CreateCastStmt</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>stmt</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1379"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>sourcetypeid</span><span class='Delimiter'>; 
</span><a name="LN1380"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>targettypeid</span><span class='Delimiter'>; 
</span><a name="LN1381"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>sourcetyptype</span><span class='Delimiter'>; 
</span><a name="LN1382"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>targettyptype</span><span class='Delimiter'>; 
</span><a name="LN1383"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>funcid</span><span class='Delimiter'>; 
</span><a name="LN1384"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>castid</span><span class='Delimiter'>; 
</span><a name="LN1385"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>nargs</span><span class='Delimiter'>; 
</span><a name="LN1386"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>castcontext</span><span class='Delimiter'>; 
</span><a name="LN1387"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>castmethod</span><span class='Delimiter'>; 
</span><a name="LN1388"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>relation</span><span class='Delimiter'>; 
</span><a name="LN1389"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tuple</span><span class='Delimiter'>; 
</span><a name="LN1390"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>values</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_cast.h.html#LN76"><span class='Ref_to_Const'>Natts_pg_cast</span></a><span class='Delimiter'>]; 
</span><a name="LN1391"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>nulls</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_cast.h.html#LN76"><span class='Ref_to_Const'>Natts_pg_cast</span></a><span class='Delimiter'>]; 
</span><a name="LN1392"></a>    <a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> <span class='Declare_Local'>myself</span><span class='Delimiter'>, 
</span><a name="LN1393"></a>                <span class='Declare_Local'>referenced</span><span class='Delimiter'>; 
</span><a name="LN1394"></a>    <a href="../../include/utils/acl.h.html#LN169"><span class='Ref_to_Typedef'>AclResult</span></a>   <span class='Declare_Local'>aclresult</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN1379"><span class='Ref_To_Local'>sourcetypeid</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_type.h.html#LN27"><span class='Ref_to_Proto'>typenameTypeId</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1377"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3229"><span class='Ref_to_Member'>sourcetype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1380"><span class='Ref_To_Local'>targettypeid</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_type.h.html#LN27"><span class='Ref_to_Proto'>typenameTypeId</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1377"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3230"><span class='Ref_to_Member'>targettype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1381"><span class='Ref_To_Local'>sourcetyptype</span></a> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN149"><span class='Ref_to_Proto'>get_typtype</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1379"><span class='Ref_To_Local'>sourcetypeid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1382"><span class='Ref_To_Local'>targettyptype</span></a> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN149"><span class='Ref_to_Proto'>get_typtype</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1380"><span class='Ref_To_Local'>targettypeid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* No pseudo-types allowed */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1381"><span class='Ref_To_Local'>sourcetyptype</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_type.h.html#LN723"><span class='Ref_to_Const'>TYPTYPE_PSEUDO</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_WRONG_OBJECT_TYPE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"source data type %s is a pseudo-type"</span><span class='Delimiter'>, 
</span>                        <a href="../../include/parser/parse_type.h.html#LN31"><span class='Ref_to_Proto'>TypeNameToString</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1377"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3229"><span class='Ref_to_Member'>sourcetype</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1382"><span class='Ref_To_Local'>targettyptype</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_type.h.html#LN723"><span class='Ref_to_Const'>TYPTYPE_PSEUDO</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_WRONG_OBJECT_TYPE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"target data type %s is a pseudo-type"</span><span class='Delimiter'>, 
</span>                        <a href="../../include/parser/parse_type.h.html#LN31"><span class='Ref_to_Proto'>TypeNameToString</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1377"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3230"><span class='Ref_to_Member'>targettype</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Permission check */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/acl.h.html#LN309"><span class='Ref_to_Proto'>pg_type_ownercheck</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1379"><span class='Ref_To_Local'>sourcetypeid</span></a><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>())</span> 
        <span class='Operator'>&& !</span><a href="../../include/utils/acl.h.html#LN309"><span class='Ref_to_Proto'>pg_type_ownercheck</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1380"><span class='Ref_To_Local'>targettypeid</span></a><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()))</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INSUFFICIENT_PRIVILEGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"must be owner of type %s or type %s"</span><span class='Delimiter'>, 
</span>                        <a href="../utils/adt/format_type.c.html#LN92"><span class='Ref_to_Func'>format_type_be</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1379"><span class='Ref_To_Local'>sourcetypeid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                        <a href="../utils/adt/format_type.c.html#LN92"><span class='Ref_to_Func'>format_type_be</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1380"><span class='Ref_To_Local'>targettypeid</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN1394"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>= </span><a href="../../include/utils/acl.h.html#LN293"><span class='Ref_to_Proto'>pg_type_aclcheck</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1379"><span class='Ref_To_Local'>sourcetypeid</span></a><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN79"><span class='Ref_to_Const'>ACL_USAGE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1394"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>!= </span><a href="../../include/utils/acl.h.html#LN171"><span class='Ref_to_EnumConst'>ACLCHECK_OK</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/acl.h.html#LN301"><span class='Ref_to_Proto'>aclcheck_error_type</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1394"><span class='Ref_To_Local'>aclresult</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1379"><span class='Ref_To_Local'>sourcetypeid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN1394"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>= </span><a href="../../include/utils/acl.h.html#LN293"><span class='Ref_to_Proto'>pg_type_aclcheck</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1380"><span class='Ref_To_Local'>targettypeid</span></a><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN79"><span class='Ref_to_Const'>ACL_USAGE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1394"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>!= </span><a href="../../include/utils/acl.h.html#LN171"><span class='Ref_to_EnumConst'>ACLCHECK_OK</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/acl.h.html#LN301"><span class='Ref_to_Proto'>aclcheck_error_type</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1394"><span class='Ref_To_Local'>aclresult</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1380"><span class='Ref_To_Local'>targettypeid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Domains are allowed for historical reasons, but we warn */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1381"><span class='Ref_To_Local'>sourcetyptype</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_type.h.html#LN721"><span class='Ref_to_Const'>TYPTYPE_DOMAIN</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN39"><span class='Ref_to_Const'>WARNING</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_WRONG_OBJECT_TYPE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cast will be ignored because the source data type is a domain"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1382"><span class='Ref_To_Local'>targettyptype</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_type.h.html#LN721"><span class='Ref_to_Const'>TYPTYPE_DOMAIN</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN39"><span class='Ref_to_Const'>WARNING</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_WRONG_OBJECT_TYPE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cast will be ignored because the target data type is a domain"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Determine the cast method */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1377"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3231"><span class='Ref_to_Member'>func</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <a href="functioncmds.c.html#LN1387"><span class='Ref_To_Local'>castmethod</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_cast.h.html#LN66"><span class='Ref_to_EnumConst'>COERCION_METHOD_FUNCTION</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1377"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3233"><span class='Ref_to_Member'>inout</span></a><span class='Parentheses'>) 
</span>        <a href="functioncmds.c.html#LN1387"><span class='Ref_To_Local'>castmethod</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_cast.h.html#LN68"><span class='Ref_to_EnumConst'>COERCION_METHOD_INOUT</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="functioncmds.c.html#LN1387"><span class='Ref_To_Local'>castmethod</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_cast.h.html#LN67"><span class='Ref_to_EnumConst'>COERCION_METHOD_BINARY</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1387"><span class='Ref_To_Local'>castmethod</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_cast.h.html#LN66"><span class='Ref_to_EnumConst'>COERCION_METHOD_FUNCTION</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1452"></a>        <a href="../../include/catalog/pg_proc.h.html#LN82"><span class='Ref_to_Typedef'>Form_pg_proc</span></a> <span class='Declare_Local'>procstruct</span><span class='Delimiter'>; 
</span> 
        <a href="functioncmds.c.html#LN1383"><span class='Ref_To_Local'>funcid</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_func.h.html#LN64"><span class='Ref_to_Proto'>LookupFuncWithArgs</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1377"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3231"><span class='Ref_to_Member'>func</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="functioncmds.c.html#LN1389"><span class='Ref_To_Local'>tuple</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN76"><span class='Ref_to_EnumConst'>PROCOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1383"><span class='Ref_To_Local'>funcid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1389"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>))</span> 
            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for function %u"</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1383"><span class='Ref_To_Local'>funcid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="functioncmds.c.html#LN1452"><span class='Ref_To_Local'>procstruct</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_proc.h.html#LN82"><span class='Ref_to_Typedef'>Form_pg_proc</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1389"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN1385"><span class='Ref_To_Local'>nargs</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN1452"><span class='Ref_To_Local'>procstruct</span></a><span class='Operator'>-&GT;</span>pronargs<span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1385"><span class='Ref_To_Local'>nargs</span></a> <span class='Operator'>&LT; </span><span class='Number'>1</span> <span class='Operator'>|| </span><a href="functioncmds.c.html#LN1385"><span class='Ref_To_Local'>nargs</span></a> <span class='Operator'>&GT; </span><span class='Number'>3</span><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                  <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cast function must take one to three arguments"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/parser/parse_coerce.h.html#LN33"><span class='Ref_to_Proto'>IsBinaryCoercible</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1379"><span class='Ref_To_Local'>sourcetypeid</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1452"><span class='Ref_To_Local'>procstruct</span></a><span class='Operator'>-&GT;</span>proargtypes<span class='Operator'>.</span>values<span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"argument of cast function must match or be binary-coercible from source data type"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1385"><span class='Ref_To_Local'>nargs</span></a> <span class='Operator'>&GT; </span><span class='Number'>1</span> <span class='Operator'>&& </span><a href="functioncmds.c.html#LN1452"><span class='Ref_To_Local'>procstruct</span></a><span class='Operator'>-&GT;</span>proargtypes<span class='Operator'>.</span>values<span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>!= </span><a href="../../interfaces/ecpg/ecpglib/pg_type.h.html#LN24"><span class='Ref_to_Const'>INT4OID</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                   <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"second argument of cast function must be type %s"</span><span class='Delimiter'>, 
</span>                          <span class='String'>"integer"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1385"><span class='Ref_To_Local'>nargs</span></a> <span class='Operator'>&GT; </span><span class='Number'>2</span> <span class='Operator'>&& </span><a href="functioncmds.c.html#LN1452"><span class='Ref_To_Local'>procstruct</span></a><span class='Operator'>-&GT;</span>proargtypes<span class='Operator'>.</span>values<span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>!= </span><a href="../../interfaces/ecpg/ecpglib/pg_type.h.html#LN17"><span class='Ref_to_Const'>BOOLOID</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"third argument of cast function must be type %s"</span><span class='Delimiter'>, 
</span>                            <span class='String'>"boolean"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/parser/parse_coerce.h.html#LN33"><span class='Ref_to_Proto'>IsBinaryCoercible</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1452"><span class='Ref_To_Local'>procstruct</span></a><span class='Operator'>-&GT;</span>prorettype<span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1380"><span class='Ref_To_Local'>targettypeid</span></a><span class='Parentheses'>))</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"return data type of cast function must match or be binary-coercible to target data type"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Restricting the volatility of a cast function may or may not be a 
         * good idea in the abstract, but it definitely breaks many old 
         * user-defined types.  Disable this check --- tgl 2/1/03 
         */ 
</span><span class='Directive'>#ifdef</span> NOT_USED 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1452"><span class='Ref_To_Local'>procstruct</span></a><span class='Operator'>-&GT;</span>provolatile <span class='Operator'>== </span><a href="../../include/catalog/pg_proc.h.html#LN5484"><span class='Ref_to_Const'>PROVOLATILE_VOLATILE</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cast function must not be volatile"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1452"><span class='Ref_To_Local'>procstruct</span></a><span class='Operator'>-&GT;</span>proisagg<span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cast function must not be an aggregate function"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1452"><span class='Ref_To_Local'>procstruct</span></a><span class='Operator'>-&GT;</span>proiswindow<span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cast function must not be a window function"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1452"><span class='Ref_To_Local'>procstruct</span></a><span class='Operator'>-&GT;</span>proretset<span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cast function must not return a set"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1389"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if castmethod==COERCION_... &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="functioncmds.c.html#LN1383"><span class='Ref_To_Local'>funcid</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN1385"><span class='Ref_To_Local'>nargs</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1387"><span class='Ref_To_Local'>castmethod</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_cast.h.html#LN67"><span class='Ref_to_EnumConst'>COERCION_METHOD_BINARY</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1519"></a>        <a href="../../include/c.h.html#LN254"><span class='Ref_to_Typedef'>int16</span></a>       <span class='Declare_Local'>typ1len</span><span class='Delimiter'>; 
</span><a name="LN1520"></a>        <a href="../../include/c.h.html#LN254"><span class='Ref_to_Typedef'>int16</span></a>       <span class='Declare_Local'>typ2len</span><span class='Delimiter'>; 
</span><a name="LN1521"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>typ1byval</span><span class='Delimiter'>; 
</span><a name="LN1522"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>typ2byval</span><span class='Delimiter'>; 
</span><a name="LN1523"></a>        <span class='Keyword'>char</span>        <span class='Declare_Local'>typ1align</span><span class='Delimiter'>; 
</span><a name="LN1524"></a>        <span class='Keyword'>char</span>        <span class='Declare_Local'>typ2align</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Must be superuser to create binary-compatible casts, since 
         * erroneous casts can easily crash the backend. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../utils/misc/superuser.c.html#LN45"><span class='Ref_to_Func'>superuser</span></a><span class='Parentheses'>())</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INSUFFICIENT_PRIVILEGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"must be superuser to create a cast WITHOUT FUNCTION"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Also, insist that the types match as to size, alignment, and 
         * pass-by-value attributes; this provides at least a crude check that 
         * they have similar representations.  A pair of types that fail this 
         * test should certainly not be equated. 
         */ 
</span>        <a href="../../include/utils/lsyscache.h.html#LN136"><span class='Ref_to_Proto'>get_typlenbyvalalign</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1379"><span class='Ref_To_Local'>sourcetypeid</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1519"><span class='Ref_To_Local'>typ1len</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1521"><span class='Ref_To_Local'>typ1byval</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1523"><span class='Ref_To_Local'>typ1align</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../include/utils/lsyscache.h.html#LN136"><span class='Ref_to_Proto'>get_typlenbyvalalign</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1380"><span class='Ref_To_Local'>targettypeid</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1520"><span class='Ref_To_Local'>typ2len</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1522"><span class='Ref_To_Local'>typ2byval</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1524"><span class='Ref_To_Local'>typ2align</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1519"><span class='Ref_To_Local'>typ1len</span></a> <span class='Operator'>!= </span><a href="functioncmds.c.html#LN1520"><span class='Ref_To_Local'>typ2len</span></a> <span class='Operator'>|| 
</span>            <a href="functioncmds.c.html#LN1521"><span class='Ref_To_Local'>typ1byval</span></a> <span class='Operator'>!= </span><a href="functioncmds.c.html#LN1522"><span class='Ref_To_Local'>typ2byval</span></a> <span class='Operator'>|| 
</span>            <a href="functioncmds.c.html#LN1523"><span class='Ref_To_Local'>typ1align</span></a> <span class='Operator'>!= </span><a href="functioncmds.c.html#LN1524"><span class='Ref_To_Local'>typ2align</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"source and target data types are not physically compatible"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * We know that composite, enum and array types are never binary- 
         * compatible with each other.  They all have OIDs embedded in them. 
         * 
         * Theoretically you could build a user-defined base type that is 
         * binary-compatible with a composite, enum, or array type.  But we 
         * disallow that too, as in practice such a cast is surely a mistake. 
         * You can always work around that by writing a cast function. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1381"><span class='Ref_To_Local'>sourcetyptype</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_type.h.html#LN720"><span class='Ref_to_Const'>TYPTYPE_COMPOSITE</span></a> <span class='Operator'>|| 
</span>            <a href="functioncmds.c.html#LN1382"><span class='Ref_To_Local'>targettyptype</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_type.h.html#LN720"><span class='Ref_to_Const'>TYPTYPE_COMPOSITE</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                  <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"composite data types are not binary-compatible"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1381"><span class='Ref_To_Local'>sourcetyptype</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_type.h.html#LN722"><span class='Ref_to_Const'>TYPTYPE_ENUM</span></a> <span class='Operator'>|| 
</span>            <a href="functioncmds.c.html#LN1382"><span class='Ref_To_Local'>targettyptype</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_type.h.html#LN722"><span class='Ref_to_Const'>TYPTYPE_ENUM</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"enum data types are not binary-compatible"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="../../include/utils/lsyscache.h.html#LN157"><span class='Ref_to_Proto'>get_element_type</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1379"><span class='Ref_To_Local'>sourcetypeid</span></a><span class='Parentheses'>))</span> <span class='Operator'>|| 
</span>            <a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="../../include/utils/lsyscache.h.html#LN157"><span class='Ref_to_Proto'>get_element_type</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1380"><span class='Ref_To_Local'>targettypeid</span></a><span class='Parentheses'>)))</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"array data types are not binary-compatible"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * We also disallow creating binary-compatibility casts involving 
         * domains.  Casting from a domain to its base type is already 
         * allowed, and casting the other way ought to go through domain 
         * coercion to permit constraint checking.  Again, if you're intent on 
         * having your own semantics for that, create a no-op cast function. 
         * 
         * NOTE: if we were to relax this, the above checks for composites 
         * etc. would have to be modified to look through domains to their 
         * base types. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1381"><span class='Ref_To_Local'>sourcetyptype</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_type.h.html#LN721"><span class='Ref_to_Const'>TYPTYPE_DOMAIN</span></a> <span class='Operator'>|| 
</span>            <a href="functioncmds.c.html#LN1382"><span class='Ref_To_Local'>targettyptype</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_type.h.html#LN721"><span class='Ref_to_Const'>TYPTYPE_DOMAIN</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"domain data types must not be marked binary-compatible"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if castmethod==COERCION_... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* 
     * Allow source and target types to be same only for length coercion 
     * functions.  We assume a multi-arg function does length coercion. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1379"><span class='Ref_To_Local'>sourcetypeid</span></a> <span class='Operator'>== </span><a href="functioncmds.c.html#LN1380"><span class='Ref_To_Local'>targettypeid</span></a> <span class='Operator'>&& </span><a href="functioncmds.c.html#LN1385"><span class='Ref_To_Local'>nargs</span></a> <span class='Operator'>&LT; </span><span class='Number'>2</span><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>              <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"source data type and target data type are the same"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* convert CoercionContext enum to char value for castcontext */ 
</span>    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1377"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3232"><span class='Ref_to_Member'>context</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/primnodes.h.html#LN420"><span class='Ref_to_EnumConst'>COERCION_IMPLICIT</span></a><span class='Operator'>: 
</span>            <a href="functioncmds.c.html#LN1386"><span class='Ref_To_Local'>castcontext</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_cast.h.html#LN54"><span class='Ref_to_EnumConst'>COERCION_CODE_IMPLICIT</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/primnodes.h.html#LN421"><span class='Ref_to_EnumConst'>COERCION_ASSIGNMENT</span></a><span class='Operator'>: 
</span>            <a href="functioncmds.c.html#LN1386"><span class='Ref_To_Local'>castcontext</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_cast.h.html#LN55"><span class='Ref_to_EnumConst'>COERCION_CODE_ASSIGNMENT</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/primnodes.h.html#LN422"><span class='Ref_to_EnumConst'>COERCION_EXPLICIT</span></a><span class='Operator'>: 
</span>            <a href="functioncmds.c.html#LN1386"><span class='Ref_To_Local'>castcontext</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_cast.h.html#LN56"><span class='Ref_to_EnumConst'>COERCION_CODE_EXPLICIT</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized CoercionContext: %d"</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1377"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3232"><span class='Ref_to_Member'>context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="functioncmds.c.html#LN1386"><span class='Ref_To_Local'>castcontext</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="functioncmds.c.html#LN1388"><span class='Ref_To_Local'>relation</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN91"><span class='Ref_to_Proto'>heap_open</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_cast.h.html#LN30"><span class='Ref_to_Const'>CastRelationId</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Check for duplicate.  This is just to give a friendly error message, 
     * the unique index would catch it anyway (so no need to sweat about race 
     * conditions). 
     */ 
</span>    <a href="functioncmds.c.html#LN1389"><span class='Ref_To_Local'>tuple</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN157"><span class='Ref_to_Macro'>SearchSysCache2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN45"><span class='Ref_to_EnumConst'>CASTSOURCETARGET</span></a><span class='Delimiter'>, 
</span>                            <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1379"><span class='Ref_To_Local'>sourcetypeid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                            <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1380"><span class='Ref_To_Local'>targettypeid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1389"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>))</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span><a href="../../bin/pg_basebackup/streamutil.c.html#LN30"><span class='Ref_to_Const'>ERRCODE_DUPLICATE_OBJECT</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cast from type %s to type %s already exists"</span><span class='Delimiter'>, 
</span>                        <a href="../utils/adt/format_type.c.html#LN92"><span class='Ref_to_Func'>format_type_be</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1379"><span class='Ref_To_Local'>sourcetypeid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                        <a href="../utils/adt/format_type.c.html#LN92"><span class='Ref_to_Func'>format_type_be</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1380"><span class='Ref_To_Local'>targettypeid</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* ready to go */ 
</span>    <a href="functioncmds.c.html#LN1390"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_cast.h.html#LN77"><span class='Ref_to_Const'>Anum_pg_cast_castsource</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1379"><span class='Ref_To_Local'>sourcetypeid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1390"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_cast.h.html#LN78"><span class='Ref_to_Const'>Anum_pg_cast_casttarget</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1380"><span class='Ref_To_Local'>targettypeid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1390"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_cast.h.html#LN79"><span class='Ref_to_Const'>Anum_pg_cast_castfunc</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1383"><span class='Ref_To_Local'>funcid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1390"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_cast.h.html#LN80"><span class='Ref_to_Const'>Anum_pg_cast_castcontext</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN421"><span class='Ref_to_Macro'>CharGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1386"><span class='Ref_To_Local'>castcontext</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1390"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_cast.h.html#LN81"><span class='Ref_to_Const'>Anum_pg_cast_castmethod</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN421"><span class='Ref_to_Macro'>CharGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1387"><span class='Ref_To_Local'>castmethod</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/c.h.html#LN856"><span class='Ref_to_Macro'>MemSet</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1391"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1391"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN1389"><span class='Ref_To_Local'>tuple</span></a> <span class='Operator'>= </span><a href="../access/common/heaptuple.c.html#LN690"><span class='Ref_to_Func'>heap_form_tuple</span></a><span class='Parentheses'>(</span><a href="../../include/utils/rel.h.html#LN428"><span class='Ref_to_Macro'>RelationGetDescr</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1388"><span class='Ref_To_Local'>relation</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1390"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1391"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN1384"><span class='Ref_To_Local'>castid</span></a> <span class='Operator'>= </span><a href="../../include/catalog/indexing.h.html#LN32"><span class='Ref_to_Proto'>CatalogTupleInsert</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1388"><span class='Ref_To_Local'>relation</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1389"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* make dependency entries */ 
</span>    <a href="functioncmds.c.html#LN1392"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_cast.h.html#LN30"><span class='Ref_to_Const'>CastRelationId</span></a><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1392"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN1384"><span class='Ref_To_Local'>castid</span></a><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1392"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on source type */ 
</span>    <a href="functioncmds.c.html#LN1393"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_type.h.html#LN33"><span class='Ref_to_Const'>TypeRelationId</span></a><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1393"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN1379"><span class='Ref_To_Local'>sourcetypeid</span></a><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1393"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../catalog/pg_depend.c.html#LN42"><span class='Ref_to_Func'>recordDependencyOn</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1392"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1393"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on target type */ 
</span>    <a href="functioncmds.c.html#LN1393"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_type.h.html#LN33"><span class='Ref_to_Const'>TypeRelationId</span></a><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1393"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN1380"><span class='Ref_To_Local'>targettypeid</span></a><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1393"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../catalog/pg_depend.c.html#LN42"><span class='Ref_to_Func'>recordDependencyOn</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1392"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1393"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on function */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1383"><span class='Ref_To_Local'>funcid</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="functioncmds.c.html#LN1393"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_proc.h.html#LN32"><span class='Ref_to_Const'>ProcedureRelationId</span></a><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN1393"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN1383"><span class='Ref_To_Local'>funcid</span></a><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN1393"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="../catalog/pg_depend.c.html#LN42"><span class='Ref_to_Func'>recordDependencyOn</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1392"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1393"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on extension */ 
</span>    <a href="../catalog/pg_depend.c.html#LN137"><span class='Ref_to_Func'>recordDependencyOnCurrentExtension</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1392"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Post creation hook for new cast */ 
</span>    <a href="../../include/catalog/objectaccess.h.html#LN144"><span class='Ref_to_Macro'>InvokeObjectPostCreateHook</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_cast.h.html#LN30"><span class='Ref_to_Const'>CastRelationId</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1384"><span class='Ref_To_Local'>castid</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/htup_details.h.html#LN815"><span class='Ref_to_Proto'>heap_freetuple</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1389"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1388"><span class='Ref_To_Local'>relation</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="functioncmds.c.html#LN1392"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end CreateCast &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * get_cast_oid - given two type OIDs, look up a cast OID 
 * 
 * If missing_ok is false, throw an error if the cast is not found.  If 
 * true, just return InvalidOid. 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN1698"></a><span class='Declare_Function'>get_cast_oid</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>sourcetypeid</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>targettypeid</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>missing_ok</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1700"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>oid</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN1700"><span class='Ref_To_Local'>oid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN184"><span class='Ref_to_Macro'>GetSysCacheOid2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN45"><span class='Ref_to_EnumConst'>CASTSOURCETARGET</span></a><span class='Delimiter'>, 
</span>                          <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1698"><span class='Ref_to_Parameter'>sourcetypeid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                          <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1698"><span class='Ref_to_Parameter'>targettypeid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1700"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>) </span><span class='Operator'>&& !</span><a href="functioncmds.c.html#LN1698"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>)</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_OBJECT<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cast from type %s to type %s does not exist"</span><span class='Delimiter'>, 
</span>                        <a href="../utils/adt/format_type.c.html#LN92"><span class='Ref_to_Func'>format_type_be</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1698"><span class='Ref_to_Parameter'>sourcetypeid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                        <a href="../utils/adt/format_type.c.html#LN92"><span class='Ref_to_Func'>format_type_be</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1698"><span class='Ref_to_Parameter'>targettypeid</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="functioncmds.c.html#LN1700"><span class='Ref_To_Local'>oid</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>void 
</span><a name="LN1715"></a><span class='Declare_Function'>DropCastById</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>castOid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1717"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>relation</span><span class='Delimiter'>; 
</span><a name="LN1718"></a>    <a href="../../include/access/skey.h.html#LN63"><span class='Ref_to_Struct'>ScanKeyData</span></a> <span class='Declare_Local'>scankey</span><span class='Delimiter'>; 
</span><a name="LN1719"></a>    <a href="../../include/access/genam.h.html#LN86"><span class='Ref_to_Typedef'>SysScanDesc</span></a> <span class='Declare_Local'>scan</span><span class='Delimiter'>; 
</span><a name="LN1720"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tuple</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN1717"><span class='Ref_To_Local'>relation</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN91"><span class='Ref_to_Proto'>heap_open</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_cast.h.html#LN30"><span class='Ref_to_Const'>CastRelationId</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../access/common/scankey.c.html#LN74"><span class='Ref_to_Func'>ScanKeyInit</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1718"><span class='Ref_To_Local'>scankey</span></a><span class='Delimiter'>, 
</span>                <a href="../../include/access/sysattr.h.html#LN21"><span class='Ref_to_Const'>ObjectIdAttributeNumber</span></a><span class='Delimiter'>, 
</span>                <a href="../../include/access/stratnum.h.html#LN30"><span class='Ref_to_Const'>BTEqualStrategyNumber</span></a><span class='Delimiter'>, </span>F_OIDEQ<span class='Delimiter'>, 
</span>                <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1715"><span class='Ref_to_Parameter'>castOid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1719"><span class='Ref_To_Local'>scan</span></a> <span class='Operator'>= </span><a href="../../include/access/genam.h.html#LN189"><span class='Ref_to_Proto'>systable_beginscan</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1717"><span class='Ref_To_Local'>relation</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/indexing.h.html#LN106"><span class='Ref_to_Const'>CastOidIndexId</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, 
</span>                              <span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1718"><span class='Ref_To_Local'>scankey</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN1720"><span class='Ref_To_Local'>tuple</span></a> <span class='Operator'>= </span><a href="../../include/access/genam.h.html#LN194"><span class='Ref_to_Proto'>systable_getnext</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1719"><span class='Ref_To_Local'>scan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1720"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"could not find tuple for cast %u"</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1715"><span class='Ref_to_Parameter'>castOid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/catalog/indexing.h.html#LN40"><span class='Ref_to_Proto'>CatalogTupleDelete</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1717"><span class='Ref_To_Local'>relation</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1720"><span class='Ref_To_Local'>tuple</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/htup.h.html#LN64"><span class='Ref_to_Member'>t_self</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/genam.h.html#LN196"><span class='Ref_to_Proto'>systable_endscan</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1719"><span class='Ref_To_Local'>scan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1717"><span class='Ref_To_Local'>relation</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end DropCastById &raquo; </span> 
 
 
<span class='Keyword'>static void 
</span><a name="LN1742"></a><span class='Declare_Function'>check_transform_function</span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_proc.h.html#LN82"><span class='Ref_to_Typedef'>Form_pg_proc</span></a> <span class='Declare_Parameter'>procstruct</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1742"><span class='Ref_to_Parameter'>procstruct</span></a><span class='Operator'>-&GT;</span>provolatile <span class='Operator'>== </span><a href="../../include/catalog/pg_proc.h.html#LN5484"><span class='Ref_to_Const'>PROVOLATILE_VOLATILE</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"transform function must not be volatile"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1742"><span class='Ref_to_Parameter'>procstruct</span></a><span class='Operator'>-&GT;</span>proisagg<span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>            <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"transform function must not be an aggregate function"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1742"><span class='Ref_to_Parameter'>procstruct</span></a><span class='Operator'>-&GT;</span>proiswindow<span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"transform function must not be a window function"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1742"><span class='Ref_to_Parameter'>procstruct</span></a><span class='Operator'>-&GT;</span>proretset<span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"transform function must not return a set"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1742"><span class='Ref_to_Parameter'>procstruct</span></a><span class='Operator'>-&GT;</span>pronargs <span class='Operator'>!= </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"transform function must take one argument"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1742"><span class='Ref_to_Parameter'>procstruct</span></a><span class='Operator'>-&GT;</span>proargtypes<span class='Operator'>.</span>values<span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>!= </span><a href="../../include/catalog/pg_type.h.html#LN697"><span class='Ref_to_Const'>INTERNALOID</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>               <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"first argument of transform function must be type %s"</span><span class='Delimiter'>, 
</span>                      <span class='String'>"internal"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end check_transform_function &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * CREATE TRANSFORM 
 */ 
</span><a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> 
<a name="LN1776"></a><span class='Declare_Function'>CreateTransform</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN3240"><span class='Ref_to_Struct'>CreateTransformStmt</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>stmt</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1778"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>typeid</span><span class='Delimiter'>; 
</span><a name="LN1779"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>typtype</span><span class='Delimiter'>; 
</span><a name="LN1780"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>langid</span><span class='Delimiter'>; 
</span><a name="LN1781"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>fromsqlfuncid</span><span class='Delimiter'>; 
</span><a name="LN1782"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>tosqlfuncid</span><span class='Delimiter'>; 
</span><a name="LN1783"></a>    <a href="../../include/utils/acl.h.html#LN169"><span class='Ref_to_Typedef'>AclResult</span></a>   <span class='Declare_Local'>aclresult</span><span class='Delimiter'>; 
</span><a name="LN1784"></a>    <a href="../../include/catalog/pg_proc.h.html#LN82"><span class='Ref_to_Typedef'>Form_pg_proc</span></a> <span class='Declare_Local'>procstruct</span><span class='Delimiter'>; 
</span><a name="LN1785"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>values</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_transform.h.html#LN40"><span class='Ref_to_Const'>Natts_pg_transform</span></a><span class='Delimiter'>]; 
</span><a name="LN1786"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>nulls</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_transform.h.html#LN40"><span class='Ref_to_Const'>Natts_pg_transform</span></a><span class='Delimiter'>]; 
</span><a name="LN1787"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>replaces</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_transform.h.html#LN40"><span class='Ref_to_Const'>Natts_pg_transform</span></a><span class='Delimiter'>]; 
</span><a name="LN1788"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>transformid</span><span class='Delimiter'>; 
</span><a name="LN1789"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tuple</span><span class='Delimiter'>; 
</span><a name="LN1790"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>newtuple</span><span class='Delimiter'>; 
</span><a name="LN1791"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>relation</span><span class='Delimiter'>; 
</span><a name="LN1792"></a>    <a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> <span class='Declare_Local'>myself</span><span class='Delimiter'>, 
</span><a name="LN1793"></a>                <span class='Declare_Local'>referenced</span><span class='Delimiter'>; 
</span><a name="LN1794"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>is_replace</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Get the type 
     */ 
</span>    <span class='Keyword'>typeid </span><span class='Operator'>= </span><a href="../../include/parser/parse_type.h.html#LN27"><span class='Ref_to_Proto'>typenameTypeId</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1776"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3244"><span class='Ref_to_Member'>type_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1779"><span class='Ref_To_Local'>typtype</span></a> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN149"><span class='Ref_to_Proto'>get_typtype</span></a><span class='Parentheses'>(</span><span class='Keyword'>typeid</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1779"><span class='Ref_To_Local'>typtype</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_type.h.html#LN723"><span class='Ref_to_Const'>TYPTYPE_PSEUDO</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_WRONG_OBJECT_TYPE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"data type %s is a pseudo-type"</span><span class='Delimiter'>, 
</span>                        <a href="../../include/parser/parse_type.h.html#LN31"><span class='Ref_to_Proto'>TypeNameToString</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1776"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3244"><span class='Ref_to_Member'>type_name</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1779"><span class='Ref_To_Local'>typtype</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_type.h.html#LN721"><span class='Ref_to_Const'>TYPTYPE_DOMAIN</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_WRONG_OBJECT_TYPE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"data type %s is a domain"</span><span class='Delimiter'>, 
</span>                        <a href="../../include/parser/parse_type.h.html#LN31"><span class='Ref_to_Proto'>TypeNameToString</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1776"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3244"><span class='Ref_to_Member'>type_name</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/acl.h.html#LN309"><span class='Ref_to_Proto'>pg_type_ownercheck</span></a><span class='Parentheses'>(</span><span class='Keyword'>typeid</span><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()))</span> 
        <a href="../../include/utils/acl.h.html#LN301"><span class='Ref_to_Proto'>aclcheck_error_type</span></a><span class='Parentheses'>(</span><a href="../../include/utils/acl.h.html#LN173"><span class='Ref_to_EnumConst'>ACLCHECK_NOT_OWNER</span></a><span class='Delimiter'>, </span><span class='Keyword'>typeid</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN1783"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>= </span><a href="../../include/utils/acl.h.html#LN293"><span class='Ref_to_Proto'>pg_type_aclcheck</span></a><span class='Parentheses'>(</span><span class='Keyword'>typeid</span><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN79"><span class='Ref_to_Const'>ACL_USAGE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1783"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>!= </span><a href="../../include/utils/acl.h.html#LN171"><span class='Ref_to_EnumConst'>ACLCHECK_OK</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/acl.h.html#LN301"><span class='Ref_to_Proto'>aclcheck_error_type</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1783"><span class='Ref_To_Local'>aclresult</span></a><span class='Delimiter'>, </span><span class='Keyword'>typeid</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Get the language 
     */ 
</span>    <a href="functioncmds.c.html#LN1780"><span class='Ref_To_Local'>langid</span></a> <span class='Operator'>= </span><a href="../../include/commands/proclang.h.html#LN20"><span class='Ref_to_Proto'>get_language_oid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1776"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3245"><span class='Ref_to_Member'>lang</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN1783"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>= </span><a href="../../include/utils/acl.h.html#LN286"><span class='Ref_to_Proto'>pg_language_aclcheck</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1780"><span class='Ref_To_Local'>langid</span></a><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN79"><span class='Ref_to_Const'>ACL_USAGE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1783"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>!= </span><a href="../../include/utils/acl.h.html#LN171"><span class='Ref_to_EnumConst'>ACLCHECK_OK</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/acl.h.html#LN295"><span class='Ref_to_Proto'>aclcheck_error</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1783"><span class='Ref_To_Local'>aclresult</span></a><span class='Delimiter'>, </span><a href="../../include/utils/acl.h.html#LN187"><span class='Ref_to_EnumConst'>ACL_KIND_LANGUAGE</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1776"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3245"><span class='Ref_to_Member'>lang</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Get the functions 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1776"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3246"><span class='Ref_to_Member'>fromsql</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="functioncmds.c.html#LN1781"><span class='Ref_To_Local'>fromsqlfuncid</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_func.h.html#LN64"><span class='Ref_to_Proto'>LookupFuncWithArgs</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1776"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3246"><span class='Ref_to_Member'>fromsql</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/acl.h.html#LN311"><span class='Ref_to_Proto'>pg_proc_ownercheck</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1781"><span class='Ref_To_Local'>fromsqlfuncid</span></a><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()))</span> 
            <a href="../../include/utils/acl.h.html#LN295"><span class='Ref_to_Proto'>aclcheck_error</span></a><span class='Parentheses'>(</span><a href="../../include/utils/acl.h.html#LN173"><span class='Ref_to_EnumConst'>ACLCHECK_NOT_OWNER</span></a><span class='Delimiter'>, </span><a href="../../include/utils/acl.h.html#LN184"><span class='Ref_to_EnumConst'>ACL_KIND_PROC</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/namespace.h.html#LN120"><span class='Ref_to_Proto'>NameListToString</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1776"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3246"><span class='Ref_to_Member'>fromsql</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1851"><span class='Ref_to_Member'>objname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <a href="functioncmds.c.html#LN1783"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>= </span><a href="../../include/utils/acl.h.html#LN285"><span class='Ref_to_Proto'>pg_proc_aclcheck</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1781"><span class='Ref_To_Local'>fromsqlfuncid</span></a><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN78"><span class='Ref_to_Const'>ACL_EXECUTE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1783"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>!= </span><a href="../../include/utils/acl.h.html#LN171"><span class='Ref_to_EnumConst'>ACLCHECK_OK</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/acl.h.html#LN295"><span class='Ref_to_Proto'>aclcheck_error</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1783"><span class='Ref_To_Local'>aclresult</span></a><span class='Delimiter'>, </span><a href="../../include/utils/acl.h.html#LN184"><span class='Ref_to_EnumConst'>ACL_KIND_PROC</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/namespace.h.html#LN120"><span class='Ref_to_Proto'>NameListToString</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1776"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3246"><span class='Ref_to_Member'>fromsql</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1851"><span class='Ref_to_Member'>objname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <a href="functioncmds.c.html#LN1789"><span class='Ref_To_Local'>tuple</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN76"><span class='Ref_to_EnumConst'>PROCOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1781"><span class='Ref_To_Local'>fromsqlfuncid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1789"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>))</span> 
            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for function %u"</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1781"><span class='Ref_To_Local'>fromsqlfuncid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN1784"><span class='Ref_To_Local'>procstruct</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_proc.h.html#LN82"><span class='Ref_to_Typedef'>Form_pg_proc</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1789"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1784"><span class='Ref_To_Local'>procstruct</span></a><span class='Operator'>-&GT;</span>prorettype <span class='Operator'>!= </span><a href="../../include/catalog/pg_type.h.html#LN697"><span class='Ref_to_Const'>INTERNALOID</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                   <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"return data type of FROM SQL function must be %s"</span><span class='Delimiter'>, 
</span>                          <span class='String'>"internal"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN1741"><span class='Ref_to_Func'>check_transform_function</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1784"><span class='Ref_To_Local'>procstruct</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1789"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if stmt-&GT;fromsql &raquo; </span> 
    <span class='Control'>else</span> 
        <a href="functioncmds.c.html#LN1781"><span class='Ref_To_Local'>fromsqlfuncid</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1776"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3247"><span class='Ref_to_Member'>tosql</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="functioncmds.c.html#LN1782"><span class='Ref_To_Local'>tosqlfuncid</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_func.h.html#LN64"><span class='Ref_to_Proto'>LookupFuncWithArgs</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1776"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3247"><span class='Ref_to_Member'>tosql</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/acl.h.html#LN311"><span class='Ref_to_Proto'>pg_proc_ownercheck</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1782"><span class='Ref_To_Local'>tosqlfuncid</span></a><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()))</span> 
            <a href="../../include/utils/acl.h.html#LN295"><span class='Ref_to_Proto'>aclcheck_error</span></a><span class='Parentheses'>(</span><a href="../../include/utils/acl.h.html#LN173"><span class='Ref_to_EnumConst'>ACLCHECK_NOT_OWNER</span></a><span class='Delimiter'>, </span><a href="../../include/utils/acl.h.html#LN184"><span class='Ref_to_EnumConst'>ACL_KIND_PROC</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/namespace.h.html#LN120"><span class='Ref_to_Proto'>NameListToString</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1776"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3247"><span class='Ref_to_Member'>tosql</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1851"><span class='Ref_to_Member'>objname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <a href="functioncmds.c.html#LN1783"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>= </span><a href="../../include/utils/acl.h.html#LN285"><span class='Ref_to_Proto'>pg_proc_aclcheck</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1782"><span class='Ref_To_Local'>tosqlfuncid</span></a><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN78"><span class='Ref_to_Const'>ACL_EXECUTE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1783"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>!= </span><a href="../../include/utils/acl.h.html#LN171"><span class='Ref_to_EnumConst'>ACLCHECK_OK</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/acl.h.html#LN295"><span class='Ref_to_Proto'>aclcheck_error</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1783"><span class='Ref_To_Local'>aclresult</span></a><span class='Delimiter'>, </span><a href="../../include/utils/acl.h.html#LN184"><span class='Ref_to_EnumConst'>ACL_KIND_PROC</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/namespace.h.html#LN120"><span class='Ref_to_Proto'>NameListToString</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1776"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3247"><span class='Ref_to_Member'>tosql</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1851"><span class='Ref_to_Member'>objname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <a href="functioncmds.c.html#LN1789"><span class='Ref_To_Local'>tuple</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN76"><span class='Ref_to_EnumConst'>PROCOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1782"><span class='Ref_To_Local'>tosqlfuncid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1789"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>))</span> 
            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for function %u"</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1782"><span class='Ref_To_Local'>tosqlfuncid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN1784"><span class='Ref_To_Local'>procstruct</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_proc.h.html#LN82"><span class='Ref_to_Typedef'>Form_pg_proc</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1789"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1784"><span class='Ref_To_Local'>procstruct</span></a><span class='Operator'>-&GT;</span>prorettype <span class='Operator'>!= </span><span class='Keyword'>typeid</span><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"return data type of TO SQL function must be the transform data type"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN1741"><span class='Ref_to_Func'>check_transform_function</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1784"><span class='Ref_To_Local'>procstruct</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1789"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if stmt-&GT;tosql &raquo; </span> 
    <span class='Control'>else</span> 
        <a href="functioncmds.c.html#LN1782"><span class='Ref_To_Local'>tosqlfuncid</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Ready to go 
     */ 
</span>    <a href="functioncmds.c.html#LN1785"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_transform.h.html#LN41"><span class='Ref_to_Const'>Anum_pg_transform_trftype</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><span class='Keyword'>typeid</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1785"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_transform.h.html#LN42"><span class='Ref_to_Const'>Anum_pg_transform_trflang</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1780"><span class='Ref_To_Local'>langid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1785"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_transform.h.html#LN43"><span class='Ref_to_Const'>Anum_pg_transform_trffromsql</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1781"><span class='Ref_To_Local'>fromsqlfuncid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1785"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_transform.h.html#LN44"><span class='Ref_to_Const'>Anum_pg_transform_trftosql</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1782"><span class='Ref_To_Local'>tosqlfuncid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/c.h.html#LN856"><span class='Ref_to_Macro'>MemSet</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1786"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1786"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN1791"><span class='Ref_To_Local'>relation</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN91"><span class='Ref_to_Proto'>heap_open</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_transform.h.html#LN24"><span class='Ref_to_Const'>TransformRelationId</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN1789"><span class='Ref_To_Local'>tuple</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN157"><span class='Ref_to_Macro'>SearchSysCache2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN96"><span class='Ref_to_EnumConst'>TRFTYPELANG</span></a><span class='Delimiter'>, 
</span>                            <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><span class='Keyword'>typeid</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                            <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1780"><span class='Ref_To_Local'>langid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1789"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="functioncmds.c.html#LN1776"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3243"><span class='Ref_to_Member'>replace</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span><a href="../../bin/pg_basebackup/streamutil.c.html#LN30"><span class='Ref_to_Const'>ERRCODE_DUPLICATE_OBJECT</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>               <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"transform for type %s language \"%s\" already exists"</span><span class='Delimiter'>, 
</span>                      <a href="../utils/adt/format_type.c.html#LN92"><span class='Ref_to_Func'>format_type_be</span></a><span class='Parentheses'>(</span><span class='Keyword'>typeid</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                      <a href="functioncmds.c.html#LN1776"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3245"><span class='Ref_to_Member'>lang</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/c.h.html#LN856"><span class='Ref_to_Macro'>MemSet</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1787"><span class='Ref_To_Local'>replaces</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1787"><span class='Ref_To_Local'>replaces</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN1787"><span class='Ref_To_Local'>replaces</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_transform.h.html#LN43"><span class='Ref_to_Const'>Anum_pg_transform_trffromsql</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN1787"><span class='Ref_To_Local'>replaces</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_transform.h.html#LN44"><span class='Ref_to_Const'>Anum_pg_transform_trftosql</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
        <a href="functioncmds.c.html#LN1790"><span class='Ref_To_Local'>newtuple</span></a> <span class='Operator'>= </span><a href="../access/common/heaptuple.c.html#LN789"><span class='Ref_to_Func'>heap_modify_tuple</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1789"><span class='Ref_To_Local'>tuple</span></a><span class='Delimiter'>, </span><a href="../../include/utils/rel.h.html#LN428"><span class='Ref_to_Macro'>RelationGetDescr</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1791"><span class='Ref_To_Local'>relation</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1785"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1786"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1787"><span class='Ref_To_Local'>replaces</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../include/catalog/indexing.h.html#LN35"><span class='Ref_to_Proto'>CatalogTupleUpdate</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1791"><span class='Ref_To_Local'>relation</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1790"><span class='Ref_To_Local'>newtuple</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/htup.h.html#LN64"><span class='Ref_to_Member'>t_self</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1790"><span class='Ref_To_Local'>newtuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="functioncmds.c.html#LN1788"><span class='Ref_To_Local'>transformid</span></a> <span class='Operator'>= </span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1789"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1789"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN1794"><span class='Ref_To_Local'>is_replace</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if HeapTupleIsValid(tupl... &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="functioncmds.c.html#LN1790"><span class='Ref_To_Local'>newtuple</span></a> <span class='Operator'>= </span><a href="../access/common/heaptuple.c.html#LN690"><span class='Ref_to_Func'>heap_form_tuple</span></a><span class='Parentheses'>(</span><a href="../../include/utils/rel.h.html#LN428"><span class='Ref_to_Macro'>RelationGetDescr</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1791"><span class='Ref_To_Local'>relation</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1785"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1786"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN1788"><span class='Ref_To_Local'>transformid</span></a> <span class='Operator'>= </span><a href="../../include/catalog/indexing.h.html#LN32"><span class='Ref_to_Proto'>CatalogTupleInsert</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1791"><span class='Ref_To_Local'>relation</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1790"><span class='Ref_To_Local'>newtuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN1794"><span class='Ref_To_Local'>is_replace</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1794"><span class='Ref_To_Local'>is_replace</span></a><span class='Parentheses'>) 
</span>        <a href="../catalog/pg_depend.c.html#LN189"><span class='Ref_to_Func'>deleteDependencyRecordsFor</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_transform.h.html#LN24"><span class='Ref_to_Const'>TransformRelationId</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1788"><span class='Ref_To_Local'>transformid</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* make dependency entries */ 
</span>    <a href="functioncmds.c.html#LN1792"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_transform.h.html#LN24"><span class='Ref_to_Const'>TransformRelationId</span></a><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1792"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN1788"><span class='Ref_To_Local'>transformid</span></a><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1792"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on language */ 
</span>    <a href="functioncmds.c.html#LN1793"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_language.h.html#LN28"><span class='Ref_to_Const'>LanguageRelationId</span></a><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1793"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN1780"><span class='Ref_To_Local'>langid</span></a><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1793"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../catalog/pg_depend.c.html#LN42"><span class='Ref_to_Func'>recordDependencyOn</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1792"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1793"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on type */ 
</span>    <a href="functioncmds.c.html#LN1793"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_type.h.html#LN33"><span class='Ref_to_Const'>TypeRelationId</span></a><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1793"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><span class='Keyword'>typeid</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN1793"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../catalog/pg_depend.c.html#LN42"><span class='Ref_to_Func'>recordDependencyOn</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1792"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1793"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependencies on functions */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1781"><span class='Ref_To_Local'>fromsqlfuncid</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="functioncmds.c.html#LN1793"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_proc.h.html#LN32"><span class='Ref_to_Const'>ProcedureRelationId</span></a><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN1793"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN1781"><span class='Ref_To_Local'>fromsqlfuncid</span></a><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN1793"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="../catalog/pg_depend.c.html#LN42"><span class='Ref_to_Func'>recordDependencyOn</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1792"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1793"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1782"><span class='Ref_To_Local'>tosqlfuncid</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="functioncmds.c.html#LN1793"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_proc.h.html#LN32"><span class='Ref_to_Const'>ProcedureRelationId</span></a><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN1793"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN1782"><span class='Ref_To_Local'>tosqlfuncid</span></a><span class='Delimiter'>; 
</span>        <a href="functioncmds.c.html#LN1793"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="../catalog/pg_depend.c.html#LN42"><span class='Ref_to_Func'>recordDependencyOn</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1792"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1793"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on extension */ 
</span>    <a href="../catalog/pg_depend.c.html#LN137"><span class='Ref_to_Func'>recordDependencyOnCurrentExtension</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="functioncmds.c.html#LN1792"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1794"><span class='Ref_To_Local'>is_replace</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Post creation hook for new transform */ 
</span>    <a href="../../include/catalog/objectaccess.h.html#LN144"><span class='Ref_to_Macro'>InvokeObjectPostCreateHook</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_transform.h.html#LN24"><span class='Ref_to_Const'>TransformRelationId</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN1788"><span class='Ref_To_Local'>transformid</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/htup_details.h.html#LN815"><span class='Ref_to_Proto'>heap_freetuple</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1790"><span class='Ref_To_Local'>newtuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1791"><span class='Ref_To_Local'>relation</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="functioncmds.c.html#LN1792"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end CreateTransform &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * get_transform_oid - given type OID and language OID, look up a transform OID 
 * 
 * If missing_ok is false, throw an error if the transform is not found.  If 
 * true, just return InvalidOid. 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN1983"></a><span class='Declare_Function'>get_transform_oid</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>type_id</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>lang_id</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>missing_ok</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1985"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>oid</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN1985"><span class='Ref_To_Local'>oid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN184"><span class='Ref_to_Macro'>GetSysCacheOid2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN96"><span class='Ref_to_EnumConst'>TRFTYPELANG</span></a><span class='Delimiter'>, 
</span>                          <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1983"><span class='Ref_to_Parameter'>type_id</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                          <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1983"><span class='Ref_to_Parameter'>lang_id</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1985"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>) </span><span class='Operator'>&& !</span><a href="functioncmds.c.html#LN1983"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>)</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_OBJECT<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>               <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"transform for type %s language \"%s\" does not exist"</span><span class='Delimiter'>, 
</span>                      <a href="../utils/adt/format_type.c.html#LN92"><span class='Ref_to_Func'>format_type_be</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1983"><span class='Ref_to_Parameter'>type_id</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                      <a href="../../include/utils/lsyscache.h.html#LN95"><span class='Ref_to_Proto'>get_language_name</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN1983"><span class='Ref_to_Parameter'>lang_id</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="functioncmds.c.html#LN1985"><span class='Ref_To_Local'>oid</span></a><span class='Delimiter'>; 
} 
</span> 
 
<span class='Keyword'>void 
</span><a name="LN2001"></a><span class='Declare_Function'>DropTransformById</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>transformOid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2003"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>relation</span><span class='Delimiter'>; 
</span><a name="LN2004"></a>    <a href="../../include/access/skey.h.html#LN63"><span class='Ref_to_Struct'>ScanKeyData</span></a> <span class='Declare_Local'>scankey</span><span class='Delimiter'>; 
</span><a name="LN2005"></a>    <a href="../../include/access/genam.h.html#LN86"><span class='Ref_to_Typedef'>SysScanDesc</span></a> <span class='Declare_Local'>scan</span><span class='Delimiter'>; 
</span><a name="LN2006"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tuple</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN2003"><span class='Ref_To_Local'>relation</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN91"><span class='Ref_to_Proto'>heap_open</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_transform.h.html#LN24"><span class='Ref_to_Const'>TransformRelationId</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../access/common/scankey.c.html#LN74"><span class='Ref_to_Func'>ScanKeyInit</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="functioncmds.c.html#LN2004"><span class='Ref_To_Local'>scankey</span></a><span class='Delimiter'>, 
</span>                <a href="../../include/access/sysattr.h.html#LN21"><span class='Ref_to_Const'>ObjectIdAttributeNumber</span></a><span class='Delimiter'>, 
</span>                <a href="../../include/access/stratnum.h.html#LN30"><span class='Ref_to_Const'>BTEqualStrategyNumber</span></a><span class='Delimiter'>, </span>F_OIDEQ<span class='Delimiter'>, 
</span>                <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2001"><span class='Ref_to_Parameter'>transformOid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN2005"><span class='Ref_To_Local'>scan</span></a> <span class='Operator'>= </span><a href="../../include/access/genam.h.html#LN189"><span class='Ref_to_Proto'>systable_beginscan</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2003"><span class='Ref_To_Local'>relation</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/indexing.h.html#LN241"><span class='Ref_to_Const'>TransformOidIndexId</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, 
</span>                              <span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN2004"><span class='Ref_To_Local'>scankey</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN2006"><span class='Ref_To_Local'>tuple</span></a> <span class='Operator'>= </span><a href="../../include/access/genam.h.html#LN194"><span class='Ref_to_Proto'>systable_getnext</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2005"><span class='Ref_To_Local'>scan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2006"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"could not find tuple for transform %u"</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN2001"><span class='Ref_to_Parameter'>transformOid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/catalog/indexing.h.html#LN40"><span class='Ref_to_Proto'>CatalogTupleDelete</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2003"><span class='Ref_To_Local'>relation</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="functioncmds.c.html#LN2006"><span class='Ref_To_Local'>tuple</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/htup.h.html#LN64"><span class='Ref_to_Member'>t_self</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/genam.h.html#LN196"><span class='Ref_to_Proto'>systable_endscan</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2005"><span class='Ref_To_Local'>scan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2003"><span class='Ref_To_Local'>relation</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end DropTransformById &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * Subroutine for ALTER FUNCTION/AGGREGATE SET SCHEMA/RENAME 
 * 
 * Is there a function with the given name and signature already in the given 
 * namespace?  If so, raise an appropriate error message. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN2034"></a><span class='Declare_Function'>IsThereFunctionInNamespace</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>proname</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>pronargs</span><span class='Delimiter'>, 
</span><a name="LN2035"></a>                           <a href="../../include/c.h.html#LN477"><span class='Ref_to_Typedef'>oidvector</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>proargtypes</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>nspOid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* check for duplicate name (more friendly than unique-index failure) */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN177"><span class='Ref_to_Macro'>SearchSysCacheExists3</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN75"><span class='Ref_to_EnumConst'>PROCNAMEARGSNSP</span></a><span class='Delimiter'>, 
</span>                              <a href="../../include/postgres.h.html#LN583"><span class='Ref_to_Macro'>CStringGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2034"><span class='Ref_to_Parameter'>proname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                              <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2035"><span class='Ref_to_Parameter'>proargtypes</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                              <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2035"><span class='Ref_to_Parameter'>nspOid</span></a><span class='Parentheses'>)))</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DUPLICATE_FUNCTION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"function %s already exists in schema \"%s\""</span><span class='Delimiter'>, 
</span>                        <a href="../../include/parser/parse_func.h.html#LN57"><span class='Ref_to_Proto'>funcname_signature_string</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2034"><span class='Ref_to_Parameter'>proname</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN2034"><span class='Ref_to_Parameter'>pronargs</span></a><span class='Delimiter'>, 
</span>                                                  <a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN2035"><span class='Ref_to_Parameter'>proargtypes</span></a><span class='Operator'>-&GT;</span><a href="../../include/c.h.html#LN485"><span class='Ref_to_Member'>values</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                        <a href="../../include/utils/lsyscache.h.html#LN175"><span class='Ref_to_Proto'>get_namespace_name</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2035"><span class='Ref_to_Parameter'>nspOid</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * ExecuteDoStmt 
 *      Execute inline procedural-language code 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN2055"></a><span class='Declare_Function'>ExecuteDoStmt</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2752"><span class='Ref_to_Struct'>DoStmt</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>stmt</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2057"></a>    <a href="../../include/nodes/parsenodes.h.html#LN2758"><span class='Ref_to_Struct'>InlineCodeBlock</span></a> <span class='Operator'>*</span><span class='Declare_Local'>codeblock</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2758"><span class='Ref_to_Struct'>InlineCodeBlock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2058"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>arg</span><span class='Delimiter'>; 
</span><a name="LN2059"></a>    <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>as_item</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN2060"></a>    <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>language_item</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN2061"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>language</span><span class='Delimiter'>; 
</span><a name="LN2062"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>laninline</span><span class='Delimiter'>; 
</span><a name="LN2063"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>languageTuple</span><span class='Delimiter'>; 
</span><a name="LN2064"></a>    <a href="../../include/catalog/pg_language.h.html#LN50"><span class='Ref_to_Typedef'>Form_pg_language</span></a> <span class='Declare_Local'>languageStruct</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Process options we got from gram.y */ 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2058"><span class='Ref_To_Local'>arg</span></a><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN2055"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2755"><span class='Ref_to_Member'>args</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2069"></a>        <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>defel</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2058"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2069"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"as"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2059"><span class='Ref_To_Local'>as_item</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"conflicting or redundant options"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <a href="functioncmds.c.html#LN2059"><span class='Ref_To_Local'>as_item</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN2069"><span class='Ref_To_Local'>defel</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2069"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"language"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2060"><span class='Ref_To_Local'>language_item</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"conflicting or redundant options"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <a href="functioncmds.c.html#LN2060"><span class='Ref_To_Local'>language_item</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN2069"><span class='Ref_To_Local'>defel</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"option \"%s\" not recognized"</span><span class='Delimiter'>, 
</span>                 <a href="functioncmds.c.html#LN2069"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2059"><span class='Ref_To_Local'>as_item</span></a><span class='Parentheses'>) 
</span>        <a href="functioncmds.c.html#LN2057"><span class='Ref_To_Local'>codeblock</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2761"><span class='Ref_to_Member'>source_text</span></a> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2059"><span class='Ref_To_Local'>as_item</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN720"><span class='Ref_to_Member'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"no inline code specified"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* if LANGUAGE option wasn't specified, use the default */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2060"><span class='Ref_To_Local'>language_item</span></a><span class='Parentheses'>) 
</span>        <a href="functioncmds.c.html#LN2061"><span class='Ref_To_Local'>language</span></a> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2060"><span class='Ref_To_Local'>language_item</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN720"><span class='Ref_to_Member'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="functioncmds.c.html#LN2061"><span class='Ref_To_Local'>language</span></a> <span class='Operator'>= </span><span class='String'>"plpgsql"</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Look up the language and validate permissions */ 
</span>    <a href="functioncmds.c.html#LN2063"><span class='Ref_To_Local'>languageTuple</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN66"><span class='Ref_to_EnumConst'>LANGNAME</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2061"><span class='Ref_To_Local'>language</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2063"><span class='Ref_To_Local'>languageTuple</span></a><span class='Parentheses'>))</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_OBJECT<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"language \"%s\" does not exist"</span><span class='Delimiter'>, </span><a href="functioncmds.c.html#LN2061"><span class='Ref_To_Local'>language</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <span class='Parentheses'>(</span><a href="../../include/commands/proclang.h.html#LN19"><span class='Ref_to_Proto'>PLTemplateExists</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2061"><span class='Ref_To_Local'>language</span></a><span class='Parentheses'>) </span><span class='Operator'>? 
</span>                  <a href="../utils/error/elog.c.html#LN985"><span class='Ref_to_Func'>errhint</span></a><span class='Parentheses'>(</span><span class='String'>"Use CREATE LANGUAGE to load the language into the database."</span><span class='Parentheses'>) </span><span class='Operator'>: </span><span class='Number'>0</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="functioncmds.c.html#LN2057"><span class='Ref_To_Local'>codeblock</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2762"><span class='Ref_to_Member'>langOid</span></a> <span class='Operator'>= </span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2063"><span class='Ref_To_Local'>languageTuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN2064"><span class='Ref_To_Local'>languageStruct</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_language.h.html#LN50"><span class='Ref_to_Typedef'>Form_pg_language</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2063"><span class='Ref_To_Local'>languageTuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="functioncmds.c.html#LN2057"><span class='Ref_To_Local'>codeblock</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2763"><span class='Ref_to_Member'>langIsTrusted</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN2064"><span class='Ref_To_Local'>languageStruct</span></a><span class='Operator'>-&GT;</span>lanpltrusted<span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2064"><span class='Ref_To_Local'>languageStruct</span></a><span class='Operator'>-&GT;</span>lanpltrusted<span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* if trusted language, need USAGE privilege */ 
</span><a name="LN2121"></a>        <a href="../../include/utils/acl.h.html#LN169"><span class='Ref_to_Typedef'>AclResult</span></a>   <span class='Declare_Local'>aclresult</span><span class='Delimiter'>; 
</span> 
        <a href="functioncmds.c.html#LN2121"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>= </span><a href="../../include/utils/acl.h.html#LN286"><span class='Ref_to_Proto'>pg_language_aclcheck</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2057"><span class='Ref_To_Local'>codeblock</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2762"><span class='Ref_to_Member'>langOid</span></a><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, 
</span>                                         <a href="../../include/nodes/parsenodes.h.html#LN79"><span class='Ref_to_Const'>ACL_USAGE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2121"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>!= </span><a href="../../include/utils/acl.h.html#LN171"><span class='Ref_to_EnumConst'>ACLCHECK_OK</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/acl.h.html#LN295"><span class='Ref_to_Proto'>aclcheck_error</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2121"><span class='Ref_To_Local'>aclresult</span></a><span class='Delimiter'>, </span><a href="../../include/utils/acl.h.html#LN187"><span class='Ref_to_EnumConst'>ACL_KIND_LANGUAGE</span></a><span class='Delimiter'>, 
</span>                           <a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2064"><span class='Ref_To_Local'>languageStruct</span></a><span class='Operator'>-&GT;</span>lanname<span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* if untrusted language, must be superuser */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../utils/misc/superuser.c.html#LN45"><span class='Ref_to_Func'>superuser</span></a><span class='Parentheses'>())</span> 
            <a href="../../include/utils/acl.h.html#LN295"><span class='Ref_to_Proto'>aclcheck_error</span></a><span class='Parentheses'>(</span><a href="../../include/utils/acl.h.html#LN172"><span class='Ref_to_EnumConst'>ACLCHECK_NO_PRIV</span></a><span class='Delimiter'>, </span><a href="../../include/utils/acl.h.html#LN187"><span class='Ref_to_EnumConst'>ACL_KIND_LANGUAGE</span></a><span class='Delimiter'>, 
</span>                           <a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2064"><span class='Ref_To_Local'>languageStruct</span></a><span class='Operator'>-&GT;</span>lanname<span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* get the handler function's OID */ 
</span>    <a href="functioncmds.c.html#LN2062"><span class='Ref_To_Local'>laninline</span></a> <span class='Operator'>= </span><a href="functioncmds.c.html#LN2064"><span class='Ref_To_Local'>languageStruct</span></a><span class='Operator'>-&GT;</span>laninline<span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2062"><span class='Ref_To_Local'>laninline</span></a><span class='Parentheses'>))</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"language \"%s\" does not support inline code execution"</span><span class='Delimiter'>, 
</span>                    <a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2064"><span class='Ref_To_Local'>languageStruct</span></a><span class='Operator'>-&GT;</span>lanname<span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2063"><span class='Ref_To_Local'>languageTuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* execute the inline handler */ 
</span>    <a href="../../include/fmgr.h.html#LN621"><span class='Ref_to_Macro'>OidFunctionCall1</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2062"><span class='Ref_To_Local'>laninline</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="functioncmds.c.html#LN2057"><span class='Ref_To_Local'>codeblock</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end ExecuteDoStmt &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>