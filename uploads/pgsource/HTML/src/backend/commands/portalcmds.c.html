<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\backend\commands\portalcmds.c</title>
<LINK REL=StyleSheet HREF="../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\backend\commands\portalcmds.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:36 2017
</td></tr>
<tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * portalcmds.c 
 *    Utility commands affecting portals (that is, SQL cursor commands) 
 * 
 * Note: see also tcop/pquery.c, which implements portal operations for 
 * the FE/BE protocol.  This module uses pquery.c for some operations. 
 * And both modules depend on utils/mmgr/portalmem.c, which controls 
 * storage management for portals (but doesn't run any queries in them). 
 * 
 * 
 * Portions Copyright (c) 1996-2017, PostgreSQL Global Development Group 
 * Portions Copyright (c) 1994, Regents of the University of California 
 * 
 * 
 * IDENTIFICATION 
 *    src/backend/commands/portalcmds.c 
 * 
 *------------------------------------------------------------------------- 
 */ 
</span> 
<span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>&LT;limits.h&GT;</span> 
 
<span class='Keyword'>#include </span><span class='String'>"access/xact.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"commands/portalcmds.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"executor/executor.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"executor/tstoreReceiver.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"rewrite/rewriteHandler.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"tcop/pquery.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"tcop/tcopprot.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/memutils.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/snapmgr.h"</span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * PerformCursorOpen 
 *      Execute SQL DECLARE CURSOR command. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN41"></a><span class='Declare_Function'>PerformCursorOpen</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2612"><span class='Ref_to_Struct'>DeclareCursorStmt</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cstmt</span><span class='Delimiter'>, </span><a href="../../include/nodes/params.h.html#LN61"><span class='Ref_to_Typedef'>ParamListInfo</span></a> <span class='Declare_Parameter'>params</span><span class='Delimiter'>, 
</span><a name="LN42"></a>                  <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>queryString</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>isTopLevel</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN44"></a>    <a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>query</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN575"><span class='Ref_to_Macro'>castNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a><span class='Delimiter'>, </span><a href="portalcmds.c.html#LN41"><span class='Ref_to_Parameter'>cstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2617"><span class='Ref_to_Member'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN45"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>rewritten</span><span class='Delimiter'>; 
</span><a name="LN46"></a>    <a href="../../include/nodes/plannodes.h.html#LN40"><span class='Ref_to_Struct'>PlannedStmt</span></a> <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span><a name="LN47"></a>    <a href="../../include/utils/portal.h.html#LN111"><span class='Ref_to_Typedef'>Portal</span></a>      <span class='Declare_Local'>portal</span><span class='Delimiter'>; 
</span><a name="LN48"></a>    <a href="../../include/utils/palloc.h.html#LN35"><span class='Ref_to_Typedef'>MemoryContext</span></a> <span class='Declare_Local'>oldContext</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Disallow empty-string cursor name (conflicts with protocol-level 
     * unnamed portal). 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="portalcmds.c.html#LN41"><span class='Ref_to_Parameter'>cstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2615"><span class='Ref_to_Member'>portalname</span></a> <span class='Operator'>|| </span><a href="portalcmds.c.html#LN41"><span class='Ref_to_Parameter'>cstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2615"><span class='Ref_to_Member'>portalname</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_CURSOR_NAME<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"invalid cursor name: must not be empty"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If this is a non-holdable cursor, we require that this statement has 
     * been executed inside a transaction block (or else, it would have no 
     * user-visible effect). 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN41"><span class='Ref_to_Parameter'>cstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2616"><span class='Ref_to_Member'>options</span></a> <span class='Operator'>& </span><a href="../../include/nodes/parsenodes.h.html#LN2605"><span class='Ref_to_Const'>CURSOR_OPT_HOLD</span></a><span class='Parentheses'>))</span> 
        <a href="../../include/access/xact.h.html#LN371"><span class='Ref_to_Proto'>RequireTransactionChain</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN42"><span class='Ref_to_Parameter'>isTopLevel</span></a><span class='Delimiter'>, </span><span class='String'>"DECLARE CURSOR"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Parse analysis was done already, but we still have to run the rule 
     * rewriter.  We do not do AcquireRewriteLocks: we assume the query either 
     * came straight from the parser, or suitable locks were acquired by 
     * plancache.c. 
     * 
     * Because the rewriter and planner tend to scribble on the input, we make 
     * a preliminary copy of the source querytree.  This prevents problems in 
     * the case that the DECLARE CURSOR is in a portal or plpgsql function and 
     * is executed repeatedly.  (See also the same hack in EXPLAIN and 
     * PREPARE.)  XXX FIXME someday. 
     */ 
</span>    <a href="portalcmds.c.html#LN45"><span class='Ref_To_Local'>rewritten</span></a> <span class='Operator'>= </span><a href="../../include/rewrite/rewriteHandler.h.html#LN19"><span class='Ref_to_Proto'>QueryRewrite</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/nodes.h.html#LN618"><span class='Ref_to_Macro'>copyObject</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN44"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* SELECT should never rewrite to more or less than one query */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN45"><span class='Ref_To_Local'>rewritten</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"non-SELECT statement in DECLARE CURSOR"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="portalcmds.c.html#LN44"><span class='Ref_To_Local'>query</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN113"><span class='Ref_to_Macro'>linitial_node</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a><span class='Delimiter'>, </span><a href="portalcmds.c.html#LN45"><span class='Ref_To_Local'>rewritten</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="portalcmds.c.html#LN44"><span class='Ref_To_Local'>query</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN109"><span class='Ref_to_Member'>commandType</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/nodes.h.html#LN650"><span class='Ref_to_EnumConst'>CMD_SELECT</span></a><span class='Parentheses'>) 
</span>        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"non-SELECT statement in DECLARE CURSOR"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Plan the query, applying the specified options */ 
</span>    <a href="portalcmds.c.html#LN46"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="../../include/tcop/tcopprot.h.html#LN59"><span class='Ref_to_Proto'>pg_plan_query</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN44"><span class='Ref_To_Local'>query</span></a><span class='Delimiter'>, </span><a href="portalcmds.c.html#LN41"><span class='Ref_to_Parameter'>cstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2616"><span class='Ref_to_Member'>options</span></a><span class='Delimiter'>, </span><a href="portalcmds.c.html#LN41"><span class='Ref_to_Parameter'>params</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Create a portal and copy the plan and queryString into its memory. 
     */ 
</span>    <a href="portalcmds.c.html#LN47"><span class='Ref_To_Local'>portal</span></a> <span class='Operator'>= </span><a href="../utils/mmgr/portalmem.c.html#LN172"><span class='Ref_to_Func'>CreatePortal</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN41"><span class='Ref_to_Parameter'>cstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2615"><span class='Ref_to_Member'>portalname</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="portalcmds.c.html#LN48"><span class='Ref_To_Local'>oldContext</span></a> <span class='Operator'>= </span><a href="../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="../../include/utils/portal.h.html#LN204"><span class='Ref_to_Macro'>PortalGetHeapMemory</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN47"><span class='Ref_To_Local'>portal</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="portalcmds.c.html#LN46"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN618"><span class='Ref_to_Macro'>copyObject</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN46"><span class='Ref_To_Local'>plan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="portalcmds.c.html#LN42"><span class='Ref_to_Parameter'>queryString</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN42"><span class='Ref_to_Parameter'>queryString</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/portal.h.html#LN229"><span class='Ref_to_Proto'>PortalDefineQuery</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN47"><span class='Ref_To_Local'>portal</span></a><span class='Delimiter'>, 
</span>                      <span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                      <a href="portalcmds.c.html#LN42"><span class='Ref_to_Parameter'>queryString</span></a><span class='Delimiter'>, 
</span>                      <span class='String'>"SELECT"</span><span class='Delimiter'>, </span><span class='Comment_Single_Line'>/* cursor's query is always a SELECT */ 
</span>                      <a href="../../include/nodes/pg_list.h.html#LN138"><span class='Ref_to_Macro'>list_make1</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN46"><span class='Ref_To_Local'>plan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                      <span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/*---------- 
     * Also copy the outer portal's parameter list into the inner portal's 
     * memory context.  We want to pass down the parameter values in case we 
     * had a command like 
     *      DECLARE c CURSOR FOR SELECT ... WHERE foo = $1 
     * This will have been parsed using the outer parameter set and the 
     * parameter value needs to be preserved for use when the cursor is 
     * executed. 
     *---------- 
     */ 
</span>    <a href="portalcmds.c.html#LN41"><span class='Ref_to_Parameter'>params</span></a> <span class='Operator'>= </span><a href="../nodes/params.c.html#LN34"><span class='Ref_to_Func'>copyParamList</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN41"><span class='Ref_to_Parameter'>params</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN48"><span class='Ref_To_Local'>oldContext</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Set up options for portal. 
     * 
     * If the user didn't specify a SCROLL type, allow or disallow scrolling 
     * based on whether it would require any additional runtime overhead to do 
     * so.  Also, we disallow scrolling for FOR UPDATE cursors. 
     */ 
</span>    <a href="portalcmds.c.html#LN47"><span class='Ref_To_Local'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN143"><span class='Ref_to_Member'>cursorOptions</span></a> <span class='Operator'>= </span><a href="portalcmds.c.html#LN41"><span class='Ref_to_Parameter'>cstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2616"><span class='Ref_to_Member'>options</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN47"><span class='Ref_To_Local'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN143"><span class='Ref_to_Member'>cursorOptions</span></a> <span class='Operator'>& </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2602"><span class='Ref_to_Const'>CURSOR_OPT_SCROLL</span></a> <span class='Operator'>| </span><a href="../../include/nodes/parsenodes.h.html#LN2603"><span class='Ref_to_Const'>CURSOR_OPT_NO_SCROLL</span></a><span class='Parentheses'>)))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="portalcmds.c.html#LN46"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/plannodes.h.html#LN85"><span class='Ref_to_Member'>rowMarks</span></a> <span class='Operator'>== </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a> <span class='Operator'>&& 
</span>            <a href="../../include/executor/executor.h.html#LN100"><span class='Ref_to_Proto'>ExecSupportsBackwardScan</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN46"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/plannodes.h.html#LN60"><span class='Ref_to_Member'>planTree</span></a><span class='Parentheses'>))</span> 
            <a href="portalcmds.c.html#LN47"><span class='Ref_To_Local'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN143"><span class='Ref_to_Member'>cursorOptions</span></a> <span class='Operator'>|= </span><a href="../../include/nodes/parsenodes.h.html#LN2602"><span class='Ref_to_Const'>CURSOR_OPT_SCROLL</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="portalcmds.c.html#LN47"><span class='Ref_To_Local'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN143"><span class='Ref_to_Member'>cursorOptions</span></a> <span class='Operator'>|= </span><a href="../../include/nodes/parsenodes.h.html#LN2603"><span class='Ref_to_Const'>CURSOR_OPT_NO_SCROLL</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Start execution, inserting parameters if any. 
     */ 
</span>    <a href="../../include/tcop/pquery.h.html#LN29"><span class='Ref_to_Proto'>PortalStart</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN47"><span class='Ref_To_Local'>portal</span></a><span class='Delimiter'>, </span><a href="portalcmds.c.html#LN41"><span class='Ref_to_Parameter'>params</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="../../include/utils/snapmgr.h.html#LN77"><span class='Ref_to_Proto'>GetActiveSnapshot</span></a><span class='Parentheses'>())</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN47"><span class='Ref_To_Local'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN142"><span class='Ref_to_Member'>strategy</span></a> <span class='Operator'>== </span><a href="../../include/utils/portal.h.html#LN89"><span class='Ref_to_EnumConst'>PORTAL_ONE_SELECT</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We're done; the query won't actually be run until PerformPortalFetch is 
     * called. 
     */ 
</span><span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end PerformCursorOpen &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * PerformPortalFetch 
 *      Execute SQL FETCH or MOVE command. 
 * 
 *  stmt: parsetree node for command 
 *  dest: where to send results 
 *  completionTag: points to a buffer of size COMPLETION_TAG_BUFSIZE 
 *      in which to store a command completion status string. 
 * 
 * completionTag may be NULL if caller doesn't want a status string. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN167"></a><span class='Declare_Function'>PerformPortalFetch</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2647"><span class='Ref_to_Struct'>FetchStmt</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>stmt</span><span class='Delimiter'>, 
</span><a name="LN168"></a>                   <a href="../../include/tcop/dest.h.html#LN112"><span class='Ref_to_Typedef'>DestReceiver</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dest</span><span class='Delimiter'>, 
</span><a name="LN169"></a>                   <span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>completionTag</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN171"></a>    <a href="../../include/utils/portal.h.html#LN111"><span class='Ref_to_Typedef'>Portal</span></a>      <span class='Declare_Local'>portal</span><span class='Delimiter'>; 
</span><a name="LN172"></a>    <a href="../../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a>      <span class='Declare_Local'>nprocessed</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Disallow empty-string cursor name (conflicts with protocol-level 
     * unnamed portal). 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="portalcmds.c.html#LN167"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2652"><span class='Ref_to_Member'>portalname</span></a> <span class='Operator'>|| </span><a href="portalcmds.c.html#LN167"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2652"><span class='Ref_to_Member'>portalname</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_CURSOR_NAME<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"invalid cursor name: must not be empty"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* get the portal from the portal name */ 
</span>    <a href="portalcmds.c.html#LN171"><span class='Ref_To_Local'>portal</span></a> <span class='Operator'>= </span><a href="../utils/mmgr/portalmem.c.html#LN127"><span class='Ref_to_Func'>GetPortalByName</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN167"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2652"><span class='Ref_to_Member'>portalname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/portal.h.html#LN198"><span class='Ref_to_Macro'>PortalIsValid</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN171"><span class='Ref_To_Local'>portal</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_CURSOR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cursor \"%s\" does not exist"</span><span class='Delimiter'>, </span><a href="portalcmds.c.html#LN167"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2652"><span class='Ref_to_Member'>portalname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span><span class='Delimiter'>;</span>                 <span class='Comment_Single_Line'>/* keep compiler happy */ 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Adjust dest if needed.  MOVE wants destination DestNone */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="portalcmds.c.html#LN167"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2653"><span class='Ref_to_Member'>ismove</span></a><span class='Parentheses'>) 
</span>        <a href="portalcmds.c.html#LN168"><span class='Ref_to_Parameter'>dest</span></a> <span class='Operator'>= </span><a href="../tcop/dest.c.html#LN90"><span class='Ref_to_Global_Var'>None_Receiver</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Do it */ 
</span>    <a href="portalcmds.c.html#LN172"><span class='Ref_To_Local'>nprocessed</span></a> <span class='Operator'>= </span><a href="../../include/tcop/pquery.h.html#LN39"><span class='Ref_to_Proto'>PortalRunFetch</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN171"><span class='Ref_To_Local'>portal</span></a><span class='Delimiter'>, 
</span>                                <a href="portalcmds.c.html#LN167"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2650"><span class='Ref_to_Member'>direction</span></a><span class='Delimiter'>, 
</span>                                <a href="portalcmds.c.html#LN167"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2651"><span class='Ref_to_Member'>howMany</span></a><span class='Delimiter'>, 
</span>                                <a href="portalcmds.c.html#LN168"><span class='Ref_to_Parameter'>dest</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Return command status if wanted */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="portalcmds.c.html#LN169"><span class='Ref_to_Parameter'>completionTag</span></a><span class='Parentheses'>) 
</span>        <a href="../../pl/plperl/plperl.h.html#LN60"><span class='Ref_to_Macro'>snprintf</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN169"><span class='Ref_to_Parameter'>completionTag</span></a><span class='Delimiter'>, </span><a href="../../include/tcop/dest.h.html#LN73"><span class='Ref_to_Const'>COMPLETION_TAG_BUFSIZE</span></a><span class='Delimiter'>, </span><span class='String'>"%s "</span> <a href="../../include/c.h.html#LN315"><span class='Ref_to_Const'>UINT64_FORMAT</span></a><span class='Delimiter'>, 
</span>                 <a href="portalcmds.c.html#LN167"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2653"><span class='Ref_to_Member'>ismove</span></a> <span class='Operator'>? </span><span class='String'>"MOVE"</span> <span class='Operator'>: </span><span class='String'>"FETCH"</span><span class='Delimiter'>, 
</span>                 <a href="portalcmds.c.html#LN172"><span class='Ref_To_Local'>nprocessed</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PerformPortalFetch &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * PerformPortalClose 
 *      Close a cursor. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN215"></a><span class='Declare_Function'>PerformPortalClose</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>name</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN217"></a>    <a href="../../include/utils/portal.h.html#LN111"><span class='Ref_to_Typedef'>Portal</span></a>      <span class='Declare_Local'>portal</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* NULL means CLOSE ALL */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="portalcmds.c.html#LN215"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="../../include/utils/portal.h.html#LN237"><span class='Ref_to_Proto'>PortalHashTableDeleteAll</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Disallow empty-string cursor name (conflicts with protocol-level 
     * unnamed portal). 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="portalcmds.c.html#LN215"><span class='Ref_to_Parameter'>name</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_CURSOR_NAME<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"invalid cursor name: must not be empty"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * get the portal from the portal name 
     */ 
</span>    <a href="portalcmds.c.html#LN217"><span class='Ref_To_Local'>portal</span></a> <span class='Operator'>= </span><a href="../utils/mmgr/portalmem.c.html#LN127"><span class='Ref_to_Func'>GetPortalByName</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN215"><span class='Ref_to_Parameter'>name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/portal.h.html#LN198"><span class='Ref_to_Macro'>PortalIsValid</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN217"><span class='Ref_To_Local'>portal</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_CURSOR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cursor \"%s\" does not exist"</span><span class='Delimiter'>, </span><a href="portalcmds.c.html#LN215"><span class='Ref_to_Parameter'>name</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span><span class='Delimiter'>;</span>                 <span class='Comment_Single_Line'>/* keep compiler happy */ 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Note: PortalCleanup is called as a side-effect, if not already done. 
     */ 
</span>    <a href="../../include/utils/portal.h.html#LN227"><span class='Ref_to_Proto'>PortalDrop</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN217"><span class='Ref_To_Local'>portal</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PerformPortalClose &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * PortalCleanup 
 * 
 * Clean up a portal when it's dropped.  This is the standard cleanup hook 
 * for portals. 
 * 
 * Note: if portal-&GT;status is PORTAL_FAILED, we are probably being called 
 * during error abort, and must be careful to avoid doing anything that 
 * is likely to fail again. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN264"></a><span class='Declare_Function'>PortalCleanup</span><span class='Parentheses'>(</span><a href="../../include/utils/portal.h.html#LN111"><span class='Ref_to_Typedef'>Portal</span></a> <span class='Declare_Parameter'>portal</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN266"></a>    <a href="../../include/executor/execdesc.h.html#LN32"><span class='Ref_to_Struct'>QueryDesc</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>queryDesc</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * sanity checks 
     */ 
</span>    <a href="../../include/c.h.html#LN676"><span class='Ref_to_Macro'>AssertArg</span></a><span class='Parentheses'>(</span><a href="../../include/utils/portal.h.html#LN198"><span class='Ref_to_Macro'>PortalIsValid</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN264"><span class='Ref_to_Parameter'>portal</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/c.h.html#LN676"><span class='Ref_to_Macro'>AssertArg</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN264"><span class='Ref_to_Parameter'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN120"><span class='Ref_to_Member'>cleanup</span></a> <span class='Operator'>== </span><a href="../../include/commands/portalcmds.h.html#LN28"><span class='Ref_to_Proto'>PortalCleanup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Shut down executor, if still running.  We skip this during error abort, 
     * since other mechanisms will take care of releasing executor resources, 
     * and we can't be sure that ExecutorEnd itself wouldn't fail. 
     */ 
</span>    <a href="portalcmds.c.html#LN266"><span class='Ref_To_Local'>queryDesc</span></a> <span class='Operator'>= </span><a href="../../include/utils/portal.h.html#LN203"><span class='Ref_to_Macro'>PortalGetQueryDesc</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN264"><span class='Ref_to_Parameter'>portal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="portalcmds.c.html#LN266"><span class='Ref_To_Local'>queryDesc</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Reset the queryDesc before anything else.  This prevents us from 
         * trying to shut down the executor twice, in case of an error below. 
         * The transaction abort mechanisms will take care of resource cleanup 
         * in such a case. 
         */ 
</span>        <a href="portalcmds.c.html#LN264"><span class='Ref_to_Parameter'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN151"><span class='Ref_to_Member'>queryDesc</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="portalcmds.c.html#LN264"><span class='Ref_to_Parameter'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN147"><span class='Ref_to_Member'>status</span></a> <span class='Operator'>!= </span><a href="../../include/utils/portal.h.html#LN108"><span class='Ref_to_EnumConst'>PORTAL_FAILED</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN292"></a>            <a href="../../include/utils/resowner.h.html#LN26"><span class='Ref_to_Typedef'>ResourceOwner</span></a> <span class='Declare_Local'>saveResourceOwner</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* We must make the portal's resource owner current */ 
</span>            <a href="portalcmds.c.html#LN292"><span class='Ref_To_Local'>saveResourceOwner</span></a> <span class='Operator'>= </span><a href="../utils/resowner/resowner.c.html#LN137"><span class='Ref_to_Global_Var'>CurrentResourceOwner</span></a><span class='Delimiter'>; 
</span>            <a href="../../include/utils/elog.h.html#LN283"><span class='Ref_to_Macro'>PG_TRY</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="portalcmds.c.html#LN264"><span class='Ref_to_Parameter'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN119"><span class='Ref_to_Member'>resowner</span></a><span class='Parentheses'>) 
</span>                    <a href="../utils/resowner/resowner.c.html#LN137"><span class='Ref_to_Global_Var'>CurrentResourceOwner</span></a> <span class='Operator'>= </span><a href="portalcmds.c.html#LN264"><span class='Ref_to_Parameter'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN119"><span class='Ref_to_Member'>resowner</span></a><span class='Delimiter'>; 
</span>                <a href="../../include/executor/executor.h.html#LN173"><span class='Ref_to_Proto'>ExecutorFinish</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN266"><span class='Ref_To_Local'>queryDesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="../../include/executor/executor.h.html#LN175"><span class='Ref_to_Proto'>ExecutorEnd</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN266"><span class='Ref_To_Local'>queryDesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="../../include/executor/execdesc.h.html#LN67"><span class='Ref_to_Proto'>FreeQueryDesc</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN266"><span class='Ref_To_Local'>queryDesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <a href="../../include/utils/elog.h.html#LN292"><span class='Ref_to_Macro'>PG_CATCH</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Ensure CurrentResourceOwner is restored on error */ 
</span>                <a href="../utils/resowner/resowner.c.html#LN137"><span class='Ref_to_Global_Var'>CurrentResourceOwner</span></a> <span class='Operator'>= </span><a href="portalcmds.c.html#LN292"><span class='Ref_To_Local'>saveResourceOwner</span></a><span class='Delimiter'>; 
</span>                <a href="../../include/utils/elog.h.html#LN310"><span class='Ref_to_Macro'>PG_RE_THROW</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <a href="../../include/utils/elog.h.html#LN299"><span class='Ref_to_Macro'>PG_END_TRY</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>            <a href="../utils/resowner/resowner.c.html#LN137"><span class='Ref_to_Global_Var'>CurrentResourceOwner</span></a> <span class='Operator'>= </span><a href="portalcmds.c.html#LN292"><span class='Ref_To_Local'>saveResourceOwner</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if portal-&GT;status!=PORTA... &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if queryDesc &raquo; </span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end PortalCleanup &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * PersistHoldablePortal 
 * 
 * Prepare the specified Portal for access outside of the current 
 * transaction. When this function returns, all future accesses to the 
 * portal must be done via the Tuplestore (not by invoking the 
 * executor). 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN325"></a><span class='Declare_Function'>PersistHoldablePortal</span><span class='Parentheses'>(</span><a href="../../include/utils/portal.h.html#LN111"><span class='Ref_to_Typedef'>Portal</span></a> <span class='Declare_Parameter'>portal</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN327"></a>    <a href="../../include/executor/execdesc.h.html#LN32"><span class='Ref_to_Struct'>QueryDesc</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>queryDesc</span> <span class='Operator'>= </span><a href="../../include/utils/portal.h.html#LN203"><span class='Ref_to_Macro'>PortalGetQueryDesc</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN325"><span class='Ref_to_Parameter'>portal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN328"></a>    <a href="../../include/utils/portal.h.html#LN111"><span class='Ref_to_Typedef'>Portal</span></a>      <span class='Declare_Local'>saveActivePortal</span><span class='Delimiter'>; 
</span><a name="LN329"></a>    <a href="../../include/utils/resowner.h.html#LN26"><span class='Ref_to_Typedef'>ResourceOwner</span></a> <span class='Declare_Local'>saveResourceOwner</span><span class='Delimiter'>; 
</span><a name="LN330"></a>    <a href="../../include/utils/palloc.h.html#LN35"><span class='Ref_to_Typedef'>MemoryContext</span></a> <span class='Declare_Local'>savePortalContext</span><span class='Delimiter'>; 
</span><a name="LN331"></a>    <a href="../../include/utils/palloc.h.html#LN35"><span class='Ref_to_Typedef'>MemoryContext</span></a> <span class='Declare_Local'>oldcxt</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If we're preserving a holdable portal, we had better be inside the 
     * transaction that originally created it. 
     */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN325"><span class='Ref_to_Parameter'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN129"><span class='Ref_to_Member'>createSubid</span></a> <span class='Operator'>!= </span><a href="../../include/c.h.html#LN402"><span class='Ref_to_Const'>InvalidSubTransactionId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN327"><span class='Ref_To_Local'>queryDesc</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Caller must have created the tuplestore already ... but not a snapshot. 
     */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN325"><span class='Ref_to_Parameter'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN164"><span class='Ref_to_Member'>holdContext</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN325"><span class='Ref_to_Parameter'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN163"><span class='Ref_to_Member'>holdStore</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN325"><span class='Ref_to_Parameter'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN174"><span class='Ref_to_Member'>holdSnapshot</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Before closing down the executor, we must copy the tupdesc into 
     * long-term memory, since it was created in executor memory. 
     */ 
</span>    <a href="portalcmds.c.html#LN331"><span class='Ref_To_Local'>oldcxt</span></a> <span class='Operator'>= </span><a href="../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN325"><span class='Ref_to_Parameter'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN164"><span class='Ref_to_Member'>holdContext</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="portalcmds.c.html#LN325"><span class='Ref_to_Parameter'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN154"><span class='Ref_to_Member'>tupDesc</span></a> <span class='Operator'>= </span><a href="../../include/access/tupdesc.h.html#LN88"><span class='Ref_to_Proto'>CreateTupleDescCopy</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN325"><span class='Ref_to_Parameter'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN154"><span class='Ref_to_Member'>tupDesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN331"><span class='Ref_To_Local'>oldcxt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Check for improper portal use, and mark portal active. 
     */ 
</span>    <a href="../../include/utils/portal.h.html#LN224"><span class='Ref_to_Proto'>MarkPortalActive</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN325"><span class='Ref_to_Parameter'>portal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Set up global portal context pointers. 
     */ 
</span>    <a href="portalcmds.c.html#LN328"><span class='Ref_To_Local'>saveActivePortal</span></a> <span class='Operator'>= </span><a href="../tcop/pquery.c.html#LN34"><span class='Ref_to_Global_Var'>ActivePortal</span></a><span class='Delimiter'>; 
</span>    <a href="portalcmds.c.html#LN329"><span class='Ref_To_Local'>saveResourceOwner</span></a> <span class='Operator'>= </span><a href="../utils/resowner/resowner.c.html#LN137"><span class='Ref_to_Global_Var'>CurrentResourceOwner</span></a><span class='Delimiter'>; 
</span>    <a href="portalcmds.c.html#LN330"><span class='Ref_To_Local'>savePortalContext</span></a> <span class='Operator'>= </span><a href="../utils/mmgr/mcxt.c.html#LN51"><span class='Ref_to_Global_Var'>PortalContext</span></a><span class='Delimiter'>; 
</span>    <a href="../../include/utils/elog.h.html#LN283"><span class='Ref_to_Macro'>PG_TRY</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>{ 
</span>        <a href="../tcop/pquery.c.html#LN34"><span class='Ref_to_Global_Var'>ActivePortal</span></a> <span class='Operator'>= </span><a href="portalcmds.c.html#LN325"><span class='Ref_to_Parameter'>portal</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="portalcmds.c.html#LN325"><span class='Ref_to_Parameter'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN119"><span class='Ref_to_Member'>resowner</span></a><span class='Parentheses'>) 
</span>            <a href="../utils/resowner/resowner.c.html#LN137"><span class='Ref_to_Global_Var'>CurrentResourceOwner</span></a> <span class='Operator'>= </span><a href="portalcmds.c.html#LN325"><span class='Ref_to_Parameter'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN119"><span class='Ref_to_Member'>resowner</span></a><span class='Delimiter'>; 
</span>        <a href="../utils/mmgr/mcxt.c.html#LN51"><span class='Ref_to_Global_Var'>PortalContext</span></a> <span class='Operator'>= </span><a href="../../include/utils/portal.h.html#LN204"><span class='Ref_to_Macro'>PortalGetHeapMemory</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN325"><span class='Ref_to_Parameter'>portal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="../utils/mmgr/mcxt.c.html#LN51"><span class='Ref_to_Global_Var'>PortalContext</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/utils/snapmgr.h.html#LN73"><span class='Ref_to_Proto'>PushActiveSnapshot</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN327"><span class='Ref_To_Local'>queryDesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/executor/execdesc.h.html#LN38"><span class='Ref_to_Member'>snapshot</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Rewind the executor: we need to store the entire result set in the 
         * tuplestore, so that subsequent backward FETCHs can be processed. 
         */ 
</span>        <a href="../../include/executor/executor.h.html#LN177"><span class='Ref_to_Proto'>ExecutorRewind</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN327"><span class='Ref_To_Local'>queryDesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Change the destination to output to the tuplestore.  Note we tell 
         * the tuplestore receiver to detoast all data passed through it; this 
         * makes it safe to not keep a snapshot associated with the data. 
         */ 
</span>        <a href="portalcmds.c.html#LN327"><span class='Ref_To_Local'>queryDesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/executor/execdesc.h.html#LN40"><span class='Ref_to_Member'>dest</span></a> <span class='Operator'>= </span><a href="../tcop/dest.c.html#LN107"><span class='Ref_to_Func'>CreateDestReceiver</span></a><span class='Parentheses'>(</span><a href="../../include/tcop/dest.h.html#LN93"><span class='Ref_to_EnumConst'>DestTuplestore</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../include/executor/tstoreReceiver.h.html#LN23"><span class='Ref_to_Proto'>SetTuplestoreDestReceiverParams</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN327"><span class='Ref_To_Local'>queryDesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/executor/execdesc.h.html#LN40"><span class='Ref_to_Member'>dest</span></a><span class='Delimiter'>, 
</span>                                        <a href="portalcmds.c.html#LN325"><span class='Ref_to_Parameter'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN163"><span class='Ref_to_Member'>holdStore</span></a><span class='Delimiter'>, 
</span>                                        <a href="portalcmds.c.html#LN325"><span class='Ref_to_Parameter'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN164"><span class='Ref_to_Member'>holdContext</span></a><span class='Delimiter'>, 
</span>                                        <span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Fetch the result set into the tuplestore */ 
</span>        <a href="../../include/executor/executor.h.html#LN169"><span class='Ref_to_Proto'>ExecutorRun</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN327"><span class='Ref_To_Local'>queryDesc</span></a><span class='Delimiter'>, </span><a href="../../include/access/sdir.h.html#LN25"><span class='Ref_to_EnumConst'>ForwardScanDirection</span></a><span class='Delimiter'>, </span><span class='Number'>0L</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="portalcmds.c.html#LN327"><span class='Ref_To_Local'>queryDesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/executor/execdesc.h.html#LN40"><span class='Ref_to_Member'>dest</span></a><span class='Operator'>-&GT;</span><a href="../../include/tcop/dest.h.html#LN125"><span class='Ref_to_Member'>rDestroy</span></a><span class='Parentheses'>) (</span><a href="portalcmds.c.html#LN327"><span class='Ref_To_Local'>queryDesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/executor/execdesc.h.html#LN40"><span class='Ref_to_Member'>dest</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="portalcmds.c.html#LN327"><span class='Ref_To_Local'>queryDesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/executor/execdesc.h.html#LN40"><span class='Ref_to_Member'>dest</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Now shut down the inner executor. 
         */ 
</span>        <a href="portalcmds.c.html#LN325"><span class='Ref_to_Parameter'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN151"><span class='Ref_to_Member'>queryDesc</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* prevent double shutdown */ 
</span>        <a href="../../include/executor/executor.h.html#LN173"><span class='Ref_to_Proto'>ExecutorFinish</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN327"><span class='Ref_To_Local'>queryDesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../include/executor/executor.h.html#LN175"><span class='Ref_to_Proto'>ExecutorEnd</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN327"><span class='Ref_To_Local'>queryDesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../include/executor/execdesc.h.html#LN67"><span class='Ref_to_Proto'>FreeQueryDesc</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN327"><span class='Ref_To_Local'>queryDesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Set the position in the result set. 
         */ 
</span>        <a href="../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN325"><span class='Ref_to_Parameter'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN164"><span class='Ref_to_Member'>holdContext</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="portalcmds.c.html#LN325"><span class='Ref_to_Parameter'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN186"><span class='Ref_to_Member'>atEnd</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * Just force the tuplestore forward to its end.  The size of the 
             * skip request here is arbitrary. 
             */ 
</span>            <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="../../include/utils/tuplestore.h.html#LN77"><span class='Ref_to_Proto'>tuplestore_skiptuples</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN325"><span class='Ref_to_Parameter'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN163"><span class='Ref_to_Member'>holdStore</span></a><span class='Delimiter'>, </span><span class='Number'>1000000</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>))</span> 
                 <span class='Comment_Multi_Line'>/* continue */ </span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="../../include/utils/tuplestore.h.html#LN84"><span class='Ref_to_Proto'>tuplestore_rescan</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN325"><span class='Ref_to_Parameter'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN163"><span class='Ref_to_Member'>holdStore</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/tuplestore.h.html#LN77"><span class='Ref_to_Proto'>tuplestore_skiptuples</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN325"><span class='Ref_to_Parameter'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN163"><span class='Ref_to_Member'>holdStore</span></a><span class='Delimiter'>, 
</span>                                       <a href="portalcmds.c.html#LN325"><span class='Ref_to_Parameter'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN187"><span class='Ref_to_Member'>portalPos</span></a><span class='Delimiter'>, 
</span>                                       <span class='Boolean'>true</span><span class='Parentheses'>))</span> 
                <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unexpected end of tuple stream"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <a href="../../include/utils/elog.h.html#LN292"><span class='Ref_to_Macro'>PG_CATCH</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Uncaught error while executing portal: mark it dead */ 
</span>        <a href="../../include/utils/portal.h.html#LN226"><span class='Ref_to_Proto'>MarkPortalFailed</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN325"><span class='Ref_to_Parameter'>portal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Restore global vars and propagate error */ 
</span>        <a href="../tcop/pquery.c.html#LN34"><span class='Ref_to_Global_Var'>ActivePortal</span></a> <span class='Operator'>= </span><a href="portalcmds.c.html#LN328"><span class='Ref_To_Local'>saveActivePortal</span></a><span class='Delimiter'>; 
</span>        <a href="../utils/resowner/resowner.c.html#LN137"><span class='Ref_to_Global_Var'>CurrentResourceOwner</span></a> <span class='Operator'>= </span><a href="portalcmds.c.html#LN329"><span class='Ref_To_Local'>saveResourceOwner</span></a><span class='Delimiter'>; 
</span>        <a href="../utils/mmgr/mcxt.c.html#LN51"><span class='Ref_to_Global_Var'>PortalContext</span></a> <span class='Operator'>= </span><a href="portalcmds.c.html#LN330"><span class='Ref_To_Local'>savePortalContext</span></a><span class='Delimiter'>; 
</span> 
        <a href="../../include/utils/elog.h.html#LN310"><span class='Ref_to_Macro'>PG_RE_THROW</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="../../include/utils/elog.h.html#LN299"><span class='Ref_to_Macro'>PG_END_TRY</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN331"><span class='Ref_To_Local'>oldcxt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Mark portal not active */ 
</span>    <a href="portalcmds.c.html#LN325"><span class='Ref_to_Parameter'>portal</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/portal.h.html#LN147"><span class='Ref_to_Member'>status</span></a> <span class='Operator'>= </span><a href="../../include/utils/portal.h.html#LN105"><span class='Ref_to_EnumConst'>PORTAL_READY</span></a><span class='Delimiter'>; 
</span> 
    <a href="../tcop/pquery.c.html#LN34"><span class='Ref_to_Global_Var'>ActivePortal</span></a> <span class='Operator'>= </span><a href="portalcmds.c.html#LN328"><span class='Ref_To_Local'>saveActivePortal</span></a><span class='Delimiter'>; 
</span>    <a href="../utils/resowner/resowner.c.html#LN137"><span class='Ref_to_Global_Var'>CurrentResourceOwner</span></a> <span class='Operator'>= </span><a href="portalcmds.c.html#LN329"><span class='Ref_To_Local'>saveResourceOwner</span></a><span class='Delimiter'>; 
</span>    <a href="../utils/mmgr/mcxt.c.html#LN51"><span class='Ref_to_Global_Var'>PortalContext</span></a> <span class='Operator'>= </span><a href="portalcmds.c.html#LN330"><span class='Ref_To_Local'>savePortalContext</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/snapmgr.h.html#LN76"><span class='Ref_to_Proto'>PopActiveSnapshot</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We can now release any subsidiary memory of the portal's heap context; 
     * we'll never use it again.  The executor already dropped its context, 
     * but this will clean up anything that glommed onto the portal's heap via 
     * PortalContext. 
     */ 
</span>    <a href="../../include/utils/memutils.h.html#LN77"><span class='Ref_to_Proto'>MemoryContextDeleteChildren</span></a><span class='Parentheses'>(</span><a href="../../include/utils/portal.h.html#LN204"><span class='Ref_to_Macro'>PortalGetHeapMemory</span></a><span class='Parentheses'>(</span><a href="portalcmds.c.html#LN325"><span class='Ref_to_Parameter'>portal</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PersistHoldablePortal &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>