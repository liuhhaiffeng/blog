<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\backend\commands\tsearchcmds.c</title>
<LINK REL=StyleSheet HREF="../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\backend\commands\tsearchcmds.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:37 2017
</td></tr>
<tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
</span><span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * tsearchcmds.c 
 * 
 *    Routines for tsearch manipulation commands 
 * 
 * Portions Copyright (c) 1996-2017, PostgreSQL Global Development Group 
 * Portions Copyright (c) 1994, Regents of the University of California 
 * 
 * 
 * IDENTIFICATION 
 *    src/backend/commands/tsearchcmds.c 
 * 
 *------------------------------------------------------------------------- 
 */ 
</span><span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>&LT;ctype.h&GT;</span> 
 
<span class='Keyword'>#include </span><span class='String'>"access/genam.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/heapam.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/htup_details.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/xact.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/dependency.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/indexing.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/objectaccess.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_namespace.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_proc.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_ts_config.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_ts_config_map.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_ts_dict.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_ts_parser.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_ts_template.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_type.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"commands/alter.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"commands/defrem.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"commands/event_trigger.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"miscadmin.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"nodes/makefuncs.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parse_func.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"tsearch/ts_cache.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"tsearch/ts_utils.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/builtins.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/fmgroids.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/lsyscache.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/rel.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/syscache.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/tqual.h"</span> 
 
 
<a name="LN50"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>MakeConfigurationMapping</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN3329"><span class='Ref_to_Struct'>AlterTSConfigurationStmt</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>stmt</span><span class='Delimiter'>, 
</span><a name="LN51"></a>                         <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a> <span class='Declare_Parameter'>tup</span><span class='Delimiter'>, </span><a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a> <span class='Declare_Parameter'>relMap</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN52"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>DropConfigurationMapping</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN3329"><span class='Ref_to_Struct'>AlterTSConfigurationStmt</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>stmt</span><span class='Delimiter'>, 
</span><a name="LN53"></a>                         <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a> <span class='Declare_Parameter'>tup</span><span class='Delimiter'>, </span><a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a> <span class='Declare_Parameter'>relMap</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* --------------------- TS Parser commands ------------------------ */ 
</span> 
<span class='Comment_Multi_Line'>/* 
 * lookup a parser support function and return its OID (as a Datum) 
 * 
 * attnum is the pg_ts_parser column the function will go into 
 */ 
</span><span class='Keyword'>static </span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN64"></a><span class='Declare_Function'>get_ts_parser_func</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>defel</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>attnum</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN66"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>funcName</span> <span class='Operator'>= </span><a href="../../include/commands/defrem.h.html#LN161"><span class='Ref_to_Proto'>defGetQualifiedName</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN64"><span class='Ref_to_Parameter'>defel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN67"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>typeId</span><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>]; 
</span><a name="LN68"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>retTypeId</span><span class='Delimiter'>; 
</span><a name="LN69"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>nargs</span><span class='Delimiter'>; 
</span><a name="LN70"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>procOid</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN68"><span class='Ref_To_Local'>retTypeId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_type.h.html#LN697"><span class='Ref_to_Const'>INTERNALOID</span></a><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* correct for most */ 
</span>    <a href="tsearchcmds.c.html#LN67"><span class='Ref_To_Local'>typeId</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/catalog/pg_type.h.html#LN697"><span class='Ref_to_Const'>INTERNALOID</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN64"><span class='Ref_to_Parameter'>attnum</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../include/catalog/pg_ts_parser.h.html#LN52"><span class='Ref_to_Const'>Anum_pg_ts_parser_prsstart</span></a><span class='Operator'>: 
</span>            <a href="tsearchcmds.c.html#LN69"><span class='Ref_To_Local'>nargs</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>            <a href="tsearchcmds.c.html#LN67"><span class='Ref_To_Local'>typeId</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../interfaces/ecpg/ecpglib/pg_type.h.html#LN24"><span class='Ref_to_Const'>INT4OID</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/catalog/pg_ts_parser.h.html#LN53"><span class='Ref_to_Const'>Anum_pg_ts_parser_prstoken</span></a><span class='Operator'>: 
</span>            <a href="tsearchcmds.c.html#LN69"><span class='Ref_To_Local'>nargs</span></a> <span class='Operator'>= </span><span class='Number'>3</span><span class='Delimiter'>; 
</span>            <a href="tsearchcmds.c.html#LN67"><span class='Ref_To_Local'>typeId</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/catalog/pg_type.h.html#LN697"><span class='Ref_to_Const'>INTERNALOID</span></a><span class='Delimiter'>; 
</span>            <a href="tsearchcmds.c.html#LN67"><span class='Ref_To_Local'>typeId</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/catalog/pg_type.h.html#LN697"><span class='Ref_to_Const'>INTERNALOID</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/catalog/pg_ts_parser.h.html#LN54"><span class='Ref_to_Const'>Anum_pg_ts_parser_prsend</span></a><span class='Operator'>: 
</span>            <a href="tsearchcmds.c.html#LN69"><span class='Ref_To_Local'>nargs</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <a href="tsearchcmds.c.html#LN68"><span class='Ref_To_Local'>retTypeId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_type.h.html#LN689"><span class='Ref_to_Const'>VOIDOID</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/catalog/pg_ts_parser.h.html#LN55"><span class='Ref_to_Const'>Anum_pg_ts_parser_prsheadline</span></a><span class='Operator'>: 
</span>            <a href="tsearchcmds.c.html#LN69"><span class='Ref_To_Local'>nargs</span></a> <span class='Operator'>= </span><span class='Number'>3</span><span class='Delimiter'>; 
</span>            <a href="tsearchcmds.c.html#LN67"><span class='Ref_To_Local'>typeId</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/catalog/pg_type.h.html#LN697"><span class='Ref_to_Const'>INTERNALOID</span></a><span class='Delimiter'>; 
</span>            <a href="tsearchcmds.c.html#LN67"><span class='Ref_To_Local'>typeId</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../interfaces/ecpg/ecpglib/pg_type.h.html#LN72"><span class='Ref_to_Const'>TSQUERYOID</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/catalog/pg_ts_parser.h.html#LN56"><span class='Ref_to_Const'>Anum_pg_ts_parser_prslextype</span></a><span class='Operator'>: 
</span>            <a href="tsearchcmds.c.html#LN69"><span class='Ref_To_Local'>nargs</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Note: because the lextype method returns type internal, it must 
             * have an internal-type argument for security reasons.  The 
             * argument is not actually used, but is just passed as a zero. 
             */ 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <span class='Comment_Multi_Line'>/* should not be here */ 
</span>            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized attribute for text search parser: %d"</span><span class='Delimiter'>, 
</span>                 <a href="tsearchcmds.c.html#LN64"><span class='Ref_to_Parameter'>attnum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="tsearchcmds.c.html#LN69"><span class='Ref_To_Local'>nargs</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>;</span>          <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch attnum &raquo; </span> 
 
    <a href="tsearchcmds.c.html#LN70"><span class='Ref_To_Local'>procOid</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_func.h.html#LN62"><span class='Ref_to_Proto'>LookupFuncName</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN66"><span class='Ref_To_Local'>funcName</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN69"><span class='Ref_To_Local'>nargs</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN67"><span class='Ref_To_Local'>typeId</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/utils/lsyscache.h.html#LN112"><span class='Ref_to_Proto'>get_func_rettype</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN70"><span class='Ref_To_Local'>procOid</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="tsearchcmds.c.html#LN68"><span class='Ref_To_Local'>retTypeId</span></a><span class='Parentheses'>)</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"function %s should return type %s"</span><span class='Delimiter'>, 
</span>                        <a href="../../include/parser/parse_func.h.html#LN59"><span class='Ref_to_Proto'>func_signature_string</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN66"><span class='Ref_To_Local'>funcName</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN69"><span class='Ref_To_Local'>nargs</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN67"><span class='Ref_To_Local'>typeId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                        <a href="../utils/adt/format_type.c.html#LN92"><span class='Ref_to_Func'>format_type_be</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN68"><span class='Ref_To_Local'>retTypeId</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN70"><span class='Ref_To_Local'>procOid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end get_ts_parser_func &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * make pg_depend entries for a new pg_ts_parser entry 
 * 
 * Return value is the address of said new entry. 
 */ 
</span><span class='Keyword'>static </span><a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> 
<a name="LN127"></a><span class='Declare_Function'>makeParserDependencies</span><span class='Parentheses'>(</span><a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a> <span class='Declare_Parameter'>tuple</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN129"></a>    <a href="../../include/catalog/pg_ts_parser.h.html#LN43"><span class='Ref_to_Typedef'>Form_pg_ts_parser</span></a> <span class='Declare_Local'>prs</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_parser.h.html#LN43"><span class='Ref_to_Typedef'>Form_pg_ts_parser</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN127"><span class='Ref_to_Parameter'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN130"></a>    <a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> <span class='Declare_Local'>myself</span><span class='Delimiter'>, 
</span><a name="LN131"></a>                <span class='Declare_Local'>referenced</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN130"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_ts_parser.h.html#LN30"><span class='Ref_to_Const'>TSParserRelationId</span></a><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN130"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN127"><span class='Ref_to_Parameter'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN130"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on namespace */ 
</span>    <a href="tsearchcmds.c.html#LN131"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_namespace.h.html#LN33"><span class='Ref_to_Const'>NamespaceRelationId</span></a><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN131"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN129"><span class='Ref_To_Local'>prs</span></a><span class='Operator'>-&GT;</span>prsnamespace<span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN131"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../catalog/pg_depend.c.html#LN42"><span class='Ref_to_Func'>recordDependencyOn</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN130"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN131"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on extension */ 
</span>    <a href="../catalog/pg_depend.c.html#LN137"><span class='Ref_to_Func'>recordDependencyOnCurrentExtension</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN130"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependencies on functions */ 
</span>    <a href="tsearchcmds.c.html#LN131"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_proc.h.html#LN32"><span class='Ref_to_Const'>ProcedureRelationId</span></a><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN131"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN131"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN129"><span class='Ref_To_Local'>prs</span></a><span class='Operator'>-&GT;</span>prsstart<span class='Delimiter'>; 
</span>    <a href="../catalog/pg_depend.c.html#LN42"><span class='Ref_to_Func'>recordDependencyOn</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN130"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN131"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN131"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN129"><span class='Ref_To_Local'>prs</span></a><span class='Operator'>-&GT;</span>prstoken<span class='Delimiter'>; 
</span>    <a href="../catalog/pg_depend.c.html#LN42"><span class='Ref_to_Func'>recordDependencyOn</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN130"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN131"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN131"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN129"><span class='Ref_To_Local'>prs</span></a><span class='Operator'>-&GT;</span>prsend<span class='Delimiter'>; 
</span>    <a href="../catalog/pg_depend.c.html#LN42"><span class='Ref_to_Func'>recordDependencyOn</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN130"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN131"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN131"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN129"><span class='Ref_To_Local'>prs</span></a><span class='Operator'>-&GT;</span>prslextype<span class='Delimiter'>; 
</span>    <a href="../catalog/pg_depend.c.html#LN42"><span class='Ref_to_Func'>recordDependencyOn</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN130"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN131"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN129"><span class='Ref_To_Local'>prs</span></a><span class='Operator'>-&GT;</span>prsheadline<span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="tsearchcmds.c.html#LN131"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN129"><span class='Ref_To_Local'>prs</span></a><span class='Operator'>-&GT;</span>prsheadline<span class='Delimiter'>; 
</span>        <a href="../catalog/pg_depend.c.html#LN42"><span class='Ref_to_Func'>recordDependencyOn</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN130"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN131"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="tsearchcmds.c.html#LN130"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end makeParserDependencies &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * CREATE TEXT SEARCH PARSER 
 */ 
</span><a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> 
<a name="LN175"></a><span class='Declare_Function'>DefineTSParser</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>names</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>parameters</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN177"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>prsname</span><span class='Delimiter'>; 
</span><a name="LN178"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>pl</span><span class='Delimiter'>; 
</span><a name="LN179"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>prsRel</span><span class='Delimiter'>; 
</span><a name="LN180"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tup</span><span class='Delimiter'>; 
</span><a name="LN181"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>values</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_parser.h.html#LN49"><span class='Ref_to_Const'>Natts_pg_ts_parser</span></a><span class='Delimiter'>]; 
</span><a name="LN182"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>nulls</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_parser.h.html#LN49"><span class='Ref_to_Const'>Natts_pg_ts_parser</span></a><span class='Delimiter'>]; 
</span><a name="LN183"></a>    <a href="../../include/c.h.html#LN492"><span class='Ref_to_Typedef'>NameData</span></a>    <span class='Declare_Local'>pname</span><span class='Delimiter'>; 
</span><a name="LN184"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>prsOid</span><span class='Delimiter'>; 
</span><a name="LN185"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceoid</span><span class='Delimiter'>; 
</span><a name="LN186"></a>    <a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> <span class='Declare_Local'>address</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../utils/misc/superuser.c.html#LN45"><span class='Ref_to_Func'>superuser</span></a><span class='Parentheses'>())</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INSUFFICIENT_PRIVILEGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"must be superuser to create text search parsers"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Convert list of names to a name and namespace */ 
</span>    <a href="tsearchcmds.c.html#LN185"><span class='Ref_To_Local'>namespaceoid</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN118"><span class='Ref_to_Proto'>QualifiedNameGetCreationNamespace</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN175"><span class='Ref_to_Parameter'>names</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN177"><span class='Ref_To_Local'>prsname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* initialize tuple fields with name/namespace */ 
</span>    memset<span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN181"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN181"><span class='Ref_To_Local'>values</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    memset<span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN182"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN182"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/builtins.h.html#LN40"><span class='Ref_to_Proto'>namestrcpy</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN183"><span class='Ref_To_Local'>pname</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN177"><span class='Ref_To_Local'>prsname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN181"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_parser.h.html#LN50"><span class='Ref_to_Const'>Anum_pg_ts_parser_prsname</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN600"><span class='Ref_to_Macro'>NameGetDatum</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN183"><span class='Ref_To_Local'>pname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN181"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_parser.h.html#LN51"><span class='Ref_to_Const'>Anum_pg_ts_parser_prsnamespace</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN185"><span class='Ref_To_Local'>namespaceoid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * loop over the definition list and extract the information we need. 
     */ 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN178"><span class='Ref_To_Local'>pl</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN175"><span class='Ref_to_Parameter'>parameters</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN209"></a>        <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>defel</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN178"><span class='Ref_To_Local'>pl</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../port/pgstrcasecmp.c.html#LN34"><span class='Ref_to_Func'>pg_strcasecmp</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN209"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"start"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="tsearchcmds.c.html#LN181"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_parser.h.html#LN52"><span class='Ref_to_Const'>Anum_pg_ts_parser_prsstart</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= 
</span>                <a href="tsearchcmds.c.html#LN63"><span class='Ref_to_Func'>get_ts_parser_func</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN209"><span class='Ref_To_Local'>defel</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/pg_ts_parser.h.html#LN52"><span class='Ref_to_Const'>Anum_pg_ts_parser_prsstart</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../port/pgstrcasecmp.c.html#LN34"><span class='Ref_to_Func'>pg_strcasecmp</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN209"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"gettoken"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="tsearchcmds.c.html#LN181"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_parser.h.html#LN53"><span class='Ref_to_Const'>Anum_pg_ts_parser_prstoken</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= 
</span>                <a href="tsearchcmds.c.html#LN63"><span class='Ref_to_Func'>get_ts_parser_func</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN209"><span class='Ref_To_Local'>defel</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/pg_ts_parser.h.html#LN53"><span class='Ref_to_Const'>Anum_pg_ts_parser_prstoken</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../port/pgstrcasecmp.c.html#LN34"><span class='Ref_to_Func'>pg_strcasecmp</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN209"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"end"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="tsearchcmds.c.html#LN181"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_parser.h.html#LN54"><span class='Ref_to_Const'>Anum_pg_ts_parser_prsend</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= 
</span>                <a href="tsearchcmds.c.html#LN63"><span class='Ref_to_Func'>get_ts_parser_func</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN209"><span class='Ref_To_Local'>defel</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/pg_ts_parser.h.html#LN54"><span class='Ref_to_Const'>Anum_pg_ts_parser_prsend</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../port/pgstrcasecmp.c.html#LN34"><span class='Ref_to_Func'>pg_strcasecmp</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN209"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"headline"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="tsearchcmds.c.html#LN181"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_parser.h.html#LN55"><span class='Ref_to_Const'>Anum_pg_ts_parser_prsheadline</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= 
</span>                <a href="tsearchcmds.c.html#LN63"><span class='Ref_to_Func'>get_ts_parser_func</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN209"><span class='Ref_To_Local'>defel</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/pg_ts_parser.h.html#LN55"><span class='Ref_to_Const'>Anum_pg_ts_parser_prsheadline</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../port/pgstrcasecmp.c.html#LN34"><span class='Ref_to_Func'>pg_strcasecmp</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN209"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"lextypes"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="tsearchcmds.c.html#LN181"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_parser.h.html#LN56"><span class='Ref_to_Const'>Anum_pg_ts_parser_prslextype</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= 
</span>                <a href="tsearchcmds.c.html#LN63"><span class='Ref_to_Func'>get_ts_parser_func</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN209"><span class='Ref_To_Local'>defel</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/pg_ts_parser.h.html#LN56"><span class='Ref_to_Const'>Anum_pg_ts_parser_prslextype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"text search parser parameter \"%s\" not recognized"</span><span class='Delimiter'>, 
</span>                        <a href="tsearchcmds.c.html#LN209"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Validation 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN505"><span class='Ref_to_Macro'>DatumGetObjectId</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN181"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_parser.h.html#LN52"><span class='Ref_to_Const'>Anum_pg_ts_parser_prsstart</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>)))</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"text search parser start method is required"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN505"><span class='Ref_to_Macro'>DatumGetObjectId</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN181"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_parser.h.html#LN53"><span class='Ref_to_Const'>Anum_pg_ts_parser_prstoken</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>)))</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"text search parser gettoken method is required"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN505"><span class='Ref_to_Macro'>DatumGetObjectId</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN181"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_parser.h.html#LN54"><span class='Ref_to_Const'>Anum_pg_ts_parser_prsend</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>)))</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"text search parser end method is required"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN505"><span class='Ref_to_Macro'>DatumGetObjectId</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN181"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_parser.h.html#LN56"><span class='Ref_to_Const'>Anum_pg_ts_parser_prslextype</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>)))</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"text search parser lextypes method is required"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Looks good, insert 
     */ 
</span>    <a href="tsearchcmds.c.html#LN179"><span class='Ref_To_Local'>prsRel</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN91"><span class='Ref_to_Proto'>heap_open</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_parser.h.html#LN30"><span class='Ref_to_Const'>TSParserRelationId</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN180"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="../access/common/heaptuple.c.html#LN690"><span class='Ref_to_Func'>heap_form_tuple</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN179"><span class='Ref_To_Local'>prsRel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN114"><span class='Ref_to_Member'>rd_att</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN181"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN182"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN184"><span class='Ref_To_Local'>prsOid</span></a> <span class='Operator'>= </span><a href="../../include/catalog/indexing.h.html#LN32"><span class='Ref_to_Proto'>CatalogTupleInsert</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN179"><span class='Ref_To_Local'>prsRel</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN180"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN186"><span class='Ref_To_Local'>address</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN126"><span class='Ref_to_Func'>makeParserDependencies</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN180"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Post creation hook for new text search parser */ 
</span>    <a href="../../include/catalog/objectaccess.h.html#LN144"><span class='Ref_to_Macro'>InvokeObjectPostCreateHook</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_parser.h.html#LN30"><span class='Ref_to_Const'>TSParserRelationId</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN184"><span class='Ref_To_Local'>prsOid</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/htup_details.h.html#LN815"><span class='Ref_to_Proto'>heap_freetuple</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN180"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN179"><span class='Ref_To_Local'>prsRel</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="tsearchcmds.c.html#LN186"><span class='Ref_To_Local'>address</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end DefineTSParser &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Guts of TS parser deletion. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN291"></a><span class='Declare_Function'>RemoveTSParserById</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>prsId</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN293"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>relation</span><span class='Delimiter'>; 
</span><a name="LN294"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tup</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN293"><span class='Ref_To_Local'>relation</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN91"><span class='Ref_to_Proto'>heap_open</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_parser.h.html#LN30"><span class='Ref_to_Const'>TSParserRelationId</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN294"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN103"><span class='Ref_to_EnumConst'>TSPARSEROID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN291"><span class='Ref_to_Parameter'>prsId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN294"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for text search parser %u"</span><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN291"><span class='Ref_to_Parameter'>prsId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/catalog/indexing.h.html#LN40"><span class='Ref_to_Proto'>CatalogTupleDelete</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN293"><span class='Ref_To_Local'>relation</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN294"><span class='Ref_To_Local'>tup</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/htup.h.html#LN64"><span class='Ref_to_Member'>t_self</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN294"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN293"><span class='Ref_To_Local'>relation</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* ---------------------- TS Dictionary commands -----------------------*/ 
</span> 
<span class='Comment_Multi_Line'>/* 
 * make pg_depend entries for a new pg_ts_dict entry 
 * 
 * Return value is address of the new entry 
 */ 
</span><span class='Keyword'>static </span><a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> 
<a name="LN318"></a><span class='Declare_Function'>makeDictionaryDependencies</span><span class='Parentheses'>(</span><a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a> <span class='Declare_Parameter'>tuple</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN320"></a>    <a href="../../include/catalog/pg_ts_dict.h.html#LN44"><span class='Ref_to_Typedef'>Form_pg_ts_dict</span></a> <span class='Declare_Local'>dict</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_dict.h.html#LN44"><span class='Ref_to_Typedef'>Form_pg_ts_dict</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN318"><span class='Ref_to_Parameter'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN321"></a>    <a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> <span class='Declare_Local'>myself</span><span class='Delimiter'>, 
</span><a name="LN322"></a>                <span class='Declare_Local'>referenced</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN321"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_ts_dict.h.html#LN30"><span class='Ref_to_Const'>TSDictionaryRelationId</span></a><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN321"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN318"><span class='Ref_to_Parameter'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN321"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on namespace */ 
</span>    <a href="tsearchcmds.c.html#LN322"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_namespace.h.html#LN33"><span class='Ref_to_Const'>NamespaceRelationId</span></a><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN322"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN320"><span class='Ref_To_Local'>dict</span></a><span class='Operator'>-&GT;</span>dictnamespace<span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN322"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../catalog/pg_depend.c.html#LN42"><span class='Ref_to_Func'>recordDependencyOn</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN321"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN322"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on owner */ 
</span>    <a href="../catalog/pg_shdepend.c.html#LN157"><span class='Ref_to_Func'>recordDependencyOnOwner</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN321"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN321"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN320"><span class='Ref_To_Local'>dict</span></a><span class='Operator'>-&GT;</span>dictowner<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on extension */ 
</span>    <a href="../catalog/pg_depend.c.html#LN137"><span class='Ref_to_Func'>recordDependencyOnCurrentExtension</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN321"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on template */ 
</span>    <a href="tsearchcmds.c.html#LN322"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_ts_template.h.html#LN30"><span class='Ref_to_Const'>TSTemplateRelationId</span></a><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN322"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN320"><span class='Ref_To_Local'>dict</span></a><span class='Operator'>-&GT;</span>dicttemplate<span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN322"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../catalog/pg_depend.c.html#LN42"><span class='Ref_to_Func'>recordDependencyOn</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN321"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN322"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="tsearchcmds.c.html#LN321"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end makeDictionaryDependencies &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * verify that a template's init method accepts a proposed option list 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN353"></a><span class='Declare_Function'>verify_dictoptions</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>tmplId</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dictoptions</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN355"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tup</span><span class='Delimiter'>; 
</span><a name="LN356"></a>    <a href="../../include/catalog/pg_ts_template.h.html#LN40"><span class='Ref_to_Typedef'>Form_pg_ts_template</span></a> <span class='Declare_Local'>tform</span><span class='Delimiter'>; 
</span><a name="LN357"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>initmethod</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Suppress this test when running in a standalone backend.  This is a 
     * hack to allow initdb to create prefab dictionaries that might not 
     * actually be usable in template1's encoding (due to using external files 
     * that can't be translated into template1's encoding).  We want to create 
     * them anyway, since they might be usable later in other databases. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../utils/init/globals.c.html#LN100"><span class='Ref_to_Global_Var'>IsUnderPostmaster</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN355"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN105"><span class='Ref_to_EnumConst'>TSTEMPLATEOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN353"><span class='Ref_to_Parameter'>tmplId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN355"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>))</span> <span class='Comment_Single_Line'>/* should not happen */ 
</span>        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for text search template %u"</span><span class='Delimiter'>, 
</span>             <a href="tsearchcmds.c.html#LN353"><span class='Ref_to_Parameter'>tmplId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN356"><span class='Ref_To_Local'>tform</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_template.h.html#LN40"><span class='Ref_to_Typedef'>Form_pg_ts_template</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN355"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN357"><span class='Ref_To_Local'>initmethod</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN356"><span class='Ref_To_Local'>tform</span></a><span class='Operator'>-&GT;</span>tmplinit<span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN357"><span class='Ref_To_Local'>initmethod</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* If there is no init method, disallow any options */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN353"><span class='Ref_to_Parameter'>dictoptions</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"text search template \"%s\" does not accept options"</span><span class='Delimiter'>, 
</span>                       <a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN356"><span class='Ref_To_Local'>tform</span></a><span class='Operator'>-&GT;</span>tmplname<span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Copy the options just in case init method thinks it can scribble on 
         * them ... 
         */ 
</span>        <a href="tsearchcmds.c.html#LN353"><span class='Ref_to_Parameter'>dictoptions</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN618"><span class='Ref_to_Macro'>copyObject</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN353"><span class='Ref_to_Parameter'>dictoptions</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Call the init method and see if it complains.  We don't worry about 
         * it leaking memory, since our command will soon be over anyway. 
         */ 
</span>        <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="../../include/fmgr.h.html#LN621"><span class='Ref_to_Macro'>OidFunctionCall1</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN357"><span class='Ref_To_Local'>initmethod</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN353"><span class='Ref_to_Parameter'>dictoptions</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN355"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end verify_dictoptions &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * CREATE TEXT SEARCH DICTIONARY 
 */ 
</span><a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> 
<a name="LN408"></a><span class='Declare_Function'>DefineTSDictionary</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>names</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>parameters</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN410"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>pl</span><span class='Delimiter'>; 
</span><a name="LN411"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>dictRel</span><span class='Delimiter'>; 
</span><a name="LN412"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tup</span><span class='Delimiter'>; 
</span><a name="LN413"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>values</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_dict.h.html#LN50"><span class='Ref_to_Const'>Natts_pg_ts_dict</span></a><span class='Delimiter'>]; 
</span><a name="LN414"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>nulls</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_dict.h.html#LN50"><span class='Ref_to_Const'>Natts_pg_ts_dict</span></a><span class='Delimiter'>]; 
</span><a name="LN415"></a>    <a href="../../include/c.h.html#LN492"><span class='Ref_to_Typedef'>NameData</span></a>    <span class='Declare_Local'>dname</span><span class='Delimiter'>; 
</span><a name="LN416"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>templId</span> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span><a name="LN417"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>dictoptions</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN418"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>dictOid</span><span class='Delimiter'>; 
</span><a name="LN419"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceoid</span><span class='Delimiter'>; 
</span><a name="LN420"></a>    <a href="../../include/utils/acl.h.html#LN169"><span class='Ref_to_Typedef'>AclResult</span></a>   <span class='Declare_Local'>aclresult</span><span class='Delimiter'>; 
</span><a name="LN421"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>dictname</span><span class='Delimiter'>; 
</span><a name="LN422"></a>    <a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> <span class='Declare_Local'>address</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Convert list of names to a name and namespace */ 
</span>    <a href="tsearchcmds.c.html#LN419"><span class='Ref_To_Local'>namespaceoid</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN118"><span class='Ref_to_Proto'>QualifiedNameGetCreationNamespace</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN408"><span class='Ref_to_Parameter'>names</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN421"><span class='Ref_To_Local'>dictname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Check we have creation rights in target namespace */ 
</span>    <a href="tsearchcmds.c.html#LN420"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>= </span><a href="../../include/utils/acl.h.html#LN289"><span class='Ref_to_Proto'>pg_namespace_aclcheck</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN419"><span class='Ref_To_Local'>namespaceoid</span></a><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN81"><span class='Ref_to_Const'>ACL_CREATE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN420"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>!= </span><a href="../../include/utils/acl.h.html#LN171"><span class='Ref_to_EnumConst'>ACLCHECK_OK</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/acl.h.html#LN295"><span class='Ref_to_Proto'>aclcheck_error</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN420"><span class='Ref_To_Local'>aclresult</span></a><span class='Delimiter'>, </span><a href="../../include/utils/acl.h.html#LN189"><span class='Ref_to_EnumConst'>ACL_KIND_NAMESPACE</span></a><span class='Delimiter'>, 
</span>                       <a href="../../include/utils/lsyscache.h.html#LN175"><span class='Ref_to_Proto'>get_namespace_name</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN419"><span class='Ref_To_Local'>namespaceoid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * loop over the definition list and extract the information we need. 
     */ 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN410"><span class='Ref_To_Local'>pl</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN408"><span class='Ref_to_Parameter'>parameters</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN438"></a>        <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>defel</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN410"><span class='Ref_To_Local'>pl</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../port/pgstrcasecmp.c.html#LN34"><span class='Ref_to_Func'>pg_strcasecmp</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN438"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"template"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="tsearchcmds.c.html#LN416"><span class='Ref_To_Local'>templId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN103"><span class='Ref_to_Proto'>get_ts_template_oid</span></a><span class='Parentheses'>(</span><a href="../../include/commands/defrem.h.html#LN161"><span class='Ref_to_Proto'>defGetQualifiedName</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN438"><span class='Ref_To_Local'>defel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Assume it's an option for the dictionary itself */ 
</span>            <a href="tsearchcmds.c.html#LN417"><span class='Ref_To_Local'>dictoptions</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN417"><span class='Ref_To_Local'>dictoptions</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN438"><span class='Ref_To_Local'>defel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Validation 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN416"><span class='Ref_To_Local'>templId</span></a><span class='Parentheses'>))</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"text search template is required"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN352"><span class='Ref_to_Func'>verify_dictoptions</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN416"><span class='Ref_To_Local'>templId</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN417"><span class='Ref_To_Local'>dictoptions</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Looks good, insert 
     */ 
</span>    memset<span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN413"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN413"><span class='Ref_To_Local'>values</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    memset<span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN414"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN414"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/builtins.h.html#LN40"><span class='Ref_to_Proto'>namestrcpy</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN415"><span class='Ref_To_Local'>dname</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN421"><span class='Ref_To_Local'>dictname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN413"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_dict.h.html#LN51"><span class='Ref_to_Const'>Anum_pg_ts_dict_dictname</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN600"><span class='Ref_to_Macro'>NameGetDatum</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN415"><span class='Ref_To_Local'>dname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN413"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_dict.h.html#LN52"><span class='Ref_to_Const'>Anum_pg_ts_dict_dictnamespace</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN419"><span class='Ref_To_Local'>namespaceoid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN413"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_dict.h.html#LN53"><span class='Ref_to_Const'>Anum_pg_ts_dict_dictowner</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>())</span><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN413"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_dict.h.html#LN54"><span class='Ref_to_Const'>Anum_pg_ts_dict_dicttemplate</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN416"><span class='Ref_To_Local'>templId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN417"><span class='Ref_To_Local'>dictoptions</span></a><span class='Parentheses'>) 
</span>        <a href="tsearchcmds.c.html#LN413"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_dict.h.html#LN55"><span class='Ref_to_Const'>Anum_pg_ts_dict_dictinitoption</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= 
</span>            <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="../../include/commands/defrem.h.html#LN122"><span class='Ref_to_Proto'>serialize_deflist</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN417"><span class='Ref_To_Local'>dictoptions</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="tsearchcmds.c.html#LN414"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_dict.h.html#LN55"><span class='Ref_to_Const'>Anum_pg_ts_dict_dictinitoption</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN411"><span class='Ref_To_Local'>dictRel</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN91"><span class='Ref_to_Proto'>heap_open</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_dict.h.html#LN30"><span class='Ref_to_Const'>TSDictionaryRelationId</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN412"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="../access/common/heaptuple.c.html#LN690"><span class='Ref_to_Func'>heap_form_tuple</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN411"><span class='Ref_To_Local'>dictRel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN114"><span class='Ref_to_Member'>rd_att</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN413"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN414"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN418"><span class='Ref_To_Local'>dictOid</span></a> <span class='Operator'>= </span><a href="../../include/catalog/indexing.h.html#LN32"><span class='Ref_to_Proto'>CatalogTupleInsert</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN411"><span class='Ref_To_Local'>dictRel</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN412"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN422"><span class='Ref_To_Local'>address</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN317"><span class='Ref_to_Func'>makeDictionaryDependencies</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN412"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Post creation hook for new text search dictionary */ 
</span>    <a href="../../include/catalog/objectaccess.h.html#LN144"><span class='Ref_to_Macro'>InvokeObjectPostCreateHook</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_dict.h.html#LN30"><span class='Ref_to_Const'>TSDictionaryRelationId</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN418"><span class='Ref_To_Local'>dictOid</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/htup_details.h.html#LN815"><span class='Ref_to_Proto'>heap_freetuple</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN412"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN411"><span class='Ref_To_Local'>dictRel</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="tsearchcmds.c.html#LN422"><span class='Ref_To_Local'>address</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end DefineTSDictionary &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Guts of TS dictionary deletion. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN500"></a><span class='Declare_Function'>RemoveTSDictionaryById</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>dictId</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN502"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>relation</span><span class='Delimiter'>; 
</span><a name="LN503"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tup</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN502"><span class='Ref_To_Local'>relation</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN91"><span class='Ref_to_Proto'>heap_open</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_dict.h.html#LN30"><span class='Ref_to_Const'>TSDictionaryRelationId</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN503"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN101"><span class='Ref_to_EnumConst'>TSDICTOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN500"><span class='Ref_to_Parameter'>dictId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN503"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for text search dictionary %u"</span><span class='Delimiter'>, 
</span>             <a href="tsearchcmds.c.html#LN500"><span class='Ref_to_Parameter'>dictId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/catalog/indexing.h.html#LN40"><span class='Ref_to_Proto'>CatalogTupleDelete</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN502"><span class='Ref_To_Local'>relation</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN503"><span class='Ref_To_Local'>tup</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/htup.h.html#LN64"><span class='Ref_to_Member'>t_self</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN503"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN502"><span class='Ref_To_Local'>relation</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end RemoveTSDictionaryById &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * ALTER TEXT SEARCH DICTIONARY 
 */ 
</span><a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> 
<a name="LN524"></a><span class='Declare_Function'>AlterTSDictionary</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN3310"><span class='Ref_to_Struct'>AlterTSDictionaryStmt</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>stmt</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN526"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tup</span><span class='Delimiter'>, 
</span><a name="LN527"></a>                <span class='Declare_Local'>newtup</span><span class='Delimiter'>; 
</span><a name="LN528"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>rel</span><span class='Delimiter'>; 
</span><a name="LN529"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>dictId</span><span class='Delimiter'>; 
</span><a name="LN530"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>pl</span><span class='Delimiter'>; 
</span><a name="LN531"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>dictoptions</span><span class='Delimiter'>; 
</span><a name="LN532"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>opt</span><span class='Delimiter'>; 
</span><a name="LN533"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>isnull</span><span class='Delimiter'>; 
</span><a name="LN534"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>repl_val</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_dict.h.html#LN50"><span class='Ref_to_Const'>Natts_pg_ts_dict</span></a><span class='Delimiter'>]; 
</span><a name="LN535"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>repl_null</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_dict.h.html#LN50"><span class='Ref_to_Const'>Natts_pg_ts_dict</span></a><span class='Delimiter'>]; 
</span><a name="LN536"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>repl_repl</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_dict.h.html#LN50"><span class='Ref_to_Const'>Natts_pg_ts_dict</span></a><span class='Delimiter'>]; 
</span><a name="LN537"></a>    <a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> <span class='Declare_Local'>address</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN529"><span class='Ref_To_Local'>dictId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN100"><span class='Ref_to_Proto'>get_ts_dict_oid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN524"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3313"><span class='Ref_to_Member'>dictname</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN528"><span class='Ref_To_Local'>rel</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN91"><span class='Ref_to_Proto'>heap_open</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_dict.h.html#LN30"><span class='Ref_to_Const'>TSDictionaryRelationId</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN526"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN101"><span class='Ref_to_EnumConst'>TSDICTOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN529"><span class='Ref_To_Local'>dictId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN526"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for text search dictionary %u"</span><span class='Delimiter'>, 
</span>             <a href="tsearchcmds.c.html#LN529"><span class='Ref_To_Local'>dictId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* must be owner */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/acl.h.html#LN321"><span class='Ref_to_Proto'>pg_ts_dict_ownercheck</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN529"><span class='Ref_To_Local'>dictId</span></a><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()))</span> 
        <a href="../../include/utils/acl.h.html#LN295"><span class='Ref_to_Proto'>aclcheck_error</span></a><span class='Parentheses'>(</span><a href="../../include/utils/acl.h.html#LN173"><span class='Ref_to_EnumConst'>ACLCHECK_NOT_OWNER</span></a><span class='Delimiter'>, </span><a href="../../include/utils/acl.h.html#LN196"><span class='Ref_to_EnumConst'>ACL_KIND_TSDICTIONARY</span></a><span class='Delimiter'>, 
</span>                       <a href="../../include/catalog/namespace.h.html#LN120"><span class='Ref_to_Proto'>NameListToString</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN524"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3313"><span class='Ref_to_Member'>dictname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* deserialize the existing set of options */ 
</span>    <a href="tsearchcmds.c.html#LN532"><span class='Ref_To_Local'>opt</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN133"><span class='Ref_to_Proto'>SysCacheGetAttr</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN101"><span class='Ref_to_EnumConst'>TSDICTOID</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN526"><span class='Ref_To_Local'>tup</span></a><span class='Delimiter'>, 
</span>                          <a href="../../include/catalog/pg_ts_dict.h.html#LN55"><span class='Ref_to_Const'>Anum_pg_ts_dict_dictinitoption</span></a><span class='Delimiter'>, 
</span>                          <span class='Operator'>&</span><a href="tsearchcmds.c.html#LN533"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN533"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>) 
</span>        <a href="tsearchcmds.c.html#LN531"><span class='Ref_To_Local'>dictoptions</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="tsearchcmds.c.html#LN531"><span class='Ref_To_Local'>dictoptions</span></a> <span class='Operator'>= </span><a href="../../include/commands/defrem.h.html#LN123"><span class='Ref_to_Proto'>deserialize_deflist</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN532"><span class='Ref_To_Local'>opt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Modify the options list as per specified changes 
     */ 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN530"><span class='Ref_To_Local'>pl</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN524"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3314"><span class='Ref_to_Member'>options</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN568"></a>        <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>defel</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN530"><span class='Ref_To_Local'>pl</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN569"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>cell</span><span class='Delimiter'>; 
</span><a name="LN570"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>prev</span><span class='Delimiter'>; 
</span><a name="LN571"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>next</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Remove any matches ... 
         */ 
</span>        <a href="tsearchcmds.c.html#LN570"><span class='Ref_To_Local'>prev</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN569"><span class='Ref_To_Local'>cell</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN75"><span class='Ref_to_Func'>list_head</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN531"><span class='Ref_To_Local'>dictoptions</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="tsearchcmds.c.html#LN569"><span class='Ref_To_Local'>cell</span></a><span class='Delimiter'>; </span><a href="tsearchcmds.c.html#LN569"><span class='Ref_To_Local'>cell</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN571"><span class='Ref_To_Local'>next</span></a><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span><a name="LN579"></a>            <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>oldel</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN569"><span class='Ref_To_Local'>cell</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="tsearchcmds.c.html#LN571"><span class='Ref_To_Local'>next</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN104"><span class='Ref_to_Macro'>lnext</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN569"><span class='Ref_To_Local'>cell</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../port/pgstrcasecmp.c.html#LN34"><span class='Ref_to_Func'>pg_strcasecmp</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN579"><span class='Ref_To_Local'>oldel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN568"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <a href="tsearchcmds.c.html#LN531"><span class='Ref_To_Local'>dictoptions</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN238"><span class='Ref_to_Proto'>list_delete_cell</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN531"><span class='Ref_To_Local'>dictoptions</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN569"><span class='Ref_To_Local'>cell</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN570"><span class='Ref_To_Local'>prev</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="tsearchcmds.c.html#LN570"><span class='Ref_To_Local'>prev</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN569"><span class='Ref_To_Local'>cell</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * and add new value if it's got one 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN568"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN720"><span class='Ref_to_Member'>arg</span></a><span class='Parentheses'>) 
</span>            <a href="tsearchcmds.c.html#LN531"><span class='Ref_To_Local'>dictoptions</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN531"><span class='Ref_To_Local'>dictoptions</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN568"><span class='Ref_To_Local'>defel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Validate 
     */ 
</span>    <a href="tsearchcmds.c.html#LN352"><span class='Ref_to_Func'>verify_dictoptions</span></a><span class='Parentheses'>(((</span><a href="../../include/catalog/pg_ts_dict.h.html#LN44"><span class='Ref_to_Typedef'>Form_pg_ts_dict</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN526"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>dicttemplate<span class='Delimiter'>, 
</span>                       <a href="tsearchcmds.c.html#LN531"><span class='Ref_To_Local'>dictoptions</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Looks good, update 
     */ 
</span>    memset<span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN534"><span class='Ref_To_Local'>repl_val</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN534"><span class='Ref_To_Local'>repl_val</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    memset<span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN535"><span class='Ref_To_Local'>repl_null</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN535"><span class='Ref_To_Local'>repl_null</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    memset<span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN536"><span class='Ref_To_Local'>repl_repl</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN536"><span class='Ref_To_Local'>repl_repl</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN531"><span class='Ref_To_Local'>dictoptions</span></a><span class='Parentheses'>) 
</span>        <a href="tsearchcmds.c.html#LN534"><span class='Ref_To_Local'>repl_val</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_dict.h.html#LN55"><span class='Ref_to_Const'>Anum_pg_ts_dict_dictinitoption</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= 
</span>            <a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="../../include/commands/defrem.h.html#LN122"><span class='Ref_to_Proto'>serialize_deflist</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN531"><span class='Ref_To_Local'>dictoptions</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="tsearchcmds.c.html#LN535"><span class='Ref_To_Local'>repl_null</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_dict.h.html#LN55"><span class='Ref_to_Const'>Anum_pg_ts_dict_dictinitoption</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN536"><span class='Ref_To_Local'>repl_repl</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_dict.h.html#LN55"><span class='Ref_to_Const'>Anum_pg_ts_dict_dictinitoption</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN527"><span class='Ref_To_Local'>newtup</span></a> <span class='Operator'>= </span><a href="../access/common/heaptuple.c.html#LN789"><span class='Ref_to_Func'>heap_modify_tuple</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN526"><span class='Ref_To_Local'>tup</span></a><span class='Delimiter'>, </span><a href="../../include/utils/rel.h.html#LN428"><span class='Ref_to_Macro'>RelationGetDescr</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN528"><span class='Ref_To_Local'>rel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                               <a href="tsearchcmds.c.html#LN534"><span class='Ref_To_Local'>repl_val</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN535"><span class='Ref_To_Local'>repl_null</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN536"><span class='Ref_To_Local'>repl_repl</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/catalog/indexing.h.html#LN35"><span class='Ref_to_Proto'>CatalogTupleUpdate</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN528"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN527"><span class='Ref_To_Local'>newtup</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/htup.h.html#LN64"><span class='Ref_to_Member'>t_self</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN527"><span class='Ref_To_Local'>newtup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/catalog/objectaccess.h.html#LN162"><span class='Ref_to_Macro'>InvokeObjectPostAlterHook</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_dict.h.html#LN30"><span class='Ref_to_Const'>TSDictionaryRelationId</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN529"><span class='Ref_To_Local'>dictId</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/catalog/objectaddress.h.html#LN39"><span class='Ref_to_Macro'>ObjectAddressSet</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN537"><span class='Ref_To_Local'>address</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/pg_ts_dict.h.html#LN30"><span class='Ref_to_Const'>TSDictionaryRelationId</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN529"><span class='Ref_To_Local'>dictId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * NOTE: because we only support altering the options, not the template, 
     * there is no need to update dependencies.  This might have to change if 
     * the options ever reference inside-the-database objects. 
     */ 
</span> 
    <a href="../../include/access/htup_details.h.html#LN815"><span class='Ref_to_Proto'>heap_freetuple</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN527"><span class='Ref_To_Local'>newtup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN526"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN528"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="tsearchcmds.c.html#LN537"><span class='Ref_To_Local'>address</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end AlterTSDictionary &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* ---------------------- TS Template commands -----------------------*/ 
</span> 
<span class='Comment_Multi_Line'>/* 
 * lookup a template support function and return its OID (as a Datum) 
 * 
 * attnum is the pg_ts_template column the function will go into 
 */ 
</span><span class='Keyword'>static </span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN646"></a><span class='Declare_Function'>get_ts_template_func</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>defel</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>attnum</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN648"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>funcName</span> <span class='Operator'>= </span><a href="../../include/commands/defrem.h.html#LN161"><span class='Ref_to_Proto'>defGetQualifiedName</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN646"><span class='Ref_to_Parameter'>defel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN649"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>typeId</span><span class='Delimiter'>[</span><span class='Number'>4</span><span class='Delimiter'>]; 
</span><a name="LN650"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>retTypeId</span><span class='Delimiter'>; 
</span><a name="LN651"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>nargs</span><span class='Delimiter'>; 
</span><a name="LN652"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>procOid</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN650"><span class='Ref_To_Local'>retTypeId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_type.h.html#LN697"><span class='Ref_to_Const'>INTERNALOID</span></a><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN649"><span class='Ref_To_Local'>typeId</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/catalog/pg_type.h.html#LN697"><span class='Ref_to_Const'>INTERNALOID</span></a><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN649"><span class='Ref_To_Local'>typeId</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/catalog/pg_type.h.html#LN697"><span class='Ref_to_Const'>INTERNALOID</span></a><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN649"><span class='Ref_To_Local'>typeId</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/catalog/pg_type.h.html#LN697"><span class='Ref_to_Const'>INTERNALOID</span></a><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN649"><span class='Ref_To_Local'>typeId</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/catalog/pg_type.h.html#LN697"><span class='Ref_to_Const'>INTERNALOID</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN646"><span class='Ref_to_Parameter'>attnum</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../include/catalog/pg_ts_template.h.html#LN49"><span class='Ref_to_Const'>Anum_pg_ts_template_tmplinit</span></a><span class='Operator'>: 
</span>            <a href="tsearchcmds.c.html#LN651"><span class='Ref_To_Local'>nargs</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/catalog/pg_ts_template.h.html#LN50"><span class='Ref_to_Const'>Anum_pg_ts_template_tmpllexize</span></a><span class='Operator'>: 
</span>            <a href="tsearchcmds.c.html#LN651"><span class='Ref_To_Local'>nargs</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <span class='Comment_Multi_Line'>/* should not be here */ 
</span>            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized attribute for text search template: %d"</span><span class='Delimiter'>, 
</span>                 <a href="tsearchcmds.c.html#LN646"><span class='Ref_to_Parameter'>attnum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="tsearchcmds.c.html#LN651"><span class='Ref_To_Local'>nargs</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>;</span>          <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="tsearchcmds.c.html#LN652"><span class='Ref_To_Local'>procOid</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_func.h.html#LN62"><span class='Ref_to_Proto'>LookupFuncName</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN648"><span class='Ref_To_Local'>funcName</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN651"><span class='Ref_To_Local'>nargs</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN649"><span class='Ref_To_Local'>typeId</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/utils/lsyscache.h.html#LN112"><span class='Ref_to_Proto'>get_func_rettype</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN652"><span class='Ref_To_Local'>procOid</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="tsearchcmds.c.html#LN650"><span class='Ref_To_Local'>retTypeId</span></a><span class='Parentheses'>)</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"function %s should return type %s"</span><span class='Delimiter'>, 
</span>                        <a href="../../include/parser/parse_func.h.html#LN59"><span class='Ref_to_Proto'>func_signature_string</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN648"><span class='Ref_To_Local'>funcName</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN651"><span class='Ref_To_Local'>nargs</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN649"><span class='Ref_To_Local'>typeId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                        <a href="../utils/adt/format_type.c.html#LN92"><span class='Ref_to_Func'>format_type_be</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN650"><span class='Ref_To_Local'>retTypeId</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN652"><span class='Ref_To_Local'>procOid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end get_ts_template_func &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * make pg_depend entries for a new pg_ts_template entry 
 */ 
</span><span class='Keyword'>static </span><a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> 
<a name="LN689"></a><span class='Declare_Function'>makeTSTemplateDependencies</span><span class='Parentheses'>(</span><a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a> <span class='Declare_Parameter'>tuple</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN691"></a>    <a href="../../include/catalog/pg_ts_template.h.html#LN40"><span class='Ref_to_Typedef'>Form_pg_ts_template</span></a> <span class='Declare_Local'>tmpl</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_template.h.html#LN40"><span class='Ref_to_Typedef'>Form_pg_ts_template</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN689"><span class='Ref_to_Parameter'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN692"></a>    <a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> <span class='Declare_Local'>myself</span><span class='Delimiter'>, 
</span><a name="LN693"></a>                <span class='Declare_Local'>referenced</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN692"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_ts_template.h.html#LN30"><span class='Ref_to_Const'>TSTemplateRelationId</span></a><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN692"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN689"><span class='Ref_to_Parameter'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN692"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on namespace */ 
</span>    <a href="tsearchcmds.c.html#LN693"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_namespace.h.html#LN33"><span class='Ref_to_Const'>NamespaceRelationId</span></a><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN693"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN691"><span class='Ref_To_Local'>tmpl</span></a><span class='Operator'>-&GT;</span>tmplnamespace<span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN693"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../catalog/pg_depend.c.html#LN42"><span class='Ref_to_Func'>recordDependencyOn</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN692"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN693"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on extension */ 
</span>    <a href="../catalog/pg_depend.c.html#LN137"><span class='Ref_to_Func'>recordDependencyOnCurrentExtension</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN692"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependencies on functions */ 
</span>    <a href="tsearchcmds.c.html#LN693"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_proc.h.html#LN32"><span class='Ref_to_Const'>ProcedureRelationId</span></a><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN693"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN693"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN691"><span class='Ref_To_Local'>tmpl</span></a><span class='Operator'>-&GT;</span>tmpllexize<span class='Delimiter'>; 
</span>    <a href="../catalog/pg_depend.c.html#LN42"><span class='Ref_to_Func'>recordDependencyOn</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN692"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN693"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN691"><span class='Ref_To_Local'>tmpl</span></a><span class='Operator'>-&GT;</span>tmplinit<span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="tsearchcmds.c.html#LN693"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN691"><span class='Ref_To_Local'>tmpl</span></a><span class='Operator'>-&GT;</span>tmplinit<span class='Delimiter'>; 
</span>        <a href="../catalog/pg_depend.c.html#LN42"><span class='Ref_to_Func'>recordDependencyOn</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN692"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN693"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="tsearchcmds.c.html#LN692"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end makeTSTemplateDependencies &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * CREATE TEXT SEARCH TEMPLATE 
 */ 
</span><a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> 
<a name="LN728"></a><span class='Declare_Function'>DefineTSTemplate</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>names</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>parameters</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN730"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>pl</span><span class='Delimiter'>; 
</span><a name="LN731"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>tmplRel</span><span class='Delimiter'>; 
</span><a name="LN732"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tup</span><span class='Delimiter'>; 
</span><a name="LN733"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>values</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_template.h.html#LN46"><span class='Ref_to_Const'>Natts_pg_ts_template</span></a><span class='Delimiter'>]; 
</span><a name="LN734"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>nulls</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_template.h.html#LN46"><span class='Ref_to_Const'>Natts_pg_ts_template</span></a><span class='Delimiter'>]; 
</span><a name="LN735"></a>    <a href="../../include/c.h.html#LN492"><span class='Ref_to_Typedef'>NameData</span></a>    <span class='Declare_Local'>dname</span><span class='Delimiter'>; 
</span><a name="LN736"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN737"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>tmplOid</span><span class='Delimiter'>; 
</span><a name="LN738"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceoid</span><span class='Delimiter'>; 
</span><a name="LN739"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>tmplname</span><span class='Delimiter'>; 
</span><a name="LN740"></a>    <a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> <span class='Declare_Local'>address</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../utils/misc/superuser.c.html#LN45"><span class='Ref_to_Func'>superuser</span></a><span class='Parentheses'>())</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INSUFFICIENT_PRIVILEGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>               <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"must be superuser to create text search templates"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Convert list of names to a name and namespace */ 
</span>    <a href="tsearchcmds.c.html#LN738"><span class='Ref_To_Local'>namespaceoid</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN118"><span class='Ref_to_Proto'>QualifiedNameGetCreationNamespace</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN728"><span class='Ref_to_Parameter'>names</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN739"><span class='Ref_To_Local'>tmplname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN736"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="tsearchcmds.c.html#LN736"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="../../include/catalog/pg_ts_template.h.html#LN46"><span class='Ref_to_Const'>Natts_pg_ts_template</span></a><span class='Delimiter'>; </span><a href="tsearchcmds.c.html#LN736"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="tsearchcmds.c.html#LN734"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><a href="tsearchcmds.c.html#LN736"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="tsearchcmds.c.html#LN733"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="tsearchcmds.c.html#LN736"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../include/utils/builtins.h.html#LN40"><span class='Ref_to_Proto'>namestrcpy</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN735"><span class='Ref_To_Local'>dname</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN739"><span class='Ref_To_Local'>tmplname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN733"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_template.h.html#LN47"><span class='Ref_to_Const'>Anum_pg_ts_template_tmplname</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN600"><span class='Ref_to_Macro'>NameGetDatum</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN735"><span class='Ref_To_Local'>dname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN733"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_template.h.html#LN48"><span class='Ref_to_Const'>Anum_pg_ts_template_tmplnamespace</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN738"><span class='Ref_To_Local'>namespaceoid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * loop over the definition list and extract the information we need. 
     */ 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN730"><span class='Ref_To_Local'>pl</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN728"><span class='Ref_to_Parameter'>parameters</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN765"></a>        <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>defel</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN730"><span class='Ref_To_Local'>pl</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../port/pgstrcasecmp.c.html#LN34"><span class='Ref_to_Func'>pg_strcasecmp</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN765"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"init"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="tsearchcmds.c.html#LN733"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_template.h.html#LN49"><span class='Ref_to_Const'>Anum_pg_ts_template_tmplinit</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= 
</span>                <a href="tsearchcmds.c.html#LN645"><span class='Ref_to_Func'>get_ts_template_func</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN765"><span class='Ref_To_Local'>defel</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/pg_ts_template.h.html#LN49"><span class='Ref_to_Const'>Anum_pg_ts_template_tmplinit</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="tsearchcmds.c.html#LN734"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_template.h.html#LN49"><span class='Ref_to_Const'>Anum_pg_ts_template_tmplinit</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../port/pgstrcasecmp.c.html#LN34"><span class='Ref_to_Func'>pg_strcasecmp</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN765"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"lexize"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="tsearchcmds.c.html#LN733"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_template.h.html#LN50"><span class='Ref_to_Const'>Anum_pg_ts_template_tmpllexize</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= 
</span>                <a href="tsearchcmds.c.html#LN645"><span class='Ref_to_Func'>get_ts_template_func</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN765"><span class='Ref_To_Local'>defel</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/pg_ts_template.h.html#LN50"><span class='Ref_to_Const'>Anum_pg_ts_template_tmpllexize</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="tsearchcmds.c.html#LN734"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_template.h.html#LN50"><span class='Ref_to_Const'>Anum_pg_ts_template_tmpllexize</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>               <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"text search template parameter \"%s\" not recognized"</span><span class='Delimiter'>, 
</span>                      <a href="tsearchcmds.c.html#LN765"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Validation 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN505"><span class='Ref_to_Macro'>DatumGetObjectId</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN733"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_template.h.html#LN50"><span class='Ref_to_Const'>Anum_pg_ts_template_tmpllexize</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>)))</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"text search template lexize method is required"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Looks good, insert 
     */ 
</span> 
    <a href="tsearchcmds.c.html#LN731"><span class='Ref_To_Local'>tmplRel</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN91"><span class='Ref_to_Proto'>heap_open</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_template.h.html#LN30"><span class='Ref_to_Const'>TSTemplateRelationId</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN732"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="../access/common/heaptuple.c.html#LN690"><span class='Ref_to_Func'>heap_form_tuple</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN731"><span class='Ref_To_Local'>tmplRel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN114"><span class='Ref_to_Member'>rd_att</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN733"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN734"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN737"><span class='Ref_To_Local'>tmplOid</span></a> <span class='Operator'>= </span><a href="../../include/catalog/indexing.h.html#LN32"><span class='Ref_to_Proto'>CatalogTupleInsert</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN731"><span class='Ref_To_Local'>tmplRel</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN732"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN740"><span class='Ref_To_Local'>address</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN688"><span class='Ref_to_Func'>makeTSTemplateDependencies</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN732"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Post creation hook for new text search template */ 
</span>    <a href="../../include/catalog/objectaccess.h.html#LN144"><span class='Ref_to_Macro'>InvokeObjectPostCreateHook</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_template.h.html#LN30"><span class='Ref_to_Const'>TSTemplateRelationId</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN737"><span class='Ref_To_Local'>tmplOid</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/htup_details.h.html#LN815"><span class='Ref_to_Proto'>heap_freetuple</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN732"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN731"><span class='Ref_To_Local'>tmplRel</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="tsearchcmds.c.html#LN740"><span class='Ref_To_Local'>address</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end DefineTSTemplate &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Guts of TS template deletion. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN820"></a><span class='Declare_Function'>RemoveTSTemplateById</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>tmplId</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN822"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>relation</span><span class='Delimiter'>; 
</span><a name="LN823"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tup</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN822"><span class='Ref_To_Local'>relation</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN91"><span class='Ref_to_Proto'>heap_open</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_template.h.html#LN30"><span class='Ref_to_Const'>TSTemplateRelationId</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN823"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN105"><span class='Ref_to_EnumConst'>TSTEMPLATEOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN820"><span class='Ref_to_Parameter'>tmplId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN823"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for text search template %u"</span><span class='Delimiter'>, 
</span>             <a href="tsearchcmds.c.html#LN820"><span class='Ref_to_Parameter'>tmplId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/catalog/indexing.h.html#LN40"><span class='Ref_to_Proto'>CatalogTupleDelete</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN822"><span class='Ref_To_Local'>relation</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN823"><span class='Ref_To_Local'>tup</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/htup.h.html#LN64"><span class='Ref_to_Member'>t_self</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN823"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN822"><span class='Ref_To_Local'>relation</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end RemoveTSTemplateById &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* ---------------------- TS Configuration commands -----------------------*/ 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Finds syscache tuple of configuration. 
 * Returns NULL if no such cfg. 
 */ 
</span><span class='Keyword'>static </span><a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a> 
<a name="LN847"></a><span class='Declare_Function'>GetTSConfigTuple</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>names</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN849"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tup</span><span class='Delimiter'>; 
</span><a name="LN850"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>cfgId</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN850"><span class='Ref_To_Local'>cfgId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN106"><span class='Ref_to_Proto'>get_ts_config_oid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN847"><span class='Ref_to_Parameter'>names</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN850"><span class='Ref_To_Local'>cfgId</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN849"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN99"><span class='Ref_to_EnumConst'>TSCONFIGOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN850"><span class='Ref_To_Local'>cfgId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN849"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>))</span> <span class='Comment_Single_Line'>/* should not happen */ 
</span>        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for text search configuration %u"</span><span class='Delimiter'>, 
</span>             <a href="tsearchcmds.c.html#LN850"><span class='Ref_To_Local'>cfgId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="tsearchcmds.c.html#LN849"><span class='Ref_To_Local'>tup</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * make pg_depend entries for a new or updated pg_ts_config entry 
 * 
 * Pass opened pg_ts_config_map relation if there might be any config map 
 * entries for the config. 
 */ 
</span><span class='Keyword'>static </span><a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> 
<a name="LN872"></a><span class='Declare_Function'>makeConfigurationDependencies</span><span class='Parentheses'>(</span><a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a> <span class='Declare_Parameter'>tuple</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>removeOld</span><span class='Delimiter'>, 
</span><a name="LN873"></a>                              <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a> <span class='Declare_Parameter'>mapRel</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN875"></a>    <a href="../../include/catalog/pg_ts_config.h.html#LN40"><span class='Ref_to_Typedef'>Form_pg_ts_config</span></a> <span class='Declare_Local'>cfg</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_config.h.html#LN40"><span class='Ref_to_Typedef'>Form_pg_ts_config</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN872"><span class='Ref_to_Parameter'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN876"></a>    <a href="../catalog/dependency.c.html#LN108"><span class='Ref_to_Struct'>ObjectAddresses</span></a> <span class='Operator'>*</span><span class='Declare_Local'>addrs</span><span class='Delimiter'>; 
</span><a name="LN877"></a>    <a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> <span class='Declare_Local'>myself</span><span class='Delimiter'>, 
</span><a name="LN878"></a>                <span class='Declare_Local'>referenced</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN877"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_ts_config.h.html#LN30"><span class='Ref_to_Const'>TSConfigRelationId</span></a><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN877"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN872"><span class='Ref_to_Parameter'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN877"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* for ALTER case, first flush old dependencies, except extension deps */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN872"><span class='Ref_to_Parameter'>removeOld</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="../catalog/pg_depend.c.html#LN189"><span class='Ref_to_Func'>deleteDependencyRecordsFor</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN877"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN877"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../include/catalog/dependency.h.html#LN254"><span class='Ref_to_Proto'>deleteSharedDependencyRecordsFor</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN877"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN877"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We use an ObjectAddresses list to remove possible duplicate 
     * dependencies from the config map info.  The pg_ts_config items 
     * shouldn't be duplicates, but might as well fold them all into one call. 
     */ 
</span>    <a href="tsearchcmds.c.html#LN876"><span class='Ref_To_Local'>addrs</span></a> <span class='Operator'>= </span><a href="../../include/catalog/dependency.h.html#LN200"><span class='Ref_to_Proto'>new_object_addresses</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on namespace */ 
</span>    <a href="tsearchcmds.c.html#LN878"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_namespace.h.html#LN33"><span class='Ref_to_Const'>NamespaceRelationId</span></a><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN878"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN875"><span class='Ref_To_Local'>cfg</span></a><span class='Operator'>-&GT;</span>cfgnamespace<span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN878"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../../include/catalog/dependency.h.html#LN202"><span class='Ref_to_Proto'>add_exact_object_address</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN878"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN876"><span class='Ref_To_Local'>addrs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on owner */ 
</span>    <a href="../catalog/pg_shdepend.c.html#LN157"><span class='Ref_to_Func'>recordDependencyOnOwner</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN877"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN877"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN875"><span class='Ref_To_Local'>cfg</span></a><span class='Operator'>-&GT;</span>cfgowner<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on extension */ 
</span>    <a href="../catalog/pg_depend.c.html#LN137"><span class='Ref_to_Func'>recordDependencyOnCurrentExtension</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN877"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN872"><span class='Ref_to_Parameter'>removeOld</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependency on parser */ 
</span>    <a href="tsearchcmds.c.html#LN878"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_ts_parser.h.html#LN30"><span class='Ref_to_Const'>TSParserRelationId</span></a><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN878"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN875"><span class='Ref_To_Local'>cfg</span></a><span class='Operator'>-&GT;</span>cfgparser<span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN878"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../../include/catalog/dependency.h.html#LN202"><span class='Ref_to_Proto'>add_exact_object_address</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN878"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN876"><span class='Ref_To_Local'>addrs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* dependencies on dictionaries listed in config map */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN873"><span class='Ref_to_Parameter'>mapRel</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN919"></a>        <a href="../../include/access/skey.h.html#LN63"><span class='Ref_to_Struct'>ScanKeyData</span></a> <span class='Declare_Local'>skey</span><span class='Delimiter'>; 
</span><a name="LN920"></a>        <a href="../../include/access/genam.h.html#LN86"><span class='Ref_to_Typedef'>SysScanDesc</span></a> <span class='Declare_Local'>scan</span><span class='Delimiter'>; 
</span><a name="LN921"></a>        <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>maptup</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* CCI to ensure we can see effects of caller's changes */ 
</span>        <a href="../../include/access/xact.h.html#LN346"><span class='Ref_to_Proto'>CommandCounterIncrement</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
        <a href="../access/common/scankey.c.html#LN74"><span class='Ref_to_Func'>ScanKeyInit</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN919"><span class='Ref_To_Local'>skey</span></a><span class='Delimiter'>, 
</span>                    <a href="../../include/catalog/pg_ts_config_map.h.html#LN47"><span class='Ref_to_Const'>Anum_pg_ts_config_map_mapcfg</span></a><span class='Delimiter'>, 
</span>                    <a href="../../include/access/stratnum.h.html#LN30"><span class='Ref_to_Const'>BTEqualStrategyNumber</span></a><span class='Delimiter'>, </span>F_OIDEQ<span class='Delimiter'>, 
</span>                    <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN877"><span class='Ref_To_Local'>myself</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <a href="tsearchcmds.c.html#LN920"><span class='Ref_To_Local'>scan</span></a> <span class='Operator'>= </span><a href="../../include/access/genam.h.html#LN189"><span class='Ref_to_Proto'>systable_beginscan</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN873"><span class='Ref_to_Parameter'>mapRel</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/indexing.h.html#LN263"><span class='Ref_to_Const'>TSConfigMapIndexId</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, 
</span>                                  <span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN919"><span class='Ref_To_Local'>skey</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>((</span><a href="tsearchcmds.c.html#LN921"><span class='Ref_To_Local'>maptup</span></a> <span class='Operator'>= </span><a href="../../include/access/genam.h.html#LN194"><span class='Ref_to_Proto'>systable_getnext</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN920"><span class='Ref_To_Local'>scan</span></a><span class='Parentheses'>))))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN936"></a>            <a href="../../include/catalog/pg_ts_config_map.h.html#LN40"><span class='Ref_to_Typedef'>Form_pg_ts_config_map</span></a> <span class='Declare_Local'>cfgmap</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_config_map.h.html#LN40"><span class='Ref_to_Typedef'>Form_pg_ts_config_map</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN921"><span class='Ref_To_Local'>maptup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="tsearchcmds.c.html#LN878"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN25"><span class='Ref_to_Member'>classId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/pg_ts_dict.h.html#LN30"><span class='Ref_to_Const'>TSDictionaryRelationId</span></a><span class='Delimiter'>; 
</span>            <a href="tsearchcmds.c.html#LN878"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN26"><span class='Ref_to_Member'>objectId</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN936"><span class='Ref_To_Local'>cfgmap</span></a><span class='Operator'>-&GT;</span>mapdict<span class='Delimiter'>; 
</span>            <a href="tsearchcmds.c.html#LN878"><span class='Ref_To_Local'>referenced</span></a><span class='Operator'>.</span><a href="../../include/catalog/objectaddress.h.html#LN27"><span class='Ref_to_Member'>objectSubId</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <a href="../../include/catalog/dependency.h.html#LN202"><span class='Ref_to_Proto'>add_exact_object_address</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN878"><span class='Ref_To_Local'>referenced</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN876"><span class='Ref_To_Local'>addrs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="../../include/access/genam.h.html#LN196"><span class='Ref_to_Proto'>systable_endscan</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN920"><span class='Ref_To_Local'>scan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if mapRel &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Record 'em (this includes duplicate elimination) */ 
</span>    <a href="../../include/catalog/dependency.h.html#LN208"><span class='Ref_to_Proto'>record_object_address_dependencies</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN877"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN876"><span class='Ref_To_Local'>addrs</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/dependency.h.html#LN74"><span class='Ref_to_EnumConst'>DEPENDENCY_NORMAL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/catalog/dependency.h.html#LN212"><span class='Ref_to_Proto'>free_object_addresses</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN876"><span class='Ref_To_Local'>addrs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="tsearchcmds.c.html#LN877"><span class='Ref_To_Local'>myself</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end makeConfigurationDependencies &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * CREATE TEXT SEARCH CONFIGURATION 
 */ 
</span><a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> 
<a name="LN959"></a><span class='Declare_Function'>DefineTSConfiguration</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>names</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>parameters</span><span class='Delimiter'>, </span><a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>copied</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN961"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>cfgRel</span><span class='Delimiter'>; 
</span><a name="LN962"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>mapRel</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN963"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tup</span><span class='Delimiter'>; 
</span><a name="LN964"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>values</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_config.h.html#LN46"><span class='Ref_to_Const'>Natts_pg_ts_config</span></a><span class='Delimiter'>]; 
</span><a name="LN965"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>nulls</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_config.h.html#LN46"><span class='Ref_to_Const'>Natts_pg_ts_config</span></a><span class='Delimiter'>]; 
</span><a name="LN966"></a>    <a href="../../include/utils/acl.h.html#LN169"><span class='Ref_to_Typedef'>AclResult</span></a>   <span class='Declare_Local'>aclresult</span><span class='Delimiter'>; 
</span><a name="LN967"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceoid</span><span class='Delimiter'>; 
</span><a name="LN968"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>cfgname</span><span class='Delimiter'>; 
</span><a name="LN969"></a>    <a href="../../include/c.h.html#LN492"><span class='Ref_to_Typedef'>NameData</span></a>    <span class='Declare_Local'>cname</span><span class='Delimiter'>; 
</span><a name="LN970"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>sourceOid</span> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span><a name="LN971"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>prsOid</span> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span><a name="LN972"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>cfgOid</span><span class='Delimiter'>; 
</span><a name="LN973"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>pl</span><span class='Delimiter'>; 
</span><a name="LN974"></a>    <a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> <span class='Declare_Local'>address</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Convert list of names to a name and namespace */ 
</span>    <a href="tsearchcmds.c.html#LN967"><span class='Ref_To_Local'>namespaceoid</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN118"><span class='Ref_to_Proto'>QualifiedNameGetCreationNamespace</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN959"><span class='Ref_to_Parameter'>names</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN968"><span class='Ref_To_Local'>cfgname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Check we have creation rights in target namespace */ 
</span>    <a href="tsearchcmds.c.html#LN966"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>= </span><a href="../../include/utils/acl.h.html#LN289"><span class='Ref_to_Proto'>pg_namespace_aclcheck</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN967"><span class='Ref_To_Local'>namespaceoid</span></a><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN81"><span class='Ref_to_Const'>ACL_CREATE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN966"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>!= </span><a href="../../include/utils/acl.h.html#LN171"><span class='Ref_to_EnumConst'>ACLCHECK_OK</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/acl.h.html#LN295"><span class='Ref_to_Proto'>aclcheck_error</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN966"><span class='Ref_To_Local'>aclresult</span></a><span class='Delimiter'>, </span><a href="../../include/utils/acl.h.html#LN189"><span class='Ref_to_EnumConst'>ACL_KIND_NAMESPACE</span></a><span class='Delimiter'>, 
</span>                       <a href="../../include/utils/lsyscache.h.html#LN175"><span class='Ref_to_Proto'>get_namespace_name</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN967"><span class='Ref_To_Local'>namespaceoid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * loop over the definition list and extract the information we need. 
     */ 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN973"><span class='Ref_To_Local'>pl</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN959"><span class='Ref_to_Parameter'>parameters</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN990"></a>        <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>defel</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN973"><span class='Ref_To_Local'>pl</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../port/pgstrcasecmp.c.html#LN34"><span class='Ref_to_Func'>pg_strcasecmp</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN990"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"parser"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="tsearchcmds.c.html#LN971"><span class='Ref_To_Local'>prsOid</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN97"><span class='Ref_to_Proto'>get_ts_parser_oid</span></a><span class='Parentheses'>(</span><a href="../../include/commands/defrem.h.html#LN161"><span class='Ref_to_Proto'>defGetQualifiedName</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN990"><span class='Ref_To_Local'>defel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../port/pgstrcasecmp.c.html#LN34"><span class='Ref_to_Func'>pg_strcasecmp</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN990"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"copy"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="tsearchcmds.c.html#LN970"><span class='Ref_To_Local'>sourceOid</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN106"><span class='Ref_to_Proto'>get_ts_config_oid</span></a><span class='Parentheses'>(</span><a href="../../include/commands/defrem.h.html#LN161"><span class='Ref_to_Proto'>defGetQualifiedName</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN990"><span class='Ref_To_Local'>defel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"text search configuration parameter \"%s\" not recognized"</span><span class='Delimiter'>, 
</span>                            <a href="tsearchcmds.c.html#LN990"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN970"><span class='Ref_To_Local'>sourceOid</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN971"><span class='Ref_To_Local'>prsOid</span></a><span class='Parentheses'>))</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot specify both PARSER and COPY options"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* make copied tsconfig available to callers */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN959"><span class='Ref_to_Parameter'>copied</span></a> <span class='Operator'>&& </span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN970"><span class='Ref_To_Local'>sourceOid</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../include/catalog/objectaddress.h.html#LN39"><span class='Ref_to_Macro'>ObjectAddressSet</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="tsearchcmds.c.html#LN959"><span class='Ref_to_Parameter'>copied</span></a><span class='Delimiter'>, 
</span>                         <a href="../../include/catalog/pg_ts_config.h.html#LN30"><span class='Ref_to_Const'>TSConfigRelationId</span></a><span class='Delimiter'>, 
</span>                         <a href="tsearchcmds.c.html#LN970"><span class='Ref_To_Local'>sourceOid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Look up source config if given. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN970"><span class='Ref_To_Local'>sourceOid</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1021"></a>        <a href="../../include/catalog/pg_ts_config.h.html#LN40"><span class='Ref_to_Typedef'>Form_pg_ts_config</span></a> <span class='Declare_Local'>cfg</span><span class='Delimiter'>; 
</span> 
        <a href="tsearchcmds.c.html#LN963"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN99"><span class='Ref_to_EnumConst'>TSCONFIGOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN970"><span class='Ref_To_Local'>sourceOid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN963"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>))</span> 
            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for text search configuration %u"</span><span class='Delimiter'>, 
</span>                 <a href="tsearchcmds.c.html#LN970"><span class='Ref_To_Local'>sourceOid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="tsearchcmds.c.html#LN1021"><span class='Ref_To_Local'>cfg</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_config.h.html#LN40"><span class='Ref_to_Typedef'>Form_pg_ts_config</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN963"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* use source's parser */ 
</span>        <a href="tsearchcmds.c.html#LN971"><span class='Ref_To_Local'>prsOid</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1021"><span class='Ref_To_Local'>cfg</span></a><span class='Operator'>-&GT;</span>cfgparser<span class='Delimiter'>; 
</span> 
        <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN963"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Validation 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN971"><span class='Ref_To_Local'>prsOid</span></a><span class='Parentheses'>))</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"text search parser is required"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Looks good, build tuple and insert 
     */ 
</span>    memset<span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN964"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN964"><span class='Ref_To_Local'>values</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    memset<span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN965"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN965"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/builtins.h.html#LN40"><span class='Ref_to_Proto'>namestrcpy</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN969"><span class='Ref_To_Local'>cname</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN968"><span class='Ref_To_Local'>cfgname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN964"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_config.h.html#LN47"><span class='Ref_to_Const'>Anum_pg_ts_config_cfgname</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN600"><span class='Ref_to_Macro'>NameGetDatum</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN969"><span class='Ref_To_Local'>cname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN964"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_config.h.html#LN48"><span class='Ref_to_Const'>Anum_pg_ts_config_cfgnamespace</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN967"><span class='Ref_To_Local'>namespaceoid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN964"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_config.h.html#LN49"><span class='Ref_to_Const'>Anum_pg_ts_config_cfgowner</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>())</span><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN964"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_config.h.html#LN50"><span class='Ref_to_Const'>Anum_pg_ts_config_cfgparser</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN971"><span class='Ref_To_Local'>prsOid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN961"><span class='Ref_To_Local'>cfgRel</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN91"><span class='Ref_to_Proto'>heap_open</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_config.h.html#LN30"><span class='Ref_to_Const'>TSConfigRelationId</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN963"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="../access/common/heaptuple.c.html#LN690"><span class='Ref_to_Func'>heap_form_tuple</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN961"><span class='Ref_To_Local'>cfgRel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN114"><span class='Ref_to_Member'>rd_att</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN964"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN965"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN972"><span class='Ref_To_Local'>cfgOid</span></a> <span class='Operator'>= </span><a href="../../include/catalog/indexing.h.html#LN32"><span class='Ref_to_Proto'>CatalogTupleInsert</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN961"><span class='Ref_To_Local'>cfgRel</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN963"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN970"><span class='Ref_To_Local'>sourceOid</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Copy token-dicts map from source config 
         */ 
</span><a name="LN1067"></a>        <a href="../../include/access/skey.h.html#LN63"><span class='Ref_to_Struct'>ScanKeyData</span></a> <span class='Declare_Local'>skey</span><span class='Delimiter'>; 
</span><a name="LN1068"></a>        <a href="../../include/access/genam.h.html#LN86"><span class='Ref_to_Typedef'>SysScanDesc</span></a> <span class='Declare_Local'>scan</span><span class='Delimiter'>; 
</span><a name="LN1069"></a>        <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>maptup</span><span class='Delimiter'>; 
</span> 
        <a href="tsearchcmds.c.html#LN962"><span class='Ref_To_Local'>mapRel</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN91"><span class='Ref_to_Proto'>heap_open</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_config_map.h.html#LN30"><span class='Ref_to_Const'>TSConfigMapRelationId</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="../access/common/scankey.c.html#LN74"><span class='Ref_to_Func'>ScanKeyInit</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN1067"><span class='Ref_To_Local'>skey</span></a><span class='Delimiter'>, 
</span>                    <a href="../../include/catalog/pg_ts_config_map.h.html#LN47"><span class='Ref_to_Const'>Anum_pg_ts_config_map_mapcfg</span></a><span class='Delimiter'>, 
</span>                    <a href="../../include/access/stratnum.h.html#LN30"><span class='Ref_to_Const'>BTEqualStrategyNumber</span></a><span class='Delimiter'>, </span>F_OIDEQ<span class='Delimiter'>, 
</span>                    <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN970"><span class='Ref_To_Local'>sourceOid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <a href="tsearchcmds.c.html#LN1068"><span class='Ref_To_Local'>scan</span></a> <span class='Operator'>= </span><a href="../../include/access/genam.h.html#LN189"><span class='Ref_to_Proto'>systable_beginscan</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN962"><span class='Ref_To_Local'>mapRel</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/indexing.h.html#LN263"><span class='Ref_to_Const'>TSConfigMapIndexId</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, 
</span>                                  <span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN1067"><span class='Ref_To_Local'>skey</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>((</span><a href="tsearchcmds.c.html#LN1069"><span class='Ref_To_Local'>maptup</span></a> <span class='Operator'>= </span><a href="../../include/access/genam.h.html#LN194"><span class='Ref_to_Proto'>systable_getnext</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1068"><span class='Ref_To_Local'>scan</span></a><span class='Parentheses'>))))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN1083"></a>            <a href="../../include/catalog/pg_ts_config_map.h.html#LN40"><span class='Ref_to_Typedef'>Form_pg_ts_config_map</span></a> <span class='Declare_Local'>cfgmap</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_config_map.h.html#LN40"><span class='Ref_to_Typedef'>Form_pg_ts_config_map</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1069"><span class='Ref_To_Local'>maptup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1084"></a>            <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>newmaptup</span><span class='Delimiter'>; 
</span><a name="LN1085"></a>            <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>mapvalues</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_config_map.h.html#LN46"><span class='Ref_to_Const'>Natts_pg_ts_config_map</span></a><span class='Delimiter'>]; 
</span><a name="LN1086"></a>            <span class='Keyword'>bool</span>        <span class='Declare_Local'>mapnulls</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_config_map.h.html#LN46"><span class='Ref_to_Const'>Natts_pg_ts_config_map</span></a><span class='Delimiter'>]; 
</span> 
            memset<span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1085"><span class='Ref_To_Local'>mapvalues</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1085"><span class='Ref_To_Local'>mapvalues</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            memset<span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1086"><span class='Ref_To_Local'>mapnulls</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1086"><span class='Ref_To_Local'>mapnulls</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
            <a href="tsearchcmds.c.html#LN1085"><span class='Ref_To_Local'>mapvalues</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_config_map.h.html#LN47"><span class='Ref_to_Const'>Anum_pg_ts_config_map_mapcfg</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="tsearchcmds.c.html#LN972"><span class='Ref_To_Local'>cfgOid</span></a><span class='Delimiter'>; 
</span>            <a href="tsearchcmds.c.html#LN1085"><span class='Ref_To_Local'>mapvalues</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_config_map.h.html#LN48"><span class='Ref_to_Const'>Anum_pg_ts_config_map_maptokentype</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1083"><span class='Ref_To_Local'>cfgmap</span></a><span class='Operator'>-&GT;</span>maptokentype<span class='Delimiter'>; 
</span>            <a href="tsearchcmds.c.html#LN1085"><span class='Ref_To_Local'>mapvalues</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_config_map.h.html#LN49"><span class='Ref_to_Const'>Anum_pg_ts_config_map_mapseqno</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1083"><span class='Ref_To_Local'>cfgmap</span></a><span class='Operator'>-&GT;</span>mapseqno<span class='Delimiter'>; 
</span>            <a href="tsearchcmds.c.html#LN1085"><span class='Ref_To_Local'>mapvalues</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_config_map.h.html#LN50"><span class='Ref_to_Const'>Anum_pg_ts_config_map_mapdict</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1083"><span class='Ref_To_Local'>cfgmap</span></a><span class='Operator'>-&GT;</span>mapdict<span class='Delimiter'>; 
</span> 
            <a href="tsearchcmds.c.html#LN1084"><span class='Ref_To_Local'>newmaptup</span></a> <span class='Operator'>= </span><a href="../access/common/heaptuple.c.html#LN690"><span class='Ref_to_Func'>heap_form_tuple</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN962"><span class='Ref_To_Local'>mapRel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN114"><span class='Ref_to_Member'>rd_att</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1085"><span class='Ref_To_Local'>mapvalues</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1086"><span class='Ref_To_Local'>mapnulls</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="../../include/catalog/indexing.h.html#LN32"><span class='Ref_to_Proto'>CatalogTupleInsert</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN962"><span class='Ref_To_Local'>mapRel</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1084"><span class='Ref_To_Local'>newmaptup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="../../include/access/htup_details.h.html#LN815"><span class='Ref_to_Proto'>heap_freetuple</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1084"><span class='Ref_To_Local'>newmaptup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while HeapTupleIsValid((map... &raquo; </span> 
 
        <a href="../../include/access/genam.h.html#LN196"><span class='Ref_to_Proto'>systable_endscan</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1068"><span class='Ref_To_Local'>scan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if OidIsValid(sourceOid) &raquo; </span> 
 
    <a href="tsearchcmds.c.html#LN974"><span class='Ref_To_Local'>address</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN871"><span class='Ref_to_Func'>makeConfigurationDependencies</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN963"><span class='Ref_To_Local'>tup</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN962"><span class='Ref_To_Local'>mapRel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Post creation hook for new text search configuration */ 
</span>    <a href="../../include/catalog/objectaccess.h.html#LN144"><span class='Ref_to_Macro'>InvokeObjectPostCreateHook</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_config.h.html#LN30"><span class='Ref_to_Const'>TSConfigRelationId</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN972"><span class='Ref_To_Local'>cfgOid</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/htup_details.h.html#LN815"><span class='Ref_to_Proto'>heap_freetuple</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN963"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN962"><span class='Ref_To_Local'>mapRel</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN962"><span class='Ref_To_Local'>mapRel</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN961"><span class='Ref_To_Local'>cfgRel</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="tsearchcmds.c.html#LN974"><span class='Ref_To_Local'>address</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end DefineTSConfiguration &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Guts of TS configuration deletion. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN1124"></a><span class='Declare_Function'>RemoveTSConfigurationById</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>cfgId</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1126"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>relCfg</span><span class='Delimiter'>, 
</span><a name="LN1127"></a>                <span class='Declare_Local'>relMap</span><span class='Delimiter'>; 
</span><a name="LN1128"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tup</span><span class='Delimiter'>; 
</span><a name="LN1129"></a>    <a href="../../include/access/skey.h.html#LN63"><span class='Ref_to_Struct'>ScanKeyData</span></a> <span class='Declare_Local'>skey</span><span class='Delimiter'>; 
</span><a name="LN1130"></a>    <a href="../../include/access/genam.h.html#LN86"><span class='Ref_to_Typedef'>SysScanDesc</span></a> <span class='Declare_Local'>scan</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Remove the pg_ts_config entry */ 
</span>    <a href="tsearchcmds.c.html#LN1126"><span class='Ref_To_Local'>relCfg</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN91"><span class='Ref_to_Proto'>heap_open</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_config.h.html#LN30"><span class='Ref_to_Const'>TSConfigRelationId</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN1128"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN99"><span class='Ref_to_EnumConst'>TSCONFIGOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1124"><span class='Ref_to_Parameter'>cfgId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1128"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for text search dictionary %u"</span><span class='Delimiter'>, 
</span>             <a href="tsearchcmds.c.html#LN1124"><span class='Ref_to_Parameter'>cfgId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/catalog/indexing.h.html#LN40"><span class='Ref_to_Proto'>CatalogTupleDelete</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1126"><span class='Ref_To_Local'>relCfg</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN1128"><span class='Ref_To_Local'>tup</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/htup.h.html#LN64"><span class='Ref_to_Member'>t_self</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1128"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1126"><span class='Ref_To_Local'>relCfg</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Remove any pg_ts_config_map entries */ 
</span>    <a href="tsearchcmds.c.html#LN1127"><span class='Ref_To_Local'>relMap</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN91"><span class='Ref_to_Proto'>heap_open</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_config_map.h.html#LN30"><span class='Ref_to_Const'>TSConfigMapRelationId</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../access/common/scankey.c.html#LN74"><span class='Ref_to_Func'>ScanKeyInit</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN1129"><span class='Ref_To_Local'>skey</span></a><span class='Delimiter'>, 
</span>                <a href="../../include/catalog/pg_ts_config_map.h.html#LN47"><span class='Ref_to_Const'>Anum_pg_ts_config_map_mapcfg</span></a><span class='Delimiter'>, 
</span>                <a href="../../include/access/stratnum.h.html#LN30"><span class='Ref_to_Const'>BTEqualStrategyNumber</span></a><span class='Delimiter'>, </span>F_OIDEQ<span class='Delimiter'>, 
</span>                <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1124"><span class='Ref_to_Parameter'>cfgId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN1130"><span class='Ref_To_Local'>scan</span></a> <span class='Operator'>= </span><a href="../../include/access/genam.h.html#LN189"><span class='Ref_to_Proto'>systable_beginscan</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1127"><span class='Ref_To_Local'>relMap</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/indexing.h.html#LN263"><span class='Ref_to_Const'>TSConfigMapIndexId</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, 
</span>                              <span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN1129"><span class='Ref_To_Local'>skey</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>((</span><a href="tsearchcmds.c.html#LN1128"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="../../include/access/genam.h.html#LN194"><span class='Ref_to_Proto'>systable_getnext</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1130"><span class='Ref_To_Local'>scan</span></a><span class='Parentheses'>))))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../include/catalog/indexing.h.html#LN40"><span class='Ref_to_Proto'>CatalogTupleDelete</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1127"><span class='Ref_To_Local'>relMap</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN1128"><span class='Ref_To_Local'>tup</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/htup.h.html#LN64"><span class='Ref_to_Member'>t_self</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../include/access/genam.h.html#LN196"><span class='Ref_to_Proto'>systable_endscan</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1130"><span class='Ref_To_Local'>scan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1127"><span class='Ref_To_Local'>relMap</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end RemoveTSConfigurationById &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * ALTER TEXT SEARCH CONFIGURATION - main entry point 
 */ 
</span><a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> 
<a name="LN1172"></a><span class='Declare_Function'>AlterTSConfiguration</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN3329"><span class='Ref_to_Struct'>AlterTSConfigurationStmt</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>stmt</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1174"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tup</span><span class='Delimiter'>; 
</span><a name="LN1175"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>cfgId</span><span class='Delimiter'>; 
</span><a name="LN1176"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>relMap</span><span class='Delimiter'>; 
</span><a name="LN1177"></a>    <a href="../../include/catalog/objectaddress.h.html#LN23"><span class='Ref_to_Struct'>ObjectAddress</span></a> <span class='Declare_Local'>address</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Find the configuration */ 
</span>    <a href="tsearchcmds.c.html#LN1174"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN846"><span class='Ref_to_Func'>GetTSConfigTuple</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1172"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3333"><span class='Ref_to_Member'>cfgname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1174"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>))</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_OBJECT<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"text search configuration \"%s\" does not exist"</span><span class='Delimiter'>, 
</span>                        <a href="../../include/catalog/namespace.h.html#LN120"><span class='Ref_to_Proto'>NameListToString</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1172"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3333"><span class='Ref_to_Member'>cfgname</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN1175"><span class='Ref_To_Local'>cfgId</span></a> <span class='Operator'>= </span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1174"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* must be owner */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/acl.h.html#LN322"><span class='Ref_to_Proto'>pg_ts_config_ownercheck</span></a><span class='Parentheses'>(</span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1174"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()))</span> 
        <a href="../../include/utils/acl.h.html#LN295"><span class='Ref_to_Proto'>aclcheck_error</span></a><span class='Parentheses'>(</span><a href="../../include/utils/acl.h.html#LN173"><span class='Ref_to_EnumConst'>ACLCHECK_NOT_OWNER</span></a><span class='Delimiter'>, </span><a href="../../include/utils/acl.h.html#LN197"><span class='Ref_to_EnumConst'>ACL_KIND_TSCONFIGURATION</span></a><span class='Delimiter'>, 
</span>                       <a href="../../include/catalog/namespace.h.html#LN120"><span class='Ref_to_Proto'>NameListToString</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1172"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3333"><span class='Ref_to_Member'>cfgname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN1176"><span class='Ref_To_Local'>relMap</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN91"><span class='Ref_to_Proto'>heap_open</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_config_map.h.html#LN30"><span class='Ref_to_Const'>TSConfigMapRelationId</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Add or drop mappings */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1172"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3340"><span class='Ref_to_Member'>dicts</span></a><span class='Parentheses'>) 
</span>        <a href="tsearchcmds.c.html#LN50"><span class='Ref_to_Proto'>MakeConfigurationMapping</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1172"><span class='Ref_to_Parameter'>stmt</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1174"><span class='Ref_To_Local'>tup</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1176"><span class='Ref_To_Local'>relMap</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1172"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3339"><span class='Ref_to_Member'>tokentype</span></a><span class='Parentheses'>) 
</span>        <a href="tsearchcmds.c.html#LN52"><span class='Ref_to_Proto'>DropConfigurationMapping</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1172"><span class='Ref_to_Parameter'>stmt</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1174"><span class='Ref_To_Local'>tup</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1176"><span class='Ref_To_Local'>relMap</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Update dependencies */ 
</span>    <a href="tsearchcmds.c.html#LN871"><span class='Ref_to_Func'>makeConfigurationDependencies</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1174"><span class='Ref_To_Local'>tup</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1176"><span class='Ref_To_Local'>relMap</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/catalog/objectaccess.h.html#LN162"><span class='Ref_to_Macro'>InvokeObjectPostAlterHook</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_config.h.html#LN30"><span class='Ref_to_Const'>TSConfigRelationId</span></a><span class='Delimiter'>, 
</span>                              <a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1174"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/catalog/objectaddress.h.html#LN39"><span class='Ref_to_Macro'>ObjectAddressSet</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1177"><span class='Ref_To_Local'>address</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/pg_ts_config.h.html#LN30"><span class='Ref_to_Const'>TSConfigRelationId</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1175"><span class='Ref_To_Local'>cfgId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1176"><span class='Ref_To_Local'>relMap</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN37"><span class='Ref_to_Const'>RowExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1174"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="tsearchcmds.c.html#LN1177"><span class='Ref_To_Local'>address</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end AlterTSConfiguration &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Translate a list of token type names to an array of token type numbers 
 */ 
</span><span class='Keyword'>static int </span><span class='Operator'>* 
</span><a name="LN1221"></a><span class='Declare_Function'>getTokenTypes</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>prsId</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tokennames</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1223"></a>    <a href="../../include/tsearch/ts_cache.h.html#LN29"><span class='Ref_to_Struct'>TSParserCacheEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>prs</span> <span class='Operator'>= </span><a href="../../include/tsearch/ts_cache.h.html#LN89"><span class='Ref_to_Proto'>lookup_ts_parser_cache</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1221"><span class='Ref_to_Parameter'>prsId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1224"></a>    <a href="../../test/modules/test_parser/test_parser.c.html#LN30"><span class='Ref_to_Typedef'>LexDescr</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>list</span><span class='Delimiter'>; 
</span><a name="LN1225"></a>    <span class='Keyword'>int</span>        <span class='Operator'>*</span><span class='Declare_Local'>res</span><span class='Delimiter'>, 
</span><a name="LN1226"></a>                <span class='Declare_Local'>i</span><span class='Delimiter'>, 
</span><a name="LN1227"></a>                <span class='Declare_Local'>ntoken</span><span class='Delimiter'>; 
</span><a name="LN1228"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>tn</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN1227"><span class='Ref_To_Local'>ntoken</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1221"><span class='Ref_to_Parameter'>tokennames</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1227"><span class='Ref_To_Local'>ntoken</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN1225"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="tsearchcmds.c.html#LN1227"><span class='Ref_To_Local'>ntoken</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1223"><span class='Ref_To_Local'>prs</span></a><span class='Operator'>-&GT;</span><a href="../../include/tsearch/ts_cache.h.html#LN39"><span class='Ref_to_Member'>lextypeOid</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"method lextype isn't defined for text search parser %u"</span><span class='Delimiter'>, 
</span>             <a href="tsearchcmds.c.html#LN1221"><span class='Ref_to_Parameter'>prsId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* lextype takes one dummy argument */ 
</span>    <a href="tsearchcmds.c.html#LN1224"><span class='Ref_To_Local'>list</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../test/modules/test_parser/test_parser.c.html#LN30"><span class='Ref_to_Typedef'>LexDescr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN621"><span class='Ref_to_Macro'>OidFunctionCall1</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1223"><span class='Ref_To_Local'>prs</span></a><span class='Operator'>-&GT;</span><a href="../../include/tsearch/ts_cache.h.html#LN39"><span class='Ref_to_Member'>lextypeOid</span></a><span class='Delimiter'>, 
</span>                                                         <span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>) </span><span class='Number'>0</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN1226"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1228"><span class='Ref_To_Local'>tn</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1221"><span class='Ref_to_Parameter'>tokennames</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1246"></a>        <a href="../../include/nodes/value.h.html#LN41"><span class='Ref_to_Struct'>Value</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>val</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/value.h.html#LN41"><span class='Ref_to_Struct'>Value</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1228"><span class='Ref_To_Local'>tn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1247"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>found</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN1248"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span> 
        <a href="tsearchcmds.c.html#LN1248"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1224"><span class='Ref_To_Local'>list</span></a> <span class='Operator'>&& </span><a href="tsearchcmds.c.html#LN1224"><span class='Ref_To_Local'>list</span></a><span class='Delimiter'>[</span><a href="tsearchcmds.c.html#LN1248"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../include/tsearch/ts_public.h.html#LN26"><span class='Ref_to_Member'>lexid</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* XXX should we use pg_strcasecmp here? */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1246"><span class='Ref_To_Local'>val</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1224"><span class='Ref_To_Local'>list</span></a><span class='Delimiter'>[</span><a href="tsearchcmds.c.html#LN1248"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../include/tsearch/ts_public.h.html#LN27"><span class='Ref_to_Member'>alias</span></a><span class='Parentheses'>)</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Delimiter'>{ 
</span>                <a href="tsearchcmds.c.html#LN1225"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>[</span><a href="tsearchcmds.c.html#LN1226"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1224"><span class='Ref_To_Local'>list</span></a><span class='Delimiter'>[</span><a href="tsearchcmds.c.html#LN1248"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../include/tsearch/ts_public.h.html#LN26"><span class='Ref_to_Member'>lexid</span></a><span class='Delimiter'>; 
</span>                <a href="tsearchcmds.c.html#LN1247"><span class='Ref_To_Local'>found</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <a href="tsearchcmds.c.html#LN1248"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="tsearchcmds.c.html#LN1247"><span class='Ref_To_Local'>found</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"token type \"%s\" does not exist"</span><span class='Delimiter'>, 
</span>                            <a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1246"><span class='Ref_To_Local'>val</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>        <a href="tsearchcmds.c.html#LN1226"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="tsearchcmds.c.html#LN1225"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end getTokenTypes &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * ALTER TEXT SEARCH CONFIGURATION ADD/ALTER MAPPING 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN1277"></a><span class='Declare_Function'>MakeConfigurationMapping</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN3329"><span class='Ref_to_Struct'>AlterTSConfigurationStmt</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>stmt</span><span class='Delimiter'>, 
</span><a name="LN1278"></a>                         <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a> <span class='Declare_Parameter'>tup</span><span class='Delimiter'>, </span><a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a> <span class='Declare_Parameter'>relMap</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1280"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>cfgId</span> <span class='Operator'>= </span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1278"><span class='Ref_to_Parameter'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1281"></a>    <a href="../../include/access/skey.h.html#LN63"><span class='Ref_to_Struct'>ScanKeyData</span></a> <span class='Declare_Local'>skey</span><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]; 
</span><a name="LN1282"></a>    <a href="../../include/access/genam.h.html#LN86"><span class='Ref_to_Typedef'>SysScanDesc</span></a> <span class='Declare_Local'>scan</span><span class='Delimiter'>; 
</span><a name="LN1283"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>maptup</span><span class='Delimiter'>; 
</span><a name="LN1284"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN1285"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span><a name="LN1286"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>prsId</span><span class='Delimiter'>; 
</span><a name="LN1287"></a>    <span class='Keyword'>int</span>        <span class='Operator'>*</span><span class='Declare_Local'>tokens</span><span class='Delimiter'>, 
</span><a name="LN1288"></a>                <span class='Declare_Local'>ntoken</span><span class='Delimiter'>; 
</span><a name="LN1289"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>dictIds</span><span class='Delimiter'>; 
</span><a name="LN1290"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>ndict</span><span class='Delimiter'>; 
</span><a name="LN1291"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>c</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN1286"><span class='Ref_To_Local'>prsId</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="../../include/catalog/pg_ts_config.h.html#LN40"><span class='Ref_to_Typedef'>Form_pg_ts_config</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1278"><span class='Ref_to_Parameter'>tup</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>cfgparser<span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN1287"><span class='Ref_To_Local'>tokens</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1220"><span class='Ref_to_Func'>getTokenTypes</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1286"><span class='Ref_To_Local'>prsId</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1277"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3339"><span class='Ref_to_Member'>tokentype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN1288"><span class='Ref_To_Local'>ntoken</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1277"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3339"><span class='Ref_to_Member'>tokentype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1277"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><span class='Keyword'>override</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * delete maps for tokens if they exist and command was ALTER 
         */ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1284"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="tsearchcmds.c.html#LN1284"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="tsearchcmds.c.html#LN1288"><span class='Ref_To_Local'>ntoken</span></a><span class='Delimiter'>; </span><a href="tsearchcmds.c.html#LN1284"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="../access/common/scankey.c.html#LN74"><span class='Ref_to_Func'>ScanKeyInit</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN1281"><span class='Ref_To_Local'>skey</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>], 
</span>                        <a href="../../include/catalog/pg_ts_config_map.h.html#LN47"><span class='Ref_to_Const'>Anum_pg_ts_config_map_mapcfg</span></a><span class='Delimiter'>, 
</span>                        <a href="../../include/access/stratnum.h.html#LN30"><span class='Ref_to_Const'>BTEqualStrategyNumber</span></a><span class='Delimiter'>, </span>F_OIDEQ<span class='Delimiter'>, 
</span>                        <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1280"><span class='Ref_To_Local'>cfgId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="../access/common/scankey.c.html#LN74"><span class='Ref_to_Func'>ScanKeyInit</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN1281"><span class='Ref_To_Local'>skey</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>], 
</span>                        <a href="../../include/catalog/pg_ts_config_map.h.html#LN48"><span class='Ref_to_Const'>Anum_pg_ts_config_map_maptokentype</span></a><span class='Delimiter'>, 
</span>                        <a href="../../include/access/stratnum.h.html#LN30"><span class='Ref_to_Const'>BTEqualStrategyNumber</span></a><span class='Delimiter'>, </span>F_INT4EQ<span class='Delimiter'>, 
</span>                        <a href="../../include/postgres.h.html#LN484"><span class='Ref_to_Macro'>Int32GetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1287"><span class='Ref_To_Local'>tokens</span></a><span class='Delimiter'>[</span><a href="tsearchcmds.c.html#LN1284"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
            <a href="tsearchcmds.c.html#LN1282"><span class='Ref_To_Local'>scan</span></a> <span class='Operator'>= </span><a href="../../include/access/genam.h.html#LN189"><span class='Ref_to_Proto'>systable_beginscan</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1278"><span class='Ref_to_Parameter'>relMap</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/indexing.h.html#LN263"><span class='Ref_to_Const'>TSConfigMapIndexId</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, 
</span>                                      <span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1281"><span class='Ref_To_Local'>skey</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>((</span><a href="tsearchcmds.c.html#LN1283"><span class='Ref_To_Local'>maptup</span></a> <span class='Operator'>= </span><a href="../../include/access/genam.h.html#LN194"><span class='Ref_to_Proto'>systable_getnext</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1282"><span class='Ref_To_Local'>scan</span></a><span class='Parentheses'>))))</span> 
            <span class='Delimiter'>{ 
</span>                <a href="../../include/catalog/indexing.h.html#LN40"><span class='Ref_to_Proto'>CatalogTupleDelete</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1278"><span class='Ref_to_Parameter'>relMap</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN1283"><span class='Ref_To_Local'>maptup</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/htup.h.html#LN64"><span class='Ref_to_Member'>t_self</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <a href="../../include/access/genam.h.html#LN196"><span class='Ref_to_Proto'>systable_endscan</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1282"><span class='Ref_To_Local'>scan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=0;i&LT;ntoken;i++ &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if stmt-&GT;override &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* 
     * Convert list of dictionary names to array of dict OIDs 
     */ 
</span>    <a href="tsearchcmds.c.html#LN1290"><span class='Ref_To_Local'>ndict</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1277"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3340"><span class='Ref_to_Member'>dicts</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN1289"><span class='Ref_To_Local'>dictIds</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="tsearchcmds.c.html#LN1290"><span class='Ref_To_Local'>ndict</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN1284"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1291"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1277"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3340"><span class='Ref_to_Member'>dicts</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1334"></a>        <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>names</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1291"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="tsearchcmds.c.html#LN1289"><span class='Ref_To_Local'>dictIds</span></a><span class='Delimiter'>[</span><a href="tsearchcmds.c.html#LN1284"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN100"><span class='Ref_to_Proto'>get_ts_dict_oid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1334"><span class='Ref_To_Local'>names</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="tsearchcmds.c.html#LN1284"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1277"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3342"><span class='Ref_to_Member'>replace</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Replace a specific dictionary in existing entries 
         */ 
</span><a name="LN1345"></a>        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>dictOld</span> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1289"><span class='Ref_To_Local'>dictIds</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>], 
</span><a name="LN1346"></a>                    <span class='Declare_Local'>dictNew</span> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1289"><span class='Ref_To_Local'>dictIds</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]; 
</span> 
        <a href="../access/common/scankey.c.html#LN74"><span class='Ref_to_Func'>ScanKeyInit</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN1281"><span class='Ref_To_Local'>skey</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>], 
</span>                    <a href="../../include/catalog/pg_ts_config_map.h.html#LN47"><span class='Ref_to_Const'>Anum_pg_ts_config_map_mapcfg</span></a><span class='Delimiter'>, 
</span>                    <a href="../../include/access/stratnum.h.html#LN30"><span class='Ref_to_Const'>BTEqualStrategyNumber</span></a><span class='Delimiter'>, </span>F_OIDEQ<span class='Delimiter'>, 
</span>                    <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1280"><span class='Ref_To_Local'>cfgId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <a href="tsearchcmds.c.html#LN1282"><span class='Ref_To_Local'>scan</span></a> <span class='Operator'>= </span><a href="../../include/access/genam.h.html#LN189"><span class='Ref_to_Proto'>systable_beginscan</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1278"><span class='Ref_to_Parameter'>relMap</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/indexing.h.html#LN263"><span class='Ref_to_Const'>TSConfigMapIndexId</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, 
</span>                                  <span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1281"><span class='Ref_To_Local'>skey</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>((</span><a href="tsearchcmds.c.html#LN1283"><span class='Ref_To_Local'>maptup</span></a> <span class='Operator'>= </span><a href="../../include/access/genam.h.html#LN194"><span class='Ref_to_Proto'>systable_getnext</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1282"><span class='Ref_To_Local'>scan</span></a><span class='Parentheses'>))))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN1358"></a>            <a href="../../include/catalog/pg_ts_config_map.h.html#LN40"><span class='Ref_to_Typedef'>Form_pg_ts_config_map</span></a> <span class='Declare_Local'>cfgmap</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_ts_config_map.h.html#LN40"><span class='Ref_to_Typedef'>Form_pg_ts_config_map</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1283"><span class='Ref_To_Local'>maptup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * check if it's one of target token types 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1287"><span class='Ref_To_Local'>tokens</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN1365"></a>                <span class='Keyword'>bool</span>        <span class='Declare_Local'>tokmatch</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
                <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1285"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="tsearchcmds.c.html#LN1285"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><a href="tsearchcmds.c.html#LN1288"><span class='Ref_To_Local'>ntoken</span></a><span class='Delimiter'>; </span><a href="tsearchcmds.c.html#LN1285"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1358"><span class='Ref_To_Local'>cfgmap</span></a><span class='Operator'>-&GT;</span>maptokentype <span class='Operator'>== </span><a href="tsearchcmds.c.html#LN1287"><span class='Ref_To_Local'>tokens</span></a><span class='Delimiter'>[</span><a href="tsearchcmds.c.html#LN1285"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <a href="tsearchcmds.c.html#LN1365"><span class='Ref_To_Local'>tokmatch</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                        <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="tsearchcmds.c.html#LN1365"><span class='Ref_To_Local'>tokmatch</span></a><span class='Parentheses'>) 
</span>                    <span class='Control'>continue</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * replace dictionary if match 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1358"><span class='Ref_To_Local'>cfgmap</span></a><span class='Operator'>-&GT;</span>mapdict <span class='Operator'>== </span><a href="tsearchcmds.c.html#LN1345"><span class='Ref_To_Local'>dictOld</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN1384"></a>                <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>repl_val</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_config_map.h.html#LN46"><span class='Ref_to_Const'>Natts_pg_ts_config_map</span></a><span class='Delimiter'>]; 
</span><a name="LN1385"></a>                <span class='Keyword'>bool</span>        <span class='Declare_Local'>repl_null</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_config_map.h.html#LN46"><span class='Ref_to_Const'>Natts_pg_ts_config_map</span></a><span class='Delimiter'>]; 
</span><a name="LN1386"></a>                <span class='Keyword'>bool</span>        <span class='Declare_Local'>repl_repl</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_config_map.h.html#LN46"><span class='Ref_to_Const'>Natts_pg_ts_config_map</span></a><span class='Delimiter'>]; 
</span><a name="LN1387"></a>                <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>newtup</span><span class='Delimiter'>; 
</span> 
                memset<span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1384"><span class='Ref_To_Local'>repl_val</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1384"><span class='Ref_To_Local'>repl_val</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                memset<span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1385"><span class='Ref_To_Local'>repl_null</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1385"><span class='Ref_To_Local'>repl_null</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                memset<span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1386"><span class='Ref_To_Local'>repl_repl</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1386"><span class='Ref_To_Local'>repl_repl</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
                <a href="tsearchcmds.c.html#LN1384"><span class='Ref_To_Local'>repl_val</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_config_map.h.html#LN50"><span class='Ref_to_Const'>Anum_pg_ts_config_map_mapdict</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1346"><span class='Ref_To_Local'>dictNew</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="tsearchcmds.c.html#LN1386"><span class='Ref_To_Local'>repl_repl</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_config_map.h.html#LN50"><span class='Ref_to_Const'>Anum_pg_ts_config_map_mapdict</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
                <a href="tsearchcmds.c.html#LN1387"><span class='Ref_To_Local'>newtup</span></a> <span class='Operator'>= </span><a href="../access/common/heaptuple.c.html#LN789"><span class='Ref_to_Func'>heap_modify_tuple</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1283"><span class='Ref_To_Local'>maptup</span></a><span class='Delimiter'>, 
</span>                                           <a href="../../include/utils/rel.h.html#LN428"><span class='Ref_to_Macro'>RelationGetDescr</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1278"><span class='Ref_to_Parameter'>relMap</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                           <a href="tsearchcmds.c.html#LN1384"><span class='Ref_To_Local'>repl_val</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1385"><span class='Ref_To_Local'>repl_null</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1386"><span class='Ref_To_Local'>repl_repl</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="../../include/catalog/indexing.h.html#LN35"><span class='Ref_to_Proto'>CatalogTupleUpdate</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1278"><span class='Ref_to_Parameter'>relMap</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN1387"><span class='Ref_To_Local'>newtup</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/htup.h.html#LN64"><span class='Ref_to_Member'>t_self</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1387"><span class='Ref_To_Local'>newtup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while HeapTupleIsValid((map... &raquo; </span> 
 
        <a href="../../include/access/genam.h.html#LN196"><span class='Ref_to_Proto'>systable_endscan</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1282"><span class='Ref_To_Local'>scan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if stmt-&GT;replace &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Insertion of new entries 
         */ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1284"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="tsearchcmds.c.html#LN1284"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="tsearchcmds.c.html#LN1288"><span class='Ref_To_Local'>ntoken</span></a><span class='Delimiter'>; </span><a href="tsearchcmds.c.html#LN1284"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1285"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="tsearchcmds.c.html#LN1285"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><a href="tsearchcmds.c.html#LN1290"><span class='Ref_To_Local'>ndict</span></a><span class='Delimiter'>; </span><a href="tsearchcmds.c.html#LN1285"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN1414"></a>                <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>values</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_config_map.h.html#LN46"><span class='Ref_to_Const'>Natts_pg_ts_config_map</span></a><span class='Delimiter'>]; 
</span><a name="LN1415"></a>                <span class='Keyword'>bool</span>        <span class='Declare_Local'>nulls</span><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_config_map.h.html#LN46"><span class='Ref_to_Const'>Natts_pg_ts_config_map</span></a><span class='Delimiter'>]; 
</span> 
                memset<span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1415"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1415"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <a href="tsearchcmds.c.html#LN1414"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_config_map.h.html#LN47"><span class='Ref_to_Const'>Anum_pg_ts_config_map_mapcfg</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1280"><span class='Ref_To_Local'>cfgId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="tsearchcmds.c.html#LN1414"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_config_map.h.html#LN48"><span class='Ref_to_Const'>Anum_pg_ts_config_map_maptokentype</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN484"><span class='Ref_to_Macro'>Int32GetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1287"><span class='Ref_To_Local'>tokens</span></a><span class='Delimiter'>[</span><a href="tsearchcmds.c.html#LN1284"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="tsearchcmds.c.html#LN1414"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_config_map.h.html#LN49"><span class='Ref_to_Const'>Anum_pg_ts_config_map_mapseqno</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN484"><span class='Ref_to_Macro'>Int32GetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1285"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="tsearchcmds.c.html#LN1414"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><a href="../../include/catalog/pg_ts_config_map.h.html#LN50"><span class='Ref_to_Const'>Anum_pg_ts_config_map_mapdict</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1289"><span class='Ref_To_Local'>dictIds</span></a><span class='Delimiter'>[</span><a href="tsearchcmds.c.html#LN1285"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <a href="tsearchcmds.c.html#LN1278"><span class='Ref_to_Parameter'>tup</span></a> <span class='Operator'>= </span><a href="../access/common/heaptuple.c.html#LN690"><span class='Ref_to_Func'>heap_form_tuple</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1278"><span class='Ref_to_Parameter'>relMap</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN114"><span class='Ref_to_Member'>rd_att</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1414"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1415"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="../../include/catalog/indexing.h.html#LN32"><span class='Ref_to_Proto'>CatalogTupleInsert</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1278"><span class='Ref_to_Parameter'>relMap</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1278"><span class='Ref_to_Parameter'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <a href="../../include/access/htup_details.h.html#LN815"><span class='Ref_to_Proto'>heap_freetuple</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1278"><span class='Ref_to_Parameter'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <a href="../../include/commands/event_trigger.h.html#LN84"><span class='Ref_to_Proto'>EventTriggerCollectAlterTSConfig</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1277"><span class='Ref_to_Parameter'>stmt</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1280"><span class='Ref_To_Local'>cfgId</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1289"><span class='Ref_To_Local'>dictIds</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1290"><span class='Ref_To_Local'>ndict</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end MakeConfigurationMapping &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * ALTER TEXT SEARCH CONFIGURATION DROP MAPPING 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN1438"></a><span class='Declare_Function'>DropConfigurationMapping</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN3329"><span class='Ref_to_Struct'>AlterTSConfigurationStmt</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>stmt</span><span class='Delimiter'>, 
</span><a name="LN1439"></a>                         <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a> <span class='Declare_Parameter'>tup</span><span class='Delimiter'>, </span><a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a> <span class='Declare_Parameter'>relMap</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1441"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>cfgId</span> <span class='Operator'>= </span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1439"><span class='Ref_to_Parameter'>tup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1442"></a>    <a href="../../include/access/skey.h.html#LN63"><span class='Ref_to_Struct'>ScanKeyData</span></a> <span class='Declare_Local'>skey</span><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]; 
</span><a name="LN1443"></a>    <a href="../../include/access/genam.h.html#LN86"><span class='Ref_to_Typedef'>SysScanDesc</span></a> <span class='Declare_Local'>scan</span><span class='Delimiter'>; 
</span><a name="LN1444"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>maptup</span><span class='Delimiter'>; 
</span><a name="LN1445"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN1446"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>prsId</span><span class='Delimiter'>; 
</span><a name="LN1447"></a>    <span class='Keyword'>int</span>        <span class='Operator'>*</span><span class='Declare_Local'>tokens</span><span class='Delimiter'>; 
</span><a name="LN1448"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>c</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN1446"><span class='Ref_To_Local'>prsId</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="../../include/catalog/pg_ts_config.h.html#LN40"><span class='Ref_to_Typedef'>Form_pg_ts_config</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1439"><span class='Ref_to_Parameter'>tup</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>cfgparser<span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN1447"><span class='Ref_To_Local'>tokens</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1220"><span class='Ref_to_Func'>getTokenTypes</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1446"><span class='Ref_To_Local'>prsId</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1438"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3339"><span class='Ref_to_Member'>tokentype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN1445"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1448"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1438"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3339"><span class='Ref_to_Member'>tokentype</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1457"></a>        <a href="../../include/nodes/value.h.html#LN41"><span class='Ref_to_Struct'>Value</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>val</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/value.h.html#LN41"><span class='Ref_to_Struct'>Value</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1448"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1458"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>found</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
        <a href="../access/common/scankey.c.html#LN74"><span class='Ref_to_Func'>ScanKeyInit</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN1442"><span class='Ref_To_Local'>skey</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>], 
</span>                    <a href="../../include/catalog/pg_ts_config_map.h.html#LN47"><span class='Ref_to_Const'>Anum_pg_ts_config_map_mapcfg</span></a><span class='Delimiter'>, 
</span>                    <a href="../../include/access/stratnum.h.html#LN30"><span class='Ref_to_Const'>BTEqualStrategyNumber</span></a><span class='Delimiter'>, </span>F_OIDEQ<span class='Delimiter'>, 
</span>                    <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1441"><span class='Ref_To_Local'>cfgId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../access/common/scankey.c.html#LN74"><span class='Ref_to_Func'>ScanKeyInit</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN1442"><span class='Ref_To_Local'>skey</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>], 
</span>                    <a href="../../include/catalog/pg_ts_config_map.h.html#LN48"><span class='Ref_to_Const'>Anum_pg_ts_config_map_maptokentype</span></a><span class='Delimiter'>, 
</span>                    <a href="../../include/access/stratnum.h.html#LN30"><span class='Ref_to_Const'>BTEqualStrategyNumber</span></a><span class='Delimiter'>, </span>F_INT4EQ<span class='Delimiter'>, 
</span>                    <a href="../../include/postgres.h.html#LN484"><span class='Ref_to_Macro'>Int32GetDatum</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1447"><span class='Ref_To_Local'>tokens</span></a><span class='Delimiter'>[</span><a href="tsearchcmds.c.html#LN1445"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <a href="tsearchcmds.c.html#LN1443"><span class='Ref_To_Local'>scan</span></a> <span class='Operator'>= </span><a href="../../include/access/genam.h.html#LN189"><span class='Ref_to_Proto'>systable_beginscan</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1439"><span class='Ref_to_Parameter'>relMap</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/indexing.h.html#LN263"><span class='Ref_to_Const'>TSConfigMapIndexId</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, 
</span>                                  <span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1442"><span class='Ref_To_Local'>skey</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>((</span><a href="tsearchcmds.c.html#LN1444"><span class='Ref_To_Local'>maptup</span></a> <span class='Operator'>= </span><a href="../../include/access/genam.h.html#LN194"><span class='Ref_to_Proto'>systable_getnext</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1443"><span class='Ref_To_Local'>scan</span></a><span class='Parentheses'>))))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="../../include/catalog/indexing.h.html#LN40"><span class='Ref_to_Proto'>CatalogTupleDelete</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1439"><span class='Ref_to_Parameter'>relMap</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN1444"><span class='Ref_To_Local'>maptup</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/htup.h.html#LN64"><span class='Ref_to_Member'>t_self</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="tsearchcmds.c.html#LN1458"><span class='Ref_To_Local'>found</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="../../include/access/genam.h.html#LN196"><span class='Ref_to_Proto'>systable_endscan</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1443"><span class='Ref_To_Local'>scan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="tsearchcmds.c.html#LN1458"><span class='Ref_To_Local'>found</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="tsearchcmds.c.html#LN1438"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN3343"><span class='Ref_to_Member'>missing_ok</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_OBJECT<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                       <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"mapping for token type \"%s\" does not exist"</span><span class='Delimiter'>, 
</span>                              <a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1457"><span class='Ref_To_Local'>val</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN36"><span class='Ref_to_Const'>NOTICE</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"mapping for token type \"%s\" does not exist, skipping"</span><span class='Delimiter'>, 
</span>                                <a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1457"><span class='Ref_To_Local'>val</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="tsearchcmds.c.html#LN1445"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../include/commands/event_trigger.h.html#LN84"><span class='Ref_to_Proto'>EventTriggerCollectAlterTSConfig</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1438"><span class='Ref_to_Parameter'>stmt</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1441"><span class='Ref_To_Local'>cfgId</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end DropConfigurationMapping &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * Serialize dictionary options, producing a TEXT datum from a List of DefElem 
 * 
 * This is used to form the value stored in pg_ts_dict.dictinitoption. 
 * For the convenience of pg_dump, the output is formatted exactly as it 
 * would need to appear in CREATE TEXT SEARCH DICTIONARY to reproduce the 
 * same options. 
 * 
 * Note that we assume that only the textual representation of an option's 
 * value is interesting --- hence, non-string DefElems get forced to strings. 
 */ 
</span><a href="../../../contrib/seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a> <span class='Operator'>* 
</span><a name="LN1516"></a><span class='Declare_Function'>serialize_deflist</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>deflist</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1518"></a>    <a href="../../../contrib/seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1519"></a>    <a href="../../include/lib/stringinfo.h.html#LN34"><span class='Ref_to_Struct'>StringInfoData</span></a> <span class='Declare_Local'>buf</span><span class='Delimiter'>; 
</span><a name="LN1520"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <a href="../lib/stringinfo.c.html#LN44"><span class='Ref_to_Func'>initStringInfo</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN1519"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1520"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1516"><span class='Ref_to_Parameter'>deflist</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1526"></a>        <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>defel</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1520"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1527"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>val</span> <span class='Operator'>= </span><a href="define.c.html#LN47"><span class='Ref_to_Func'>defGetString</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1526"><span class='Ref_To_Local'>defel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="../../bin/pg_waldump/compat.c.html#LN69"><span class='Ref_to_Func'>appendStringInfo</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN1519"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>"%s = "</span><span class='Delimiter'>, 
</span>                         <a href="../../include/utils/builtins.h.html#LN77"><span class='Ref_to_Proto'>quote_identifier</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1526"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* If backslashes appear, force E syntax to determine their handling */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>strchr<span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1527"><span class='Ref_To_Local'>val</span></a><span class='Delimiter'>, </span><span class='String'>'\\'</span><span class='Parentheses'>))</span> 
            <a href="../replication/syncrep_scanner.l.html#LN76"><span class='Ref_to_Proto'>appendStringInfoChar</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN1519"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="../../include/c.h.html#LN509"><span class='Ref_to_Const'>ESCAPE_STRING_SYNTAX</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../replication/syncrep_scanner.l.html#LN76"><span class='Ref_to_Proto'>appendStringInfoChar</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN1519"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>'\''</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1527"><span class='Ref_To_Local'>val</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN1537"></a>            <span class='Keyword'>char</span>        <span class='Declare_Local'>ch</span> <span class='Operator'>= *</span><a href="tsearchcmds.c.html#LN1527"><span class='Ref_To_Local'>val</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN506"><span class='Ref_to_Macro'>SQL_STR_DOUBLE</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1537"><span class='Ref_To_Local'>ch</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>))</span> 
                <a href="../replication/syncrep_scanner.l.html#LN76"><span class='Ref_to_Proto'>appendStringInfoChar</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN1519"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1537"><span class='Ref_To_Local'>ch</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../replication/syncrep_scanner.l.html#LN76"><span class='Ref_to_Proto'>appendStringInfoChar</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN1519"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1537"><span class='Ref_To_Local'>ch</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="../replication/syncrep_scanner.l.html#LN76"><span class='Ref_to_Proto'>appendStringInfoChar</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN1519"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>'\''</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN104"><span class='Ref_to_Macro'>lnext</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1520"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
            <a href="../../bin/pg_waldump/compat.c.html#LN79"><span class='Ref_to_Func'>appendStringInfoString</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsearchcmds.c.html#LN1519"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>", "</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="tsearchcmds.c.html#LN1518"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/utils/builtins.h.html#LN86"><span class='Ref_to_Proto'>cstring_to_text_with_len</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1519"><span class='Ref_To_Local'>buf</span></a><span class='Operator'>.</span><a href="../../include/lib/stringinfo.h.html#LN36"><span class='Ref_to_Member'>data</span></a><span class='Delimiter'>, </span><a href="tsearchcmds.c.html#LN1519"><span class='Ref_To_Local'>buf</span></a><span class='Operator'>.</span><a href="../../include/lib/stringinfo.h.html#LN37"><span class='Ref_to_Member'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1519"><span class='Ref_To_Local'>buf</span></a><span class='Operator'>.</span><a href="../../include/lib/stringinfo.h.html#LN36"><span class='Ref_to_Member'>data</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="tsearchcmds.c.html#LN1518"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end serialize_deflist &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Deserialize dictionary options, reconstructing a List of DefElem from TEXT 
 * 
 * This is also used for prsheadline options, so for backward compatibility 
 * we need to accept a few things serialize_deflist() will never emit: 
 * in particular, unquoted and double-quoted values. 
 */ 
</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>* 
</span><a name="LN1561"></a><span class='Declare_Function'>deserialize_deflist</span><span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Declare_Parameter'>txt</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1563"></a>    <a href="../../../contrib/seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>in</span> <span class='Operator'>= </span><a href="../../include/fmgr.h.html#LN255"><span class='Ref_to_Macro'>DatumGetTextPP</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1561"><span class='Ref_to_Parameter'>txt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* in case it's toasted */ 
</span><a name="LN1564"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>result</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN1565"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span> <span class='Operator'>= </span><a href="../../include/postgres.h.html#LN339"><span class='Ref_to_Macro'>VARSIZE_ANY_EXHDR</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1563"><span class='Ref_To_Local'>in</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1566"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>ptr</span><span class='Delimiter'>, 
</span><a name="LN1567"></a>               <span class='Operator'>*</span><span class='Declare_Local'>endptr</span><span class='Delimiter'>, 
</span><a name="LN1568"></a>               <span class='Operator'>*</span><span class='Declare_Local'>workspace</span><span class='Delimiter'>, 
</span><a name="LN1569"></a>               <span class='Operator'>*</span><span class='Declare_Local'>wsptr</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span><a name="LN1570"></a>               <span class='Operator'>*</span><span class='Declare_Local'>startvalue</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>typedef</span> <span class='Control'>enum</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1573"></a>        <span class='Declare_Local'>CS_WAITKEY</span><span class='Delimiter'>, 
</span><a name="LN1574"></a>        <span class='Declare_Local'>CS_INKEY</span><span class='Delimiter'>, 
</span><a name="LN1575"></a>        <span class='Declare_Local'>CS_INQKEY</span><span class='Delimiter'>, 
</span><a name="LN1576"></a>        <span class='Declare_Local'>CS_WAITEQ</span><span class='Delimiter'>, 
</span><a name="LN1577"></a>        <span class='Declare_Local'>CS_WAITVALUE</span><span class='Delimiter'>, 
</span><a name="LN1578"></a>        <span class='Declare_Local'>CS_INSQVALUE</span><span class='Delimiter'>, 
</span><a name="LN1579"></a>        <span class='Declare_Local'>CS_INDQVALUE</span><span class='Delimiter'>, 
</span><a name="LN1580"></a>        <span class='Declare_Local'>CS_INWVALUE</span> 
<a name="LN1581"></a>    <span class='Delimiter'>} </span><span class='Declare_Local'>ds_state</span><span class='Delimiter'>; 
</span><a name="LN1582"></a>    <a href="tsearchcmds.c.html#LN1581"><span class='Ref_to_Typedef'>ds_state</span></a>    <span class='Declare_Local'>state</span> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1573"><span class='Ref_to_EnumConst'>CS_WAITKEY</span></a><span class='Delimiter'>; 
</span> 
    <a href="tsearchcmds.c.html#LN1568"><span class='Ref_To_Local'>workspace</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1565"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* certainly enough room */ 
</span>    <a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>= </span><a href="../../include/postgres.h.html#LN346"><span class='Ref_to_Macro'>VARDATA_ANY</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1563"><span class='Ref_To_Local'>in</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="tsearchcmds.c.html#LN1567"><span class='Ref_To_Local'>endptr</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>+ </span><a href="tsearchcmds.c.html#LN1565"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>; </span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>&LT; </span><a href="tsearchcmds.c.html#LN1567"><span class='Ref_To_Local'>endptr</span></a><span class='Delimiter'>; </span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1582"><span class='Ref_To_Local'>state</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>case</span> <a href="tsearchcmds.c.html#LN1573"><span class='Ref_to_EnumConst'>CS_WAITKEY</span></a><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span>isspace<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a><span class='Parentheses'>)</span> <span class='Operator'>|| *</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>== </span><span class='String'>','</span><span class='Parentheses'>)</span> 
                    <span class='Control'>continue</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>== </span><span class='String'>'"'</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <a href="tsearchcmds.c.html#LN1569"><span class='Ref_To_Local'>wsptr</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1568"><span class='Ref_To_Local'>workspace</span></a><span class='Delimiter'>; 
</span>                    <a href="tsearchcmds.c.html#LN1582"><span class='Ref_To_Local'>state</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1575"><span class='Ref_to_EnumConst'>CS_INQKEY</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                <span class='Delimiter'>{ 
</span>                    <a href="tsearchcmds.c.html#LN1569"><span class='Ref_To_Local'>wsptr</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1568"><span class='Ref_To_Local'>workspace</span></a><span class='Delimiter'>; 
</span>                    <span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1569"><span class='Ref_To_Local'>wsptr</span></a><span class='Operator'>++ = *</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>; 
</span>                    <a href="tsearchcmds.c.html#LN1582"><span class='Ref_To_Local'>state</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1574"><span class='Ref_to_EnumConst'>CS_INKEY</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="tsearchcmds.c.html#LN1574"><span class='Ref_to_EnumConst'>CS_INKEY</span></a><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span>isspace<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a><span class='Parentheses'>))</span> 
                <span class='Delimiter'>{ 
</span>                    <span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1569"><span class='Ref_To_Local'>wsptr</span></a><span class='Operator'>++ = </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>                    <a href="tsearchcmds.c.html#LN1582"><span class='Ref_To_Local'>state</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1576"><span class='Ref_to_EnumConst'>CS_WAITEQ</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>== </span><span class='String'>'='</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1569"><span class='Ref_To_Local'>wsptr</span></a><span class='Operator'>++ = </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>                    <a href="tsearchcmds.c.html#LN1582"><span class='Ref_To_Local'>state</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1577"><span class='Ref_to_EnumConst'>CS_WAITVALUE</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                <span class='Delimiter'>{ 
</span>                    <span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1569"><span class='Ref_To_Local'>wsptr</span></a><span class='Operator'>++ = *</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="tsearchcmds.c.html#LN1575"><span class='Ref_to_EnumConst'>CS_INQKEY</span></a><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>== </span><span class='String'>'"'</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>+ </span><span class='Number'>1</span> <span class='Operator'>&LT; </span><a href="tsearchcmds.c.html#LN1567"><span class='Ref_To_Local'>endptr</span></a> <span class='Operator'>&& </span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'"'</span><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <span class='Comment_Multi_Line'>/* copy only one of the two quotes */ 
</span>                        <span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1569"><span class='Ref_To_Local'>wsptr</span></a><span class='Operator'>++ = *</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    <span class='Control'>else</span> 
                    <span class='Delimiter'>{ 
</span>                        <span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1569"><span class='Ref_To_Local'>wsptr</span></a><span class='Operator'>++ = </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>                        <a href="tsearchcmds.c.html#LN1582"><span class='Ref_To_Local'>state</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1576"><span class='Ref_to_EnumConst'>CS_WAITEQ</span></a><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                <span class='Delimiter'>{ 
</span>                    <span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1569"><span class='Ref_To_Local'>wsptr</span></a><span class='Operator'>++ = *</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="tsearchcmds.c.html#LN1576"><span class='Ref_to_EnumConst'>CS_WAITEQ</span></a><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>== </span><span class='String'>'='</span><span class='Parentheses'>) 
</span>                    <a href="tsearchcmds.c.html#LN1582"><span class='Ref_To_Local'>state</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1577"><span class='Ref_to_EnumConst'>CS_WAITVALUE</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span>isspace<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a><span class='Parentheses'>))</span> 
                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"invalid parameter list format: \"%s\""</span><span class='Delimiter'>, 
</span>                                    <a href="../../include/utils/builtins.h.html#LN87"><span class='Ref_to_Proto'>text_to_cstring</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1563"><span class='Ref_To_Local'>in</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="tsearchcmds.c.html#LN1577"><span class='Ref_to_EnumConst'>CS_WAITVALUE</span></a><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>== </span><span class='String'>'\''</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <a href="tsearchcmds.c.html#LN1570"><span class='Ref_To_Local'>startvalue</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1569"><span class='Ref_To_Local'>wsptr</span></a><span class='Delimiter'>; 
</span>                    <a href="tsearchcmds.c.html#LN1582"><span class='Ref_To_Local'>state</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1578"><span class='Ref_to_EnumConst'>CS_INSQVALUE</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>== </span><span class='String'>'E'</span> <span class='Operator'>&& </span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>+ </span><span class='Number'>1</span> <span class='Operator'>&LT; </span><a href="tsearchcmds.c.html#LN1567"><span class='Ref_To_Local'>endptr</span></a> <span class='Operator'>&& </span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'\''</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                    <a href="tsearchcmds.c.html#LN1570"><span class='Ref_To_Local'>startvalue</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1569"><span class='Ref_To_Local'>wsptr</span></a><span class='Delimiter'>; 
</span>                    <a href="tsearchcmds.c.html#LN1582"><span class='Ref_To_Local'>state</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1578"><span class='Ref_to_EnumConst'>CS_INSQVALUE</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>== </span><span class='String'>'"'</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <a href="tsearchcmds.c.html#LN1570"><span class='Ref_To_Local'>startvalue</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1569"><span class='Ref_To_Local'>wsptr</span></a><span class='Delimiter'>; 
</span>                    <a href="tsearchcmds.c.html#LN1582"><span class='Ref_To_Local'>state</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1579"><span class='Ref_to_EnumConst'>CS_INDQVALUE</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span>isspace<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a><span class='Parentheses'>))</span> 
                <span class='Delimiter'>{ 
</span>                    <a href="tsearchcmds.c.html#LN1570"><span class='Ref_To_Local'>startvalue</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1569"><span class='Ref_To_Local'>wsptr</span></a><span class='Delimiter'>; 
</span>                    <span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1569"><span class='Ref_To_Local'>wsptr</span></a><span class='Operator'>++ = *</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>; 
</span>                    <a href="tsearchcmds.c.html#LN1582"><span class='Ref_To_Local'>state</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1580"><span class='Ref_to_EnumConst'>CS_INWVALUE</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="tsearchcmds.c.html#LN1578"><span class='Ref_to_EnumConst'>CS_INSQVALUE</span></a><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>== </span><span class='String'>'\''</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>+ </span><span class='Number'>1</span> <span class='Operator'>&LT; </span><a href="tsearchcmds.c.html#LN1567"><span class='Ref_To_Local'>endptr</span></a> <span class='Operator'>&& </span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'\''</span><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <span class='Comment_Multi_Line'>/* copy only one of the two quotes */ 
</span>                        <span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1569"><span class='Ref_To_Local'>wsptr</span></a><span class='Operator'>++ = *</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    <span class='Control'>else</span> 
                    <span class='Delimiter'>{ 
</span>                        <span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1569"><span class='Ref_To_Local'>wsptr</span></a><span class='Operator'>++ = </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>                        <a href="tsearchcmds.c.html#LN1564"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1564"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, 
</span>                                         <a href="../../include/nodes/makefuncs.h.html#LN82"><span class='Ref_to_Proto'>makeDefElem</span></a><span class='Parentheses'>(</span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1568"><span class='Ref_To_Local'>workspace</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                              <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>)</span> <a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1570"><span class='Ref_To_Local'>startvalue</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                        <a href="tsearchcmds.c.html#LN1582"><span class='Ref_To_Local'>state</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1573"><span class='Ref_to_EnumConst'>CS_WAITKEY</span></a><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>== </span><span class='String'>'\\'</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>+ </span><span class='Number'>1</span> <span class='Operator'>&LT; </span><a href="tsearchcmds.c.html#LN1567"><span class='Ref_To_Local'>endptr</span></a> <span class='Operator'>&& </span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'\\'</span><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <span class='Comment_Multi_Line'>/* copy only one of the two backslashes */ 
</span>                        <span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1569"><span class='Ref_To_Local'>wsptr</span></a><span class='Operator'>++ = *</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    <span class='Control'>else</span> 
                        <span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1569"><span class='Ref_To_Local'>wsptr</span></a><span class='Operator'>++ = *</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                <span class='Delimiter'>{ 
</span>                    <span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1569"><span class='Ref_To_Local'>wsptr</span></a><span class='Operator'>++ = *</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="tsearchcmds.c.html#LN1579"><span class='Ref_to_EnumConst'>CS_INDQVALUE</span></a><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>== </span><span class='String'>'"'</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>+ </span><span class='Number'>1</span> <span class='Operator'>&LT; </span><a href="tsearchcmds.c.html#LN1567"><span class='Ref_To_Local'>endptr</span></a> <span class='Operator'>&& </span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'"'</span><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <span class='Comment_Multi_Line'>/* copy only one of the two quotes */ 
</span>                        <span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1569"><span class='Ref_To_Local'>wsptr</span></a><span class='Operator'>++ = *</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    <span class='Control'>else</span> 
                    <span class='Delimiter'>{ 
</span>                        <span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1569"><span class='Ref_To_Local'>wsptr</span></a><span class='Operator'>++ = </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>                        <a href="tsearchcmds.c.html#LN1564"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1564"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, 
</span>                                         <a href="../../include/nodes/makefuncs.h.html#LN82"><span class='Ref_to_Proto'>makeDefElem</span></a><span class='Parentheses'>(</span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1568"><span class='Ref_To_Local'>workspace</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                              <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>)</span> <a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1570"><span class='Ref_To_Local'>startvalue</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                        <a href="tsearchcmds.c.html#LN1582"><span class='Ref_To_Local'>state</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1573"><span class='Ref_to_EnumConst'>CS_WAITKEY</span></a><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                <span class='Delimiter'>{ 
</span>                    <span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1569"><span class='Ref_To_Local'>wsptr</span></a><span class='Operator'>++ = *</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="tsearchcmds.c.html#LN1580"><span class='Ref_to_EnumConst'>CS_INWVALUE</span></a><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>== </span><span class='String'>','</span> <span class='Operator'>|| </span>isspace<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a><span class='Parentheses'>))</span> 
                <span class='Delimiter'>{ 
</span>                    <span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1569"><span class='Ref_To_Local'>wsptr</span></a><span class='Operator'>++ = </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>                    <a href="tsearchcmds.c.html#LN1564"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1564"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, 
</span>                                     <a href="../../include/nodes/makefuncs.h.html#LN82"><span class='Ref_to_Proto'>makeDefElem</span></a><span class='Parentheses'>(</span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1568"><span class='Ref_To_Local'>workspace</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                              <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>)</span> <a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1570"><span class='Ref_To_Local'>startvalue</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                    <a href="tsearchcmds.c.html#LN1582"><span class='Ref_To_Local'>state</span></a> <span class='Operator'>= </span><a href="tsearchcmds.c.html#LN1573"><span class='Ref_to_EnumConst'>CS_WAITKEY</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                <span class='Delimiter'>{ 
</span>                    <span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1569"><span class='Ref_To_Local'>wsptr</span></a><span class='Operator'>++ = *</span><a href="tsearchcmds.c.html#LN1566"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>default</span><span class='Operator'>: 
</span>                <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized deserialize_deflist state: %d"</span><span class='Delimiter'>, 
</span>                     <a href="tsearchcmds.c.html#LN1582"><span class='Ref_To_Local'>state</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch state &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for ;ptr&LT;endptr;ptr++ &raquo; </span> 
 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1582"><span class='Ref_To_Local'>state</span></a> <span class='Operator'>== </span><a href="tsearchcmds.c.html#LN1580"><span class='Ref_to_EnumConst'>CS_INWVALUE</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Operator'>*</span><a href="tsearchcmds.c.html#LN1569"><span class='Ref_To_Local'>wsptr</span></a><span class='Operator'>++ = </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>        <a href="tsearchcmds.c.html#LN1564"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1564"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, 
</span>                         <a href="../../include/nodes/makefuncs.h.html#LN82"><span class='Ref_to_Proto'>makeDefElem</span></a><span class='Parentheses'>(</span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1568"><span class='Ref_To_Local'>workspace</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                              <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>)</span> <a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1570"><span class='Ref_To_Local'>startvalue</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1582"><span class='Ref_To_Local'>state</span></a> <span class='Operator'>!= </span><a href="tsearchcmds.c.html#LN1573"><span class='Ref_to_EnumConst'>CS_WAITKEY</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"invalid parameter list format: \"%s\""</span><span class='Delimiter'>, 
</span>                        <a href="../../include/utils/builtins.h.html#LN87"><span class='Ref_to_Proto'>text_to_cstring</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1563"><span class='Ref_To_Local'>in</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="tsearchcmds.c.html#LN1568"><span class='Ref_To_Local'>workspace</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="tsearchcmds.c.html#LN1564"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end deserialize_deflist &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>