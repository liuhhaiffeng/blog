<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\backend\executor\nodeSubplan.c</title>
<LINK REL=StyleSheet HREF="../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\backend\executor\nodeSubplan.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:40 2017
</td></tr>
<tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * nodeSubplan.c 
 *    routines to support sub-selects appearing in expressions 
 * 
 * This module is concerned with executing SubPlan expression nodes, which 
 * should not be confused with sub-SELECTs appearing in FROM.  SubPlans are 
 * divided into "initplans", which are those that need only one evaluation per 
 * query (among other restrictions, this requires that they don't use any 
 * direct correlation variables from the parent plan level), and "regular" 
 * subplans, which are re-evaluated every time their result is required. 
 * 
 * 
 * Portions Copyright (c) 1996-2017, PostgreSQL Global Development Group 
 * Portions Copyright (c) 1994, Regents of the University of California 
 * 
 * IDENTIFICATION 
 *    src/backend/executor/nodeSubplan.c 
 * 
 *------------------------------------------------------------------------- 
 */ 
/* 
 *   INTERFACE ROUTINES 
 *      ExecSubPlan  - process a subselect 
 *      ExecInitSubPlan - initialize a subselect 
 */ 
</span><span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>&LT;limits.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;math.h&GT;</span> 
 
<span class='Keyword'>#include </span><span class='String'>"access/htup_details.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"executor/executor.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"executor/nodeSubplan.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"nodes/makefuncs.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/clauses.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/array.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/lsyscache.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/memutils.h"</span> 
 
 
<a name="LN41"></a><span class='Keyword'>static </span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Declare_Prototype'>ExecHashSubPlan</span><span class='Parentheses'>(</span><a href="../../include/nodes/execnodes.h.html#LN731"><span class='Ref_to_Struct'>SubPlanState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, 
</span><a name="LN42"></a>                <a href="../../include/nodes/execnodes.h.html#LN191"><span class='Ref_to_Struct'>ExprContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>econtext</span><span class='Delimiter'>, 
</span><a name="LN43"></a>                <span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>isNull</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN44"></a><span class='Keyword'>static </span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Declare_Prototype'>ExecScanSubPlan</span><span class='Parentheses'>(</span><a href="../../include/nodes/execnodes.h.html#LN731"><span class='Ref_to_Struct'>SubPlanState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, 
</span><a name="LN45"></a>                <a href="../../include/nodes/execnodes.h.html#LN191"><span class='Ref_to_Struct'>ExprContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>econtext</span><span class='Delimiter'>, 
</span><a name="LN46"></a>                <span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>isNull</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN47"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>buildSubPlanHash</span><span class='Parentheses'>(</span><a href="../../include/nodes/execnodes.h.html#LN731"><span class='Ref_to_Struct'>SubPlanState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, </span><a href="../../include/nodes/execnodes.h.html#LN191"><span class='Ref_to_Struct'>ExprContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>econtext</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN48"></a><span class='Keyword'>static bool </span><span class='Declare_Prototype'>findPartialMatch</span><span class='Parentheses'>(</span><a href="../../include/nodes/execnodes.h.html#LN561"><span class='Ref_to_Typedef'>TupleHashTable</span></a> <span class='Declare_Parameter'>hashtable</span><span class='Delimiter'>, </span><a href="../../include/executor/tuptable.h.html#LN112"><span class='Ref_to_Struct'>TupleTableSlot</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>slot</span><span class='Delimiter'>, 
</span><a name="LN49"></a>                 <a href="../../include/fmgr.h.html#LN55"><span class='Ref_to_Struct'>FmgrInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>eqfunctions</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN50"></a><span class='Keyword'>static bool </span><span class='Declare_Prototype'>slotAllNulls</span><span class='Parentheses'>(</span><a href="../../include/executor/tuptable.h.html#LN112"><span class='Ref_to_Struct'>TupleTableSlot</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>slot</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN51"></a><span class='Keyword'>static bool </span><span class='Declare_Prototype'>slotNoNulls</span><span class='Parentheses'>(</span><a href="../../include/executor/tuptable.h.html#LN112"><span class='Ref_to_Struct'>TupleTableSlot</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>slot</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* ---------------------------------------------------------------- 
 *      ExecSubPlan 
 * 
 * This is the main entry point for execution of a regular SubPlan. 
 * ---------------------------------------------------------------- 
 */ 
</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN61"></a><span class='Declare_Function'>ExecSubPlan</span><span class='Parentheses'>(</span><a href="../../include/nodes/execnodes.h.html#LN731"><span class='Ref_to_Struct'>SubPlanState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, 
</span><a name="LN62"></a>            <a href="../../include/nodes/execnodes.h.html#LN191"><span class='Ref_to_Struct'>ExprContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>econtext</span><span class='Delimiter'>, 
</span><a name="LN63"></a>            <span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>isNull</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN65"></a>    <a href="../../include/nodes/primnodes.h.html#LN678"><span class='Ref_to_Struct'>SubPlan</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>subplan</span> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN61"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN734"><span class='Ref_to_Member'>subplan</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Set non-null as default */ 
</span>    <span class='Operator'>*</span><a href="nodeSubplan.c.html#LN63"><span class='Ref_to_Parameter'>isNull</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Sanity checks */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN65"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN682"><span class='Ref_to_Member'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN625"><span class='Ref_to_EnumConst'>CTE_SUBLINK</span></a><span class='Parentheses'>) 
</span>        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"CTE subplans should not be executed via ExecSubPlan"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN65"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN705"><span class='Ref_to_Member'>setParam</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a> <span class='Operator'>&& </span><a href="nodeSubplan.c.html#LN65"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN682"><span class='Ref_to_Member'>subLinkType</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/primnodes.h.html#LN623"><span class='Ref_to_EnumConst'>MULTIEXPR_SUBLINK</span></a><span class='Parentheses'>) 
</span>        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cannot set parent params from subquery"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Select appropriate evaluation strategy */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN65"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN696"><span class='Ref_to_Member'>useHashTable</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="nodeSubplan.c.html#LN41"><span class='Ref_to_Proto'>ExecHashSubPlan</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN61"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN62"><span class='Ref_to_Parameter'>econtext</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN63"><span class='Ref_to_Parameter'>isNull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <a href="nodeSubplan.c.html#LN44"><span class='Ref_to_Proto'>ExecScanSubPlan</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN61"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN62"><span class='Ref_to_Parameter'>econtext</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN63"><span class='Ref_to_Parameter'>isNull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end ExecSubPlan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * ExecHashSubPlan: store subselect result in an in-memory hash table 
 */ 
</span><span class='Keyword'>static </span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN87"></a><span class='Declare_Function'>ExecHashSubPlan</span><span class='Parentheses'>(</span><a href="../../include/nodes/execnodes.h.html#LN731"><span class='Ref_to_Struct'>SubPlanState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, 
</span><a name="LN88"></a>                <a href="../../include/nodes/execnodes.h.html#LN191"><span class='Ref_to_Struct'>ExprContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>econtext</span><span class='Delimiter'>, 
</span><a name="LN89"></a>                <span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>isNull</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN91"></a>    <a href="../../include/nodes/primnodes.h.html#LN678"><span class='Ref_to_Struct'>SubPlan</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>subplan</span> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN87"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN734"><span class='Ref_to_Member'>subplan</span></a><span class='Delimiter'>; 
</span><a name="LN92"></a>    <a href="../../include/nodes/execnodes.h.html#LN808"><span class='Ref_to_Struct'>PlanState</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>planstate</span> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN87"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN735"><span class='Ref_to_Member'>planstate</span></a><span class='Delimiter'>; 
</span><a name="LN93"></a>    <a href="../../include/executor/tuptable.h.html#LN112"><span class='Ref_to_Struct'>TupleTableSlot</span></a> <span class='Operator'>*</span><span class='Declare_Local'>slot</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Shouldn't have any direct correlation Vars */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN91"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN707"><span class='Ref_to_Member'>parParam</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a> <span class='Operator'>|| </span><a href="nodeSubplan.c.html#LN87"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN738"><span class='Ref_to_Member'>args</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"hashed subplan with direct correlation not supported"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If first time through or we need to rescan the subplan, build the hash 
     * table. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN87"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN744"><span class='Ref_to_Member'>hashtable</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span><a href="nodeSubplan.c.html#LN92"><span class='Ref_To_Local'>planstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN836"><span class='Ref_to_Member'>chgParam</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <a href="nodeSubplan.c.html#LN47"><span class='Ref_to_Proto'>buildSubPlanHash</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN87"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN88"><span class='Ref_to_Parameter'>econtext</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * The result for an empty subplan is always FALSE; no need to evaluate 
     * lefthand side. 
     */ 
</span>    <span class='Operator'>*</span><a href="nodeSubplan.c.html#LN89"><span class='Ref_to_Parameter'>isNull</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="nodeSubplan.c.html#LN87"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN746"><span class='Ref_to_Member'>havehashrows</span></a> <span class='Operator'>&& !</span><a href="nodeSubplan.c.html#LN87"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN747"><span class='Ref_to_Member'>havenullrows</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Evaluate lefthand expressions and form a projection tuple. First we 
     * have to set the econtext to use (hack alert!). 
     */ 
</span>    <a href="nodeSubplan.c.html#LN87"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN742"><span class='Ref_to_Member'>projLeft</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN297"><span class='Ref_to_Member'>pi_exprContext</span></a> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN88"><span class='Ref_to_Parameter'>econtext</span></a><span class='Delimiter'>; 
</span>    <a href="nodeSubplan.c.html#LN93"><span class='Ref_To_Local'>slot</span></a> <span class='Operator'>= </span><a href="../../include/executor/executor.h.html#LN307"><span class='Ref_to_Func'>ExecProject</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN87"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN742"><span class='Ref_to_Member'>projLeft</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Note: because we are typically called in a per-tuple context, we have 
     * to explicitly clear the projected tuple before returning. Otherwise, 
     * we'll have a double-free situation: the per-tuple context will probably 
     * be reset before we're called again, and then the tuple slot will think 
     * it still needs to free the tuple. 
     */ 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If the LHS is all non-null, probe for an exact match in the main hash 
     * table.  If we find one, the result is TRUE. Otherwise, scan the 
     * partly-null table to see if there are any rows that aren't provably 
     * unequal to the LHS; if so, the result is UNKNOWN.  (We skip that part 
     * if we don't care about UNKNOWN.) Otherwise, the result is FALSE. 
     * 
     * Note: the reason we can avoid a full scan of the main hash table is 
     * that the combining operators are assumed never to yield NULL when both 
     * inputs are non-null.  If they were to do so, we might need to produce 
     * UNKNOWN instead of FALSE because of an UNKNOWN result in comparing the 
     * LHS to some main-table entry --- which is a comparison we will not even 
     * make, unless there's a chance match of hash keys. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN51"><span class='Ref_to_Proto'>slotNoNulls</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN93"><span class='Ref_To_Local'>slot</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN87"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN746"><span class='Ref_to_Member'>havehashrows</span></a> <span class='Operator'>&& 
</span>            <a href="../../include/executor/executor.h.html#LN141"><span class='Ref_to_Proto'>FindTupleHashEntry</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN87"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN744"><span class='Ref_to_Member'>hashtable</span></a><span class='Delimiter'>, 
</span>                               <a href="nodeSubplan.c.html#LN93"><span class='Ref_To_Local'>slot</span></a><span class='Delimiter'>, 
</span>                               <a href="nodeSubplan.c.html#LN87"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN755"><span class='Ref_to_Member'>cur_eq_funcs</span></a><span class='Delimiter'>, 
</span>                               <a href="nodeSubplan.c.html#LN87"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN754"><span class='Ref_to_Member'>lhs_hash_funcs</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="../../include/executor/tuptable.h.html#LN154"><span class='Ref_to_Proto'>ExecClearTuple</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN93"><span class='Ref_To_Local'>slot</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <a href="../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN87"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN747"><span class='Ref_to_Member'>havenullrows</span></a> <span class='Operator'>&& 
</span>            <a href="nodeSubplan.c.html#LN48"><span class='Ref_to_Proto'>findPartialMatch</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN87"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN745"><span class='Ref_to_Member'>hashnulls</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN93"><span class='Ref_To_Local'>slot</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN87"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN755"><span class='Ref_to_Member'>cur_eq_funcs</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="../../include/executor/tuptable.h.html#LN154"><span class='Ref_to_Proto'>ExecClearTuple</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN93"><span class='Ref_To_Local'>slot</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="nodeSubplan.c.html#LN89"><span class='Ref_to_Parameter'>isNull</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <a href="../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="../../include/executor/tuptable.h.html#LN154"><span class='Ref_to_Proto'>ExecClearTuple</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN93"><span class='Ref_To_Local'>slot</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if slotNoNulls(slot) &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* 
     * When the LHS is partly or wholly NULL, we can never return TRUE. If we 
     * don't care about UNKNOWN, just return FALSE.  Otherwise, if the LHS is 
     * wholly NULL, immediately return UNKNOWN.  (Since the combining 
     * operators are strict, the result could only be FALSE if the sub-select 
     * were empty, but we already handled that case.) Otherwise, we must scan 
     * both the main and partly-null tables to see if there are any rows that 
     * aren't provably unequal to the LHS; if so, the result is UNKNOWN. 
     * Otherwise, the result is FALSE. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN87"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN745"><span class='Ref_to_Member'>hashnulls</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="../../include/executor/tuptable.h.html#LN154"><span class='Ref_to_Proto'>ExecClearTuple</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN93"><span class='Ref_To_Local'>slot</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN50"><span class='Ref_to_Proto'>slotAllNulls</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN93"><span class='Ref_To_Local'>slot</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../include/executor/tuptable.h.html#LN154"><span class='Ref_to_Proto'>ExecClearTuple</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN93"><span class='Ref_To_Local'>slot</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="nodeSubplan.c.html#LN89"><span class='Ref_to_Parameter'>isNull</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* Scan partly-null table first, since more likely to get a match */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN87"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN747"><span class='Ref_to_Member'>havenullrows</span></a> <span class='Operator'>&& 
</span>        <a href="nodeSubplan.c.html#LN48"><span class='Ref_to_Proto'>findPartialMatch</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN87"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN745"><span class='Ref_to_Member'>hashnulls</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN93"><span class='Ref_To_Local'>slot</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN87"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN755"><span class='Ref_to_Member'>cur_eq_funcs</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../include/executor/tuptable.h.html#LN154"><span class='Ref_to_Proto'>ExecClearTuple</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN93"><span class='Ref_To_Local'>slot</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="nodeSubplan.c.html#LN89"><span class='Ref_to_Parameter'>isNull</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN87"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN746"><span class='Ref_to_Member'>havehashrows</span></a> <span class='Operator'>&& 
</span>        <a href="nodeSubplan.c.html#LN48"><span class='Ref_to_Proto'>findPartialMatch</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN87"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN744"><span class='Ref_to_Member'>hashtable</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN93"><span class='Ref_To_Local'>slot</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN87"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN755"><span class='Ref_to_Member'>cur_eq_funcs</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../include/executor/tuptable.h.html#LN154"><span class='Ref_to_Proto'>ExecClearTuple</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN93"><span class='Ref_To_Local'>slot</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="nodeSubplan.c.html#LN89"><span class='Ref_to_Parameter'>isNull</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="../../include/executor/tuptable.h.html#LN154"><span class='Ref_to_Proto'>ExecClearTuple</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN93"><span class='Ref_To_Local'>slot</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end ExecHashSubPlan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * ExecScanSubPlan: default case where we have to rescan subplan each time 
 */ 
</span><span class='Keyword'>static </span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN209"></a><span class='Declare_Function'>ExecScanSubPlan</span><span class='Parentheses'>(</span><a href="../../include/nodes/execnodes.h.html#LN731"><span class='Ref_to_Struct'>SubPlanState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, 
</span><a name="LN210"></a>                <a href="../../include/nodes/execnodes.h.html#LN191"><span class='Ref_to_Struct'>ExprContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>econtext</span><span class='Delimiter'>, 
</span><a name="LN211"></a>                <span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>isNull</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN213"></a>    <a href="../../include/nodes/primnodes.h.html#LN678"><span class='Ref_to_Struct'>SubPlan</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>subplan</span> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN209"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN734"><span class='Ref_to_Member'>subplan</span></a><span class='Delimiter'>; 
</span><a name="LN214"></a>    <a href="../../include/nodes/execnodes.h.html#LN808"><span class='Ref_to_Struct'>PlanState</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>planstate</span> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN209"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN735"><span class='Ref_to_Member'>planstate</span></a><span class='Delimiter'>; 
</span><a name="LN215"></a>    <a href="../../include/nodes/primnodes.h.html#LN616"><span class='Ref_to_Enum'>SubLinkType</span></a> <span class='Declare_Local'>subLinkType</span> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN213"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN682"><span class='Ref_to_Member'>subLinkType</span></a><span class='Delimiter'>; 
</span><a name="LN216"></a>    <a href="../../include/utils/palloc.h.html#LN35"><span class='Ref_to_Typedef'>MemoryContext</span></a> <span class='Declare_Local'>oldcontext</span><span class='Delimiter'>; 
</span><a name="LN217"></a>    <a href="../../include/executor/tuptable.h.html#LN112"><span class='Ref_to_Struct'>TupleTableSlot</span></a> <span class='Operator'>*</span><span class='Declare_Local'>slot</span><span class='Delimiter'>; 
</span><a name="LN218"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN219"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>found</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>;</span>  <span class='Comment_Single_Line'>/* TRUE if got at least one subplan tuple */ 
</span><a name="LN220"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>pvar</span><span class='Delimiter'>; 
</span><a name="LN221"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span><a name="LN222"></a>    <a href="../../include/utils/array.h.html#LN206"><span class='Ref_to_Struct'>ArrayBuildStateAny</span></a> <span class='Operator'>*</span><span class='Declare_Local'>astate</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * MULTIEXPR subplans, when "executed", just return NULL; but first we 
     * mark the subplan's output parameters as needing recalculation.  (This 
     * is a bit of a hack: it relies on the subplan appearing later in its 
     * targetlist than any of the referencing Params, so that all the Params 
     * have been evaluated before we re-mark them for the next evaluation 
     * cycle.  But in general resjunk tlist items appear after non-resjunk 
     * ones, so this should be safe.)  Unlike ExecReScanSetParamPlan, we do 
     * *not* set bits in the parent plan node's chgParam, because we don't 
     * want to cause a rescan of the parent. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN215"><span class='Ref_To_Local'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN623"><span class='Ref_to_EnumConst'>MULTIEXPR_SUBLINK</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN237"></a>        <a href="../../include/nodes/execnodes.h.html#LN402"><span class='Ref_to_Struct'>EState</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>estate</span> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN209"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN736"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN814"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>; 
</span> 
        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN221"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN213"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN705"><span class='Ref_to_Member'>setParam</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN241"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>paramid</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN106"><span class='Ref_to_Macro'>lfirst_int</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN221"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN242"></a>            <a href="../../include/nodes/params.h.html#LN96"><span class='Ref_to_Struct'>ParamExecData</span></a> <span class='Operator'>*</span><span class='Declare_Local'>prm</span> <span class='Operator'>= &</span><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN237"><span class='Ref_To_Local'>estate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN442"><span class='Ref_to_Member'>es_param_exec_vals</span></a><span class='Delimiter'>[</span><a href="nodeSubplan.c.html#LN241"><span class='Ref_To_Local'>paramid</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="nodeSubplan.c.html#LN242"><span class='Ref_To_Local'>prm</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/params.h.html#LN98"><span class='Ref_to_Member'>execPlan</span></a> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN209"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Operator'>*</span><a href="nodeSubplan.c.html#LN211"><span class='Ref_to_Parameter'>isNull</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>) </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Initialize ArrayBuildStateAny in caller's context, if needed */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN215"><span class='Ref_To_Local'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN624"><span class='Ref_to_EnumConst'>ARRAY_SUBLINK</span></a><span class='Parentheses'>) 
</span>        <a href="nodeSubplan.c.html#LN222"><span class='Ref_To_Local'>astate</span></a> <span class='Operator'>= </span><a href="../../include/utils/array.h.html#LN408"><span class='Ref_to_Proto'>initArrayResultAny</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN213"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN691"><span class='Ref_to_Member'>firstColType</span></a><span class='Delimiter'>, 
</span>                                    <a href="../utils/mmgr/mcxt.c.html#LN36"><span class='Ref_to_Global_Var'>CurrentMemoryContext</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We are probably in a short-lived expression-evaluation context. Switch 
     * to the per-query context for manipulating the child plan's chgParam, 
     * calling ExecProcNode on it, etc. 
     */ 
</span>    <a href="nodeSubplan.c.html#LN216"><span class='Ref_To_Local'>oldcontext</span></a> <span class='Operator'>= </span><a href="../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN210"><span class='Ref_to_Parameter'>econtext</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN201"><span class='Ref_to_Member'>ecxt_per_query_memory</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Set Params of this plan from parent plan correlation values. (Any 
     * calculation we have to do is done in the parent econtext, since the 
     * Param values don't need to have per-query lifetime.) 
     */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN213"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN707"><span class='Ref_to_Member'>parParam</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN209"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN738"><span class='Ref_to_Member'>args</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN179"><span class='Ref_to_Macro'>forboth</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN221"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN213"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN707"><span class='Ref_to_Member'>parParam</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN220"><span class='Ref_To_Local'>pvar</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN209"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN738"><span class='Ref_to_Member'>args</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN271"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>paramid</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN106"><span class='Ref_to_Macro'>lfirst_int</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN221"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN272"></a>        <a href="../../include/nodes/params.h.html#LN96"><span class='Ref_to_Struct'>ParamExecData</span></a> <span class='Operator'>*</span><span class='Declare_Local'>prm</span> <span class='Operator'>= &</span><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN210"><span class='Ref_to_Parameter'>econtext</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN205"><span class='Ref_to_Member'>ecxt_param_exec_vals</span></a><span class='Delimiter'>[</span><a href="nodeSubplan.c.html#LN271"><span class='Ref_To_Local'>paramid</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="nodeSubplan.c.html#LN272"><span class='Ref_To_Local'>prm</span></a><span class='Operator'>-&GT;</span><span class='Keyword'>value </span><span class='Operator'>= </span><a href="../../include/executor/executor.h.html#LN279"><span class='Ref_to_Func'>ExecEvalExprSwitchContext</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/execnodes.h.html#LN52"><span class='Ref_to_Struct'>ExprState</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN220"><span class='Ref_To_Local'>pvar</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                               <a href="nodeSubplan.c.html#LN210"><span class='Ref_to_Parameter'>econtext</span></a><span class='Delimiter'>, 
</span>                                               <span class='Operator'>&</span><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN272"><span class='Ref_To_Local'>prm</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/params.h.html#LN100"><span class='Ref_to_Member'>isnull</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="nodeSubplan.c.html#LN214"><span class='Ref_To_Local'>planstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN836"><span class='Ref_to_Member'>chgParam</span></a> <span class='Operator'>= </span><a href="../../include/nodes/bitmapset.h.html#LN89"><span class='Ref_to_Proto'>bms_add_member</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN214"><span class='Ref_To_Local'>planstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN836"><span class='Ref_to_Member'>chgParam</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN271"><span class='Ref_To_Local'>paramid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Now that we've set up its parameters, we can reset the subplan. 
     */ 
</span>    <a href="execAmi.c.html#LN73"><span class='Ref_to_Func'>ExecReScan</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN214"><span class='Ref_To_Local'>planstate</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * For all sublink types except EXPR_SUBLINK and ARRAY_SUBLINK, the result 
     * is boolean as are the results of the combining operators. We combine 
     * results across tuples (if the subplan produces more than one) using OR 
     * semantics for ANY_SUBLINK or AND semantics for ALL_SUBLINK. 
     * (ROWCOMPARE_SUBLINK doesn't allow multiple tuples from the subplan.) 
     * NULL results from the combining operators are handled according to the 
     * usual SQL semantics for OR and AND.  The result for no input tuples is 
     * FALSE for ANY_SUBLINK, TRUE for ALL_SUBLINK, NULL for 
     * ROWCOMPARE_SUBLINK. 
     * 
     * For EXPR_SUBLINK we require the subplan to produce no more than one 
     * tuple, else an error is raised.  If zero tuples are produced, we return 
     * NULL.  Assuming we get a tuple, we just use its first column (there can 
     * be only one non-junk column in this case). 
     * 
     * For ARRAY_SUBLINK we allow the subplan to produce any number of tuples, 
     * and form an array of the first column's values.  Note in particular 
     * that we produce a zero-element array if no tuples are produced (this is 
     * a change from pre-8.3 behavior of returning NULL). 
     */ 
</span>    <a href="nodeSubplan.c.html#LN218"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN215"><span class='Ref_To_Local'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN619"><span class='Ref_to_EnumConst'>ALL_SUBLINK</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="nodeSubplan.c.html#LN211"><span class='Ref_to_Parameter'>isNull</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN217"><span class='Ref_To_Local'>slot</span></a> <span class='Operator'>= </span><a href="../../include/executor/executor.h.html#LN229"><span class='Ref_to_Proto'>ExecProcNode</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN214"><span class='Ref_To_Local'>planstate</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>         <span class='Operator'>!</span><a href="../../include/executor/tuptable.h.html#LN137"><span class='Ref_to_Macro'>TupIsNull</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN217"><span class='Ref_To_Local'>slot</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>         <a href="nodeSubplan.c.html#LN217"><span class='Ref_To_Local'>slot</span></a> <span class='Operator'>= </span><a href="../../include/executor/executor.h.html#LN229"><span class='Ref_to_Proto'>ExecProcNode</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN214"><span class='Ref_To_Local'>planstate</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN313"></a>        <a href="../../include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a>   <span class='Declare_Local'>tdesc</span> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN217"><span class='Ref_To_Local'>slot</span></a><span class='Operator'>-&GT;</span><a href="../../include/executor/tuptable.h.html#LN120"><span class='Ref_to_Member'>tts_tupleDescriptor</span></a><span class='Delimiter'>; 
</span><a name="LN314"></a>        <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>rowresult</span><span class='Delimiter'>; 
</span><a name="LN315"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>rownull</span><span class='Delimiter'>; 
</span><a name="LN316"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>col</span><span class='Delimiter'>; 
</span><a name="LN317"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>plst</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN215"><span class='Ref_To_Local'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN618"><span class='Ref_to_EnumConst'>EXISTS_SUBLINK</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="nodeSubplan.c.html#LN219"><span class='Ref_To_Local'>found</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <a href="nodeSubplan.c.html#LN218"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN215"><span class='Ref_To_Local'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN622"><span class='Ref_to_EnumConst'>EXPR_SUBLINK</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* cannot allow multiple input tuples for EXPR sublink */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN219"><span class='Ref_To_Local'>found</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_CARDINALITY_VIOLATION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"more than one row returned by a subquery used as an expression"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <a href="nodeSubplan.c.html#LN219"><span class='Ref_To_Local'>found</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * We need to copy the subplan's tuple in case the result is of 
             * pass-by-ref type --- our return value will point into this 
             * copied tuple!  Can't use the subplan's instance of the tuple 
             * since it won't still be valid after next ExecProcNode() call. 
             * node-&GT;curTuple keeps track of the copied tuple for eventual 
             * freeing. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN209"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN739"><span class='Ref_to_Member'>curTuple</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/access/htup_details.h.html#LN815"><span class='Ref_to_Proto'>heap_freetuple</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN209"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN739"><span class='Ref_to_Member'>curTuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="nodeSubplan.c.html#LN209"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN739"><span class='Ref_to_Member'>curTuple</span></a> <span class='Operator'>= </span><a href="../../include/executor/tuptable.h.html#LN157"><span class='Ref_to_Proto'>ExecCopySlotTuple</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN217"><span class='Ref_To_Local'>slot</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="nodeSubplan.c.html#LN218"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/access/htup_details.h.html#LN768"><span class='Ref_to_Macro'>heap_getattr</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN209"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN739"><span class='Ref_to_Member'>curTuple</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN313"><span class='Ref_To_Local'>tdesc</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN211"><span class='Ref_to_Parameter'>isNull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* keep scanning subplan to make sure there's only one tuple */ 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if subLinkType==EXPR_SUB... &raquo; </span> 
 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN215"><span class='Ref_To_Local'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN624"><span class='Ref_to_EnumConst'>ARRAY_SUBLINK</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN354"></a>            <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>dvalue</span><span class='Delimiter'>; 
</span><a name="LN355"></a>            <span class='Keyword'>bool</span>        <span class='Declare_Local'>disnull</span><span class='Delimiter'>; 
</span> 
            <a href="nodeSubplan.c.html#LN219"><span class='Ref_To_Local'>found</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* stash away current value */ 
</span>            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN213"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN691"><span class='Ref_to_Member'>firstColType</span></a> <span class='Operator'>== </span><a href="nodeSubplan.c.html#LN313"><span class='Ref_To_Local'>tdesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN73"><span class='Ref_to_Member'>attrs</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span>atttypid<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="nodeSubplan.c.html#LN354"><span class='Ref_To_Local'>dvalue</span></a> <span class='Operator'>= </span><a href="../../include/executor/tuptable.h.html#LN167"><span class='Ref_to_Proto'>slot_getattr</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN217"><span class='Ref_To_Local'>slot</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="nodeSubplan.c.html#LN355"><span class='Ref_To_Local'>disnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="nodeSubplan.c.html#LN222"><span class='Ref_To_Local'>astate</span></a> <span class='Operator'>= </span><a href="../../include/utils/array.h.html#LN410"><span class='Ref_to_Proto'>accumArrayResultAny</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN222"><span class='Ref_To_Local'>astate</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN354"><span class='Ref_To_Local'>dvalue</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN355"><span class='Ref_To_Local'>disnull</span></a><span class='Delimiter'>, 
</span>                                         <a href="nodeSubplan.c.html#LN213"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN691"><span class='Ref_to_Member'>firstColType</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN216"><span class='Ref_To_Local'>oldcontext</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* keep scanning subplan to collect all values */ 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* cannot allow multiple input tuples for ROWCOMPARE sublink either */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN215"><span class='Ref_To_Local'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN621"><span class='Ref_to_EnumConst'>ROWCOMPARE_SUBLINK</span></a> <span class='Operator'>&& </span><a href="nodeSubplan.c.html#LN219"><span class='Ref_To_Local'>found</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_CARDINALITY_VIOLATION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"more than one row returned by a subquery used as an expression"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <a href="nodeSubplan.c.html#LN219"><span class='Ref_To_Local'>found</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * For ALL, ANY, and ROWCOMPARE sublinks, load up the Params 
         * representing the columns of the sub-select, and then evaluate the 
         * combining expression. 
         */ 
</span>        <a href="nodeSubplan.c.html#LN316"><span class='Ref_To_Local'>col</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN317"><span class='Ref_To_Local'>plst</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN213"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN685"><span class='Ref_to_Member'>paramIds</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN383"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>paramid</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN106"><span class='Ref_to_Macro'>lfirst_int</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN317"><span class='Ref_To_Local'>plst</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN384"></a>            <a href="../../include/nodes/params.h.html#LN96"><span class='Ref_to_Struct'>ParamExecData</span></a> <span class='Operator'>*</span><span class='Declare_Local'>prmdata</span><span class='Delimiter'>; 
</span> 
            <a href="nodeSubplan.c.html#LN384"><span class='Ref_To_Local'>prmdata</span></a> <span class='Operator'>= &</span><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN210"><span class='Ref_to_Parameter'>econtext</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN205"><span class='Ref_to_Member'>ecxt_param_exec_vals</span></a><span class='Delimiter'>[</span><a href="nodeSubplan.c.html#LN383"><span class='Ref_To_Local'>paramid</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN384"><span class='Ref_To_Local'>prmdata</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/params.h.html#LN98"><span class='Ref_to_Member'>execPlan</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="nodeSubplan.c.html#LN384"><span class='Ref_To_Local'>prmdata</span></a><span class='Operator'>-&GT;</span><span class='Keyword'>value </span><span class='Operator'>= </span><a href="../../include/executor/tuptable.h.html#LN167"><span class='Ref_to_Proto'>slot_getattr</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN217"><span class='Ref_To_Local'>slot</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN316"><span class='Ref_To_Local'>col</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN384"><span class='Ref_To_Local'>prmdata</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/params.h.html#LN100"><span class='Ref_to_Member'>isnull</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="nodeSubplan.c.html#LN316"><span class='Ref_To_Local'>col</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="nodeSubplan.c.html#LN314"><span class='Ref_To_Local'>rowresult</span></a> <span class='Operator'>= </span><a href="../../include/executor/executor.h.html#LN279"><span class='Ref_to_Func'>ExecEvalExprSwitchContext</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN209"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN737"><span class='Ref_to_Member'>testexpr</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN210"><span class='Ref_to_Parameter'>econtext</span></a><span class='Delimiter'>, 
</span>                                              <span class='Operator'>&</span><a href="nodeSubplan.c.html#LN315"><span class='Ref_To_Local'>rownull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN215"><span class='Ref_To_Local'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN620"><span class='Ref_to_EnumConst'>ANY_SUBLINK</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* combine across rows per OR semantics */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN315"><span class='Ref_To_Local'>rownull</span></a><span class='Parentheses'>) 
</span>                <span class='Operator'>*</span><a href="nodeSubplan.c.html#LN211"><span class='Ref_to_Parameter'>isNull</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN314"><span class='Ref_To_Local'>rowresult</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span>                <a href="nodeSubplan.c.html#LN218"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Operator'>*</span><a href="nodeSubplan.c.html#LN211"><span class='Ref_to_Parameter'>isNull</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>;</span>          <span class='Comment_Single_Line'>/* needn't look at any more rows */ 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN215"><span class='Ref_To_Local'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN619"><span class='Ref_to_EnumConst'>ALL_SUBLINK</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* combine across rows per AND semantics */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN315"><span class='Ref_To_Local'>rownull</span></a><span class='Parentheses'>) 
</span>                <span class='Operator'>*</span><a href="nodeSubplan.c.html#LN211"><span class='Ref_to_Parameter'>isNull</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN314"><span class='Ref_To_Local'>rowresult</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span>                <a href="nodeSubplan.c.html#LN218"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Operator'>*</span><a href="nodeSubplan.c.html#LN211"><span class='Ref_to_Parameter'>isNull</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>;</span>          <span class='Comment_Single_Line'>/* needn't look at any more rows */ 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* must be ROWCOMPARE_SUBLINK */ 
</span>            <a href="nodeSubplan.c.html#LN218"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN314"><span class='Ref_To_Local'>rowresult</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="nodeSubplan.c.html#LN211"><span class='Ref_to_Parameter'>isNull</span></a> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN315"><span class='Ref_To_Local'>rownull</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for slot=ExecProcNode(pla... &raquo; </span> 
 
    <a href="../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN216"><span class='Ref_To_Local'>oldcontext</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN215"><span class='Ref_To_Local'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN624"><span class='Ref_to_EnumConst'>ARRAY_SUBLINK</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* We return the result in the caller's context */ 
</span>        <a href="nodeSubplan.c.html#LN218"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/utils/array.h.html#LN414"><span class='Ref_to_Proto'>makeArrayResultAny</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN222"><span class='Ref_To_Local'>astate</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN216"><span class='Ref_To_Local'>oldcontext</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="nodeSubplan.c.html#LN219"><span class='Ref_To_Local'>found</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * deal with empty subplan result.  result/isNull were previously 
         * initialized correctly for all sublink types except EXPR and 
         * ROWCOMPARE; for those, return NULL. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN215"><span class='Ref_To_Local'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN622"><span class='Ref_to_EnumConst'>EXPR_SUBLINK</span></a> <span class='Operator'>|| 
</span>            <a href="nodeSubplan.c.html#LN215"><span class='Ref_To_Local'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN621"><span class='Ref_to_EnumConst'>ROWCOMPARE_SUBLINK</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="nodeSubplan.c.html#LN218"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>) </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="nodeSubplan.c.html#LN211"><span class='Ref_to_Parameter'>isNull</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="nodeSubplan.c.html#LN218"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end ExecScanSubPlan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * buildSubPlanHash: load hash table by scanning subplan output. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN456"></a><span class='Declare_Function'>buildSubPlanHash</span><span class='Parentheses'>(</span><a href="../../include/nodes/execnodes.h.html#LN731"><span class='Ref_to_Struct'>SubPlanState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, </span><a href="../../include/nodes/execnodes.h.html#LN191"><span class='Ref_to_Struct'>ExprContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>econtext</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN458"></a>    <a href="../../include/nodes/primnodes.h.html#LN678"><span class='Ref_to_Struct'>SubPlan</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>subplan</span> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN734"><span class='Ref_to_Member'>subplan</span></a><span class='Delimiter'>; 
</span><a name="LN459"></a>    <a href="../../include/nodes/execnodes.h.html#LN808"><span class='Ref_to_Struct'>PlanState</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>planstate</span> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN735"><span class='Ref_to_Member'>planstate</span></a><span class='Delimiter'>; 
</span><a name="LN460"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>ncols</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN458"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN685"><span class='Ref_to_Member'>paramIds</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN461"></a>    <a href="../../include/nodes/execnodes.h.html#LN191"><span class='Ref_to_Struct'>ExprContext</span></a> <span class='Operator'>*</span><span class='Declare_Local'>innerecontext</span> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN750"><span class='Ref_to_Member'>innerecontext</span></a><span class='Delimiter'>; 
</span><a name="LN462"></a>    <a href="../../include/utils/palloc.h.html#LN35"><span class='Ref_to_Typedef'>MemoryContext</span></a> <span class='Declare_Local'>oldcontext</span><span class='Delimiter'>; 
</span><a name="LN463"></a>    <span class='Keyword'>long</span>        <span class='Declare_Local'>nbuckets</span><span class='Delimiter'>; 
</span><a name="LN464"></a>    <a href="../../include/executor/tuptable.h.html#LN112"><span class='Ref_to_Struct'>TupleTableSlot</span></a> <span class='Operator'>*</span><span class='Declare_Local'>slot</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN458"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN682"><span class='Ref_to_Member'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN620"><span class='Ref_to_EnumConst'>ANY_SUBLINK</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If we already had any hash tables, destroy 'em; then create empty hash 
     * table(s). 
     * 
     * If we need to distinguish accurately between FALSE and UNKNOWN (i.e., 
     * NULL) results of the IN operation, then we have to store subplan output 
     * rows that are partly or wholly NULL.  We store such rows in a separate 
     * hash table that we expect will be much smaller than the main table. (We 
     * can use hashing to eliminate partly-null rows that are not distinct. We 
     * keep them separate to minimize the cost of the inevitable full-table 
     * searches; see findPartialMatch.) 
     * 
     * If it's not necessary to distinguish FALSE and UNKNOWN, then we don't 
     * need to store subplan output rows that contain NULL. 
     */ 
</span>    <a href="../../include/utils/memutils.h.html#LN73"><span class='Ref_to_Proto'>MemoryContextReset</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN748"><span class='Ref_to_Member'>hashtablecxt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN744"><span class='Ref_to_Member'>hashtable</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN745"><span class='Ref_to_Member'>hashnulls</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN746"><span class='Ref_to_Member'>havehashrows</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN747"><span class='Ref_to_Member'>havenullrows</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <a href="nodeSubplan.c.html#LN463"><span class='Ref_To_Local'>nbuckets</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>long</span><span class='Parentheses'>) </span><a href="../../interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN459"><span class='Ref_To_Local'>planstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN812"><span class='Ref_to_Member'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/plannodes.h.html#LN130"><span class='Ref_to_Member'>plan_rows</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>double</span><span class='Parentheses'>) </span>LONG_MAX<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN463"><span class='Ref_To_Local'>nbuckets</span></a> <span class='Operator'>&LT; </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>        <a href="nodeSubplan.c.html#LN463"><span class='Ref_To_Local'>nbuckets</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN744"><span class='Ref_to_Member'>hashtable</span></a> <span class='Operator'>= </span><a href="../../include/executor/executor.h.html#LN132"><span class='Ref_to_Proto'>BuildTupleHashTable</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN460"><span class='Ref_To_Local'>ncols</span></a><span class='Delimiter'>, 
</span>                                          <a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN751"><span class='Ref_to_Member'>keyColIdx</span></a><span class='Delimiter'>, 
</span>                                          <a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN753"><span class='Ref_to_Member'>tab_eq_funcs</span></a><span class='Delimiter'>, 
</span>                                          <a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN752"><span class='Ref_to_Member'>tab_hash_funcs</span></a><span class='Delimiter'>, 
</span>                                          <a href="nodeSubplan.c.html#LN463"><span class='Ref_To_Local'>nbuckets</span></a><span class='Delimiter'>, 
</span>                                          <span class='Number'>0</span><span class='Delimiter'>, 
</span>                                          <a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN748"><span class='Ref_to_Member'>hashtablecxt</span></a><span class='Delimiter'>, 
</span>                                          <a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN749"><span class='Ref_to_Member'>hashtempcxt</span></a><span class='Delimiter'>, 
</span>                                          <span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="nodeSubplan.c.html#LN458"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN698"><span class='Ref_to_Member'>unknownEqFalse</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN460"><span class='Ref_To_Local'>ncols</span></a> <span class='Operator'>== </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>            <a href="nodeSubplan.c.html#LN463"><span class='Ref_To_Local'>nbuckets</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* there can only be one entry */ 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="nodeSubplan.c.html#LN463"><span class='Ref_To_Local'>nbuckets</span></a> <span class='Operator'>/= </span><span class='Number'>16</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN463"><span class='Ref_To_Local'>nbuckets</span></a> <span class='Operator'>&LT; </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>                <a href="nodeSubplan.c.html#LN463"><span class='Ref_To_Local'>nbuckets</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN745"><span class='Ref_to_Member'>hashnulls</span></a> <span class='Operator'>= </span><a href="../../include/executor/executor.h.html#LN132"><span class='Ref_to_Proto'>BuildTupleHashTable</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN460"><span class='Ref_To_Local'>ncols</span></a><span class='Delimiter'>, 
</span>                                              <a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN751"><span class='Ref_to_Member'>keyColIdx</span></a><span class='Delimiter'>, 
</span>                                              <a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN753"><span class='Ref_to_Member'>tab_eq_funcs</span></a><span class='Delimiter'>, 
</span>                                              <a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN752"><span class='Ref_to_Member'>tab_hash_funcs</span></a><span class='Delimiter'>, 
</span>                                              <a href="nodeSubplan.c.html#LN463"><span class='Ref_To_Local'>nbuckets</span></a><span class='Delimiter'>, 
</span>                                              <span class='Number'>0</span><span class='Delimiter'>, 
</span>                                              <a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN748"><span class='Ref_to_Member'>hashtablecxt</span></a><span class='Delimiter'>, 
</span>                                              <a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN749"><span class='Ref_to_Member'>hashtempcxt</span></a><span class='Delimiter'>, 
</span>                                              <span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if !subplan-&GT;unknownEqFa... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* 
     * We are probably in a short-lived expression-evaluation context. Switch 
     * to the per-query context for manipulating the child plan. 
     */ 
</span>    <a href="nodeSubplan.c.html#LN462"><span class='Ref_To_Local'>oldcontext</span></a> <span class='Operator'>= </span><a href="../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>econtext</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN201"><span class='Ref_to_Member'>ecxt_per_query_memory</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Reset subplan to start. 
     */ 
</span>    <a href="execAmi.c.html#LN73"><span class='Ref_to_Func'>ExecReScan</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN459"><span class='Ref_To_Local'>planstate</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Scan the subplan and load the hash table(s).  Note that when there are 
     * duplicate rows coming out of the sub-select, only one copy is stored. 
     */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN464"><span class='Ref_To_Local'>slot</span></a> <span class='Operator'>= </span><a href="../../include/executor/executor.h.html#LN229"><span class='Ref_to_Proto'>ExecProcNode</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN459"><span class='Ref_To_Local'>planstate</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>         <span class='Operator'>!</span><a href="../../include/executor/tuptable.h.html#LN137"><span class='Ref_to_Macro'>TupIsNull</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN464"><span class='Ref_To_Local'>slot</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>         <a href="nodeSubplan.c.html#LN464"><span class='Ref_To_Local'>slot</span></a> <span class='Operator'>= </span><a href="../../include/executor/executor.h.html#LN229"><span class='Ref_to_Proto'>ExecProcNode</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN459"><span class='Ref_To_Local'>planstate</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN543"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>col</span> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span><a name="LN544"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>plst</span><span class='Delimiter'>; 
</span><a name="LN545"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>isnew</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Load up the Params representing the raw sub-select outputs, then 
         * form the projection tuple to store in the hashtable. 
         */ 
</span>        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN544"><span class='Ref_To_Local'>plst</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN458"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN685"><span class='Ref_to_Member'>paramIds</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN553"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>paramid</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN106"><span class='Ref_to_Macro'>lfirst_int</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN544"><span class='Ref_To_Local'>plst</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN554"></a>            <a href="../../include/nodes/params.h.html#LN96"><span class='Ref_to_Struct'>ParamExecData</span></a> <span class='Operator'>*</span><span class='Declare_Local'>prmdata</span><span class='Delimiter'>; 
</span> 
            <a href="nodeSubplan.c.html#LN554"><span class='Ref_To_Local'>prmdata</span></a> <span class='Operator'>= &</span><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN461"><span class='Ref_To_Local'>innerecontext</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN205"><span class='Ref_to_Member'>ecxt_param_exec_vals</span></a><span class='Delimiter'>[</span><a href="nodeSubplan.c.html#LN553"><span class='Ref_To_Local'>paramid</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN554"><span class='Ref_To_Local'>prmdata</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/params.h.html#LN98"><span class='Ref_to_Member'>execPlan</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="nodeSubplan.c.html#LN554"><span class='Ref_To_Local'>prmdata</span></a><span class='Operator'>-&GT;</span><span class='Keyword'>value </span><span class='Operator'>= </span><a href="../../include/executor/tuptable.h.html#LN167"><span class='Ref_to_Proto'>slot_getattr</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN464"><span class='Ref_To_Local'>slot</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN543"><span class='Ref_To_Local'>col</span></a><span class='Delimiter'>, 
</span>                                          <span class='Operator'>&</span><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN554"><span class='Ref_To_Local'>prmdata</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/params.h.html#LN100"><span class='Ref_to_Member'>isnull</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="nodeSubplan.c.html#LN543"><span class='Ref_To_Local'>col</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="nodeSubplan.c.html#LN464"><span class='Ref_To_Local'>slot</span></a> <span class='Operator'>= </span><a href="../../include/executor/executor.h.html#LN307"><span class='Ref_to_Func'>ExecProject</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN743"><span class='Ref_to_Member'>projRight</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If result contains any nulls, store separately or not at all. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN51"><span class='Ref_to_Proto'>slotNoNulls</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN464"><span class='Ref_To_Local'>slot</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="../../include/executor/executor.h.html#LN138"><span class='Ref_to_Proto'>LookupTupleHashEntry</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN744"><span class='Ref_to_Member'>hashtable</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN464"><span class='Ref_To_Local'>slot</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="nodeSubplan.c.html#LN545"><span class='Ref_To_Local'>isnew</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN746"><span class='Ref_to_Member'>havehashrows</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN745"><span class='Ref_to_Member'>hashnulls</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="../../include/executor/executor.h.html#LN138"><span class='Ref_to_Proto'>LookupTupleHashEntry</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN745"><span class='Ref_to_Member'>hashnulls</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN464"><span class='Ref_To_Local'>slot</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="nodeSubplan.c.html#LN545"><span class='Ref_To_Local'>isnew</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN747"><span class='Ref_to_Member'>havenullrows</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Reset innerecontext after each inner tuple to free any memory used 
         * during ExecProject. 
         */ 
</span>        <a href="../../include/executor/executor.h.html#LN449"><span class='Ref_to_Macro'>ResetExprContext</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN461"><span class='Ref_To_Local'>innerecontext</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for slot=ExecProcNode(pla... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* 
     * Since the projected tuples are in the sub-query's context and not the 
     * main context, we'd better clear the tuple slot before there's any 
     * chance of a reset of the sub-query's context.  Else we will have the 
     * potential for a double free attempt.  (XXX possibly no longer needed, 
     * but can't hurt.) 
     */ 
</span>    <a href="../../include/executor/tuptable.h.html#LN154"><span class='Ref_to_Proto'>ExecClearTuple</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN456"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN743"><span class='Ref_to_Member'>projRight</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN295"><span class='Ref_to_Member'>pi_state</span></a><span class='Operator'>.</span><a href="../../include/nodes/execnodes.h.html#LN68"><span class='Ref_to_Member'>resultslot</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN462"><span class='Ref_To_Local'>oldcontext</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end buildSubPlanHash &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * findPartialMatch: does the hashtable contain an entry that is not 
 * provably distinct from the tuple? 
 * 
 * We have to scan the whole hashtable; we can't usefully use hashkeys 
 * to guide probing, since we might get partial matches on tuples with 
 * hashkeys quite unrelated to what we'd get from the given tuple. 
 * 
 * Caller must provide the equality functions to use, since in cross-type 
 * cases these are different from the hashtable's internal functions. 
 */ 
</span><span class='Keyword'>static bool 
</span><a name="LN609"></a><span class='Declare_Function'>findPartialMatch</span><span class='Parentheses'>(</span><a href="../../include/nodes/execnodes.h.html#LN561"><span class='Ref_to_Typedef'>TupleHashTable</span></a> <span class='Declare_Parameter'>hashtable</span><span class='Delimiter'>, </span><a href="../../include/executor/tuptable.h.html#LN112"><span class='Ref_to_Struct'>TupleTableSlot</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>slot</span><span class='Delimiter'>, 
</span><a name="LN610"></a>                 <a href="../../include/fmgr.h.html#LN55"><span class='Ref_to_Struct'>FmgrInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>eqfunctions</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN612"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>numCols</span> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN609"><span class='Ref_to_Parameter'>hashtable</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN582"><span class='Ref_to_Member'>numCols</span></a><span class='Delimiter'>; 
</span><a name="LN613"></a>    <a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Local'>keyColIdx</span> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN609"><span class='Ref_to_Parameter'>hashtable</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN583"><span class='Ref_to_Member'>keyColIdx</span></a><span class='Delimiter'>; 
</span><a name="LN614"></a>    <a href="../../include/nodes/execnodes.h.html#LN597"><span class='Ref_to_Typedef'>TupleHashIterator</span></a> <span class='Declare_Local'>hashiter</span><span class='Delimiter'>; 
</span><a name="LN615"></a>    <a href="../../include/nodes/execnodes.h.html#LN560"><span class='Ref_to_Typedef'>TupleHashEntry</span></a> <span class='Declare_Local'>entry</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/execnodes.h.html#LN604"><span class='Ref_to_Macro'>InitTupleHashIterator</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN609"><span class='Ref_to_Parameter'>hashtable</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="nodeSubplan.c.html#LN614"><span class='Ref_To_Local'>hashiter</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>((</span><a href="nodeSubplan.c.html#LN615"><span class='Ref_To_Local'>entry</span></a> <span class='Operator'>= </span><a href="../../include/nodes/execnodes.h.html#LN610"><span class='Ref_to_Macro'>ScanTupleHashTable</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN609"><span class='Ref_to_Parameter'>hashtable</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="nodeSubplan.c.html#LN614"><span class='Ref_To_Local'>hashiter</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../include/executor/tuptable.h.html#LN151"><span class='Ref_to_Proto'>ExecStoreMinimalTuple</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN615"><span class='Ref_To_Local'>entry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN565"><span class='Ref_to_Member'>firstTuple</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN609"><span class='Ref_to_Parameter'>hashtable</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN589"><span class='Ref_to_Member'>tableslot</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/executor/executor.h.html#LN120"><span class='Ref_to_Proto'>execTuplesUnequal</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN609"><span class='Ref_to_Parameter'>slot</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN609"><span class='Ref_to_Parameter'>hashtable</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN589"><span class='Ref_to_Member'>tableslot</span></a><span class='Delimiter'>, 
</span>                               <a href="nodeSubplan.c.html#LN612"><span class='Ref_To_Local'>numCols</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN613"><span class='Ref_To_Local'>keyColIdx</span></a><span class='Delimiter'>, 
</span>                               <a href="nodeSubplan.c.html#LN610"><span class='Ref_to_Parameter'>eqfunctions</span></a><span class='Delimiter'>, 
</span>                               <a href="nodeSubplan.c.html#LN609"><span class='Ref_to_Parameter'>hashtable</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN587"><span class='Ref_to_Member'>tempcxt</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="../../include/nodes/execnodes.h.html#LN606"><span class='Ref_to_Macro'>TermTupleHashIterator</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="nodeSubplan.c.html#LN614"><span class='Ref_To_Local'>hashiter</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* No TermTupleHashIterator call needed here */ 
</span>    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end findPartialMatch &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * slotAllNulls: is the slot completely NULL? 
 * 
 * This does not test for dropped columns, which is OK because we only 
 * use it on projected tuples. 
 */ 
</span><span class='Keyword'>static bool 
</span><a name="LN641"></a><span class='Declare_Function'>slotAllNulls</span><span class='Parentheses'>(</span><a href="../../include/executor/tuptable.h.html#LN112"><span class='Ref_to_Struct'>TupleTableSlot</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>slot</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN643"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>ncols</span> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN641"><span class='Ref_to_Parameter'>slot</span></a><span class='Operator'>-&GT;</span><a href="../../include/executor/tuptable.h.html#LN120"><span class='Ref_to_Member'>tts_tupleDescriptor</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Delimiter'>; 
</span><a name="LN644"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN644"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; </span><a href="nodeSubplan.c.html#LN644"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT;= </span><a href="nodeSubplan.c.html#LN643"><span class='Ref_To_Local'>ncols</span></a><span class='Delimiter'>; </span><a href="nodeSubplan.c.html#LN644"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/executor/tuptable.h.html#LN170"><span class='Ref_to_Proto'>slot_attisnull</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN641"><span class='Ref_to_Parameter'>slot</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN644"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * slotNoNulls: is the slot entirely not NULL? 
 * 
 * This does not test for dropped columns, which is OK because we only 
 * use it on projected tuples. 
 */ 
</span><span class='Keyword'>static bool 
</span><a name="LN661"></a><span class='Declare_Function'>slotNoNulls</span><span class='Parentheses'>(</span><a href="../../include/executor/tuptable.h.html#LN112"><span class='Ref_to_Struct'>TupleTableSlot</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>slot</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN663"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>ncols</span> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN661"><span class='Ref_to_Parameter'>slot</span></a><span class='Operator'>-&GT;</span><a href="../../include/executor/tuptable.h.html#LN120"><span class='Ref_to_Member'>tts_tupleDescriptor</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Delimiter'>; 
</span><a name="LN664"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN664"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; </span><a href="nodeSubplan.c.html#LN664"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT;= </span><a href="nodeSubplan.c.html#LN663"><span class='Ref_To_Local'>ncols</span></a><span class='Delimiter'>; </span><a href="nodeSubplan.c.html#LN664"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/executor/tuptable.h.html#LN170"><span class='Ref_to_Proto'>slot_attisnull</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN661"><span class='Ref_to_Parameter'>slot</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN664"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* ---------------------------------------------------------------- 
 *      ExecInitSubPlan 
 * 
 * Create a SubPlanState for a SubPlan; this is the SubPlan-specific part 
 * of ExecInitExpr().  We split it out so that it can be used for InitPlans 
 * as well as regular SubPlans.  Note that we don't link the SubPlan into 
 * the parent's subPlan list, because that shouldn't happen for InitPlans. 
 * Instead, ExecInitExpr() does that one part. 
 * ---------------------------------------------------------------- 
 */ 
</span><a href="../../include/nodes/execnodes.h.html#LN731"><span class='Ref_to_Struct'>SubPlanState</span></a> <span class='Operator'>* 
</span><a name="LN685"></a><span class='Declare_Function'>ExecInitSubPlan</span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN678"><span class='Ref_to_Struct'>SubPlan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>subplan</span><span class='Delimiter'>, </span><a href="../../include/nodes/execnodes.h.html#LN808"><span class='Ref_to_Struct'>PlanState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>parent</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN687"></a>    <a href="../../include/nodes/execnodes.h.html#LN731"><span class='Ref_to_Struct'>SubPlanState</span></a> <span class='Operator'>*</span><span class='Declare_Local'>sstate</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/execnodes.h.html#LN731"><span class='Ref_to_Struct'>SubPlanState</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN688"></a>    <a href="../../include/nodes/execnodes.h.html#LN402"><span class='Ref_to_Struct'>EState</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>estate</span> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN685"><span class='Ref_to_Parameter'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN814"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>; 
</span> 
    <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN734"><span class='Ref_to_Member'>subplan</span></a> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN685"><span class='Ref_to_Parameter'>subplan</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Link the SubPlanState to already-initialized subplan */ 
</span>    <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN735"><span class='Ref_to_Member'>planstate</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/execnodes.h.html#LN808"><span class='Ref_to_Struct'>PlanState</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN223"><span class='Ref_to_Proto'>list_nth</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN688"><span class='Ref_To_Local'>estate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN462"><span class='Ref_to_Member'>es_subplanstates</span></a><span class='Delimiter'>, 
</span>                                               <a href="nodeSubplan.c.html#LN685"><span class='Ref_to_Parameter'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN687"><span class='Ref_to_Member'>plan_id</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* ... and to its parent's state */ 
</span>    <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN736"><span class='Ref_to_Member'>parent</span></a> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN685"><span class='Ref_to_Parameter'>parent</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Initialize subexpressions */ 
</span>    <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN737"><span class='Ref_to_Member'>testexpr</span></a> <span class='Operator'>= </span><a href="execExpr.c.html#LN111"><span class='Ref_to_Func'>ExecInitExpr</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/primnodes.h.html#LN131"><span class='Ref_to_Struct'>Expr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="nodeSubplan.c.html#LN685"><span class='Ref_to_Parameter'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN684"><span class='Ref_to_Member'>testexpr</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN685"><span class='Ref_to_Parameter'>parent</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN738"><span class='Ref_to_Member'>args</span></a> <span class='Operator'>= </span><a href="../../include/executor/executor.h.html#LN240"><span class='Ref_to_Proto'>ExecInitExprList</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN685"><span class='Ref_to_Parameter'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN708"><span class='Ref_to_Member'>args</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN685"><span class='Ref_to_Parameter'>parent</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * initialize my state 
     */ 
</span>    <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN739"><span class='Ref_to_Member'>curTuple</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN740"><span class='Ref_to_Member'>curArray</span></a> <span class='Operator'>= </span><a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN742"><span class='Ref_to_Member'>projLeft</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN743"><span class='Ref_to_Member'>projRight</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN744"><span class='Ref_to_Member'>hashtable</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN745"><span class='Ref_to_Member'>hashnulls</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN748"><span class='Ref_to_Member'>hashtablecxt</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN749"><span class='Ref_to_Member'>hashtempcxt</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN750"><span class='Ref_to_Member'>innerecontext</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN751"><span class='Ref_to_Member'>keyColIdx</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN752"><span class='Ref_to_Member'>tab_hash_funcs</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN753"><span class='Ref_to_Member'>tab_eq_funcs</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN754"><span class='Ref_to_Member'>lhs_hash_funcs</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN755"><span class='Ref_to_Member'>cur_eq_funcs</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If this is an initplan or MULTIEXPR subplan, it has output parameters 
     * that the parent plan will use, so mark those parameters as needing 
     * evaluation.  We don't actually run the subplan until we first need one 
     * of its outputs. 
     * 
     * A CTE subplan's output parameter is never to be evaluated in the normal 
     * way, so skip this in that case. 
     * 
     * Note that we don't set parent-&GT;chgParam here: the parent plan hasn't 
     * been run yet, so no need to force it to re-run. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN685"><span class='Ref_to_Parameter'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN705"><span class='Ref_to_Member'>setParam</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a> <span class='Operator'>&& </span><a href="nodeSubplan.c.html#LN685"><span class='Ref_to_Parameter'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN682"><span class='Ref_to_Member'>subLinkType</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/primnodes.h.html#LN625"><span class='Ref_to_EnumConst'>CTE_SUBLINK</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN735"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lst</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN735"><span class='Ref_To_Local'>lst</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN685"><span class='Ref_to_Parameter'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN705"><span class='Ref_to_Member'>setParam</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN739"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>paramid</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN106"><span class='Ref_to_Macro'>lfirst_int</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN735"><span class='Ref_To_Local'>lst</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN740"></a>            <a href="../../include/nodes/params.h.html#LN96"><span class='Ref_to_Struct'>ParamExecData</span></a> <span class='Operator'>*</span><span class='Declare_Local'>prm</span> <span class='Operator'>= &</span><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN688"><span class='Ref_To_Local'>estate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN442"><span class='Ref_to_Member'>es_param_exec_vals</span></a><span class='Delimiter'>[</span><a href="nodeSubplan.c.html#LN739"><span class='Ref_To_Local'>paramid</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="nodeSubplan.c.html#LN740"><span class='Ref_To_Local'>prm</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/params.h.html#LN98"><span class='Ref_to_Member'>execPlan</span></a> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If we are going to hash the subquery output, initialize relevant stuff. 
     * (We don't create the hashtable until needed, though.) 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN685"><span class='Ref_to_Parameter'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN696"><span class='Ref_to_Member'>useHashTable</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN752"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>ncols</span><span class='Delimiter'>, 
</span><a name="LN753"></a>                    <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN754"></a>        <a href="../../include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a>   <span class='Declare_Local'>tupDesc</span><span class='Delimiter'>; 
</span><a name="LN755"></a>        <a href="../../include/executor/tuptable.h.html#LN112"><span class='Ref_to_Struct'>TupleTableSlot</span></a> <span class='Operator'>*</span><span class='Declare_Local'>slot</span><span class='Delimiter'>; 
</span><a name="LN756"></a>        <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>oplist</span><span class='Delimiter'>, 
</span><a name="LN757"></a>                   <span class='Operator'>*</span><span class='Declare_Local'>lefttlist</span><span class='Delimiter'>, 
</span><a name="LN758"></a>                   <span class='Operator'>*</span><span class='Declare_Local'>righttlist</span><span class='Delimiter'>; 
</span><a name="LN759"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* We need a memory context to hold the hash table(s) */ 
</span>        <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN748"><span class='Ref_to_Member'>hashtablecxt</span></a> <span class='Operator'>= 
</span>            <a href="../../include/utils/memutils.h.html#LN145"><span class='Ref_to_Proto'>AllocSetContextCreate</span></a><span class='Parentheses'>(</span><a href="../utils/mmgr/mcxt.c.html#LN36"><span class='Ref_to_Global_Var'>CurrentMemoryContext</span></a><span class='Delimiter'>, 
</span>                                  <span class='String'>"Subplan HashTable Context"</span><span class='Delimiter'>, 
</span>                                  <a href="../../include/utils/memutils.h.html#LN164"><span class='Ref_to_Const'>ALLOCSET_DEFAULT_SIZES</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* and a small one for the hash tables to use as temp storage */ 
</span>        <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN749"><span class='Ref_to_Member'>hashtempcxt</span></a> <span class='Operator'>= 
</span>            <a href="../../include/utils/memutils.h.html#LN145"><span class='Ref_to_Proto'>AllocSetContextCreate</span></a><span class='Parentheses'>(</span><a href="../utils/mmgr/mcxt.c.html#LN36"><span class='Ref_to_Global_Var'>CurrentMemoryContext</span></a><span class='Delimiter'>, 
</span>                                  <span class='String'>"Subplan HashTable Temp Context"</span><span class='Delimiter'>, 
</span>                                  <a href="../../include/utils/memutils.h.html#LN174"><span class='Ref_to_Const'>ALLOCSET_SMALL_SIZES</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* and a short-lived exprcontext for function evaluation */ 
</span>        <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN750"><span class='Ref_to_Member'>innerecontext</span></a> <span class='Operator'>= </span><a href="execUtils.c.html#LN216"><span class='Ref_to_Func'>CreateExprContext</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN688"><span class='Ref_To_Local'>estate</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* Silly little array of column numbers 1..n */ 
</span>        <a href="nodeSubplan.c.html#LN752"><span class='Ref_To_Local'>ncols</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN685"><span class='Ref_to_Parameter'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN685"><span class='Ref_to_Member'>paramIds</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN751"><span class='Ref_to_Member'>keyColIdx</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN752"><span class='Ref_To_Local'>ncols</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN753"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="nodeSubplan.c.html#LN753"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="nodeSubplan.c.html#LN752"><span class='Ref_To_Local'>ncols</span></a><span class='Delimiter'>; </span><a href="nodeSubplan.c.html#LN753"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>            <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN751"><span class='Ref_to_Member'>keyColIdx</span></a><span class='Delimiter'>[</span><a href="nodeSubplan.c.html#LN753"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="nodeSubplan.c.html#LN753"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * We use ExecProject to evaluate the lefthand and righthand 
         * expression lists and form tuples.  (You might think that we could 
         * use the sub-select's output tuples directly, but that is not the 
         * case if we had to insert any run-time coercions of the sub-select's 
         * output datatypes; anyway this avoids storing any resjunk columns 
         * that might be in the sub-select's output.)  Run through the 
         * combining expressions to build tlists for the lefthand and 
         * righthand sides. 
         * 
         * We also extract the combining operators themselves to initialize 
         * the equality and hashing functions for the hash tables. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN685"><span class='Ref_to_Parameter'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN684"><span class='Ref_to_Member'>testexpr</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN491"><span class='Ref_to_Struct'>OpExpr</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* single combining operator */ 
</span>            <a href="nodeSubplan.c.html#LN756"><span class='Ref_To_Local'>oplist</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN138"><span class='Ref_to_Macro'>list_make1</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN685"><span class='Ref_to_Parameter'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN684"><span class='Ref_to_Member'>testexpr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/optimizer/clauses.h.html#LN42"><span class='Ref_to_Proto'>and_clause</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="nodeSubplan.c.html#LN685"><span class='Ref_to_Parameter'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN684"><span class='Ref_to_Member'>testexpr</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* multiple combining operators */ 
</span>            <a href="nodeSubplan.c.html#LN756"><span class='Ref_To_Local'>oplist</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN575"><span class='Ref_to_Macro'>castNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN557"><span class='Ref_to_Struct'>BoolExpr</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN685"><span class='Ref_to_Parameter'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN684"><span class='Ref_to_Member'>testexpr</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>args<span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* shouldn't see anything else in a hashable subplan */ 
</span>            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized testexpr type: %d"</span><span class='Delimiter'>, 
</span>                 <span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="../../include/nodes/nodes.h.html#LN513"><span class='Ref_to_Macro'>nodeTag</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN685"><span class='Ref_to_Parameter'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN684"><span class='Ref_to_Member'>testexpr</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="nodeSubplan.c.html#LN756"><span class='Ref_To_Local'>oplist</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span>        <span class='Delimiter'>} 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN756"><span class='Ref_To_Local'>oplist</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="nodeSubplan.c.html#LN752"><span class='Ref_To_Local'>ncols</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="nodeSubplan.c.html#LN757"><span class='Ref_To_Local'>lefttlist</span></a> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN758"><span class='Ref_To_Local'>righttlist</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>        <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN752"><span class='Ref_to_Member'>tab_hash_funcs</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN55"><span class='Ref_to_Struct'>FmgrInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN752"><span class='Ref_To_Local'>ncols</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN55"><span class='Ref_to_Struct'>FmgrInfo</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN753"><span class='Ref_to_Member'>tab_eq_funcs</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN55"><span class='Ref_to_Struct'>FmgrInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN752"><span class='Ref_To_Local'>ncols</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN55"><span class='Ref_to_Struct'>FmgrInfo</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN754"><span class='Ref_to_Member'>lhs_hash_funcs</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN55"><span class='Ref_to_Struct'>FmgrInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN752"><span class='Ref_To_Local'>ncols</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN55"><span class='Ref_to_Struct'>FmgrInfo</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN755"><span class='Ref_to_Member'>cur_eq_funcs</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN55"><span class='Ref_to_Struct'>FmgrInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN752"><span class='Ref_To_Local'>ncols</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN55"><span class='Ref_to_Struct'>FmgrInfo</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="nodeSubplan.c.html#LN753"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN759"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN756"><span class='Ref_To_Local'>oplist</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN819"></a>            <a href="../../include/nodes/primnodes.h.html#LN491"><span class='Ref_to_Struct'>OpExpr</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>opexpr</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN108"><span class='Ref_to_Macro'>lfirst_node</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN491"><span class='Ref_to_Struct'>OpExpr</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN759"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN820"></a>            <a href="../../include/nodes/primnodes.h.html#LN131"><span class='Ref_to_Struct'>Expr</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>expr</span><span class='Delimiter'>; 
</span><a name="LN821"></a>            <a href="../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>tle</span><span class='Delimiter'>; 
</span><a name="LN822"></a>            <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>rhs_eq_oper</span><span class='Delimiter'>; 
</span><a name="LN823"></a>            <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>left_hashfn</span><span class='Delimiter'>; 
</span><a name="LN824"></a>            <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>right_hashfn</span><span class='Delimiter'>; 
</span> 
            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN819"><span class='Ref_To_Local'>opexpr</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN500"><span class='Ref_to_Member'>args</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Process lefthand argument */ 
</span>            <a href="nodeSubplan.c.html#LN820"><span class='Ref_To_Local'>expr</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN131"><span class='Ref_to_Struct'>Expr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN819"><span class='Ref_To_Local'>opexpr</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN500"><span class='Ref_to_Member'>args</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="nodeSubplan.c.html#LN821"><span class='Ref_To_Local'>tle</span></a> <span class='Operator'>= </span><a href="../../include/nodes/makefuncs.h.html#LN40"><span class='Ref_to_Proto'>makeTargetEntry</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN820"><span class='Ref_To_Local'>expr</span></a><span class='Delimiter'>, 
</span>                                  <a href="nodeSubplan.c.html#LN753"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>, 
</span>                                  <span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                                  <span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="nodeSubplan.c.html#LN757"><span class='Ref_To_Local'>lefttlist</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN757"><span class='Ref_To_Local'>lefttlist</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN821"><span class='Ref_To_Local'>tle</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Process righthand argument */ 
</span>            <a href="nodeSubplan.c.html#LN820"><span class='Ref_To_Local'>expr</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN131"><span class='Ref_to_Struct'>Expr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN115"><span class='Ref_to_Macro'>lsecond</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN819"><span class='Ref_To_Local'>opexpr</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN500"><span class='Ref_to_Member'>args</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="nodeSubplan.c.html#LN821"><span class='Ref_To_Local'>tle</span></a> <span class='Operator'>= </span><a href="../../include/nodes/makefuncs.h.html#LN40"><span class='Ref_to_Proto'>makeTargetEntry</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN820"><span class='Ref_To_Local'>expr</span></a><span class='Delimiter'>, 
</span>                                  <a href="nodeSubplan.c.html#LN753"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>, 
</span>                                  <span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                                  <span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="nodeSubplan.c.html#LN758"><span class='Ref_To_Local'>righttlist</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN758"><span class='Ref_To_Local'>righttlist</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN821"><span class='Ref_To_Local'>tle</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Lookup the equality function (potentially cross-type) */ 
</span>            <a href="../../include/fmgr.h.html#LN92"><span class='Ref_to_Proto'>fmgr_info</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN819"><span class='Ref_To_Local'>opexpr</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN495"><span class='Ref_to_Member'>opfuncid</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN755"><span class='Ref_to_Member'>cur_eq_funcs</span></a><span class='Delimiter'>[</span><a href="nodeSubplan.c.html#LN753"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../include/fmgr.h.html#LN103"><span class='Ref_to_Macro'>fmgr_info_set_expr</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="nodeSubplan.c.html#LN819"><span class='Ref_To_Local'>opexpr</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN755"><span class='Ref_to_Member'>cur_eq_funcs</span></a><span class='Delimiter'>[</span><a href="nodeSubplan.c.html#LN753"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Look up the equality function for the RHS type */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/lsyscache.h.html#LN77"><span class='Ref_to_Proto'>get_compatible_hash_operators</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN819"><span class='Ref_To_Local'>opexpr</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN494"><span class='Ref_to_Member'>opno</span></a><span class='Delimiter'>, 
</span>                                               <span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="nodeSubplan.c.html#LN822"><span class='Ref_To_Local'>rhs_eq_oper</span></a><span class='Parentheses'>))</span> 
                <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"could not find compatible hash operator for operator %u"</span><span class='Delimiter'>, 
</span>                     <a href="nodeSubplan.c.html#LN819"><span class='Ref_To_Local'>opexpr</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN494"><span class='Ref_to_Member'>opno</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../include/fmgr.h.html#LN92"><span class='Ref_to_Proto'>fmgr_info</span></a><span class='Parentheses'>(</span><a href="../../include/utils/lsyscache.h.html#LN98"><span class='Ref_to_Proto'>get_opcode</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN822"><span class='Ref_To_Local'>rhs_eq_oper</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN753"><span class='Ref_to_Member'>tab_eq_funcs</span></a><span class='Delimiter'>[</span><a href="nodeSubplan.c.html#LN753"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Lookup the associated hash functions */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/utils/lsyscache.h.html#LN79"><span class='Ref_to_Proto'>get_op_hash_functions</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN819"><span class='Ref_To_Local'>opexpr</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN494"><span class='Ref_to_Member'>opno</span></a><span class='Delimiter'>, 
</span>                                       <span class='Operator'>&</span><a href="nodeSubplan.c.html#LN823"><span class='Ref_To_Local'>left_hashfn</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="nodeSubplan.c.html#LN824"><span class='Ref_To_Local'>right_hashfn</span></a><span class='Parentheses'>))</span> 
                <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"could not find hash function for hash operator %u"</span><span class='Delimiter'>, 
</span>                     <a href="nodeSubplan.c.html#LN819"><span class='Ref_To_Local'>opexpr</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN494"><span class='Ref_to_Member'>opno</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../include/fmgr.h.html#LN92"><span class='Ref_to_Proto'>fmgr_info</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN823"><span class='Ref_To_Local'>left_hashfn</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN754"><span class='Ref_to_Member'>lhs_hash_funcs</span></a><span class='Delimiter'>[</span><a href="nodeSubplan.c.html#LN753"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../include/fmgr.h.html#LN92"><span class='Ref_to_Proto'>fmgr_info</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN824"><span class='Ref_To_Local'>right_hashfn</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN752"><span class='Ref_to_Member'>tab_hash_funcs</span></a><span class='Delimiter'>[</span><a href="nodeSubplan.c.html#LN753"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="nodeSubplan.c.html#LN753"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Construct tupdescs, slots and projection nodes for left and right 
         * sides.  The lefthand expressions will be evaluated in the parent 
         * plan node's exprcontext, which we don't have access to here. 
         * Fortunately we can just pass NULL for now and fill it in later 
         * (hack alert!).  The righthand expressions will be evaluated in our 
         * own innerecontext. 
         */ 
</span>        <a href="nodeSubplan.c.html#LN754"><span class='Ref_To_Local'>tupDesc</span></a> <span class='Operator'>= </span><a href="../../include/executor/executor.h.html#LN405"><span class='Ref_to_Proto'>ExecTypeFromTL</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN757"><span class='Ref_To_Local'>lefttlist</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="nodeSubplan.c.html#LN755"><span class='Ref_To_Local'>slot</span></a> <span class='Operator'>= </span><a href="../../include/executor/executor.h.html#LN402"><span class='Ref_to_Proto'>ExecInitExtraTupleSlot</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN688"><span class='Ref_To_Local'>estate</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../include/executor/tuptable.h.html#LN146"><span class='Ref_to_Proto'>ExecSetSlotDescriptor</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN755"><span class='Ref_To_Local'>slot</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN754"><span class='Ref_To_Local'>tupDesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN742"><span class='Ref_to_Member'>projLeft</span></a> <span class='Operator'>= </span><a href="../../include/executor/executor.h.html#LN241"><span class='Ref_to_Proto'>ExecBuildProjectionInfo</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN757"><span class='Ref_To_Local'>lefttlist</span></a><span class='Delimiter'>, 
</span>                                                   <span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                                                   <a href="nodeSubplan.c.html#LN755"><span class='Ref_To_Local'>slot</span></a><span class='Delimiter'>, 
</span>                                                   <a href="nodeSubplan.c.html#LN685"><span class='Ref_to_Parameter'>parent</span></a><span class='Delimiter'>, 
</span>                                                   <span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="nodeSubplan.c.html#LN754"><span class='Ref_To_Local'>tupDesc</span></a> <span class='Operator'>= </span><a href="../../include/executor/executor.h.html#LN405"><span class='Ref_to_Proto'>ExecTypeFromTL</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN758"><span class='Ref_To_Local'>righttlist</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="nodeSubplan.c.html#LN755"><span class='Ref_To_Local'>slot</span></a> <span class='Operator'>= </span><a href="../../include/executor/executor.h.html#LN402"><span class='Ref_to_Proto'>ExecInitExtraTupleSlot</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN688"><span class='Ref_To_Local'>estate</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../include/executor/tuptable.h.html#LN146"><span class='Ref_to_Proto'>ExecSetSlotDescriptor</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN755"><span class='Ref_To_Local'>slot</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN754"><span class='Ref_To_Local'>tupDesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN743"><span class='Ref_to_Member'>projRight</span></a> <span class='Operator'>= </span><a href="../../include/executor/executor.h.html#LN241"><span class='Ref_to_Proto'>ExecBuildProjectionInfo</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN758"><span class='Ref_To_Local'>righttlist</span></a><span class='Delimiter'>, 
</span>                                                    <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN750"><span class='Ref_to_Member'>innerecontext</span></a><span class='Delimiter'>, 
</span>                                                    <a href="nodeSubplan.c.html#LN755"><span class='Ref_To_Local'>slot</span></a><span class='Delimiter'>, 
</span>                                                    <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN735"><span class='Ref_to_Member'>planstate</span></a><span class='Delimiter'>, 
</span>                                                    <span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if subplan-&GT;useHashTable &raquo; </span> 
 
    <span class='Control'>return</span> <a href="nodeSubplan.c.html#LN687"><span class='Ref_To_Local'>sstate</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end ExecInitSubPlan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* ---------------------------------------------------------------- 
 *      ExecSetParamPlan 
 * 
 *      Executes a subplan and sets its output parameters. 
 * 
 * This is called from ExecEvalParamExec() when the value of a PARAM_EXEC 
 * parameter is requested and the param's execPlan field is set (indicating 
 * that the param has not yet been evaluated).  This allows lazy evaluation 
 * of initplans: we don't run the subplan until/unless we need its output. 
 * Note that this routine MUST clear the execPlan fields of the plan's 
 * output parameters after evaluating them! 
 * ---------------------------------------------------------------- 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN910"></a><span class='Declare_Function'>ExecSetParamPlan</span><span class='Parentheses'>(</span><a href="../../include/nodes/execnodes.h.html#LN731"><span class='Ref_to_Struct'>SubPlanState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, </span><a href="../../include/nodes/execnodes.h.html#LN191"><span class='Ref_to_Struct'>ExprContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>econtext</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN912"></a>    <a href="../../include/nodes/primnodes.h.html#LN678"><span class='Ref_to_Struct'>SubPlan</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>subplan</span> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN910"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN734"><span class='Ref_to_Member'>subplan</span></a><span class='Delimiter'>; 
</span><a name="LN913"></a>    <a href="../../include/nodes/execnodes.h.html#LN808"><span class='Ref_to_Struct'>PlanState</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>planstate</span> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN910"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN735"><span class='Ref_to_Member'>planstate</span></a><span class='Delimiter'>; 
</span><a name="LN914"></a>    <a href="../../include/nodes/primnodes.h.html#LN616"><span class='Ref_to_Enum'>SubLinkType</span></a> <span class='Declare_Local'>subLinkType</span> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN912"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN682"><span class='Ref_to_Member'>subLinkType</span></a><span class='Delimiter'>; 
</span><a name="LN915"></a>    <a href="../../include/utils/palloc.h.html#LN35"><span class='Ref_to_Typedef'>MemoryContext</span></a> <span class='Declare_Local'>oldcontext</span><span class='Delimiter'>; 
</span><a name="LN916"></a>    <a href="../../include/executor/tuptable.h.html#LN112"><span class='Ref_to_Struct'>TupleTableSlot</span></a> <span class='Operator'>*</span><span class='Declare_Local'>slot</span><span class='Delimiter'>; 
</span><a name="LN917"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>pvar</span><span class='Delimiter'>; 
</span><a name="LN918"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span><a name="LN919"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>found</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN920"></a>    <a href="../../include/utils/array.h.html#LN206"><span class='Ref_to_Struct'>ArrayBuildStateAny</span></a> <span class='Operator'>*</span><span class='Declare_Local'>astate</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN914"><span class='Ref_To_Local'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN620"><span class='Ref_to_EnumConst'>ANY_SUBLINK</span></a> <span class='Operator'>|| 
</span>        <a href="nodeSubplan.c.html#LN914"><span class='Ref_To_Local'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN619"><span class='Ref_to_EnumConst'>ALL_SUBLINK</span></a><span class='Parentheses'>) 
</span>        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"ANY/ALL subselect unsupported as initplan"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN914"><span class='Ref_To_Local'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN625"><span class='Ref_to_EnumConst'>CTE_SUBLINK</span></a><span class='Parentheses'>) 
</span>        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"CTE subplans should not be executed via ExecSetParamPlan"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Initialize ArrayBuildStateAny in caller's context, if needed */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN914"><span class='Ref_To_Local'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN624"><span class='Ref_to_EnumConst'>ARRAY_SUBLINK</span></a><span class='Parentheses'>) 
</span>        <a href="nodeSubplan.c.html#LN920"><span class='Ref_To_Local'>astate</span></a> <span class='Operator'>= </span><a href="../../include/utils/array.h.html#LN408"><span class='Ref_to_Proto'>initArrayResultAny</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN912"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN691"><span class='Ref_to_Member'>firstColType</span></a><span class='Delimiter'>, 
</span>                                    <a href="../utils/mmgr/mcxt.c.html#LN36"><span class='Ref_to_Global_Var'>CurrentMemoryContext</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Must switch to per-query memory context. 
     */ 
</span>    <a href="nodeSubplan.c.html#LN915"><span class='Ref_To_Local'>oldcontext</span></a> <span class='Operator'>= </span><a href="../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN910"><span class='Ref_to_Parameter'>econtext</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN201"><span class='Ref_to_Member'>ecxt_per_query_memory</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Set Params of this plan from parent plan correlation values. (Any 
     * calculation we have to do is done in the parent econtext, since the 
     * Param values don't need to have per-query lifetime.)  Currently, we 
     * expect only MULTIEXPR_SUBLINK plans to have any correlation values. 
     */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN912"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN707"><span class='Ref_to_Member'>parParam</span></a> <span class='Operator'>== </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a> <span class='Operator'>|| </span><a href="nodeSubplan.c.html#LN914"><span class='Ref_To_Local'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN623"><span class='Ref_to_EnumConst'>MULTIEXPR_SUBLINK</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN912"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN707"><span class='Ref_to_Member'>parParam</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN910"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN738"><span class='Ref_to_Member'>args</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN179"><span class='Ref_to_Macro'>forboth</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN918"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN912"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN707"><span class='Ref_to_Member'>parParam</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN917"><span class='Ref_To_Local'>pvar</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN910"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN738"><span class='Ref_to_Member'>args</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN949"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>paramid</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN106"><span class='Ref_to_Macro'>lfirst_int</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN918"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN950"></a>        <a href="../../include/nodes/params.h.html#LN96"><span class='Ref_to_Struct'>ParamExecData</span></a> <span class='Operator'>*</span><span class='Declare_Local'>prm</span> <span class='Operator'>= &</span><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN910"><span class='Ref_to_Parameter'>econtext</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN205"><span class='Ref_to_Member'>ecxt_param_exec_vals</span></a><span class='Delimiter'>[</span><a href="nodeSubplan.c.html#LN949"><span class='Ref_To_Local'>paramid</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="nodeSubplan.c.html#LN950"><span class='Ref_To_Local'>prm</span></a><span class='Operator'>-&GT;</span><span class='Keyword'>value </span><span class='Operator'>= </span><a href="../../include/executor/executor.h.html#LN279"><span class='Ref_to_Func'>ExecEvalExprSwitchContext</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/execnodes.h.html#LN52"><span class='Ref_to_Struct'>ExprState</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN917"><span class='Ref_To_Local'>pvar</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                               <a href="nodeSubplan.c.html#LN910"><span class='Ref_to_Parameter'>econtext</span></a><span class='Delimiter'>, 
</span>                                               <span class='Operator'>&</span><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN950"><span class='Ref_To_Local'>prm</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/params.h.html#LN100"><span class='Ref_to_Member'>isnull</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="nodeSubplan.c.html#LN913"><span class='Ref_To_Local'>planstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN836"><span class='Ref_to_Member'>chgParam</span></a> <span class='Operator'>= </span><a href="../../include/nodes/bitmapset.h.html#LN89"><span class='Ref_to_Proto'>bms_add_member</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN913"><span class='Ref_To_Local'>planstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN836"><span class='Ref_to_Member'>chgParam</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN949"><span class='Ref_To_Local'>paramid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Run the plan.  (If it needs to be rescanned, the first ExecProcNode 
     * call will take care of that.) 
     */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN916"><span class='Ref_To_Local'>slot</span></a> <span class='Operator'>= </span><a href="../../include/executor/executor.h.html#LN229"><span class='Ref_to_Proto'>ExecProcNode</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN913"><span class='Ref_To_Local'>planstate</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>         <span class='Operator'>!</span><a href="../../include/executor/tuptable.h.html#LN137"><span class='Ref_to_Macro'>TupIsNull</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN916"><span class='Ref_To_Local'>slot</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>         <a href="nodeSubplan.c.html#LN916"><span class='Ref_To_Local'>slot</span></a> <span class='Operator'>= </span><a href="../../include/executor/executor.h.html#LN229"><span class='Ref_to_Proto'>ExecProcNode</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN913"><span class='Ref_To_Local'>planstate</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN966"></a>        <a href="../../include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a>   <span class='Declare_Local'>tdesc</span> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN916"><span class='Ref_To_Local'>slot</span></a><span class='Operator'>-&GT;</span><a href="../../include/executor/tuptable.h.html#LN120"><span class='Ref_to_Member'>tts_tupleDescriptor</span></a><span class='Delimiter'>; 
</span><a name="LN967"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN914"><span class='Ref_To_Local'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN618"><span class='Ref_to_EnumConst'>EXISTS_SUBLINK</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* There can be only one setParam... */ 
</span><a name="LN972"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>paramid</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN111"><span class='Ref_to_Macro'>linitial_int</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN912"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN705"><span class='Ref_to_Member'>setParam</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN973"></a>            <a href="../../include/nodes/params.h.html#LN96"><span class='Ref_to_Struct'>ParamExecData</span></a> <span class='Operator'>*</span><span class='Declare_Local'>prm</span> <span class='Operator'>= &</span><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN910"><span class='Ref_to_Parameter'>econtext</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN205"><span class='Ref_to_Member'>ecxt_param_exec_vals</span></a><span class='Delimiter'>[</span><a href="nodeSubplan.c.html#LN972"><span class='Ref_To_Local'>paramid</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="nodeSubplan.c.html#LN973"><span class='Ref_To_Local'>prm</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/params.h.html#LN98"><span class='Ref_to_Member'>execPlan</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <a href="nodeSubplan.c.html#LN973"><span class='Ref_To_Local'>prm</span></a><span class='Operator'>-&GT;</span><span class='Keyword'>value </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="nodeSubplan.c.html#LN973"><span class='Ref_To_Local'>prm</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/params.h.html#LN100"><span class='Ref_to_Member'>isnull</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <a href="nodeSubplan.c.html#LN919"><span class='Ref_To_Local'>found</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN914"><span class='Ref_To_Local'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN624"><span class='Ref_to_EnumConst'>ARRAY_SUBLINK</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN984"></a>            <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>dvalue</span><span class='Delimiter'>; 
</span><a name="LN985"></a>            <span class='Keyword'>bool</span>        <span class='Declare_Local'>disnull</span><span class='Delimiter'>; 
</span> 
            <a href="nodeSubplan.c.html#LN919"><span class='Ref_To_Local'>found</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* stash away current value */ 
</span>            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN912"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN691"><span class='Ref_to_Member'>firstColType</span></a> <span class='Operator'>== </span><a href="nodeSubplan.c.html#LN966"><span class='Ref_To_Local'>tdesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN73"><span class='Ref_to_Member'>attrs</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span>atttypid<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="nodeSubplan.c.html#LN984"><span class='Ref_To_Local'>dvalue</span></a> <span class='Operator'>= </span><a href="../../include/executor/tuptable.h.html#LN167"><span class='Ref_to_Proto'>slot_getattr</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN916"><span class='Ref_To_Local'>slot</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="nodeSubplan.c.html#LN985"><span class='Ref_To_Local'>disnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="nodeSubplan.c.html#LN920"><span class='Ref_To_Local'>astate</span></a> <span class='Operator'>= </span><a href="../../include/utils/array.h.html#LN410"><span class='Ref_to_Proto'>accumArrayResultAny</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN920"><span class='Ref_To_Local'>astate</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN984"><span class='Ref_To_Local'>dvalue</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN985"><span class='Ref_To_Local'>disnull</span></a><span class='Delimiter'>, 
</span>                                         <a href="nodeSubplan.c.html#LN912"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN691"><span class='Ref_to_Member'>firstColType</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN915"><span class='Ref_To_Local'>oldcontext</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* keep scanning subplan to collect all values */ 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN919"><span class='Ref_To_Local'>found</span></a> <span class='Operator'>&& 
</span>            <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN914"><span class='Ref_To_Local'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN622"><span class='Ref_to_EnumConst'>EXPR_SUBLINK</span></a> <span class='Operator'>|| 
</span>             <a href="nodeSubplan.c.html#LN914"><span class='Ref_To_Local'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN623"><span class='Ref_to_EnumConst'>MULTIEXPR_SUBLINK</span></a> <span class='Operator'>|| 
</span>             <a href="nodeSubplan.c.html#LN914"><span class='Ref_To_Local'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN621"><span class='Ref_to_EnumConst'>ROWCOMPARE_SUBLINK</span></a><span class='Parentheses'>))</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_CARDINALITY_VIOLATION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"more than one row returned by a subquery used as an expression"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <a href="nodeSubplan.c.html#LN919"><span class='Ref_To_Local'>found</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * We need to copy the subplan's tuple into our own context, in case 
         * any of the params are pass-by-ref type --- the pointers stored in 
         * the param structs will point at this copied tuple! node-&GT;curTuple 
         * keeps track of the copied tuple for eventual freeing. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN910"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN739"><span class='Ref_to_Member'>curTuple</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/access/htup_details.h.html#LN815"><span class='Ref_to_Proto'>heap_freetuple</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN910"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN739"><span class='Ref_to_Member'>curTuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="nodeSubplan.c.html#LN910"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN739"><span class='Ref_to_Member'>curTuple</span></a> <span class='Operator'>= </span><a href="../../include/executor/tuptable.h.html#LN157"><span class='Ref_to_Proto'>ExecCopySlotTuple</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN916"><span class='Ref_To_Local'>slot</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Now set all the setParam params from the columns of the tuple 
         */ 
</span>        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN918"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN912"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN705"><span class='Ref_to_Member'>setParam</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN1022"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>paramid</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN106"><span class='Ref_to_Macro'>lfirst_int</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN918"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1023"></a>            <a href="../../include/nodes/params.h.html#LN96"><span class='Ref_to_Struct'>ParamExecData</span></a> <span class='Operator'>*</span><span class='Declare_Local'>prm</span> <span class='Operator'>= &</span><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN910"><span class='Ref_to_Parameter'>econtext</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN205"><span class='Ref_to_Member'>ecxt_param_exec_vals</span></a><span class='Delimiter'>[</span><a href="nodeSubplan.c.html#LN1022"><span class='Ref_To_Local'>paramid</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="nodeSubplan.c.html#LN1023"><span class='Ref_To_Local'>prm</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/params.h.html#LN98"><span class='Ref_to_Member'>execPlan</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <a href="nodeSubplan.c.html#LN1023"><span class='Ref_To_Local'>prm</span></a><span class='Operator'>-&GT;</span><span class='Keyword'>value </span><span class='Operator'>= </span><a href="../../include/access/htup_details.h.html#LN768"><span class='Ref_to_Macro'>heap_getattr</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN910"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN739"><span class='Ref_to_Member'>curTuple</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN967"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN966"><span class='Ref_To_Local'>tdesc</span></a><span class='Delimiter'>, 
</span>                                      <span class='Operator'>&</span><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN1023"><span class='Ref_To_Local'>prm</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/params.h.html#LN100"><span class='Ref_to_Member'>isnull</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="nodeSubplan.c.html#LN967"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for slot=ExecProcNode(pla... &raquo; </span> 
 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN914"><span class='Ref_To_Local'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN624"><span class='Ref_to_EnumConst'>ARRAY_SUBLINK</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* There can be only one setParam... */ 
</span><a name="LN1035"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>paramid</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN111"><span class='Ref_to_Macro'>linitial_int</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN912"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN705"><span class='Ref_to_Member'>setParam</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1036"></a>        <a href="../../include/nodes/params.h.html#LN96"><span class='Ref_to_Struct'>ParamExecData</span></a> <span class='Operator'>*</span><span class='Declare_Local'>prm</span> <span class='Operator'>= &</span><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN910"><span class='Ref_to_Parameter'>econtext</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN205"><span class='Ref_to_Member'>ecxt_param_exec_vals</span></a><span class='Delimiter'>[</span><a href="nodeSubplan.c.html#LN1035"><span class='Ref_To_Local'>paramid</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * We build the result array in query context so it won't disappear; 
         * to avoid leaking memory across repeated calls, we have to remember 
         * the latest value, much as for curTuple above. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN910"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN740"><span class='Ref_to_Member'>curArray</span></a> <span class='Operator'>!= </span><a href="../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Parentheses'>))</span> 
            <a href="../../include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN910"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN740"><span class='Ref_to_Member'>curArray</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="nodeSubplan.c.html#LN910"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN740"><span class='Ref_to_Member'>curArray</span></a> <span class='Operator'>= </span><a href="../../include/utils/array.h.html#LN414"><span class='Ref_to_Proto'>makeArrayResultAny</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN920"><span class='Ref_To_Local'>astate</span></a><span class='Delimiter'>, 
</span>                                            <a href="nodeSubplan.c.html#LN910"><span class='Ref_to_Parameter'>econtext</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN201"><span class='Ref_to_Member'>ecxt_per_query_memory</span></a><span class='Delimiter'>, 
</span>                                            <span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="nodeSubplan.c.html#LN1036"><span class='Ref_To_Local'>prm</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/params.h.html#LN98"><span class='Ref_to_Member'>execPlan</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="nodeSubplan.c.html#LN1036"><span class='Ref_To_Local'>prm</span></a><span class='Operator'>-&GT;</span><span class='Keyword'>value </span><span class='Operator'>= </span><a href="nodeSubplan.c.html#LN910"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN740"><span class='Ref_to_Member'>curArray</span></a><span class='Delimiter'>; 
</span>        <a href="nodeSubplan.c.html#LN1036"><span class='Ref_To_Local'>prm</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/params.h.html#LN100"><span class='Ref_to_Member'>isnull</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if subLinkType==ARRAY_SU... &raquo; </span> 
    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="nodeSubplan.c.html#LN919"><span class='Ref_To_Local'>found</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN914"><span class='Ref_To_Local'>subLinkType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN618"><span class='Ref_to_EnumConst'>EXISTS_SUBLINK</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* There can be only one setParam... */ 
</span><a name="LN1057"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>paramid</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN111"><span class='Ref_to_Macro'>linitial_int</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN912"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN705"><span class='Ref_to_Member'>setParam</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1058"></a>            <a href="../../include/nodes/params.h.html#LN96"><span class='Ref_to_Struct'>ParamExecData</span></a> <span class='Operator'>*</span><span class='Declare_Local'>prm</span> <span class='Operator'>= &</span><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN910"><span class='Ref_to_Parameter'>econtext</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN205"><span class='Ref_to_Member'>ecxt_param_exec_vals</span></a><span class='Delimiter'>[</span><a href="nodeSubplan.c.html#LN1057"><span class='Ref_To_Local'>paramid</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="nodeSubplan.c.html#LN1058"><span class='Ref_To_Local'>prm</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/params.h.html#LN98"><span class='Ref_to_Member'>execPlan</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <a href="nodeSubplan.c.html#LN1058"><span class='Ref_To_Local'>prm</span></a><span class='Operator'>-&GT;</span><span class='Keyword'>value </span><span class='Operator'>= </span><a href="../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="nodeSubplan.c.html#LN1058"><span class='Ref_To_Local'>prm</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/params.h.html#LN100"><span class='Ref_to_Member'>isnull</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* For other sublink types, set all the output params to NULL */ 
</span>            <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN918"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN912"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN705"><span class='Ref_to_Member'>setParam</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN1069"></a>                <span class='Keyword'>int</span>         <span class='Declare_Local'>paramid</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN106"><span class='Ref_to_Macro'>lfirst_int</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN918"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1070"></a>                <a href="../../include/nodes/params.h.html#LN96"><span class='Ref_to_Struct'>ParamExecData</span></a> <span class='Operator'>*</span><span class='Declare_Local'>prm</span> <span class='Operator'>= &</span><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN910"><span class='Ref_to_Parameter'>econtext</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN205"><span class='Ref_to_Member'>ecxt_param_exec_vals</span></a><span class='Delimiter'>[</span><a href="nodeSubplan.c.html#LN1069"><span class='Ref_To_Local'>paramid</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <a href="nodeSubplan.c.html#LN1070"><span class='Ref_To_Local'>prm</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/params.h.html#LN98"><span class='Ref_to_Member'>execPlan</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>                <a href="nodeSubplan.c.html#LN1070"><span class='Ref_To_Local'>prm</span></a><span class='Operator'>-&GT;</span><span class='Keyword'>value </span><span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>) </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                <a href="nodeSubplan.c.html#LN1070"><span class='Ref_To_Local'>prm</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/params.h.html#LN100"><span class='Ref_to_Member'>isnull</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if !found &raquo; </span> 
 
    <a href="../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN915"><span class='Ref_To_Local'>oldcontext</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end ExecSetParamPlan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Mark an initplan as needing recalculation 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN1086"></a><span class='Declare_Function'>ExecReScanSetParamPlan</span><span class='Parentheses'>(</span><a href="../../include/nodes/execnodes.h.html#LN731"><span class='Ref_to_Struct'>SubPlanState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, </span><a href="../../include/nodes/execnodes.h.html#LN808"><span class='Ref_to_Struct'>PlanState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>parent</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1088"></a>    <a href="../../include/nodes/execnodes.h.html#LN808"><span class='Ref_to_Struct'>PlanState</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>planstate</span> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN1086"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN735"><span class='Ref_to_Member'>planstate</span></a><span class='Delimiter'>; 
</span><a name="LN1089"></a>    <a href="../../include/nodes/primnodes.h.html#LN678"><span class='Ref_to_Struct'>SubPlan</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>subplan</span> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN1086"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN734"><span class='Ref_to_Member'>subplan</span></a><span class='Delimiter'>; 
</span><a name="LN1090"></a>    <a href="../../include/nodes/execnodes.h.html#LN402"><span class='Ref_to_Struct'>EState</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>estate</span> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN1086"><span class='Ref_to_Parameter'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN814"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>; 
</span><a name="LN1091"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* sanity checks */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN1089"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN707"><span class='Ref_to_Member'>parParam</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"direct correlated subquery unsupported as initplan"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN1089"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN705"><span class='Ref_to_Member'>setParam</span></a> <span class='Operator'>== </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"setParam list of initplan is empty"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/bitmapset.h.html#LN85"><span class='Ref_to_Proto'>bms_is_empty</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN1088"><span class='Ref_To_Local'>planstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN812"><span class='Ref_to_Member'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/plannodes.h.html#LN161"><span class='Ref_to_Member'>extParam</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"extParam set of initplan is empty"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Don't actually re-scan: it'll happen inside ExecSetParamPlan if needed. 
     */ 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Mark this subplan's output parameters as needing recalculation. 
     * 
     * CTE subplans are never executed via parameter recalculation; instead 
     * they get run when called by nodeCtescan.c.  So don't mark the output 
     * parameter of a CTE subplan as dirty, but do set the chgParam bit for it 
     * so that dependent plan nodes will get told to rescan. 
     */ 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN1091"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN1089"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN705"><span class='Ref_to_Member'>setParam</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1115"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>paramid</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN106"><span class='Ref_to_Macro'>lfirst_int</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN1091"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1116"></a>        <a href="../../include/nodes/params.h.html#LN96"><span class='Ref_to_Struct'>ParamExecData</span></a> <span class='Operator'>*</span><span class='Declare_Local'>prm</span> <span class='Operator'>= &</span><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN1090"><span class='Ref_To_Local'>estate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN442"><span class='Ref_to_Member'>es_param_exec_vals</span></a><span class='Delimiter'>[</span><a href="nodeSubplan.c.html#LN1115"><span class='Ref_To_Local'>paramid</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN1089"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN682"><span class='Ref_to_Member'>subLinkType</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/primnodes.h.html#LN625"><span class='Ref_to_EnumConst'>CTE_SUBLINK</span></a><span class='Parentheses'>) 
</span>            <a href="nodeSubplan.c.html#LN1116"><span class='Ref_To_Local'>prm</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/params.h.html#LN98"><span class='Ref_to_Member'>execPlan</span></a> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN1086"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <a href="nodeSubplan.c.html#LN1086"><span class='Ref_to_Parameter'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN836"><span class='Ref_to_Member'>chgParam</span></a> <span class='Operator'>= </span><a href="../../include/nodes/bitmapset.h.html#LN89"><span class='Ref_to_Proto'>bms_add_member</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN1086"><span class='Ref_to_Parameter'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN836"><span class='Ref_to_Member'>chgParam</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN1115"><span class='Ref_To_Local'>paramid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end ExecReScanSetParamPlan &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * ExecInitAlternativeSubPlan 
 * 
 * Initialize for execution of one of a set of alternative subplans. 
 */ 
</span><a href="../../include/nodes/execnodes.h.html#LN762"><span class='Ref_to_Struct'>AlternativeSubPlanState</span></a> <span class='Operator'>* 
</span><a name="LN1132"></a><span class='Declare_Function'>ExecInitAlternativeSubPlan</span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN722"><span class='Ref_to_Struct'>AlternativeSubPlan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>asplan</span><span class='Delimiter'>, </span><a href="../../include/nodes/execnodes.h.html#LN808"><span class='Ref_to_Struct'>PlanState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>parent</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1134"></a>    <a href="../../include/nodes/execnodes.h.html#LN762"><span class='Ref_to_Struct'>AlternativeSubPlanState</span></a> <span class='Operator'>*</span><span class='Declare_Local'>asstate</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/execnodes.h.html#LN762"><span class='Ref_to_Struct'>AlternativeSubPlanState</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1135"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>num_calls</span><span class='Delimiter'>; 
</span><a name="LN1136"></a>    <a href="../../include/nodes/primnodes.h.html#LN678"><span class='Ref_to_Struct'>SubPlan</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>subplan1</span><span class='Delimiter'>; 
</span><a name="LN1137"></a>    <a href="../../include/nodes/primnodes.h.html#LN678"><span class='Ref_to_Struct'>SubPlan</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>subplan2</span><span class='Delimiter'>; 
</span><a name="LN1138"></a>    <a href="../../include/nodes/nodes.h.html#LN638"><span class='Ref_to_Typedef'>Cost</span></a>        <span class='Declare_Local'>cost1</span><span class='Delimiter'>; 
</span><a name="LN1139"></a>    <a href="../../include/nodes/nodes.h.html#LN638"><span class='Ref_to_Typedef'>Cost</span></a>        <span class='Declare_Local'>cost2</span><span class='Delimiter'>; 
</span><a name="LN1140"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
    <a href="nodeSubplan.c.html#LN1134"><span class='Ref_To_Local'>asstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN765"><span class='Ref_to_Member'>subplan</span></a> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN1132"><span class='Ref_to_Parameter'>asplan</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Initialize subplans.  (Can we get away with only initializing the one 
     * we're going to use?) 
     */ 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN1140"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN1132"><span class='Ref_to_Parameter'>asplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN725"><span class='Ref_to_Member'>subplans</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1150"></a>        <a href="../../include/nodes/primnodes.h.html#LN678"><span class='Ref_to_Struct'>SubPlan</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>sp</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN108"><span class='Ref_to_Macro'>lfirst_node</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN678"><span class='Ref_to_Struct'>SubPlan</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN1140"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1151"></a>        <a href="../../include/nodes/execnodes.h.html#LN731"><span class='Ref_to_Struct'>SubPlanState</span></a> <span class='Operator'>*</span><span class='Declare_Local'>sps</span> <span class='Operator'>= </span><a href="../../include/executor/nodeSubplan.h.html#LN18"><span class='Ref_to_Proto'>ExecInitSubPlan</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN1150"><span class='Ref_To_Local'>sp</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN1132"><span class='Ref_to_Parameter'>parent</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="nodeSubplan.c.html#LN1134"><span class='Ref_To_Local'>asstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN766"><span class='Ref_to_Member'>subplans</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN1134"><span class='Ref_To_Local'>asstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN766"><span class='Ref_to_Member'>subplans</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN1151"><span class='Ref_To_Local'>sps</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="nodeSubplan.c.html#LN1132"><span class='Ref_to_Parameter'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN831"><span class='Ref_to_Member'>subPlan</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN1132"><span class='Ref_to_Parameter'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN831"><span class='Ref_to_Member'>subPlan</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN1151"><span class='Ref_To_Local'>sps</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Select the one to be used.  For this, we need an estimate of the number 
     * of executions of the subplan.  We use the number of output rows 
     * expected from the parent plan node.  This is a good estimate if we are 
     * in the parent's targetlist, and an underestimate (but probably not by 
     * more than a factor of 2) if we are in the qual. 
     */ 
</span>    <a href="nodeSubplan.c.html#LN1135"><span class='Ref_To_Local'>num_calls</span></a> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN1132"><span class='Ref_to_Parameter'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN812"><span class='Ref_to_Member'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/plannodes.h.html#LN130"><span class='Ref_to_Member'>plan_rows</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * The planner saved enough info so that we don't have to work very hard 
     * to estimate the total cost, given the number-of-calls estimate. 
     */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN1132"><span class='Ref_to_Parameter'>asplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN725"><span class='Ref_to_Member'>subplans</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="nodeSubplan.c.html#LN1136"><span class='Ref_To_Local'>subplan1</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN678"><span class='Ref_to_Struct'>SubPlan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN1132"><span class='Ref_to_Parameter'>asplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN725"><span class='Ref_to_Member'>subplans</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="nodeSubplan.c.html#LN1137"><span class='Ref_To_Local'>subplan2</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN678"><span class='Ref_to_Struct'>SubPlan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN115"><span class='Ref_to_Macro'>lsecond</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN1132"><span class='Ref_to_Parameter'>asplan</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN725"><span class='Ref_to_Member'>subplans</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="nodeSubplan.c.html#LN1138"><span class='Ref_To_Local'>cost1</span></a> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN1136"><span class='Ref_To_Local'>subplan1</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN710"><span class='Ref_to_Member'>startup_cost</span></a> <span class='Operator'>+ </span><a href="nodeSubplan.c.html#LN1135"><span class='Ref_To_Local'>num_calls</span></a> <span class='Operator'>* </span><a href="nodeSubplan.c.html#LN1136"><span class='Ref_To_Local'>subplan1</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN711"><span class='Ref_to_Member'>per_call_cost</span></a><span class='Delimiter'>; 
</span>    <a href="nodeSubplan.c.html#LN1139"><span class='Ref_To_Local'>cost2</span></a> <span class='Operator'>= </span><a href="nodeSubplan.c.html#LN1137"><span class='Ref_To_Local'>subplan2</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN710"><span class='Ref_to_Member'>startup_cost</span></a> <span class='Operator'>+ </span><a href="nodeSubplan.c.html#LN1135"><span class='Ref_To_Local'>num_calls</span></a> <span class='Operator'>* </span><a href="nodeSubplan.c.html#LN1137"><span class='Ref_To_Local'>subplan2</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN711"><span class='Ref_to_Member'>per_call_cost</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN1138"><span class='Ref_To_Local'>cost1</span></a> <span class='Operator'>&LT; </span><a href="nodeSubplan.c.html#LN1139"><span class='Ref_To_Local'>cost2</span></a><span class='Parentheses'>) 
</span>        <a href="nodeSubplan.c.html#LN1134"><span class='Ref_To_Local'>asstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN767"><span class='Ref_to_Member'>active</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="nodeSubplan.c.html#LN1134"><span class='Ref_To_Local'>asstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN767"><span class='Ref_to_Member'>active</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="nodeSubplan.c.html#LN1134"><span class='Ref_To_Local'>asstate</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end ExecInitAlternativeSubPlan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * ExecAlternativeSubPlan 
 * 
 * Execute one of a set of alternative subplans. 
 * 
 * Note: in future we might consider changing to different subplans on the 
 * fly, in case the original rowcount estimate turns out to be way off. 
 */ 
</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1194"></a><span class='Declare_Function'>ExecAlternativeSubPlan</span><span class='Parentheses'>(</span><a href="../../include/nodes/execnodes.h.html#LN762"><span class='Ref_to_Struct'>AlternativeSubPlanState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, 
</span><a name="LN1195"></a>                       <a href="../../include/nodes/execnodes.h.html#LN191"><span class='Ref_to_Struct'>ExprContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>econtext</span><span class='Delimiter'>, 
</span><a name="LN1196"></a>                       <span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>isNull</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* Just pass control to the active subplan */ 
</span><a name="LN1199"></a>    <a href="../../include/nodes/execnodes.h.html#LN731"><span class='Ref_to_Struct'>SubPlanState</span></a> <span class='Operator'>*</span><span class='Declare_Local'>activesp</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN226"><span class='Ref_to_Macro'>list_nth_node</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/execnodes.h.html#LN731"><span class='Ref_to_Struct'>SubPlanState</span></a><span class='Delimiter'>, 
</span>                                           <a href="nodeSubplan.c.html#LN1194"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN766"><span class='Ref_to_Member'>subplans</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN1194"><span class='Ref_to_Parameter'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN767"><span class='Ref_to_Member'>active</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="../../include/executor/nodeSubplan.h.html#LN22"><span class='Ref_to_Proto'>ExecSubPlan</span></a><span class='Parentheses'>(</span><a href="nodeSubplan.c.html#LN1199"><span class='Ref_To_Local'>activesp</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN1195"><span class='Ref_to_Parameter'>econtext</span></a><span class='Delimiter'>, </span><a href="nodeSubplan.c.html#LN1196"><span class='Ref_to_Parameter'>isNull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span></pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>