<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\backend\foreign\foreign.c</title>
<LINK REL=StyleSheet HREF="../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\backend\foreign\foreign.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:40 2017
</td></tr>
<tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
</span><span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * foreign.c 
 *        support for foreign-data wrappers, servers and user mappings. 
 * 
 * Portions Copyright (c) 1996-2017, PostgreSQL Global Development Group 
 * 
 * IDENTIFICATION 
 *        src/backend/foreign/foreign.c 
 * 
 *------------------------------------------------------------------------- 
 */ 
</span><span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>"access/htup_details.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/reloptions.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_foreign_data_wrapper.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_foreign_server.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_foreign_table.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_user_mapping.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"foreign/fdwapi.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"foreign/foreign.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"lib/stringinfo.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"miscadmin.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/builtins.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/memutils.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/rel.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/syscache.h"</span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * GetForeignDataWrapper -  look up the foreign-data wrapper by OID. 
 */ 
</span><a href="../../include/foreign/foreign.h.html#LN34"><span class='Ref_to_Struct'>ForeignDataWrapper</span></a> <span class='Operator'>* 
</span><a name="LN34"></a><span class='Declare_Function'>GetForeignDataWrapper</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>fdwid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN36"></a>    <a href="../../include/catalog/pg_foreign_data_wrapper.h.html#LN48"><span class='Ref_to_Typedef'>Form_pg_foreign_data_wrapper</span></a> <span class='Declare_Local'>fdwform</span><span class='Delimiter'>; 
</span><a name="LN37"></a>    <a href="../../include/foreign/foreign.h.html#LN34"><span class='Ref_to_Struct'>ForeignDataWrapper</span></a> <span class='Operator'>*</span><span class='Declare_Local'>fdw</span><span class='Delimiter'>; 
</span><a name="LN38"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>datum</span><span class='Delimiter'>; 
</span><a name="LN39"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tp</span><span class='Delimiter'>; 
</span><a name="LN40"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>isnull</span><span class='Delimiter'>; 
</span> 
    <a href="foreign.c.html#LN39"><span class='Ref_To_Local'>tp</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN61"><span class='Ref_to_EnumConst'>FOREIGNDATAWRAPPEROID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN34"><span class='Ref_to_Parameter'>fdwid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN39"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for foreign-data wrapper %u"</span><span class='Delimiter'>, </span><a href="foreign.c.html#LN34"><span class='Ref_to_Parameter'>fdwid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="foreign.c.html#LN36"><span class='Ref_To_Local'>fdwform</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_foreign_data_wrapper.h.html#LN48"><span class='Ref_to_Typedef'>Form_pg_foreign_data_wrapper</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN39"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="foreign.c.html#LN37"><span class='Ref_To_Local'>fdw</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/foreign/foreign.h.html#LN34"><span class='Ref_to_Struct'>ForeignDataWrapper</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/foreign/foreign.h.html#LN34"><span class='Ref_to_Struct'>ForeignDataWrapper</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN37"><span class='Ref_To_Local'>fdw</span></a><span class='Operator'>-&GT;</span><a href="../../include/foreign/foreign.h.html#LN36"><span class='Ref_to_Member'>fdwid</span></a> <span class='Operator'>= </span><a href="foreign.c.html#LN34"><span class='Ref_to_Parameter'>fdwid</span></a><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN37"><span class='Ref_To_Local'>fdw</span></a><span class='Operator'>-&GT;</span><a href="../../include/foreign/foreign.h.html#LN37"><span class='Ref_to_Member'>owner</span></a> <span class='Operator'>= </span><a href="foreign.c.html#LN36"><span class='Ref_To_Local'>fdwform</span></a><span class='Operator'>-&GT;</span>fdwowner<span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN37"><span class='Ref_To_Local'>fdw</span></a><span class='Operator'>-&GT;</span><a href="../../include/foreign/foreign.h.html#LN38"><span class='Ref_to_Member'>fdwname</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN36"><span class='Ref_To_Local'>fdwform</span></a><span class='Operator'>-&GT;</span>fdwname<span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN37"><span class='Ref_To_Local'>fdw</span></a><span class='Operator'>-&GT;</span><a href="../../include/foreign/foreign.h.html#LN39"><span class='Ref_to_Member'>fdwhandler</span></a> <span class='Operator'>= </span><a href="foreign.c.html#LN36"><span class='Ref_To_Local'>fdwform</span></a><span class='Operator'>-&GT;</span>fdwhandler<span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN37"><span class='Ref_To_Local'>fdw</span></a><span class='Operator'>-&GT;</span><a href="../../include/foreign/foreign.h.html#LN40"><span class='Ref_to_Member'>fdwvalidator</span></a> <span class='Operator'>= </span><a href="foreign.c.html#LN36"><span class='Ref_To_Local'>fdwform</span></a><span class='Operator'>-&GT;</span>fdwvalidator<span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Extract the fdwoptions */ 
</span>    <a href="foreign.c.html#LN38"><span class='Ref_To_Local'>datum</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN133"><span class='Ref_to_Proto'>SysCacheGetAttr</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN61"><span class='Ref_to_EnumConst'>FOREIGNDATAWRAPPEROID</span></a><span class='Delimiter'>, 
</span>                            <a href="foreign.c.html#LN39"><span class='Ref_To_Local'>tp</span></a><span class='Delimiter'>, 
</span>                            <a href="../../include/catalog/pg_foreign_data_wrapper.h.html#LN61"><span class='Ref_to_Const'>Anum_pg_foreign_data_wrapper_fdwoptions</span></a><span class='Delimiter'>, 
</span>                            <span class='Operator'>&</span><a href="foreign.c.html#LN40"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="foreign.c.html#LN40"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>) 
</span>        <a href="foreign.c.html#LN37"><span class='Ref_To_Local'>fdw</span></a><span class='Operator'>-&GT;</span><a href="../../include/foreign/foreign.h.html#LN41"><span class='Ref_to_Member'>options</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="foreign.c.html#LN37"><span class='Ref_To_Local'>fdw</span></a><span class='Operator'>-&GT;</span><a href="../../include/foreign/foreign.h.html#LN41"><span class='Ref_to_Member'>options</span></a> <span class='Operator'>= </span><a href="../../include/access/reloptions.h.html#LN260"><span class='Ref_to_Proto'>untransformRelOptions</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN38"><span class='Ref_To_Local'>datum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN39"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="foreign.c.html#LN37"><span class='Ref_To_Local'>fdw</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end GetForeignDataWrapper &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * GetForeignDataWrapperByName - look up the foreign-data wrapper 
 * definition by name. 
 */ 
</span><a href="../../include/foreign/foreign.h.html#LN34"><span class='Ref_to_Struct'>ForeignDataWrapper</span></a> <span class='Operator'>* 
</span><a name="LN77"></a><span class='Declare_Function'>GetForeignDataWrapperByName</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>fdwname</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>missing_ok</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN79"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>fdwId</span> <span class='Operator'>= </span><a href="../../include/foreign/foreign.h.html#LN81"><span class='Ref_to_Proto'>get_foreign_data_wrapper_oid</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN77"><span class='Ref_to_Parameter'>fdwname</span></a><span class='Delimiter'>, </span><a href="foreign.c.html#LN77"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN79"><span class='Ref_To_Local'>fdwId</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="foreign.c.html#LN33"><span class='Ref_to_Func'>GetForeignDataWrapper</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN79"><span class='Ref_To_Local'>fdwId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * GetForeignServer - look up the foreign server definition. 
 */ 
</span><a href="../../include/foreign/foreign.h.html#LN44"><span class='Ref_to_Struct'>ForeignServer</span></a> <span class='Operator'>* 
</span><a name="LN92"></a><span class='Declare_Function'>GetForeignServer</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>serverid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN94"></a>    <a href="../../include/catalog/pg_foreign_server.h.html#LN47"><span class='Ref_to_Typedef'>Form_pg_foreign_server</span></a> <span class='Declare_Local'>serverform</span><span class='Delimiter'>; 
</span><a name="LN95"></a>    <a href="../../include/foreign/foreign.h.html#LN44"><span class='Ref_to_Struct'>ForeignServer</span></a> <span class='Operator'>*</span><span class='Declare_Local'>server</span><span class='Delimiter'>; 
</span><a name="LN96"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tp</span><span class='Delimiter'>; 
</span><a name="LN97"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>datum</span><span class='Delimiter'>; 
</span><a name="LN98"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>isnull</span><span class='Delimiter'>; 
</span> 
    <a href="foreign.c.html#LN96"><span class='Ref_To_Local'>tp</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN63"><span class='Ref_to_EnumConst'>FOREIGNSERVEROID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN92"><span class='Ref_to_Parameter'>serverid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN96"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for foreign server %u"</span><span class='Delimiter'>, </span><a href="foreign.c.html#LN92"><span class='Ref_to_Parameter'>serverid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="foreign.c.html#LN94"><span class='Ref_To_Local'>serverform</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_foreign_server.h.html#LN47"><span class='Ref_to_Typedef'>Form_pg_foreign_server</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN96"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="foreign.c.html#LN95"><span class='Ref_To_Local'>server</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/foreign/foreign.h.html#LN44"><span class='Ref_to_Struct'>ForeignServer</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/foreign/foreign.h.html#LN44"><span class='Ref_to_Struct'>ForeignServer</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN95"><span class='Ref_To_Local'>server</span></a><span class='Operator'>-&GT;</span><a href="../../include/foreign/foreign.h.html#LN46"><span class='Ref_to_Member'>serverid</span></a> <span class='Operator'>= </span><a href="foreign.c.html#LN92"><span class='Ref_to_Parameter'>serverid</span></a><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN95"><span class='Ref_To_Local'>server</span></a><span class='Operator'>-&GT;</span><a href="../../include/foreign/foreign.h.html#LN49"><span class='Ref_to_Member'>servername</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN94"><span class='Ref_To_Local'>serverform</span></a><span class='Operator'>-&GT;</span>srvname<span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN95"><span class='Ref_To_Local'>server</span></a><span class='Operator'>-&GT;</span><a href="../../include/foreign/foreign.h.html#LN48"><span class='Ref_to_Member'>owner</span></a> <span class='Operator'>= </span><a href="foreign.c.html#LN94"><span class='Ref_To_Local'>serverform</span></a><span class='Operator'>-&GT;</span>srvowner<span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN95"><span class='Ref_To_Local'>server</span></a><span class='Operator'>-&GT;</span><a href="../../include/foreign/foreign.h.html#LN47"><span class='Ref_to_Member'>fdwid</span></a> <span class='Operator'>= </span><a href="foreign.c.html#LN94"><span class='Ref_To_Local'>serverform</span></a><span class='Operator'>-&GT;</span>srvfdw<span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Extract server type */ 
</span>    <a href="foreign.c.html#LN97"><span class='Ref_To_Local'>datum</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN133"><span class='Ref_to_Proto'>SysCacheGetAttr</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN63"><span class='Ref_to_EnumConst'>FOREIGNSERVEROID</span></a><span class='Delimiter'>, 
</span>                            <a href="foreign.c.html#LN96"><span class='Ref_To_Local'>tp</span></a><span class='Delimiter'>, 
</span>                            <a href="../../include/catalog/pg_foreign_server.h.html#LN58"><span class='Ref_to_Const'>Anum_pg_foreign_server_srvtype</span></a><span class='Delimiter'>, 
</span>                            <span class='Operator'>&</span><a href="foreign.c.html#LN98"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN95"><span class='Ref_To_Local'>server</span></a><span class='Operator'>-&GT;</span><a href="../../include/foreign/foreign.h.html#LN50"><span class='Ref_to_Member'>servertype</span></a> <span class='Operator'>= </span><a href="foreign.c.html#LN98"><span class='Ref_To_Local'>isnull</span></a> <span class='Operator'>? </span><span class='Null_Value'>NULL </span><span class='Operator'>: </span><a href="../../include/utils/builtins.h.html#LN91"><span class='Ref_to_Macro'>TextDatumGetCString</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN97"><span class='Ref_To_Local'>datum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Extract server version */ 
</span>    <a href="foreign.c.html#LN97"><span class='Ref_To_Local'>datum</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN133"><span class='Ref_to_Proto'>SysCacheGetAttr</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN63"><span class='Ref_to_EnumConst'>FOREIGNSERVEROID</span></a><span class='Delimiter'>, 
</span>                            <a href="foreign.c.html#LN96"><span class='Ref_To_Local'>tp</span></a><span class='Delimiter'>, 
</span>                            <a href="../../include/catalog/pg_foreign_server.h.html#LN59"><span class='Ref_to_Const'>Anum_pg_foreign_server_srvversion</span></a><span class='Delimiter'>, 
</span>                            <span class='Operator'>&</span><a href="foreign.c.html#LN98"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN95"><span class='Ref_To_Local'>server</span></a><span class='Operator'>-&GT;</span><a href="../../include/foreign/foreign.h.html#LN51"><span class='Ref_to_Member'>serverversion</span></a> <span class='Operator'>= </span><a href="foreign.c.html#LN98"><span class='Ref_To_Local'>isnull</span></a> <span class='Operator'>? </span><span class='Null_Value'>NULL </span><span class='Operator'>: </span><a href="../../include/utils/builtins.h.html#LN91"><span class='Ref_to_Macro'>TextDatumGetCString</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN97"><span class='Ref_To_Local'>datum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Extract the srvoptions */ 
</span>    <a href="foreign.c.html#LN97"><span class='Ref_To_Local'>datum</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN133"><span class='Ref_to_Proto'>SysCacheGetAttr</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN63"><span class='Ref_to_EnumConst'>FOREIGNSERVEROID</span></a><span class='Delimiter'>, 
</span>                            <a href="foreign.c.html#LN96"><span class='Ref_To_Local'>tp</span></a><span class='Delimiter'>, 
</span>                            <a href="../../include/catalog/pg_foreign_server.h.html#LN61"><span class='Ref_to_Const'>Anum_pg_foreign_server_srvoptions</span></a><span class='Delimiter'>, 
</span>                            <span class='Operator'>&</span><a href="foreign.c.html#LN98"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="foreign.c.html#LN98"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>) 
</span>        <a href="foreign.c.html#LN95"><span class='Ref_To_Local'>server</span></a><span class='Operator'>-&GT;</span><a href="../../include/foreign/foreign.h.html#LN52"><span class='Ref_to_Member'>options</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="foreign.c.html#LN95"><span class='Ref_To_Local'>server</span></a><span class='Operator'>-&GT;</span><a href="../../include/foreign/foreign.h.html#LN52"><span class='Ref_to_Member'>options</span></a> <span class='Operator'>= </span><a href="../../include/access/reloptions.h.html#LN260"><span class='Ref_to_Proto'>untransformRelOptions</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN97"><span class='Ref_To_Local'>datum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN96"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="foreign.c.html#LN95"><span class='Ref_To_Local'>server</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end GetForeignServer &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * GetForeignServerByName - look up the foreign server definition by name. 
 */ 
</span><a href="../../include/foreign/foreign.h.html#LN44"><span class='Ref_to_Struct'>ForeignServer</span></a> <span class='Operator'>* 
</span><a name="LN147"></a><span class='Declare_Function'>GetForeignServerByName</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>srvname</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>missing_ok</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN149"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>serverid</span> <span class='Operator'>= </span><a href="../../include/foreign/foreign.h.html#LN82"><span class='Ref_to_Proto'>get_foreign_server_oid</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN147"><span class='Ref_to_Parameter'>srvname</span></a><span class='Delimiter'>, </span><a href="foreign.c.html#LN147"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN149"><span class='Ref_To_Local'>serverid</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="../../include/foreign/foreign.h.html#LN71"><span class='Ref_to_Proto'>GetForeignServer</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN149"><span class='Ref_To_Local'>serverid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * GetUserMapping - look up the user mapping. 
 * 
 * If no mapping is found for the supplied user, we also look for 
 * PUBLIC mappings (userid == InvalidOid). 
 */ 
</span><a href="../../include/foreign/foreign.h.html#LN55"><span class='Ref_to_Struct'>UserMapping</span></a> <span class='Operator'>* 
</span><a name="LN165"></a><span class='Declare_Function'>GetUserMapping</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>userid</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>serverid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN167"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>datum</span><span class='Delimiter'>; 
</span><a name="LN168"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tp</span><span class='Delimiter'>; 
</span><a name="LN169"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>isnull</span><span class='Delimiter'>; 
</span><a name="LN170"></a>    <a href="../../include/foreign/foreign.h.html#LN55"><span class='Ref_to_Struct'>UserMapping</span></a> <span class='Operator'>*</span><span class='Declare_Local'>um</span><span class='Delimiter'>; 
</span> 
    <a href="foreign.c.html#LN168"><span class='Ref_To_Local'>tp</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN157"><span class='Ref_to_Macro'>SearchSysCache2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN109"><span class='Ref_to_EnumConst'>USERMAPPINGUSERSERVER</span></a><span class='Delimiter'>, 
</span>                         <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN165"><span class='Ref_to_Parameter'>userid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN165"><span class='Ref_to_Parameter'>serverid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN168"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Not found for the specific user -- try PUBLIC */ 
</span>        <a href="foreign.c.html#LN168"><span class='Ref_To_Local'>tp</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN157"><span class='Ref_to_Macro'>SearchSysCache2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN109"><span class='Ref_to_EnumConst'>USERMAPPINGUSERSERVER</span></a><span class='Delimiter'>, 
</span>                             <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN165"><span class='Ref_to_Parameter'>serverid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN168"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>))</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_OBJECT<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"user mapping not found for \"%s\""</span><span class='Delimiter'>, 
</span>                        <a href="../../include/foreign/foreign.h.html#LN19"><span class='Ref_to_Macro'>MappingUserName</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN165"><span class='Ref_to_Parameter'>userid</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <a href="foreign.c.html#LN170"><span class='Ref_To_Local'>um</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/foreign/foreign.h.html#LN55"><span class='Ref_to_Struct'>UserMapping</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/foreign/foreign.h.html#LN55"><span class='Ref_to_Struct'>UserMapping</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN170"><span class='Ref_To_Local'>um</span></a><span class='Operator'>-&GT;</span><a href="../../include/foreign/foreign.h.html#LN57"><span class='Ref_to_Member'>umid</span></a> <span class='Operator'>= </span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN168"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN170"><span class='Ref_To_Local'>um</span></a><span class='Operator'>-&GT;</span><a href="../../include/foreign/foreign.h.html#LN58"><span class='Ref_to_Member'>userid</span></a> <span class='Operator'>= </span><a href="foreign.c.html#LN165"><span class='Ref_to_Parameter'>userid</span></a><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN170"><span class='Ref_To_Local'>um</span></a><span class='Operator'>-&GT;</span><a href="../../include/foreign/foreign.h.html#LN59"><span class='Ref_to_Member'>serverid</span></a> <span class='Operator'>= </span><a href="foreign.c.html#LN165"><span class='Ref_to_Parameter'>serverid</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Extract the umoptions */ 
</span>    <a href="foreign.c.html#LN167"><span class='Ref_To_Local'>datum</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN133"><span class='Ref_to_Proto'>SysCacheGetAttr</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN109"><span class='Ref_to_EnumConst'>USERMAPPINGUSERSERVER</span></a><span class='Delimiter'>, 
</span>                            <a href="foreign.c.html#LN168"><span class='Ref_To_Local'>tp</span></a><span class='Delimiter'>, 
</span>                            <a href="../../include/catalog/pg_user_mapping.h.html#LN54"><span class='Ref_to_Const'>Anum_pg_user_mapping_umoptions</span></a><span class='Delimiter'>, 
</span>                            <span class='Operator'>&</span><a href="foreign.c.html#LN169"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="foreign.c.html#LN169"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>) 
</span>        <a href="foreign.c.html#LN170"><span class='Ref_To_Local'>um</span></a><span class='Operator'>-&GT;</span><a href="../../include/foreign/foreign.h.html#LN60"><span class='Ref_to_Member'>options</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="foreign.c.html#LN170"><span class='Ref_To_Local'>um</span></a><span class='Operator'>-&GT;</span><a href="../../include/foreign/foreign.h.html#LN60"><span class='Ref_to_Member'>options</span></a> <span class='Operator'>= </span><a href="../../include/access/reloptions.h.html#LN260"><span class='Ref_to_Proto'>untransformRelOptions</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN167"><span class='Ref_To_Local'>datum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN168"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="foreign.c.html#LN170"><span class='Ref_To_Local'>um</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end GetUserMapping &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * GetForeignTable - look up the foreign table definition by relation oid. 
 */ 
</span><a href="../../include/foreign/foreign.h.html#LN63"><span class='Ref_to_Struct'>ForeignTable</span></a> <span class='Operator'>* 
</span><a name="LN215"></a><span class='Declare_Function'>GetForeignTable</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>relid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN217"></a>    <a href="../../include/catalog/pg_foreign_table.h.html#LN43"><span class='Ref_to_Typedef'>Form_pg_foreign_table</span></a> <span class='Declare_Local'>tableform</span><span class='Delimiter'>; 
</span><a name="LN218"></a>    <a href="../../include/foreign/foreign.h.html#LN63"><span class='Ref_to_Struct'>ForeignTable</span></a> <span class='Operator'>*</span><span class='Declare_Local'>ft</span><span class='Delimiter'>; 
</span><a name="LN219"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tp</span><span class='Delimiter'>; 
</span><a name="LN220"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>datum</span><span class='Delimiter'>; 
</span><a name="LN221"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>isnull</span><span class='Delimiter'>; 
</span> 
    <a href="foreign.c.html#LN219"><span class='Ref_To_Local'>tp</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN64"><span class='Ref_to_EnumConst'>FOREIGNTABLEREL</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN215"><span class='Ref_to_Parameter'>relid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN219"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for foreign table %u"</span><span class='Delimiter'>, </span><a href="foreign.c.html#LN215"><span class='Ref_to_Parameter'>relid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN217"><span class='Ref_To_Local'>tableform</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_foreign_table.h.html#LN43"><span class='Ref_to_Typedef'>Form_pg_foreign_table</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN219"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="foreign.c.html#LN218"><span class='Ref_To_Local'>ft</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/foreign/foreign.h.html#LN63"><span class='Ref_to_Struct'>ForeignTable</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/foreign/foreign.h.html#LN63"><span class='Ref_to_Struct'>ForeignTable</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN218"><span class='Ref_To_Local'>ft</span></a><span class='Operator'>-&GT;</span><a href="../../include/foreign/foreign.h.html#LN65"><span class='Ref_to_Member'>relid</span></a> <span class='Operator'>= </span><a href="foreign.c.html#LN215"><span class='Ref_to_Parameter'>relid</span></a><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN218"><span class='Ref_To_Local'>ft</span></a><span class='Operator'>-&GT;</span><a href="../../include/foreign/foreign.h.html#LN66"><span class='Ref_to_Member'>serverid</span></a> <span class='Operator'>= </span><a href="foreign.c.html#LN217"><span class='Ref_To_Local'>tableform</span></a><span class='Operator'>-&GT;</span>ftserver<span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Extract the ftoptions */ 
</span>    <a href="foreign.c.html#LN220"><span class='Ref_To_Local'>datum</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN133"><span class='Ref_to_Proto'>SysCacheGetAttr</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN64"><span class='Ref_to_EnumConst'>FOREIGNTABLEREL</span></a><span class='Delimiter'>, 
</span>                            <a href="foreign.c.html#LN219"><span class='Ref_To_Local'>tp</span></a><span class='Delimiter'>, 
</span>                            <a href="../../include/catalog/pg_foreign_table.h.html#LN53"><span class='Ref_to_Const'>Anum_pg_foreign_table_ftoptions</span></a><span class='Delimiter'>, 
</span>                            <span class='Operator'>&</span><a href="foreign.c.html#LN221"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="foreign.c.html#LN221"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>) 
</span>        <a href="foreign.c.html#LN218"><span class='Ref_To_Local'>ft</span></a><span class='Operator'>-&GT;</span><a href="../../include/foreign/foreign.h.html#LN67"><span class='Ref_to_Member'>options</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="foreign.c.html#LN218"><span class='Ref_To_Local'>ft</span></a><span class='Operator'>-&GT;</span><a href="../../include/foreign/foreign.h.html#LN67"><span class='Ref_to_Member'>options</span></a> <span class='Operator'>= </span><a href="../../include/access/reloptions.h.html#LN260"><span class='Ref_to_Proto'>untransformRelOptions</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN220"><span class='Ref_To_Local'>datum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN219"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="foreign.c.html#LN218"><span class='Ref_To_Local'>ft</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end GetForeignTable &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * GetForeignColumnOptions - Get attfdwoptions of given relation/attnum 
 * as list of DefElem. 
 */ 
</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>* 
</span><a name="LN253"></a><span class='Declare_Function'>GetForeignColumnOptions</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>relid</span><span class='Delimiter'>, </span><a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Declare_Parameter'>attnum</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN255"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>options</span><span class='Delimiter'>; 
</span><a name="LN256"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tp</span><span class='Delimiter'>; 
</span><a name="LN257"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>datum</span><span class='Delimiter'>; 
</span><a name="LN258"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>isnull</span><span class='Delimiter'>; 
</span> 
    <a href="foreign.c.html#LN256"><span class='Ref_To_Local'>tp</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN157"><span class='Ref_to_Macro'>SearchSysCache2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN40"><span class='Ref_to_EnumConst'>ATTNUM</span></a><span class='Delimiter'>, 
</span>                         <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN253"><span class='Ref_to_Parameter'>relid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../../include/postgres.h.html#LN456"><span class='Ref_to_Macro'>Int16GetDatum</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN253"><span class='Ref_to_Parameter'>attnum</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN256"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for attribute %d of relation %u"</span><span class='Delimiter'>, 
</span>             <a href="foreign.c.html#LN253"><span class='Ref_to_Parameter'>attnum</span></a><span class='Delimiter'>, </span><a href="foreign.c.html#LN253"><span class='Ref_to_Parameter'>relid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN257"><span class='Ref_To_Local'>datum</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN133"><span class='Ref_to_Proto'>SysCacheGetAttr</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN40"><span class='Ref_to_EnumConst'>ATTNUM</span></a><span class='Delimiter'>, 
</span>                            <a href="foreign.c.html#LN256"><span class='Ref_To_Local'>tp</span></a><span class='Delimiter'>, 
</span>                            <a href="../../include/catalog/pg_attribute.h.html#LN215"><span class='Ref_to_Const'>Anum_pg_attribute_attfdwoptions</span></a><span class='Delimiter'>, 
</span>                            <span class='Operator'>&</span><a href="foreign.c.html#LN258"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="foreign.c.html#LN258"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>) 
</span>        <a href="foreign.c.html#LN255"><span class='Ref_To_Local'>options</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="foreign.c.html#LN255"><span class='Ref_To_Local'>options</span></a> <span class='Operator'>= </span><a href="../../include/access/reloptions.h.html#LN260"><span class='Ref_to_Proto'>untransformRelOptions</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN257"><span class='Ref_To_Local'>datum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN256"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="foreign.c.html#LN255"><span class='Ref_To_Local'>options</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end GetForeignColumnOptions &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * GetFdwRoutine - call the specified foreign-data wrapper handler routine 
 * to get its FdwRoutine struct. 
 */ 
</span><a href="../../include/foreign/fdwapi.h.html#LN168"><span class='Ref_to_Struct'>FdwRoutine</span></a> <span class='Operator'>* 
</span><a name="LN286"></a><span class='Declare_Function'>GetFdwRoutine</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>fdwhandler</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN288"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>datum</span><span class='Delimiter'>; 
</span><a name="LN289"></a>    <a href="../../include/foreign/fdwapi.h.html#LN168"><span class='Ref_to_Struct'>FdwRoutine</span></a> <span class='Operator'>*</span><span class='Declare_Local'>routine</span><span class='Delimiter'>; 
</span> 
    <a href="foreign.c.html#LN288"><span class='Ref_To_Local'>datum</span></a> <span class='Operator'>= </span><a href="../../include/fmgr.h.html#LN619"><span class='Ref_to_Macro'>OidFunctionCall0</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN286"><span class='Ref_to_Parameter'>fdwhandler</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN289"><span class='Ref_To_Local'>routine</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/foreign/fdwapi.h.html#LN168"><span class='Ref_to_Struct'>FdwRoutine</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN288"><span class='Ref_To_Local'>datum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="foreign.c.html#LN289"><span class='Ref_To_Local'>routine</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| !</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN289"><span class='Ref_To_Local'>routine</span></a><span class='Delimiter'>, </span><a href="../../include/foreign/fdwapi.h.html#LN168"><span class='Ref_to_Struct'>FdwRoutine</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"foreign-data wrapper handler function %u did not return an FdwRoutine struct"</span><span class='Delimiter'>, 
</span>             <a href="foreign.c.html#LN286"><span class='Ref_to_Parameter'>fdwhandler</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="foreign.c.html#LN289"><span class='Ref_To_Local'>routine</span></a><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * GetForeignServerIdByRelId - look up the foreign server 
 * for the given foreign table, and return its OID. 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN307"></a><span class='Declare_Function'>GetForeignServerIdByRelId</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>relid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN309"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tp</span><span class='Delimiter'>; 
</span><a name="LN310"></a>    <a href="../../include/catalog/pg_foreign_table.h.html#LN43"><span class='Ref_to_Typedef'>Form_pg_foreign_table</span></a> <span class='Declare_Local'>tableform</span><span class='Delimiter'>; 
</span><a name="LN311"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>serverid</span><span class='Delimiter'>; 
</span> 
    <a href="foreign.c.html#LN309"><span class='Ref_To_Local'>tp</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN64"><span class='Ref_to_EnumConst'>FOREIGNTABLEREL</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN307"><span class='Ref_to_Parameter'>relid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN309"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for foreign table %u"</span><span class='Delimiter'>, </span><a href="foreign.c.html#LN307"><span class='Ref_to_Parameter'>relid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN310"><span class='Ref_To_Local'>tableform</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_foreign_table.h.html#LN43"><span class='Ref_to_Typedef'>Form_pg_foreign_table</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN309"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN311"><span class='Ref_To_Local'>serverid</span></a> <span class='Operator'>= </span><a href="foreign.c.html#LN310"><span class='Ref_To_Local'>tableform</span></a><span class='Operator'>-&GT;</span>ftserver<span class='Delimiter'>; 
</span>    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN309"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="foreign.c.html#LN311"><span class='Ref_To_Local'>serverid</span></a><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * GetFdwRoutineByServerId - look up the handler of the foreign-data wrapper 
 * for the given foreign server, and retrieve its FdwRoutine struct. 
 */ 
</span><a href="../../include/foreign/fdwapi.h.html#LN168"><span class='Ref_to_Struct'>FdwRoutine</span></a> <span class='Operator'>* 
</span><a name="LN329"></a><span class='Declare_Function'>GetFdwRoutineByServerId</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>serverid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN331"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tp</span><span class='Delimiter'>; 
</span><a name="LN332"></a>    <a href="../../include/catalog/pg_foreign_data_wrapper.h.html#LN48"><span class='Ref_to_Typedef'>Form_pg_foreign_data_wrapper</span></a> <span class='Declare_Local'>fdwform</span><span class='Delimiter'>; 
</span><a name="LN333"></a>    <a href="../../include/catalog/pg_foreign_server.h.html#LN47"><span class='Ref_to_Typedef'>Form_pg_foreign_server</span></a> <span class='Declare_Local'>serverform</span><span class='Delimiter'>; 
</span><a name="LN334"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>fdwid</span><span class='Delimiter'>; 
</span><a name="LN335"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>fdwhandler</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Get foreign-data wrapper OID for the server. */ 
</span>    <a href="foreign.c.html#LN331"><span class='Ref_To_Local'>tp</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN63"><span class='Ref_to_EnumConst'>FOREIGNSERVEROID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN329"><span class='Ref_to_Parameter'>serverid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN331"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for foreign server %u"</span><span class='Delimiter'>, </span><a href="foreign.c.html#LN329"><span class='Ref_to_Parameter'>serverid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN333"><span class='Ref_To_Local'>serverform</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_foreign_server.h.html#LN47"><span class='Ref_to_Typedef'>Form_pg_foreign_server</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN331"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN334"><span class='Ref_To_Local'>fdwid</span></a> <span class='Operator'>= </span><a href="foreign.c.html#LN333"><span class='Ref_To_Local'>serverform</span></a><span class='Operator'>-&GT;</span>srvfdw<span class='Delimiter'>; 
</span>    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN331"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Get handler function OID for the FDW. */ 
</span>    <a href="foreign.c.html#LN331"><span class='Ref_To_Local'>tp</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN61"><span class='Ref_to_EnumConst'>FOREIGNDATAWRAPPEROID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN334"><span class='Ref_To_Local'>fdwid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN331"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for foreign-data wrapper %u"</span><span class='Delimiter'>, </span><a href="foreign.c.html#LN334"><span class='Ref_To_Local'>fdwid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN332"><span class='Ref_To_Local'>fdwform</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_foreign_data_wrapper.h.html#LN48"><span class='Ref_to_Typedef'>Form_pg_foreign_data_wrapper</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN331"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN335"><span class='Ref_To_Local'>fdwhandler</span></a> <span class='Operator'>= </span><a href="foreign.c.html#LN332"><span class='Ref_To_Local'>fdwform</span></a><span class='Operator'>-&GT;</span>fdwhandler<span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Complain if FDW has been set to NO HANDLER. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN335"><span class='Ref_To_Local'>fdwhandler</span></a><span class='Parentheses'>))</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_OBJECT_NOT_IN_PREREQUISITE_STATE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"foreign-data wrapper \"%s\" has no handler"</span><span class='Delimiter'>, 
</span>                        <a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN332"><span class='Ref_To_Local'>fdwform</span></a><span class='Operator'>-&GT;</span>fdwname<span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN331"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* And finally, call the handler function. */ 
</span>    <span class='Control'>return</span> <a href="../../include/foreign/fdwapi.h.html#LN232"><span class='Ref_to_Proto'>GetFdwRoutine</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN335"><span class='Ref_To_Local'>fdwhandler</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end GetFdwRoutineByServerId &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * GetFdwRoutineByRelId - look up the handler of the foreign-data wrapper 
 * for the given foreign table, and retrieve its FdwRoutine struct. 
 */ 
</span><a href="../../include/foreign/fdwapi.h.html#LN168"><span class='Ref_to_Struct'>FdwRoutine</span></a> <span class='Operator'>* 
</span><a name="LN371"></a><span class='Declare_Function'>GetFdwRoutineByRelId</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>relid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN373"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>serverid</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Get server OID for the foreign table. */ 
</span>    <a href="foreign.c.html#LN373"><span class='Ref_To_Local'>serverid</span></a> <span class='Operator'>= </span><a href="../../include/foreign/fdwapi.h.html#LN233"><span class='Ref_to_Proto'>GetForeignServerIdByRelId</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN371"><span class='Ref_to_Parameter'>relid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Now retrieve server's FdwRoutine struct. */ 
</span>    <span class='Control'>return</span> <a href="../../include/foreign/fdwapi.h.html#LN234"><span class='Ref_to_Proto'>GetFdwRoutineByServerId</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN373"><span class='Ref_To_Local'>serverid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * GetFdwRoutineForRelation - look up the handler of the foreign-data wrapper 
 * for the given foreign table, and retrieve its FdwRoutine struct. 
 * 
 * This function is preferred over GetFdwRoutineByRelId because it caches 
 * the data in the relcache entry, saving a number of catalog lookups. 
 * 
 * If makecopy is true then the returned data is freshly palloc'd in the 
 * caller's memory context.  Otherwise, it's a pointer to the relcache data, 
 * which will be lost in any relcache reset --- so don't rely on it long. 
 */ 
</span><a href="../../include/foreign/fdwapi.h.html#LN168"><span class='Ref_to_Struct'>FdwRoutine</span></a> <span class='Operator'>* 
</span><a name="LN394"></a><span class='Declare_Function'>GetFdwRoutineForRelation</span><span class='Parentheses'>(</span><a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a> <span class='Declare_Parameter'>relation</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>makecopy</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN396"></a>    <a href="../../include/foreign/fdwapi.h.html#LN168"><span class='Ref_to_Struct'>FdwRoutine</span></a> <span class='Operator'>*</span><span class='Declare_Local'>fdwroutine</span><span class='Delimiter'>; 
</span><a name="LN397"></a>    <a href="../../include/foreign/fdwapi.h.html#LN168"><span class='Ref_to_Struct'>FdwRoutine</span></a> <span class='Operator'>*</span><span class='Declare_Local'>cfdwroutine</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="foreign.c.html#LN394"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN203"><span class='Ref_to_Member'>rd_fdwroutine</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Get the info by consulting the catalogs and the FDW code */ 
</span>        <a href="foreign.c.html#LN396"><span class='Ref_To_Local'>fdwroutine</span></a> <span class='Operator'>= </span><a href="../../include/foreign/fdwapi.h.html#LN235"><span class='Ref_to_Proto'>GetFdwRoutineByRelId</span></a><span class='Parentheses'>(</span><a href="../../include/utils/rel.h.html#LN416"><span class='Ref_to_Macro'>RelationGetRelid</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN394"><span class='Ref_to_Parameter'>relation</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Save the data for later reuse in CacheMemoryContext */ 
</span>        <a href="foreign.c.html#LN397"><span class='Ref_To_Local'>cfdwroutine</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/foreign/fdwapi.h.html#LN168"><span class='Ref_to_Struct'>FdwRoutine</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/utils/palloc.h.html#LN70"><span class='Ref_to_Proto'>MemoryContextAlloc</span></a><span class='Parentheses'>(</span><a href="../utils/mmgr/mcxt.c.html#LN45"><span class='Ref_to_Global_Var'>CacheMemoryContext</span></a><span class='Delimiter'>, 
</span>                                                        <span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/foreign/fdwapi.h.html#LN168"><span class='Ref_to_Struct'>FdwRoutine</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        memcpy<span class='Parentheses'>(</span><a href="foreign.c.html#LN397"><span class='Ref_To_Local'>cfdwroutine</span></a><span class='Delimiter'>, </span><a href="foreign.c.html#LN396"><span class='Ref_To_Local'>fdwroutine</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/foreign/fdwapi.h.html#LN168"><span class='Ref_to_Struct'>FdwRoutine</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="foreign.c.html#LN394"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN203"><span class='Ref_to_Member'>rd_fdwroutine</span></a> <span class='Operator'>= </span><a href="foreign.c.html#LN397"><span class='Ref_To_Local'>cfdwroutine</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Give back the locally palloc'd copy regardless of makecopy */ 
</span>        <span class='Control'>return</span> <a href="foreign.c.html#LN396"><span class='Ref_To_Local'>fdwroutine</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* We have valid cached data --- does the caller want a copy? */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="foreign.c.html#LN394"><span class='Ref_to_Parameter'>makecopy</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="foreign.c.html#LN396"><span class='Ref_To_Local'>fdwroutine</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/foreign/fdwapi.h.html#LN168"><span class='Ref_to_Struct'>FdwRoutine</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/foreign/fdwapi.h.html#LN168"><span class='Ref_to_Struct'>FdwRoutine</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        memcpy<span class='Parentheses'>(</span><a href="foreign.c.html#LN396"><span class='Ref_To_Local'>fdwroutine</span></a><span class='Delimiter'>, </span><a href="foreign.c.html#LN394"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN203"><span class='Ref_to_Member'>rd_fdwroutine</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/foreign/fdwapi.h.html#LN168"><span class='Ref_to_Struct'>FdwRoutine</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="foreign.c.html#LN396"><span class='Ref_To_Local'>fdwroutine</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Only a short-lived reference is needed, so just hand back cached copy */ 
</span>    <span class='Control'>return</span> <a href="foreign.c.html#LN394"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN203"><span class='Ref_to_Member'>rd_fdwroutine</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end GetFdwRoutineForRelation &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * IsImportableForeignTable - filter table names for IMPORT FOREIGN SCHEMA 
 * 
 * Returns TRUE if given table name should be imported according to the 
 * statement's import filter options. 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN434"></a><span class='Declare_Function'>IsImportableForeignTable</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>tablename</span><span class='Delimiter'>, 
</span><a name="LN435"></a>                         <a href="../../include/nodes/parsenodes.h.html#LN2265"><span class='Ref_to_Struct'>ImportForeignSchemaStmt</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>stmt</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN437"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="foreign.c.html#LN435"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2271"><span class='Ref_to_Member'>list_type</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2260"><span class='Ref_to_EnumConst'>FDW_IMPORT_SCHEMA_ALL</span></a><span class='Operator'>: 
</span>            <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2261"><span class='Ref_to_EnumConst'>FDW_IMPORT_SCHEMA_LIMIT_TO</span></a><span class='Operator'>: 
</span>            <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN437"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="foreign.c.html#LN435"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2272"><span class='Ref_to_Member'>table_list</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN447"></a>                <a href="../../include/nodes/primnodes.h.html#LN62"><span class='Ref_to_Struct'>RangeVar</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>rv</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN62"><span class='Ref_to_Struct'>RangeVar</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN437"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="foreign.c.html#LN434"><span class='Ref_to_Parameter'>tablename</span></a><span class='Delimiter'>, </span><a href="foreign.c.html#LN447"><span class='Ref_To_Local'>rv</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2262"><span class='Ref_to_EnumConst'>FDW_IMPORT_SCHEMA_EXCEPT</span></a><span class='Operator'>: 
</span>            <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN437"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="foreign.c.html#LN435"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2272"><span class='Ref_to_Member'>table_list</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN457"></a>                <a href="../../include/nodes/primnodes.h.html#LN62"><span class='Ref_to_Struct'>RangeVar</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>rv</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN62"><span class='Ref_to_Struct'>RangeVar</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN437"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="foreign.c.html#LN434"><span class='Ref_to_Parameter'>tablename</span></a><span class='Delimiter'>, </span><a href="foreign.c.html#LN457"><span class='Ref_To_Local'>rv</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch stmt-&GT;list_type &raquo; </span> 
    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>;</span>               <span class='Comment_Single_Line'>/* shouldn't get here */ 
</span><span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end IsImportableForeignTable &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * deflist_to_tuplestore - Helper function to convert DefElem list to 
 * tuplestore usable in SRF. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN473"></a><span class='Declare_Function'>deflist_to_tuplestore</span><span class='Parentheses'>(</span><a href="../../include/nodes/execnodes.h.html#LN261"><span class='Ref_to_Struct'>ReturnSetInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rsinfo</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>options</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN475"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>cell</span><span class='Delimiter'>; 
</span><a name="LN476"></a>    <a href="../../include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a>   <span class='Declare_Local'>tupdesc</span><span class='Delimiter'>; 
</span><a name="LN477"></a>    <a href="../utils/sort/tuplestore.c.html#LN102"><span class='Ref_to_Struct'>Tuplestorestate</span></a> <span class='Operator'>*</span><span class='Declare_Local'>tupstore</span><span class='Delimiter'>; 
</span><a name="LN478"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>values</span><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]; 
</span><a name="LN479"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>nulls</span><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]; 
</span><a name="LN480"></a>    <a href="../../include/utils/palloc.h.html#LN35"><span class='Ref_to_Typedef'>MemoryContext</span></a> <span class='Declare_Local'>per_query_ctx</span><span class='Delimiter'>; 
</span><a name="LN481"></a>    <a href="../../include/utils/palloc.h.html#LN35"><span class='Ref_to_Typedef'>MemoryContext</span></a> <span class='Declare_Local'>oldcontext</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* check to see if caller supports us returning a tuplestore */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="foreign.c.html#LN473"><span class='Ref_to_Parameter'>rsinfo</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| !</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN473"><span class='Ref_to_Parameter'>rsinfo</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/execnodes.h.html#LN261"><span class='Ref_to_Struct'>ReturnSetInfo</span></a><span class='Parentheses'>))</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"set-valued function called in context that cannot accept a set"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><span class='Parentheses'>(</span><a href="foreign.c.html#LN473"><span class='Ref_to_Parameter'>rsinfo</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN267"><span class='Ref_to_Member'>allowedModes</span></a> <span class='Operator'>& </span><a href="../../include/nodes/execnodes.h.html#LN250"><span class='Ref_to_EnumConst'>SFRM_Materialize</span></a><span class='Parentheses'>) </span><span class='Operator'>|| 
</span>        <a href="foreign.c.html#LN473"><span class='Ref_to_Parameter'>rsinfo</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN266"><span class='Ref_to_Member'>expectedDesc</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"materialize mode required, but it is not allowed in this context"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="foreign.c.html#LN480"><span class='Ref_To_Local'>per_query_ctx</span></a> <span class='Operator'>= </span><a href="foreign.c.html#LN473"><span class='Ref_to_Parameter'>rsinfo</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN265"><span class='Ref_to_Member'>econtext</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN201"><span class='Ref_to_Member'>ecxt_per_query_memory</span></a><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN481"><span class='Ref_To_Local'>oldcontext</span></a> <span class='Operator'>= </span><a href="../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN480"><span class='Ref_To_Local'>per_query_ctx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Now prepare the result set. 
     */ 
</span>    <a href="foreign.c.html#LN476"><span class='Ref_To_Local'>tupdesc</span></a> <span class='Operator'>= </span><a href="../../include/access/tupdesc.h.html#LN88"><span class='Ref_to_Proto'>CreateTupleDescCopy</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN473"><span class='Ref_to_Parameter'>rsinfo</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN266"><span class='Ref_to_Member'>expectedDesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN477"><span class='Ref_To_Local'>tupstore</span></a> <span class='Operator'>= </span><a href="../../include/utils/tuplestore.h.html#LN46"><span class='Ref_to_Proto'>tuplestore_begin_heap</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><a href="../utils/init/globals.c.html#LN112"><span class='Ref_to_Global_Var'>work_mem</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN473"><span class='Ref_to_Parameter'>rsinfo</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN269"><span class='Ref_to_Member'>returnMode</span></a> <span class='Operator'>= </span><a href="../../include/nodes/execnodes.h.html#LN250"><span class='Ref_to_EnumConst'>SFRM_Materialize</span></a><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN473"><span class='Ref_to_Parameter'>rsinfo</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN272"><span class='Ref_to_Member'>setResult</span></a> <span class='Operator'>= </span><a href="foreign.c.html#LN477"><span class='Ref_To_Local'>tupstore</span></a><span class='Delimiter'>; 
</span>    <a href="foreign.c.html#LN473"><span class='Ref_to_Parameter'>rsinfo</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/execnodes.h.html#LN273"><span class='Ref_to_Member'>setDesc</span></a> <span class='Operator'>= </span><a href="foreign.c.html#LN476"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN475"><span class='Ref_To_Local'>cell</span></a><span class='Delimiter'>, </span><a href="foreign.c.html#LN473"><span class='Ref_to_Parameter'>options</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN508"></a>        <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>def</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN475"><span class='Ref_To_Local'>cell</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="foreign.c.html#LN478"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/utils/builtins.h.html#LN90"><span class='Ref_to_Macro'>CStringGetTextDatum</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN508"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="foreign.c.html#LN479"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="foreign.c.html#LN508"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN720"><span class='Ref_to_Member'>arg</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="foreign.c.html#LN478"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/utils/builtins.h.html#LN90"><span class='Ref_to_Macro'>CStringGetTextDatum</span></a><span class='Parentheses'>(((</span><a href="../../include/nodes/value.h.html#LN41"><span class='Ref_to_Struct'>Value</span></a> <span class='Operator'>*</span><span class='Parentheses'>) (</span><a href="foreign.c.html#LN508"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN720"><span class='Ref_to_Member'>arg</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span><a href="../../../contrib/ltree/ltxtquery_io.c.html#LN29"><span class='Ref_to_Member'>val</span></a><span class='Operator'>.</span>str<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="foreign.c.html#LN479"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="foreign.c.html#LN478"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>) </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <a href="foreign.c.html#LN479"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="../../include/utils/tuplestore.h.html#LN55"><span class='Ref_to_Proto'>tuplestore_putvalues</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN477"><span class='Ref_To_Local'>tupstore</span></a><span class='Delimiter'>, </span><a href="foreign.c.html#LN476"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, </span><a href="foreign.c.html#LN478"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>, </span><a href="foreign.c.html#LN479"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* clean up and return the tuplestore */ 
</span>    <a href="../../include/utils/tuplestore.h.html#LN59"><span class='Ref_to_Macro'>tuplestore_donestoring</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN477"><span class='Ref_To_Local'>tupstore</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN481"><span class='Ref_To_Local'>oldcontext</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end deflist_to_tuplestore &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * Convert options array to name/value table.  Useful for information 
 * schema and pg_dump. 
 */ 
</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN537"></a><span class='Declare_Function'>pg_options_to_table</span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN539"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>array</span> <span class='Operator'>= </span><a href="../../include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="foreign.c.html#LN472"><span class='Ref_to_Func'>deflist_to_tuplestore</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/execnodes.h.html#LN261"><span class='Ref_to_Struct'>ReturnSetInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span>fcinfo<span class='Operator'>-&GT;</span>resultinfo<span class='Delimiter'>, 
</span>                          <a href="../../include/access/reloptions.h.html#LN260"><span class='Ref_to_Proto'>untransformRelOptions</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN539"><span class='Ref_To_Local'>array</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>) </span><span class='Number'>0</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * Describes the valid options for postgresql FDW, server, and user mapping. 
 */ 
</span><a name="LN551"></a><span class='Control'>struct</span> <span class='Declare_Struct'>ConnectionOption</span> 
<span class='Delimiter'>{ 
</span><a name="LN553"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Member'>optname</span><span class='Delimiter'>; 
</span><a name="LN554"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Member'>optcontext</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* Oid of catalog in which option may appear */ 
</span><span class='Delimiter'>}; 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Copied from fe-connect.c PQconninfoOptions. 
 * 
 * The list is small - don't bother with bsearch if it stays so. 
 */ 
</span><a name="LN562"></a><span class='Keyword'>static </span><span class='Control'>struct</span> <a href="foreign.c.html#LN551"><span class='Ref_to_Struct'>ConnectionOption</span></a> <span class='Declare_Var'>libpq_conninfo_options</span><span class='Delimiter'>[] </span><span class='Operator'>= </span><span class='Delimiter'>{ 
</span>    <span class='Delimiter'>{</span><span class='String'>"authtype"</span><span class='Delimiter'>, </span><a href="../../include/catalog/pg_foreign_server.h.html#LN26"><span class='Ref_to_Const'>ForeignServerRelationId</span></a><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"service"</span><span class='Delimiter'>, </span><a href="../../include/catalog/pg_foreign_server.h.html#LN26"><span class='Ref_to_Const'>ForeignServerRelationId</span></a><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"user"</span><span class='Delimiter'>, </span><a href="../../include/catalog/pg_user_mapping.h.html#LN26"><span class='Ref_to_Const'>UserMappingRelationId</span></a><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"password"</span><span class='Delimiter'>, </span><a href="../../include/catalog/pg_user_mapping.h.html#LN26"><span class='Ref_to_Const'>UserMappingRelationId</span></a><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"connect_timeout"</span><span class='Delimiter'>, </span><a href="../../include/catalog/pg_foreign_server.h.html#LN26"><span class='Ref_to_Const'>ForeignServerRelationId</span></a><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"dbname"</span><span class='Delimiter'>, </span><a href="../../include/catalog/pg_foreign_server.h.html#LN26"><span class='Ref_to_Const'>ForeignServerRelationId</span></a><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"host"</span><span class='Delimiter'>, </span><a href="../../include/catalog/pg_foreign_server.h.html#LN26"><span class='Ref_to_Const'>ForeignServerRelationId</span></a><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"hostaddr"</span><span class='Delimiter'>, </span><a href="../../include/catalog/pg_foreign_server.h.html#LN26"><span class='Ref_to_Const'>ForeignServerRelationId</span></a><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"port"</span><span class='Delimiter'>, </span><a href="../../include/catalog/pg_foreign_server.h.html#LN26"><span class='Ref_to_Const'>ForeignServerRelationId</span></a><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"tty"</span><span class='Delimiter'>, </span><a href="../../include/catalog/pg_foreign_server.h.html#LN26"><span class='Ref_to_Const'>ForeignServerRelationId</span></a><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"options"</span><span class='Delimiter'>, </span><a href="../../include/catalog/pg_foreign_server.h.html#LN26"><span class='Ref_to_Const'>ForeignServerRelationId</span></a><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"requiressl"</span><span class='Delimiter'>, </span><a href="../../include/catalog/pg_foreign_server.h.html#LN26"><span class='Ref_to_Const'>ForeignServerRelationId</span></a><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"sslmode"</span><span class='Delimiter'>, </span><a href="../../include/catalog/pg_foreign_server.h.html#LN26"><span class='Ref_to_Const'>ForeignServerRelationId</span></a><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='String'>"gsslib"</span><span class='Delimiter'>, </span><a href="../../include/catalog/pg_foreign_server.h.html#LN26"><span class='Ref_to_Const'>ForeignServerRelationId</span></a><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>} 
}; 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * Check if the provided option is one of libpq conninfo options. 
 * context is the Oid of the catalog the option came from, or 0 if we 
 * don't care. 
 */ 
</span><span class='Keyword'>static bool 
</span><a name="LN587"></a><span class='Declare_Function'>is_conninfo_option</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>option</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>context</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN589"></a>    <span class='Control'>struct</span> <a href="foreign.c.html#LN551"><span class='Ref_to_Struct'>ConnectionOption</span></a> <span class='Operator'>*</span><span class='Declare_Local'>opt</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="foreign.c.html#LN589"><span class='Ref_To_Local'>opt</span></a> <span class='Operator'>= </span><a href="foreign.c.html#LN562"><span class='Ref_to_Global_Var'>libpq_conninfo_options</span></a><span class='Delimiter'>; </span><a href="foreign.c.html#LN589"><span class='Ref_To_Local'>opt</span></a><span class='Operator'>-&GT;</span><a href="foreign.c.html#LN553"><span class='Ref_to_Member'>optname</span></a><span class='Delimiter'>; </span><a href="foreign.c.html#LN589"><span class='Ref_To_Local'>opt</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="foreign.c.html#LN587"><span class='Ref_to_Parameter'>context</span></a> <span class='Operator'>== </span><a href="foreign.c.html#LN589"><span class='Ref_To_Local'>opt</span></a><span class='Operator'>-&GT;</span><a href="foreign.c.html#LN554"><span class='Ref_to_Member'>optcontext</span></a> <span class='Operator'>&& </span>strcmp<span class='Parentheses'>(</span><a href="foreign.c.html#LN589"><span class='Ref_To_Local'>opt</span></a><span class='Operator'>-&GT;</span><a href="foreign.c.html#LN553"><span class='Ref_to_Member'>optname</span></a><span class='Delimiter'>, </span><a href="foreign.c.html#LN587"><span class='Ref_to_Parameter'>option</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * Validate the generic option given to SERVER or USER MAPPING. 
 * Raise an ERROR if the option or its value is considered invalid. 
 * 
 * Valid server options are all libpq conninfo options except 
 * user and password -- these may only appear in USER MAPPING options. 
 * 
 * Caution: this function is deprecated, and is now meant only for testing 
 * purposes, because the list of options it knows about doesn't necessarily 
 * square with those known to whichever libpq instance you might be using. 
 * Inquire of libpq itself, instead. 
 */ 
</span><a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN611"></a><span class='Declare_Function'>postgresql_fdw_validator</span><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN613"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>options_list</span> <span class='Operator'>= </span><a href="../../include/access/reloptions.h.html#LN260"><span class='Ref_to_Proto'>untransformRelOptions</span></a><span class='Parentheses'>(</span><a href="../../include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span><a name="LN614"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>catalog</span> <span class='Operator'>= </span><a href="../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<a name="LN616"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>cell</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN616"><span class='Ref_To_Local'>cell</span></a><span class='Delimiter'>, </span><a href="foreign.c.html#LN613"><span class='Ref_To_Local'>options_list</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN620"></a>        <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>def</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN616"><span class='Ref_To_Local'>cell</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="foreign.c.html#LN586"><span class='Ref_to_Func'>is_conninfo_option</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN620"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><a href="foreign.c.html#LN614"><span class='Ref_To_Local'>catalog</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN624"></a>            <span class='Control'>struct</span> <a href="foreign.c.html#LN551"><span class='Ref_to_Struct'>ConnectionOption</span></a> <span class='Operator'>*</span><span class='Declare_Local'>opt</span><span class='Delimiter'>; 
</span><a name="LN625"></a>            <a href="../../include/lib/stringinfo.h.html#LN34"><span class='Ref_to_Struct'>StringInfoData</span></a> <span class='Declare_Local'>buf</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Unknown option specified, complain about it. Provide a hint 
             * with list of valid options for the object. 
             */ 
</span>            <a href="../lib/stringinfo.c.html#LN44"><span class='Ref_to_Func'>initStringInfo</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="foreign.c.html#LN625"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="foreign.c.html#LN624"><span class='Ref_To_Local'>opt</span></a> <span class='Operator'>= </span><a href="foreign.c.html#LN562"><span class='Ref_to_Global_Var'>libpq_conninfo_options</span></a><span class='Delimiter'>; </span><a href="foreign.c.html#LN624"><span class='Ref_To_Local'>opt</span></a><span class='Operator'>-&GT;</span><a href="foreign.c.html#LN553"><span class='Ref_to_Member'>optname</span></a><span class='Delimiter'>; </span><a href="foreign.c.html#LN624"><span class='Ref_To_Local'>opt</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="foreign.c.html#LN614"><span class='Ref_To_Local'>catalog</span></a> <span class='Operator'>== </span><a href="foreign.c.html#LN624"><span class='Ref_To_Local'>opt</span></a><span class='Operator'>-&GT;</span><a href="foreign.c.html#LN554"><span class='Ref_to_Member'>optcontext</span></a><span class='Parentheses'>) 
</span>                    <a href="../../bin/pg_waldump/compat.c.html#LN69"><span class='Ref_to_Func'>appendStringInfo</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="foreign.c.html#LN625"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>"%s%s"</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="foreign.c.html#LN625"><span class='Ref_To_Local'>buf</span></a><span class='Operator'>.</span><a href="../../include/lib/stringinfo.h.html#LN37"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='String'>", "</span> <span class='Operator'>: </span><span class='String'>""</span><span class='Delimiter'>, 
</span>                                     <a href="foreign.c.html#LN624"><span class='Ref_To_Local'>opt</span></a><span class='Operator'>-&GT;</span><a href="foreign.c.html#LN553"><span class='Ref_to_Member'>optname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"invalid option \"%s\""</span><span class='Delimiter'>, </span><a href="foreign.c.html#LN620"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN985"><span class='Ref_to_Func'>errhint</span></a><span class='Parentheses'>(</span><span class='String'>"Valid options in this context are: %s"</span><span class='Delimiter'>, 
</span>                             <a href="foreign.c.html#LN625"><span class='Ref_To_Local'>buf</span></a><span class='Operator'>.</span><a href="../../include/lib/stringinfo.h.html#LN36"><span class='Ref_to_Member'>data</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
            <a href="../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if !is_conninfo_option(d... &raquo; </span> 
    <span class='Delimiter'>} 
</span> 
    <a href="../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end postgresql_fdw_validator &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * get_foreign_data_wrapper_oid - given a FDW name, look up the OID 
 * 
 * If missing_ok is false, throw an error if name not found.  If true, just 
 * return InvalidOid. 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN658"></a><span class='Declare_Function'>get_foreign_data_wrapper_oid</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>fdwname</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>missing_ok</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN660"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>oid</span><span class='Delimiter'>; 
</span> 
    <a href="foreign.c.html#LN660"><span class='Ref_To_Local'>oid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN182"><span class='Ref_to_Macro'>GetSysCacheOid1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN60"><span class='Ref_to_EnumConst'>FOREIGNDATAWRAPPERNAME</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN583"><span class='Ref_to_Macro'>CStringGetDatum</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN658"><span class='Ref_to_Parameter'>fdwname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN660"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>) </span><span class='Operator'>&& !</span><a href="foreign.c.html#LN658"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>)</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_OBJECT<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"foreign-data wrapper \"%s\" does not exist"</span><span class='Delimiter'>, 
</span>                        <a href="foreign.c.html#LN658"><span class='Ref_to_Parameter'>fdwname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="foreign.c.html#LN660"><span class='Ref_To_Local'>oid</span></a><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * get_foreign_server_oid - given a server name, look up the OID 
 * 
 * If missing_ok is false, throw an error if name not found.  If true, just 
 * return InvalidOid. 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN679"></a><span class='Declare_Function'>get_foreign_server_oid</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>servername</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>missing_ok</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN681"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>oid</span><span class='Delimiter'>; 
</span> 
    <a href="foreign.c.html#LN681"><span class='Ref_To_Local'>oid</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN182"><span class='Ref_to_Macro'>GetSysCacheOid1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN62"><span class='Ref_to_EnumConst'>FOREIGNSERVERNAME</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN583"><span class='Ref_to_Macro'>CStringGetDatum</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN679"><span class='Ref_to_Parameter'>servername</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN681"><span class='Ref_To_Local'>oid</span></a><span class='Parentheses'>) </span><span class='Operator'>&& !</span><a href="foreign.c.html#LN679"><span class='Ref_to_Parameter'>missing_ok</span></a><span class='Parentheses'>)</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_OBJECT<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"server \"%s\" does not exist"</span><span class='Delimiter'>, </span><a href="foreign.c.html#LN679"><span class='Ref_to_Parameter'>servername</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="foreign.c.html#LN681"><span class='Ref_To_Local'>oid</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Get a copy of an existing local path for a given join relation. 
 * 
 * This function is usually helpful to obtain an alternate local path for EPQ 
 * checks. 
 * 
 * Right now, this function only supports unparameterized foreign joins, so we 
 * only search for unparameterized path in the given list of paths. Since we 
 * are searching for a path which can be used to construct an alternative local 
 * plan for a foreign join, we look for only MergeJoin, HashJoin or NestLoop 
 * paths. 
 * 
 * If the inner or outer subpath of the chosen path is a ForeignScan, we 
 * replace it with its outer subpath.  For this reason, and also because the 
 * planner might free the original path later, the path returned by this 
 * function is a shallow copy of the original.  There's no need to copy 
 * the substructure, so we don't. 
 * 
 * Since the plan created using this path will presumably only be used to 
 * execute EPQ checks, efficiency of the path is not a concern. But since the 
 * path list in RelOptInfo is anyway sorted by total cost we are likely to 
 * choose the most efficient path, which is all for the best. 
 */ 
</span><span class='Keyword'>extern </span><a href="../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>* 
</span><a name="LN715"></a><span class='Declare_Function'>GetExistingLocalJoinPath</span><span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN717"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN509"><span class='Ref_to_Macro'>IS_JOIN_REL</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN715"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN717"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="foreign.c.html#LN715"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN538"><span class='Ref_to_Member'>pathlist</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN723"></a>        <a href="../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>path</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN717"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN724"></a>        <a href="../../include/nodes/relation.h.html#LN1286"><span class='Ref_to_Struct'>JoinPath</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>joinpath</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Skip parameterized paths. */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="foreign.c.html#LN723"><span class='Ref_To_Local'>path</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="foreign.c.html#LN723"><span class='Ref_To_Local'>path</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN950"><span class='Ref_to_Member'>pathtype</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>case</span> <a href="../../include/nodes/nodes.h.html#LN72"><span class='Ref_to_EnumConst'>T_HashJoin</span></a><span class='Operator'>: 
</span>                <span class='Delimiter'>{ 
</span><a name="LN734"></a>                    <a href="../../include/nodes/relation.h.html#LN1367"><span class='Ref_to_Struct'>HashPath</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>hash_path</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN1367"><span class='Ref_to_Struct'>HashPath</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                    memcpy<span class='Parentheses'>(</span><a href="foreign.c.html#LN734"><span class='Ref_To_Local'>hash_path</span></a><span class='Delimiter'>, </span><a href="foreign.c.html#LN723"><span class='Ref_To_Local'>path</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN1367"><span class='Ref_to_Struct'>HashPath</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                    <a href="foreign.c.html#LN724"><span class='Ref_To_Local'>joinpath</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN1286"><span class='Ref_to_Struct'>JoinPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="foreign.c.html#LN734"><span class='Ref_To_Local'>hash_path</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/nodes.h.html#LN70"><span class='Ref_to_EnumConst'>T_NestLoop</span></a><span class='Operator'>: 
</span>                <span class='Delimiter'>{ 
</span><a name="LN743"></a>                    <a href="../../include/nodes/relation.h.html#LN1311"><span class='Ref_to_Typedef'>NestPath</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>nest_path</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN1311"><span class='Ref_to_Typedef'>NestPath</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                    memcpy<span class='Parentheses'>(</span><a href="foreign.c.html#LN743"><span class='Ref_To_Local'>nest_path</span></a><span class='Delimiter'>, </span><a href="foreign.c.html#LN723"><span class='Ref_To_Local'>path</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN1311"><span class='Ref_to_Typedef'>NestPath</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                    <a href="foreign.c.html#LN724"><span class='Ref_To_Local'>joinpath</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN1286"><span class='Ref_to_Struct'>JoinPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="foreign.c.html#LN743"><span class='Ref_To_Local'>nest_path</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/nodes.h.html#LN71"><span class='Ref_to_EnumConst'>T_MergeJoin</span></a><span class='Operator'>: 
</span>                <span class='Delimiter'>{ 
</span><a name="LN752"></a>                    <a href="../../include/nodes/relation.h.html#LN1348"><span class='Ref_to_Struct'>MergePath</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>merge_path</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN1348"><span class='Ref_to_Struct'>MergePath</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                    memcpy<span class='Parentheses'>(</span><a href="foreign.c.html#LN752"><span class='Ref_To_Local'>merge_path</span></a><span class='Delimiter'>, </span><a href="foreign.c.html#LN723"><span class='Ref_To_Local'>path</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN1348"><span class='Ref_to_Struct'>MergePath</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                    <a href="foreign.c.html#LN724"><span class='Ref_To_Local'>joinpath</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN1286"><span class='Ref_to_Struct'>JoinPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="foreign.c.html#LN752"><span class='Ref_To_Local'>merge_path</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>default</span><span class='Operator'>: 
</span> 
                <span class='Comment_Multi_Line'>/* 
                 * Just skip anything else. We don't know if corresponding 
                 * plan would build the output row from whole-row references 
                 * of base relations and execute the EPQ checks. 
                 */ 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch path-&GT;pathtype &raquo; </span> 
 
        <span class='Comment_Multi_Line'>/* This path isn't good for us, check next. */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="foreign.c.html#LN724"><span class='Ref_To_Local'>joinpath</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If either inner or outer path is a ForeignPath corresponding to a 
         * pushed down join, replace it with the fdw_outerpath, so that we 
         * maintain path for EPQ checks built entirely of local join 
         * strategies. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN724"><span class='Ref_To_Local'>joinpath</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN1295"><span class='Ref_to_Member'>outerjoinpath</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/relation.h.html#LN1127"><span class='Ref_to_Struct'>ForeignPath</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN781"></a>            <a href="../../include/nodes/relation.h.html#LN1127"><span class='Ref_to_Struct'>ForeignPath</span></a> <span class='Operator'>*</span><span class='Declare_Local'>foreign_path</span><span class='Delimiter'>; 
</span> 
            <a href="foreign.c.html#LN781"><span class='Ref_To_Local'>foreign_path</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN1127"><span class='Ref_to_Struct'>ForeignPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="foreign.c.html#LN724"><span class='Ref_To_Local'>joinpath</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN1295"><span class='Ref_to_Member'>outerjoinpath</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN509"><span class='Ref_to_Macro'>IS_JOIN_REL</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN781"><span class='Ref_To_Local'>foreign_path</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN1129"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Parentheses'>))</span> 
                <a href="foreign.c.html#LN724"><span class='Ref_To_Local'>joinpath</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN1295"><span class='Ref_to_Member'>outerjoinpath</span></a> <span class='Operator'>= </span><a href="foreign.c.html#LN781"><span class='Ref_To_Local'>foreign_path</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN1130"><span class='Ref_to_Member'>fdw_outerpath</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN724"><span class='Ref_To_Local'>joinpath</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN1296"><span class='Ref_to_Member'>innerjoinpath</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/relation.h.html#LN1127"><span class='Ref_to_Struct'>ForeignPath</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN790"></a>            <a href="../../include/nodes/relation.h.html#LN1127"><span class='Ref_to_Struct'>ForeignPath</span></a> <span class='Operator'>*</span><span class='Declare_Local'>foreign_path</span><span class='Delimiter'>; 
</span> 
            <a href="foreign.c.html#LN790"><span class='Ref_To_Local'>foreign_path</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN1127"><span class='Ref_to_Struct'>ForeignPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="foreign.c.html#LN724"><span class='Ref_To_Local'>joinpath</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN1296"><span class='Ref_to_Member'>innerjoinpath</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN509"><span class='Ref_to_Macro'>IS_JOIN_REL</span></a><span class='Parentheses'>(</span><a href="foreign.c.html#LN790"><span class='Ref_To_Local'>foreign_path</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN1129"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Parentheses'>))</span> 
                <a href="foreign.c.html#LN724"><span class='Ref_To_Local'>joinpath</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN1296"><span class='Ref_to_Member'>innerjoinpath</span></a> <span class='Operator'>= </span><a href="foreign.c.html#LN790"><span class='Ref_To_Local'>foreign_path</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN1130"><span class='Ref_to_Member'>fdw_outerpath</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="foreign.c.html#LN724"><span class='Ref_To_Local'>joinpath</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end GetExistingLocalJoinPath &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>