<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\backend\lib\rbtree.c</title>
<LINK REL=StyleSheet HREF="../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\backend\lib\rbtree.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:40 2017
</td></tr>
<tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * rbtree.c 
 *    implementation for PostgreSQL generic Red-Black binary tree package 
 *    Adopted from http://algolist.manual.ru/ds/rbtree.php 
 * 
 * This code comes from Thomas Niemann's "Sorting and Searching Algorithms: 
 * a Cookbook". 
 * 
 * See http://www.cs.auckland.ac.nz/software/AlgAnim/niemann/s_man.htm for 
 * license terms: "Source code, when part of a software project, may be used 
 * freely without reference to the author." 
 * 
 * Red-black trees are a type of balanced binary tree wherein (1) any child of 
 * a red node is always black, and (2) every path from root to leaf traverses 
 * an equal number of black nodes.  From these properties, it follows that the 
 * longest path from root to leaf is only about twice as long as the shortest, 
 * so lookups are guaranteed to run in O(lg n) time. 
 * 
 * Copyright (c) 2009-2017, PostgreSQL Global Development Group 
 * 
 * IDENTIFICATION 
 *    src/backend/lib/rbtree.c 
 * 
 *------------------------------------------------------------------------- 
 */ 
</span><span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>"lib/rbtree.h"</span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * Colors of nodes (values of RBNode.color) 
 */ 
</span><a name="LN34"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>RBBLACK</span>     <span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>) 
</span><a name="LN35"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>RBRED</span>       <span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>) 
</span> 
<span class='Comment_Multi_Line'>/* 
 * RBTree control structure 
 */ 
</span><a name="LN40"></a><span class='Control'>struct</span> <span class='Declare_Struct'>RBTree</span> 
<span class='Delimiter'>{ 
</span><a name="LN42"></a>    <a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a>     <span class='Operator'>*</span><span class='Declare_Member'>root</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* root node, or RBNIL if tree is empty */ 
</span> 
    <span class='Comment_Multi_Line'>/* Remaining fields are constant after rb_create */ 
</span> 
<a name="LN46"></a>    <a href="../../include/c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a>        <span class='Declare_Member'>node_size</span><span class='Delimiter'>;</span>      <span class='Comment_Single_Line'>/* actual size of tree nodes */ 
</span>    <span class='Comment_Multi_Line'>/* The caller-supplied manipulation functions */ 
</span><a name="LN48"></a>    <a href="../../include/lib/rbtree.h.html#LN59"><span class='Ref_to_Typedef'>rb_comparator</span></a> <span class='Declare_Member'>comparator</span><span class='Delimiter'>; 
</span><a name="LN49"></a>    <a href="../../include/lib/rbtree.h.html#LN60"><span class='Ref_to_Typedef'>rb_combiner</span></a> <span class='Declare_Member'>combiner</span><span class='Delimiter'>; 
</span><a name="LN50"></a>    <a href="../../include/lib/rbtree.h.html#LN61"><span class='Ref_to_Typedef'>rb_allocfunc</span></a> <span class='Declare_Member'>allocfunc</span><span class='Delimiter'>; 
</span><a name="LN51"></a>    <a href="../../include/lib/rbtree.h.html#LN62"><span class='Ref_to_Typedef'>rb_freefunc</span></a> <span class='Declare_Member'>freefunc</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* Passthrough arg passed to all manipulation functions */ 
</span><a name="LN53"></a>    <span class='Keyword'>void</span>       <span class='Operator'>*</span><span class='Declare_Member'>arg</span><span class='Delimiter'>; 
}; 
</span> 
<span class='Comment_Multi_Line'>/* 
 * all leafs are sentinels, use customized NIL name to prevent 
 * collision with system-wide constant NIL which is actually NULL 
 */ 
</span><a name="LN60"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>RBNIL</span> <span class='Parentheses'>(</span><span class='Operator'>&</span><a href="rbtree.c.html#LN62"><span class='Ref_to_Global_Var'>sentinel</span></a><span class='Parentheses'>) 
</span> 
<a name="LN62"></a><span class='Keyword'>static </span><a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a> <span class='Declare_Var'>sentinel</span> <span class='Operator'>= </span><span class='Delimiter'>{</span><a href="rbtree.c.html#LN34"><span class='Ref_to_Const'>RBBLACK</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>}; 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Values used in the RBTreeIterator.next_state field, with an 
 * InvertedWalk iterator. 
 */ 
</span><a name="LN68"></a><span class='Control'>typedef</span> <span class='Control'>enum</span> <span class='Declare_Enum'>InvertedWalkNextStep</span> 
<span class='Delimiter'>{ 
</span><a name="LN70"></a>    <span class='Declare_Enum_Const'>NextStepBegin</span><span class='Delimiter'>, 
</span><a name="LN71"></a>    <span class='Declare_Enum_Const'>NextStepUp</span><span class='Delimiter'>, 
</span><a name="LN72"></a>    <span class='Declare_Enum_Const'>NextStepLeft</span><span class='Delimiter'>, 
</span><a name="LN73"></a>    <span class='Declare_Enum_Const'>NextStepRight</span> 
<a name="LN74"></a><span class='Delimiter'>} </span><span class='Declare_Typedef'>InvertedWalkNextStep</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* 
 * rb_create: create an empty RBTree 
 * 
 * Arguments are: 
 *  node_size: actual size of tree nodes (&GT; sizeof(RBNode)) 
 *  The manipulation functions: 
 *  comparator: compare two RBNodes for less/equal/greater 
 *  combiner: merge an existing tree entry with a new one 
 *  allocfunc: allocate a new RBNode 
 *  freefunc: free an old RBNode 
 *  arg: passthrough pointer that will be passed to the manipulation functions 
 * 
 * Note that the combiner's righthand argument will be a "proposed" tree node, 
 * ie the input to rb_insert, in which the RBNode fields themselves aren't 
 * valid.  Similarly, either input to the comparator may be a "proposed" node. 
 * This shouldn't matter since the functions aren't supposed to look at the 
 * RBNode fields, only the extra fields of the struct the RBNode is embedded 
 * in. 
 * 
 * The freefunc should just be pfree or equivalent; it should NOT attempt 
 * to free any subsidiary data, because the node passed to it may not contain 
 * valid data!  freefunc can be NULL if caller doesn't require retail 
 * space reclamation. 
 * 
 * The RBTree node is palloc'd in the caller's memory context.  Note that 
 * all contents of the tree are actually allocated by the caller, not here. 
 * 
 * Since tree contents are managed by the caller, there is currently not 
 * an explicit "destroy" operation; typically a tree would be freed by 
 * resetting or deleting the memory context it's stored in.  You can pfree 
 * the RBTree node if you feel the urge. 
 */ 
</span><a href="rbtree.c.html#LN40"><span class='Ref_to_Struct'>RBTree</span></a> <span class='Operator'>* 
</span><a name="LN109"></a><span class='Declare_Function'>rb_create</span><span class='Parentheses'>(</span><a href="../../include/c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a> <span class='Declare_Parameter'>node_size</span><span class='Delimiter'>, 
</span><a name="LN110"></a>          <a href="../../include/lib/rbtree.h.html#LN59"><span class='Ref_to_Typedef'>rb_comparator</span></a> <span class='Declare_Parameter'>comparator</span><span class='Delimiter'>, 
</span><a name="LN111"></a>          <a href="../../include/lib/rbtree.h.html#LN60"><span class='Ref_to_Typedef'>rb_combiner</span></a> <span class='Declare_Parameter'>combiner</span><span class='Delimiter'>, 
</span><a name="LN112"></a>          <a href="../../include/lib/rbtree.h.html#LN61"><span class='Ref_to_Typedef'>rb_allocfunc</span></a> <span class='Declare_Parameter'>allocfunc</span><span class='Delimiter'>, 
</span><a name="LN113"></a>          <a href="../../include/lib/rbtree.h.html#LN62"><span class='Ref_to_Typedef'>rb_freefunc</span></a> <span class='Declare_Parameter'>freefunc</span><span class='Delimiter'>, 
</span><a name="LN114"></a>          <span class='Keyword'>void </span><span class='Operator'>*</span><span class='Declare_Parameter'>arg</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN116"></a>    <a href="rbtree.c.html#LN40"><span class='Ref_to_Struct'>RBTree</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>tree</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="rbtree.c.html#LN40"><span class='Ref_to_Struct'>RBTree</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="rbtree.c.html#LN40"><span class='Ref_to_Struct'>RBTree</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="rbtree.c.html#LN109"><span class='Ref_to_Parameter'>node_size</span></a> <span class='Operator'>&GT; </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="rbtree.c.html#LN116"><span class='Ref_To_Local'>tree</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN42"><span class='Ref_to_Member'>root</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Delimiter'>; 
</span>    <a href="rbtree.c.html#LN116"><span class='Ref_To_Local'>tree</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN46"><span class='Ref_to_Member'>node_size</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN109"><span class='Ref_to_Parameter'>node_size</span></a><span class='Delimiter'>; 
</span>    <a href="rbtree.c.html#LN116"><span class='Ref_To_Local'>tree</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN48"><span class='Ref_to_Member'>comparator</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN110"><span class='Ref_to_Parameter'>comparator</span></a><span class='Delimiter'>; 
</span>    <a href="rbtree.c.html#LN116"><span class='Ref_To_Local'>tree</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN49"><span class='Ref_to_Member'>combiner</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN111"><span class='Ref_to_Parameter'>combiner</span></a><span class='Delimiter'>; 
</span>    <a href="rbtree.c.html#LN116"><span class='Ref_To_Local'>tree</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN50"><span class='Ref_to_Member'>allocfunc</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN112"><span class='Ref_to_Parameter'>allocfunc</span></a><span class='Delimiter'>; 
</span>    <a href="rbtree.c.html#LN116"><span class='Ref_To_Local'>tree</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN51"><span class='Ref_to_Member'>freefunc</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN113"><span class='Ref_to_Parameter'>freefunc</span></a><span class='Delimiter'>; 
</span> 
    <a href="rbtree.c.html#LN116"><span class='Ref_To_Local'>tree</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN53"><span class='Ref_to_Member'>arg</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN114"><span class='Ref_to_Parameter'>arg</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="rbtree.c.html#LN116"><span class='Ref_To_Local'>tree</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end rb_create &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* Copy the additional data fields from one RBNode to another */ 
</span><span class='Keyword'>static inline void 
</span><a name="LN134"></a><span class='Declare_Function'>rb_copy_data</span><span class='Parentheses'>(</span><a href="rbtree.c.html#LN40"><span class='Ref_to_Struct'>RBTree</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rb</span><span class='Delimiter'>, </span><a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dest</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>src</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    memcpy<span class='Parentheses'>(</span><a href="rbtree.c.html#LN134"><span class='Ref_to_Parameter'>dest</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="rbtree.c.html#LN134"><span class='Ref_to_Parameter'>src</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="rbtree.c.html#LN134"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN46"><span class='Ref_to_Member'>node_size</span></a> <span class='Operator'>- </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/********************************************************************** 
 *                        Search                                      * 
 **********************************************************************/ 
</span> 
<span class='Comment_Multi_Line'>/* 
 * rb_find: search for a value in an RBTree 
 * 
 * data represents the value to try to find.  Its RBNode fields need not 
 * be valid, it's the extra data in the larger struct that is of interest. 
 * 
 * Returns the matching tree entry, or NULL if no match is found. 
 */ 
</span><a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a> <span class='Operator'>* 
</span><a name="LN152"></a><span class='Declare_Function'>rb_find</span><span class='Parentheses'>(</span><a href="rbtree.c.html#LN40"><span class='Ref_to_Struct'>RBTree</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rb</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>data</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN154"></a>    <a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="rbtree.c.html#LN152"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN42"><span class='Ref_to_Member'>root</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN154"><span class='Ref_To_Local'>node</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN158"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>cmp</span> <span class='Operator'>= </span><a href="rbtree.c.html#LN152"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN48"><span class='Ref_to_Member'>comparator</span></a><span class='Parentheses'>(</span><a href="rbtree.c.html#LN152"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN154"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN152"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN53"><span class='Ref_to_Member'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN158"><span class='Ref_To_Local'>cmp</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <a href="rbtree.c.html#LN154"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN158"><span class='Ref_To_Local'>cmp</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="rbtree.c.html#LN154"><span class='Ref_To_Local'>node</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN154"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="rbtree.c.html#LN154"><span class='Ref_To_Local'>node</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN154"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * rb_leftmost: fetch the leftmost (smallest-valued) tree node. 
 * Returns NULL if tree is empty. 
 * 
 * Note: in the original implementation this included an unlink step, but 
 * that's a bit awkward.  Just call rb_delete on the result if that's what 
 * you want. 
 */ 
</span><a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a> <span class='Operator'>* 
</span><a name="LN180"></a><span class='Declare_Function'>rb_leftmost</span><span class='Parentheses'>(</span><a href="rbtree.c.html#LN40"><span class='Ref_to_Struct'>RBTree</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rb</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN182"></a>    <a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="rbtree.c.html#LN180"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN42"><span class='Ref_to_Member'>root</span></a><span class='Delimiter'>; 
</span><a name="LN183"></a>    <a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>leftmost</span> <span class='Operator'>= </span><a href="rbtree.c.html#LN180"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN42"><span class='Ref_to_Member'>root</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN182"><span class='Ref_To_Local'>node</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="rbtree.c.html#LN183"><span class='Ref_To_Local'>leftmost</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN182"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
</span>        <a href="rbtree.c.html#LN182"><span class='Ref_To_Local'>node</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN182"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN183"><span class='Ref_To_Local'>leftmost</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="rbtree.c.html#LN183"><span class='Ref_To_Local'>leftmost</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/********************************************************************** 
 *                            Insertion                               * 
 **********************************************************************/ 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Rotate node x to left. 
 * 
 * x's right child takes its place in the tree, and x becomes the left 
 * child of that node. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN208"></a><span class='Declare_Function'>rb_rotate_left</span><span class='Parentheses'>(</span><a href="rbtree.c.html#LN40"><span class='Ref_to_Struct'>RBTree</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rb</span><span class='Delimiter'>, </span><a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>x</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN210"></a>    <a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>y</span> <span class='Operator'>= </span><a href="rbtree.c.html#LN208"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* establish x-&GT;right link */ 
</span>    <a href="rbtree.c.html#LN208"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN210"><span class='Ref_To_Local'>y</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN210"><span class='Ref_To_Local'>y</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>) 
</span>        <a href="rbtree.c.html#LN210"><span class='Ref_To_Local'>y</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN208"><span class='Ref_to_Parameter'>x</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* establish y-&GT;parent link */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN210"><span class='Ref_To_Local'>y</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>) 
</span>        <a href="rbtree.c.html#LN210"><span class='Ref_To_Local'>y</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN208"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN208"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN208"><span class='Ref_to_Parameter'>x</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN208"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Parentheses'>) 
</span>            <a href="rbtree.c.html#LN208"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN210"><span class='Ref_To_Local'>y</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="rbtree.c.html#LN208"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN210"><span class='Ref_To_Local'>y</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="rbtree.c.html#LN208"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN42"><span class='Ref_to_Member'>root</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN210"><span class='Ref_To_Local'>y</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* link x and y */ 
</span>    <a href="rbtree.c.html#LN210"><span class='Ref_To_Local'>y</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN208"><span class='Ref_to_Parameter'>x</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN208"><span class='Ref_to_Parameter'>x</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>) 
</span>        <a href="rbtree.c.html#LN208"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN210"><span class='Ref_To_Local'>y</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end rb_rotate_left &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Rotate node x to right. 
 * 
 * x's left right child takes its place in the tree, and x becomes the right 
 * child of that node. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN245"></a><span class='Declare_Function'>rb_rotate_right</span><span class='Parentheses'>(</span><a href="rbtree.c.html#LN40"><span class='Ref_to_Struct'>RBTree</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rb</span><span class='Delimiter'>, </span><a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>x</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN247"></a>    <a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>y</span> <span class='Operator'>= </span><a href="rbtree.c.html#LN245"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* establish x-&GT;left link */ 
</span>    <a href="rbtree.c.html#LN245"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN247"><span class='Ref_To_Local'>y</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN247"><span class='Ref_To_Local'>y</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>) 
</span>        <a href="rbtree.c.html#LN247"><span class='Ref_To_Local'>y</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN245"><span class='Ref_to_Parameter'>x</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* establish y-&GT;parent link */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN247"><span class='Ref_To_Local'>y</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>) 
</span>        <a href="rbtree.c.html#LN247"><span class='Ref_To_Local'>y</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN245"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN245"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN245"><span class='Ref_to_Parameter'>x</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN245"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a><span class='Parentheses'>) 
</span>            <a href="rbtree.c.html#LN245"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN247"><span class='Ref_To_Local'>y</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="rbtree.c.html#LN245"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN247"><span class='Ref_To_Local'>y</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="rbtree.c.html#LN245"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN42"><span class='Ref_to_Member'>root</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN247"><span class='Ref_To_Local'>y</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* link x and y */ 
</span>    <a href="rbtree.c.html#LN247"><span class='Ref_To_Local'>y</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN245"><span class='Ref_to_Parameter'>x</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN245"><span class='Ref_to_Parameter'>x</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>) 
</span>        <a href="rbtree.c.html#LN245"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN247"><span class='Ref_To_Local'>y</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end rb_rotate_right &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Maintain Red-Black tree balance after inserting node x. 
 * 
 * The newly inserted node is always initially marked red.  That may lead to 
 * a situation where a red node has a red child, which is prohibited.  We can 
 * always fix the problem by a series of color changes and/or "rotations", 
 * which move the problem progressively higher up in the tree.  If one of the 
 * two red nodes is the root, we can always fix the problem by changing the 
 * root from red to black. 
 * 
 * (This does not work lower down in the tree because we must also maintain 
 * the invariant that every leaf has equal black-height.) 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN289"></a><span class='Declare_Function'>rb_insert_fixup</span><span class='Parentheses'>(</span><a href="rbtree.c.html#LN40"><span class='Ref_to_Struct'>RBTree</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rb</span><span class='Delimiter'>, </span><a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>x</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* 
     * x is always a red node.  Initially, it is the newly inserted node. Each 
     * iteration of this loop moves it higher up in the tree. 
     */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN42"><span class='Ref_to_Member'>root</span></a> <span class='Operator'>&& </span><a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN35"><span class='Ref_to_Const'>RBRED</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * x and x-&GT;parent are both red.  Fix depends on whether x-&GT;parent is 
         * a left or right child.  In either case, we define y to be the 
         * "uncle" of x, that is, the other child of x's grandparent. 
         * 
         * If the uncle is red, we flip the grandparent to red and its two 
         * children to black.  Then we loop around again to check whether the 
         * grandparent still has a problem. 
         * 
         * If the uncle is black, we will perform one or two "rotations" to 
         * balance the tree.  Either x or x-&GT;parent will take the 
         * grandparent's position in the tree and recolored black, and the 
         * original grandparent will be recolored red and become a child of 
         * that node. This always leaves us with a valid red-black tree, so 
         * the loop will terminate. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN315"></a>            <a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>y</span> <span class='Operator'>= </span><a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN315"><span class='Ref_To_Local'>y</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN35"><span class='Ref_to_Const'>RBRED</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* uncle is RBRED */ 
</span>                <a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN34"><span class='Ref_to_Const'>RBBLACK</span></a><span class='Delimiter'>; 
</span>                <a href="rbtree.c.html#LN315"><span class='Ref_To_Local'>y</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN34"><span class='Ref_to_Const'>RBBLACK</span></a><span class='Delimiter'>; 
</span>                <a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN35"><span class='Ref_to_Const'>RBRED</span></a><span class='Delimiter'>; 
</span> 
                <a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* uncle is RBBLACK */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Comment_Multi_Line'>/* make x a left child */ 
</span>                    <a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Delimiter'>; 
</span>                    <a href="rbtree.c.html#LN207"><span class='Ref_to_Func'>rb_rotate_left</span></a><span class='Parentheses'>(</span><a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>rb</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span> 
                <span class='Comment_Multi_Line'>/* recolor and rotate */ 
</span>                <a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN34"><span class='Ref_to_Const'>RBBLACK</span></a><span class='Delimiter'>; 
</span>                <a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN35"><span class='Ref_to_Const'>RBRED</span></a><span class='Delimiter'>; 
</span> 
                <a href="rbtree.c.html#LN244"><span class='Ref_to_Func'>rb_rotate_right</span></a><span class='Parentheses'>(</span><a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>rb</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if x-&GT;parent==x-&GT;parent-... &raquo; </span> 
        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* mirror image of above code */ 
</span><a name="LN346"></a>            <a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>y</span> <span class='Operator'>= </span><a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN346"><span class='Ref_To_Local'>y</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN35"><span class='Ref_to_Const'>RBRED</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* uncle is RBRED */ 
</span>                <a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN34"><span class='Ref_to_Const'>RBBLACK</span></a><span class='Delimiter'>; 
</span>                <a href="rbtree.c.html#LN346"><span class='Ref_To_Local'>y</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN34"><span class='Ref_to_Const'>RBBLACK</span></a><span class='Delimiter'>; 
</span>                <a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN35"><span class='Ref_to_Const'>RBRED</span></a><span class='Delimiter'>; 
</span> 
                <a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* uncle is RBBLACK */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Delimiter'>; 
</span>                    <a href="rbtree.c.html#LN244"><span class='Ref_to_Func'>rb_rotate_right</span></a><span class='Parentheses'>(</span><a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>rb</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN34"><span class='Ref_to_Const'>RBBLACK</span></a><span class='Delimiter'>; 
</span>                <a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN35"><span class='Ref_to_Const'>RBRED</span></a><span class='Delimiter'>; 
</span> 
                <a href="rbtree.c.html#LN207"><span class='Ref_to_Func'>rb_rotate_left</span></a><span class='Parentheses'>(</span><a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>rb</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while x!=rb-&GT;root&&x-&GT;paren... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* 
     * The root may already have been black; if not, the black-height of every 
     * node in the tree increases by one. 
     */ 
</span>    <a href="rbtree.c.html#LN289"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN42"><span class='Ref_to_Member'>root</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN34"><span class='Ref_to_Const'>RBBLACK</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end rb_insert_fixup &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * rb_insert: insert a new value into the tree. 
 * 
 * data represents the value to insert.  Its RBNode fields need not 
 * be valid, it's the extra data in the larger struct that is of interest. 
 * 
 * If the value represented by "data" is not present in the tree, then 
 * we copy "data" into a new tree entry and return that node, setting *isNew 
 * to true. 
 * 
 * If the value represented by "data" is already present, then we call the 
 * combiner function to merge data into the existing node, and return the 
 * existing node, setting *isNew to false. 
 * 
 * "data" is unmodified in either case; it's typically just a local 
 * variable in the caller. 
 */ 
</span><a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a> <span class='Operator'>* 
</span><a name="LN398"></a><span class='Declare_Function'>rb_insert</span><span class='Parentheses'>(</span><a href="rbtree.c.html#LN40"><span class='Ref_to_Struct'>RBTree</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rb</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>data</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>isNew</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN400"></a>    <a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>current</span><span class='Delimiter'>, 
</span><a name="LN401"></a>               <span class='Operator'>*</span><span class='Declare_Local'>parent</span><span class='Delimiter'>, 
</span><a name="LN402"></a>               <span class='Operator'>*</span><span class='Declare_Local'>x</span><span class='Delimiter'>; 
</span><a name="LN403"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>cmp</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* find where node belongs */ 
</span>    <a href="rbtree.c.html#LN400"><span class='Ref_To_Local'>current</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN398"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN42"><span class='Ref_to_Member'>root</span></a><span class='Delimiter'>; 
</span>    <a href="rbtree.c.html#LN401"><span class='Ref_To_Local'>parent</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="rbtree.c.html#LN403"><span class='Ref_To_Local'>cmp</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>;</span>                    <span class='Comment_Single_Line'>/* just to prevent compiler warning */ 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN400"><span class='Ref_To_Local'>current</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="rbtree.c.html#LN403"><span class='Ref_To_Local'>cmp</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN398"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN48"><span class='Ref_to_Member'>comparator</span></a><span class='Parentheses'>(</span><a href="rbtree.c.html#LN398"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN400"><span class='Ref_To_Local'>current</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN398"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN53"><span class='Ref_to_Member'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN403"><span class='Ref_To_Local'>cmp</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * Found node with given key.  Apply combiner. 
             */ 
</span>            <a href="rbtree.c.html#LN398"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN49"><span class='Ref_to_Member'>combiner</span></a><span class='Parentheses'>(</span><a href="rbtree.c.html#LN400"><span class='Ref_To_Local'>current</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN398"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN398"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN53"><span class='Ref_to_Member'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="rbtree.c.html#LN398"><span class='Ref_to_Parameter'>isNew</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <a href="rbtree.c.html#LN400"><span class='Ref_To_Local'>current</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="rbtree.c.html#LN401"><span class='Ref_To_Local'>parent</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN400"><span class='Ref_To_Local'>current</span></a><span class='Delimiter'>; 
</span>        <a href="rbtree.c.html#LN400"><span class='Ref_To_Local'>current</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="rbtree.c.html#LN403"><span class='Ref_To_Local'>cmp</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="rbtree.c.html#LN400"><span class='Ref_To_Local'>current</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a> <span class='Operator'>: </span><a href="rbtree.c.html#LN400"><span class='Ref_To_Local'>current</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Value is not present, so create a new node containing data. 
     */ 
</span>    <span class='Operator'>*</span><a href="rbtree.c.html#LN398"><span class='Ref_to_Parameter'>isNew</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
    <a href="rbtree.c.html#LN402"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN398"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN50"><span class='Ref_to_Member'>allocfunc</span></a> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN398"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN53"><span class='Ref_to_Member'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="rbtree.c.html#LN402"><span class='Ref_To_Local'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN35"><span class='Ref_to_Const'>RBRED</span></a><span class='Delimiter'>; 
</span> 
    <a href="rbtree.c.html#LN402"><span class='Ref_To_Local'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Delimiter'>; 
</span>    <a href="rbtree.c.html#LN402"><span class='Ref_To_Local'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Delimiter'>; 
</span>    <a href="rbtree.c.html#LN402"><span class='Ref_To_Local'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN401"><span class='Ref_To_Local'>parent</span></a><span class='Delimiter'>; 
</span>    <a href="rbtree.c.html#LN133"><span class='Ref_to_Func'>rb_copy_data</span></a><span class='Parentheses'>(</span><a href="rbtree.c.html#LN398"><span class='Ref_to_Parameter'>rb</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN402"><span class='Ref_To_Local'>x</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN398"><span class='Ref_to_Parameter'>data</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* insert node in tree */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN401"><span class='Ref_To_Local'>parent</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN403"><span class='Ref_To_Local'>cmp</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="rbtree.c.html#LN401"><span class='Ref_To_Local'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN402"><span class='Ref_To_Local'>x</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="rbtree.c.html#LN401"><span class='Ref_To_Local'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN402"><span class='Ref_To_Local'>x</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="rbtree.c.html#LN398"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN42"><span class='Ref_to_Member'>root</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN402"><span class='Ref_To_Local'>x</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="rbtree.c.html#LN288"><span class='Ref_to_Func'>rb_insert_fixup</span></a><span class='Parentheses'>(</span><a href="rbtree.c.html#LN398"><span class='Ref_to_Parameter'>rb</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN402"><span class='Ref_To_Local'>x</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="rbtree.c.html#LN402"><span class='Ref_To_Local'>x</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end rb_insert &raquo; </span> 
 
<span class='Comment_Multi_Line'>/********************************************************************** 
 *                          Deletion                                  * 
 **********************************************************************/ 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Maintain Red-Black tree balance after deleting a black node. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN466"></a><span class='Declare_Function'>rb_delete_fixup</span><span class='Parentheses'>(</span><a href="rbtree.c.html#LN40"><span class='Ref_to_Struct'>RBTree</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rb</span><span class='Delimiter'>, </span><a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>x</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* 
     * x is always a black node.  Initially, it is the former child of the 
     * deleted node.  Each iteration of this loop moves it higher up in the 
     * tree. 
     */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN42"><span class='Ref_to_Member'>root</span></a> <span class='Operator'>&& </span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN34"><span class='Ref_to_Const'>RBBLACK</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Left and right cases are symmetric.  Any nodes that are children of 
         * x have a black-height one less than the remainder of the nodes in 
         * the tree.  We rotate and recolor nodes to move the problem up the 
         * tree: at some stage we'll either fix the problem, or reach the root 
         * (where the black-height is allowed to decrease). 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN484"></a>            <a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>w</span> <span class='Operator'>= </span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN484"><span class='Ref_To_Local'>w</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN35"><span class='Ref_to_Const'>RBRED</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="rbtree.c.html#LN484"><span class='Ref_To_Local'>w</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN34"><span class='Ref_to_Const'>RBBLACK</span></a><span class='Delimiter'>; 
</span>                <a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN35"><span class='Ref_to_Const'>RBRED</span></a><span class='Delimiter'>; 
</span> 
                <a href="rbtree.c.html#LN207"><span class='Ref_to_Func'>rb_rotate_left</span></a><span class='Parentheses'>(</span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>rb</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="rbtree.c.html#LN484"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN484"><span class='Ref_To_Local'>w</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN34"><span class='Ref_to_Const'>RBBLACK</span></a> <span class='Operator'>&& </span><a href="rbtree.c.html#LN484"><span class='Ref_To_Local'>w</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN34"><span class='Ref_to_Const'>RBBLACK</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="rbtree.c.html#LN484"><span class='Ref_To_Local'>w</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN35"><span class='Ref_to_Const'>RBRED</span></a><span class='Delimiter'>; 
</span> 
                <a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN484"><span class='Ref_To_Local'>w</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN34"><span class='Ref_to_Const'>RBBLACK</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <a href="rbtree.c.html#LN484"><span class='Ref_To_Local'>w</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN34"><span class='Ref_to_Const'>RBBLACK</span></a><span class='Delimiter'>; 
</span>                    <a href="rbtree.c.html#LN484"><span class='Ref_To_Local'>w</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN35"><span class='Ref_to_Const'>RBRED</span></a><span class='Delimiter'>; 
</span> 
                    <a href="rbtree.c.html#LN244"><span class='Ref_to_Func'>rb_rotate_right</span></a><span class='Parentheses'>(</span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>rb</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN484"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <a href="rbtree.c.html#LN484"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <a href="rbtree.c.html#LN484"><span class='Ref_To_Local'>w</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a><span class='Delimiter'>; 
</span>                <a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN34"><span class='Ref_to_Const'>RBBLACK</span></a><span class='Delimiter'>; 
</span>                <a href="rbtree.c.html#LN484"><span class='Ref_To_Local'>w</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN34"><span class='Ref_to_Const'>RBBLACK</span></a><span class='Delimiter'>; 
</span> 
                <a href="rbtree.c.html#LN207"><span class='Ref_to_Func'>rb_rotate_left</span></a><span class='Parentheses'>(</span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>rb</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN42"><span class='Ref_to_Member'>root</span></a><span class='Delimiter'>;</span>   <span class='Comment_Single_Line'>/* Arrange for loop to terminate. */ 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if x==x-&GT;parent-&GT;left &raquo; </span> 
        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span><a name="LN521"></a>            <a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>w</span> <span class='Operator'>= </span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN521"><span class='Ref_To_Local'>w</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN35"><span class='Ref_to_Const'>RBRED</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="rbtree.c.html#LN521"><span class='Ref_To_Local'>w</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN34"><span class='Ref_to_Const'>RBBLACK</span></a><span class='Delimiter'>; 
</span>                <a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN35"><span class='Ref_to_Const'>RBRED</span></a><span class='Delimiter'>; 
</span> 
                <a href="rbtree.c.html#LN244"><span class='Ref_to_Func'>rb_rotate_right</span></a><span class='Parentheses'>(</span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>rb</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="rbtree.c.html#LN521"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN521"><span class='Ref_To_Local'>w</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN34"><span class='Ref_to_Const'>RBBLACK</span></a> <span class='Operator'>&& </span><a href="rbtree.c.html#LN521"><span class='Ref_To_Local'>w</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN34"><span class='Ref_to_Const'>RBBLACK</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="rbtree.c.html#LN521"><span class='Ref_To_Local'>w</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN35"><span class='Ref_to_Const'>RBRED</span></a><span class='Delimiter'>; 
</span> 
                <a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN521"><span class='Ref_To_Local'>w</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN34"><span class='Ref_to_Const'>RBBLACK</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <a href="rbtree.c.html#LN521"><span class='Ref_To_Local'>w</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN34"><span class='Ref_to_Const'>RBBLACK</span></a><span class='Delimiter'>; 
</span>                    <a href="rbtree.c.html#LN521"><span class='Ref_To_Local'>w</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN35"><span class='Ref_to_Const'>RBRED</span></a><span class='Delimiter'>; 
</span> 
                    <a href="rbtree.c.html#LN207"><span class='Ref_to_Func'>rb_rotate_left</span></a><span class='Parentheses'>(</span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>rb</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN521"><span class='Ref_To_Local'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <a href="rbtree.c.html#LN521"><span class='Ref_To_Local'>w</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <a href="rbtree.c.html#LN521"><span class='Ref_To_Local'>w</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a><span class='Delimiter'>; 
</span>                <a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN34"><span class='Ref_to_Const'>RBBLACK</span></a><span class='Delimiter'>; 
</span>                <a href="rbtree.c.html#LN521"><span class='Ref_To_Local'>w</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN34"><span class='Ref_to_Const'>RBBLACK</span></a><span class='Delimiter'>; 
</span> 
                <a href="rbtree.c.html#LN244"><span class='Ref_to_Func'>rb_rotate_right</span></a><span class='Parentheses'>(</span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>rb</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN42"><span class='Ref_to_Member'>root</span></a><span class='Delimiter'>;</span>   <span class='Comment_Single_Line'>/* Arrange for loop to terminate. */ 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while x!=rb-&GT;root&&x-&GT;color... &raquo; </span> 
    <a href="rbtree.c.html#LN466"><span class='Ref_to_Parameter'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN34"><span class='Ref_to_Const'>RBBLACK</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end rb_delete_fixup &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Delete node z from tree. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN564"></a><span class='Declare_Function'>rb_delete_node</span><span class='Parentheses'>(</span><a href="rbtree.c.html#LN40"><span class='Ref_to_Struct'>RBTree</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rb</span><span class='Delimiter'>, </span><a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>z</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN566"></a>    <a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>x</span><span class='Delimiter'>, 
</span><a name="LN567"></a>               <span class='Operator'>*</span><span class='Declare_Local'>y</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="rbtree.c.html#LN564"><span class='Ref_to_Parameter'>z</span></a> <span class='Operator'>|| </span><a href="rbtree.c.html#LN564"><span class='Ref_to_Parameter'>z</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * y is the node that will actually be removed from the tree.  This will 
     * be z if z has fewer than two children, or the tree successor of z 
     * otherwise. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN564"><span class='Ref_to_Parameter'>z</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a> <span class='Operator'>|| </span><a href="rbtree.c.html#LN564"><span class='Ref_to_Parameter'>z</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* y has a RBNIL node as a child */ 
</span>        <a href="rbtree.c.html#LN567"><span class='Ref_To_Local'>y</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN564"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* find tree successor */ 
</span>        <a href="rbtree.c.html#LN567"><span class='Ref_To_Local'>y</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN564"><span class='Ref_to_Parameter'>z</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN567"><span class='Ref_To_Local'>y</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>) 
</span>            <a href="rbtree.c.html#LN567"><span class='Ref_To_Local'>y</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN567"><span class='Ref_To_Local'>y</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* x is y's only child */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN567"><span class='Ref_To_Local'>y</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>) 
</span>        <a href="rbtree.c.html#LN566"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN567"><span class='Ref_To_Local'>y</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="rbtree.c.html#LN566"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN567"><span class='Ref_To_Local'>y</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Remove y from the tree. */ 
</span>    <a href="rbtree.c.html#LN566"><span class='Ref_To_Local'>x</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN567"><span class='Ref_To_Local'>y</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN567"><span class='Ref_To_Local'>y</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN567"><span class='Ref_To_Local'>y</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN567"><span class='Ref_To_Local'>y</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Parentheses'>) 
</span>            <a href="rbtree.c.html#LN567"><span class='Ref_To_Local'>y</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN566"><span class='Ref_To_Local'>x</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="rbtree.c.html#LN567"><span class='Ref_To_Local'>y</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN566"><span class='Ref_To_Local'>x</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="rbtree.c.html#LN564"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN42"><span class='Ref_to_Member'>root</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN566"><span class='Ref_To_Local'>x</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If we removed the tree successor of z rather than z itself, then move 
     * the data for the removed node to the one we were supposed to remove. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN567"><span class='Ref_To_Local'>y</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN564"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>) 
</span>        <a href="rbtree.c.html#LN133"><span class='Ref_to_Func'>rb_copy_data</span></a><span class='Parentheses'>(</span><a href="rbtree.c.html#LN564"><span class='Ref_to_Parameter'>rb</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN564"><span class='Ref_to_Parameter'>z</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN567"><span class='Ref_To_Local'>y</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Removing a black node might make some paths from root to leaf contain 
     * fewer black nodes than others, or it might make two red nodes adjacent. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN567"><span class='Ref_To_Local'>y</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN24"><span class='Ref_to_Member'>color</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN34"><span class='Ref_to_Const'>RBBLACK</span></a><span class='Parentheses'>) 
</span>        <a href="rbtree.c.html#LN465"><span class='Ref_to_Func'>rb_delete_fixup</span></a><span class='Parentheses'>(</span><a href="rbtree.c.html#LN564"><span class='Ref_to_Parameter'>rb</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN566"><span class='Ref_To_Local'>x</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Now we can recycle the y node */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN564"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN51"><span class='Ref_to_Member'>freefunc</span></a><span class='Parentheses'>) 
</span>        <a href="rbtree.c.html#LN564"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN51"><span class='Ref_to_Member'>freefunc</span></a> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN567"><span class='Ref_To_Local'>y</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN564"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN53"><span class='Ref_to_Member'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end rb_delete_node &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * rb_delete: remove the given tree entry 
 * 
 * "node" must have previously been found via rb_find or rb_leftmost. 
 * It is caller's responsibility to free any subsidiary data attached 
 * to the node before calling rb_delete.  (Do *not* try to push that 
 * responsibility off to the freefunc, as some other physical node 
 * may be the one actually freed!) 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN639"></a><span class='Declare_Function'>rb_delete</span><span class='Parentheses'>(</span><a href="rbtree.c.html#LN40"><span class='Ref_to_Struct'>RBTree</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rb</span><span class='Delimiter'>, </span><a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="rbtree.c.html#LN563"><span class='Ref_to_Func'>rb_delete_node</span></a><span class='Parentheses'>(</span><a href="rbtree.c.html#LN639"><span class='Ref_to_Parameter'>rb</span></a><span class='Delimiter'>, </span><a href="rbtree.c.html#LN639"><span class='Ref_to_Parameter'>node</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/********************************************************************** 
 *                        Traverse                                    * 
 **********************************************************************/ 
</span> 
<span class='Keyword'>static </span><a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a> <span class='Operator'>* 
</span><a name="LN649"></a><span class='Declare_Function'>rb_left_right_iterator</span><span class='Parentheses'>(</span><a href="../../include/lib/rbtree.h.html#LN49"><span class='Ref_to_Struct'>RBTreeIterator</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>iter</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN649"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="rbtree.c.html#LN649"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN649"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN51"><span class='Ref_to_Member'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN42"><span class='Ref_to_Member'>root</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN649"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>) 
</span>            <a href="rbtree.c.html#LN649"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN649"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>return</span> <a href="rbtree.c.html#LN649"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN649"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="rbtree.c.html#LN649"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN649"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN649"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>) 
</span>            <a href="rbtree.c.html#LN649"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN649"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>return</span> <a href="rbtree.c.html#LN649"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>;;</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN671"></a>        <a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>came_from</span> <span class='Operator'>= </span><a href="rbtree.c.html#LN649"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Delimiter'>; 
</span> 
        <a href="rbtree.c.html#LN649"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN649"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN649"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="rbtree.c.html#LN649"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN55"><span class='Ref_to_Member'>is_over</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN649"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN671"><span class='Ref_To_Local'>came_from</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>break</span><span class='Delimiter'>;</span>              <span class='Comment_Multi_Line'>/* came from left sub-tree, return current 
                                 * node */ 
</span> 
        <span class='Comment_Multi_Line'>/* else - came from right sub-tree, continue to move up */ 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="rbtree.c.html#LN649"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end rb_left_right_iterator &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a> <span class='Operator'>* 
</span><a name="LN691"></a><span class='Declare_Function'>rb_right_left_iterator</span><span class='Parentheses'>(</span><a href="../../include/lib/rbtree.h.html#LN49"><span class='Ref_to_Struct'>RBTreeIterator</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>iter</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN691"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="rbtree.c.html#LN691"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN691"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN51"><span class='Ref_to_Member'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN42"><span class='Ref_to_Member'>root</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN691"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>) 
</span>            <a href="rbtree.c.html#LN691"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN691"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>return</span> <a href="rbtree.c.html#LN691"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN691"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="rbtree.c.html#LN691"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN691"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN691"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>) 
</span>            <a href="rbtree.c.html#LN691"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN691"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>return</span> <a href="rbtree.c.html#LN691"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>;;</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN713"></a>        <a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>came_from</span> <span class='Operator'>= </span><a href="rbtree.c.html#LN691"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Delimiter'>; 
</span> 
        <a href="rbtree.c.html#LN691"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN691"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN691"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="rbtree.c.html#LN691"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN55"><span class='Ref_to_Member'>is_over</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN691"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN713"><span class='Ref_To_Local'>came_from</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>break</span><span class='Delimiter'>;</span>              <span class='Comment_Multi_Line'>/* came from right sub-tree, return current 
                                 * node */ 
</span> 
        <span class='Comment_Multi_Line'>/* else - came from left sub-tree, continue to move up */ 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="rbtree.c.html#LN691"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end rb_right_left_iterator &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a> <span class='Operator'>* 
</span><a name="LN733"></a><span class='Declare_Function'>rb_direct_iterator</span><span class='Parentheses'>(</span><a href="../../include/lib/rbtree.h.html#LN49"><span class='Ref_to_Struct'>RBTreeIterator</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>iter</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN733"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="rbtree.c.html#LN733"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN733"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN51"><span class='Ref_to_Member'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN42"><span class='Ref_to_Member'>root</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="rbtree.c.html#LN733"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN733"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="rbtree.c.html#LN733"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN733"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="rbtree.c.html#LN733"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>do</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN733"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="rbtree.c.html#LN733"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN733"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* go up and one step right */ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>;;</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN758"></a>            <a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>came_from</span> <span class='Operator'>= </span><a href="rbtree.c.html#LN733"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Delimiter'>; 
</span> 
            <a href="rbtree.c.html#LN733"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN733"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN733"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="rbtree.c.html#LN733"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN55"><span class='Ref_to_Member'>is_over</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="rbtree.c.html#LN733"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN758"><span class='Ref_To_Local'>came_from</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="rbtree.c.html#LN733"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span>                <a href="rbtree.c.html#LN733"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN733"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>return</span> <a href="rbtree.c.html#LN733"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end do &raquo; </span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN733"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="rbtree.c.html#LN733"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end rb_direct_iterator &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a> <span class='Operator'>* 
</span><a name="LN780"></a><span class='Declare_Function'>rb_inverted_iterator</span><span class='Parentheses'>(</span><a href="../../include/lib/rbtree.h.html#LN49"><span class='Ref_to_Struct'>RBTreeIterator</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>iter</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN782"></a>    <a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>came_from</span><span class='Delimiter'>; 
</span><a name="LN783"></a>    <a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>current</span><span class='Delimiter'>; 
</span> 
    <a href="rbtree.c.html#LN783"><span class='Ref_To_Local'>current</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN780"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a><span class='Delimiter'>; 
</span> 
<a name="LN787"></a><span class='Label'>loop</span><span class='Operator'>: 
</span>    <span class='Control'>switch</span> <span class='Parentheses'>((</span><a href="rbtree.c.html#LN68"><span class='Ref_to_Enum'>InvertedWalkNextStep</span></a><span class='Parentheses'>) </span><a href="rbtree.c.html#LN780"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN54"><span class='Ref_to_Member'>next_step</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* First call, begin from root */ 
</span>        <span class='Control'>case</span> <a href="rbtree.c.html#LN70"><span class='Ref_to_EnumConst'>NextStepBegin</span></a><span class='Operator'>: 
</span>            <a href="rbtree.c.html#LN783"><span class='Ref_To_Local'>current</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN780"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN51"><span class='Ref_to_Member'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN42"><span class='Ref_to_Member'>root</span></a><span class='Delimiter'>; 
</span>            <a href="rbtree.c.html#LN780"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN54"><span class='Ref_to_Member'>next_step</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN72"><span class='Ref_to_EnumConst'>NextStepLeft</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>goto</span> <span class='Symbol_Characters'>&uarr;</span><a href="rbtree.c.html#LN787"><span class='Ref_to_Label'>loop</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="rbtree.c.html#LN72"><span class='Ref_to_EnumConst'>NextStepLeft</span></a><span class='Operator'>: 
</span>            <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN783"><span class='Ref_To_Local'>current</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>) 
</span>                <a href="rbtree.c.html#LN783"><span class='Ref_To_Local'>current</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN783"><span class='Ref_To_Local'>current</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Delimiter'>; 
</span> 
            <a href="rbtree.c.html#LN780"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN54"><span class='Ref_to_Member'>next_step</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN73"><span class='Ref_to_EnumConst'>NextStepRight</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>goto</span> <span class='Symbol_Characters'>&uarr;</span><a href="rbtree.c.html#LN787"><span class='Ref_to_Label'>loop</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="rbtree.c.html#LN73"><span class='Ref_to_EnumConst'>NextStepRight</span></a><span class='Operator'>: 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN783"><span class='Ref_To_Local'>current</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a> <span class='Operator'>!= </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="rbtree.c.html#LN783"><span class='Ref_To_Local'>current</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN783"><span class='Ref_To_Local'>current</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a><span class='Delimiter'>; 
</span>                <a href="rbtree.c.html#LN780"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN54"><span class='Ref_to_Member'>next_step</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN72"><span class='Ref_to_EnumConst'>NextStepLeft</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&uarr;</span><a href="rbtree.c.html#LN787"><span class='Ref_to_Label'>loop</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span>    <span class='Comment_Single_Line'>/* not moved - return current, then go up */ 
</span>                <a href="rbtree.c.html#LN780"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN54"><span class='Ref_to_Member'>next_step</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN71"><span class='Ref_to_EnumConst'>NextStepUp</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="rbtree.c.html#LN71"><span class='Ref_to_EnumConst'>NextStepUp</span></a><span class='Operator'>: 
</span>            <a href="rbtree.c.html#LN782"><span class='Ref_To_Local'>came_from</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN783"><span class='Ref_To_Local'>current</span></a><span class='Delimiter'>; 
</span>            <a href="rbtree.c.html#LN783"><span class='Ref_To_Local'>current</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN783"><span class='Ref_To_Local'>current</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN27"><span class='Ref_to_Member'>parent</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN783"><span class='Ref_To_Local'>current</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="rbtree.c.html#LN780"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN55"><span class='Ref_to_Member'>is_over</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>;</span>          <span class='Comment_Single_Line'>/* end of iteration */ 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN782"><span class='Ref_To_Local'>came_from</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN783"><span class='Ref_To_Local'>current</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN26"><span class='Ref_to_Member'>right</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* return current, then continue to go up */ 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* otherwise we came from the left */ 
</span>                <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="rbtree.c.html#LN782"><span class='Ref_To_Local'>came_from</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN783"><span class='Ref_To_Local'>current</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN25"><span class='Ref_to_Member'>left</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="rbtree.c.html#LN780"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN54"><span class='Ref_to_Member'>next_step</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN73"><span class='Ref_to_EnumConst'>NextStepRight</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&uarr;</span><a href="rbtree.c.html#LN787"><span class='Ref_to_Label'>loop</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch (InvertedWalkNextStep... &raquo; </span> 
 
    <a href="rbtree.c.html#LN780"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN783"><span class='Ref_To_Local'>current</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="rbtree.c.html#LN783"><span class='Ref_To_Local'>current</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end rb_inverted_iterator &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * rb_begin_iterate: prepare to traverse the tree in any of several orders 
 * 
 * After calling rb_begin_iterate, call rb_iterate repeatedly until it 
 * returns NULL or the traversal stops being of interest. 
 * 
 * If the tree is changed during traversal, results of further calls to 
 * rb_iterate are unspecified.  Multiple concurrent iterators on the same 
 * tree are allowed. 
 * 
 * The iterator state is stored in the 'iter' struct.  The caller should 
 * treat it as opaque struct. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN854"></a><span class='Declare_Function'>rb_begin_iterate</span><span class='Parentheses'>(</span><a href="rbtree.c.html#LN40"><span class='Ref_to_Struct'>RBTree</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rb</span><span class='Delimiter'>, </span><a href="../../include/lib/rbtree.h.html#LN34"><span class='Ref_to_Enum'>RBOrderControl</span></a> <span class='Declare_Parameter'>ctrl</span><span class='Delimiter'>, </span><a href="../../include/lib/rbtree.h.html#LN49"><span class='Ref_to_Struct'>RBTreeIterator</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>iter</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* Common initialization for all traversal orders */ 
</span>    <a href="rbtree.c.html#LN854"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN51"><span class='Ref_to_Member'>rb</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN854"><span class='Ref_to_Parameter'>rb</span></a><span class='Delimiter'>; 
</span>    <a href="rbtree.c.html#LN854"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN53"><span class='Ref_to_Member'>last_visited</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="rbtree.c.html#LN854"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN55"><span class='Ref_to_Member'>is_over</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="rbtree.c.html#LN854"><span class='Ref_to_Parameter'>rb</span></a><span class='Operator'>-&GT;</span><a href="rbtree.c.html#LN42"><span class='Ref_to_Member'>root</span></a> <span class='Operator'>== </span><a href="rbtree.c.html#LN60"><span class='Ref_to_Const'>RBNIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN854"><span class='Ref_to_Parameter'>ctrl</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../include/lib/rbtree.h.html#LN36"><span class='Ref_to_EnumConst'>LeftRightWalk</span></a><span class='Operator'>:</span>     <span class='Comment_Single_Line'>/* visit left, then self, then right */ 
</span>            <a href="rbtree.c.html#LN854"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span>iterate <span class='Operator'>= </span><a href="rbtree.c.html#LN648"><span class='Ref_to_Func'>rb_left_right_iterator</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/lib/rbtree.h.html#LN37"><span class='Ref_to_EnumConst'>RightLeftWalk</span></a><span class='Operator'>:</span>     <span class='Comment_Single_Line'>/* visit right, then self, then left */ 
</span>            <a href="rbtree.c.html#LN854"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span>iterate <span class='Operator'>= </span><a href="rbtree.c.html#LN690"><span class='Ref_to_Func'>rb_right_left_iterator</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/lib/rbtree.h.html#LN38"><span class='Ref_to_EnumConst'>DirectWalk</span></a><span class='Operator'>:</span>        <span class='Comment_Single_Line'>/* visit self, then left, then right */ 
</span>            <a href="rbtree.c.html#LN854"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span>iterate <span class='Operator'>= </span><a href="rbtree.c.html#LN732"><span class='Ref_to_Func'>rb_direct_iterator</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/lib/rbtree.h.html#LN39"><span class='Ref_to_EnumConst'>InvertedWalk</span></a><span class='Operator'>:</span>      <span class='Comment_Single_Line'>/* visit left, then right, then self */ 
</span>            <a href="rbtree.c.html#LN854"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span>iterate <span class='Operator'>= </span><a href="rbtree.c.html#LN779"><span class='Ref_to_Func'>rb_inverted_iterator</span></a><span class='Delimiter'>; 
</span>            <a href="rbtree.c.html#LN854"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN54"><span class='Ref_to_Member'>next_step</span></a> <span class='Operator'>= </span><a href="rbtree.c.html#LN70"><span class='Ref_to_EnumConst'>NextStepBegin</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized rbtree iteration order: %d"</span><span class='Delimiter'>, </span><a href="rbtree.c.html#LN854"><span class='Ref_to_Parameter'>ctrl</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end rb_begin_iterate &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * rb_iterate: return the next node in traversal order, or NULL if no more 
 */ 
</span><a href="../../include/lib/rbtree.h.html#LN22"><span class='Ref_to_Struct'>RBNode</span></a> <span class='Operator'>* 
</span><a name="LN885"></a><span class='Declare_Function'>rb_iterate</span><span class='Parentheses'>(</span><a href="../../include/lib/rbtree.h.html#LN49"><span class='Ref_to_Struct'>RBTreeIterator</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>iter</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rbtree.c.html#LN885"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span><a href="../../include/lib/rbtree.h.html#LN55"><span class='Ref_to_Member'>is_over</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="rbtree.c.html#LN885"><span class='Ref_to_Parameter'>iter</span></a><span class='Operator'>-&GT;</span>iterate<span class='Parentheses'>(</span><a href="rbtree.c.html#LN885"><span class='Ref_to_Parameter'>iter</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span></pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>