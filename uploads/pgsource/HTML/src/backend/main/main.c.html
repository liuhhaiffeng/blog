<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\backend\main\main.c</title>
<LINK REL=StyleSheet HREF="../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\backend\main\main.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:40 2017
</td></tr>
<tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * main.c 
 *    Stub main() routine for the postgres executable. 
 * 
 * This does some essential startup tasks for any incarnation of postgres 
 * (postmaster, standalone backend, standalone bootstrap process, or a 
 * separately exec'd child of a postmaster) and then dispatches to the 
 * proper FooMain() routine for the incarnation. 
 * 
 * 
 * Portions Copyright (c) 1996-2017, PostgreSQL Global Development Group 
 * Portions Copyright (c) 1994, Regents of the University of California 
 * 
 * 
 * IDENTIFICATION 
 *    src/backend/main/main.c 
 * 
 *------------------------------------------------------------------------- 
 */ 
</span><span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>&LT;unistd.h&GT;</span> 
 
<span class='Directive'>#if</span> defined<span class='Parentheses'>(</span>__NetBSD__<span class='Parentheses'>) 
</span><span class='Keyword'>#include </span><span class='String'>&LT;sys/param.h&GT;</span> 
<span class='Directive'>#endif</span> 
 
<span class='Directive'>#if</span> defined<span class='Parentheses'>(</span>_M_AMD64<span class='Parentheses'>) </span><span class='Operator'>&& </span>_MSC_VER <span class='Operator'>== </span><span class='Number'>1800</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;math.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;versionhelpers.h&GT;</span> 
<span class='Directive'>#endif</span> 
 
<span class='Keyword'>#include </span><span class='String'>"bootstrap/bootstrap.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"common/username.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"port/atomics.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"postmaster/postmaster.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"storage/s_lock.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"storage/spin.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"tcop/tcopprot.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/help_config.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/memutils.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/pg_locale.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/ps_status.h"</span> 
 
 
<a name="LN46"></a><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Var'>progname</span><span class='Delimiter'>; 
</span> 
 
<a name="LN49"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>startup_hacks</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>progname</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN50"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>init_locale</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>categoryname</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>category</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>locale</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN51"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>help</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>progname</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN52"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>check_root</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>progname</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * Any Postgres server process begins execution here. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN59"></a><span class='Declare_Function'>main</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>argc</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>argv</span><span class='Delimiter'>[]</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN61"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>do_check_root</span> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
    <a href="../../bin/pg_test_timing/pg_test_timing.c.html#LN11"><span class='Ref_to_Global_Var'>progname</span></a> <span class='Operator'>= </span><a href="../../include/port.h.html#LN49"><span class='Ref_to_Proto'>get_progname</span></a><span class='Parentheses'>(</span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Platform-specific startup hacks 
     */ 
</span>    <a href="main.c.html#LN49"><span class='Ref_to_Proto'>startup_hacks</span></a><span class='Parentheses'>(</span><a href="../../bin/pg_test_timing/pg_test_timing.c.html#LN11"><span class='Ref_to_Global_Var'>progname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Remember the physical location of the initially given argv[] array for 
     * possible use by ps display.  On some platforms, the argv[] storage must 
     * be overwritten in order to set the process title for ps. In such cases 
     * save_ps_display_args makes and returns a new copy of the argv[] array. 
     * 
     * save_ps_display_args may also move the environment strings to make 
     * extra room. Therefore this should be done as early as possible during 
     * startup, to avoid entanglements with code that might save a getenv() 
     * result pointer. 
     */ 
</span>    <a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argv</span></a> <span class='Operator'>= </span><a href="../../include/utils/ps_status.h.html#LN16"><span class='Ref_to_Proto'>save_ps_display_args</span></a><span class='Parentheses'>(</span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argc</span></a><span class='Delimiter'>, </span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argv</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If supported on the current platform, set up a handler to be called if 
     * the backend/postmaster crashes with a fatal signal or exception. 
     */ 
</span><span class='Directive'>#if</span> defined<span class='Parentheses'>(</span><a href="../../include/c.h.html#LN61"><span class='Ref_to_Const'>WIN32</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span>defined<span class='Parentheses'>(</span>HAVE_MINIDUMP_TYPE<span class='Parentheses'>) 
</span>    <a href="../port/win32/crashdump.c.html#LN178"><span class='Ref_to_Func'>pgwin32_install_crashdump_handler</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
 
    <span class='Comment_Multi_Line'>/* 
     * Fire up essential subsystems: error and memory management 
     * 
     * Code after this point is allowed to use elog/ereport, though 
     * localization of messages may not work right away, and messages won't go 
     * anywhere but stderr until GUC settings get loaded. 
     */ 
</span>    <a href="../../include/utils/memutils.h.html#LN72"><span class='Ref_to_Proto'>MemoryContextInit</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Set up locale information from environment.  Note that LC_CTYPE and 
     * LC_COLLATE will be overridden later from pg_control if we are in an 
     * already-initialized database.  We set them here so that they will be 
     * available to fill pg_control during initdb.  LC_MESSAGES will get set 
     * later during GUC option processing, but we set it here to allow startup 
     * error messages to be localized. 
     */ 
</span> 
    <a href="../../include/port.h.html#LN93"><span class='Ref_to_Proto'>set_pglocale_pgservice</span></a><span class='Parentheses'>(</span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>], </span><a href="../../include/c.h.html#LN1009"><span class='Ref_to_Macro'>PG_TEXTDOMAIN</span></a><span class='Parentheses'>(</span><span class='String'>"postgres"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
<span class='Directive'>#ifdef</span> <a href="../../include/c.h.html#LN61"><span class='Ref_to_Const'>WIN32</span></a> 
 
    <span class='Comment_Multi_Line'>/* 
     * Windows uses codepages rather than the environment, so we work around 
     * that by querying the environment explicitly first for LC_COLLATE and 
     * LC_CTYPE. We have to do this because initdb passes those values in the 
     * environment. If there is nothing there we fall back on the codepage. 
     */ 
</span>    <span class='Delimiter'>{ 
</span><a name="LN120"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>env_locale</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="main.c.html#LN120"><span class='Ref_To_Local'>env_locale</span></a> <span class='Operator'>= </span>getenv<span class='Parentheses'>(</span><span class='String'>"LC_COLLATE"</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
            <a href="main.c.html#LN50"><span class='Ref_to_Proto'>init_locale</span></a><span class='Parentheses'>(</span><span class='String'>"LC_COLLATE"</span><span class='Delimiter'>, </span>LC_COLLATE<span class='Delimiter'>, </span><a href="main.c.html#LN120"><span class='Ref_To_Local'>env_locale</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="main.c.html#LN50"><span class='Ref_to_Proto'>init_locale</span></a><span class='Parentheses'>(</span><span class='String'>"LC_COLLATE"</span><span class='Delimiter'>, </span>LC_COLLATE<span class='Delimiter'>, </span><span class='String'>""</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="main.c.html#LN120"><span class='Ref_To_Local'>env_locale</span></a> <span class='Operator'>= </span>getenv<span class='Parentheses'>(</span><span class='String'>"LC_CTYPE"</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
            <a href="main.c.html#LN50"><span class='Ref_to_Proto'>init_locale</span></a><span class='Parentheses'>(</span><span class='String'>"LC_CTYPE"</span><span class='Delimiter'>, </span>LC_CTYPE<span class='Delimiter'>, </span><a href="main.c.html#LN120"><span class='Ref_To_Local'>env_locale</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="main.c.html#LN50"><span class='Ref_to_Proto'>init_locale</span></a><span class='Parentheses'>(</span><span class='String'>"LC_CTYPE"</span><span class='Delimiter'>, </span>LC_CTYPE<span class='Delimiter'>, </span><span class='String'>""</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span><span class='Directive'>#else</span> 
    <a href="main.c.html#LN50"><span class='Ref_to_Proto'>init_locale</span></a><span class='Parentheses'>(</span><span class='String'>"LC_COLLATE"</span><span class='Delimiter'>, </span>LC_COLLATE<span class='Delimiter'>, </span><span class='String'>""</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="main.c.html#LN50"><span class='Ref_to_Proto'>init_locale</span></a><span class='Parentheses'>(</span><span class='String'>"LC_CTYPE"</span><span class='Delimiter'>, </span>LC_CTYPE<span class='Delimiter'>, </span><span class='String'>""</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
 
<span class='Directive'>#ifdef</span> LC_MESSAGES 
    <a href="main.c.html#LN50"><span class='Ref_to_Proto'>init_locale</span></a><span class='Parentheses'>(</span><span class='String'>"LC_MESSAGES"</span><span class='Delimiter'>, </span>LC_MESSAGES<span class='Delimiter'>, </span><span class='String'>""</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
 
    <span class='Comment_Multi_Line'>/* 
     * We keep these set to "C" always, except transiently in pg_locale.c; see 
     * that file for explanations. 
     */ 
</span>    <a href="main.c.html#LN50"><span class='Ref_to_Proto'>init_locale</span></a><span class='Parentheses'>(</span><span class='String'>"LC_MONETARY"</span><span class='Delimiter'>, </span>LC_MONETARY<span class='Delimiter'>, </span><span class='String'>"C"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="main.c.html#LN50"><span class='Ref_to_Proto'>init_locale</span></a><span class='Parentheses'>(</span><span class='String'>"LC_NUMERIC"</span><span class='Delimiter'>, </span>LC_NUMERIC<span class='Delimiter'>, </span><span class='String'>"C"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="main.c.html#LN50"><span class='Ref_to_Proto'>init_locale</span></a><span class='Parentheses'>(</span><span class='String'>"LC_TIME"</span><span class='Delimiter'>, </span>LC_TIME<span class='Delimiter'>, </span><span class='String'>"C"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Now that we have absorbed as much as we wish to from the locale 
     * environment, remove any LC_ALL setting, so that the environment 
     * variables installed by pg_perm_setlocale have force. 
     */ 
</span>    <a href="../../port/unsetenv.c.html#LN18"><span class='Ref_to_Func'>unsetenv</span></a><span class='Parentheses'>(</span><span class='String'>"LC_ALL"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/pg_locale.h.html#LN48"><span class='Ref_to_Proto'>check_strxfrm_bug</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Catch standard options before doing much else, in particular before we 
     * insist on not being root. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argc</span></a> <span class='Operator'>&GT; </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>], </span><span class='String'>"--help"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| </span>strcmp<span class='Parentheses'>(</span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>], </span><span class='String'>"-?"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="../../bin/scripts/pg_isready.c.html#LN16"><span class='Ref_to_Proto'>help</span></a><span class='Parentheses'>(</span><a href="../../bin/pg_test_timing/pg_test_timing.c.html#LN11"><span class='Ref_to_Global_Var'>progname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../test/isolation/specscanner.l.html#LN91"><span class='Ref_to_Proto'>exit</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>], </span><span class='String'>"--version"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| </span>strcmp<span class='Parentheses'>(</span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>], </span><span class='String'>"-V"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            puts<span class='Parentheses'>(</span><span class='String'>"postgres (PostgreSQL) "</span> PG_VERSION<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../test/isolation/specscanner.l.html#LN91"><span class='Ref_to_Proto'>exit</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * In addition to the above, we allow "--describe-config" and "-C var" 
         * to be called by root.  This is reasonably safe since these are 
         * read-only activities.  The -C case is important because pg_ctl may 
         * try to invoke it while still holding administrator privileges on 
         * Windows.  Note that while -C can normally be in any argv position, 
         * if you want to bypass the root check you must put it first.  This 
         * reduces the risk that we might misinterpret some other mode's -C 
         * switch as being the postmaster/postgres one. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>], </span><span class='String'>"--describe-config"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="main.c.html#LN61"><span class='Ref_To_Local'>do_check_root</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argc</span></a> <span class='Operator'>&GT; </span><span class='Number'>2</span> <span class='Operator'>&& </span>strcmp<span class='Parentheses'>(</span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>], </span><span class='String'>"-C"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="main.c.html#LN61"><span class='Ref_To_Local'>do_check_root</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if argc&GT;1 &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* 
     * Make sure we are not running as root, unless it's safe for the selected 
     * option. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="main.c.html#LN61"><span class='Ref_To_Local'>do_check_root</span></a><span class='Parentheses'>) 
</span>        <a href="main.c.html#LN52"><span class='Ref_to_Proto'>check_root</span></a><span class='Parentheses'>(</span><a href="../../bin/pg_test_timing/pg_test_timing.c.html#LN11"><span class='Ref_to_Global_Var'>progname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Dispatch to one of various subprograms depending on first argument. 
     */ 
</span> 
<span class='Directive'>#ifdef</span> EXEC_BACKEND 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argc</span></a> <span class='Operator'>&GT; </span><span class='Number'>1</span> <span class='Operator'>&& </span>strncmp<span class='Parentheses'>(</span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>], </span><span class='String'>"--fork"</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="../postmaster/postmaster.c.html#LN4683"><span class='Ref_to_Func'>SubPostmasterMain</span></a><span class='Parentheses'>(</span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argc</span></a><span class='Delimiter'>, </span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argv</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>  <span class='Comment_Single_Line'>/* does not return */ 
</span><span class='Directive'>#endif</span> 
 
<span class='Directive'>#ifdef</span> <a href="../../include/c.h.html#LN61"><span class='Ref_to_Const'>WIN32</span></a> 
 
    <span class='Comment_Multi_Line'>/* 
     * Start our win32 signal implementation 
     * 
     * SubPostmasterMain() will do this for itself, but the remaining modes 
     * need it here 
     */ 
</span>    <a href="../port/win32/signal.c.html#LN66"><span class='Ref_to_Func'>pgwin32_signal_initialize</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argc</span></a> <span class='Operator'>&GT; </span><span class='Number'>1</span> <span class='Operator'>&& </span>strcmp<span class='Parentheses'>(</span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>], </span><span class='String'>"--boot"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="../bootstrap/bootstrap.c.html#LN192"><span class='Ref_to_Func'>AuxiliaryProcessMain</span></a><span class='Parentheses'>(</span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argc</span></a><span class='Delimiter'>, </span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argv</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* does not return */ 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argc</span></a> <span class='Operator'>&GT; </span><span class='Number'>1</span> <span class='Operator'>&& </span>strcmp<span class='Parentheses'>(</span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>], </span><span class='String'>"--describe-config"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="../utils/misc/help_config.c.html#LN45"><span class='Ref_to_Func'>GucInfoMain</span></a><span class='Parentheses'>()</span><span class='Delimiter'>;</span>          <span class='Comment_Single_Line'>/* does not return */ 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argc</span></a> <span class='Operator'>&GT; </span><span class='Number'>1</span> <span class='Operator'>&& </span>strcmp<span class='Parentheses'>(</span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>], </span><span class='String'>"--single"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="../tcop/postgres.c.html#LN3577"><span class='Ref_to_Func'>PostgresMain</span></a><span class='Parentheses'>(</span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argc</span></a><span class='Delimiter'>, </span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argv</span></a><span class='Delimiter'>, 
</span>                     <span class='Null_Value'>NULL</span><span class='Delimiter'>,</span>      <span class='Comment_Single_Line'>/* no dbname */ 
</span>                     strdup<span class='Parentheses'>(</span><a href="../../include/common/username.h.html#LN12"><span class='Ref_to_Proto'>get_user_name_or_exit</span></a><span class='Parentheses'>(</span><a href="../../bin/pg_test_timing/pg_test_timing.c.html#LN11"><span class='Ref_to_Global_Var'>progname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>;</span>  <span class='Comment_Single_Line'>/* does not return */ 
</span>    <span class='Control'>else</span> 
        <a href="../postmaster/postmaster.c.html#LN565"><span class='Ref_to_Func'>PostmasterMain</span></a><span class='Parentheses'>(</span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argc</span></a><span class='Delimiter'>, </span><a href="main.c.html#LN59"><span class='Ref_to_Parameter'>argv</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* does not return */ 
</span>    abort<span class='Parentheses'>()</span><span class='Delimiter'>;</span>                    <span class='Comment_Single_Line'>/* should not get here */ 
</span><span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end main &raquo; </span> 
 
 
 
<span class='Comment_Multi_Line'>/* 
 * Place platform-specific startup hacks here.  This is the right 
 * place to put code that must be executed early in the launch of any new 
 * server process.  Note that this code will NOT be executed when a backend 
 * or sub-bootstrap process is forked, unless we are in a fork/exec 
 * environment (ie EXEC_BACKEND is defined). 
 * 
 * XXX The need for code here is proof that the platform in question 
 * is too brain-dead to provide a standard C execution environment 
 * without help.  Avoid adding more here, if you can. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN245"></a><span class='Declare_Function'>startup_hacks</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>progname</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* 
     * Windows-specific execution environment hacking. 
     */ 
</span><span class='Directive'>#ifdef</span> <a href="../../include/c.h.html#LN61"><span class='Ref_to_Const'>WIN32</span></a> 
    <span class='Delimiter'>{ 
</span><a name="LN252"></a>        WSADATA     <span class='Declare_Local'>wsaData</span><span class='Delimiter'>; 
</span><a name="LN253"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>err</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Make output streams unbuffered by default */ 
</span>        setvbuf<span class='Parentheses'>(</span>stdout<span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span>_IONBF<span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        setvbuf<span class='Parentheses'>(</span>stderr<span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span>_IONBF<span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Prepare Winsock */ 
</span>        <a href="main.c.html#LN253"><span class='Ref_To_Local'>err</span></a> <span class='Operator'>= </span>WSAStartup<span class='Parentheses'>(</span>MAKEWORD<span class='Parentheses'>(</span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="main.c.html#LN252"><span class='Ref_To_Local'>wsaData</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="main.c.html#LN253"><span class='Ref_To_Local'>err</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="../../bin/pg_dump/parallel.c.html#LN179"><span class='Ref_to_Macro'>write_stderr</span></a><span class='Parentheses'>(</span><span class='String'>"%s: WSAStartup failed: %d\n"</span><span class='Delimiter'>, 
</span>                         <a href="main.c.html#LN245"><span class='Ref_to_Parameter'>progname</span></a><span class='Delimiter'>, </span><a href="main.c.html#LN253"><span class='Ref_To_Local'>err</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../test/isolation/specscanner.l.html#LN91"><span class='Ref_to_Proto'>exit</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* In case of general protection fault, don't show GUI popup box */ 
</span>        SetErrorMode<span class='Parentheses'>(</span>SEM_FAILCRITICALERRORS <span class='Operator'>| </span>SEM_NOGPFAULTERRORBOX<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Directive'>#if</span> defined<span class='Parentheses'>(</span>_M_AMD64<span class='Parentheses'>) </span><span class='Operator'>&& </span>_MSC_VER <span class='Operator'>== </span><span class='Number'>1800</span> 
 
        <span class='Comment_Multi_Line'>/*---------- 
         * Avoid crashing in certain floating-point operations if we were 
         * compiled for x64 with MS Visual Studio 2013 and are running on 
         * Windows prior to 7/2008R2 SP1 on an AVX2-capable CPU. 
         * 
         * Ref: https://connect.microsoft.com/VisualStudio/feedback/details/811093/visual-studio-2013-rtm-c-x64-code-generation-bug-for-avx2-instructions 
         *---------- 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span>IsWindows7SP1OrGreater<span class='Parentheses'>())</span> 
        <span class='Delimiter'>{ 
</span>            _set_FMA3_enable<span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span><span class='Directive'>#endif</span>   <span class='Comment_Single_Line'>/* defined(_M_AMD64) && _MSC_VER == 1800 */ 
</span> 
    <span class='Delimiter'>} 
</span><span class='Directive'>#endif</span>   <span class='Comment_Single_Line'>/* WIN32 */ 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Initialize dummy_spinlock, in case we are on a platform where we have 
     * to use the fallback implementation of pg_memory_barrier(). 
     */ 
</span>    <a href="../../include/storage/spin.h.html#LN59"><span class='Ref_to_Macro'>SpinLockInit</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="../storage/lmgr/s_lock.c.html#LN63"><span class='Ref_to_Global_Var'>dummy_spinlock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end startup_hacks &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * Make the initial permanent setting for a locale category.  If that fails, 
 * perhaps due to LC_foo=invalid in the environment, use locale C.  If even 
 * that fails, perhaps due to out-of-memory, the entire startup fails with it. 
 * When this returns, we are guaranteed to have a setting for the given 
 * category's environment variable. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN306"></a><span class='Declare_Function'>init_locale</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>categoryname</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>category</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>locale</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/utils/pg_locale.h.html#LN47"><span class='Ref_to_Proto'>pg_perm_setlocale</span></a><span class='Parentheses'>(</span><a href="main.c.html#LN306"><span class='Ref_to_Parameter'>category</span></a><span class='Delimiter'>, </span><a href="main.c.html#LN306"><span class='Ref_to_Parameter'>locale</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>&& 
</span>        <a href="../../include/utils/pg_locale.h.html#LN47"><span class='Ref_to_Proto'>pg_perm_setlocale</span></a><span class='Parentheses'>(</span><a href="main.c.html#LN306"><span class='Ref_to_Parameter'>category</span></a><span class='Delimiter'>, </span><span class='String'>"C"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN51"><span class='Ref_to_Const'>FATAL</span></a><span class='Delimiter'>, </span><span class='String'>"could not adopt \"%s\" locale nor C locale for %s"</span><span class='Delimiter'>, 
</span>             <a href="main.c.html#LN306"><span class='Ref_to_Parameter'>locale</span></a><span class='Delimiter'>, </span><a href="main.c.html#LN306"><span class='Ref_to_Parameter'>categoryname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * Help display should match the options accepted by PostmasterMain() 
 * and PostgresMain(). 
 * 
 * XXX On Windows, non-ASCII localizations of these messages only display 
 * correctly if the console output code page covers the necessary characters. 
 * Messages emitted in write_console() do not exhibit this problem. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN325"></a><span class='Declare_Function'>help</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>progname</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"%s is the PostgreSQL server.\n\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="main.c.html#LN325"><span class='Ref_to_Parameter'>progname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"Usage:\n  %s [OPTION]...\n\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="main.c.html#LN325"><span class='Ref_to_Parameter'>progname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"Options:\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -B NBUFFERS        number of shared buffers\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -c NAME=VALUE      set run-time parameter\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -C NAME            print value of run-time parameter, then exit\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -d 1-5             debugging level\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -D DATADIR         database directory\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -e                 use European date input format (DMY)\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -F                 turn fsync off\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -h HOSTNAME        host name or IP address to listen on\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -i                 enable TCP/IP connections\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -k DIRECTORY       Unix-domain socket location\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span><span class='Directive'>#ifdef</span> <a href="../../include/pg_config_manual.h.html#LN172"><span class='Ref_to_Const'>USE_SSL</span></a> 
    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -l                 enable SSL connections\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -N MAX-CONNECT     maximum number of allowed connections\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -o OPTIONS         pass \"OPTIONS\" to each server process (obsolete)\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -p PORT            port number to listen on\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -s                 show statistics after each query\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -S WORK-MEM        set amount of memory for sorts (in kB)\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -V, --version      output version information, then exit\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  --NAME=VALUE       set run-time parameter\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  --describe-config  describe configuration parameters, then exit\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -?, --help         show this help, then exit\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"\nDeveloper options:\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -f s|i|n|m|h       forbid use of some plan types\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -n                 do not reinitialize shared memory after abnormal exit\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -O                 allow system table structure changes\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -P                 disable system indexes\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -t pa|pl|ex        show timings after each query\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -T                 send SIGSTOP to all backend processes if one dies\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -W NUM             wait NUM seconds to allow attach from a debugger\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"\nOptions for single-user mode:\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  --single           selects single-user mode (must be first argument)\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  DBNAME             database name (defaults to user name)\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -d 0-5             override debugging level\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -E                 echo statement before execution\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -j                 do not use newline as interactive query delimiter\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -r FILENAME        send stdout and stderr to given file\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"\nOptions for bootstrapping mode:\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  --boot             selects bootstrapping mode (must be first argument)\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  DBNAME             database name (mandatory argument in bootstrapping mode)\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -r FILENAME        send stdout and stderr to given file\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"  -x NUM             internal use\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span>_<span class='Parentheses'>(</span><span class='String'>"\nPlease read the documentation for the complete list of run-time\n"</span> 
     <span class='String'>"configuration settings and how to set them on the command line or in\n"</span> 
             <span class='String'>"the configuration file.\n\n"</span> 
             <span class='String'>"Report bugs to &LT;pgsql-bugs@postgresql.org&GT;.\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end help &raquo; </span> 
 
 
 
<span class='Keyword'>static void 
</span><a name="LN385"></a><span class='Declare_Function'>check_root</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>progname</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><span class='Directive'>#ifndef</span> <a href="../../include/c.h.html#LN61"><span class='Ref_to_Const'>WIN32</span></a> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span>geteuid<span class='Parentheses'>() </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../bin/pg_dump/parallel.c.html#LN179"><span class='Ref_to_Macro'>write_stderr</span></a><span class='Parentheses'>(</span><span class='String'>"\"root\" execution of the PostgreSQL server is not permitted.\n"</span> 
                     <span class='String'>"The server must be started under an unprivileged user ID to prevent\n"</span> 
          <span class='String'>"possible system security compromise.  See the documentation for\n"</span> 
                  <span class='String'>"more information on how to properly start the server.\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../test/isolation/specscanner.l.html#LN91"><span class='Ref_to_Proto'>exit</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Also make sure that real and effective uids are the same. Executing as 
     * a setuid program from a root shell is a security hole, since on many 
     * platforms a nefarious subroutine could setuid back to root if real uid 
     * is root.  (Since nobody actually uses postgres as a setuid program, 
     * trying to actively fix this situation seems more trouble than it's 
     * worth; we'll just expend the effort to check for it.) 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>getuid<span class='Parentheses'>() </span><span class='Operator'>!= </span>geteuid<span class='Parentheses'>())</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../bin/pg_dump/parallel.c.html#LN179"><span class='Ref_to_Macro'>write_stderr</span></a><span class='Parentheses'>(</span><span class='String'>"%s: real and effective user IDs must match\n"</span><span class='Delimiter'>, 
</span>                     <a href="main.c.html#LN385"><span class='Ref_to_Parameter'>progname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../test/isolation/specscanner.l.html#LN91"><span class='Ref_to_Proto'>exit</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span><span class='Directive'>#else</span>                           <span class='Comment_Single_Line'>/* WIN32 */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../port/win32security.c.html#LN47"><span class='Ref_to_Func'>pgwin32_is_admin</span></a><span class='Parentheses'>())</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../bin/pg_dump/parallel.c.html#LN179"><span class='Ref_to_Macro'>write_stderr</span></a><span class='Parentheses'>(</span><span class='String'>"Execution of PostgreSQL by a user with administrative permissions is not\n"</span> 
                     <span class='String'>"permitted.\n"</span> 
                     <span class='String'>"The server must be started under an unprivileged user ID to prevent\n"</span> 
         <span class='String'>"possible system security compromises.  See the documentation for\n"</span> 
                  <span class='String'>"more information on how to properly start the server.\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../test/isolation/specscanner.l.html#LN91"><span class='Ref_to_Proto'>exit</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span><span class='Directive'>#endif</span>   <span class='Comment_Single_Line'>/* WIN32 */ 
</span><span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end check_root &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>