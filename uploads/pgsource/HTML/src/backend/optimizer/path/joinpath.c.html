<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\backend\optimizer\path\joinpath.c</title>
<LINK REL=StyleSheet HREF="../../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\backend\optimizer\path\joinpath.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:41 2017
</td></tr>
<tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * joinpath.c 
 *    Routines to find all possible paths for processing a set of joins 
 * 
 * Portions Copyright (c) 1996-2017, PostgreSQL Global Development Group 
 * Portions Copyright (c) 1994, Regents of the University of California 
 * 
 * 
 * IDENTIFICATION 
 *    src/backend/optimizer/path/joinpath.c 
 * 
 *------------------------------------------------------------------------- 
 */ 
</span><span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>&LT;math.h&GT;</span> 
 
<span class='Keyword'>#include </span><span class='String'>"executor/executor.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"foreign/fdwapi.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/cost.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/pathnode.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/paths.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/planmain.h"</span> 
 
<span class='Comment_Multi_Line'>/* Hook for plugins to get control in add_paths_to_joinrel() */ 
</span><a name="LN26"></a><a href="../../../include/optimizer/paths.h.html#LN35"><span class='Ref_to_Typedef'>set_join_pathlist_hook_type</span></a> <span class='Declare_Var'>set_join_pathlist_hook</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
<a name="LN28"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PATH_PARAM_BY_REL</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>path</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>rel</span><span class='Parentheses'>)</span>  <span class='Operator'>\ 
</span>    <span class='Parentheses'>((</span><a href="joinpath.c.html#LN28"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>param_info <span class='Operator'>&& </span><a href="../../../include/nodes/bitmapset.h.html#LN76"><span class='Ref_to_Proto'>bms_overlap</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN972"><span class='Ref_to_Macro'>PATH_REQ_OUTER</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN28"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="joinpath.c.html#LN28"><span class='Ref_to_Parameter'>rel</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>relids<span class='Parentheses'>))</span> 
 
<a name="LN31"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>try_partial_mergejoin_path</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN32"></a>                           <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN33"></a>                           <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outer_path</span><span class='Delimiter'>, 
</span><a name="LN34"></a>                           <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>inner_path</span><span class='Delimiter'>, 
</span><a name="LN35"></a>                           <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pathkeys</span><span class='Delimiter'>, 
</span><a name="LN36"></a>                           <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>mergeclauses</span><span class='Delimiter'>, 
</span><a name="LN37"></a>                           <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outersortkeys</span><span class='Delimiter'>, 
</span><a name="LN38"></a>                           <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>innersortkeys</span><span class='Delimiter'>, 
</span><a name="LN39"></a>                           <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, 
</span><a name="LN40"></a>                           <a href="../../../include/nodes/relation.h.html#LN2177"><span class='Ref_to_Struct'>JoinPathExtraData</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>extra</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN41"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>sort_inner_and_outer</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN42"></a>                     <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outerrel</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>innerrel</span><span class='Delimiter'>, 
</span><a name="LN43"></a>                     <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN2177"><span class='Ref_to_Struct'>JoinPathExtraData</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>extra</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN44"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>match_unsorted_outer</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN45"></a>                     <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outerrel</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>innerrel</span><span class='Delimiter'>, 
</span><a name="LN46"></a>                     <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN2177"><span class='Ref_to_Struct'>JoinPathExtraData</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>extra</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN47"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>consider_parallel_nestloop</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN48"></a>                           <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN49"></a>                           <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outerrel</span><span class='Delimiter'>, 
</span><a name="LN50"></a>                           <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>innerrel</span><span class='Delimiter'>, 
</span><a name="LN51"></a>                           <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, 
</span><a name="LN52"></a>                           <a href="../../../include/nodes/relation.h.html#LN2177"><span class='Ref_to_Struct'>JoinPathExtraData</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>extra</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN53"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>consider_parallel_mergejoin</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN54"></a>                            <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN55"></a>                            <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outerrel</span><span class='Delimiter'>, 
</span><a name="LN56"></a>                            <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>innerrel</span><span class='Delimiter'>, 
</span><a name="LN57"></a>                            <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, 
</span><a name="LN58"></a>                            <a href="../../../include/nodes/relation.h.html#LN2177"><span class='Ref_to_Struct'>JoinPathExtraData</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>extra</span><span class='Delimiter'>, 
</span><a name="LN59"></a>                            <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>inner_cheapest_total</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN60"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>hash_inner_and_outer</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN61"></a>                     <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outerrel</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>innerrel</span><span class='Delimiter'>, 
</span><a name="LN62"></a>                     <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN2177"><span class='Ref_to_Struct'>JoinPathExtraData</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>extra</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN63"></a><span class='Keyword'>static </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>select_mergejoin_clauses</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN64"></a>                         <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN65"></a>                         <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outerrel</span><span class='Delimiter'>, 
</span><a name="LN66"></a>                         <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>innerrel</span><span class='Delimiter'>, 
</span><a name="LN67"></a>                         <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>restrictlist</span><span class='Delimiter'>, 
</span><a name="LN68"></a>                         <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, 
</span><a name="LN69"></a>                         <span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>mergejoin_allowed</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN70"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>generate_mergejoin_paths</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN71"></a>                         <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN72"></a>                         <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>innerrel</span><span class='Delimiter'>, 
</span><a name="LN73"></a>                         <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outerpath</span><span class='Delimiter'>, 
</span><a name="LN74"></a>                         <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, 
</span><a name="LN75"></a>                         <a href="../../../include/nodes/relation.h.html#LN2177"><span class='Ref_to_Struct'>JoinPathExtraData</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>extra</span><span class='Delimiter'>, 
</span><a name="LN76"></a>                         <span class='Keyword'>bool </span><span class='Declare_Parameter'>useallclauses</span><span class='Delimiter'>, 
</span><a name="LN77"></a>                         <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>inner_cheapest_total</span><span class='Delimiter'>, 
</span><a name="LN78"></a>                         <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>merge_pathkeys</span><span class='Delimiter'>, 
</span><a name="LN79"></a>                         <span class='Keyword'>bool </span><span class='Declare_Parameter'>is_partial</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * add_paths_to_joinrel 
 *    Given a join relation and two component rels from which it can be made, 
 *    consider all possible paths that use the two component rels as outer 
 *    and inner rel respectively.  Add these paths to the join rel's pathlist 
 *    if they survive comparison with other paths (and remove any existing 
 *    paths that are dominated by these paths). 
 * 
 * Modifies the pathlist field of the joinrel node to contain the best 
 * paths found so far. 
 * 
 * jointype is not necessarily the same as sjinfo-&GT;jointype; it might be 
 * "flipped around" if we are considering joining the rels in the opposite 
 * direction from what's indicated in sjinfo. 
 * 
 * Also, this routine and others in this module accept the special JoinTypes 
 * JOIN_UNIQUE_OUTER and JOIN_UNIQUE_INNER to indicate that we should 
 * unique-ify the outer or inner relation and then apply a regular inner 
 * join.  These values are not allowed to propagate outside this module, 
 * however.  Path cost estimation code may need to recognize that it's 
 * dealing with such a case --- the combination of nominal jointype INNER 
 * with sjinfo-&GT;jointype == JOIN_SEMI indicates that. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN106"></a><span class='Declare_Function'>add_paths_to_joinrel</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN107"></a>                     <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN108"></a>                     <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outerrel</span><span class='Delimiter'>, 
</span><a name="LN109"></a>                     <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>innerrel</span><span class='Delimiter'>, 
</span><a name="LN110"></a>                     <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, 
</span><a name="LN111"></a>                     <a href="../../../include/nodes/relation.h.html#LN1913"><span class='Ref_to_Struct'>SpecialJoinInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>sjinfo</span><span class='Delimiter'>, 
</span><a name="LN112"></a>                     <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>restrictlist</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN114"></a>    <a href="../../../include/nodes/relation.h.html#LN2177"><span class='Ref_to_Struct'>JoinPathExtraData</span></a> <span class='Declare_Local'>extra</span><span class='Delimiter'>; 
</span><a name="LN115"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>mergejoin_allowed</span> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span><a name="LN116"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
    <a href="joinpath.c.html#LN114"><span class='Ref_To_Local'>extra</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2179"><span class='Ref_to_Member'>restrictlist</span></a> <span class='Operator'>= </span><a href="joinpath.c.html#LN112"><span class='Ref_to_Parameter'>restrictlist</span></a><span class='Delimiter'>; 
</span>    <a href="joinpath.c.html#LN114"><span class='Ref_To_Local'>extra</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2180"><span class='Ref_to_Member'>mergeclause_list</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="joinpath.c.html#LN114"><span class='Ref_To_Local'>extra</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2182"><span class='Ref_to_Member'>sjinfo</span></a> <span class='Operator'>= </span><a href="joinpath.c.html#LN111"><span class='Ref_to_Parameter'>sjinfo</span></a><span class='Delimiter'>; 
</span>    <a href="joinpath.c.html#LN114"><span class='Ref_To_Local'>extra</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2184"><span class='Ref_to_Member'>param_source_rels</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * See if the inner relation is provably unique for this outer rel. 
     * 
     * We have some special cases: for JOIN_SEMI and JOIN_ANTI, it doesn't 
     * matter since the executor can make the equivalent optimization anyway; 
     * we need not expend planner cycles on proofs.  For JOIN_UNIQUE_INNER, we 
     * must be considering a semijoin whose inner side is not provably unique 
     * (else reduce_unique_semijoins would've simplified it), so there's no 
     * point in calling innerrel_is_unique.  However, if the LHS covers all of 
     * the semijoin's min_lefthand, then it's appropriate to set inner_unique 
     * because the path produced by create_unique_path will be unique relative 
     * to the LHS.  (If we have an LHS that's only part of the min_lefthand, 
     * that is *not* true.)  For JOIN_UNIQUE_OUTER, pass JOIN_INNER to avoid 
     * letting that value escape this module. 
     */ 
</span>    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN110"><span class='Ref_to_Parameter'>jointype</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN691"><span class='Ref_to_EnumConst'>JOIN_SEMI</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN692"><span class='Ref_to_EnumConst'>JOIN_ANTI</span></a><span class='Operator'>: 
</span>            <a href="joinpath.c.html#LN114"><span class='Ref_To_Local'>extra</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2181"><span class='Ref_to_Member'>inner_unique</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; </span><span class='Comment_Single_Line'>/* well, unproven */ 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN699"><span class='Ref_to_EnumConst'>JOIN_UNIQUE_INNER</span></a><span class='Operator'>: 
</span>            <a href="joinpath.c.html#LN114"><span class='Ref_To_Local'>extra</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2181"><span class='Ref_to_Member'>inner_unique</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/bitmapset.h.html#LN73"><span class='Ref_to_Proto'>bms_is_subset</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN111"><span class='Ref_to_Parameter'>sjinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1916"><span class='Ref_to_Member'>min_lefthand</span></a><span class='Delimiter'>, 
</span>                                               <a href="joinpath.c.html#LN108"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN698"><span class='Ref_to_EnumConst'>JOIN_UNIQUE_OUTER</span></a><span class='Operator'>: 
</span>            <a href="joinpath.c.html#LN114"><span class='Ref_To_Local'>extra</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2181"><span class='Ref_to_Member'>inner_unique</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/planmain.h.html#LN108"><span class='Ref_to_Proto'>innerrel_is_unique</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN106"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                    <a href="joinpath.c.html#LN108"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, 
</span>                                                    <a href="joinpath.c.html#LN109"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Delimiter'>, 
</span>                                                    <a href="../../../include/nodes/nodes.h.html#LN677"><span class='Ref_to_EnumConst'>JOIN_INNER</span></a><span class='Delimiter'>, 
</span>                                                    <a href="joinpath.c.html#LN112"><span class='Ref_to_Parameter'>restrictlist</span></a><span class='Delimiter'>, 
</span>                                                    <span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="joinpath.c.html#LN114"><span class='Ref_To_Local'>extra</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2181"><span class='Ref_to_Member'>inner_unique</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/planmain.h.html#LN108"><span class='Ref_to_Proto'>innerrel_is_unique</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN106"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                    <a href="joinpath.c.html#LN108"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, 
</span>                                                    <a href="joinpath.c.html#LN109"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Delimiter'>, 
</span>                                                    <a href="joinpath.c.html#LN110"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                                                    <a href="joinpath.c.html#LN112"><span class='Ref_to_Parameter'>restrictlist</span></a><span class='Delimiter'>, 
</span>                                                    <span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch jointype &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* 
     * Find potential mergejoin clauses.  We can skip this if we are not 
     * interested in doing a mergejoin.  However, mergejoin may be our only 
     * way of implementing a full outer join, so override enable_mergejoin if 
     * it's a full join. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="costsize.c.html#LN126"><span class='Ref_to_Global_Var'>enable_mergejoin</span></a> <span class='Operator'>|| </span><a href="joinpath.c.html#LN110"><span class='Ref_to_Parameter'>jointype</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/nodes.h.html#LN679"><span class='Ref_to_EnumConst'>JOIN_FULL</span></a><span class='Parentheses'>) 
</span>        <a href="joinpath.c.html#LN114"><span class='Ref_To_Local'>extra</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2180"><span class='Ref_to_Member'>mergeclause_list</span></a> <span class='Operator'>= </span><a href="joinpath.c.html#LN63"><span class='Ref_to_Proto'>select_mergejoin_clauses</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN106"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                          <a href="joinpath.c.html#LN107"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                                                          <a href="joinpath.c.html#LN108"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Delimiter'>, 
</span>                                                          <a href="joinpath.c.html#LN109"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Delimiter'>, 
</span>                                                          <a href="joinpath.c.html#LN112"><span class='Ref_to_Parameter'>restrictlist</span></a><span class='Delimiter'>, 
</span>                                                          <a href="joinpath.c.html#LN110"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                                                          <span class='Operator'>&</span><a href="joinpath.c.html#LN115"><span class='Ref_To_Local'>mergejoin_allowed</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If it's SEMI, ANTI, or inner_unique join, compute correction factors 
     * for cost estimation.  These will be the same for all paths. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN110"><span class='Ref_to_Parameter'>jointype</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/nodes.h.html#LN691"><span class='Ref_to_EnumConst'>JOIN_SEMI</span></a> <span class='Operator'>|| </span><a href="joinpath.c.html#LN110"><span class='Ref_to_Parameter'>jointype</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/nodes.h.html#LN692"><span class='Ref_to_EnumConst'>JOIN_ANTI</span></a> <span class='Operator'>|| </span><a href="joinpath.c.html#LN114"><span class='Ref_To_Local'>extra</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2181"><span class='Ref_to_Member'>inner_unique</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/optimizer/cost.h.html#LN159"><span class='Ref_to_Proto'>compute_semi_anti_join_factors</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN106"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN108"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN109"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Delimiter'>, 
</span>                                       <a href="joinpath.c.html#LN110"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN111"><span class='Ref_to_Parameter'>sjinfo</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN112"><span class='Ref_to_Parameter'>restrictlist</span></a><span class='Delimiter'>, 
</span>                                       <span class='Operator'>&</span><a href="joinpath.c.html#LN114"><span class='Ref_To_Local'>extra</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2183"><span class='Ref_to_Member'>semifactors</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Decide whether it's sensible to generate parameterized paths for this 
     * joinrel, and if so, which relations such paths should require.  There 
     * is usually no need to create a parameterized result path unless there 
     * is a join order restriction that prevents joining one of our input rels 
     * directly to the parameter source rel instead of joining to the other 
     * input rel.  (But see allow_star_schema_join().)  This restriction 
     * reduces the number of parameterized paths we have to deal with at 
     * higher join levels, without compromising the quality of the resulting 
     * plan.  We express the restriction as a Relids set that must overlap the 
     * parameterization of any proposed join path. 
     */ 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN116"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN106"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN249"><span class='Ref_to_Member'>join_info_list</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN204"></a>        <a href="../../../include/nodes/relation.h.html#LN1913"><span class='Ref_to_Struct'>SpecialJoinInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>sjinfo2</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1913"><span class='Ref_to_Struct'>SpecialJoinInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN116"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * SJ is relevant to this join if we have some part of its RHS 
         * (possibly not all of it), and haven't yet joined to its LHS.  (This 
         * test is pretty simplistic, but should be sufficient considering the 
         * join has already been proven legal.)  If the SJ is relevant, it 
         * presents constraints for joining to anything not in its RHS. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/bitmapset.h.html#LN76"><span class='Ref_to_Proto'>bms_overlap</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN107"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN204"><span class='Ref_To_Local'>sjinfo2</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1917"><span class='Ref_to_Member'>min_righthand</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>            <span class='Operator'>!</span><a href="../../../include/nodes/bitmapset.h.html#LN76"><span class='Ref_to_Proto'>bms_overlap</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN107"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN204"><span class='Ref_To_Local'>sjinfo2</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1916"><span class='Ref_to_Member'>min_lefthand</span></a><span class='Parentheses'>))</span> 
            <a href="joinpath.c.html#LN114"><span class='Ref_To_Local'>extra</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2184"><span class='Ref_to_Member'>param_source_rels</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/bitmapset.h.html#LN94"><span class='Ref_to_Proto'>bms_join</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN114"><span class='Ref_To_Local'>extra</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2184"><span class='Ref_to_Member'>param_source_rels</span></a><span class='Delimiter'>, 
</span>                                           <a href="../../../include/nodes/bitmapset.h.html#LN72"><span class='Ref_to_Proto'>bms_difference</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN106"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN195"><span class='Ref_to_Member'>all_baserels</span></a><span class='Delimiter'>, 
</span>                                                    <a href="joinpath.c.html#LN204"><span class='Ref_To_Local'>sjinfo2</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1917"><span class='Ref_to_Member'>min_righthand</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* full joins constrain both sides symmetrically */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN204"><span class='Ref_To_Local'>sjinfo2</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1920"><span class='Ref_to_Member'>jointype</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/nodes.h.html#LN679"><span class='Ref_to_EnumConst'>JOIN_FULL</span></a> <span class='Operator'>&& 
</span>            <a href="../../../include/nodes/bitmapset.h.html#LN76"><span class='Ref_to_Proto'>bms_overlap</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN107"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN204"><span class='Ref_To_Local'>sjinfo2</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1916"><span class='Ref_to_Member'>min_lefthand</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>            <span class='Operator'>!</span><a href="../../../include/nodes/bitmapset.h.html#LN76"><span class='Ref_to_Proto'>bms_overlap</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN107"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN204"><span class='Ref_To_Local'>sjinfo2</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1917"><span class='Ref_to_Member'>min_righthand</span></a><span class='Parentheses'>))</span> 
            <a href="joinpath.c.html#LN114"><span class='Ref_To_Local'>extra</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2184"><span class='Ref_to_Member'>param_source_rels</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/bitmapset.h.html#LN94"><span class='Ref_to_Proto'>bms_join</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN114"><span class='Ref_To_Local'>extra</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2184"><span class='Ref_to_Member'>param_source_rels</span></a><span class='Delimiter'>, 
</span>                                           <a href="../../../include/nodes/bitmapset.h.html#LN72"><span class='Ref_to_Proto'>bms_difference</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN106"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN195"><span class='Ref_to_Member'>all_baserels</span></a><span class='Delimiter'>, 
</span>                                                     <a href="joinpath.c.html#LN204"><span class='Ref_To_Local'>sjinfo2</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1916"><span class='Ref_to_Member'>min_lefthand</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * However, when a LATERAL subquery is involved, there will simply not be 
     * any paths for the joinrel that aren't parameterized by whatever the 
     * subquery is parameterized by, unless its parameterization is resolved 
     * within the joinrel.  So we might as well allow additional dependencies 
     * on whatever residual lateral dependencies the joinrel will have. 
     */ 
</span>    <a href="joinpath.c.html#LN114"><span class='Ref_To_Local'>extra</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2184"><span class='Ref_to_Member'>param_source_rels</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/bitmapset.h.html#LN91"><span class='Ref_to_Proto'>bms_add_members</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN114"><span class='Ref_To_Local'>extra</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2184"><span class='Ref_to_Member'>param_source_rels</span></a><span class='Delimiter'>, 
</span>                                              <a href="joinpath.c.html#LN107"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN549"><span class='Ref_to_Member'>lateral_relids</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * 1. Consider mergejoin paths where both relations must be explicitly 
     * sorted.  Skip this if we can't mergejoin. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN115"><span class='Ref_To_Local'>mergejoin_allowed</span></a><span class='Parentheses'>) 
</span>        <a href="joinpath.c.html#LN41"><span class='Ref_to_Proto'>sort_inner_and_outer</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN106"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN107"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN108"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN109"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Delimiter'>, 
</span>                             <a href="joinpath.c.html#LN110"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="joinpath.c.html#LN114"><span class='Ref_To_Local'>extra</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * 2. Consider paths where the outer relation need not be explicitly 
     * sorted. This includes both nestloops and mergejoins where the outer 
     * path is already ordered.  Again, skip this if we can't mergejoin. 
     * (That's okay because we know that nestloop can't handle right/full 
     * joins at all, so it wouldn't work in the prohibited cases either.) 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN115"><span class='Ref_To_Local'>mergejoin_allowed</span></a><span class='Parentheses'>) 
</span>        <a href="joinpath.c.html#LN44"><span class='Ref_to_Proto'>match_unsorted_outer</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN106"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN107"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN108"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN109"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Delimiter'>, 
</span>                             <a href="joinpath.c.html#LN110"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="joinpath.c.html#LN114"><span class='Ref_To_Local'>extra</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Directive'>#ifdef</span> NOT_USED 
 
    <span class='Comment_Multi_Line'>/* 
     * 3. Consider paths where the inner relation need not be explicitly 
     * sorted.  This includes mergejoins only (nestloops were already built in 
     * match_unsorted_outer). 
     * 
     * Diked out as redundant 2/13/2000 -- tgl.  There isn't any really 
     * significant difference between the inner and outer side of a mergejoin, 
     * so match_unsorted_inner creates no paths that aren't equivalent to 
     * those made by match_unsorted_outer when add_paths_to_joinrel() is 
     * invoked with the two rels given in the other order. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN115"><span class='Ref_To_Local'>mergejoin_allowed</span></a><span class='Parentheses'>) 
</span>        match_unsorted_inner<span class='Parentheses'>(</span><a href="joinpath.c.html#LN106"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN107"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN108"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN109"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Delimiter'>, 
</span>                             <a href="joinpath.c.html#LN110"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="joinpath.c.html#LN114"><span class='Ref_To_Local'>extra</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
 
    <span class='Comment_Multi_Line'>/* 
     * 4. Consider paths where both outer and inner relations must be hashed 
     * before being joined.  As above, disregard enable_hashjoin for full 
     * joins, because there may be no other alternative. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="costsize.c.html#LN127"><span class='Ref_to_Global_Var'>enable_hashjoin</span></a> <span class='Operator'>|| </span><a href="joinpath.c.html#LN110"><span class='Ref_to_Parameter'>jointype</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/nodes.h.html#LN679"><span class='Ref_to_EnumConst'>JOIN_FULL</span></a><span class='Parentheses'>) 
</span>        <a href="joinpath.c.html#LN60"><span class='Ref_to_Proto'>hash_inner_and_outer</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN106"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN107"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN108"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN109"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Delimiter'>, 
</span>                             <a href="joinpath.c.html#LN110"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="joinpath.c.html#LN114"><span class='Ref_To_Local'>extra</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * 5. If inner and outer relations are foreign tables (or joins) belonging 
     * to the same server and assigned to the same user to check access 
     * permissions as, give the FDW a chance to push down joins. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN107"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN575"><span class='Ref_to_Member'>fdwroutine</span></a> <span class='Operator'>&& 
</span>        <a href="joinpath.c.html#LN107"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN575"><span class='Ref_to_Member'>fdwroutine</span></a><span class='Operator'>-&GT;</span><a href="../../../include/foreign/fdwapi.h.html#LN187"><span class='Ref_to_Member'>GetForeignJoinPaths</span></a><span class='Parentheses'>) 
</span>        <a href="joinpath.c.html#LN107"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN575"><span class='Ref_to_Member'>fdwroutine</span></a><span class='Operator'>-&GT;</span><a href="../../../include/foreign/fdwapi.h.html#LN187"><span class='Ref_to_Member'>GetForeignJoinPaths</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN106"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN107"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                                                 <a href="joinpath.c.html#LN108"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN109"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Delimiter'>, 
</span>                                                 <a href="joinpath.c.html#LN110"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="joinpath.c.html#LN114"><span class='Ref_To_Local'>extra</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * 6. Finally, give extensions a chance to manipulate the path list. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN26"><span class='Ref_to_Global_Var'>set_join_pathlist_hook</span></a><span class='Parentheses'>) 
</span>        <a href="joinpath.c.html#LN26"><span class='Ref_to_Global_Var'>set_join_pathlist_hook</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN106"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN107"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN108"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN109"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Delimiter'>, 
</span>                               <a href="joinpath.c.html#LN110"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="joinpath.c.html#LN114"><span class='Ref_To_Local'>extra</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end add_paths_to_joinrel &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * We override the param_source_rels heuristic to accept nestloop paths in 
 * which the outer rel satisfies some but not all of the inner path's 
 * parameterization.  This is necessary to get good plans for star-schema 
 * scenarios, in which a parameterized path for a large table may require 
 * parameters from multiple small tables that will not get joined directly to 
 * each other.  We can handle that by stacking nestloops that have the small 
 * tables on the outside; but this breaks the rule the param_source_rels 
 * heuristic is based on, namely that parameters should not be passed down 
 * across joins unless there's a join-order-constraint-based reason to do so. 
 * So we ignore the param_source_rels restriction when this case applies. 
 * 
 * allow_star_schema_join() returns TRUE if the param_source_rels restriction 
 * should be overridden, ie, it's okay to perform this join. 
 */ 
</span><span class='Keyword'>static inline bool 
</span><a name="LN319"></a><span class='Declare_Function'>allow_star_schema_join</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN320"></a>                       <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outer_path</span><span class='Delimiter'>, 
</span><a name="LN321"></a>                       <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>inner_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN323"></a>    <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a>      <span class='Declare_Local'>innerparams</span> <span class='Operator'>= </span><a href="../../../include/nodes/relation.h.html#LN972"><span class='Ref_to_Macro'>PATH_REQ_OUTER</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN321"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN324"></a>    <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a>      <span class='Declare_Local'>outerrelids</span> <span class='Operator'>= </span><a href="joinpath.c.html#LN320"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * It's a star-schema case if the outer rel provides some but not all of 
     * the inner rel's parameterization. 
     */ 
</span>    <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/bitmapset.h.html#LN76"><span class='Ref_to_Proto'>bms_overlap</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN323"><span class='Ref_To_Local'>innerparams</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN324"><span class='Ref_To_Local'>outerrelids</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>            <a href="../../../include/nodes/bitmapset.h.html#LN78"><span class='Ref_to_Proto'>bms_nonempty_difference</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN323"><span class='Ref_To_Local'>innerparams</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN324"><span class='Ref_To_Local'>outerrelids</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * try_nestloop_path 
 *    Consider a nestloop join path; if it appears useful, push it into 
 *    the joinrel's pathlist via add_path(). 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN340"></a><span class='Declare_Function'>try_nestloop_path</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN341"></a>                  <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN342"></a>                  <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outer_path</span><span class='Delimiter'>, 
</span><a name="LN343"></a>                  <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>inner_path</span><span class='Delimiter'>, 
</span><a name="LN344"></a>                  <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pathkeys</span><span class='Delimiter'>, 
</span><a name="LN345"></a>                  <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, 
</span><a name="LN346"></a>                  <a href="../../../include/nodes/relation.h.html#LN2177"><span class='Ref_to_Struct'>JoinPathExtraData</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>extra</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN348"></a>    <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a>      <span class='Declare_Local'>required_outer</span><span class='Delimiter'>; 
</span><a name="LN349"></a>    <a href="../../../include/nodes/relation.h.html#LN2199"><span class='Ref_to_Struct'>JoinCostWorkspace</span></a> <span class='Declare_Local'>workspace</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Check to see if proposed path is still parameterized, and reject if the 
     * parameterization wouldn't be sensible --- unless allow_star_schema_join 
     * says to allow it anyway.  Also, we must reject if have_dangerous_phv 
     * doesn't like the look of it, which could only happen if the nestloop is 
     * still parameterized. 
     */ 
</span>    <a href="joinpath.c.html#LN348"><span class='Ref_To_Local'>required_outer</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/pathnode.h.html#LN114"><span class='Ref_to_Proto'>calc_nestloop_required_outer</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN342"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Delimiter'>, 
</span>                                                  <a href="joinpath.c.html#LN343"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN348"><span class='Ref_To_Local'>required_outer</span></a> <span class='Operator'>&& 
</span>        <span class='Parentheses'>((</span><span class='Operator'>!</span><a href="../../../include/nodes/bitmapset.h.html#LN76"><span class='Ref_to_Proto'>bms_overlap</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN348"><span class='Ref_To_Local'>required_outer</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN346"><span class='Ref_to_Parameter'>extra</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2184"><span class='Ref_to_Member'>param_source_rels</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>          <span class='Operator'>!</span><a href="joinpath.c.html#LN318"><span class='Ref_to_Func'>allow_star_schema_join</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN340"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN342"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN343"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Parentheses'>))</span> <span class='Operator'>|| 
</span>         <a href="../../../include/optimizer/paths.h.html#LN111"><span class='Ref_to_Proto'>have_dangerous_phv</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN340"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                            <a href="joinpath.c.html#LN342"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, 
</span>                            <a href="../../../include/nodes/relation.h.html#LN972"><span class='Ref_to_Macro'>PATH_REQ_OUTER</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN343"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Parentheses'>))))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Waste no memory when we reject a path here */ 
</span>        <a href="../../../include/nodes/bitmapset.h.html#LN68"><span class='Ref_to_Proto'>bms_free</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN348"><span class='Ref_To_Local'>required_outer</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Do a precheck to quickly eliminate obviously-inferior paths.  We 
     * calculate a cheap lower bound on the path's cost and then use 
     * add_path_precheck() to see if the path is clearly going to be dominated 
     * by some existing path for the joinrel.  If not, do the full pushup with 
     * creating a fully valid path structure and submitting it to add_path(). 
     * The latter two steps are expensive enough to make this two-phase 
     * methodology worthwhile. 
     */ 
</span>    <a href="../../../include/optimizer/cost.h.html#LN127"><span class='Ref_to_Proto'>initial_cost_nestloop</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN340"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="joinpath.c.html#LN349"><span class='Ref_To_Local'>workspace</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN345"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                          <a href="joinpath.c.html#LN342"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN343"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN346"><span class='Ref_to_Parameter'>extra</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/optimizer/pathnode.h.html#LN28"><span class='Ref_to_Proto'>add_path_precheck</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN341"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                          <a href="joinpath.c.html#LN349"><span class='Ref_To_Local'>workspace</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2202"><span class='Ref_to_Member'>startup_cost</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN349"><span class='Ref_To_Local'>workspace</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2203"><span class='Ref_to_Member'>total_cost</span></a><span class='Delimiter'>, 
</span>                          <a href="joinpath.c.html#LN344"><span class='Ref_to_Parameter'>pathkeys</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN348"><span class='Ref_To_Local'>required_outer</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../../include/optimizer/pathnode.h.html#LN27"><span class='Ref_to_Proto'>add_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN341"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>                 <a href="../../../include/optimizer/pathnode.h.html#LN117"><span class='Ref_to_Proto'>create_nestloop_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN340"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                      <a href="joinpath.c.html#LN341"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                                      <a href="joinpath.c.html#LN345"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                                      <span class='Operator'>&</span><a href="joinpath.c.html#LN349"><span class='Ref_To_Local'>workspace</span></a><span class='Delimiter'>, 
</span>                                      <a href="joinpath.c.html#LN346"><span class='Ref_to_Parameter'>extra</span></a><span class='Delimiter'>, 
</span>                                      <a href="joinpath.c.html#LN342"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Delimiter'>, 
</span>                                      <a href="joinpath.c.html#LN343"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Delimiter'>, 
</span>                                      <a href="joinpath.c.html#LN346"><span class='Ref_to_Parameter'>extra</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2179"><span class='Ref_to_Member'>restrictlist</span></a><span class='Delimiter'>, 
</span>                                      <a href="joinpath.c.html#LN344"><span class='Ref_to_Parameter'>pathkeys</span></a><span class='Delimiter'>, 
</span>                                      <a href="joinpath.c.html#LN348"><span class='Ref_To_Local'>required_outer</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Waste no memory when we reject a path here */ 
</span>        <a href="../../../include/nodes/bitmapset.h.html#LN68"><span class='Ref_to_Proto'>bms_free</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN348"><span class='Ref_To_Local'>required_outer</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end try_nestloop_path &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * try_partial_nestloop_path 
 *    Consider a partial nestloop join path; if it appears useful, push it into 
 *    the joinrel's partial_pathlist via add_partial_path(). 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN413"></a><span class='Declare_Function'>try_partial_nestloop_path</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN414"></a>                          <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN415"></a>                          <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outer_path</span><span class='Delimiter'>, 
</span><a name="LN416"></a>                          <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>inner_path</span><span class='Delimiter'>, 
</span><a name="LN417"></a>                          <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pathkeys</span><span class='Delimiter'>, 
</span><a name="LN418"></a>                          <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, 
</span><a name="LN419"></a>                          <a href="../../../include/nodes/relation.h.html#LN2177"><span class='Ref_to_Struct'>JoinPathExtraData</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>extra</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN421"></a>    <a href="../../../include/nodes/relation.h.html#LN2199"><span class='Ref_to_Struct'>JoinCostWorkspace</span></a> <span class='Declare_Local'>workspace</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If the inner path is parameterized, the parameterization must be fully 
     * satisfied by the proposed outer path.  Parameterized partial paths are 
     * not supported.  The caller should already have verified that no 
     * extra_lateral_rels are required here. 
     */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/nodes/bitmapset.h.html#LN85"><span class='Ref_to_Proto'>bms_is_empty</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN414"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN549"><span class='Ref_to_Member'>lateral_relids</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN416"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN432"></a>        <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a>      <span class='Declare_Local'>inner_paramrels</span> <span class='Operator'>= </span><a href="joinpath.c.html#LN416"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN911"><span class='Ref_to_Member'>ppi_req_outer</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/nodes/bitmapset.h.html#LN73"><span class='Ref_to_Proto'>bms_is_subset</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN432"><span class='Ref_To_Local'>inner_paramrels</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN415"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Before creating a path, get a quick lower bound on what it is likely to 
     * cost.  Bail out right away if it looks terrible. 
     */ 
</span>    <a href="../../../include/optimizer/cost.h.html#LN127"><span class='Ref_to_Proto'>initial_cost_nestloop</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN413"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="joinpath.c.html#LN421"><span class='Ref_To_Local'>workspace</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN418"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                          <a href="joinpath.c.html#LN415"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN416"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN419"><span class='Ref_to_Parameter'>extra</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/optimizer/pathnode.h.html#LN32"><span class='Ref_to_Proto'>add_partial_path_precheck</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN414"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN421"><span class='Ref_To_Local'>workspace</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2203"><span class='Ref_to_Member'>total_cost</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN417"><span class='Ref_to_Parameter'>pathkeys</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Might be good enough to be worth trying, so let's try it. */ 
</span>    <a href="../../../include/optimizer/pathnode.h.html#LN31"><span class='Ref_to_Proto'>add_partial_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN414"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>                     <a href="../../../include/optimizer/pathnode.h.html#LN117"><span class='Ref_to_Proto'>create_nestloop_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN413"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                          <a href="joinpath.c.html#LN414"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                                          <a href="joinpath.c.html#LN418"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                                          <span class='Operator'>&</span><a href="joinpath.c.html#LN421"><span class='Ref_To_Local'>workspace</span></a><span class='Delimiter'>, 
</span>                                          <a href="joinpath.c.html#LN419"><span class='Ref_to_Parameter'>extra</span></a><span class='Delimiter'>, 
</span>                                          <a href="joinpath.c.html#LN415"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Delimiter'>, 
</span>                                          <a href="joinpath.c.html#LN416"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Delimiter'>, 
</span>                                          <a href="joinpath.c.html#LN419"><span class='Ref_to_Parameter'>extra</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2179"><span class='Ref_to_Member'>restrictlist</span></a><span class='Delimiter'>, 
</span>                                          <a href="joinpath.c.html#LN417"><span class='Ref_to_Parameter'>pathkeys</span></a><span class='Delimiter'>, 
</span>                                          <span class='Null_Value'>NULL</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end try_partial_nestloop_path &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * try_mergejoin_path 
 *    Consider a merge join path; if it appears useful, push it into 
 *    the joinrel's pathlist via add_path(). 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN467"></a><span class='Declare_Function'>try_mergejoin_path</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN468"></a>                   <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN469"></a>                   <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outer_path</span><span class='Delimiter'>, 
</span><a name="LN470"></a>                   <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>inner_path</span><span class='Delimiter'>, 
</span><a name="LN471"></a>                   <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pathkeys</span><span class='Delimiter'>, 
</span><a name="LN472"></a>                   <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>mergeclauses</span><span class='Delimiter'>, 
</span><a name="LN473"></a>                   <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outersortkeys</span><span class='Delimiter'>, 
</span><a name="LN474"></a>                   <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>innersortkeys</span><span class='Delimiter'>, 
</span><a name="LN475"></a>                   <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, 
</span><a name="LN476"></a>                   <a href="../../../include/nodes/relation.h.html#LN2177"><span class='Ref_to_Struct'>JoinPathExtraData</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>extra</span><span class='Delimiter'>, 
</span><a name="LN477"></a>                   <span class='Keyword'>bool </span><span class='Declare_Parameter'>is_partial</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN479"></a>    <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a>      <span class='Declare_Local'>required_outer</span><span class='Delimiter'>; 
</span><a name="LN480"></a>    <a href="../../../include/nodes/relation.h.html#LN2199"><span class='Ref_to_Struct'>JoinCostWorkspace</span></a> <span class='Declare_Local'>workspace</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN477"><span class='Ref_to_Parameter'>is_partial</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="joinpath.c.html#LN31"><span class='Ref_to_Proto'>try_partial_mergejoin_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN467"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                   <a href="joinpath.c.html#LN468"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                                   <a href="joinpath.c.html#LN469"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Delimiter'>, 
</span>                                   <a href="joinpath.c.html#LN470"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Delimiter'>, 
</span>                                   <a href="joinpath.c.html#LN471"><span class='Ref_to_Parameter'>pathkeys</span></a><span class='Delimiter'>, 
</span>                                   <a href="joinpath.c.html#LN472"><span class='Ref_to_Parameter'>mergeclauses</span></a><span class='Delimiter'>, 
</span>                                   <a href="joinpath.c.html#LN473"><span class='Ref_to_Parameter'>outersortkeys</span></a><span class='Delimiter'>, 
</span>                                   <a href="joinpath.c.html#LN474"><span class='Ref_to_Parameter'>innersortkeys</span></a><span class='Delimiter'>, 
</span>                                   <a href="joinpath.c.html#LN475"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                                   <a href="joinpath.c.html#LN476"><span class='Ref_to_Parameter'>extra</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Check to see if proposed path is still parameterized, and reject if the 
     * parameterization wouldn't be sensible. 
     */ 
</span>    <a href="joinpath.c.html#LN479"><span class='Ref_To_Local'>required_outer</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/pathnode.h.html#LN115"><span class='Ref_to_Proto'>calc_non_nestloop_required_outer</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN469"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Delimiter'>, 
</span>                                                      <a href="joinpath.c.html#LN470"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN479"><span class='Ref_To_Local'>required_outer</span></a> <span class='Operator'>&& 
</span>        <span class='Operator'>!</span><a href="../../../include/nodes/bitmapset.h.html#LN76"><span class='Ref_to_Proto'>bms_overlap</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN479"><span class='Ref_To_Local'>required_outer</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN476"><span class='Ref_to_Parameter'>extra</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2184"><span class='Ref_to_Member'>param_source_rels</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Waste no memory when we reject a path here */ 
</span>        <a href="../../../include/nodes/bitmapset.h.html#LN68"><span class='Ref_to_Proto'>bms_free</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN479"><span class='Ref_To_Local'>required_outer</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If the given paths are already well enough ordered, we can skip doing 
     * an explicit sort. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN473"><span class='Ref_to_Parameter'>outersortkeys</span></a> <span class='Operator'>&& 
</span>        <a href="../../../include/optimizer/paths.h.html#LN183"><span class='Ref_to_Proto'>pathkeys_contained_in</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN473"><span class='Ref_to_Parameter'>outersortkeys</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN469"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN967"><span class='Ref_to_Member'>pathkeys</span></a><span class='Parentheses'>))</span> 
        <a href="joinpath.c.html#LN473"><span class='Ref_to_Parameter'>outersortkeys</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN474"><span class='Ref_to_Parameter'>innersortkeys</span></a> <span class='Operator'>&& 
</span>        <a href="../../../include/optimizer/paths.h.html#LN183"><span class='Ref_to_Proto'>pathkeys_contained_in</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN474"><span class='Ref_to_Parameter'>innersortkeys</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN470"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN967"><span class='Ref_to_Member'>pathkeys</span></a><span class='Parentheses'>))</span> 
        <a href="joinpath.c.html#LN474"><span class='Ref_to_Parameter'>innersortkeys</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * See comments in try_nestloop_path(). 
     */ 
</span>    <a href="../../../include/optimizer/cost.h.html#LN135"><span class='Ref_to_Proto'>initial_cost_mergejoin</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN467"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="joinpath.c.html#LN480"><span class='Ref_To_Local'>workspace</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN475"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN472"><span class='Ref_to_Parameter'>mergeclauses</span></a><span class='Delimiter'>, 
</span>                           <a href="joinpath.c.html#LN469"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN470"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Delimiter'>, 
</span>                           <a href="joinpath.c.html#LN473"><span class='Ref_to_Parameter'>outersortkeys</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN474"><span class='Ref_to_Parameter'>innersortkeys</span></a><span class='Delimiter'>, 
</span>                           <a href="joinpath.c.html#LN476"><span class='Ref_to_Parameter'>extra</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/optimizer/pathnode.h.html#LN28"><span class='Ref_to_Proto'>add_path_precheck</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN468"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                          <a href="joinpath.c.html#LN480"><span class='Ref_To_Local'>workspace</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2202"><span class='Ref_to_Member'>startup_cost</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN480"><span class='Ref_To_Local'>workspace</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2203"><span class='Ref_to_Member'>total_cost</span></a><span class='Delimiter'>, 
</span>                          <a href="joinpath.c.html#LN471"><span class='Ref_to_Parameter'>pathkeys</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN479"><span class='Ref_To_Local'>required_outer</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../../include/optimizer/pathnode.h.html#LN27"><span class='Ref_to_Proto'>add_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN468"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>                 <a href="../../../include/optimizer/pathnode.h.html#LN128"><span class='Ref_to_Proto'>create_mergejoin_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN467"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                       <a href="joinpath.c.html#LN468"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                                       <a href="joinpath.c.html#LN475"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                                       <span class='Operator'>&</span><a href="joinpath.c.html#LN480"><span class='Ref_To_Local'>workspace</span></a><span class='Delimiter'>, 
</span>                                       <a href="joinpath.c.html#LN476"><span class='Ref_to_Parameter'>extra</span></a><span class='Delimiter'>, 
</span>                                       <a href="joinpath.c.html#LN469"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Delimiter'>, 
</span>                                       <a href="joinpath.c.html#LN470"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Delimiter'>, 
</span>                                       <a href="joinpath.c.html#LN476"><span class='Ref_to_Parameter'>extra</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2179"><span class='Ref_to_Member'>restrictlist</span></a><span class='Delimiter'>, 
</span>                                       <a href="joinpath.c.html#LN471"><span class='Ref_to_Parameter'>pathkeys</span></a><span class='Delimiter'>, 
</span>                                       <a href="joinpath.c.html#LN479"><span class='Ref_To_Local'>required_outer</span></a><span class='Delimiter'>, 
</span>                                       <a href="joinpath.c.html#LN472"><span class='Ref_to_Parameter'>mergeclauses</span></a><span class='Delimiter'>, 
</span>                                       <a href="joinpath.c.html#LN473"><span class='Ref_to_Parameter'>outersortkeys</span></a><span class='Delimiter'>, 
</span>                                       <a href="joinpath.c.html#LN474"><span class='Ref_to_Parameter'>innersortkeys</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Waste no memory when we reject a path here */ 
</span>        <a href="../../../include/nodes/bitmapset.h.html#LN68"><span class='Ref_to_Proto'>bms_free</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN479"><span class='Ref_To_Local'>required_outer</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end try_mergejoin_path &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * try_partial_mergejoin_path 
 *    Consider a partial merge join path; if it appears useful, push it into 
 *    the joinrel's pathlist via add_partial_path(). 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN562"></a><span class='Declare_Function'>try_partial_mergejoin_path</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN563"></a>                           <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN564"></a>                           <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outer_path</span><span class='Delimiter'>, 
</span><a name="LN565"></a>                           <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>inner_path</span><span class='Delimiter'>, 
</span><a name="LN566"></a>                           <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pathkeys</span><span class='Delimiter'>, 
</span><a name="LN567"></a>                           <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>mergeclauses</span><span class='Delimiter'>, 
</span><a name="LN568"></a>                           <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outersortkeys</span><span class='Delimiter'>, 
</span><a name="LN569"></a>                           <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>innersortkeys</span><span class='Delimiter'>, 
</span><a name="LN570"></a>                           <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, 
</span><a name="LN571"></a>                           <a href="../../../include/nodes/relation.h.html#LN2177"><span class='Ref_to_Struct'>JoinPathExtraData</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>extra</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN573"></a>    <a href="../../../include/nodes/relation.h.html#LN2199"><span class='Ref_to_Struct'>JoinCostWorkspace</span></a> <span class='Declare_Local'>workspace</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * See comments in try_partial_hashjoin_path(). 
     */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/nodes/bitmapset.h.html#LN85"><span class='Ref_to_Proto'>bms_is_empty</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN563"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN549"><span class='Ref_to_Member'>lateral_relids</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN565"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN581"></a>        <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a>      <span class='Declare_Local'>inner_paramrels</span> <span class='Operator'>= </span><a href="joinpath.c.html#LN565"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN911"><span class='Ref_to_Member'>ppi_req_outer</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/nodes/bitmapset.h.html#LN85"><span class='Ref_to_Proto'>bms_is_empty</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN581"><span class='Ref_To_Local'>inner_paramrels</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If the given paths are already well enough ordered, we can skip doing 
     * an explicit sort. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN568"><span class='Ref_to_Parameter'>outersortkeys</span></a> <span class='Operator'>&& 
</span>        <a href="../../../include/optimizer/paths.h.html#LN183"><span class='Ref_to_Proto'>pathkeys_contained_in</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN568"><span class='Ref_to_Parameter'>outersortkeys</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN564"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN967"><span class='Ref_to_Member'>pathkeys</span></a><span class='Parentheses'>))</span> 
        <a href="joinpath.c.html#LN568"><span class='Ref_to_Parameter'>outersortkeys</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN569"><span class='Ref_to_Parameter'>innersortkeys</span></a> <span class='Operator'>&& 
</span>        <a href="../../../include/optimizer/paths.h.html#LN183"><span class='Ref_to_Proto'>pathkeys_contained_in</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN569"><span class='Ref_to_Parameter'>innersortkeys</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN565"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN967"><span class='Ref_to_Member'>pathkeys</span></a><span class='Parentheses'>))</span> 
        <a href="joinpath.c.html#LN569"><span class='Ref_to_Parameter'>innersortkeys</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * See comments in try_partial_nestloop_path(). 
     */ 
</span>    <a href="../../../include/optimizer/cost.h.html#LN135"><span class='Ref_to_Proto'>initial_cost_mergejoin</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN562"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="joinpath.c.html#LN573"><span class='Ref_To_Local'>workspace</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN570"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN567"><span class='Ref_to_Parameter'>mergeclauses</span></a><span class='Delimiter'>, 
</span>                           <a href="joinpath.c.html#LN564"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN565"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Delimiter'>, 
</span>                           <a href="joinpath.c.html#LN568"><span class='Ref_to_Parameter'>outersortkeys</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN569"><span class='Ref_to_Parameter'>innersortkeys</span></a><span class='Delimiter'>, 
</span>                           <a href="joinpath.c.html#LN571"><span class='Ref_to_Parameter'>extra</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/optimizer/pathnode.h.html#LN32"><span class='Ref_to_Proto'>add_partial_path_precheck</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN563"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN573"><span class='Ref_To_Local'>workspace</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2203"><span class='Ref_to_Member'>total_cost</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN566"><span class='Ref_to_Parameter'>pathkeys</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Might be good enough to be worth trying, so let's try it. */ 
</span>    <a href="../../../include/optimizer/pathnode.h.html#LN31"><span class='Ref_to_Proto'>add_partial_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN563"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>                     <a href="../../../include/optimizer/pathnode.h.html#LN128"><span class='Ref_to_Proto'>create_mergejoin_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN562"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                           <a href="joinpath.c.html#LN563"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                                           <a href="joinpath.c.html#LN570"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                                           <span class='Operator'>&</span><a href="joinpath.c.html#LN573"><span class='Ref_To_Local'>workspace</span></a><span class='Delimiter'>, 
</span>                                           <a href="joinpath.c.html#LN571"><span class='Ref_to_Parameter'>extra</span></a><span class='Delimiter'>, 
</span>                                           <a href="joinpath.c.html#LN564"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Delimiter'>, 
</span>                                           <a href="joinpath.c.html#LN565"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Delimiter'>, 
</span>                                           <a href="joinpath.c.html#LN571"><span class='Ref_to_Parameter'>extra</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2179"><span class='Ref_to_Member'>restrictlist</span></a><span class='Delimiter'>, 
</span>                                           <a href="joinpath.c.html#LN566"><span class='Ref_to_Parameter'>pathkeys</span></a><span class='Delimiter'>, 
</span>                                           <span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                                           <a href="joinpath.c.html#LN567"><span class='Ref_to_Parameter'>mergeclauses</span></a><span class='Delimiter'>, 
</span>                                           <a href="joinpath.c.html#LN568"><span class='Ref_to_Parameter'>outersortkeys</span></a><span class='Delimiter'>, 
</span>                                           <a href="joinpath.c.html#LN569"><span class='Ref_to_Parameter'>innersortkeys</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end try_partial_mergejoin_path &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * try_hashjoin_path 
 *    Consider a hash join path; if it appears useful, push it into 
 *    the joinrel's pathlist via add_path(). 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN632"></a><span class='Declare_Function'>try_hashjoin_path</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN633"></a>                  <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN634"></a>                  <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outer_path</span><span class='Delimiter'>, 
</span><a name="LN635"></a>                  <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>inner_path</span><span class='Delimiter'>, 
</span><a name="LN636"></a>                  <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>hashclauses</span><span class='Delimiter'>, 
</span><a name="LN637"></a>                  <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, 
</span><a name="LN638"></a>                  <a href="../../../include/nodes/relation.h.html#LN2177"><span class='Ref_to_Struct'>JoinPathExtraData</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>extra</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN640"></a>    <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a>      <span class='Declare_Local'>required_outer</span><span class='Delimiter'>; 
</span><a name="LN641"></a>    <a href="../../../include/nodes/relation.h.html#LN2199"><span class='Ref_to_Struct'>JoinCostWorkspace</span></a> <span class='Declare_Local'>workspace</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Check to see if proposed path is still parameterized, and reject if the 
     * parameterization wouldn't be sensible. 
     */ 
</span>    <a href="joinpath.c.html#LN640"><span class='Ref_To_Local'>required_outer</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/pathnode.h.html#LN115"><span class='Ref_to_Proto'>calc_non_nestloop_required_outer</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN634"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Delimiter'>, 
</span>                                                      <a href="joinpath.c.html#LN635"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN640"><span class='Ref_To_Local'>required_outer</span></a> <span class='Operator'>&& 
</span>        <span class='Operator'>!</span><a href="../../../include/nodes/bitmapset.h.html#LN76"><span class='Ref_to_Proto'>bms_overlap</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN640"><span class='Ref_To_Local'>required_outer</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN638"><span class='Ref_to_Parameter'>extra</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2184"><span class='Ref_to_Member'>param_source_rels</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Waste no memory when we reject a path here */ 
</span>        <a href="../../../include/nodes/bitmapset.h.html#LN68"><span class='Ref_to_Proto'>bms_free</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN640"><span class='Ref_To_Local'>required_outer</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * See comments in try_nestloop_path().  Also note that hashjoin paths 
     * never have any output pathkeys, per comments in create_hashjoin_path. 
     */ 
</span>    <a href="../../../include/optimizer/cost.h.html#LN145"><span class='Ref_to_Proto'>initial_cost_hashjoin</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN632"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="joinpath.c.html#LN641"><span class='Ref_To_Local'>workspace</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN637"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN636"><span class='Ref_to_Parameter'>hashclauses</span></a><span class='Delimiter'>, 
</span>                          <a href="joinpath.c.html#LN634"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN635"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN638"><span class='Ref_to_Parameter'>extra</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/optimizer/pathnode.h.html#LN28"><span class='Ref_to_Proto'>add_path_precheck</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN633"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                          <a href="joinpath.c.html#LN641"><span class='Ref_To_Local'>workspace</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2202"><span class='Ref_to_Member'>startup_cost</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN641"><span class='Ref_To_Local'>workspace</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2203"><span class='Ref_to_Member'>total_cost</span></a><span class='Delimiter'>, 
</span>                          <a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN640"><span class='Ref_To_Local'>required_outer</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../../include/optimizer/pathnode.h.html#LN27"><span class='Ref_to_Proto'>add_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN633"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>                 <a href="../../../include/optimizer/pathnode.h.html#LN142"><span class='Ref_to_Proto'>create_hashjoin_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN632"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                      <a href="joinpath.c.html#LN633"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                                      <a href="joinpath.c.html#LN637"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                                      <span class='Operator'>&</span><a href="joinpath.c.html#LN641"><span class='Ref_To_Local'>workspace</span></a><span class='Delimiter'>, 
</span>                                      <a href="joinpath.c.html#LN638"><span class='Ref_to_Parameter'>extra</span></a><span class='Delimiter'>, 
</span>                                      <a href="joinpath.c.html#LN634"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Delimiter'>, 
</span>                                      <a href="joinpath.c.html#LN635"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Delimiter'>, 
</span>                                      <a href="joinpath.c.html#LN638"><span class='Ref_to_Parameter'>extra</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2179"><span class='Ref_to_Member'>restrictlist</span></a><span class='Delimiter'>, 
</span>                                      <a href="joinpath.c.html#LN640"><span class='Ref_To_Local'>required_outer</span></a><span class='Delimiter'>, 
</span>                                      <a href="joinpath.c.html#LN636"><span class='Ref_to_Parameter'>hashclauses</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Waste no memory when we reject a path here */ 
</span>        <a href="../../../include/nodes/bitmapset.h.html#LN68"><span class='Ref_to_Proto'>bms_free</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN640"><span class='Ref_To_Local'>required_outer</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end try_hashjoin_path &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * try_partial_hashjoin_path 
 *    Consider a partial hashjoin join path; if it appears useful, push it into 
 *    the joinrel's partial_pathlist via add_partial_path(). 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN693"></a><span class='Declare_Function'>try_partial_hashjoin_path</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN694"></a>                          <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN695"></a>                          <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outer_path</span><span class='Delimiter'>, 
</span><a name="LN696"></a>                          <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>inner_path</span><span class='Delimiter'>, 
</span><a name="LN697"></a>                          <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>hashclauses</span><span class='Delimiter'>, 
</span><a name="LN698"></a>                          <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, 
</span><a name="LN699"></a>                          <a href="../../../include/nodes/relation.h.html#LN2177"><span class='Ref_to_Struct'>JoinPathExtraData</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>extra</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN701"></a>    <a href="../../../include/nodes/relation.h.html#LN2199"><span class='Ref_to_Struct'>JoinCostWorkspace</span></a> <span class='Declare_Local'>workspace</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If the inner path is parameterized, the parameterization must be fully 
     * satisfied by the proposed outer path.  Parameterized partial paths are 
     * not supported.  The caller should already have verified that no 
     * extra_lateral_rels are required here. 
     */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/nodes/bitmapset.h.html#LN85"><span class='Ref_to_Proto'>bms_is_empty</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN694"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN549"><span class='Ref_to_Member'>lateral_relids</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN696"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN712"></a>        <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a>      <span class='Declare_Local'>inner_paramrels</span> <span class='Operator'>= </span><a href="joinpath.c.html#LN696"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN911"><span class='Ref_to_Member'>ppi_req_outer</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/nodes/bitmapset.h.html#LN85"><span class='Ref_to_Proto'>bms_is_empty</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN712"><span class='Ref_To_Local'>inner_paramrels</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Before creating a path, get a quick lower bound on what it is likely to 
     * cost.  Bail out right away if it looks terrible. 
     */ 
</span>    <a href="../../../include/optimizer/cost.h.html#LN145"><span class='Ref_to_Proto'>initial_cost_hashjoin</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN693"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="joinpath.c.html#LN701"><span class='Ref_To_Local'>workspace</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN698"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN697"><span class='Ref_to_Parameter'>hashclauses</span></a><span class='Delimiter'>, 
</span>                          <a href="joinpath.c.html#LN695"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN696"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN699"><span class='Ref_to_Parameter'>extra</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/optimizer/pathnode.h.html#LN32"><span class='Ref_to_Proto'>add_partial_path_precheck</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN694"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN701"><span class='Ref_To_Local'>workspace</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN2203"><span class='Ref_to_Member'>total_cost</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Might be good enough to be worth trying, so let's try it. */ 
</span>    <a href="../../../include/optimizer/pathnode.h.html#LN31"><span class='Ref_to_Proto'>add_partial_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN694"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>                     <a href="../../../include/optimizer/pathnode.h.html#LN142"><span class='Ref_to_Proto'>create_hashjoin_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN693"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                          <a href="joinpath.c.html#LN694"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                                          <a href="joinpath.c.html#LN698"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                                          <span class='Operator'>&</span><a href="joinpath.c.html#LN701"><span class='Ref_To_Local'>workspace</span></a><span class='Delimiter'>, 
</span>                                          <a href="joinpath.c.html#LN699"><span class='Ref_to_Parameter'>extra</span></a><span class='Delimiter'>, 
</span>                                          <a href="joinpath.c.html#LN695"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Delimiter'>, 
</span>                                          <a href="joinpath.c.html#LN696"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Delimiter'>, 
</span>                                          <a href="joinpath.c.html#LN699"><span class='Ref_to_Parameter'>extra</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2179"><span class='Ref_to_Member'>restrictlist</span></a><span class='Delimiter'>, 
</span>                                          <span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                                          <a href="joinpath.c.html#LN697"><span class='Ref_to_Parameter'>hashclauses</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end try_partial_hashjoin_path &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * clause_sides_match_join 
 *    Determine whether a join clause is of the right form to use in this join. 
 * 
 * We already know that the clause is a binary opclause referencing only the 
 * rels in the current join.  The point here is to check whether it has the 
 * form "outerrel_expr op innerrel_expr" or "innerrel_expr op outerrel_expr", 
 * rather than mixing outer and inner vars on either side.  If it matches, 
 * we set the transient flag outer_is_left to identify which side is which. 
 */ 
</span><span class='Keyword'>static inline bool 
</span><a name="LN752"></a><span class='Declare_Function'>clause_sides_match_join</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rinfo</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outerrel</span><span class='Delimiter'>, 
</span><a name="LN753"></a>                        <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>innerrel</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/bitmapset.h.html#LN73"><span class='Ref_to_Proto'>bms_is_subset</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN752"><span class='Ref_to_Parameter'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1773"><span class='Ref_to_Member'>left_relids</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN752"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>        <a href="../../../include/nodes/bitmapset.h.html#LN73"><span class='Ref_to_Proto'>bms_is_subset</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN752"><span class='Ref_to_Parameter'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1774"><span class='Ref_to_Member'>right_relids</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN753"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* lefthand side is outer */ 
</span>        <a href="joinpath.c.html#LN752"><span class='Ref_to_Parameter'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1801"><span class='Ref_to_Member'>outer_is_left</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/bitmapset.h.html#LN73"><span class='Ref_to_Proto'>bms_is_subset</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN752"><span class='Ref_to_Parameter'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1773"><span class='Ref_to_Member'>left_relids</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN753"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>             <a href="../../../include/nodes/bitmapset.h.html#LN73"><span class='Ref_to_Proto'>bms_is_subset</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN752"><span class='Ref_to_Parameter'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1774"><span class='Ref_to_Member'>right_relids</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN752"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* righthand side is outer */ 
</span>        <a href="joinpath.c.html#LN752"><span class='Ref_to_Parameter'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1801"><span class='Ref_to_Member'>outer_is_left</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>;</span>               <span class='Comment_Single_Line'>/* no good for these input relations */ 
</span><span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end clause_sides_match_join &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * sort_inner_and_outer 
 *    Create mergejoin join paths by explicitly sorting both the outer and 
 *    inner join relations on each available merge ordering. 
 * 
 * 'joinrel' is the join relation 
 * 'outerrel' is the outer join relation 
 * 'innerrel' is the inner join relation 
 * 'jointype' is the type of join to do 
 * 'extra' contains additional input values 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN784"></a><span class='Declare_Function'>sort_inner_and_outer</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN785"></a>                     <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN786"></a>                     <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outerrel</span><span class='Delimiter'>, 
</span><a name="LN787"></a>                     <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>innerrel</span><span class='Delimiter'>, 
</span><a name="LN788"></a>                     <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, 
</span><a name="LN789"></a>                     <a href="../../../include/nodes/relation.h.html#LN2177"><span class='Ref_to_Struct'>JoinPathExtraData</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>extra</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN791"></a>    <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a>    <span class='Declare_Local'>save_jointype</span> <span class='Operator'>= </span><a href="joinpath.c.html#LN788"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>; 
</span><a name="LN792"></a>    <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>outer_path</span><span class='Delimiter'>; 
</span><a name="LN793"></a>    <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>inner_path</span><span class='Delimiter'>; 
</span><a name="LN794"></a>    <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>cheapest_partial_outer</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN795"></a>    <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>cheapest_safe_inner</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN796"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>all_pathkeys</span><span class='Delimiter'>; 
</span><a name="LN797"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We only consider the cheapest-total-cost input paths, since we are 
     * assuming here that a sort is required.  We will consider 
     * cheapest-startup-cost input paths later, and only if they don't need a 
     * sort. 
     * 
     * This function intentionally does not consider parameterized input 
     * paths, except when the cheapest-total is parameterized.  If we did so, 
     * we'd have a combinatorial explosion of mergejoin paths of dubious 
     * value.  This interacts with decisions elsewhere that also discriminate 
     * against mergejoins with parameterized inputs; see comments in 
     * src/backend/optimizer/README. 
     */ 
</span>    <a href="joinpath.c.html#LN792"><span class='Ref_To_Local'>outer_path</span></a> <span class='Operator'>= </span><a href="joinpath.c.html#LN786"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN542"><span class='Ref_to_Member'>cheapest_total_path</span></a><span class='Delimiter'>; 
</span>    <a href="joinpath.c.html#LN793"><span class='Ref_To_Local'>inner_path</span></a> <span class='Operator'>= </span><a href="joinpath.c.html#LN787"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN542"><span class='Ref_to_Member'>cheapest_total_path</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If either cheapest-total path is parameterized by the other rel, we 
     * can't use a mergejoin.  (There's no use looking for alternative input 
     * paths, since these should already be the least-parameterized available 
     * paths.) 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN28"><span class='Ref_to_Macro'>PATH_PARAM_BY_REL</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN792"><span class='Ref_To_Local'>outer_path</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN787"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Parentheses'>) </span><span class='Operator'>|| 
</span>        <a href="joinpath.c.html#LN28"><span class='Ref_to_Macro'>PATH_PARAM_BY_REL</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN793"><span class='Ref_To_Local'>inner_path</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN786"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If unique-ification is requested, do it and then handle as a plain 
     * inner join. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN788"><span class='Ref_to_Parameter'>jointype</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/nodes.h.html#LN698"><span class='Ref_to_EnumConst'>JOIN_UNIQUE_OUTER</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="joinpath.c.html#LN792"><span class='Ref_To_Local'>outer_path</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/optimizer/pathnode.h.html#LN77"><span class='Ref_to_Proto'>create_unique_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN784"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN786"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Delimiter'>, 
</span>                                                 <a href="joinpath.c.html#LN792"><span class='Ref_To_Local'>outer_path</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN789"><span class='Ref_to_Parameter'>extra</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2182"><span class='Ref_to_Member'>sjinfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="joinpath.c.html#LN792"><span class='Ref_To_Local'>outer_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="joinpath.c.html#LN788"><span class='Ref_to_Parameter'>jointype</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN677"><span class='Ref_to_EnumConst'>JOIN_INNER</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN788"><span class='Ref_to_Parameter'>jointype</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/nodes.h.html#LN699"><span class='Ref_to_EnumConst'>JOIN_UNIQUE_INNER</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="joinpath.c.html#LN793"><span class='Ref_To_Local'>inner_path</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/optimizer/pathnode.h.html#LN77"><span class='Ref_to_Proto'>create_unique_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN784"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN787"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Delimiter'>, 
</span>                                                 <a href="joinpath.c.html#LN793"><span class='Ref_To_Local'>inner_path</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN789"><span class='Ref_to_Parameter'>extra</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2182"><span class='Ref_to_Member'>sjinfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="joinpath.c.html#LN793"><span class='Ref_To_Local'>inner_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="joinpath.c.html#LN788"><span class='Ref_to_Parameter'>jointype</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN677"><span class='Ref_to_EnumConst'>JOIN_INNER</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If the joinrel is parallel-safe, we may be able to consider a partial 
     * merge join.  However, we can't handle JOIN_UNIQUE_OUTER, because the 
     * outer path will be partial, and therefore we won't be able to properly 
     * guarantee uniqueness.  Similarly, we can't handle JOIN_FULL and 
     * JOIN_RIGHT, because they can produce false null extended rows.  Also, 
     * the resulting path must not be parameterized. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN785"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN532"><span class='Ref_to_Member'>consider_parallel</span></a> <span class='Operator'>&& 
</span>        <a href="joinpath.c.html#LN791"><span class='Ref_To_Local'>save_jointype</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/nodes.h.html#LN698"><span class='Ref_to_EnumConst'>JOIN_UNIQUE_OUTER</span></a> <span class='Operator'>&& 
</span>        <a href="joinpath.c.html#LN791"><span class='Ref_To_Local'>save_jointype</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/nodes.h.html#LN679"><span class='Ref_to_EnumConst'>JOIN_FULL</span></a> <span class='Operator'>&& 
</span>        <a href="joinpath.c.html#LN791"><span class='Ref_To_Local'>save_jointype</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/nodes.h.html#LN680"><span class='Ref_to_EnumConst'>JOIN_RIGHT</span></a> <span class='Operator'>&& 
</span>        <a href="joinpath.c.html#LN786"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN540"><span class='Ref_to_Member'>partial_pathlist</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a> <span class='Operator'>&& 
</span>        <a href="../../../include/nodes/bitmapset.h.html#LN85"><span class='Ref_to_Proto'>bms_is_empty</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN785"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN549"><span class='Ref_to_Member'>lateral_relids</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="joinpath.c.html#LN794"><span class='Ref_To_Local'>cheapest_partial_outer</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN786"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN540"><span class='Ref_to_Member'>partial_pathlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN793"><span class='Ref_To_Local'>inner_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN958"><span class='Ref_to_Member'>parallel_safe</span></a><span class='Parentheses'>) 
</span>            <a href="joinpath.c.html#LN795"><span class='Ref_To_Local'>cheapest_safe_inner</span></a> <span class='Operator'>= </span><a href="joinpath.c.html#LN793"><span class='Ref_To_Local'>inner_path</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN791"><span class='Ref_To_Local'>save_jointype</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/nodes.h.html#LN699"><span class='Ref_to_EnumConst'>JOIN_UNIQUE_INNER</span></a><span class='Parentheses'>) 
</span>            <a href="joinpath.c.html#LN795"><span class='Ref_To_Local'>cheapest_safe_inner</span></a> <span class='Operator'>= 
</span>                <a href="../../../include/optimizer/paths.h.html#LN192"><span class='Ref_to_Proto'>get_cheapest_parallel_safe_total_inner</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN787"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN538"><span class='Ref_to_Member'>pathlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Each possible ordering of the available mergejoin clauses will generate 
     * a differently-sorted result path at essentially the same cost.  We have 
     * no basis for choosing one over another at this level of joining, but 
     * some sort orders may be more useful than others for higher-level 
     * mergejoins, so it's worth considering multiple orderings. 
     * 
     * Actually, it's not quite true that every mergeclause ordering will 
     * generate a different path order, because some of the clauses may be 
     * partially redundant (refer to the same EquivalenceClasses).  Therefore, 
     * what we do is convert the mergeclause list to a list of canonical 
     * pathkeys, and then consider different orderings of the pathkeys. 
     * 
     * Generating a path for *every* permutation of the pathkeys doesn't seem 
     * like a winning strategy; the cost in planning time is too high. For 
     * now, we generate one path for each pathkey, listing that pathkey first 
     * and the rest in random order.  This should allow at least a one-clause 
     * mergejoin without re-sorting against any other possible mergejoin 
     * partner path.  But if we've not guessed the right ordering of secondary 
     * keys, we may end up evaluating clauses as qpquals when they could have 
     * been done as mergeclauses.  (In practice, it's rare that there's more 
     * than two or three mergeclauses, so expending a huge amount of thought 
     * on that is probably not worth it.) 
     * 
     * The pathkey order returned by select_outer_pathkeys_for_merge() has 
     * some heuristics behind it (see that function), so be sure to try it 
     * exactly as-is as well as making variants. 
     */ 
</span>    <a href="joinpath.c.html#LN796"><span class='Ref_To_Local'>all_pathkeys</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/paths.h.html#LN216"><span class='Ref_to_Proto'>select_outer_pathkeys_for_merge</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN784"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                   <a href="joinpath.c.html#LN789"><span class='Ref_to_Parameter'>extra</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2180"><span class='Ref_to_Member'>mergeclause_list</span></a><span class='Delimiter'>, 
</span>                                                   <a href="joinpath.c.html#LN785"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN797"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN796"><span class='Ref_To_Local'>all_pathkeys</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN902"></a>        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>front_pathkey</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN797"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN903"></a>        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>cur_mergeclauses</span><span class='Delimiter'>; 
</span><a name="LN904"></a>        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>outerkeys</span><span class='Delimiter'>; 
</span><a name="LN905"></a>        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>innerkeys</span><span class='Delimiter'>; 
</span><a name="LN906"></a>        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>merge_pathkeys</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Make a pathkey list with this guy first */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN797"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/pg_list.h.html#LN75"><span class='Ref_to_Func'>list_head</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN796"><span class='Ref_To_Local'>all_pathkeys</span></a><span class='Parentheses'>))</span> 
            <a href="joinpath.c.html#LN904"><span class='Ref_To_Local'>outerkeys</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN215"><span class='Ref_to_Proto'>lcons</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN902"><span class='Ref_To_Local'>front_pathkey</span></a><span class='Delimiter'>, 
</span>                              <a href="../../../include/nodes/pg_list.h.html#LN234"><span class='Ref_to_Proto'>list_delete_ptr</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN268"><span class='Ref_to_Proto'>list_copy</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN796"><span class='Ref_To_Local'>all_pathkeys</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                              <a href="joinpath.c.html#LN902"><span class='Ref_To_Local'>front_pathkey</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="joinpath.c.html#LN904"><span class='Ref_To_Local'>outerkeys</span></a> <span class='Operator'>= </span><a href="joinpath.c.html#LN796"><span class='Ref_To_Local'>all_pathkeys</span></a><span class='Delimiter'>;</span>   <span class='Comment_Single_Line'>/* no work at first one... */ 
</span> 
        <span class='Comment_Multi_Line'>/* Sort the mergeclauses into the corresponding ordering */ 
</span>        <a href="joinpath.c.html#LN903"><span class='Ref_To_Local'>cur_mergeclauses</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/paths.h.html#LN212"><span class='Ref_to_Proto'>find_mergeclauses_for_pathkeys</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN784"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                          <a href="joinpath.c.html#LN904"><span class='Ref_To_Local'>outerkeys</span></a><span class='Delimiter'>, 
</span>                                                          <span class='Boolean'>true</span><span class='Delimiter'>, 
</span>                                                    <a href="joinpath.c.html#LN789"><span class='Ref_to_Parameter'>extra</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2180"><span class='Ref_to_Member'>mergeclause_list</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Should have used them all... */ 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN903"><span class='Ref_To_Local'>cur_mergeclauses</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN789"><span class='Ref_to_Parameter'>extra</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2180"><span class='Ref_to_Member'>mergeclause_list</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Build sort pathkeys for the inner side */ 
</span>        <a href="joinpath.c.html#LN905"><span class='Ref_To_Local'>innerkeys</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/paths.h.html#LN219"><span class='Ref_to_Proto'>make_inner_pathkeys_for_merge</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN784"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                  <a href="joinpath.c.html#LN903"><span class='Ref_To_Local'>cur_mergeclauses</span></a><span class='Delimiter'>, 
</span>                                                  <a href="joinpath.c.html#LN904"><span class='Ref_To_Local'>outerkeys</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Build pathkeys representing output sort order */ 
</span>        <a href="joinpath.c.html#LN906"><span class='Ref_To_Local'>merge_pathkeys</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/paths.h.html#LN201"><span class='Ref_to_Proto'>build_join_pathkeys</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN784"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN785"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN788"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                                             <a href="joinpath.c.html#LN904"><span class='Ref_To_Local'>outerkeys</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * And now we can make the path. 
         * 
         * Note: it's possible that the cheapest paths will already be sorted 
         * properly.  try_mergejoin_path will detect that case and suppress an 
         * explicit sort step, so we needn't do so here. 
         */ 
</span>        <a href="joinpath.c.html#LN466"><span class='Ref_to_Func'>try_mergejoin_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN784"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                           <a href="joinpath.c.html#LN785"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                           <a href="joinpath.c.html#LN792"><span class='Ref_To_Local'>outer_path</span></a><span class='Delimiter'>, 
</span>                           <a href="joinpath.c.html#LN793"><span class='Ref_To_Local'>inner_path</span></a><span class='Delimiter'>, 
</span>                           <a href="joinpath.c.html#LN906"><span class='Ref_To_Local'>merge_pathkeys</span></a><span class='Delimiter'>, 
</span>                           <a href="joinpath.c.html#LN903"><span class='Ref_To_Local'>cur_mergeclauses</span></a><span class='Delimiter'>, 
</span>                           <a href="joinpath.c.html#LN904"><span class='Ref_To_Local'>outerkeys</span></a><span class='Delimiter'>, 
</span>                           <a href="joinpath.c.html#LN905"><span class='Ref_To_Local'>innerkeys</span></a><span class='Delimiter'>, 
</span>                           <a href="joinpath.c.html#LN788"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                           <a href="joinpath.c.html#LN789"><span class='Ref_to_Parameter'>extra</span></a><span class='Delimiter'>, 
</span>                           <span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If we have partial outer and parallel safe inner path then try 
         * partial mergejoin path. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN794"><span class='Ref_To_Local'>cheapest_partial_outer</span></a> <span class='Operator'>&& </span><a href="joinpath.c.html#LN795"><span class='Ref_To_Local'>cheapest_safe_inner</span></a><span class='Parentheses'>) 
</span>            <a href="joinpath.c.html#LN31"><span class='Ref_to_Proto'>try_partial_mergejoin_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN784"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                       <a href="joinpath.c.html#LN785"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                                       <a href="joinpath.c.html#LN794"><span class='Ref_To_Local'>cheapest_partial_outer</span></a><span class='Delimiter'>, 
</span>                                       <a href="joinpath.c.html#LN795"><span class='Ref_To_Local'>cheapest_safe_inner</span></a><span class='Delimiter'>, 
</span>                                       <a href="joinpath.c.html#LN906"><span class='Ref_To_Local'>merge_pathkeys</span></a><span class='Delimiter'>, 
</span>                                       <a href="joinpath.c.html#LN903"><span class='Ref_To_Local'>cur_mergeclauses</span></a><span class='Delimiter'>, 
</span>                                       <a href="joinpath.c.html#LN904"><span class='Ref_To_Local'>outerkeys</span></a><span class='Delimiter'>, 
</span>                                       <a href="joinpath.c.html#LN905"><span class='Ref_To_Local'>innerkeys</span></a><span class='Delimiter'>, 
</span>                                       <a href="joinpath.c.html#LN788"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                                       <a href="joinpath.c.html#LN789"><span class='Ref_to_Parameter'>extra</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end sort_inner_and_outer &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * generate_mergejoin_paths 
 *  Creates possible mergejoin paths for input outerpath. 
 * 
 * We generate mergejoins if mergejoin clauses are available.  We have 
 * two ways to generate the inner path for a mergejoin: sort the cheapest 
 * inner path, or use an inner path that is already suitably ordered for the 
 * merge.  If we have several mergeclauses, it could be that there is no inner 
 * path (or only a very expensive one) for the full list of mergeclauses, but 
 * better paths exist if we truncate the mergeclause list (thereby discarding 
 * some sort key requirements).  So, we consider truncations of the 
 * mergeclause list as well as the full list.  (Ideally we'd consider all 
 * subsets of the mergeclause list, but that seems way too expensive.) 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN986"></a><span class='Declare_Function'>generate_mergejoin_paths</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN987"></a>                         <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN988"></a>                         <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>innerrel</span><span class='Delimiter'>, 
</span><a name="LN989"></a>                         <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outerpath</span><span class='Delimiter'>, 
</span><a name="LN990"></a>                         <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, 
</span><a name="LN991"></a>                         <a href="../../../include/nodes/relation.h.html#LN2177"><span class='Ref_to_Struct'>JoinPathExtraData</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>extra</span><span class='Delimiter'>, 
</span><a name="LN992"></a>                         <span class='Keyword'>bool </span><span class='Declare_Parameter'>useallclauses</span><span class='Delimiter'>, 
</span><a name="LN993"></a>                         <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>inner_cheapest_total</span><span class='Delimiter'>, 
</span><a name="LN994"></a>                         <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>merge_pathkeys</span><span class='Delimiter'>, 
</span><a name="LN995"></a>                         <span class='Keyword'>bool </span><span class='Declare_Parameter'>is_partial</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN997"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>mergeclauses</span><span class='Delimiter'>; 
</span><a name="LN998"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>innersortkeys</span><span class='Delimiter'>; 
</span><a name="LN999"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>trialsortkeys</span><span class='Delimiter'>; 
</span><a name="LN1000"></a>    <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>cheapest_startup_inner</span><span class='Delimiter'>; 
</span><a name="LN1001"></a>    <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>cheapest_total_inner</span><span class='Delimiter'>; 
</span><a name="LN1002"></a>    <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a>    <span class='Declare_Local'>save_jointype</span> <span class='Operator'>= </span><a href="joinpath.c.html#LN990"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>; 
</span><a name="LN1003"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>num_sortkeys</span><span class='Delimiter'>; 
</span><a name="LN1004"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>sortkeycnt</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN990"><span class='Ref_to_Parameter'>jointype</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/nodes.h.html#LN698"><span class='Ref_to_EnumConst'>JOIN_UNIQUE_OUTER</span></a> <span class='Operator'>|| </span><a href="joinpath.c.html#LN990"><span class='Ref_to_Parameter'>jointype</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/nodes.h.html#LN699"><span class='Ref_to_EnumConst'>JOIN_UNIQUE_INNER</span></a><span class='Parentheses'>) 
</span>        <a href="joinpath.c.html#LN990"><span class='Ref_to_Parameter'>jointype</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN677"><span class='Ref_to_EnumConst'>JOIN_INNER</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Look for useful mergeclauses (if any) */ 
</span>    <a href="joinpath.c.html#LN997"><span class='Ref_To_Local'>mergeclauses</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/paths.h.html#LN212"><span class='Ref_to_Proto'>find_mergeclauses_for_pathkeys</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN986"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                  <a href="joinpath.c.html#LN989"><span class='Ref_to_Parameter'>outerpath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN967"><span class='Ref_to_Member'>pathkeys</span></a><span class='Delimiter'>, 
</span>                                                  <span class='Boolean'>true</span><span class='Delimiter'>, 
</span>                                                  <a href="joinpath.c.html#LN991"><span class='Ref_to_Parameter'>extra</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2180"><span class='Ref_to_Member'>mergeclause_list</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Done with this outer path if no chance for a mergejoin. 
     * 
     * Special corner case: for "x FULL JOIN y ON true", there will be no join 
     * clauses at all.  Ordinarily we'd generate a clauseless nestloop path, 
     * but since mergejoin is our only join type that supports FULL JOIN 
     * without any join clauses, it's necessary to generate a clauseless 
     * mergejoin path instead. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN997"><span class='Ref_To_Local'>mergeclauses</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN990"><span class='Ref_to_Parameter'>jointype</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/nodes.h.html#LN679"><span class='Ref_to_EnumConst'>JOIN_FULL</span></a><span class='Parentheses'>) 
</span>             <span class='Comment_Multi_Line'>/* okay to try for mergejoin */ </span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <span class='Control'>return</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN992"><span class='Ref_to_Parameter'>useallclauses</span></a> <span class='Operator'>&& 
</span>        <a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN997"><span class='Ref_To_Local'>mergeclauses</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN991"><span class='Ref_to_Parameter'>extra</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2180"><span class='Ref_to_Member'>mergeclause_list</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Compute the required ordering of the inner path */ 
</span>    <a href="joinpath.c.html#LN998"><span class='Ref_To_Local'>innersortkeys</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/paths.h.html#LN219"><span class='Ref_to_Proto'>make_inner_pathkeys_for_merge</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN986"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                  <a href="joinpath.c.html#LN997"><span class='Ref_To_Local'>mergeclauses</span></a><span class='Delimiter'>, 
</span>                                                  <a href="joinpath.c.html#LN989"><span class='Ref_to_Parameter'>outerpath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN967"><span class='Ref_to_Member'>pathkeys</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Generate a mergejoin on the basis of sorting the cheapest inner. Since 
     * a sort will be needed, only cheapest total cost matters. (But 
     * try_mergejoin_path will do the right thing if inner_cheapest_total is 
     * already correctly sorted.) 
     */ 
</span>    <a href="joinpath.c.html#LN466"><span class='Ref_to_Func'>try_mergejoin_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN986"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                       <a href="joinpath.c.html#LN987"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                       <a href="joinpath.c.html#LN989"><span class='Ref_to_Parameter'>outerpath</span></a><span class='Delimiter'>, 
</span>                       <a href="joinpath.c.html#LN993"><span class='Ref_to_Parameter'>inner_cheapest_total</span></a><span class='Delimiter'>, 
</span>                       <a href="joinpath.c.html#LN994"><span class='Ref_to_Parameter'>merge_pathkeys</span></a><span class='Delimiter'>, 
</span>                       <a href="joinpath.c.html#LN997"><span class='Ref_To_Local'>mergeclauses</span></a><span class='Delimiter'>, 
</span>                       <a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>, 
</span>                       <a href="joinpath.c.html#LN998"><span class='Ref_To_Local'>innersortkeys</span></a><span class='Delimiter'>, 
</span>                       <a href="joinpath.c.html#LN990"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                       <a href="joinpath.c.html#LN991"><span class='Ref_to_Parameter'>extra</span></a><span class='Delimiter'>, 
</span>                       <a href="joinpath.c.html#LN995"><span class='Ref_to_Parameter'>is_partial</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Can't do anything else if inner path needs to be unique'd */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1002"><span class='Ref_To_Local'>save_jointype</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/nodes.h.html#LN699"><span class='Ref_to_EnumConst'>JOIN_UNIQUE_INNER</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Look for presorted inner paths that satisfy the innersortkey list --- 
     * or any truncation thereof, if we are allowed to build a mergejoin using 
     * a subset of the merge clauses.  Here, we consider both cheap startup 
     * cost and cheap total cost. 
     * 
     * Currently we do not consider parameterized inner paths here. This 
     * interacts with decisions elsewhere that also discriminate against 
     * mergejoins with parameterized inputs; see comments in 
     * src/backend/optimizer/README. 
     * 
     * As we shorten the sortkey list, we should consider only paths that are 
     * strictly cheaper than (in particular, not the same as) any path found 
     * in an earlier iteration.  Otherwise we'd be intentionally using fewer 
     * merge keys than a given path allows (treating the rest as plain 
     * joinquals), which is unlikely to be a good idea.  Also, eliminating 
     * paths here on the basis of compare_path_costs is a lot cheaper than 
     * building the mergejoin path only to throw it away. 
     * 
     * If inner_cheapest_total is well enough sorted to have not required a 
     * sort in the path made above, we shouldn't make a duplicate path with 
     * it, either.  We handle that case with the same logic that handles the 
     * previous consideration, by initializing the variables that track 
     * cheapest-so-far properly.  Note that we do NOT reject 
     * inner_cheapest_total if we find it matches some shorter set of 
     * pathkeys.  That case corresponds to using fewer mergekeys to avoid 
     * sorting inner_cheapest_total, whereas we did sort it above, so the 
     * plans being considered are different. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/optimizer/paths.h.html#LN183"><span class='Ref_to_Proto'>pathkeys_contained_in</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN998"><span class='Ref_To_Local'>innersortkeys</span></a><span class='Delimiter'>, 
</span>                              <a href="joinpath.c.html#LN993"><span class='Ref_to_Parameter'>inner_cheapest_total</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN967"><span class='Ref_to_Member'>pathkeys</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* inner_cheapest_total didn't require a sort */ 
</span>        <a href="joinpath.c.html#LN1000"><span class='Ref_To_Local'>cheapest_startup_inner</span></a> <span class='Operator'>= </span><a href="joinpath.c.html#LN993"><span class='Ref_to_Parameter'>inner_cheapest_total</span></a><span class='Delimiter'>; 
</span>        <a href="joinpath.c.html#LN1001"><span class='Ref_To_Local'>cheapest_total_inner</span></a> <span class='Operator'>= </span><a href="joinpath.c.html#LN993"><span class='Ref_to_Parameter'>inner_cheapest_total</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* it did require a sort, at least for the full set of keys */ 
</span>        <a href="joinpath.c.html#LN1000"><span class='Ref_To_Local'>cheapest_startup_inner</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="joinpath.c.html#LN1001"><span class='Ref_To_Local'>cheapest_total_inner</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="joinpath.c.html#LN1003"><span class='Ref_To_Local'>num_sortkeys</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN998"><span class='Ref_To_Local'>innersortkeys</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1003"><span class='Ref_To_Local'>num_sortkeys</span></a> <span class='Operator'>&GT; </span><span class='Number'>1</span> <span class='Operator'>&& !</span><a href="joinpath.c.html#LN992"><span class='Ref_to_Parameter'>useallclauses</span></a><span class='Parentheses'>) 
</span>        <a href="joinpath.c.html#LN999"><span class='Ref_To_Local'>trialsortkeys</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN268"><span class='Ref_to_Proto'>list_copy</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN998"><span class='Ref_To_Local'>innersortkeys</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* need modifiable copy */ 
</span>    <span class='Control'>else</span> 
        <a href="joinpath.c.html#LN999"><span class='Ref_To_Local'>trialsortkeys</span></a> <span class='Operator'>= </span><a href="joinpath.c.html#LN998"><span class='Ref_To_Local'>innersortkeys</span></a><span class='Delimiter'>;</span>  <span class='Comment_Single_Line'>/* won't really truncate */ 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1004"><span class='Ref_To_Local'>sortkeycnt</span></a> <span class='Operator'>= </span><a href="joinpath.c.html#LN1003"><span class='Ref_To_Local'>num_sortkeys</span></a><span class='Delimiter'>; </span><a href="joinpath.c.html#LN1004"><span class='Ref_To_Local'>sortkeycnt</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="joinpath.c.html#LN1004"><span class='Ref_To_Local'>sortkeycnt</span></a><span class='Operator'>--</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1112"></a>        <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>innerpath</span><span class='Delimiter'>; 
</span><a name="LN1113"></a>        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>newclauses</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Look for an inner path ordered well enough for the first 
         * 'sortkeycnt' innersortkeys.  NB: trialsortkeys list is modified 
         * destructively, which is why we made a copy... 
         */ 
</span>        <a href="joinpath.c.html#LN999"><span class='Ref_To_Local'>trialsortkeys</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN220"><span class='Ref_to_Proto'>list_truncate</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN999"><span class='Ref_To_Local'>trialsortkeys</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1004"><span class='Ref_To_Local'>sortkeycnt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="joinpath.c.html#LN1112"><span class='Ref_To_Local'>innerpath</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/paths.h.html#LN184"><span class='Ref_to_Proto'>get_cheapest_path_for_pathkeys</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN988"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN538"><span class='Ref_to_Member'>pathlist</span></a><span class='Delimiter'>, 
</span>                                                   <a href="joinpath.c.html#LN999"><span class='Ref_To_Local'>trialsortkeys</span></a><span class='Delimiter'>, 
</span>                                                   <span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                                                   <a href="../../../include/nodes/relation.h.html#LN35"><span class='Ref_to_EnumConst'>TOTAL_COST</span></a><span class='Delimiter'>, 
</span>                                                   <a href="joinpath.c.html#LN995"><span class='Ref_to_Parameter'>is_partial</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1112"><span class='Ref_To_Local'>innerpath</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& 
</span>            <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1001"><span class='Ref_To_Local'>cheapest_total_inner</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| 
</span>             <a href="../../../include/optimizer/pathnode.h.html#LN22"><span class='Ref_to_Proto'>compare_path_costs</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1112"><span class='Ref_To_Local'>innerpath</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1001"><span class='Ref_To_Local'>cheapest_total_inner</span></a><span class='Delimiter'>, 
</span>                                <a href="../../../include/nodes/relation.h.html#LN35"><span class='Ref_to_EnumConst'>TOTAL_COST</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Found a cheap (or even-cheaper) sorted path */ 
</span>            <span class='Comment_Multi_Line'>/* Select the right mergeclauses, if we didn't already */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1004"><span class='Ref_To_Local'>sortkeycnt</span></a> <span class='Operator'>&LT; </span><a href="joinpath.c.html#LN1003"><span class='Ref_To_Local'>num_sortkeys</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="joinpath.c.html#LN1113"><span class='Ref_To_Local'>newclauses</span></a> <span class='Operator'>= 
</span>                    <a href="../../../include/optimizer/paths.h.html#LN212"><span class='Ref_to_Proto'>find_mergeclauses_for_pathkeys</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN986"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                   <a href="joinpath.c.html#LN999"><span class='Ref_To_Local'>trialsortkeys</span></a><span class='Delimiter'>, 
</span>                                                   <span class='Boolean'>false</span><span class='Delimiter'>, 
</span>                                                   <a href="joinpath.c.html#LN997"><span class='Ref_To_Local'>mergeclauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1113"><span class='Ref_To_Local'>newclauses</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
                <a href="joinpath.c.html#LN1113"><span class='Ref_To_Local'>newclauses</span></a> <span class='Operator'>= </span><a href="joinpath.c.html#LN997"><span class='Ref_To_Local'>mergeclauses</span></a><span class='Delimiter'>; 
</span>            <a href="joinpath.c.html#LN466"><span class='Ref_to_Func'>try_mergejoin_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN986"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                               <a href="joinpath.c.html#LN987"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                               <a href="joinpath.c.html#LN989"><span class='Ref_to_Parameter'>outerpath</span></a><span class='Delimiter'>, 
</span>                               <a href="joinpath.c.html#LN1112"><span class='Ref_To_Local'>innerpath</span></a><span class='Delimiter'>, 
</span>                               <a href="joinpath.c.html#LN994"><span class='Ref_to_Parameter'>merge_pathkeys</span></a><span class='Delimiter'>, 
</span>                               <a href="joinpath.c.html#LN1113"><span class='Ref_To_Local'>newclauses</span></a><span class='Delimiter'>, 
</span>                               <a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>, 
</span>                               <a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>, 
</span>                               <a href="joinpath.c.html#LN990"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                               <a href="joinpath.c.html#LN991"><span class='Ref_to_Parameter'>extra</span></a><span class='Delimiter'>, 
</span>                               <a href="joinpath.c.html#LN995"><span class='Ref_to_Parameter'>is_partial</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="joinpath.c.html#LN1001"><span class='Ref_To_Local'>cheapest_total_inner</span></a> <span class='Operator'>= </span><a href="joinpath.c.html#LN1112"><span class='Ref_To_Local'>innerpath</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if innerpath!=NULL&&(che... &raquo; </span> 
        <span class='Comment_Multi_Line'>/* Same on the basis of cheapest startup cost ... */ 
</span>        <a href="joinpath.c.html#LN1112"><span class='Ref_To_Local'>innerpath</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/paths.h.html#LN184"><span class='Ref_to_Proto'>get_cheapest_path_for_pathkeys</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN988"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN538"><span class='Ref_to_Member'>pathlist</span></a><span class='Delimiter'>, 
</span>                                                   <a href="joinpath.c.html#LN999"><span class='Ref_To_Local'>trialsortkeys</span></a><span class='Delimiter'>, 
</span>                                                   <span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                                                   <a href="../../../include/nodes/relation.h.html#LN35"><span class='Ref_to_EnumConst'>STARTUP_COST</span></a><span class='Delimiter'>, 
</span>                                                   <a href="joinpath.c.html#LN995"><span class='Ref_to_Parameter'>is_partial</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1112"><span class='Ref_To_Local'>innerpath</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& 
</span>            <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1000"><span class='Ref_To_Local'>cheapest_startup_inner</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| 
</span>             <a href="../../../include/optimizer/pathnode.h.html#LN22"><span class='Ref_to_Proto'>compare_path_costs</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1112"><span class='Ref_To_Local'>innerpath</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1000"><span class='Ref_To_Local'>cheapest_startup_inner</span></a><span class='Delimiter'>, 
</span>                                <a href="../../../include/nodes/relation.h.html#LN35"><span class='Ref_to_EnumConst'>STARTUP_COST</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Found a cheap (or even-cheaper) sorted path */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1112"><span class='Ref_To_Local'>innerpath</span></a> <span class='Operator'>!= </span><a href="joinpath.c.html#LN1001"><span class='Ref_To_Local'>cheapest_total_inner</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* 
                 * Avoid rebuilding clause list if we already made one; saves 
                 * memory in big join trees... 
                 */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1113"><span class='Ref_To_Local'>newclauses</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1004"><span class='Ref_To_Local'>sortkeycnt</span></a> <span class='Operator'>&LT; </span><a href="joinpath.c.html#LN1003"><span class='Ref_To_Local'>num_sortkeys</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <a href="joinpath.c.html#LN1113"><span class='Ref_To_Local'>newclauses</span></a> <span class='Operator'>= 
</span>                            <a href="../../../include/optimizer/paths.h.html#LN212"><span class='Ref_to_Proto'>find_mergeclauses_for_pathkeys</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN986"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                           <a href="joinpath.c.html#LN999"><span class='Ref_To_Local'>trialsortkeys</span></a><span class='Delimiter'>, 
</span>                                                           <span class='Boolean'>false</span><span class='Delimiter'>, 
</span>                                                           <a href="joinpath.c.html#LN997"><span class='Ref_To_Local'>mergeclauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1113"><span class='Ref_To_Local'>newclauses</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    <span class='Control'>else</span> 
                        <a href="joinpath.c.html#LN1113"><span class='Ref_To_Local'>newclauses</span></a> <span class='Operator'>= </span><a href="joinpath.c.html#LN997"><span class='Ref_To_Local'>mergeclauses</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <a href="joinpath.c.html#LN466"><span class='Ref_to_Func'>try_mergejoin_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN986"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                   <a href="joinpath.c.html#LN987"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                                   <a href="joinpath.c.html#LN989"><span class='Ref_to_Parameter'>outerpath</span></a><span class='Delimiter'>, 
</span>                                   <a href="joinpath.c.html#LN1112"><span class='Ref_To_Local'>innerpath</span></a><span class='Delimiter'>, 
</span>                                   <a href="joinpath.c.html#LN994"><span class='Ref_to_Parameter'>merge_pathkeys</span></a><span class='Delimiter'>, 
</span>                                   <a href="joinpath.c.html#LN1113"><span class='Ref_To_Local'>newclauses</span></a><span class='Delimiter'>, 
</span>                                   <a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>, 
</span>                                   <a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>, 
</span>                                   <a href="joinpath.c.html#LN990"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                                   <a href="joinpath.c.html#LN991"><span class='Ref_to_Parameter'>extra</span></a><span class='Delimiter'>, 
</span>                                   <a href="joinpath.c.html#LN995"><span class='Ref_to_Parameter'>is_partial</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if innerpath!=cheapest_t... &raquo; </span> 
            <a href="joinpath.c.html#LN1000"><span class='Ref_To_Local'>cheapest_startup_inner</span></a> <span class='Operator'>= </span><a href="joinpath.c.html#LN1112"><span class='Ref_To_Local'>innerpath</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if innerpath!=NULL&&(che... &raquo; </span> 
 
        <span class='Comment_Multi_Line'>/* 
         * Don't consider truncated sortkeys if we need all clauses. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN992"><span class='Ref_to_Parameter'>useallclauses</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for sortkeycnt=num_sortke... &raquo; </span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end generate_mergejoin_paths &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * match_unsorted_outer 
 *    Creates possible join paths for processing a single join relation 
 *    'joinrel' by employing either iterative substitution or 
 *    mergejoining on each of its possible outer paths (considering 
 *    only outer paths that are already ordered well enough for merging). 
 * 
 * We always generate a nestloop path for each available outer path. 
 * In fact we may generate as many as five: one on the cheapest-total-cost 
 * inner path, one on the same with materialization, one on the 
 * cheapest-startup-cost inner path (if different), one on the 
 * cheapest-total inner-indexscan path (if any), and one on the 
 * cheapest-startup inner-indexscan path (if different). 
 * 
 * We also consider mergejoins if mergejoin clauses are available.  See 
 * detailed comments in generate_mergejoin_paths. 
 * 
 * 'joinrel' is the join relation 
 * 'outerrel' is the outer join relation 
 * 'innerrel' is the inner join relation 
 * 'jointype' is the type of join to do 
 * 'extra' contains additional input values 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN1236"></a><span class='Declare_Function'>match_unsorted_outer</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN1237"></a>                     <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN1238"></a>                     <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outerrel</span><span class='Delimiter'>, 
</span><a name="LN1239"></a>                     <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>innerrel</span><span class='Delimiter'>, 
</span><a name="LN1240"></a>                     <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, 
</span><a name="LN1241"></a>                     <a href="../../../include/nodes/relation.h.html#LN2177"><span class='Ref_to_Struct'>JoinPathExtraData</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>extra</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1243"></a>    <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a>    <span class='Declare_Local'>save_jointype</span> <span class='Operator'>= </span><a href="joinpath.c.html#LN1240"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>; 
</span><a name="LN1244"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>nestjoinOK</span><span class='Delimiter'>; 
</span><a name="LN1245"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>useallclauses</span><span class='Delimiter'>; 
</span><a name="LN1246"></a>    <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>inner_cheapest_total</span> <span class='Operator'>= </span><a href="joinpath.c.html#LN1239"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN542"><span class='Ref_to_Member'>cheapest_total_path</span></a><span class='Delimiter'>; 
</span><a name="LN1247"></a>    <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>matpath</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN1248"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc1</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Nestloop only supports inner, left, semi, and anti joins.  Also, if we 
     * are doing a right or full mergejoin, we must use *all* the mergeclauses 
     * as join clauses, else we will not have a valid plan.  (Although these 
     * two flags are currently inverses, keep them separate for clarity and 
     * possible future changes.) 
     */ 
</span>    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1240"><span class='Ref_to_Parameter'>jointype</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN677"><span class='Ref_to_EnumConst'>JOIN_INNER</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN678"><span class='Ref_to_EnumConst'>JOIN_LEFT</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN691"><span class='Ref_to_EnumConst'>JOIN_SEMI</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN692"><span class='Ref_to_EnumConst'>JOIN_ANTI</span></a><span class='Operator'>: 
</span>            <a href="joinpath.c.html#LN1244"><span class='Ref_To_Local'>nestjoinOK</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <a href="joinpath.c.html#LN1245"><span class='Ref_To_Local'>useallclauses</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN680"><span class='Ref_to_EnumConst'>JOIN_RIGHT</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN679"><span class='Ref_to_EnumConst'>JOIN_FULL</span></a><span class='Operator'>: 
</span>            <a href="joinpath.c.html#LN1244"><span class='Ref_To_Local'>nestjoinOK</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <a href="joinpath.c.html#LN1245"><span class='Ref_To_Local'>useallclauses</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN698"><span class='Ref_to_EnumConst'>JOIN_UNIQUE_OUTER</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN699"><span class='Ref_to_EnumConst'>JOIN_UNIQUE_INNER</span></a><span class='Operator'>: 
</span>            <a href="joinpath.c.html#LN1240"><span class='Ref_to_Parameter'>jointype</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN677"><span class='Ref_to_EnumConst'>JOIN_INNER</span></a><span class='Delimiter'>; 
</span>            <a href="joinpath.c.html#LN1244"><span class='Ref_To_Local'>nestjoinOK</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <a href="joinpath.c.html#LN1245"><span class='Ref_To_Local'>useallclauses</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized join type: %d"</span><span class='Delimiter'>, 
</span>                 <span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="joinpath.c.html#LN1240"><span class='Ref_to_Parameter'>jointype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="joinpath.c.html#LN1244"><span class='Ref_To_Local'>nestjoinOK</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; </span><span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span>            <a href="joinpath.c.html#LN1245"><span class='Ref_To_Local'>useallclauses</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch jointype &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* 
     * If inner_cheapest_total is parameterized by the outer rel, ignore it; 
     * we will consider it below as a member of cheapest_parameterized_paths, 
     * but the other possibilities considered in this routine aren't usable. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN28"><span class='Ref_to_Macro'>PATH_PARAM_BY_REL</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1246"><span class='Ref_To_Local'>inner_cheapest_total</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1238"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Parentheses'>))</span> 
        <a href="joinpath.c.html#LN1246"><span class='Ref_To_Local'>inner_cheapest_total</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If we need to unique-ify the inner path, we will consider only the 
     * cheapest-total inner. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1243"><span class='Ref_To_Local'>save_jointype</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/nodes.h.html#LN699"><span class='Ref_to_EnumConst'>JOIN_UNIQUE_INNER</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* No way to do this with an inner path parameterized by outer rel */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1246"><span class='Ref_To_Local'>inner_cheapest_total</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span><span class='Delimiter'>; 
</span>        <a href="joinpath.c.html#LN1246"><span class='Ref_To_Local'>inner_cheapest_total</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="../../../include/optimizer/pathnode.h.html#LN77"><span class='Ref_to_Proto'>create_unique_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1236"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1239"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1246"><span class='Ref_To_Local'>inner_cheapest_total</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1241"><span class='Ref_to_Parameter'>extra</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2182"><span class='Ref_to_Member'>sjinfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1246"><span class='Ref_To_Local'>inner_cheapest_total</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1244"><span class='Ref_To_Local'>nestjoinOK</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Consider materializing the cheapest inner path, unless 
         * enable_material is off or the path in question materializes its 
         * output anyway. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="costsize.c.html#LN125"><span class='Ref_to_Global_Var'>enable_material</span></a> <span class='Operator'>&& </span><a href="joinpath.c.html#LN1246"><span class='Ref_To_Local'>inner_cheapest_total</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& 
</span>            <span class='Operator'>!</span><a href="../../../include/executor/executor.h.html#LN101"><span class='Ref_to_Proto'>ExecMaterializesOutput</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1246"><span class='Ref_To_Local'>inner_cheapest_total</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN950"><span class='Ref_to_Member'>pathtype</span></a><span class='Parentheses'>))</span> 
            <a href="joinpath.c.html#LN1247"><span class='Ref_To_Local'>matpath</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>                <a href="../../../include/optimizer/pathnode.h.html#LN76"><span class='Ref_to_Proto'>create_material_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1239"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1246"><span class='Ref_To_Local'>inner_cheapest_total</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1248"><span class='Ref_To_Local'>lc1</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1238"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN538"><span class='Ref_to_Member'>pathlist</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1321"></a>        <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>outerpath</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1248"><span class='Ref_To_Local'>lc1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1322"></a>        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>merge_pathkeys</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * We cannot use an outer path that is parameterized by the inner rel. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN28"><span class='Ref_to_Macro'>PATH_PARAM_BY_REL</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1321"><span class='Ref_To_Local'>outerpath</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1239"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If we need to unique-ify the outer path, it's pointless to consider 
         * any but the cheapest outer.  (XXX we don't consider parameterized 
         * outers, nor inners, for unique-ified cases.  Should we?) 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1243"><span class='Ref_To_Local'>save_jointype</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/nodes.h.html#LN698"><span class='Ref_to_EnumConst'>JOIN_UNIQUE_OUTER</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1321"><span class='Ref_To_Local'>outerpath</span></a> <span class='Operator'>!= </span><a href="joinpath.c.html#LN1238"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN542"><span class='Ref_to_Member'>cheapest_total_path</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>; 
</span>            <a href="joinpath.c.html#LN1321"><span class='Ref_To_Local'>outerpath</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/optimizer/pathnode.h.html#LN77"><span class='Ref_to_Proto'>create_unique_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1236"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1238"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Delimiter'>, 
</span>                                                    <a href="joinpath.c.html#LN1321"><span class='Ref_To_Local'>outerpath</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1241"><span class='Ref_to_Parameter'>extra</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2182"><span class='Ref_to_Member'>sjinfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1321"><span class='Ref_To_Local'>outerpath</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * The result will have this sort order (even if it is implemented as 
         * a nestloop, and even if some of the mergeclauses are implemented by 
         * qpquals rather than as true mergeclauses): 
         */ 
</span>        <a href="joinpath.c.html#LN1322"><span class='Ref_To_Local'>merge_pathkeys</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/paths.h.html#LN201"><span class='Ref_to_Proto'>build_join_pathkeys</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1236"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1237"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1240"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                                             <a href="joinpath.c.html#LN1321"><span class='Ref_To_Local'>outerpath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN967"><span class='Ref_to_Member'>pathkeys</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1243"><span class='Ref_To_Local'>save_jointype</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/nodes.h.html#LN699"><span class='Ref_to_EnumConst'>JOIN_UNIQUE_INNER</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * Consider nestloop join, but only with the unique-ified cheapest 
             * inner path 
             */ 
</span>            <a href="joinpath.c.html#LN339"><span class='Ref_to_Func'>try_nestloop_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1236"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                              <a href="joinpath.c.html#LN1237"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                              <a href="joinpath.c.html#LN1321"><span class='Ref_To_Local'>outerpath</span></a><span class='Delimiter'>, 
</span>                              <a href="joinpath.c.html#LN1246"><span class='Ref_To_Local'>inner_cheapest_total</span></a><span class='Delimiter'>, 
</span>                              <a href="joinpath.c.html#LN1322"><span class='Ref_To_Local'>merge_pathkeys</span></a><span class='Delimiter'>, 
</span>                              <a href="joinpath.c.html#LN1240"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                              <a href="joinpath.c.html#LN1241"><span class='Ref_to_Parameter'>extra</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1244"><span class='Ref_To_Local'>nestjoinOK</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * Consider nestloop joins using this outer path and various 
             * available paths for the inner relation.  We consider the 
             * cheapest-total paths for each available parameterization of the 
             * inner relation, including the unparameterized case. 
             */ 
</span><a name="LN1374"></a>            <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc2</span><span class='Delimiter'>; 
</span> 
            <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1374"><span class='Ref_To_Local'>lc2</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1239"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN544"><span class='Ref_to_Member'>cheapest_parameterized_paths</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN1378"></a>                <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>innerpath</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1374"><span class='Ref_To_Local'>lc2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <a href="joinpath.c.html#LN339"><span class='Ref_to_Func'>try_nestloop_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1236"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                  <a href="joinpath.c.html#LN1237"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                                  <a href="joinpath.c.html#LN1321"><span class='Ref_To_Local'>outerpath</span></a><span class='Delimiter'>, 
</span>                                  <a href="joinpath.c.html#LN1378"><span class='Ref_To_Local'>innerpath</span></a><span class='Delimiter'>, 
</span>                                  <a href="joinpath.c.html#LN1322"><span class='Ref_To_Local'>merge_pathkeys</span></a><span class='Delimiter'>, 
</span>                                  <a href="joinpath.c.html#LN1240"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                                  <a href="joinpath.c.html#LN1241"><span class='Ref_to_Parameter'>extra</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Comment_Multi_Line'>/* Also consider materialized form of the cheapest inner path */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1247"><span class='Ref_To_Local'>matpath</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                <a href="joinpath.c.html#LN339"><span class='Ref_to_Func'>try_nestloop_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1236"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                  <a href="joinpath.c.html#LN1237"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                                  <a href="joinpath.c.html#LN1321"><span class='Ref_To_Local'>outerpath</span></a><span class='Delimiter'>, 
</span>                                  <a href="joinpath.c.html#LN1247"><span class='Ref_To_Local'>matpath</span></a><span class='Delimiter'>, 
</span>                                  <a href="joinpath.c.html#LN1322"><span class='Ref_To_Local'>merge_pathkeys</span></a><span class='Delimiter'>, 
</span>                                  <a href="joinpath.c.html#LN1240"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                                  <a href="joinpath.c.html#LN1241"><span class='Ref_to_Parameter'>extra</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if nestjoinOK &raquo; </span> 
 
        <span class='Comment_Multi_Line'>/* Can't do anything else if outer path needs to be unique'd */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1243"><span class='Ref_To_Local'>save_jointype</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/nodes.h.html#LN698"><span class='Ref_to_EnumConst'>JOIN_UNIQUE_OUTER</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Can't do anything else if inner rel is parameterized by outer */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1246"><span class='Ref_To_Local'>inner_cheapest_total</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Generate merge join paths */ 
</span>        <a href="joinpath.c.html#LN70"><span class='Ref_to_Proto'>generate_mergejoin_paths</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1236"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1237"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1239"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1321"><span class='Ref_To_Local'>outerpath</span></a><span class='Delimiter'>, 
</span>                                 <a href="joinpath.c.html#LN1243"><span class='Ref_To_Local'>save_jointype</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1241"><span class='Ref_to_Parameter'>extra</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1245"><span class='Ref_To_Local'>useallclauses</span></a><span class='Delimiter'>, 
</span>                                 <a href="joinpath.c.html#LN1246"><span class='Ref_To_Local'>inner_cheapest_total</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1322"><span class='Ref_To_Local'>merge_pathkeys</span></a><span class='Delimiter'>, 
</span>                                 <span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Consider partial nestloop and mergejoin plan if outerrel has any 
     * partial path and the joinrel is parallel-safe.  However, we can't 
     * handle JOIN_UNIQUE_OUTER, because the outer path will be partial, and 
     * therefore we won't be able to properly guarantee uniqueness.  Nor can 
     * we handle extra_lateral_rels, since partial paths must not be 
     * parameterized. Similarly, we can't handle JOIN_FULL and JOIN_RIGHT, 
     * because they can produce false null extended rows. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1237"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN532"><span class='Ref_to_Member'>consider_parallel</span></a> <span class='Operator'>&& 
</span>        <a href="joinpath.c.html#LN1243"><span class='Ref_To_Local'>save_jointype</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/nodes.h.html#LN698"><span class='Ref_to_EnumConst'>JOIN_UNIQUE_OUTER</span></a> <span class='Operator'>&& 
</span>        <a href="joinpath.c.html#LN1243"><span class='Ref_To_Local'>save_jointype</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/nodes.h.html#LN679"><span class='Ref_to_EnumConst'>JOIN_FULL</span></a> <span class='Operator'>&& 
</span>        <a href="joinpath.c.html#LN1243"><span class='Ref_To_Local'>save_jointype</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/nodes.h.html#LN680"><span class='Ref_to_EnumConst'>JOIN_RIGHT</span></a> <span class='Operator'>&& 
</span>        <a href="joinpath.c.html#LN1238"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN540"><span class='Ref_to_Member'>partial_pathlist</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a> <span class='Operator'>&& 
</span>        <a href="../../../include/nodes/bitmapset.h.html#LN85"><span class='Ref_to_Proto'>bms_is_empty</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1237"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN549"><span class='Ref_to_Member'>lateral_relids</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1244"><span class='Ref_To_Local'>nestjoinOK</span></a><span class='Parentheses'>) 
</span>            <a href="joinpath.c.html#LN47"><span class='Ref_to_Proto'>consider_parallel_nestloop</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1236"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1237"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1238"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1239"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Delimiter'>, 
</span>                                       <a href="joinpath.c.html#LN1243"><span class='Ref_To_Local'>save_jointype</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1241"><span class='Ref_to_Parameter'>extra</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If inner_cheapest_total is NULL or non parallel-safe then find the 
         * cheapest total parallel safe path.  If doing JOIN_UNIQUE_INNER, we 
         * can't use any alternative inner path. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1246"><span class='Ref_To_Local'>inner_cheapest_total</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| 
</span>            <span class='Operator'>!</span><a href="joinpath.c.html#LN1246"><span class='Ref_To_Local'>inner_cheapest_total</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN958"><span class='Ref_to_Member'>parallel_safe</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1243"><span class='Ref_To_Local'>save_jointype</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/nodes.h.html#LN699"><span class='Ref_to_EnumConst'>JOIN_UNIQUE_INNER</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
            <a href="joinpath.c.html#LN1246"><span class='Ref_To_Local'>inner_cheapest_total</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/paths.h.html#LN192"><span class='Ref_to_Proto'>get_cheapest_parallel_safe_total_inner</span></a><span class='Parentheses'>( 
</span>                                                         <a href="joinpath.c.html#LN1239"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN538"><span class='Ref_to_Member'>pathlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1246"><span class='Ref_To_Local'>inner_cheapest_total</span></a><span class='Parentheses'>) 
</span>            <a href="joinpath.c.html#LN53"><span class='Ref_to_Proto'>consider_parallel_mergejoin</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1236"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1237"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1238"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1239"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Delimiter'>, 
</span>                                        <a href="joinpath.c.html#LN1243"><span class='Ref_To_Local'>save_jointype</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1241"><span class='Ref_to_Parameter'>extra</span></a><span class='Delimiter'>, 
</span>                                        <a href="joinpath.c.html#LN1246"><span class='Ref_To_Local'>inner_cheapest_total</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if joinrel-&GT;consider_par... &raquo; </span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end match_unsorted_outer &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * consider_parallel_mergejoin 
 *    Try to build partial paths for a joinrel by joining a partial path 
 *    for the outer relation to a complete path for the inner relation. 
 * 
 * 'joinrel' is the join relation 
 * 'outerrel' is the outer join relation 
 * 'innerrel' is the inner join relation 
 * 'jointype' is the type of join to do 
 * 'extra' contains additional input values 
 * 'inner_cheapest_total' cheapest total path for innerrel 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN1470"></a><span class='Declare_Function'>consider_parallel_mergejoin</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN1471"></a>                            <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN1472"></a>                            <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outerrel</span><span class='Delimiter'>, 
</span><a name="LN1473"></a>                            <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>innerrel</span><span class='Delimiter'>, 
</span><a name="LN1474"></a>                            <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, 
</span><a name="LN1475"></a>                            <a href="../../../include/nodes/relation.h.html#LN2177"><span class='Ref_to_Struct'>JoinPathExtraData</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>extra</span><span class='Delimiter'>, 
</span><a name="LN1476"></a>                            <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>inner_cheapest_total</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1478"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc1</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* generate merge join path for each partial outer path */ 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1478"><span class='Ref_To_Local'>lc1</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1472"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN540"><span class='Ref_to_Member'>partial_pathlist</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1483"></a>        <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>outerpath</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1478"><span class='Ref_To_Local'>lc1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1484"></a>        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>merge_pathkeys</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Figure out what useful ordering any paths we create will have. 
         */ 
</span>        <a href="joinpath.c.html#LN1484"><span class='Ref_To_Local'>merge_pathkeys</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/paths.h.html#LN201"><span class='Ref_to_Proto'>build_join_pathkeys</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1470"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1471"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1474"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                                             <a href="joinpath.c.html#LN1483"><span class='Ref_To_Local'>outerpath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN967"><span class='Ref_to_Member'>pathkeys</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="joinpath.c.html#LN70"><span class='Ref_to_Proto'>generate_mergejoin_paths</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1470"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1471"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1473"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1483"><span class='Ref_To_Local'>outerpath</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1474"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                                 <a href="joinpath.c.html#LN1475"><span class='Ref_to_Parameter'>extra</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1476"><span class='Ref_to_Parameter'>inner_cheapest_total</span></a><span class='Delimiter'>, 
</span>                                 <a href="joinpath.c.html#LN1484"><span class='Ref_To_Local'>merge_pathkeys</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end consider_parallel_mergejoin &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * consider_parallel_nestloop 
 *    Try to build partial paths for a joinrel by joining a partial path for the 
 *    outer relation to a complete path for the inner relation. 
 * 
 * 'joinrel' is the join relation 
 * 'outerrel' is the outer join relation 
 * 'innerrel' is the inner join relation 
 * 'jointype' is the type of join to do 
 * 'extra' contains additional input values 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN1510"></a><span class='Declare_Function'>consider_parallel_nestloop</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN1511"></a>                           <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN1512"></a>                           <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outerrel</span><span class='Delimiter'>, 
</span><a name="LN1513"></a>                           <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>innerrel</span><span class='Delimiter'>, 
</span><a name="LN1514"></a>                           <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, 
</span><a name="LN1515"></a>                           <a href="../../../include/nodes/relation.h.html#LN2177"><span class='Ref_to_Struct'>JoinPathExtraData</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>extra</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1517"></a>    <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a>    <span class='Declare_Local'>save_jointype</span> <span class='Operator'>= </span><a href="joinpath.c.html#LN1514"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>; 
</span><a name="LN1518"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1514"><span class='Ref_to_Parameter'>jointype</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/nodes.h.html#LN699"><span class='Ref_to_EnumConst'>JOIN_UNIQUE_INNER</span></a><span class='Parentheses'>) 
</span>        <a href="joinpath.c.html#LN1514"><span class='Ref_to_Parameter'>jointype</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN677"><span class='Ref_to_EnumConst'>JOIN_INNER</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1518"><span class='Ref_To_Local'>lc1</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1512"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN540"><span class='Ref_to_Member'>partial_pathlist</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1525"></a>        <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>outerpath</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1518"><span class='Ref_To_Local'>lc1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1526"></a>        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>pathkeys</span><span class='Delimiter'>; 
</span><a name="LN1527"></a>        <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc2</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Figure out what useful ordering any paths we create will have. */ 
</span>        <a href="joinpath.c.html#LN1526"><span class='Ref_To_Local'>pathkeys</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/paths.h.html#LN201"><span class='Ref_to_Proto'>build_join_pathkeys</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1510"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1511"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1514"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                                       <a href="joinpath.c.html#LN1525"><span class='Ref_To_Local'>outerpath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN967"><span class='Ref_to_Member'>pathkeys</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Try the cheapest parameterized paths; only those which will produce 
         * an unparameterized path when joined to this outerrel will survive 
         * try_partial_nestloop_path.  The cheapest unparameterized path is 
         * also in this list. 
         */ 
</span>        <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1527"><span class='Ref_To_Local'>lc2</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1513"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN544"><span class='Ref_to_Member'>cheapest_parameterized_paths</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN1541"></a>            <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>innerpath</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1527"><span class='Ref_To_Local'>lc2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Can't join to an inner path that is not parallel-safe */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="joinpath.c.html#LN1541"><span class='Ref_To_Local'>innerpath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN958"><span class='Ref_to_Member'>parallel_safe</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * If we're doing JOIN_UNIQUE_INNER, we can only use the inner's 
             * cheapest_total_path, and we have to unique-ify it.  (We might 
             * be able to relax this to allow other safe, unparameterized 
             * inner paths, but right now create_unique_path is not on board 
             * with that.) 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1517"><span class='Ref_To_Local'>save_jointype</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/nodes.h.html#LN699"><span class='Ref_to_EnumConst'>JOIN_UNIQUE_INNER</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1541"><span class='Ref_To_Local'>innerpath</span></a> <span class='Operator'>!= </span><a href="joinpath.c.html#LN1513"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN542"><span class='Ref_to_Member'>cheapest_total_path</span></a><span class='Parentheses'>) 
</span>                    <span class='Control'>continue</span><span class='Delimiter'>; 
</span>                <a href="joinpath.c.html#LN1541"><span class='Ref_To_Local'>innerpath</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/optimizer/pathnode.h.html#LN77"><span class='Ref_to_Proto'>create_unique_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1510"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1513"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Delimiter'>, 
</span>                                                        <a href="joinpath.c.html#LN1541"><span class='Ref_To_Local'>innerpath</span></a><span class='Delimiter'>, 
</span>                                                        <a href="joinpath.c.html#LN1515"><span class='Ref_to_Parameter'>extra</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2182"><span class='Ref_to_Member'>sjinfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1541"><span class='Ref_To_Local'>innerpath</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <a href="joinpath.c.html#LN412"><span class='Ref_to_Func'>try_partial_nestloop_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1510"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1511"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1525"><span class='Ref_To_Local'>outerpath</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1541"><span class='Ref_To_Local'>innerpath</span></a><span class='Delimiter'>, 
</span>                                      <a href="joinpath.c.html#LN1526"><span class='Ref_To_Local'>pathkeys</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1514"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1515"><span class='Ref_to_Parameter'>extra</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end consider_parallel_nestloop &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * hash_inner_and_outer 
 *    Create hashjoin join paths by explicitly hashing both the outer and 
 *    inner keys of each available hash clause. 
 * 
 * 'joinrel' is the join relation 
 * 'outerrel' is the outer join relation 
 * 'innerrel' is the inner join relation 
 * 'jointype' is the type of join to do 
 * 'extra' contains additional input values 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN1582"></a><span class='Declare_Function'>hash_inner_and_outer</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN1583"></a>                     <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN1584"></a>                     <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outerrel</span><span class='Delimiter'>, 
</span><a name="LN1585"></a>                     <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>innerrel</span><span class='Delimiter'>, 
</span><a name="LN1586"></a>                     <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, 
</span><a name="LN1587"></a>                     <a href="../../../include/nodes/relation.h.html#LN2177"><span class='Ref_to_Struct'>JoinPathExtraData</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>extra</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1589"></a>    <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a>    <span class='Declare_Local'>save_jointype</span> <span class='Operator'>= </span><a href="joinpath.c.html#LN1586"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>; 
</span><a name="LN1590"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>isouterjoin</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN720"><span class='Ref_to_Macro'>IS_OUTER_JOIN</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1586"><span class='Ref_to_Parameter'>jointype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1591"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>hashclauses</span><span class='Delimiter'>; 
</span><a name="LN1592"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We need to build only one hashclauses list for any given pair of outer 
     * and inner relations; all of the hashable clauses will be used as keys. 
     * 
     * Scan the join's restrictinfo list to find hashjoinable clauses that are 
     * usable with this pair of sub-relations. 
     */ 
</span>    <a href="joinpath.c.html#LN1591"><span class='Ref_To_Local'>hashclauses</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1592"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1587"><span class='Ref_to_Parameter'>extra</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2179"><span class='Ref_to_Member'>restrictlist</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1604"></a>        <a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>restrictinfo</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1592"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If processing an outer join, only use its own join clauses for 
         * hashing.  For inner joins we need not be so picky. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1590"><span class='Ref_To_Local'>isouterjoin</span></a> <span class='Operator'>&& </span><a href="joinpath.c.html#LN1604"><span class='Ref_To_Local'>restrictinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1748"><span class='Ref_to_Member'>is_pushed_down</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="joinpath.c.html#LN1604"><span class='Ref_To_Local'>restrictinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1752"><span class='Ref_to_Member'>can_join</span></a> <span class='Operator'>|| 
</span>            <a href="joinpath.c.html#LN1604"><span class='Ref_To_Local'>restrictinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1804"><span class='Ref_to_Member'>hashjoinoperator</span></a> <span class='Operator'>== </span><a href="../../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* not hashjoinable */ 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Check if clause has the form "outer op inner" or "inner op outer". 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../plan/analyzejoins.c.html#LN125"><span class='Ref_to_Func'>clause_sides_match_join</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1604"><span class='Ref_To_Local'>restrictinfo</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1584"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1585"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>continue</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* no good for these input relations */ 
</span> 
        <a href="joinpath.c.html#LN1591"><span class='Ref_To_Local'>hashclauses</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1591"><span class='Ref_To_Local'>hashclauses</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1604"><span class='Ref_To_Local'>restrictinfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* If we found any usable hashclauses, make paths */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1591"><span class='Ref_To_Local'>hashclauses</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * We consider both the cheapest-total-cost and cheapest-startup-cost 
         * outer paths.  There's no need to consider any but the 
         * cheapest-total-cost inner path, however. 
         */ 
</span><a name="LN1634"></a>        <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>cheapest_startup_outer</span> <span class='Operator'>= </span><a href="joinpath.c.html#LN1584"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN541"><span class='Ref_to_Member'>cheapest_startup_path</span></a><span class='Delimiter'>; 
</span><a name="LN1635"></a>        <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>cheapest_total_outer</span> <span class='Operator'>= </span><a href="joinpath.c.html#LN1584"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN542"><span class='Ref_to_Member'>cheapest_total_path</span></a><span class='Delimiter'>; 
</span><a name="LN1636"></a>        <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>cheapest_total_inner</span> <span class='Operator'>= </span><a href="joinpath.c.html#LN1585"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN542"><span class='Ref_to_Member'>cheapest_total_path</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If either cheapest-total path is parameterized by the other rel, we 
         * can't use a hashjoin.  (There's no use looking for alternative 
         * input paths, since these should already be the least-parameterized 
         * available paths.) 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN28"><span class='Ref_to_Macro'>PATH_PARAM_BY_REL</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1635"><span class='Ref_To_Local'>cheapest_total_outer</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1585"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Parentheses'>) </span><span class='Operator'>|| 
</span>            <a href="joinpath.c.html#LN28"><span class='Ref_to_Macro'>PATH_PARAM_BY_REL</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1636"><span class='Ref_To_Local'>cheapest_total_inner</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1584"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Unique-ify if need be; we ignore parameterized possibilities */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1586"><span class='Ref_to_Parameter'>jointype</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/nodes.h.html#LN698"><span class='Ref_to_EnumConst'>JOIN_UNIQUE_OUTER</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="joinpath.c.html#LN1635"><span class='Ref_To_Local'>cheapest_total_outer</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>                <a href="../../../include/optimizer/pathnode.h.html#LN77"><span class='Ref_to_Proto'>create_unique_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1582"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1584"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Delimiter'>, 
</span>                                   <a href="joinpath.c.html#LN1635"><span class='Ref_To_Local'>cheapest_total_outer</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1587"><span class='Ref_to_Parameter'>extra</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2182"><span class='Ref_to_Member'>sjinfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1635"><span class='Ref_To_Local'>cheapest_total_outer</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="joinpath.c.html#LN1586"><span class='Ref_to_Parameter'>jointype</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN677"><span class='Ref_to_EnumConst'>JOIN_INNER</span></a><span class='Delimiter'>; 
</span>            <a href="joinpath.c.html#LN631"><span class='Ref_to_Func'>try_hashjoin_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1582"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                              <a href="joinpath.c.html#LN1583"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                              <a href="joinpath.c.html#LN1635"><span class='Ref_To_Local'>cheapest_total_outer</span></a><span class='Delimiter'>, 
</span>                              <a href="joinpath.c.html#LN1636"><span class='Ref_To_Local'>cheapest_total_inner</span></a><span class='Delimiter'>, 
</span>                              <a href="joinpath.c.html#LN1591"><span class='Ref_To_Local'>hashclauses</span></a><span class='Delimiter'>, 
</span>                              <a href="joinpath.c.html#LN1586"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                              <a href="joinpath.c.html#LN1587"><span class='Ref_to_Parameter'>extra</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* no possibility of cheap startup here */ 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1586"><span class='Ref_to_Parameter'>jointype</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/nodes.h.html#LN699"><span class='Ref_to_EnumConst'>JOIN_UNIQUE_INNER</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="joinpath.c.html#LN1636"><span class='Ref_To_Local'>cheapest_total_inner</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>                <a href="../../../include/optimizer/pathnode.h.html#LN77"><span class='Ref_to_Proto'>create_unique_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1582"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1585"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Delimiter'>, 
</span>                                   <a href="joinpath.c.html#LN1636"><span class='Ref_To_Local'>cheapest_total_inner</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1587"><span class='Ref_to_Parameter'>extra</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2182"><span class='Ref_to_Member'>sjinfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1636"><span class='Ref_To_Local'>cheapest_total_inner</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="joinpath.c.html#LN1586"><span class='Ref_to_Parameter'>jointype</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN677"><span class='Ref_to_EnumConst'>JOIN_INNER</span></a><span class='Delimiter'>; 
</span>            <a href="joinpath.c.html#LN631"><span class='Ref_to_Func'>try_hashjoin_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1582"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                              <a href="joinpath.c.html#LN1583"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                              <a href="joinpath.c.html#LN1635"><span class='Ref_To_Local'>cheapest_total_outer</span></a><span class='Delimiter'>, 
</span>                              <a href="joinpath.c.html#LN1636"><span class='Ref_To_Local'>cheapest_total_inner</span></a><span class='Delimiter'>, 
</span>                              <a href="joinpath.c.html#LN1591"><span class='Ref_To_Local'>hashclauses</span></a><span class='Delimiter'>, 
</span>                              <a href="joinpath.c.html#LN1586"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                              <a href="joinpath.c.html#LN1587"><span class='Ref_to_Parameter'>extra</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1634"><span class='Ref_To_Local'>cheapest_startup_outer</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& 
</span>                <a href="joinpath.c.html#LN1634"><span class='Ref_To_Local'>cheapest_startup_outer</span></a> <span class='Operator'>!= </span><a href="joinpath.c.html#LN1635"><span class='Ref_To_Local'>cheapest_total_outer</span></a><span class='Parentheses'>) 
</span>                <a href="joinpath.c.html#LN631"><span class='Ref_to_Func'>try_hashjoin_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1582"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                  <a href="joinpath.c.html#LN1583"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                                  <a href="joinpath.c.html#LN1634"><span class='Ref_To_Local'>cheapest_startup_outer</span></a><span class='Delimiter'>, 
</span>                                  <a href="joinpath.c.html#LN1636"><span class='Ref_To_Local'>cheapest_total_inner</span></a><span class='Delimiter'>, 
</span>                                  <a href="joinpath.c.html#LN1591"><span class='Ref_To_Local'>hashclauses</span></a><span class='Delimiter'>, 
</span>                                  <a href="joinpath.c.html#LN1586"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                                  <a href="joinpath.c.html#LN1587"><span class='Ref_to_Parameter'>extra</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if jointype==JOIN_UNIQUE... &raquo; </span> 
        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * For other jointypes, we consider the cheapest startup outer 
             * together with the cheapest total inner, and then consider 
             * pairings of cheapest-total paths including parameterized ones. 
             * There is no use in generating parameterized paths on the basis 
             * of possibly cheap startup cost, so this is sufficient. 
             */ 
</span><a name="LN1698"></a>            <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc1</span><span class='Delimiter'>; 
</span><a name="LN1699"></a>            <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc2</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1634"><span class='Ref_To_Local'>cheapest_startup_outer</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                <a href="joinpath.c.html#LN631"><span class='Ref_to_Func'>try_hashjoin_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1582"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                  <a href="joinpath.c.html#LN1583"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                                  <a href="joinpath.c.html#LN1634"><span class='Ref_To_Local'>cheapest_startup_outer</span></a><span class='Delimiter'>, 
</span>                                  <a href="joinpath.c.html#LN1636"><span class='Ref_To_Local'>cheapest_total_inner</span></a><span class='Delimiter'>, 
</span>                                  <a href="joinpath.c.html#LN1591"><span class='Ref_To_Local'>hashclauses</span></a><span class='Delimiter'>, 
</span>                                  <a href="joinpath.c.html#LN1586"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                                  <a href="joinpath.c.html#LN1587"><span class='Ref_to_Parameter'>extra</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1698"><span class='Ref_To_Local'>lc1</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1584"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN544"><span class='Ref_to_Member'>cheapest_parameterized_paths</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN1712"></a>                <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>outerpath</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1698"><span class='Ref_To_Local'>lc1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* 
                 * We cannot use an outer path that is parameterized by the 
                 * inner rel. 
                 */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN28"><span class='Ref_to_Macro'>PATH_PARAM_BY_REL</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1712"><span class='Ref_To_Local'>outerpath</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1585"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Parentheses'>))</span> 
                    <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
                <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1699"><span class='Ref_To_Local'>lc2</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1585"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN544"><span class='Ref_to_Member'>cheapest_parameterized_paths</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span><a name="LN1723"></a>                    <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>innerpath</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1699"><span class='Ref_To_Local'>lc2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * We cannot use an inner path that is parameterized by 
                     * the outer rel, either. 
                     */ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN28"><span class='Ref_to_Macro'>PATH_PARAM_BY_REL</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1723"><span class='Ref_To_Local'>innerpath</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1584"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Parentheses'>))</span> 
                        <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1712"><span class='Ref_To_Local'>outerpath</span></a> <span class='Operator'>== </span><a href="joinpath.c.html#LN1634"><span class='Ref_To_Local'>cheapest_startup_outer</span></a> <span class='Operator'>&& 
</span>                        <a href="joinpath.c.html#LN1723"><span class='Ref_To_Local'>innerpath</span></a> <span class='Operator'>== </span><a href="joinpath.c.html#LN1636"><span class='Ref_To_Local'>cheapest_total_inner</span></a><span class='Parentheses'>) 
</span>                        <span class='Control'>continue</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* already tried it */ 
</span> 
                    <a href="joinpath.c.html#LN631"><span class='Ref_to_Func'>try_hashjoin_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1582"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                      <a href="joinpath.c.html#LN1583"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                                      <a href="joinpath.c.html#LN1712"><span class='Ref_To_Local'>outerpath</span></a><span class='Delimiter'>, 
</span>                                      <a href="joinpath.c.html#LN1723"><span class='Ref_To_Local'>innerpath</span></a><span class='Delimiter'>, 
</span>                                      <a href="joinpath.c.html#LN1591"><span class='Ref_To_Local'>hashclauses</span></a><span class='Delimiter'>, 
</span>                                      <a href="joinpath.c.html#LN1586"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, 
</span>                                      <a href="joinpath.c.html#LN1587"><span class='Ref_to_Parameter'>extra</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
        <span class='Comment_Multi_Line'>/* 
         * If the joinrel is parallel-safe, we may be able to consider a 
         * partial hash join.  However, we can't handle JOIN_UNIQUE_OUTER, 
         * because the outer path will be partial, and therefore we won't be 
         * able to properly guarantee uniqueness.  Similarly, we can't handle 
         * JOIN_FULL and JOIN_RIGHT, because they can produce false null 
         * extended rows.  Also, the resulting path must not be parameterized. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1583"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN532"><span class='Ref_to_Member'>consider_parallel</span></a> <span class='Operator'>&& 
</span>            <a href="joinpath.c.html#LN1589"><span class='Ref_To_Local'>save_jointype</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/nodes.h.html#LN698"><span class='Ref_to_EnumConst'>JOIN_UNIQUE_OUTER</span></a> <span class='Operator'>&& 
</span>            <a href="joinpath.c.html#LN1589"><span class='Ref_To_Local'>save_jointype</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/nodes.h.html#LN679"><span class='Ref_to_EnumConst'>JOIN_FULL</span></a> <span class='Operator'>&& 
</span>            <a href="joinpath.c.html#LN1589"><span class='Ref_To_Local'>save_jointype</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/nodes.h.html#LN680"><span class='Ref_to_EnumConst'>JOIN_RIGHT</span></a> <span class='Operator'>&& 
</span>            <a href="joinpath.c.html#LN1584"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN540"><span class='Ref_to_Member'>partial_pathlist</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a> <span class='Operator'>&& 
</span>            <a href="../../../include/nodes/bitmapset.h.html#LN85"><span class='Ref_to_Proto'>bms_is_empty</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1583"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN549"><span class='Ref_to_Member'>lateral_relids</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN1762"></a>            <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>cheapest_partial_outer</span><span class='Delimiter'>; 
</span><a name="LN1763"></a>            <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>cheapest_safe_inner</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
            <a href="joinpath.c.html#LN1762"><span class='Ref_To_Local'>cheapest_partial_outer</span></a> <span class='Operator'>= 
</span>                <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1584"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN540"><span class='Ref_to_Member'>partial_pathlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Normally, given that the joinrel is parallel-safe, the cheapest 
             * total inner path will also be parallel-safe, but if not, we'll 
             * have to search for the cheapest safe, unparameterized inner 
             * path.  If doing JOIN_UNIQUE_INNER, we can't use any alternative 
             * inner path. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1636"><span class='Ref_To_Local'>cheapest_total_inner</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN958"><span class='Ref_to_Member'>parallel_safe</span></a><span class='Parentheses'>) 
</span>                <a href="joinpath.c.html#LN1763"><span class='Ref_To_Local'>cheapest_safe_inner</span></a> <span class='Operator'>= </span><a href="joinpath.c.html#LN1636"><span class='Ref_To_Local'>cheapest_total_inner</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1589"><span class='Ref_To_Local'>save_jointype</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/nodes.h.html#LN699"><span class='Ref_to_EnumConst'>JOIN_UNIQUE_INNER</span></a><span class='Parentheses'>) 
</span>                <a href="joinpath.c.html#LN1763"><span class='Ref_To_Local'>cheapest_safe_inner</span></a> <span class='Operator'>= 
</span>                    <a href="../../../include/optimizer/paths.h.html#LN192"><span class='Ref_to_Proto'>get_cheapest_parallel_safe_total_inner</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1585"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN538"><span class='Ref_to_Member'>pathlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1763"><span class='Ref_To_Local'>cheapest_safe_inner</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                <a href="joinpath.c.html#LN692"><span class='Ref_to_Func'>try_partial_hashjoin_path</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1582"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1583"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                                          <a href="joinpath.c.html#LN1762"><span class='Ref_To_Local'>cheapest_partial_outer</span></a><span class='Delimiter'>, 
</span>                                          <a href="joinpath.c.html#LN1763"><span class='Ref_To_Local'>cheapest_safe_inner</span></a><span class='Delimiter'>, 
</span>                                          <a href="joinpath.c.html#LN1591"><span class='Ref_To_Local'>hashclauses</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1586"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1587"><span class='Ref_to_Parameter'>extra</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if joinrel-&GT;consider_par... &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if hashclauses &raquo; </span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end hash_inner_and_outer &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * select_mergejoin_clauses 
 *    Select mergejoin clauses that are usable for a particular join. 
 *    Returns a list of RestrictInfo nodes for those clauses. 
 * 
 * *mergejoin_allowed is normally set to TRUE, but it is set to FALSE if 
 * this is a right/full join and there are nonmergejoinable join clauses. 
 * The executor's mergejoin machinery cannot handle such cases, so we have 
 * to avoid generating a mergejoin plan.  (Note that this flag does NOT 
 * consider whether there are actually any mergejoinable clauses.  This is 
 * correct because in some cases we need to build a clauseless mergejoin. 
 * Simply returning NIL is therefore not enough to distinguish safe from 
 * unsafe cases.) 
 * 
 * We also mark each selected RestrictInfo to show which side is currently 
 * being considered as outer.  These are transient markings that are only 
 * good for the duration of the current add_paths_to_joinrel() call! 
 * 
 * We examine each restrictinfo clause known for the join to see 
 * if it is mergejoinable and involves vars from the two sub-relations 
 * currently of interest. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>* 
</span><a name="LN1813"></a><span class='Declare_Function'>select_mergejoin_clauses</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN1814"></a>                         <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN1815"></a>                         <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outerrel</span><span class='Delimiter'>, 
</span><a name="LN1816"></a>                         <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>innerrel</span><span class='Delimiter'>, 
</span><a name="LN1817"></a>                         <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>restrictlist</span><span class='Delimiter'>, 
</span><a name="LN1818"></a>                         <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, 
</span><a name="LN1819"></a>                         <span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>mergejoin_allowed</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1821"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>result_list</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN1822"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>isouterjoin</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN720"><span class='Ref_to_Macro'>IS_OUTER_JOIN</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1818"><span class='Ref_to_Parameter'>jointype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1823"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>have_nonmergeable_joinclause</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN1824"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1824"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1817"><span class='Ref_to_Parameter'>restrictlist</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1828"></a>        <a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>restrictinfo</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1824"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If processing an outer join, only use its own join clauses in the 
         * merge.  For inner joins we can use pushed-down clauses too. (Note: 
         * we don't set have_nonmergeable_joinclause here because pushed-down 
         * clauses will become otherquals not joinquals.) 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1822"><span class='Ref_To_Local'>isouterjoin</span></a> <span class='Operator'>&& </span><a href="joinpath.c.html#LN1828"><span class='Ref_To_Local'>restrictinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1748"><span class='Ref_to_Member'>is_pushed_down</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Check that clause is a mergeable operator clause */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="joinpath.c.html#LN1828"><span class='Ref_To_Local'>restrictinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1752"><span class='Ref_to_Member'>can_join</span></a> <span class='Operator'>|| 
</span>            <a href="joinpath.c.html#LN1828"><span class='Ref_To_Local'>restrictinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1791"><span class='Ref_to_Member'>mergeopfamilies</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * The executor can handle extra joinquals that are constants, but 
             * not anything else, when doing right/full merge join.  (The 
             * reason to support constants is so we can do FULL JOIN ON 
             * FALSE.) 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="joinpath.c.html#LN1828"><span class='Ref_To_Local'>restrictinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1746"><span class='Ref_to_Member'>clause</span></a> <span class='Operator'>|| !</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1828"><span class='Ref_To_Local'>restrictinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1746"><span class='Ref_to_Member'>clause</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/primnodes.h.html#LN188"><span class='Ref_to_Struct'>Const</span></a><span class='Parentheses'>))</span> 
                <a href="joinpath.c.html#LN1823"><span class='Ref_To_Local'>have_nonmergeable_joinclause</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Control'>continue</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* not mergejoinable */ 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Check if clause has the form "outer op inner" or "inner op outer". 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../plan/analyzejoins.c.html#LN125"><span class='Ref_to_Func'>clause_sides_match_join</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1828"><span class='Ref_To_Local'>restrictinfo</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1815"><span class='Ref_to_Parameter'>outerrel</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1816"><span class='Ref_to_Parameter'>innerrel</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="joinpath.c.html#LN1823"><span class='Ref_To_Local'>have_nonmergeable_joinclause</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Control'>continue</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* no good for these input relations */ 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Insist that each side have a non-redundant eclass.  This 
         * restriction is needed because various bits of the planner expect 
         * that each clause in a merge be associable with some pathkey in a 
         * canonical pathkey list, but redundant eclasses can't appear in 
         * canonical sort orderings.  (XXX it might be worth relaxing this, 
         * but not enough time to address it for 8.3.) 
         * 
         * Note: it would be bad if this condition failed for an otherwise 
         * mergejoinable FULL JOIN clause, since that would result in 
         * undesirable planner failure.  I believe that is not possible 
         * however; a variable involved in a full join could only appear in 
         * below_outer_join eclasses, which aren't considered redundant. 
         * 
         * This case *can* happen for left/right join clauses: the outer-side 
         * variable could be equated to a constant.  Because we will propagate 
         * that constant across the join clause, the loss of ability to do a 
         * mergejoin is not really all that big a deal, and so it's not clear 
         * that improving this is important. 
         */ 
</span>        <a href="../../../include/optimizer/paths.h.html#LN210"><span class='Ref_to_Proto'>update_mergeclause_eclasses</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1813"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1828"><span class='Ref_To_Local'>restrictinfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN791"><span class='Ref_to_Macro'>EC_MUST_BE_REDUNDANT</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1828"><span class='Ref_To_Local'>restrictinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1794"><span class='Ref_to_Member'>left_ec</span></a><span class='Parentheses'>) </span><span class='Operator'>|| 
</span>            <a href="../../../include/nodes/relation.h.html#LN791"><span class='Ref_to_Macro'>EC_MUST_BE_REDUNDANT</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1828"><span class='Ref_To_Local'>restrictinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1795"><span class='Ref_to_Member'>right_ec</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="joinpath.c.html#LN1823"><span class='Ref_To_Local'>have_nonmergeable_joinclause</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Control'>continue</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* can't handle redundant eclasses */ 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="joinpath.c.html#LN1821"><span class='Ref_To_Local'>result_list</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="joinpath.c.html#LN1821"><span class='Ref_To_Local'>result_list</span></a><span class='Delimiter'>, </span><a href="joinpath.c.html#LN1828"><span class='Ref_To_Local'>restrictinfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Report whether mergejoin is allowed (see comment at top of function). 
     */ 
</span>    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="joinpath.c.html#LN1818"><span class='Ref_to_Parameter'>jointype</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN680"><span class='Ref_to_EnumConst'>JOIN_RIGHT</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN679"><span class='Ref_to_EnumConst'>JOIN_FULL</span></a><span class='Operator'>: 
</span>            <span class='Operator'>*</span><a href="joinpath.c.html#LN1819"><span class='Ref_to_Parameter'>mergejoin_allowed</span></a> <span class='Operator'>= !</span><a href="joinpath.c.html#LN1823"><span class='Ref_To_Local'>have_nonmergeable_joinclause</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <span class='Operator'>*</span><a href="joinpath.c.html#LN1819"><span class='Ref_to_Parameter'>mergejoin_allowed</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="joinpath.c.html#LN1821"><span class='Ref_To_Local'>result_list</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end select_mergejoin_clauses &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>