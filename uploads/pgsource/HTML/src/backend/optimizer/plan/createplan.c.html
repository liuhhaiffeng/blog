<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\backend\optimizer\plan\createplan.c</title>
<LINK REL=StyleSheet HREF="../../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\backend\optimizer\plan\createplan.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:42 2017
</td></tr>
<tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * createplan.c 
 *    Routines to create the desired plan for processing a query. 
 *    Planning is complete, we just need to convert the selected 
 *    Path into a Plan. 
 * 
 * Portions Copyright (c) 1996-2017, PostgreSQL Global Development Group 
 * Portions Copyright (c) 1994, Regents of the University of California 
 * 
 * 
 * IDENTIFICATION 
 *    src/backend/optimizer/plan/createplan.c 
 * 
 *------------------------------------------------------------------------- 
 */ 
</span><span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>&LT;limits.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;math.h&GT;</span> 
 
<span class='Keyword'>#include </span><span class='String'>"access/stratnum.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/sysattr.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_class.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"foreign/fdwapi.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"miscadmin.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"nodes/extensible.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"nodes/makefuncs.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"nodes/nodeFuncs.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/clauses.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/cost.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/paths.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/placeholder.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/plancat.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/planmain.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/planner.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/predtest.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/restrictinfo.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/subselect.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/tlist.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/var.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parse_clause.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parsetree.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/lsyscache.h"</span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * Flag bits that can appear in the flags argument of create_plan_recurse(). 
 * These can be OR-ed together. 
 * 
 * CP_EXACT_TLIST specifies that the generated plan node must return exactly 
 * the tlist specified by the path's pathtarget (this overrides both 
 * CP_SMALL_TLIST and CP_LABEL_TLIST, if those are set).  Otherwise, the 
 * plan node is allowed to return just the Vars and PlaceHolderVars needed 
 * to evaluate the pathtarget. 
 * 
 * CP_SMALL_TLIST specifies that a narrower tlist is preferred.  This is 
 * passed down by parent nodes such as Sort and Hash, which will have to 
 * store the returned tuples. 
 * 
 * CP_LABEL_TLIST specifies that the plan node must return columns matching 
 * any sortgrouprefs specified in its pathtarget, with appropriate 
 * ressortgroupref labels.  This is passed down by parent nodes such as Sort 
 * and Group, which need these values to be available in their inputs. 
 */ 
</span><a name="LN65"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>CP_EXACT_TLIST</span>      <span class='Number'>0x0001</span>      <span class='Comment_Single_Line'>/* Plan must return specified tlist */ 
</span><a name="LN66"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>CP_SMALL_TLIST</span>      <span class='Number'>0x0002</span>      <span class='Comment_Single_Line'>/* Prefer narrower tlists */ 
</span><a name="LN67"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>CP_LABEL_TLIST</span>      <span class='Number'>0x0004</span>      <span class='Comment_Single_Line'>/* tlist must contain sortgrouprefs */ 
</span> 
 
<a name="LN70"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_plan_recurse</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN71"></a>                    <span class='Keyword'>int </span><span class='Declare_Parameter'>flags</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN72"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_scan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN73"></a>                 <span class='Keyword'>int </span><span class='Declare_Parameter'>flags</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN74"></a><span class='Keyword'>static </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>build_path_tlist</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>path</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN75"></a><span class='Keyword'>static bool </span><span class='Declare_Prototype'>use_physical_tlist</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>path</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>flags</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN76"></a><span class='Keyword'>static </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>get_gating_quals</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>quals</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN77"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_gating_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>path</span><span class='Delimiter'>, </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>plan</span><span class='Delimiter'>, 
</span><a name="LN78"></a>                   <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>gating_quals</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN79"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_join_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1286"><span class='Ref_to_Struct'>JoinPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN80"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_append_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1174"><span class='Ref_to_Struct'>AppendPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN81"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_merge_append_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1194"><span class='Ref_to_Struct'>MergeAppendPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN82"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN187"><span class='Ref_to_Struct'>Result</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_result_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1210"><span class='Ref_to_Struct'>ResultPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN83"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN199"><span class='Ref_to_Struct'>ProjectSet</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_project_set_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1400"><span class='Ref_to_Struct'>ProjectSetPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN84"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN734"><span class='Ref_to_Struct'>Material</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_material_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1222"><span class='Ref_to_Struct'>MaterialPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN85"></a>                     <span class='Keyword'>int </span><span class='Declare_Parameter'>flags</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN86"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_unique_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1247"><span class='Ref_to_Struct'>UniquePath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN87"></a>                   <span class='Keyword'>int </span><span class='Declare_Parameter'>flags</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN88"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN831"><span class='Ref_to_Struct'>Gather</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_gather_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1261"><span class='Ref_to_Struct'>GatherPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN89"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_projection_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1388"><span class='Ref_to_Struct'>ProjectionPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN90"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>inject_projection_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>subplan</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>parallel_safe</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN91"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN743"><span class='Ref_to_Struct'>Sort</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_sort_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1414"><span class='Ref_to_Struct'>SortPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>flags</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN92"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN759"><span class='Ref_to_Struct'>Group</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_group_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1428"><span class='Ref_to_Struct'>GroupPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN93"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN819"><span class='Ref_to_Struct'>Unique</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_upper_unique_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1442"><span class='Ref_to_Struct'>UpperUniquePath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN94"></a>                         <span class='Keyword'>int </span><span class='Declare_Parameter'>flags</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN95"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN781"><span class='Ref_to_Struct'>Agg</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_agg_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1456"><span class='Ref_to_Struct'>AggPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN96"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_groupingsets_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1493"><span class='Ref_to_Struct'>GroupingSetsPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN97"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN187"><span class='Ref_to_Struct'>Result</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_minmaxagg_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1505"><span class='Ref_to_Struct'>MinMaxAggPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN98"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN800"><span class='Ref_to_Struct'>WindowAgg</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_windowagg_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1519"><span class='Ref_to_Struct'>WindowAggPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN99"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN876"><span class='Ref_to_Struct'>SetOp</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_setop_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1530"><span class='Ref_to_Struct'>SetOpPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN100"></a>                  <span class='Keyword'>int </span><span class='Declare_Parameter'>flags</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN101"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN279"><span class='Ref_to_Struct'>RecursiveUnion</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_recursiveunion_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1545"><span class='Ref_to_Struct'>RecursiveUnionPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN102"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>get_column_info_for_window</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/parsenodes.h.html#LN1252"><span class='Ref_to_Struct'>WindowClause</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>wc</span><span class='Delimiter'>, 
</span><a name="LN103"></a>                           <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, 
</span><a name="LN104"></a>                           <span class='Keyword'>int </span><span class='Declare_Parameter'>numSortCols</span><span class='Delimiter'>, </span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>sortColIdx</span><span class='Delimiter'>, 
</span><a name="LN105"></a>                           <span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>partNumCols</span><span class='Delimiter'>, 
</span><a name="LN106"></a>                           <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>partColIdx</span><span class='Delimiter'>, 
</span><a name="LN107"></a>                           <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>partOperators</span><span class='Delimiter'>, 
</span><a name="LN108"></a>                           <span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>ordNumCols</span><span class='Delimiter'>, 
</span><a name="LN109"></a>                           <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>ordColIdx</span><span class='Delimiter'>, 
</span><a name="LN110"></a>                           <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>ordOperators</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN111"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN899"><span class='Ref_to_Struct'>LockRows</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_lockrows_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1558"><span class='Ref_to_Struct'>LockRowsPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN112"></a>                     <span class='Keyword'>int </span><span class='Declare_Parameter'>flags</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN113"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN213"><span class='Ref_to_Struct'>ModifyTable</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_modifytable_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1573"><span class='Ref_to_Struct'>ModifyTablePath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN114"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN913"><span class='Ref_to_Struct'>Limit</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_limit_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1594"><span class='Ref_to_Struct'>LimitPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN115"></a>                  <span class='Keyword'>int </span><span class='Declare_Parameter'>flags</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN116"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN335"><span class='Ref_to_Typedef'>SeqScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_seqscan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN117"></a>                    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN118"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN341"><span class='Ref_to_Struct'>SampleScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_samplescan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN119"></a>                       <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN120"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN325"><span class='Ref_to_Struct'>Scan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_indexscan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1027"><span class='Ref_to_Struct'>IndexPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN121"></a>                      <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>indexonly</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN122"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN459"><span class='Ref_to_Struct'>BitmapHeapScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_bitmap_scan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN123"></a>                        <a href="../../../include/nodes/relation.h.html#LN1058"><span class='Ref_to_Struct'>BitmapHeapPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN124"></a>                        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN125"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_bitmap_subplan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>bitmapqual</span><span class='Delimiter'>, 
</span><a name="LN126"></a>                      <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>qual</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>indexqual</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>indexECs</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN127"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>bitmap_subplan_mark_shared</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>plan</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN128"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN472"><span class='Ref_to_Struct'>TidScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_tidscan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1097"><span class='Ref_to_Struct'>TidPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN129"></a>                    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN130"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN494"><span class='Ref_to_Struct'>SubqueryScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_subqueryscan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN131"></a>                         <a href="../../../include/nodes/relation.h.html#LN1111"><span class='Ref_to_Struct'>SubqueryScanPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN132"></a>                         <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN133"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN504"><span class='Ref_to_Struct'>FunctionScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_functionscan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN134"></a>                         <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN135"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN515"><span class='Ref_to_Struct'>ValuesScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_valuesscan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN136"></a>                       <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN137"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN525"><span class='Ref_to_Struct'>TableFuncScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_tablefuncscan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN138"></a>                          <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN139"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN535"><span class='Ref_to_Struct'>CteScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_ctescan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN140"></a>                    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN141"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN546"><span class='Ref_to_Struct'>NamedTuplestoreScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_namedtuplestorescan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN142"></a>                           <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN143"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN556"><span class='Ref_to_Struct'>WorkTableScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_worktablescan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN144"></a>                          <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN145"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN594"><span class='Ref_to_Struct'>ForeignScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_foreignscan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1127"><span class='Ref_to_Struct'>ForeignPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN146"></a>                        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN147"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN623"><span class='Ref_to_Struct'>CustomScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_customscan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN148"></a>                       <a href="../../../include/nodes/relation.h.html#LN1155"><span class='Ref_to_Struct'>CustomPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN149"></a>                       <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN150"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN684"><span class='Ref_to_Struct'>NestLoop</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_nestloop_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1311"><span class='Ref_to_Typedef'>NestPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN151"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN708"><span class='Ref_to_Struct'>MergeJoin</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_mergejoin_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1348"><span class='Ref_to_Struct'>MergePath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN152"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN724"><span class='Ref_to_Struct'>HashJoin</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_hashjoin_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1367"><span class='Ref_to_Struct'>HashPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN153"></a><span class='Keyword'>static </span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>replace_nestloop_params</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>expr</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN154"></a><span class='Keyword'>static </span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>replace_nestloop_params_mutator</span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN155"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>process_subquery_nestloop_params</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN156"></a>                                 <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>subplan_params</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN157"></a><span class='Keyword'>static </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>fix_indexqual_references</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1027"><span class='Ref_to_Struct'>IndexPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>index_path</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN158"></a><span class='Keyword'>static </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>fix_indexorderby_references</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1027"><span class='Ref_to_Struct'>IndexPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>index_path</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN159"></a><span class='Keyword'>static </span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>fix_indexqual_operand</span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN626"><span class='Ref_to_Struct'>IndexOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>index</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>indexcol</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN160"></a><span class='Keyword'>static </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>get_switched_clauses</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>clauses</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a> <span class='Declare_Parameter'>outerrelids</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN161"></a><span class='Keyword'>static </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>order_qual_clauses</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>clauses</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN162"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>copy_generic_path_info</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dest</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>src</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN163"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>copy_plan_costsize</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dest</span><span class='Delimiter'>, </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>src</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN164"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>label_sort_with_costsize</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/plannodes.h.html#LN743"><span class='Ref_to_Struct'>Sort</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>plan</span><span class='Delimiter'>, 
</span><a name="LN165"></a>                         <span class='Keyword'>double </span><span class='Declare_Parameter'>limit_tuples</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN166"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN335"><span class='Ref_to_Typedef'>SeqScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_seqscan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN167"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN341"><span class='Ref_to_Struct'>SampleScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_samplescan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Delimiter'>, 
</span><a name="LN168"></a>                <a href="../../../include/nodes/parsenodes.h.html#LN1071"><span class='Ref_to_Struct'>TableSampleClause</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tsc</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN169"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN385"><span class='Ref_to_Struct'>IndexScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_indexscan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Delimiter'>, 
</span><a name="LN170"></a>               <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>indexid</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>indexqual</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>indexqualorig</span><span class='Delimiter'>, 
</span><a name="LN171"></a>               <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>indexorderby</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>indexorderbyorig</span><span class='Delimiter'>, 
</span><a name="LN172"></a>               <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>indexorderbyops</span><span class='Delimiter'>, 
</span><a name="LN173"></a>               <a href="../../../include/access/sdir.h.html#LN21"><span class='Ref_to_Enum'>ScanDirection</span></a> <span class='Declare_Parameter'>indexscandir</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN174"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN414"><span class='Ref_to_Struct'>IndexOnlyScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_indexonlyscan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, 
</span><a name="LN175"></a>                   <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Delimiter'>, </span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>indexid</span><span class='Delimiter'>, 
</span><a name="LN176"></a>                   <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>indexqual</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>indexorderby</span><span class='Delimiter'>, 
</span><a name="LN177"></a>                   <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>indextlist</span><span class='Delimiter'>, 
</span><a name="LN178"></a>                   <a href="../../../include/access/sdir.h.html#LN21"><span class='Ref_to_Enum'>ScanDirection</span></a> <span class='Declare_Parameter'>indexscandir</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN179"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN441"><span class='Ref_to_Struct'>BitmapIndexScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_bitmap_indexscan</span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Delimiter'>, </span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>indexid</span><span class='Delimiter'>, 
</span><a name="LN180"></a>                      <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>indexqual</span><span class='Delimiter'>, 
</span><a name="LN181"></a>                      <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>indexqualorig</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN182"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN459"><span class='Ref_to_Struct'>BitmapHeapScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_bitmap_heapscan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, 
</span><a name="LN183"></a>                     <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, 
</span><a name="LN184"></a>                     <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, 
</span><a name="LN185"></a>                     <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>bitmapqualorig</span><span class='Delimiter'>, 
</span><a name="LN186"></a>                     <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN187"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN472"><span class='Ref_to_Struct'>TidScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_tidscan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Delimiter'>, 
</span><a name="LN188"></a>             <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tidquals</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN189"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN494"><span class='Ref_to_Struct'>SubqueryScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_subqueryscan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, 
</span><a name="LN190"></a>                  <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, 
</span><a name="LN191"></a>                  <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Delimiter'>, 
</span><a name="LN192"></a>                  <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>subplan</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN193"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN504"><span class='Ref_to_Struct'>FunctionScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_functionscan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, 
</span><a name="LN194"></a>                  <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>functions</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>funcordinality</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN195"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN515"><span class='Ref_to_Struct'>ValuesScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_valuesscan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, 
</span><a name="LN196"></a>                <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>values_lists</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN197"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN525"><span class='Ref_to_Struct'>TableFuncScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_tablefuncscan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, 
</span><a name="LN198"></a>                   <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Delimiter'>, </span><a href="../../../include/nodes/primnodes.h.html#LN78"><span class='Ref_to_Struct'>TableFunc</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tablefunc</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN199"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN535"><span class='Ref_to_Struct'>CteScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_ctescan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, 
</span><a name="LN200"></a>             <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>ctePlanId</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>cteParam</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN201"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN546"><span class='Ref_to_Struct'>NamedTuplestoreScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_namedtuplestorescan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, 
</span><a name="LN202"></a>                         <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>enrname</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN203"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN556"><span class='Ref_to_Struct'>WorkTableScan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_worktablescan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, 
</span><a name="LN204"></a>                   <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>wtParam</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN205"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN244"><span class='Ref_to_Struct'>Append</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_append</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>appendplans</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>partitioned_rels</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN206"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN279"><span class='Ref_to_Struct'>RecursiveUnion</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_recursive_union</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, 
</span><a name="LN207"></a>                     <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, 
</span><a name="LN208"></a>                     <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>righttree</span><span class='Delimiter'>, 
</span><a name="LN209"></a>                     <span class='Keyword'>int </span><span class='Declare_Parameter'>wtParam</span><span class='Delimiter'>, 
</span><a name="LN210"></a>                     <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>distinctList</span><span class='Delimiter'>, 
</span><a name="LN211"></a>                     <span class='Keyword'>long </span><span class='Declare_Parameter'>numGroups</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN212"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN299"><span class='Ref_to_Struct'>BitmapAnd</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_bitmap_and</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>bitmapplans</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN213"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN313"><span class='Ref_to_Struct'>BitmapOr</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_bitmap_or</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>bitmapplans</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN214"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN684"><span class='Ref_to_Struct'>NestLoop</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_nestloop</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, 
</span><a name="LN215"></a>              <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinclauses</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>otherclauses</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>nestParams</span><span class='Delimiter'>, 
</span><a name="LN216"></a>              <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>righttree</span><span class='Delimiter'>, 
</span><a name="LN217"></a>              <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>inner_unique</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN218"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN724"><span class='Ref_to_Struct'>HashJoin</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_hashjoin</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, 
</span><a name="LN219"></a>              <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinclauses</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>otherclauses</span><span class='Delimiter'>, 
</span><a name="LN220"></a>              <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>hashclauses</span><span class='Delimiter'>, 
</span><a name="LN221"></a>              <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>righttree</span><span class='Delimiter'>, 
</span><a name="LN222"></a>              <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>inner_unique</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN223"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN863"><span class='Ref_to_Struct'>Hash</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_hash</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, 
</span><a name="LN224"></a>          <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>skewTable</span><span class='Delimiter'>, 
</span><a name="LN225"></a>          <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Declare_Parameter'>skewColumn</span><span class='Delimiter'>, 
</span><a name="LN226"></a>          <span class='Keyword'>bool </span><span class='Declare_Parameter'>skewInherit</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN227"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN708"><span class='Ref_to_Struct'>MergeJoin</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_mergejoin</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, 
</span><a name="LN228"></a>               <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinclauses</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>otherclauses</span><span class='Delimiter'>, 
</span><a name="LN229"></a>               <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>mergeclauses</span><span class='Delimiter'>, 
</span><a name="LN230"></a>               <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>mergefamilies</span><span class='Delimiter'>, 
</span><a name="LN231"></a>               <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>mergecollations</span><span class='Delimiter'>, 
</span><a name="LN232"></a>               <span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>mergestrategies</span><span class='Delimiter'>, 
</span><a name="LN233"></a>               <span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>mergenullsfirst</span><span class='Delimiter'>, 
</span><a name="LN234"></a>               <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>righttree</span><span class='Delimiter'>, 
</span><a name="LN235"></a>               <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>inner_unique</span><span class='Delimiter'>, 
</span><a name="LN236"></a>               <span class='Keyword'>bool </span><span class='Declare_Parameter'>skip_mark_restore</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN237"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN743"><span class='Ref_to_Struct'>Sort</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_sort</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>numCols</span><span class='Delimiter'>, 
</span><a name="LN238"></a>          <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>sortColIdx</span><span class='Delimiter'>, </span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>sortOperators</span><span class='Delimiter'>, 
</span><a name="LN239"></a>          <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>collations</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>nullsFirst</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN240"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>prepare_sort_from_pathkeys</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pathkeys</span><span class='Delimiter'>, 
</span><a name="LN241"></a>                           <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a> <span class='Declare_Parameter'>relids</span><span class='Delimiter'>, 
</span><a name="LN242"></a>                           <span class='Keyword'>const </span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>reqColIdx</span><span class='Delimiter'>, 
</span><a name="LN243"></a>                           <span class='Keyword'>bool </span><span class='Declare_Parameter'>adjust_tlist_in_place</span><span class='Delimiter'>, 
</span><a name="LN244"></a>                           <span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>p_numsortkeys</span><span class='Delimiter'>, 
</span><a name="LN245"></a>                           <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>p_sortColIdx</span><span class='Delimiter'>, 
</span><a name="LN246"></a>                           <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>p_sortOperators</span><span class='Delimiter'>, 
</span><a name="LN247"></a>                           <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>p_collations</span><span class='Delimiter'>, 
</span><a name="LN248"></a>                           <span class='Keyword'>bool </span><span class='Operator'>**</span><span class='Declare_Parameter'>p_nullsFirst</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN249"></a><span class='Keyword'>static </span><a href="../../../include/nodes/relation.h.html#LN816"><span class='Ref_to_Struct'>EquivalenceMember</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>find_ec_member_for_tle</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN766"><span class='Ref_to_Struct'>EquivalenceClass</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>ec</span><span class='Delimiter'>, 
</span><a name="LN250"></a>                       <a href="../../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tle</span><span class='Delimiter'>, 
</span><a name="LN251"></a>                       <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a> <span class='Declare_Parameter'>relids</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN252"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN743"><span class='Ref_to_Struct'>Sort</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_sort_from_pathkeys</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pathkeys</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN253"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN743"><span class='Ref_to_Struct'>Sort</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_sort_from_groupcols</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>groupcls</span><span class='Delimiter'>, 
</span><a name="LN254"></a>                         <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>grpColIdx</span><span class='Delimiter'>, 
</span><a name="LN255"></a>                         <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN256"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN734"><span class='Ref_to_Struct'>Material</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_material</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN257"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN800"><span class='Ref_to_Struct'>WindowAgg</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_windowagg</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>winref</span><span class='Delimiter'>, 
</span><a name="LN258"></a>               <span class='Keyword'>int </span><span class='Declare_Parameter'>partNumCols</span><span class='Delimiter'>, </span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>partColIdx</span><span class='Delimiter'>, </span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>partOperators</span><span class='Delimiter'>, 
</span><a name="LN259"></a>               <span class='Keyword'>int </span><span class='Declare_Parameter'>ordNumCols</span><span class='Delimiter'>, </span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>ordColIdx</span><span class='Delimiter'>, </span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>ordOperators</span><span class='Delimiter'>, 
</span><a name="LN260"></a>               <span class='Keyword'>int </span><span class='Declare_Parameter'>frameOptions</span><span class='Delimiter'>, </span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>startOffset</span><span class='Delimiter'>, </span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>endOffset</span><span class='Delimiter'>, 
</span><a name="LN261"></a>               <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN262"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN759"><span class='Ref_to_Struct'>Group</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_group</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qual</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>numGroupCols</span><span class='Delimiter'>, 
</span><a name="LN263"></a>           <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>grpColIdx</span><span class='Delimiter'>, </span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>grpOperators</span><span class='Delimiter'>, 
</span><a name="LN264"></a>           <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN265"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN819"><span class='Ref_to_Struct'>Unique</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_unique_from_sortclauses</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>distinctList</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN266"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN819"><span class='Ref_to_Struct'>Unique</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_unique_from_pathkeys</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, 
</span><a name="LN267"></a>                          <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pathkeys</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>numCols</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN268"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN831"><span class='Ref_to_Struct'>Gather</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_gather</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, 
</span><a name="LN269"></a>            <span class='Keyword'>int </span><span class='Declare_Parameter'>nworkers</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>single_copy</span><span class='Delimiter'>, </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>subplan</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN270"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN876"><span class='Ref_to_Struct'>SetOp</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_setop</span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN777"><span class='Ref_to_Enum'>SetOpCmd</span></a> <span class='Declare_Parameter'>cmd</span><span class='Delimiter'>, </span><a href="../../../include/nodes/nodes.h.html#LN785"><span class='Ref_to_Enum'>SetOpStrategy</span></a> <span class='Declare_Parameter'>strategy</span><span class='Delimiter'>, </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, 
</span><a name="LN271"></a>           <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>distinctList</span><span class='Delimiter'>, </span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Declare_Parameter'>flagColIdx</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>firstFlag</span><span class='Delimiter'>, 
</span><a name="LN272"></a>           <span class='Keyword'>long </span><span class='Declare_Parameter'>numGroups</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN273"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN899"><span class='Ref_to_Struct'>LockRows</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_lockrows</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rowMarks</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>epqParam</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN274"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN187"><span class='Ref_to_Struct'>Result</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_result</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>resconstantqual</span><span class='Delimiter'>, </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>subplan</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN275"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN199"><span class='Ref_to_Struct'>ProjectSet</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_project_set</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>subplan</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN276"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN213"><span class='Ref_to_Struct'>ModifyTable</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>make_modifytable</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN277"></a>                 <a href="../../../include/nodes/nodes.h.html#LN647"><span class='Ref_to_Enum'>CmdType</span></a> <span class='Declare_Parameter'>operation</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>canSetTag</span><span class='Delimiter'>, 
</span><a name="LN278"></a>                 <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>nominalRelation</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>partitioned_rels</span><span class='Delimiter'>, 
</span><a name="LN279"></a>                 <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>resultRelations</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>subplans</span><span class='Delimiter'>, 
</span><a name="LN280"></a>                 <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>withCheckOptionLists</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>returningLists</span><span class='Delimiter'>, 
</span><a name="LN281"></a>                 <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rowMarks</span><span class='Delimiter'>, </span><a href="../../../include/nodes/primnodes.h.html#LN1482"><span class='Ref_to_Struct'>OnConflictExpr</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>onconflict</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>epqParam</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN282"></a><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN843"><span class='Ref_to_Struct'>GatherMerge</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>create_gather_merge_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN283"></a>                         <a href="../../../include/nodes/relation.h.html#LN1274"><span class='Ref_to_Struct'>GatherMergePath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_plan 
 *    Creates the access plan for a query by recursively processing the 
 *    desired tree of pathnodes, starting at the node 'best_path'.  For 
 *    every pathnode found, we create a corresponding plan node containing 
 *    appropriate id, target list, and qualification information. 
 * 
 *    The tlists and quals in the plan tree are still in planner format, 
 *    ie, Vars still correspond to the parser's numbering.  This will be 
 *    fixed later by setrefs.c. 
 * 
 *    best_path is the best access path 
 * 
 *    Returns a Plan tree. 
 */ 
</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>* 
</span><a name="LN302"></a><span class='Declare_Function'>create_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN304"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* plan_params should not be in use in current query level */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN302"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN168"><span class='Ref_to_Member'>plan_params</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Initialize this module's private workspace in PlannerInfo */ 
</span>    <a href="createplan.c.html#LN302"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN311"><span class='Ref_to_Member'>curOuterRels</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN302"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN312"><span class='Ref_to_Member'>curOuterParams</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Recursively process the path tree, demanding the correct tlist result */ 
</span>    <a href="createplan.c.html#LN304"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN302"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN302"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN65"><span class='Ref_to_Const'>CP_EXACT_TLIST</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Make sure the topmost plan node's targetlist exposes the original 
     * column names and other decorative info.  Targetlists generated within 
     * the planner don't bother with that stuff, but we must have it on the 
     * top-level tlist seen at execution time.  However, ModifyTable plan 
     * nodes don't have a tlist matching the querytree targetlist. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN304"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/plannodes.h.html#LN213"><span class='Ref_to_Struct'>ModifyTable</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/optimizer/tlist.h.html#LN33"><span class='Ref_to_Proto'>apply_tlist_labeling</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN304"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN302"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN280"><span class='Ref_to_Member'>processed_tlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Attach any initPlans created in this query level to the topmost plan 
     * node.  (In principle the initplans could go in any plan node at or 
     * above where they're referenced, but there seems no reason to put them 
     * any lower than the topmost node for the query level.  Also, see 
     * comments for SS_finalize_plan before you try to change this.) 
     */ 
</span>    <a href="../../../include/optimizer/subselect.h.html#LN29"><span class='Ref_to_Proto'>SS_attach_initplans</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN302"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN304"><span class='Ref_To_Local'>plan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Check we successfully assigned all NestLoopParams to plan nodes */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN302"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN312"><span class='Ref_to_Member'>curOuterParams</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>        <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"failed to assign all NestLoopParams to plan nodes"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Reset plan_params to ensure param IDs used for nestloop params are not 
     * re-used later 
     */ 
</span>    <a href="createplan.c.html#LN302"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN168"><span class='Ref_to_Member'>plan_params</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN304"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_plan_recurse 
 *    Recursive guts of create_plan(). 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>* 
</span><a name="LN353"></a><span class='Declare_Function'>create_plan_recurse</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>flags</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN355"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN950"><span class='Ref_to_Member'>pathtype</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN53"><span class='Ref_to_EnumConst'>T_SeqScan</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN54"><span class='Ref_to_EnumConst'>T_SampleScan</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN55"><span class='Ref_to_EnumConst'>T_IndexScan</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN56"><span class='Ref_to_EnumConst'>T_IndexOnlyScan</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN58"><span class='Ref_to_EnumConst'>T_BitmapHeapScan</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN59"><span class='Ref_to_EnumConst'>T_TidScan</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN60"><span class='Ref_to_EnumConst'>T_SubqueryScan</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN61"><span class='Ref_to_EnumConst'>T_FunctionScan</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN63"><span class='Ref_to_EnumConst'>T_TableFuncScan</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN62"><span class='Ref_to_EnumConst'>T_ValuesScan</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN64"><span class='Ref_to_EnumConst'>T_CteScan</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN66"><span class='Ref_to_EnumConst'>T_WorkTableScan</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN65"><span class='Ref_to_EnumConst'>T_NamedTuplestoreScan</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN67"><span class='Ref_to_EnumConst'>T_ForeignScan</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN68"><span class='Ref_to_EnumConst'>T_CustomScan</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN355"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN72"><span class='Ref_to_Proto'>create_scan_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>flags</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN72"><span class='Ref_to_EnumConst'>T_HashJoin</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN71"><span class='Ref_to_EnumConst'>T_MergeJoin</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN70"><span class='Ref_to_EnumConst'>T_NestLoop</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN355"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN79"><span class='Ref_to_Proto'>create_join_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                    <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1286"><span class='Ref_to_Struct'>JoinPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN47"><span class='Ref_to_EnumConst'>T_Append</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN355"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN80"><span class='Ref_to_Proto'>create_append_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                      <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1174"><span class='Ref_to_Struct'>AppendPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN48"><span class='Ref_to_EnumConst'>T_MergeAppend</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN355"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN81"><span class='Ref_to_Proto'>create_merge_append_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                            <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1194"><span class='Ref_to_Struct'>MergeAppendPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN44"><span class='Ref_to_EnumConst'>T_Result</span></a><span class='Operator'>: 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1388"><span class='Ref_to_Struct'>ProjectionPath</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span>                <a href="createplan.c.html#LN355"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN89"><span class='Ref_to_Proto'>create_projection_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                              <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1388"><span class='Ref_to_Struct'>ProjectionPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1505"><span class='Ref_to_Struct'>MinMaxAggPath</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span>                <a href="createplan.c.html#LN355"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN97"><span class='Ref_to_Proto'>create_minmaxagg_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1505"><span class='Ref_to_Struct'>MinMaxAggPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1210"><span class='Ref_to_Struct'>ResultPath</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <a href="createplan.c.html#LN355"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN82"><span class='Ref_to_Proto'>create_result_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                   <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1210"><span class='Ref_to_Struct'>ResultPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN45"><span class='Ref_to_EnumConst'>T_ProjectSet</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN355"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN83"><span class='Ref_to_Proto'>create_project_set_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                               <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1400"><span class='Ref_to_Struct'>ProjectSetPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN73"><span class='Ref_to_EnumConst'>T_Material</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN355"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN84"><span class='Ref_to_Proto'>create_material_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                 <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1222"><span class='Ref_to_Struct'>MaterialPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, 
</span>                                                 <a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>flags</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN78"><span class='Ref_to_EnumConst'>T_Unique</span></a><span class='Operator'>: 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1442"><span class='Ref_to_Struct'>UpperUniquePath</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span>                <a href="createplan.c.html#LN355"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN93"><span class='Ref_to_Proto'>create_upper_unique_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                               <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1442"><span class='Ref_to_Struct'>UpperUniquePath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, 
</span>                                                         <a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>flags</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1247"><span class='Ref_to_Struct'>UniquePath</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <a href="createplan.c.html#LN355"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN86"><span class='Ref_to_Proto'>create_unique_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                          <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1247"><span class='Ref_to_Struct'>UniquePath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, 
</span>                                          <a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>flags</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN79"><span class='Ref_to_EnumConst'>T_Gather</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN355"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN88"><span class='Ref_to_Proto'>create_gather_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                               <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1261"><span class='Ref_to_Struct'>GatherPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN74"><span class='Ref_to_EnumConst'>T_Sort</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN355"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN91"><span class='Ref_to_Proto'>create_sort_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                             <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1414"><span class='Ref_to_Struct'>SortPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, 
</span>                                             <a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>flags</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN75"><span class='Ref_to_EnumConst'>T_Group</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN355"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN92"><span class='Ref_to_Proto'>create_group_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                              <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1428"><span class='Ref_to_Struct'>GroupPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN76"><span class='Ref_to_EnumConst'>T_Agg</span></a><span class='Operator'>: 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1493"><span class='Ref_to_Struct'>GroupingSetsPath</span></a><span class='Parentheses'>))</span> 
                <a href="createplan.c.html#LN355"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN96"><span class='Ref_to_Proto'>create_groupingsets_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                             <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1493"><span class='Ref_to_Struct'>GroupingSetsPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1456"><span class='Ref_to_Struct'>AggPath</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <a href="createplan.c.html#LN355"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN95"><span class='Ref_to_Proto'>create_agg_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1456"><span class='Ref_to_Struct'>AggPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN77"><span class='Ref_to_EnumConst'>T_WindowAgg</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN355"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN98"><span class='Ref_to_Proto'>create_windowagg_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1519"><span class='Ref_to_Struct'>WindowAggPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN82"><span class='Ref_to_EnumConst'>T_SetOp</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN355"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN99"><span class='Ref_to_Proto'>create_setop_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                              <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1530"><span class='Ref_to_Struct'>SetOpPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, 
</span>                                              <a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>flags</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN49"><span class='Ref_to_EnumConst'>T_RecursiveUnion</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN355"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN101"><span class='Ref_to_Proto'>create_recursiveunion_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                           <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1545"><span class='Ref_to_Struct'>RecursiveUnionPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN83"><span class='Ref_to_EnumConst'>T_LockRows</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN355"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN111"><span class='Ref_to_Proto'>create_lockrows_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                 <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1558"><span class='Ref_to_Struct'>LockRowsPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, 
</span>                                                 <a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>flags</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN46"><span class='Ref_to_EnumConst'>T_ModifyTable</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN355"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN113"><span class='Ref_to_Proto'>create_modifytable_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                              <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1573"><span class='Ref_to_Struct'>ModifyTablePath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN84"><span class='Ref_to_EnumConst'>T_Limit</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN355"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN114"><span class='Ref_to_Proto'>create_limit_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                              <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1594"><span class='Ref_to_Struct'>LimitPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, 
</span>                                              <a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>flags</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN80"><span class='Ref_to_EnumConst'>T_GatherMerge</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN355"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN282"><span class='Ref_to_Proto'>create_gather_merge_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                              <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1274"><span class='Ref_to_Struct'>GatherMergePath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized node type: %d"</span><span class='Delimiter'>, 
</span>                 <span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN353"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN950"><span class='Ref_to_Member'>pathtype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN355"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch best_path-&GT;pathtype &raquo; </span> 
 
    <span class='Control'>return</span> <a href="createplan.c.html#LN355"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_plan_recurse &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_scan_plan 
 *   Create a scan plan for the parent relation of 'best_path'. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>* 
</span><a name="LN502"></a><span class='Declare_Function'>create_scan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>flags</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN504"></a>    <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rel</span> <span class='Operator'>= </span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Delimiter'>; 
</span><a name="LN505"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>scan_clauses</span><span class='Delimiter'>; 
</span><a name="LN506"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>gating_clauses</span><span class='Delimiter'>; 
</span><a name="LN507"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>tlist</span><span class='Delimiter'>; 
</span><a name="LN508"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Extract the relevant restriction clauses from the parent relation. The 
     * executor must apply all these restrictions during the scan, except for 
     * pseudoconstants which we'll take care of below. 
     * 
     * If this is a plain indexscan or index-only scan, we need not consider 
     * restriction clauses that are implied by the index's predicate, so use 
     * indrestrictinfo not baserestrictinfo.  Note that we can't do that for 
     * bitmap indexscans, since there's not necessarily a single index 
     * involved; but it doesn't matter since create_bitmap_scan_plan() will be 
     * able to get rid of such clauses anyway via predicate proof. 
     */ 
</span>    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN950"><span class='Ref_to_Member'>pathtype</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN55"><span class='Ref_to_EnumConst'>T_IndexScan</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN56"><span class='Ref_to_EnumConst'>T_IndexOnlyScan</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN505"><span class='Ref_To_Local'>scan_clauses</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN575"><span class='Ref_to_Macro'>castNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1027"><span class='Ref_to_Struct'>IndexPath</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>indexinfo<span class='Operator'>-&GT;</span>indrestrictinfo<span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN505"><span class='Ref_To_Local'>scan_clauses</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN504"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN583"><span class='Ref_to_Member'>baserestrictinfo</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If this is a parameterized scan, we also need to enforce all the join 
     * clauses available from the outer relation(s). 
     * 
     * For paranoia's sake, don't modify the stored baserestrictinfo list. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a><span class='Parentheses'>) 
</span>        <a href="createplan.c.html#LN505"><span class='Ref_To_Local'>scan_clauses</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN219"><span class='Ref_to_Proto'>list_concat</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN268"><span class='Ref_to_Proto'>list_copy</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN505"><span class='Ref_To_Local'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                   <a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN913"><span class='Ref_to_Member'>ppi_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Detect whether we have any pseudoconstant quals to deal with.  Then, if 
     * we'll need a gating Result node, it will be able to project, so there 
     * are no requirements on the child's tlist. 
     */ 
</span>    <a href="createplan.c.html#LN506"><span class='Ref_To_Local'>gating_clauses</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN76"><span class='Ref_to_Proto'>get_gating_quals</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN505"><span class='Ref_To_Local'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN506"><span class='Ref_To_Local'>gating_clauses</span></a><span class='Parentheses'>) 
</span>        <a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>flags</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * For table scans, rather than using the relation targetlist (which is 
     * only those Vars actually needed by the query), we prefer to generate a 
     * tlist containing all Vars in order.  This will allow the executor to 
     * optimize away projection of the table tuples, if possible. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN75"><span class='Ref_to_Proto'>use_physical_tlist</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>flags</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN950"><span class='Ref_to_Member'>pathtype</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/nodes.h.html#LN56"><span class='Ref_to_EnumConst'>T_IndexOnlyScan</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* For index-only scan, the preferred tlist is the index's */ 
</span>            <a href="createplan.c.html#LN507"><span class='Ref_To_Local'>tlist</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN618"><span class='Ref_to_Macro'>copyObject</span></a><span class='Parentheses'>(((</span><a href="../../../include/nodes/relation.h.html#LN1027"><span class='Ref_to_Struct'>IndexPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>indexinfo<span class='Operator'>-&GT;</span>indextlist<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Transfer any sortgroupref data to the replacement tlist, unless 
             * we don't care because the gating Result will handle it. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="createplan.c.html#LN506"><span class='Ref_To_Local'>gating_clauses</span></a><span class='Parentheses'>) 
</span>                <a href="../../../include/optimizer/tlist.h.html#LN62"><span class='Ref_to_Proto'>apply_pathtarget_labeling_to_tlist</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN507"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN953"><span class='Ref_to_Member'>pathtarget</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="createplan.c.html#LN507"><span class='Ref_To_Local'>tlist</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/plancat.h.html#LN40"><span class='Ref_to_Proto'>build_physical_tlist</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN504"><span class='Ref_To_Local'>rel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN507"><span class='Ref_To_Local'>tlist</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Failed because of dropped cols, so use regular method */ 
</span>                <a href="createplan.c.html#LN507"><span class='Ref_To_Local'>tlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN74"><span class='Ref_to_Proto'>build_path_tlist</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* As above, transfer sortgroupref data to replacement tlist */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="createplan.c.html#LN506"><span class='Ref_To_Local'>gating_clauses</span></a><span class='Parentheses'>) 
</span>                    <a href="../../../include/optimizer/tlist.h.html#LN62"><span class='Ref_to_Proto'>apply_pathtarget_labeling_to_tlist</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN507"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN953"><span class='Ref_to_Member'>pathtarget</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if use_physical_tlist(ro... &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="createplan.c.html#LN507"><span class='Ref_To_Local'>tlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN74"><span class='Ref_to_Proto'>build_path_tlist</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN950"><span class='Ref_to_Member'>pathtype</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN53"><span class='Ref_to_EnumConst'>T_SeqScan</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN508"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN116"><span class='Ref_to_Proto'>create_seqscan_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                <a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, 
</span>                                                <a href="createplan.c.html#LN507"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, 
</span>                                                <a href="createplan.c.html#LN505"><span class='Ref_To_Local'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN54"><span class='Ref_to_EnumConst'>T_SampleScan</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN508"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN118"><span class='Ref_to_Proto'>create_samplescan_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                   <a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, 
</span>                                                   <a href="createplan.c.html#LN507"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, 
</span>                                                   <a href="createplan.c.html#LN505"><span class='Ref_To_Local'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN55"><span class='Ref_to_EnumConst'>T_IndexScan</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN508"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN120"><span class='Ref_to_Proto'>create_indexscan_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                  <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1027"><span class='Ref_to_Struct'>IndexPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, 
</span>                                                  <a href="createplan.c.html#LN507"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, 
</span>                                                  <a href="createplan.c.html#LN505"><span class='Ref_To_Local'>scan_clauses</span></a><span class='Delimiter'>, 
</span>                                                  <span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN56"><span class='Ref_to_EnumConst'>T_IndexOnlyScan</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN508"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN120"><span class='Ref_to_Proto'>create_indexscan_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                  <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1027"><span class='Ref_to_Struct'>IndexPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, 
</span>                                                  <a href="createplan.c.html#LN507"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, 
</span>                                                  <a href="createplan.c.html#LN505"><span class='Ref_To_Local'>scan_clauses</span></a><span class='Delimiter'>, 
</span>                                                  <span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN58"><span class='Ref_to_EnumConst'>T_BitmapHeapScan</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN508"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN122"><span class='Ref_to_Proto'>create_bitmap_scan_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1058"><span class='Ref_to_Struct'>BitmapHeapPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, 
</span>                                                    <a href="createplan.c.html#LN507"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, 
</span>                                                    <a href="createplan.c.html#LN505"><span class='Ref_To_Local'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN59"><span class='Ref_to_EnumConst'>T_TidScan</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN508"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN128"><span class='Ref_to_Proto'>create_tidscan_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1097"><span class='Ref_to_Struct'>TidPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, 
</span>                                                <a href="createplan.c.html#LN507"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, 
</span>                                                <a href="createplan.c.html#LN505"><span class='Ref_To_Local'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN60"><span class='Ref_to_EnumConst'>T_SubqueryScan</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN508"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN130"><span class='Ref_to_Proto'>create_subqueryscan_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                              <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1111"><span class='Ref_to_Struct'>SubqueryScanPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, 
</span>                                                     <a href="createplan.c.html#LN507"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, 
</span>                                                     <a href="createplan.c.html#LN505"><span class='Ref_To_Local'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN61"><span class='Ref_to_EnumConst'>T_FunctionScan</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN508"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN133"><span class='Ref_to_Proto'>create_functionscan_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                     <a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, 
</span>                                                     <a href="createplan.c.html#LN507"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, 
</span>                                                     <a href="createplan.c.html#LN505"><span class='Ref_To_Local'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN63"><span class='Ref_to_EnumConst'>T_TableFuncScan</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN508"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN137"><span class='Ref_to_Proto'>create_tablefuncscan_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                      <a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, 
</span>                                                      <a href="createplan.c.html#LN507"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, 
</span>                                                      <a href="createplan.c.html#LN505"><span class='Ref_To_Local'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN62"><span class='Ref_to_EnumConst'>T_ValuesScan</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN508"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN135"><span class='Ref_to_Proto'>create_valuesscan_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                   <a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, 
</span>                                                   <a href="createplan.c.html#LN507"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, 
</span>                                                   <a href="createplan.c.html#LN505"><span class='Ref_To_Local'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN64"><span class='Ref_to_EnumConst'>T_CteScan</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN508"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN139"><span class='Ref_to_Proto'>create_ctescan_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                <a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, 
</span>                                                <a href="createplan.c.html#LN507"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, 
</span>                                                <a href="createplan.c.html#LN505"><span class='Ref_To_Local'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN65"><span class='Ref_to_EnumConst'>T_NamedTuplestoreScan</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN508"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN141"><span class='Ref_to_Proto'>create_namedtuplestorescan_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                            <a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, 
</span>                                                            <a href="createplan.c.html#LN507"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, 
</span>                                                            <a href="createplan.c.html#LN505"><span class='Ref_To_Local'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN66"><span class='Ref_to_EnumConst'>T_WorkTableScan</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN508"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN143"><span class='Ref_to_Proto'>create_worktablescan_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                      <a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, 
</span>                                                      <a href="createplan.c.html#LN507"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, 
</span>                                                      <a href="createplan.c.html#LN505"><span class='Ref_To_Local'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN67"><span class='Ref_to_EnumConst'>T_ForeignScan</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN508"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN145"><span class='Ref_to_Proto'>create_foreignscan_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                    <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1127"><span class='Ref_to_Struct'>ForeignPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, 
</span>                                                    <a href="createplan.c.html#LN507"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, 
</span>                                                    <a href="createplan.c.html#LN505"><span class='Ref_To_Local'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN68"><span class='Ref_to_EnumConst'>T_CustomScan</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN508"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN147"><span class='Ref_to_Proto'>create_customscan_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                   <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1155"><span class='Ref_to_Struct'>CustomPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, 
</span>                                                   <a href="createplan.c.html#LN507"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, 
</span>                                                   <a href="createplan.c.html#LN505"><span class='Ref_To_Local'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized node type: %d"</span><span class='Delimiter'>, 
</span>                 <span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN950"><span class='Ref_to_Member'>pathtype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN508"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch best_path-&GT;pathtype &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* 
     * If there are any pseudoconstant clauses attached to this node, insert a 
     * gating Result node that evaluates the pseudoconstants as one-time 
     * quals. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN506"><span class='Ref_To_Local'>gating_clauses</span></a><span class='Parentheses'>) 
</span>        <a href="createplan.c.html#LN508"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN77"><span class='Ref_to_Proto'>create_gating_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN502"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN508"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN506"><span class='Ref_To_Local'>gating_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN508"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_scan_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Build a target list (ie, a list of TargetEntry) for the Path's output. 
 * 
 * This is almost just make_tlist_from_pathtarget(), but we also have to 
 * deal with replacing nestloop params. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>* 
</span><a name="LN727"></a><span class='Declare_Function'>build_path_tlist</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN729"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>tlist</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN730"></a>    <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>sortgrouprefs</span> <span class='Operator'>= </span><a href="createplan.c.html#LN727"><span class='Ref_to_Parameter'>path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN953"><span class='Ref_to_Member'>pathtarget</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN883"><span class='Ref_to_Member'>sortgrouprefs</span></a><span class='Delimiter'>; 
</span><a name="LN731"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>resno</span> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span><a name="LN732"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>v</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN732"><span class='Ref_To_Local'>v</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN727"><span class='Ref_to_Parameter'>path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN953"><span class='Ref_to_Member'>pathtarget</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN882"><span class='Ref_to_Member'>exprs</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN736"></a>        <a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN732"><span class='Ref_To_Local'>v</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN737"></a>        <a href="../../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>tle</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If it's a parameterized path, there might be lateral references in 
         * the tlist, which need to be replaced with Params.  There's no need 
         * to remake the TargetEntry nodes, so apply this to each list item 
         * separately. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN727"><span class='Ref_to_Parameter'>path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN736"><span class='Ref_To_Local'>node</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN727"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN736"><span class='Ref_To_Local'>node</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN737"><span class='Ref_To_Local'>tle</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/makefuncs.h.html#LN40"><span class='Ref_to_Proto'>makeTargetEntry</span></a><span class='Parentheses'>((</span><a href="../../../include/nodes/primnodes.h.html#LN131"><span class='Ref_to_Struct'>Expr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN736"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>, 
</span>                              <a href="createplan.c.html#LN731"><span class='Ref_To_Local'>resno</span></a><span class='Delimiter'>, 
</span>                              <span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                              <span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN730"><span class='Ref_To_Local'>sortgrouprefs</span></a><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN737"><span class='Ref_To_Local'>tle</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN1369"><span class='Ref_to_Member'>ressortgroupref</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN730"><span class='Ref_To_Local'>sortgrouprefs</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN731"><span class='Ref_To_Local'>resno</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span> 
        <a href="createplan.c.html#LN729"><span class='Ref_To_Local'>tlist</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN729"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN737"><span class='Ref_To_Local'>tle</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN731"><span class='Ref_To_Local'>resno</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="createplan.c.html#LN729"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end build_path_tlist &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * use_physical_tlist 
 *      Decide whether to use a tlist matching relation structure, 
 *      rather than only those Vars actually referenced. 
 */ 
</span><span class='Keyword'>static bool 
</span><a name="LN767"></a><span class='Declare_Function'>use_physical_tlist</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>path</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>flags</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN769"></a>    <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rel</span> <span class='Operator'>= </span><a href="createplan.c.html#LN767"><span class='Ref_to_Parameter'>path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Delimiter'>; 
</span><a name="LN770"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN771"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Forget it if either exact tlist or small tlist is demanded. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN767"><span class='Ref_to_Parameter'>flags</span></a> <span class='Operator'>& </span><span class='Parentheses'>(</span><a href="createplan.c.html#LN65"><span class='Ref_to_Const'>CP_EXACT_TLIST</span></a> <span class='Operator'>| </span><a href="createplan.c.html#LN66"><span class='Ref_to_Const'>CP_SMALL_TLIST</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We can do this for real relation scans, subquery scans, function scans, 
     * tablefunc scans, values scans, and CTE scans (but not for, eg, joins). 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN769"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN554"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/parsenodes.h.html#LN922"><span class='Ref_to_EnumConst'>RTE_RELATION</span></a> <span class='Operator'>&& 
</span>        <a href="createplan.c.html#LN769"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN554"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/parsenodes.h.html#LN923"><span class='Ref_to_EnumConst'>RTE_SUBQUERY</span></a> <span class='Operator'>&& 
</span>        <a href="createplan.c.html#LN769"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN554"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/parsenodes.h.html#LN925"><span class='Ref_to_EnumConst'>RTE_FUNCTION</span></a> <span class='Operator'>&& 
</span>        <a href="createplan.c.html#LN769"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN554"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/parsenodes.h.html#LN926"><span class='Ref_to_EnumConst'>RTE_TABLEFUNC</span></a> <span class='Operator'>&& 
</span>        <a href="createplan.c.html#LN769"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN554"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/parsenodes.h.html#LN927"><span class='Ref_to_EnumConst'>RTE_VALUES</span></a> <span class='Operator'>&& 
</span>        <a href="createplan.c.html#LN769"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN554"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/parsenodes.h.html#LN928"><span class='Ref_to_EnumConst'>RTE_CTE</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Can't do it with inheritance cases either (mainly because Append 
     * doesn't project; this test may be unnecessary now that 
     * create_append_plan instructs its children to return an exact tlist). 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN769"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN521"><span class='Ref_to_Member'>reloptkind</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/relation.h.html#LN493"><span class='Ref_to_EnumConst'>RELOPT_BASEREL</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Also, don't do it to a CustomPath; the premise that we're extracting 
     * columns from a simple physical tuple is unlikely to hold for those. 
     * (When it does make sense, the custom path creator can set up the path's 
     * pathtarget that way.) 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN767"><span class='Ref_to_Parameter'>path</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1155"><span class='Ref_to_Struct'>CustomPath</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Can't do it if any system columns or whole-row Vars are requested. 
     * (This could possibly be fixed but would take some fragile assumptions 
     * in setrefs.c, I think.) 
     */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN770"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN769"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN555"><span class='Ref_to_Member'>min_attr</span></a><span class='Delimiter'>; </span><a href="createplan.c.html#LN770"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="createplan.c.html#LN770"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/nodes/bitmapset.h.html#LN85"><span class='Ref_to_Proto'>bms_is_empty</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN769"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN557"><span class='Ref_to_Member'>attr_needed</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN770"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>- </span><a href="createplan.c.html#LN769"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN555"><span class='Ref_to_Member'>min_attr</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Can't do it if the rel is required to emit any placeholder expressions, 
     * either. 
     */ 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN771"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN767"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN257"><span class='Ref_to_Member'>placeholder_list</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN825"></a>        <a href="../../../include/nodes/relation.h.html#LN2057"><span class='Ref_to_Struct'>PlaceHolderInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>phinfo</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN2057"><span class='Ref_to_Struct'>PlaceHolderInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN771"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/bitmapset.h.html#LN78"><span class='Ref_to_Proto'>bms_nonempty_difference</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN825"><span class='Ref_To_Local'>phinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2065"><span class='Ref_to_Member'>ph_needed</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN769"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>            <a href="../../../include/nodes/bitmapset.h.html#LN73"><span class='Ref_to_Proto'>bms_is_subset</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN825"><span class='Ref_To_Local'>phinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2063"><span class='Ref_to_Member'>ph_eval_at</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN769"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Also, can't do it if CP_LABEL_TLIST is specified and path is requested 
     * to emit any sort/group columns that are not simple Vars.  (If they are 
     * simple Vars, they should appear in the physical tlist, and 
     * apply_pathtarget_labeling_to_tlist will take care of getting them 
     * labeled again.)  We also have to check that no two sort/group columns 
     * are the same Var, else that element of the physical tlist would need 
     * conflicting ressortgroupref labels. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="createplan.c.html#LN767"><span class='Ref_to_Parameter'>flags</span></a> <span class='Operator'>& </span><a href="createplan.c.html#LN67"><span class='Ref_to_Const'>CP_LABEL_TLIST</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><a href="createplan.c.html#LN767"><span class='Ref_to_Parameter'>path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN953"><span class='Ref_to_Member'>pathtarget</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN883"><span class='Ref_to_Member'>sortgrouprefs</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span><a name="LN843"></a>        <a href="../../../include/nodes/bitmapset.h.html#LN36"><span class='Ref_to_Struct'>Bitmapset</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>sortgroupatts</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN770"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN771"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN767"><span class='Ref_to_Parameter'>path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN953"><span class='Ref_to_Member'>pathtarget</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN882"><span class='Ref_to_Member'>exprs</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN848"></a>            <a href="../../../include/nodes/primnodes.h.html#LN131"><span class='Ref_to_Struct'>Expr</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>expr</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN131"><span class='Ref_to_Struct'>Expr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN771"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN767"><span class='Ref_to_Parameter'>path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN953"><span class='Ref_to_Member'>pathtarget</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN883"><span class='Ref_to_Member'>sortgrouprefs</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN770"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN848"><span class='Ref_To_Local'>expr</span></a> <span class='Operator'>&& </span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN848"><span class='Ref_To_Local'>expr</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a><span class='Parentheses'>))</span> 
                <span class='Delimiter'>{ 
</span><a name="LN854"></a>                    <span class='Keyword'>int</span>         <span class='Declare_Local'>attno</span> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="../../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN848"><span class='Ref_To_Local'>expr</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>varattno<span class='Delimiter'>; 
</span> 
                    <a href="createplan.c.html#LN854"><span class='Ref_To_Local'>attno</span></a> <span class='Operator'>-= </span><a href="../../../include/access/sysattr.h.html#LN27"><span class='Ref_to_Const'>FirstLowInvalidHeapAttributeNumber</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/bitmapset.h.html#LN75"><span class='Ref_to_Proto'>bms_is_member</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN854"><span class='Ref_To_Local'>attno</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN843"><span class='Ref_To_Local'>sortgroupatts</span></a><span class='Parentheses'>))</span> 
                        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                    <a href="createplan.c.html#LN843"><span class='Ref_To_Local'>sortgroupatts</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/bitmapset.h.html#LN89"><span class='Ref_to_Proto'>bms_add_member</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN843"><span class='Ref_To_Local'>sortgroupatts</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN854"><span class='Ref_To_Local'>attno</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <a href="createplan.c.html#LN770"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if (flags&CP_LABEL_TLIST... &raquo; </span> 
 
    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end use_physical_tlist &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * get_gating_quals 
 *    See if there are pseudoconstant quals in a node's quals list 
 * 
 * If the node's quals list includes any pseudoconstant quals, 
 * return just those quals. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>* 
</span><a name="LN879"></a><span class='Declare_Function'>get_gating_quals</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>quals</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* No need to look if we know there are no pseudoconstants */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="createplan.c.html#LN879"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN302"><span class='Ref_to_Member'>hasPseudoConstantQuals</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Sort into desirable execution order while still in RestrictInfo form */ 
</span>    <a href="createplan.c.html#LN879"><span class='Ref_to_Parameter'>quals</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN161"><span class='Ref_to_Proto'>order_qual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN879"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN879"><span class='Ref_to_Parameter'>quals</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Pull out any pseudoconstant quals from the RestrictInfo list */ 
</span>    <span class='Control'>return</span> <a href="../../../include/optimizer/restrictinfo.h.html#LN35"><span class='Ref_to_Proto'>extract_actual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN879"><span class='Ref_to_Parameter'>quals</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * create_gating_plan 
 *    Deal with pseudoconstant qual clauses 
 * 
 * Add a gating Result node atop the already-built plan. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>* 
</span><a name="LN899"></a><span class='Declare_Function'>create_gating_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>path</span><span class='Delimiter'>, </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>plan</span><span class='Delimiter'>, 
</span><a name="LN900"></a>                   <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>gating_quals</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN902"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>gplan</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN900"><span class='Ref_to_Parameter'>gating_quals</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Since we need a Result node anyway, always return the path's requested 
     * tlist; that's never a wrong choice, even if the parent node didn't ask 
     * for CP_EXACT_TLIST. 
     */ 
</span>    <a href="createplan.c.html#LN902"><span class='Ref_To_Local'>gplan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN274"><span class='Ref_to_Proto'>make_result</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN74"><span class='Ref_to_Proto'>build_path_tlist</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN899"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN899"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                 <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN900"><span class='Ref_to_Parameter'>gating_quals</span></a><span class='Delimiter'>, 
</span>                                 <a href="createplan.c.html#LN899"><span class='Ref_to_Parameter'>plan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Notice that we don't change cost or size estimates when doing gating. 
     * The costs of qual eval were already included in the subplan's cost. 
     * Leaving the size alone amounts to assuming that the gating qual will 
     * succeed, which is the conservative estimate for planning upper queries. 
     * We certainly don't want to assume the output size is zero (unless the 
     * gating qual is actually constant FALSE, and that case is dealt with in 
     * clausesel.c).  Interpolating between the two cases is silly, because it 
     * doesn't reflect what will really happen at runtime, and besides which 
     * in most cases we have only a very bad idea of the probability of the 
     * gating qual being true. 
     */ 
</span>    <a href="createplan.c.html#LN163"><span class='Ref_to_Proto'>copy_plan_costsize</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN902"><span class='Ref_To_Local'>gplan</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN899"><span class='Ref_to_Parameter'>plan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Gating quals could be unsafe, so better use the Path's safety flag */ 
</span>    <a href="createplan.c.html#LN902"><span class='Ref_To_Local'>gplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN137"><span class='Ref_to_Member'>parallel_safe</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN899"><span class='Ref_to_Parameter'>path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN958"><span class='Ref_to_Member'>parallel_safe</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN902"><span class='Ref_To_Local'>gplan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_gating_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_join_plan 
 *    Create a join plan for 'best_path' and (recursively) plans for its 
 *    inner and outer paths. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>* 
</span><a name="LN941"></a><span class='Declare_Function'>create_join_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1286"><span class='Ref_to_Struct'>JoinPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN943"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span><a name="LN944"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>gating_clauses</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN941"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1288"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN950"><span class='Ref_to_Member'>pathtype</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN71"><span class='Ref_to_EnumConst'>T_MergeJoin</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN943"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN151"><span class='Ref_to_Proto'>create_mergejoin_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN941"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                  <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1348"><span class='Ref_to_Struct'>MergePath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN941"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN72"><span class='Ref_to_EnumConst'>T_HashJoin</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN943"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN152"><span class='Ref_to_Proto'>create_hashjoin_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN941"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                 <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1367"><span class='Ref_to_Struct'>HashPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN941"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN70"><span class='Ref_to_EnumConst'>T_NestLoop</span></a><span class='Operator'>: 
</span>            <a href="createplan.c.html#LN943"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN150"><span class='Ref_to_Proto'>create_nestloop_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN941"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                 <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1311"><span class='Ref_to_Typedef'>NestPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN941"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized node type: %d"</span><span class='Delimiter'>, 
</span>                 <span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN941"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1288"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN950"><span class='Ref_to_Member'>pathtype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN943"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch best_path-&GT;path.patht... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* 
     * If there are any pseudoconstant clauses attached to this node, insert a 
     * gating Result node that evaluates the pseudoconstants as one-time 
     * quals. 
     */ 
</span>    <a href="createplan.c.html#LN944"><span class='Ref_To_Local'>gating_clauses</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN76"><span class='Ref_to_Proto'>get_gating_quals</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN941"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN941"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1298"><span class='Ref_to_Member'>joinrestrictinfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN944"><span class='Ref_To_Local'>gating_clauses</span></a><span class='Parentheses'>) 
</span>        <a href="createplan.c.html#LN943"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN77"><span class='Ref_to_Proto'>create_gating_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN941"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN941"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN943"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>, 
</span>                                  <a href="createplan.c.html#LN944"><span class='Ref_To_Local'>gating_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Directive'>#ifdef</span> NOT_USED 
 
    <span class='Comment_Multi_Line'>/* 
     * * Expensive function pullups may have pulled local predicates * into 
     * this path node.  Put them in the qpqual of the plan node. * JMH, 
     * 6/15/92 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>get_loc_restrictinfo<span class='Parentheses'>(</span><a href="createplan.c.html#LN941"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span> 
        set_qpqual<span class='Parentheses'>((</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a><span class='Parentheses'>)</span> <a href="createplan.c.html#LN943"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>, 
</span>                   <a href="../../../include/nodes/pg_list.h.html#LN219"><span class='Ref_to_Proto'>list_concat</span></a><span class='Parentheses'>(</span>get_qpqual<span class='Parentheses'>((</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a><span class='Parentheses'>) </span><a href="createplan.c.html#LN943"><span class='Ref_To_Local'>plan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                       <a href="../../../include/optimizer/restrictinfo.h.html#LN34"><span class='Ref_to_Proto'>get_actual_clauses</span></a><span class='Parentheses'>(</span>get_loc_restrictinfo<span class='Parentheses'>(</span><a href="createplan.c.html#LN941"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
 
    <span class='Control'>return</span> <a href="createplan.c.html#LN943"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_join_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_append_plan 
 *    Create an Append plan for 'best_path' and (recursively) plans 
 *    for its subpaths. 
 * 
 *    Returns a Plan node. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>* 
</span><a name="LN1001"></a><span class='Declare_Function'>create_append_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1174"><span class='Ref_to_Struct'>AppendPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1003"></a>    <a href="../../../include/nodes/plannodes.h.html#LN244"><span class='Ref_to_Struct'>Append</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span><a name="LN1004"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>tlist</span> <span class='Operator'>= </span><a href="createplan.c.html#LN74"><span class='Ref_to_Proto'>build_path_tlist</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1001"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN1001"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1176"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1005"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplans</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN1006"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>subpaths</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * The subpaths list could be empty, if every child was proven empty by 
     * constraint exclusion.  In that case generate a dummy plan that returns 
     * no rows. 
     * 
     * Note that an AppendPath with no members is also generated in certain 
     * cases where there was no appending construct at all, but we know the 
     * relation is empty (see set_dummy_rel_pathlist). 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN1001"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1179"><span class='Ref_to_Member'>subpaths</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Generate a Result plan with constant-FALSE gating qual */ 
</span><a name="LN1020"></a>        <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN1020"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN274"><span class='Ref_to_Proto'>make_result</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1004"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, 
</span>                                    <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>)</span> <a href="../../../include/nodes/pg_list.h.html#LN138"><span class='Ref_to_Macro'>list_make1</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/makefuncs.h.html#LN59"><span class='Ref_to_Proto'>makeBoolConst</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Delimiter'>, 
</span>                                                                      <span class='Boolean'>false</span><span class='Parentheses'>))</span><span class='Delimiter'>, 
</span>                                    <span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1020"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN1001"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>return</span> <a href="createplan.c.html#LN1020"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Build the plan for each child */ 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1006"><span class='Ref_To_Local'>subpaths</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1001"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1179"><span class='Ref_to_Member'>subpaths</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1035"></a>        <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subpath</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1006"><span class='Ref_To_Local'>subpaths</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1036"></a>        <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplan</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Must insist that all children return the same tlist */ 
</span>        <a href="createplan.c.html#LN1036"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1001"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1035"><span class='Ref_To_Local'>subpath</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN65"><span class='Ref_to_Const'>CP_EXACT_TLIST</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN1005"><span class='Ref_To_Local'>subplans</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1005"><span class='Ref_To_Local'>subplans</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1036"><span class='Ref_To_Local'>subplan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * XXX ideally, if there's just one child, we'd not bother to generate an 
     * Append node but just return the single child.  At the moment this does 
     * not work because the varno of the child scan plan won't match the 
     * parent-rel Vars it'll be asked to emit. 
     */ 
</span> 
    <a href="createplan.c.html#LN1003"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN205"><span class='Ref_to_Proto'>make_append</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1005"><span class='Ref_To_Local'>subplans</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1004"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1001"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1178"><span class='Ref_to_Member'>partitioned_rels</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN1003"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN246"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN1001"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN1003"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_append_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_merge_append_plan 
 *    Create a MergeAppend plan for 'best_path' and (recursively) plans 
 *    for its subpaths. 
 * 
 *    Returns a Plan node. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>* 
</span><a name="LN1066"></a><span class='Declare_Function'>create_merge_append_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1194"><span class='Ref_to_Struct'>MergeAppendPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1068"></a>    <a href="../../../include/nodes/plannodes.h.html#LN257"><span class='Ref_to_Struct'>MergeAppend</span></a> <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN257"><span class='Ref_to_Struct'>MergeAppend</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1069"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN1068"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN259"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span><a name="LN1070"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>tlist</span> <span class='Operator'>= </span><a href="createplan.c.html#LN74"><span class='Ref_to_Proto'>build_path_tlist</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1066"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN1066"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1196"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1071"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>pathkeys</span> <span class='Operator'>= </span><a href="createplan.c.html#LN1066"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1196"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN967"><span class='Ref_to_Member'>pathkeys</span></a><span class='Delimiter'>; 
</span><a name="LN1072"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplans</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN1073"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>subpaths</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We don't have the actual creation of the MergeAppend node split out 
     * into a separate make_xxx function.  This is because we want to run 
     * prepare_sort_from_pathkeys on it before we do so on the individual 
     * child plans, to make cross-checking the sort info easier. 
     */ 
</span>    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1069"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN1066"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN1069"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1070"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN1069"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN1069"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN1069"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Compute sort column info, and adjust MergeAppend's tlist as needed */ 
</span>    <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN240"><span class='Ref_to_Proto'>prepare_sort_from_pathkeys</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1069"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1071"><span class='Ref_To_Local'>pathkeys</span></a><span class='Delimiter'>, 
</span>                                      <a href="createplan.c.html#LN1066"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1196"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, 
</span>                                      <span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                                      <span class='Boolean'>true</span><span class='Delimiter'>, 
</span>                                      <span class='Operator'>&</span><a href="createplan.c.html#LN1068"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN264"><span class='Ref_to_Member'>numCols</span></a><span class='Delimiter'>, 
</span>                                      <span class='Operator'>&</span><a href="createplan.c.html#LN1068"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN265"><span class='Ref_to_Member'>sortColIdx</span></a><span class='Delimiter'>, 
</span>                                      <span class='Operator'>&</span><a href="createplan.c.html#LN1068"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN266"><span class='Ref_to_Member'>sortOperators</span></a><span class='Delimiter'>, 
</span>                                      <span class='Operator'>&</span><a href="createplan.c.html#LN1068"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN267"><span class='Ref_to_Member'>collations</span></a><span class='Delimiter'>, 
</span>                                      <span class='Operator'>&</span><a href="createplan.c.html#LN1068"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN268"><span class='Ref_to_Member'>nullsFirst</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Now prepare the child plans.  We must apply prepare_sort_from_pathkeys 
     * even to subplans that don't need an explicit sort, to make sure they 
     * are returning the same sort key columns the MergeAppend expects. 
     */ 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1073"><span class='Ref_To_Local'>subpaths</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1066"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1199"><span class='Ref_to_Member'>subpaths</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1105"></a>        <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subpath</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1073"><span class='Ref_To_Local'>subpaths</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1106"></a>        <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplan</span><span class='Delimiter'>; 
</span><a name="LN1107"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>numsortkeys</span><span class='Delimiter'>; 
</span><a name="LN1108"></a>        <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Local'>sortColIdx</span><span class='Delimiter'>; 
</span><a name="LN1109"></a>        <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>sortOperators</span><span class='Delimiter'>; 
</span><a name="LN1110"></a>        <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>collations</span><span class='Delimiter'>; 
</span><a name="LN1111"></a>        <span class='Keyword'>bool</span>       <span class='Operator'>*</span><span class='Declare_Local'>nullsFirst</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Build the child plan */ 
</span>        <span class='Comment_Multi_Line'>/* Must insist that all children return the same tlist */ 
</span>        <a href="createplan.c.html#LN1106"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1066"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1105"><span class='Ref_To_Local'>subpath</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN65"><span class='Ref_to_Const'>CP_EXACT_TLIST</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Compute sort column info, and adjust subplan's tlist as needed */ 
</span>        <a href="createplan.c.html#LN1106"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN240"><span class='Ref_to_Proto'>prepare_sort_from_pathkeys</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1106"><span class='Ref_To_Local'>subplan</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1071"><span class='Ref_To_Local'>pathkeys</span></a><span class='Delimiter'>, 
</span>                                             <a href="createplan.c.html#LN1105"><span class='Ref_To_Local'>subpath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, 
</span>                                             <a href="createplan.c.html#LN1068"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN265"><span class='Ref_to_Member'>sortColIdx</span></a><span class='Delimiter'>, 
</span>                                             <span class='Boolean'>false</span><span class='Delimiter'>, 
</span>                                             <span class='Operator'>&</span><a href="createplan.c.html#LN1107"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Delimiter'>, 
</span>                                             <span class='Operator'>&</span><a href="createplan.c.html#LN1108"><span class='Ref_To_Local'>sortColIdx</span></a><span class='Delimiter'>, 
</span>                                             <span class='Operator'>&</span><a href="createplan.c.html#LN1109"><span class='Ref_To_Local'>sortOperators</span></a><span class='Delimiter'>, 
</span>                                             <span class='Operator'>&</span><a href="createplan.c.html#LN1110"><span class='Ref_To_Local'>collations</span></a><span class='Delimiter'>, 
</span>                                             <span class='Operator'>&</span><a href="createplan.c.html#LN1111"><span class='Ref_To_Local'>nullsFirst</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Check that we got the same sort key information.  We just Assert 
         * that the sortops match, since those depend only on the pathkeys; 
         * but it seems like a good idea to check the sort column numbers 
         * explicitly, to ensure the tlists really do match up. 
         */ 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN1107"><span class='Ref_To_Local'>numsortkeys</span></a> <span class='Operator'>== </span><a href="createplan.c.html#LN1068"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN264"><span class='Ref_to_Member'>numCols</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>memcmp<span class='Parentheses'>(</span><a href="createplan.c.html#LN1108"><span class='Ref_To_Local'>sortColIdx</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1068"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN265"><span class='Ref_to_Member'>sortColIdx</span></a><span class='Delimiter'>, 
</span>                   <a href="createplan.c.html#LN1107"><span class='Ref_To_Local'>numsortkeys</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"MergeAppend child's targetlist doesn't match MergeAppend"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span>memcmp<span class='Parentheses'>(</span><a href="createplan.c.html#LN1109"><span class='Ref_To_Local'>sortOperators</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1068"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN266"><span class='Ref_to_Member'>sortOperators</span></a><span class='Delimiter'>, 
</span>                      <a href="createplan.c.html#LN1107"><span class='Ref_To_Local'>numsortkeys</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span>memcmp<span class='Parentheses'>(</span><a href="createplan.c.html#LN1110"><span class='Ref_To_Local'>collations</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1068"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN267"><span class='Ref_to_Member'>collations</span></a><span class='Delimiter'>, 
</span>                      <a href="createplan.c.html#LN1107"><span class='Ref_To_Local'>numsortkeys</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span>memcmp<span class='Parentheses'>(</span><a href="createplan.c.html#LN1111"><span class='Ref_To_Local'>nullsFirst</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1068"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN268"><span class='Ref_to_Member'>nullsFirst</span></a><span class='Delimiter'>, 
</span>                      <a href="createplan.c.html#LN1107"><span class='Ref_To_Local'>numsortkeys</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Keyword'>bool</span><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Now, insert a Sort node if subplan isn't sufficiently ordered */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/optimizer/paths.h.html#LN183"><span class='Ref_to_Proto'>pathkeys_contained_in</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1071"><span class='Ref_To_Local'>pathkeys</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1105"><span class='Ref_To_Local'>subpath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN967"><span class='Ref_to_Member'>pathkeys</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN1148"></a>            <a href="../../../include/nodes/plannodes.h.html#LN743"><span class='Ref_to_Struct'>Sort</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>sort</span> <span class='Operator'>= </span><a href="createplan.c.html#LN237"><span class='Ref_to_Proto'>make_sort</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1106"><span class='Ref_To_Local'>subplan</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1107"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Delimiter'>, 
</span>                                         <a href="createplan.c.html#LN1108"><span class='Ref_To_Local'>sortColIdx</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1109"><span class='Ref_To_Local'>sortOperators</span></a><span class='Delimiter'>, 
</span>                                         <a href="createplan.c.html#LN1110"><span class='Ref_To_Local'>collations</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1111"><span class='Ref_To_Local'>nullsFirst</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="createplan.c.html#LN164"><span class='Ref_to_Proto'>label_sort_with_costsize</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1066"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1148"><span class='Ref_To_Local'>sort</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1066"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1200"><span class='Ref_to_Member'>limit_tuples</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN1106"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN1148"><span class='Ref_To_Local'>sort</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="createplan.c.html#LN1072"><span class='Ref_To_Local'>subplans</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1072"><span class='Ref_To_Local'>subplans</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1106"><span class='Ref_To_Local'>subplan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="createplan.c.html#LN1068"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN261"><span class='Ref_to_Member'>partitioned_rels</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1066"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1198"><span class='Ref_to_Member'>partitioned_rels</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN1068"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN262"><span class='Ref_to_Member'>mergeplans</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1072"><span class='Ref_To_Local'>subplans</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN1068"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_merge_append_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_result_plan 
 *    Create a Result plan for 'best_path'. 
 *    This is only used for degenerate cases, such as a query with an empty 
 *    jointree. 
 * 
 *    Returns a Plan node. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN187"><span class='Ref_to_Struct'>Result</span></a> <span class='Operator'>* 
</span><a name="LN1174"></a><span class='Declare_Function'>create_result_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1210"><span class='Ref_to_Struct'>ResultPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1176"></a>    <a href="../../../include/nodes/plannodes.h.html#LN187"><span class='Ref_to_Struct'>Result</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span><a name="LN1177"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>tlist</span><span class='Delimiter'>; 
</span><a name="LN1178"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>quals</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN1177"><span class='Ref_To_Local'>tlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN74"><span class='Ref_to_Proto'>build_path_tlist</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1174"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN1174"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1212"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* best_path-&GT;quals is just bare clauses */ 
</span>    <a href="createplan.c.html#LN1178"><span class='Ref_To_Local'>quals</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN161"><span class='Ref_to_Proto'>order_qual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1174"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1174"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1213"><span class='Ref_to_Member'>quals</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN1176"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN274"><span class='Ref_to_Proto'>make_result</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1177"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN1178"><span class='Ref_To_Local'>quals</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN1176"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN189"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN1174"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN1176"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * create_project_set_plan 
 *    Create a ProjectSet plan for 'best_path'. 
 * 
 *    Returns a Plan node. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN199"><span class='Ref_to_Struct'>ProjectSet</span></a> <span class='Operator'>* 
</span><a name="LN1199"></a><span class='Declare_Function'>create_project_set_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1400"><span class='Ref_to_Struct'>ProjectSetPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1201"></a>    <a href="../../../include/nodes/plannodes.h.html#LN199"><span class='Ref_to_Struct'>ProjectSet</span></a> <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span><a name="LN1202"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplan</span><span class='Delimiter'>; 
</span><a name="LN1203"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>tlist</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Since we intend to project, we don't need to constrain child tlist */ 
</span>    <a href="createplan.c.html#LN1202"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1199"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1199"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1403"><span class='Ref_to_Member'>subpath</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN1203"><span class='Ref_To_Local'>tlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN74"><span class='Ref_to_Proto'>build_path_tlist</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1199"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN1199"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1402"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN1201"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN275"><span class='Ref_to_Proto'>make_project_set</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1203"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1202"><span class='Ref_To_Local'>subplan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN1201"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN201"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN1199"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN1201"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * create_material_plan 
 *    Create a Material plan for 'best_path' and (recursively) plans 
 *    for its subpaths. 
 * 
 *    Returns a Plan node. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN734"><span class='Ref_to_Struct'>Material</span></a> <span class='Operator'>* 
</span><a name="LN1225"></a><span class='Declare_Function'>create_material_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1222"><span class='Ref_to_Struct'>MaterialPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>flags</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1227"></a>    <a href="../../../include/nodes/plannodes.h.html#LN734"><span class='Ref_to_Struct'>Material</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span><a name="LN1228"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplan</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We don't want any excess columns in the materialized tuples, so request 
     * a smaller tlist.  Otherwise, since Material doesn't project, tlist 
     * requirements pass through. 
     */ 
</span>    <a href="createplan.c.html#LN1228"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1225"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1225"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1225"><span class='Ref_to_Member'>subpath</span></a><span class='Delimiter'>, 
</span>                                  <a href="createplan.c.html#LN1225"><span class='Ref_to_Parameter'>flags</span></a> <span class='Operator'>| </span><a href="createplan.c.html#LN66"><span class='Ref_to_Const'>CP_SMALL_TLIST</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN1227"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN256"><span class='Ref_to_Proto'>make_material</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1228"><span class='Ref_To_Local'>subplan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN1227"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN736"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN1225"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN1227"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_material_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_unique_plan 
 *    Create a Unique plan for 'best_path' and (recursively) plans 
 *    for its subpaths. 
 * 
 *    Returns a Plan node. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>* 
</span><a name="LN1253"></a><span class='Declare_Function'>create_unique_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1247"><span class='Ref_to_Struct'>UniquePath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>flags</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1255"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span><a name="LN1256"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplan</span><span class='Delimiter'>; 
</span><a name="LN1257"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>in_operators</span><span class='Delimiter'>; 
</span><a name="LN1258"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>uniq_exprs</span><span class='Delimiter'>; 
</span><a name="LN1259"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>newtlist</span><span class='Delimiter'>; 
</span><a name="LN1260"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>nextresno</span><span class='Delimiter'>; 
</span><a name="LN1261"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>newitems</span><span class='Delimiter'>; 
</span><a name="LN1262"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>numGroupCols</span><span class='Delimiter'>; 
</span><a name="LN1263"></a>    <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Local'>groupColIdx</span><span class='Delimiter'>; 
</span><a name="LN1264"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>groupColPos</span><span class='Delimiter'>; 
</span><a name="LN1265"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Unique doesn't project, so tlist requirements pass through */ 
</span>    <a href="createplan.c.html#LN1256"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1253"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1253"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1250"><span class='Ref_to_Member'>subpath</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1253"><span class='Ref_to_Parameter'>flags</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Done if we don't need to do any actual unique-ifying */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN1253"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1251"><span class='Ref_to_Member'>umethod</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/relation.h.html#LN1242"><span class='Ref_to_EnumConst'>UNIQUE_PATH_NOOP</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="createplan.c.html#LN1256"><span class='Ref_To_Local'>subplan</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * As constructed, the subplan has a "flat" tlist containing just the Vars 
     * needed here and at upper levels.  The values we are supposed to 
     * unique-ify may be expressions in these variables.  We have to add any 
     * such expressions to the subplan's tlist. 
     * 
     * The subplan may have a "physical" tlist if it is a simple scan plan. If 
     * we're going to sort, this should be reduced to the regular tlist, so 
     * that we don't sort more data than we need to.  For hashing, the tlist 
     * should be left as-is if we don't need to add any expressions; but if we 
     * do have to add expressions, then a projection step will be needed at 
     * runtime anyway, so we may as well remove unneeded items. Therefore 
     * newtlist starts from build_path_tlist() not just a copy of the 
     * subplan's tlist; and we don't install it into the subplan unless we are 
     * sorting or stuff has to be added. 
     */ 
</span>    <a href="createplan.c.html#LN1257"><span class='Ref_To_Local'>in_operators</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1253"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1252"><span class='Ref_to_Member'>in_operators</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN1258"><span class='Ref_To_Local'>uniq_exprs</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1253"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1253"><span class='Ref_to_Member'>uniq_exprs</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* initialize modified subplan tlist as just the "required" vars */ 
</span>    <a href="createplan.c.html#LN1259"><span class='Ref_To_Local'>newtlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN74"><span class='Ref_to_Proto'>build_path_tlist</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1253"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN1253"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1249"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN1260"><span class='Ref_To_Local'>nextresno</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1259"><span class='Ref_To_Local'>newtlist</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN1261"><span class='Ref_To_Local'>newitems</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1265"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1258"><span class='Ref_To_Local'>uniq_exprs</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1300"></a>        <a href="../../../include/nodes/primnodes.h.html#LN131"><span class='Ref_to_Struct'>Expr</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>uniqexpr</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1265"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1301"></a>        <a href="../../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>tle</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN1301"><span class='Ref_To_Local'>tle</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/tlist.h.html#LN19"><span class='Ref_to_Proto'>tlist_member</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1300"><span class='Ref_To_Local'>uniqexpr</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1259"><span class='Ref_To_Local'>newtlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="createplan.c.html#LN1301"><span class='Ref_To_Local'>tle</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="createplan.c.html#LN1301"><span class='Ref_To_Local'>tle</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/makefuncs.h.html#LN40"><span class='Ref_to_Proto'>makeTargetEntry</span></a><span class='Parentheses'>((</span><a href="../../../include/nodes/primnodes.h.html#LN131"><span class='Ref_to_Struct'>Expr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN1300"><span class='Ref_To_Local'>uniqexpr</span></a><span class='Delimiter'>, 
</span>                                  <a href="createplan.c.html#LN1260"><span class='Ref_To_Local'>nextresno</span></a><span class='Delimiter'>, 
</span>                                  <span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                                  <span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN1259"><span class='Ref_To_Local'>newtlist</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1259"><span class='Ref_To_Local'>newtlist</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1301"><span class='Ref_To_Local'>tle</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN1260"><span class='Ref_To_Local'>nextresno</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN1261"><span class='Ref_To_Local'>newitems</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN1261"><span class='Ref_To_Local'>newitems</span></a> <span class='Operator'>|| </span><a href="createplan.c.html#LN1253"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1251"><span class='Ref_to_Member'>umethod</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/relation.h.html#LN1244"><span class='Ref_to_EnumConst'>UNIQUE_PATH_SORT</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * If the top plan node can't do projections and its existing target 
         * list isn't already what we need, we need to add a Result node to 
         * help it along. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/optimizer/planmain.h.html#LN56"><span class='Ref_to_Proto'>is_projection_capable_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1256"><span class='Ref_To_Local'>subplan</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>            <span class='Operator'>!</span><a href="../../../include/optimizer/tlist.h.html#LN28"><span class='Ref_to_Proto'>tlist_same_exprs</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1259"><span class='Ref_To_Local'>newtlist</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1256"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Parentheses'>))</span> 
            <a href="createplan.c.html#LN1256"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN90"><span class='Ref_to_Proto'>inject_projection_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1256"><span class='Ref_To_Local'>subplan</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1259"><span class='Ref_To_Local'>newtlist</span></a><span class='Delimiter'>, 
</span>                                             <a href="createplan.c.html#LN1253"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1249"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN958"><span class='Ref_to_Member'>parallel_safe</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="createplan.c.html#LN1256"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1259"><span class='Ref_To_Local'>newtlist</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Build control information showing which subplan output columns are to 
     * be examined by the grouping step.  Unfortunately we can't merge this 
     * with the previous loop, since we didn't then know which version of the 
     * subplan tlist we'd end up using. 
     */ 
</span>    <a href="createplan.c.html#LN1259"><span class='Ref_To_Local'>newtlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1256"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN1262"><span class='Ref_To_Local'>numGroupCols</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1258"><span class='Ref_To_Local'>uniq_exprs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN1263"><span class='Ref_To_Local'>groupColIdx</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1262"><span class='Ref_To_Local'>numGroupCols</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN1264"><span class='Ref_To_Local'>groupColPos</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1265"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1258"><span class='Ref_To_Local'>uniq_exprs</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1344"></a>        <a href="../../../include/nodes/primnodes.h.html#LN131"><span class='Ref_to_Struct'>Expr</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>uniqexpr</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1265"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1345"></a>        <a href="../../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>tle</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN1345"><span class='Ref_To_Local'>tle</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/tlist.h.html#LN19"><span class='Ref_to_Proto'>tlist_member</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1344"><span class='Ref_To_Local'>uniqexpr</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1259"><span class='Ref_To_Local'>newtlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="createplan.c.html#LN1345"><span class='Ref_To_Local'>tle</span></a><span class='Parentheses'>)</span>               <span class='Comment_Single_Line'>/* shouldn't happen */ 
</span>            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"failed to find unique expression in subplan tlist"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN1263"><span class='Ref_To_Local'>groupColIdx</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN1264"><span class='Ref_To_Local'>groupColPos</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN1345"><span class='Ref_To_Local'>tle</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN1367"><span class='Ref_to_Member'>resno</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN1253"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1251"><span class='Ref_to_Member'>umethod</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/relation.h.html#LN1243"><span class='Ref_to_EnumConst'>UNIQUE_PATH_HASH</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1355"></a>        <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>groupOperators</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Get the hashable equality operators for the Agg node to use. 
         * Normally these are the same as the IN clause operators, but if 
         * those are cross-type operators then the equality operators are the 
         * ones for the IN clause operators' RHS datatype. 
         */ 
</span>        <a href="createplan.c.html#LN1355"><span class='Ref_To_Local'>groupOperators</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1262"><span class='Ref_To_Local'>numGroupCols</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN1264"><span class='Ref_To_Local'>groupColPos</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1265"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1257"><span class='Ref_To_Local'>in_operators</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN1367"></a>            <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>in_oper</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1265"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1368"></a>            <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>eq_oper</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/utils/lsyscache.h.html#LN77"><span class='Ref_to_Proto'>get_compatible_hash_operators</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1367"><span class='Ref_To_Local'>in_oper</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN1368"><span class='Ref_To_Local'>eq_oper</span></a><span class='Parentheses'>))</span> 
                <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"could not find compatible hash operator for operator %u"</span><span class='Delimiter'>, 
</span>                     <a href="createplan.c.html#LN1367"><span class='Ref_To_Local'>in_oper</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN1355"><span class='Ref_To_Local'>groupOperators</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN1264"><span class='Ref_To_Local'>groupColPos</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN1368"><span class='Ref_To_Local'>eq_oper</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Since the Agg node is going to project anyway, we can give it the 
         * minimum output tlist, without any stuff we might have added to the 
         * subplan tlist. 
         */ 
</span>        <a href="createplan.c.html#LN1255"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/optimizer/planmain.h.html#LN60"><span class='Ref_to_Proto'>make_agg</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN74"><span class='Ref_to_Proto'>build_path_tlist</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1253"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN1253"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1249"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                 <a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>, 
</span>                                 <a href="../../../include/nodes/nodes.h.html#LN737"><span class='Ref_to_EnumConst'>AGG_HASHED</span></a><span class='Delimiter'>, 
</span>                                 <a href="../../../include/nodes/nodes.h.html#LN758"><span class='Ref_to_EnumConst'>AGGSPLIT_SIMPLE</span></a><span class='Delimiter'>, 
</span>                                 <a href="createplan.c.html#LN1262"><span class='Ref_To_Local'>numGroupCols</span></a><span class='Delimiter'>, 
</span>                                 <a href="createplan.c.html#LN1263"><span class='Ref_To_Local'>groupColIdx</span></a><span class='Delimiter'>, 
</span>                                 <a href="createplan.c.html#LN1355"><span class='Ref_To_Local'>groupOperators</span></a><span class='Delimiter'>, 
</span>                                 <a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>, 
</span>                                 <a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>, 
</span>                                 <a href="createplan.c.html#LN1253"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1249"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN963"><span class='Ref_to_Member'>rows</span></a><span class='Delimiter'>, 
</span>                                 <a href="createplan.c.html#LN1256"><span class='Ref_To_Local'>subplan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if best_path-&GT;umethod==U... &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1395"></a>        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>sortList</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN1396"></a>        <a href="../../../include/nodes/plannodes.h.html#LN743"><span class='Ref_to_Struct'>Sort</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>sort</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Create an ORDER BY list to sort the input compatibly */ 
</span>        <a href="createplan.c.html#LN1264"><span class='Ref_To_Local'>groupColPos</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1265"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1257"><span class='Ref_To_Local'>in_operators</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN1402"></a>            <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>in_oper</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1265"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1403"></a>            <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>sortop</span><span class='Delimiter'>; 
</span><a name="LN1404"></a>            <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>eqop</span><span class='Delimiter'>; 
</span><a name="LN1405"></a>            <a href="../../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>tle</span><span class='Delimiter'>; 
</span><a name="LN1406"></a>            <a href="../../../include/nodes/parsenodes.h.html#LN1161"><span class='Ref_to_Struct'>SortGroupClause</span></a> <span class='Operator'>*</span><span class='Declare_Local'>sortcl</span><span class='Delimiter'>; 
</span> 
            <a href="createplan.c.html#LN1403"><span class='Ref_To_Local'>sortop</span></a> <span class='Operator'>= </span><a href="../../../include/utils/lsyscache.h.html#LN75"><span class='Ref_to_Proto'>get_ordering_op_for_equality_op</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1402"><span class='Ref_To_Local'>in_oper</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1403"><span class='Ref_To_Local'>sortop</span></a><span class='Parentheses'>))</span>    <span class='Comment_Single_Line'>/* shouldn't happen */ 
</span>                <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"could not find ordering operator for equality operator %u"</span><span class='Delimiter'>, 
</span>                     <a href="createplan.c.html#LN1402"><span class='Ref_To_Local'>in_oper</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * The Unique node will need equality operators.  Normally these 
             * are the same as the IN clause operators, but if those are 
             * cross-type operators then the equality operators are the ones 
             * for the IN clause operators' RHS datatype. 
             */ 
</span>            <a href="createplan.c.html#LN1404"><span class='Ref_To_Local'>eqop</span></a> <span class='Operator'>= </span><a href="../../../include/utils/lsyscache.h.html#LN74"><span class='Ref_to_Proto'>get_equality_op_for_ordering_op</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1403"><span class='Ref_To_Local'>sortop</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1404"><span class='Ref_To_Local'>eqop</span></a><span class='Parentheses'>))</span>      <span class='Comment_Single_Line'>/* shouldn't happen */ 
</span>                <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"could not find equality operator for ordering operator %u"</span><span class='Delimiter'>, 
</span>                     <a href="createplan.c.html#LN1403"><span class='Ref_To_Local'>sortop</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="createplan.c.html#LN1405"><span class='Ref_To_Local'>tle</span></a> <span class='Operator'>= </span><a href="../../../include/parser/parsetree.h.html#LN69"><span class='Ref_to_Proto'>get_tle_by_resno</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1256"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Delimiter'>, 
</span>                                   <a href="createplan.c.html#LN1263"><span class='Ref_To_Local'>groupColIdx</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN1264"><span class='Ref_To_Local'>groupColPos</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN1405"><span class='Ref_To_Local'>tle</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="createplan.c.html#LN1406"><span class='Ref_To_Local'>sortcl</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/parsenodes.h.html#LN1161"><span class='Ref_to_Struct'>SortGroupClause</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN1406"><span class='Ref_To_Local'>sortcl</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1164"><span class='Ref_to_Member'>tleSortGroupRef</span></a> <span class='Operator'>= </span><a href="../../../include/parser/parse_clause.h.html#LN50"><span class='Ref_to_Proto'>assignSortGroupRef</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1405"><span class='Ref_To_Local'>tle</span></a><span class='Delimiter'>, 
</span>                                                         <a href="createplan.c.html#LN1256"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN1406"><span class='Ref_To_Local'>sortcl</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1165"><span class='Ref_to_Member'>eqop</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1404"><span class='Ref_To_Local'>eqop</span></a><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN1406"><span class='Ref_To_Local'>sortcl</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1166"><span class='Ref_to_Member'>sortop</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1403"><span class='Ref_To_Local'>sortop</span></a><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN1406"><span class='Ref_To_Local'>sortcl</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1167"><span class='Ref_to_Member'>nulls_first</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN1406"><span class='Ref_To_Local'>sortcl</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1168"><span class='Ref_to_Member'>hashable</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>;</span>   <span class='Comment_Single_Line'>/* no need to make this accurate */ 
</span>            <a href="createplan.c.html#LN1395"><span class='Ref_To_Local'>sortList</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1395"><span class='Ref_To_Local'>sortList</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1406"><span class='Ref_To_Local'>sortcl</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN1264"><span class='Ref_To_Local'>groupColPos</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="createplan.c.html#LN1396"><span class='Ref_To_Local'>sort</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/planmain.h.html#LN59"><span class='Ref_to_Proto'>make_sort_from_sortclauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1395"><span class='Ref_To_Local'>sortList</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1256"><span class='Ref_To_Local'>subplan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN164"><span class='Ref_to_Proto'>label_sort_with_costsize</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1253"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1396"><span class='Ref_To_Local'>sort</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN1255"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN265"><span class='Ref_to_Proto'>make_unique_from_sortclauses</span></a><span class='Parentheses'>((</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN1396"><span class='Ref_To_Local'>sort</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1395"><span class='Ref_To_Local'>sortList</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Copy cost data from Path to Plan */ 
</span>    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1255"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN1253"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1249"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN1255"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_unique_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_gather_plan 
 * 
 *    Create a Gather plan for 'best_path' and (recursively) plans 
 *    for its subpaths. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN831"><span class='Ref_to_Struct'>Gather</span></a> <span class='Operator'>* 
</span><a name="LN1456"></a><span class='Declare_Function'>create_gather_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1261"><span class='Ref_to_Struct'>GatherPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1458"></a>    <a href="../../../include/nodes/plannodes.h.html#LN831"><span class='Ref_to_Struct'>Gather</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>gather_plan</span><span class='Delimiter'>; 
</span><a name="LN1459"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplan</span><span class='Delimiter'>; 
</span><a name="LN1460"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>tlist</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Although the Gather node can project, we prefer to push down such work 
     * to its child node, so demand an exact tlist from the child. 
     */ 
</span>    <a href="createplan.c.html#LN1459"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1456"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1456"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1264"><span class='Ref_to_Member'>subpath</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN65"><span class='Ref_to_Const'>CP_EXACT_TLIST</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN1460"><span class='Ref_To_Local'>tlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN74"><span class='Ref_to_Proto'>build_path_tlist</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1456"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN1456"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1263"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN1458"><span class='Ref_To_Local'>gather_plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN268"><span class='Ref_to_Proto'>make_gather</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1460"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, 
</span>                              <a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>, 
</span>                              <a href="createplan.c.html#LN1456"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1266"><span class='Ref_to_Member'>num_workers</span></a><span class='Delimiter'>, 
</span>                              <a href="createplan.c.html#LN1456"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1265"><span class='Ref_to_Member'>single_copy</span></a><span class='Delimiter'>, 
</span>                              <a href="createplan.c.html#LN1459"><span class='Ref_To_Local'>subplan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN1458"><span class='Ref_To_Local'>gather_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN833"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN1456"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1263"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* use parallel mode for parallel plans. */ 
</span>    <a href="createplan.c.html#LN1456"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN156"><span class='Ref_to_Member'>glob</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN130"><span class='Ref_to_Member'>parallelModeNeeded</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN1458"><span class='Ref_To_Local'>gather_plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_gather_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_gather_merge_plan 
 * 
 *    Create a Gather Merge plan for 'best_path' and (recursively) 
 *    plans for its subpaths. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN843"><span class='Ref_to_Struct'>GatherMerge</span></a> <span class='Operator'>* 
</span><a name="LN1491"></a><span class='Declare_Function'>create_gather_merge_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1274"><span class='Ref_to_Struct'>GatherMergePath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1493"></a>    <a href="../../../include/nodes/plannodes.h.html#LN843"><span class='Ref_to_Struct'>GatherMerge</span></a> <span class='Operator'>*</span><span class='Declare_Local'>gm_plan</span><span class='Delimiter'>; 
</span><a name="LN1494"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplan</span><span class='Delimiter'>; 
</span><a name="LN1495"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>pathkeys</span> <span class='Operator'>= </span><a href="createplan.c.html#LN1491"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1276"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN967"><span class='Ref_to_Member'>pathkeys</span></a><span class='Delimiter'>; 
</span><a name="LN1496"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>tlist</span> <span class='Operator'>= </span><a href="createplan.c.html#LN74"><span class='Ref_to_Proto'>build_path_tlist</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1491"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN1491"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1276"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* As with Gather, it's best to project away columns in the workers. */ 
</span>    <a href="createplan.c.html#LN1494"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1491"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1491"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1277"><span class='Ref_to_Member'>subpath</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN65"><span class='Ref_to_Const'>CP_EXACT_TLIST</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Create a shell for a GatherMerge plan. */ 
</span>    <a href="createplan.c.html#LN1493"><span class='Ref_To_Local'>gm_plan</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN843"><span class='Ref_to_Struct'>GatherMerge</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN1493"><span class='Ref_To_Local'>gm_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN845"><span class='Ref_to_Member'>plan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1496"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN1493"><span class='Ref_To_Local'>gm_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN846"><span class='Ref_to_Member'>num_workers</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1491"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1278"><span class='Ref_to_Member'>num_workers</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN1493"><span class='Ref_To_Local'>gm_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN845"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN1491"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1276"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Gather Merge is pointless with no pathkeys; use Gather instead. */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN1495"><span class='Ref_To_Local'>pathkeys</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Compute sort column info, and adjust subplan's tlist as needed */ 
</span>    <a href="createplan.c.html#LN1494"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN240"><span class='Ref_to_Proto'>prepare_sort_from_pathkeys</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1494"><span class='Ref_To_Local'>subplan</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1495"><span class='Ref_To_Local'>pathkeys</span></a><span class='Delimiter'>, 
</span>                                         <a href="createplan.c.html#LN1491"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1277"><span class='Ref_to_Member'>subpath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, 
</span>                                         <a href="createplan.c.html#LN1493"><span class='Ref_To_Local'>gm_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN849"><span class='Ref_to_Member'>sortColIdx</span></a><span class='Delimiter'>, 
</span>                                         <span class='Boolean'>false</span><span class='Delimiter'>, 
</span>                                         <span class='Operator'>&</span><a href="createplan.c.html#LN1493"><span class='Ref_To_Local'>gm_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN848"><span class='Ref_to_Member'>numCols</span></a><span class='Delimiter'>, 
</span>                                         <span class='Operator'>&</span><a href="createplan.c.html#LN1493"><span class='Ref_To_Local'>gm_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN849"><span class='Ref_to_Member'>sortColIdx</span></a><span class='Delimiter'>, 
</span>                                         <span class='Operator'>&</span><a href="createplan.c.html#LN1493"><span class='Ref_To_Local'>gm_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN850"><span class='Ref_to_Member'>sortOperators</span></a><span class='Delimiter'>, 
</span>                                         <span class='Operator'>&</span><a href="createplan.c.html#LN1493"><span class='Ref_To_Local'>gm_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN851"><span class='Ref_to_Member'>collations</span></a><span class='Delimiter'>, 
</span>                                         <span class='Operator'>&</span><a href="createplan.c.html#LN1493"><span class='Ref_To_Local'>gm_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN852"><span class='Ref_to_Member'>nullsFirst</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
    <span class='Comment_Multi_Line'>/* Now, insert a Sort node if subplan isn't sufficiently ordered */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/optimizer/paths.h.html#LN183"><span class='Ref_to_Proto'>pathkeys_contained_in</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1495"><span class='Ref_To_Local'>pathkeys</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1491"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1277"><span class='Ref_to_Member'>subpath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN967"><span class='Ref_to_Member'>pathkeys</span></a><span class='Parentheses'>))</span> 
        <a href="createplan.c.html#LN1494"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN237"><span class='Ref_to_Proto'>make_sort</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1494"><span class='Ref_To_Local'>subplan</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1493"><span class='Ref_To_Local'>gm_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN848"><span class='Ref_to_Member'>numCols</span></a><span class='Delimiter'>, 
</span>                                     <a href="createplan.c.html#LN1493"><span class='Ref_To_Local'>gm_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN849"><span class='Ref_to_Member'>sortColIdx</span></a><span class='Delimiter'>, 
</span>                                     <a href="createplan.c.html#LN1493"><span class='Ref_To_Local'>gm_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN850"><span class='Ref_to_Member'>sortOperators</span></a><span class='Delimiter'>, 
</span>                                     <a href="createplan.c.html#LN1493"><span class='Ref_To_Local'>gm_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN851"><span class='Ref_to_Member'>collations</span></a><span class='Delimiter'>, 
</span>                                     <a href="createplan.c.html#LN1493"><span class='Ref_To_Local'>gm_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN852"><span class='Ref_to_Member'>nullsFirst</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Now insert the subplan under GatherMerge. */ 
</span>    <a href="createplan.c.html#LN1493"><span class='Ref_To_Local'>gm_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN845"><span class='Ref_to_Member'>plan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1494"><span class='Ref_To_Local'>subplan</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* use parallel mode for parallel plans. */ 
</span>    <a href="createplan.c.html#LN1491"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN156"><span class='Ref_to_Member'>glob</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN130"><span class='Ref_to_Member'>parallelModeNeeded</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN1493"><span class='Ref_To_Local'>gm_plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_gather_merge_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_projection_plan 
 * 
 *    Create a plan tree to do a projection step and (recursively) plans 
 *    for its subpaths.  We may need a Result node for the projection, 
 *    but sometimes we can just let the subplan do the work. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>* 
</span><a name="LN1547"></a><span class='Declare_Function'>create_projection_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1388"><span class='Ref_to_Struct'>ProjectionPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1549"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span><a name="LN1550"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplan</span><span class='Delimiter'>; 
</span><a name="LN1551"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>tlist</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Since we intend to project, we don't need to constrain child tlist */ 
</span>    <a href="createplan.c.html#LN1550"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1547"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1547"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1391"><span class='Ref_to_Member'>subpath</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN1551"><span class='Ref_To_Local'>tlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN74"><span class='Ref_to_Proto'>build_path_tlist</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1547"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN1547"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1390"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We might not really need a Result node here, either because the subplan 
     * can project or because it's returning the right list of expressions 
     * anyway.  Usually create_projection_path will have detected that and set 
     * dummypp if we don't need a Result; but its decision can't be final, 
     * because some createplan.c routines change the tlists of their nodes. 
     * (An example is that create_merge_append_plan might add resjunk sort 
     * columns to a MergeAppend.)  So we have to recheck here.  If we do 
     * arrive at a different answer than create_projection_path did, we'll 
     * have made slightly wrong cost estimates; but label the plan with the 
     * cost estimates we actually used, not "corrected" ones.  (XXX this could 
     * be cleaned up if we moved more of the sortcolumn setup logic into Path 
     * creation, but that would add expense to creating Paths we might end up 
     * not using.) 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/optimizer/planmain.h.html#LN55"><span class='Ref_to_Proto'>is_projection_capable_path</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1547"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1391"><span class='Ref_to_Member'>subpath</span></a><span class='Parentheses'>) </span><span class='Operator'>|| 
</span>        <a href="../../../include/optimizer/tlist.h.html#LN28"><span class='Ref_to_Proto'>tlist_same_exprs</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1551"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1550"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Don't need a separate Result, just assign tlist to subplan */ 
</span>        <a href="createplan.c.html#LN1549"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1550"><span class='Ref_To_Local'>subplan</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN1549"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1551"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Label plan with the estimated costs we actually used */ 
</span>        <a href="createplan.c.html#LN1549"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN124"><span class='Ref_to_Member'>startup_cost</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1547"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1390"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN964"><span class='Ref_to_Member'>startup_cost</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN1549"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN125"><span class='Ref_to_Member'>total_cost</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1547"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1390"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN965"><span class='Ref_to_Member'>total_cost</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN1549"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN130"><span class='Ref_to_Member'>plan_rows</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1547"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1390"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN963"><span class='Ref_to_Member'>rows</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN1549"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN131"><span class='Ref_to_Member'>plan_width</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1547"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1390"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN953"><span class='Ref_to_Member'>pathtarget</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN885"><span class='Ref_to_Member'>width</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN1549"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN137"><span class='Ref_to_Member'>parallel_safe</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1547"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1390"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN958"><span class='Ref_to_Member'>parallel_safe</span></a><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* ... but don't change subplan's parallel_aware flag */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* We need a Result node */ 
</span>        <a href="createplan.c.html#LN1549"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN274"><span class='Ref_to_Proto'>make_result</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1551"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="createplan.c.html#LN1550"><span class='Ref_To_Local'>subplan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1549"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN1547"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN1549"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_projection_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * inject_projection_plan 
 *    Insert a Result node to do a projection step. 
 * 
 * This is used in a few places where we decide on-the-fly that we need a 
 * projection step as part of the tree generated for some Path node. 
 * We should try to get rid of this in favor of doing it more honestly. 
 * 
 * One reason it's ugly is we have to be told the right parallel_safe marking 
 * to apply (since the tlist might be unsafe even if the child plan is safe). 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>* 
</span><a name="LN1611"></a><span class='Declare_Function'>inject_projection_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>subplan</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>parallel_safe</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1613"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN1613"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN274"><span class='Ref_to_Proto'>make_result</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1611"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="createplan.c.html#LN1611"><span class='Ref_to_Parameter'>subplan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * In principle, we should charge tlist eval cost plus cpu_per_tuple per 
     * row for the Result node.  But the former has probably been factored in 
     * already and the latter was not accounted for during Path construction, 
     * so being formally correct might just make the EXPLAIN output look less 
     * consistent not more so.  Hence, just copy the subplan's cost. 
     */ 
</span>    <a href="createplan.c.html#LN163"><span class='Ref_to_Proto'>copy_plan_costsize</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1613"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1611"><span class='Ref_to_Parameter'>subplan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN1613"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN137"><span class='Ref_to_Member'>parallel_safe</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1611"><span class='Ref_to_Parameter'>parallel_safe</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN1613"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * create_sort_plan 
 * 
 *    Create a Sort plan for 'best_path' and (recursively) plans 
 *    for its subpaths. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN743"><span class='Ref_to_Struct'>Sort</span></a> <span class='Operator'>* 
</span><a name="LN1637"></a><span class='Declare_Function'>create_sort_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1414"><span class='Ref_to_Struct'>SortPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>flags</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1639"></a>    <a href="../../../include/nodes/plannodes.h.html#LN743"><span class='Ref_to_Struct'>Sort</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span><a name="LN1640"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplan</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We don't want any excess columns in the sorted tuples, so request a 
     * smaller tlist.  Otherwise, since Sort doesn't project, tlist 
     * requirements pass through. 
     */ 
</span>    <a href="createplan.c.html#LN1640"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1637"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1637"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1417"><span class='Ref_to_Member'>subpath</span></a><span class='Delimiter'>, 
</span>                                  <a href="createplan.c.html#LN1637"><span class='Ref_to_Parameter'>flags</span></a> <span class='Operator'>| </span><a href="createplan.c.html#LN66"><span class='Ref_to_Const'>CP_SMALL_TLIST</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN1639"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN252"><span class='Ref_to_Proto'>make_sort_from_pathkeys</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1640"><span class='Ref_To_Local'>subplan</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1637"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1416"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN967"><span class='Ref_to_Member'>pathkeys</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN1639"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN745"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN1637"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN1639"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_sort_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_group_plan 
 * 
 *    Create a Group plan for 'best_path' and (recursively) plans 
 *    for its subpaths. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN759"><span class='Ref_to_Struct'>Group</span></a> <span class='Operator'>* 
</span><a name="LN1664"></a><span class='Declare_Function'>create_group_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1428"><span class='Ref_to_Struct'>GroupPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1666"></a>    <a href="../../../include/nodes/plannodes.h.html#LN759"><span class='Ref_to_Struct'>Group</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span><a name="LN1667"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplan</span><span class='Delimiter'>; 
</span><a name="LN1668"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>tlist</span><span class='Delimiter'>; 
</span><a name="LN1669"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>quals</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Group can project, so no need to be terribly picky about child tlist, 
     * but we do need grouping columns to be available 
     */ 
</span>    <a href="createplan.c.html#LN1667"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1664"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1664"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1431"><span class='Ref_to_Member'>subpath</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN67"><span class='Ref_to_Const'>CP_LABEL_TLIST</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN1668"><span class='Ref_To_Local'>tlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN74"><span class='Ref_to_Proto'>build_path_tlist</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1664"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN1664"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1430"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN1669"><span class='Ref_To_Local'>quals</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN161"><span class='Ref_to_Proto'>order_qual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1664"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1664"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1433"><span class='Ref_to_Member'>qual</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN1666"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN262"><span class='Ref_to_Proto'>make_group</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1668"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, 
</span>                      <a href="createplan.c.html#LN1669"><span class='Ref_To_Local'>quals</span></a><span class='Delimiter'>, 
</span>                      <a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1664"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1432"><span class='Ref_to_Member'>groupClause</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                      <a href="../../../include/optimizer/tlist.h.html#LN50"><span class='Ref_to_Proto'>extract_grouping_cols</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1664"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1432"><span class='Ref_to_Member'>groupClause</span></a><span class='Delimiter'>, 
</span>                                            <a href="createplan.c.html#LN1667"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                      <a href="../../../include/optimizer/tlist.h.html#LN49"><span class='Ref_to_Proto'>extract_grouping_ops</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1664"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1432"><span class='Ref_to_Member'>groupClause</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                      <a href="createplan.c.html#LN1667"><span class='Ref_To_Local'>subplan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN1666"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN761"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN1664"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN1666"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_group_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_upper_unique_plan 
 * 
 *    Create a Unique plan for 'best_path' and (recursively) plans 
 *    for its subpaths. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN819"><span class='Ref_to_Struct'>Unique</span></a> <span class='Operator'>* 
</span><a name="LN1701"></a><span class='Declare_Function'>create_upper_unique_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1442"><span class='Ref_to_Struct'>UpperUniquePath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>flags</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1703"></a>    <a href="../../../include/nodes/plannodes.h.html#LN819"><span class='Ref_to_Struct'>Unique</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span><a name="LN1704"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplan</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Unique doesn't project, so tlist requirements pass through; moreover we 
     * need grouping columns to be labeled. 
     */ 
</span>    <a href="createplan.c.html#LN1704"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1701"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1701"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1445"><span class='Ref_to_Member'>subpath</span></a><span class='Delimiter'>, 
</span>                                  <a href="createplan.c.html#LN1701"><span class='Ref_to_Parameter'>flags</span></a> <span class='Operator'>| </span><a href="createplan.c.html#LN67"><span class='Ref_to_Const'>CP_LABEL_TLIST</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN1703"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN266"><span class='Ref_to_Proto'>make_unique_from_pathkeys</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1704"><span class='Ref_To_Local'>subplan</span></a><span class='Delimiter'>, 
</span>                                     <a href="createplan.c.html#LN1701"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1444"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN967"><span class='Ref_to_Member'>pathkeys</span></a><span class='Delimiter'>, 
</span>                                     <a href="createplan.c.html#LN1701"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1446"><span class='Ref_to_Member'>numkeys</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN1703"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN821"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN1701"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN1703"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_upper_unique_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_agg_plan 
 * 
 *    Create an Agg plan for 'best_path' and (recursively) plans 
 *    for its subpaths. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN781"><span class='Ref_to_Struct'>Agg</span></a> <span class='Operator'>* 
</span><a name="LN1729"></a><span class='Declare_Function'>create_agg_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1456"><span class='Ref_to_Struct'>AggPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1731"></a>    <a href="../../../include/nodes/plannodes.h.html#LN781"><span class='Ref_to_Struct'>Agg</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span><a name="LN1732"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplan</span><span class='Delimiter'>; 
</span><a name="LN1733"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>tlist</span><span class='Delimiter'>; 
</span><a name="LN1734"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>quals</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Agg can project, so no need to be terribly picky about child tlist, but 
     * we do need grouping columns to be available 
     */ 
</span>    <a href="createplan.c.html#LN1732"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1729"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1729"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1459"><span class='Ref_to_Member'>subpath</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN67"><span class='Ref_to_Const'>CP_LABEL_TLIST</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN1733"><span class='Ref_To_Local'>tlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN74"><span class='Ref_to_Proto'>build_path_tlist</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1729"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN1729"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1458"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN1734"><span class='Ref_To_Local'>quals</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN161"><span class='Ref_to_Proto'>order_qual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1729"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1729"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1464"><span class='Ref_to_Member'>qual</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN1731"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/planmain.h.html#LN60"><span class='Ref_to_Proto'>make_agg</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1733"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1734"><span class='Ref_To_Local'>quals</span></a><span class='Delimiter'>, 
</span>                    <a href="createplan.c.html#LN1729"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1460"><span class='Ref_to_Member'>aggstrategy</span></a><span class='Delimiter'>, 
</span>                    <a href="createplan.c.html#LN1729"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1461"><span class='Ref_to_Member'>aggsplit</span></a><span class='Delimiter'>, 
</span>                    <a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1729"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1463"><span class='Ref_to_Member'>groupClause</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                    <a href="../../../include/optimizer/tlist.h.html#LN50"><span class='Ref_to_Proto'>extract_grouping_cols</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1729"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1463"><span class='Ref_to_Member'>groupClause</span></a><span class='Delimiter'>, 
</span>                                          <a href="createplan.c.html#LN1732"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                    <a href="../../../include/optimizer/tlist.h.html#LN49"><span class='Ref_to_Proto'>extract_grouping_ops</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1729"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1463"><span class='Ref_to_Member'>groupClause</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                    <a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>, 
</span>                    <a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>, 
</span>                    <a href="createplan.c.html#LN1729"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1462"><span class='Ref_to_Member'>numGroups</span></a><span class='Delimiter'>, 
</span>                    <a href="createplan.c.html#LN1732"><span class='Ref_To_Local'>subplan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN1731"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN783"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN1729"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN1731"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_agg_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Given a groupclause for a collection of grouping sets, produce the 
 * corresponding groupColIdx. 
 * 
 * root-&GT;grouping_map maps the tleSortGroupRef to the actual column position in 
 * the input tuple. So we get the ref from the entries in the groupclause and 
 * look them up there. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>* 
</span><a name="LN1772"></a><span class='Declare_Function'>remap_groupColIdx</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>groupClause</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1774"></a>    <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Local'>grouping_map</span> <span class='Operator'>= </span><a href="createplan.c.html#LN1772"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN283"><span class='Ref_to_Member'>grouping_map</span></a><span class='Delimiter'>; 
</span><a name="LN1775"></a>    <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Local'>new_grpColIdx</span><span class='Delimiter'>; 
</span><a name="LN1776"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span><a name="LN1777"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN1774"><span class='Ref_To_Local'>grouping_map</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN1775"><span class='Ref_To_Local'>new_grpColIdx</span></a> <span class='Operator'>= </span><a href="../../../include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1772"><span class='Ref_to_Parameter'>groupClause</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN1777"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1776"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1772"><span class='Ref_to_Parameter'>groupClause</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1786"></a>        <a href="../../../include/nodes/parsenodes.h.html#LN1161"><span class='Ref_to_Struct'>SortGroupClause</span></a> <span class='Operator'>*</span><span class='Declare_Local'>clause</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1776"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN1775"><span class='Ref_To_Local'>new_grpColIdx</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN1777"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN1774"><span class='Ref_To_Local'>grouping_map</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN1786"><span class='Ref_To_Local'>clause</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1164"><span class='Ref_to_Member'>tleSortGroupRef</span></a><span class='Delimiter'>]; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN1775"><span class='Ref_To_Local'>new_grpColIdx</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end remap_groupColIdx &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_groupingsets_plan 
 *    Create a plan for 'best_path' and (recursively) plans 
 *    for its subpaths. 
 * 
 *    What we emit is an Agg plan with some vestigial Agg and Sort nodes 
 *    hanging off the side.  The top Agg implements the last grouping set 
 *    specified in the GroupingSetsPath, and any additional grouping sets 
 *    each give rise to a subsidiary Agg and Sort node in the top Agg's 
 *    "chain" list.  These nodes don't participate in the plan directly, 
 *    but they are a convenient way to represent the required data for 
 *    the extra steps. 
 * 
 *    Returns a Plan node. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>* 
</span><a name="LN1810"></a><span class='Declare_Function'>create_groupingsets_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1493"><span class='Ref_to_Struct'>GroupingSetsPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1812"></a>    <a href="../../../include/nodes/plannodes.h.html#LN781"><span class='Ref_to_Struct'>Agg</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span><a name="LN1813"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplan</span><span class='Delimiter'>; 
</span><a name="LN1814"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>rollups</span> <span class='Operator'>= </span><a href="createplan.c.html#LN1810"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1498"><span class='Ref_to_Member'>rollups</span></a><span class='Delimiter'>; 
</span><a name="LN1815"></a>    <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Local'>grouping_map</span><span class='Delimiter'>; 
</span><a name="LN1816"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>maxref</span><span class='Delimiter'>; 
</span><a name="LN1817"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>chain</span><span class='Delimiter'>; 
</span><a name="LN1818"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Shouldn't get here without grouping sets */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN1810"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN154"><span class='Ref_to_Member'>parse</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN147"><span class='Ref_to_Member'>groupingSets</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN1814"><span class='Ref_To_Local'>rollups</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Agg can project, so no need to be terribly picky about child tlist, but 
     * we do need grouping columns to be available 
     */ 
</span>    <a href="createplan.c.html#LN1813"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1810"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1810"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1496"><span class='Ref_to_Member'>subpath</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN67"><span class='Ref_to_Const'>CP_LABEL_TLIST</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Compute the mapping from tleSortGroupRef to column index in the child's 
     * tlist.  First, identify max SortGroupRef in groupClause, for array 
     * sizing. 
     */ 
</span>    <a href="createplan.c.html#LN1816"><span class='Ref_To_Local'>maxref</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1818"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1810"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN154"><span class='Ref_to_Member'>parse</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN145"><span class='Ref_to_Member'>groupClause</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1838"></a>        <a href="../../../include/nodes/parsenodes.h.html#LN1161"><span class='Ref_to_Struct'>SortGroupClause</span></a> <span class='Operator'>*</span><span class='Declare_Local'>gc</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/parsenodes.h.html#LN1161"><span class='Ref_to_Struct'>SortGroupClause</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1818"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN1838"><span class='Ref_To_Local'>gc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1164"><span class='Ref_to_Member'>tleSortGroupRef</span></a> <span class='Operator'>&GT; </span><a href="createplan.c.html#LN1816"><span class='Ref_To_Local'>maxref</span></a><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN1816"><span class='Ref_To_Local'>maxref</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1838"><span class='Ref_To_Local'>gc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1164"><span class='Ref_to_Member'>tleSortGroupRef</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="createplan.c.html#LN1815"><span class='Ref_To_Local'>grouping_map</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>((</span><a href="createplan.c.html#LN1816"><span class='Ref_To_Local'>maxref</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Now look up the column numbers in the child's tlist */ 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1818"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1810"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN154"><span class='Ref_to_Member'>parse</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN145"><span class='Ref_to_Member'>groupClause</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1849"></a>        <a href="../../../include/nodes/parsenodes.h.html#LN1161"><span class='Ref_to_Struct'>SortGroupClause</span></a> <span class='Operator'>*</span><span class='Declare_Local'>gc</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/parsenodes.h.html#LN1161"><span class='Ref_to_Struct'>SortGroupClause</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1818"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1850"></a>        <a href="../../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>tle</span> <span class='Operator'>= </span><a href="../../../include/optimizer/tlist.h.html#LN37"><span class='Ref_to_Proto'>get_sortgroupclause_tle</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1849"><span class='Ref_To_Local'>gc</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1813"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN1815"><span class='Ref_To_Local'>grouping_map</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN1849"><span class='Ref_To_Local'>gc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1164"><span class='Ref_to_Member'>tleSortGroupRef</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN1850"><span class='Ref_To_Local'>tle</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN1367"><span class='Ref_to_Member'>resno</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * During setrefs.c, we'll need the grouping_map to fix up the cols lists 
     * in GroupingFunc nodes.  Save it for setrefs.c to use. 
     * 
     * This doesn't work if we're in an inheritance subtree (see notes in 
     * create_modifytable_plan).  Fortunately we can't be because there would 
     * never be grouping in an UPDATE/DELETE; but let's Assert that. 
     */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="createplan.c.html#LN1810"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN296"><span class='Ref_to_Member'>hasInheritedTarget</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN1810"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN283"><span class='Ref_to_Member'>grouping_map</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN1810"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN283"><span class='Ref_to_Member'>grouping_map</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1815"><span class='Ref_To_Local'>grouping_map</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Generate the side nodes that describe the other sort and group 
     * operations besides the top one.  Note that we don't worry about putting 
     * accurate cost estimates in the side nodes; only the topmost Agg node's 
     * costs will be shown by EXPLAIN. 
     */ 
</span>    <a href="createplan.c.html#LN1817"><span class='Ref_To_Local'>chain</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1814"><span class='Ref_To_Local'>rollups</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1876"></a>        <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc2</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN104"><span class='Ref_to_Macro'>lnext</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN75"><span class='Ref_to_Func'>list_head</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1814"><span class='Ref_To_Local'>rollups</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span><a name="LN1877"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>is_first_sort</span> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="../../../include/nodes/relation.h.html#LN1478"><span class='Ref_to_Struct'>RollupData</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1814"><span class='Ref_To_Local'>rollups</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>is_hashed<span class='Delimiter'>; 
</span> 
        <a href="../../../include/nodes/pg_list.h.html#LN168"><span class='Ref_to_Macro'>for_each_cell</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1818"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1876"><span class='Ref_To_Local'>lc2</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN1881"></a>            <a href="../../../include/nodes/relation.h.html#LN1478"><span class='Ref_to_Struct'>RollupData</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rollup</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1818"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1882"></a>            <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Local'>new_grpColIdx</span><span class='Delimiter'>; 
</span><a name="LN1883"></a>            <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>sort_plan</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN1884"></a>            <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>agg_plan</span><span class='Delimiter'>; 
</span><a name="LN1885"></a>            <a href="../../../include/nodes/nodes.h.html#LN733"><span class='Ref_to_Enum'>AggStrategy</span></a> <span class='Declare_Local'>strat</span><span class='Delimiter'>; 
</span> 
            <a href="createplan.c.html#LN1882"><span class='Ref_To_Local'>new_grpColIdx</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1771"><span class='Ref_to_Func'>remap_groupColIdx</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1810"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1881"><span class='Ref_To_Local'>rollup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1481"><span class='Ref_to_Member'>groupClause</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="createplan.c.html#LN1881"><span class='Ref_To_Local'>rollup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1486"><span class='Ref_to_Member'>is_hashed</span></a> <span class='Operator'>&& !</span><a href="createplan.c.html#LN1877"><span class='Ref_To_Local'>is_first_sort</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="createplan.c.html#LN1883"><span class='Ref_To_Local'>sort_plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>                    <a href="createplan.c.html#LN253"><span class='Ref_to_Proto'>make_sort_from_groupcols</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1881"><span class='Ref_To_Local'>rollup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1481"><span class='Ref_to_Member'>groupClause</span></a><span class='Delimiter'>, 
</span>                                             <a href="createplan.c.html#LN1882"><span class='Ref_To_Local'>new_grpColIdx</span></a><span class='Delimiter'>, 
</span>                                             <a href="createplan.c.html#LN1813"><span class='Ref_To_Local'>subplan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="createplan.c.html#LN1881"><span class='Ref_To_Local'>rollup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1486"><span class='Ref_to_Member'>is_hashed</span></a><span class='Parentheses'>) 
</span>                <a href="createplan.c.html#LN1877"><span class='Ref_To_Local'>is_first_sort</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN1881"><span class='Ref_To_Local'>rollup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1486"><span class='Ref_to_Member'>is_hashed</span></a><span class='Parentheses'>) 
</span>                <a href="createplan.c.html#LN1885"><span class='Ref_To_Local'>strat</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN737"><span class='Ref_to_EnumConst'>AGG_HASHED</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1881"><span class='Ref_To_Local'>rollup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1482"><span class='Ref_to_Member'>gsets</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <a href="createplan.c.html#LN1885"><span class='Ref_To_Local'>strat</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN735"><span class='Ref_to_EnumConst'>AGG_PLAIN</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="createplan.c.html#LN1885"><span class='Ref_To_Local'>strat</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN736"><span class='Ref_to_EnumConst'>AGG_SORTED</span></a><span class='Delimiter'>; 
</span> 
            <a href="createplan.c.html#LN1884"><span class='Ref_To_Local'>agg_plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/optimizer/planmain.h.html#LN60"><span class='Ref_to_Proto'>make_agg</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>, 
</span>                                         <a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>, 
</span>                                         <a href="createplan.c.html#LN1885"><span class='Ref_To_Local'>strat</span></a><span class='Delimiter'>, 
</span>                                         <a href="../../../include/nodes/nodes.h.html#LN758"><span class='Ref_to_EnumConst'>AGGSPLIT_SIMPLE</span></a><span class='Delimiter'>, 
</span>                               <a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>((</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1881"><span class='Ref_To_Local'>rollup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1482"><span class='Ref_to_Member'>gsets</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, 
</span>                                         <a href="createplan.c.html#LN1882"><span class='Ref_To_Local'>new_grpColIdx</span></a><span class='Delimiter'>, 
</span>                                   <a href="../../../include/optimizer/tlist.h.html#LN49"><span class='Ref_to_Proto'>extract_grouping_ops</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1881"><span class='Ref_To_Local'>rollup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1481"><span class='Ref_to_Member'>groupClause</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                         <a href="createplan.c.html#LN1881"><span class='Ref_To_Local'>rollup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1482"><span class='Ref_to_Member'>gsets</span></a><span class='Delimiter'>, 
</span>                                         <a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>, 
</span>                                         <a href="createplan.c.html#LN1881"><span class='Ref_To_Local'>rollup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1484"><span class='Ref_to_Member'>numGroups</span></a><span class='Delimiter'>, 
</span>                                         <a href="createplan.c.html#LN1883"><span class='Ref_To_Local'>sort_plan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Remove stuff we don't need to avoid bloating debug output. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN1883"><span class='Ref_To_Local'>sort_plan</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="createplan.c.html#LN1883"><span class='Ref_To_Local'>sort_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>                <a href="createplan.c.html#LN1883"><span class='Ref_To_Local'>sort_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <a href="createplan.c.html#LN1817"><span class='Ref_To_Local'>chain</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1817"><span class='Ref_To_Local'>chain</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1884"><span class='Ref_To_Local'>agg_plan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if list_length(rollups)&GT;... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* 
     * Now make the real Agg node 
     */ 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1936"></a>        <a href="../../../include/nodes/relation.h.html#LN1478"><span class='Ref_to_Struct'>RollupData</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rollup</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1814"><span class='Ref_To_Local'>rollups</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1937"></a>        <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Local'>top_grpColIdx</span><span class='Delimiter'>; 
</span><a name="LN1938"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>numGroupCols</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN1937"><span class='Ref_To_Local'>top_grpColIdx</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1771"><span class='Ref_to_Func'>remap_groupColIdx</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1810"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1936"><span class='Ref_To_Local'>rollup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1481"><span class='Ref_to_Member'>groupClause</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN1938"><span class='Ref_To_Local'>numGroupCols</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>((</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1936"><span class='Ref_To_Local'>rollup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1482"><span class='Ref_to_Member'>gsets</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN1812"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/planmain.h.html#LN60"><span class='Ref_to_Proto'>make_agg</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN74"><span class='Ref_to_Proto'>build_path_tlist</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1810"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN1810"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1495"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                        <a href="createplan.c.html#LN1810"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1499"><span class='Ref_to_Member'>qual</span></a><span class='Delimiter'>, 
</span>                        <a href="createplan.c.html#LN1810"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1497"><span class='Ref_to_Member'>aggstrategy</span></a><span class='Delimiter'>, 
</span>                        <a href="../../../include/nodes/nodes.h.html#LN758"><span class='Ref_to_EnumConst'>AGGSPLIT_SIMPLE</span></a><span class='Delimiter'>, 
</span>                        <a href="createplan.c.html#LN1938"><span class='Ref_To_Local'>numGroupCols</span></a><span class='Delimiter'>, 
</span>                        <a href="createplan.c.html#LN1937"><span class='Ref_To_Local'>top_grpColIdx</span></a><span class='Delimiter'>, 
</span>                        <a href="../../../include/optimizer/tlist.h.html#LN49"><span class='Ref_to_Proto'>extract_grouping_ops</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1936"><span class='Ref_To_Local'>rollup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1481"><span class='Ref_to_Member'>groupClause</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                        <a href="createplan.c.html#LN1936"><span class='Ref_To_Local'>rollup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1482"><span class='Ref_to_Member'>gsets</span></a><span class='Delimiter'>, 
</span>                        <a href="createplan.c.html#LN1817"><span class='Ref_To_Local'>chain</span></a><span class='Delimiter'>, 
</span>                        <a href="createplan.c.html#LN1936"><span class='Ref_To_Local'>rollup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1484"><span class='Ref_to_Member'>numGroups</span></a><span class='Delimiter'>, 
</span>                        <a href="createplan.c.html#LN1813"><span class='Ref_To_Local'>subplan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Copy cost data from Path to Plan */ 
</span>        <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN1812"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN783"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN1810"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1495"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN1812"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_groupingsets_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_minmaxagg_plan 
 * 
 *    Create a Result plan for 'best_path' and (recursively) plans 
 *    for its subpaths. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN187"><span class='Ref_to_Struct'>Result</span></a> <span class='Operator'>* 
</span><a name="LN1970"></a><span class='Declare_Function'>create_minmaxagg_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1505"><span class='Ref_to_Struct'>MinMaxAggPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1972"></a>    <a href="../../../include/nodes/plannodes.h.html#LN187"><span class='Ref_to_Struct'>Result</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span><a name="LN1973"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>tlist</span><span class='Delimiter'>; 
</span><a name="LN1974"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Prepare an InitPlan for each aggregate's subquery. */ 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1974"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1970"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1508"><span class='Ref_to_Member'>mmaggregates</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1979"></a>        <a href="../../../include/nodes/relation.h.html#LN2074"><span class='Ref_to_Struct'>MinMaxAggInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>mminfo</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN2074"><span class='Ref_to_Struct'>MinMaxAggInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1974"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1980"></a>        <a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>subroot</span> <span class='Operator'>= </span><a href="createplan.c.html#LN1979"><span class='Ref_To_Local'>mminfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2081"><span class='Ref_to_Member'>subroot</span></a><span class='Delimiter'>; 
</span><a name="LN1981"></a>        <a href="../../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>subparse</span> <span class='Operator'>= </span><a href="createplan.c.html#LN1980"><span class='Ref_To_Local'>subroot</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN154"><span class='Ref_to_Member'>parse</span></a><span class='Delimiter'>; 
</span><a name="LN1982"></a>        <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Generate the plan for the subquery. We already have a Path, but we 
         * have to convert it to a Plan and attach a LIMIT node above it. 
         * Since we are entering a different planner context (subroot), 
         * recurse to create_plan not create_plan_recurse. 
         */ 
</span>        <a href="createplan.c.html#LN1982"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/planmain.h.html#LN49"><span class='Ref_to_Proto'>create_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1980"><span class='Ref_To_Local'>subroot</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1979"><span class='Ref_To_Local'>mminfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2082"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN1982"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/optimizer/planmain.h.html#LN65"><span class='Ref_to_Proto'>make_limit</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1982"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>, 
</span>                                   <a href="createplan.c.html#LN1981"><span class='Ref_To_Local'>subparse</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN157"><span class='Ref_to_Member'>limitOffset</span></a><span class='Delimiter'>, 
</span>                                   <a href="createplan.c.html#LN1981"><span class='Ref_To_Local'>subparse</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN158"><span class='Ref_to_Member'>limitCount</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Must apply correct cost/width data to Limit node */ 
</span>        <a href="createplan.c.html#LN1982"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN124"><span class='Ref_to_Member'>startup_cost</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1979"><span class='Ref_To_Local'>mminfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2082"><span class='Ref_to_Member'>path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN964"><span class='Ref_to_Member'>startup_cost</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN1982"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN125"><span class='Ref_to_Member'>total_cost</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1979"><span class='Ref_To_Local'>mminfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2083"><span class='Ref_to_Member'>pathcost</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN1982"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN130"><span class='Ref_to_Member'>plan_rows</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN1982"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN131"><span class='Ref_to_Member'>plan_width</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1979"><span class='Ref_To_Local'>mminfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2082"><span class='Ref_to_Member'>path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN953"><span class='Ref_to_Member'>pathtarget</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN885"><span class='Ref_to_Member'>width</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN1982"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN136"><span class='Ref_to_Member'>parallel_aware</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN1982"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN137"><span class='Ref_to_Member'>parallel_safe</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1979"><span class='Ref_To_Local'>mminfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2082"><span class='Ref_to_Member'>path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN958"><span class='Ref_to_Member'>parallel_safe</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Convert the plan into an InitPlan in the outer query. */ 
</span>        <a href="../../../include/optimizer/subselect.h.html#LN34"><span class='Ref_to_Proto'>SS_make_initplan_from_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1970"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1980"><span class='Ref_To_Local'>subroot</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1982"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN1979"><span class='Ref_To_Local'>mminfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2084"><span class='Ref_to_Member'>param</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Generate the output plan --- basically just a Result */ 
</span>    <a href="createplan.c.html#LN1973"><span class='Ref_To_Local'>tlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN74"><span class='Ref_to_Proto'>build_path_tlist</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1970"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN1970"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1507"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN1972"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN274"><span class='Ref_to_Proto'>make_result</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN1973"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN1970"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1509"><span class='Ref_to_Member'>quals</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN1972"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN189"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN1970"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * During setrefs.c, we'll need to replace references to the Agg nodes 
     * with InitPlan output params.  (We can't just do that locally in the 
     * MinMaxAgg node, because path nodes above here may have Agg references 
     * as well.)  Save the mmaggregates list to tell setrefs.c to do that. 
     * 
     * This doesn't work if we're in an inheritance subtree (see notes in 
     * create_modifytable_plan).  Fortunately we can't be because there would 
     * never be aggregates in an UPDATE/DELETE; but let's Assert that. 
     */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="createplan.c.html#LN1970"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN296"><span class='Ref_to_Member'>hasInheritedTarget</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN1970"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN284"><span class='Ref_to_Member'>minmax_aggs</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN1970"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN284"><span class='Ref_to_Member'>minmax_aggs</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN1970"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1508"><span class='Ref_to_Member'>mmaggregates</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN1972"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_minmaxagg_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_windowagg_plan 
 * 
 *    Create a WindowAgg plan for 'best_path' and (recursively) plans 
 *    for its subpaths. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN800"><span class='Ref_to_Struct'>WindowAgg</span></a> <span class='Operator'>* 
</span><a name="LN2039"></a><span class='Declare_Function'>create_windowagg_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1519"><span class='Ref_to_Struct'>WindowAggPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2041"></a>    <a href="../../../include/nodes/plannodes.h.html#LN800"><span class='Ref_to_Struct'>WindowAgg</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span><a name="LN2042"></a>    <a href="../../../include/nodes/parsenodes.h.html#LN1252"><span class='Ref_to_Struct'>WindowClause</span></a> <span class='Operator'>*</span><span class='Declare_Local'>wc</span> <span class='Operator'>= </span><a href="createplan.c.html#LN2039"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1523"><span class='Ref_to_Member'>winclause</span></a><span class='Delimiter'>; 
</span><a name="LN2043"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplan</span><span class='Delimiter'>; 
</span><a name="LN2044"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>tlist</span><span class='Delimiter'>; 
</span><a name="LN2045"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>numsortkeys</span><span class='Delimiter'>; 
</span><a name="LN2046"></a>    <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Local'>sortColIdx</span><span class='Delimiter'>; 
</span><a name="LN2047"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>sortOperators</span><span class='Delimiter'>; 
</span><a name="LN2048"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>collations</span><span class='Delimiter'>; 
</span><a name="LN2049"></a>    <span class='Keyword'>bool</span>       <span class='Operator'>*</span><span class='Declare_Local'>nullsFirst</span><span class='Delimiter'>; 
</span><a name="LN2050"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>partNumCols</span><span class='Delimiter'>; 
</span><a name="LN2051"></a>    <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Local'>partColIdx</span><span class='Delimiter'>; 
</span><a name="LN2052"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>partOperators</span><span class='Delimiter'>; 
</span><a name="LN2053"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>ordNumCols</span><span class='Delimiter'>; 
</span><a name="LN2054"></a>    <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Local'>ordColIdx</span><span class='Delimiter'>; 
</span><a name="LN2055"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>ordOperators</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * WindowAgg can project, so no need to be terribly picky about child 
     * tlist, but we do need grouping columns to be available 
     */ 
</span>    <a href="createplan.c.html#LN2043"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2039"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2039"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1522"><span class='Ref_to_Member'>subpath</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN67"><span class='Ref_to_Const'>CP_LABEL_TLIST</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN2044"><span class='Ref_To_Local'>tlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN74"><span class='Ref_to_Proto'>build_path_tlist</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2039"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN2039"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1521"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We shouldn't need to actually sort, but it's convenient to use 
     * prepare_sort_from_pathkeys to identify the input's sort columns. 
     */ 
</span>    <a href="createplan.c.html#LN2043"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN240"><span class='Ref_to_Proto'>prepare_sort_from_pathkeys</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2043"><span class='Ref_To_Local'>subplan</span></a><span class='Delimiter'>, 
</span>                                         <a href="createplan.c.html#LN2039"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1524"><span class='Ref_to_Member'>winpathkeys</span></a><span class='Delimiter'>, 
</span>                                         <span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                                         <span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                                         <span class='Boolean'>false</span><span class='Delimiter'>, 
</span>                                         <span class='Operator'>&</span><a href="createplan.c.html#LN2045"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Delimiter'>, 
</span>                                         <span class='Operator'>&</span><a href="createplan.c.html#LN2046"><span class='Ref_To_Local'>sortColIdx</span></a><span class='Delimiter'>, 
</span>                                         <span class='Operator'>&</span><a href="createplan.c.html#LN2047"><span class='Ref_To_Local'>sortOperators</span></a><span class='Delimiter'>, 
</span>                                         <span class='Operator'>&</span><a href="createplan.c.html#LN2048"><span class='Ref_To_Local'>collations</span></a><span class='Delimiter'>, 
</span>                                         <span class='Operator'>&</span><a href="createplan.c.html#LN2049"><span class='Ref_To_Local'>nullsFirst</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Now deconstruct that into partition and ordering portions */ 
</span>    <a href="createplan.c.html#LN102"><span class='Ref_to_Proto'>get_column_info_for_window</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2039"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                               <a href="createplan.c.html#LN2042"><span class='Ref_To_Local'>wc</span></a><span class='Delimiter'>, 
</span>                               <a href="createplan.c.html#LN2043"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Delimiter'>, 
</span>                               <a href="createplan.c.html#LN2045"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Delimiter'>, 
</span>                               <a href="createplan.c.html#LN2046"><span class='Ref_To_Local'>sortColIdx</span></a><span class='Delimiter'>, 
</span>                               <span class='Operator'>&</span><a href="createplan.c.html#LN2050"><span class='Ref_To_Local'>partNumCols</span></a><span class='Delimiter'>, 
</span>                               <span class='Operator'>&</span><a href="createplan.c.html#LN2051"><span class='Ref_To_Local'>partColIdx</span></a><span class='Delimiter'>, 
</span>                               <span class='Operator'>&</span><a href="createplan.c.html#LN2052"><span class='Ref_To_Local'>partOperators</span></a><span class='Delimiter'>, 
</span>                               <span class='Operator'>&</span><a href="createplan.c.html#LN2053"><span class='Ref_To_Local'>ordNumCols</span></a><span class='Delimiter'>, 
</span>                               <span class='Operator'>&</span><a href="createplan.c.html#LN2054"><span class='Ref_To_Local'>ordColIdx</span></a><span class='Delimiter'>, 
</span>                               <span class='Operator'>&</span><a href="createplan.c.html#LN2055"><span class='Ref_To_Local'>ordOperators</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* And finally we can make the WindowAgg node */ 
</span>    <a href="createplan.c.html#LN2041"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN257"><span class='Ref_to_Proto'>make_windowagg</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2044"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, 
</span>                          <a href="createplan.c.html#LN2042"><span class='Ref_To_Local'>wc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1262"><span class='Ref_to_Member'>winref</span></a><span class='Delimiter'>, 
</span>                          <a href="createplan.c.html#LN2050"><span class='Ref_To_Local'>partNumCols</span></a><span class='Delimiter'>, 
</span>                          <a href="createplan.c.html#LN2051"><span class='Ref_To_Local'>partColIdx</span></a><span class='Delimiter'>, 
</span>                          <a href="createplan.c.html#LN2052"><span class='Ref_To_Local'>partOperators</span></a><span class='Delimiter'>, 
</span>                          <a href="createplan.c.html#LN2053"><span class='Ref_To_Local'>ordNumCols</span></a><span class='Delimiter'>, 
</span>                          <a href="createplan.c.html#LN2054"><span class='Ref_To_Local'>ordColIdx</span></a><span class='Delimiter'>, 
</span>                          <a href="createplan.c.html#LN2055"><span class='Ref_To_Local'>ordOperators</span></a><span class='Delimiter'>, 
</span>                          <a href="createplan.c.html#LN2042"><span class='Ref_To_Local'>wc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1259"><span class='Ref_to_Member'>frameOptions</span></a><span class='Delimiter'>, 
</span>                          <a href="createplan.c.html#LN2042"><span class='Ref_To_Local'>wc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1260"><span class='Ref_to_Member'>startOffset</span></a><span class='Delimiter'>, 
</span>                          <a href="createplan.c.html#LN2042"><span class='Ref_To_Local'>wc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1261"><span class='Ref_to_Member'>endOffset</span></a><span class='Delimiter'>, 
</span>                          <a href="createplan.c.html#LN2043"><span class='Ref_To_Local'>subplan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN2041"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN802"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN2039"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN2041"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_windowagg_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * get_column_info_for_window 
 *      Get the partitioning/ordering column numbers and equality operators 
 *      for a WindowAgg node. 
 * 
 * This depends on the behavior of planner.c's make_pathkeys_for_window! 
 * 
 * We are given the target WindowClause and an array of the input column 
 * numbers associated with the resulting pathkeys.  In the easy case, there 
 * are the same number of pathkey columns as partitioning + ordering columns 
 * and we just have to copy some data around.  However, it's possible that 
 * some of the original partitioning + ordering columns were eliminated as 
 * redundant during the transformation to pathkeys.  (This can happen even 
 * though the parser gets rid of obvious duplicates.  A typical scenario is a 
 * window specification "PARTITION BY x ORDER BY y" coupled with a clause 
 * "WHERE x = y" that causes the two sort columns to be recognized as 
 * redundant.)  In that unusual case, we have to work a lot harder to 
 * determine which keys are significant. 
 * 
 * The method used here is a bit brute-force: add the sort columns to a list 
 * one at a time and note when the resulting pathkey list gets longer.  But 
 * it's a sufficiently uncommon case that a faster way doesn't seem worth 
 * the amount of code refactoring that'd be needed. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN2137"></a><span class='Declare_Function'>get_column_info_for_window</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/parsenodes.h.html#LN1252"><span class='Ref_to_Struct'>WindowClause</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>wc</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, 
</span><a name="LN2138"></a>                           <span class='Keyword'>int </span><span class='Declare_Parameter'>numSortCols</span><span class='Delimiter'>, </span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>sortColIdx</span><span class='Delimiter'>, 
</span><a name="LN2139"></a>                           <span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>partNumCols</span><span class='Delimiter'>, 
</span><a name="LN2140"></a>                           <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>partColIdx</span><span class='Delimiter'>, 
</span><a name="LN2141"></a>                           <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>partOperators</span><span class='Delimiter'>, 
</span><a name="LN2142"></a>                           <span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>ordNumCols</span><span class='Delimiter'>, 
</span><a name="LN2143"></a>                           <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>ordColIdx</span><span class='Delimiter'>, 
</span><a name="LN2144"></a>                           <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>ordOperators</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2146"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>numPart</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2137"><span class='Ref_to_Parameter'>wc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1257"><span class='Ref_to_Member'>partitionClause</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2147"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>numOrder</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2137"><span class='Ref_to_Parameter'>wc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1258"><span class='Ref_to_Member'>orderClause</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN2138"><span class='Ref_to_Parameter'>numSortCols</span></a> <span class='Operator'>== </span><a href="createplan.c.html#LN2146"><span class='Ref_To_Local'>numPart</span></a> <span class='Operator'>+ </span><a href="createplan.c.html#LN2147"><span class='Ref_To_Local'>numOrder</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* easy case */ 
</span>        <span class='Operator'>*</span><a href="createplan.c.html#LN2139"><span class='Ref_to_Parameter'>partNumCols</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN2146"><span class='Ref_To_Local'>numPart</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="createplan.c.html#LN2140"><span class='Ref_to_Parameter'>partColIdx</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN2138"><span class='Ref_to_Parameter'>sortColIdx</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="createplan.c.html#LN2141"><span class='Ref_to_Parameter'>partOperators</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/tlist.h.html#LN49"><span class='Ref_to_Proto'>extract_grouping_ops</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2137"><span class='Ref_to_Parameter'>wc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1257"><span class='Ref_to_Member'>partitionClause</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="createplan.c.html#LN2142"><span class='Ref_to_Parameter'>ordNumCols</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN2147"><span class='Ref_To_Local'>numOrder</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="createplan.c.html#LN2143"><span class='Ref_to_Parameter'>ordColIdx</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN2138"><span class='Ref_to_Parameter'>sortColIdx</span></a> <span class='Operator'>+ </span><a href="createplan.c.html#LN2146"><span class='Ref_To_Local'>numPart</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="createplan.c.html#LN2144"><span class='Ref_to_Parameter'>ordOperators</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/tlist.h.html#LN49"><span class='Ref_to_Proto'>extract_grouping_ops</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2137"><span class='Ref_to_Parameter'>wc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1258"><span class='Ref_to_Member'>orderClause</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span><a name="LN2161"></a>        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>sortclauses</span><span class='Delimiter'>; 
</span><a name="LN2162"></a>        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>pathkeys</span><span class='Delimiter'>; 
</span><a name="LN2163"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>scidx</span><span class='Delimiter'>; 
</span><a name="LN2164"></a>        <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* first, allocate what's certainly enough space for the arrays */ 
</span>        <span class='Operator'>*</span><a href="createplan.c.html#LN2139"><span class='Ref_to_Parameter'>partNumCols</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="createplan.c.html#LN2140"><span class='Ref_to_Parameter'>partColIdx</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2146"><span class='Ref_To_Local'>numPart</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="createplan.c.html#LN2141"><span class='Ref_to_Parameter'>partOperators</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2146"><span class='Ref_To_Local'>numPart</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="createplan.c.html#LN2142"><span class='Ref_to_Parameter'>ordNumCols</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="createplan.c.html#LN2143"><span class='Ref_to_Parameter'>ordColIdx</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2147"><span class='Ref_To_Local'>numOrder</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="createplan.c.html#LN2144"><span class='Ref_to_Parameter'>ordOperators</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2147"><span class='Ref_To_Local'>numOrder</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN2161"><span class='Ref_To_Local'>sortclauses</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN2162"><span class='Ref_To_Local'>pathkeys</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN2163"><span class='Ref_To_Local'>scidx</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2164"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2137"><span class='Ref_to_Parameter'>wc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1257"><span class='Ref_to_Member'>partitionClause</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN2178"></a>            <a href="../../../include/nodes/parsenodes.h.html#LN1161"><span class='Ref_to_Struct'>SortGroupClause</span></a> <span class='Operator'>*</span><span class='Declare_Local'>sgc</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/parsenodes.h.html#LN1161"><span class='Ref_to_Struct'>SortGroupClause</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2164"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2179"></a>            <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>new_pathkeys</span><span class='Delimiter'>; 
</span> 
            <a href="createplan.c.html#LN2161"><span class='Ref_To_Local'>sortclauses</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2161"><span class='Ref_To_Local'>sortclauses</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2178"><span class='Ref_To_Local'>sgc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN2179"><span class='Ref_To_Local'>new_pathkeys</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/paths.h.html#LN205"><span class='Ref_to_Proto'>make_pathkeys_for_sortclauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2137"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                         <a href="createplan.c.html#LN2161"><span class='Ref_To_Local'>sortclauses</span></a><span class='Delimiter'>, 
</span>                                                         <a href="createplan.c.html#LN2137"><span class='Ref_to_Parameter'>tlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2179"><span class='Ref_To_Local'>new_pathkeys</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2162"><span class='Ref_To_Local'>pathkeys</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* this sort clause is actually significant */ 
</span>                <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="createplan.c.html#LN2140"><span class='Ref_to_Parameter'>partColIdx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>[</span><span class='Operator'>*</span><a href="createplan.c.html#LN2139"><span class='Ref_to_Parameter'>partNumCols</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN2138"><span class='Ref_to_Parameter'>sortColIdx</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN2163"><span class='Ref_To_Local'>scidx</span></a><span class='Operator'>++</span><span class='Delimiter'>]; 
</span>                <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="createplan.c.html#LN2141"><span class='Ref_to_Parameter'>partOperators</span></a><span class='Parentheses'>)</span><span class='Delimiter'>[</span><span class='Operator'>*</span><a href="createplan.c.html#LN2139"><span class='Ref_to_Parameter'>partNumCols</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN2178"><span class='Ref_To_Local'>sgc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1165"><span class='Ref_to_Member'>eqop</span></a><span class='Delimiter'>; 
</span>                <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="createplan.c.html#LN2139"><span class='Ref_to_Parameter'>partNumCols</span></a><span class='Parentheses'>)</span><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                <a href="createplan.c.html#LN2162"><span class='Ref_To_Local'>pathkeys</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN2179"><span class='Ref_To_Local'>new_pathkeys</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>        <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2164"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2137"><span class='Ref_to_Parameter'>wc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1258"><span class='Ref_to_Member'>orderClause</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN2196"></a>            <a href="../../../include/nodes/parsenodes.h.html#LN1161"><span class='Ref_to_Struct'>SortGroupClause</span></a> <span class='Operator'>*</span><span class='Declare_Local'>sgc</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/parsenodes.h.html#LN1161"><span class='Ref_to_Struct'>SortGroupClause</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2164"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2197"></a>            <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>new_pathkeys</span><span class='Delimiter'>; 
</span> 
            <a href="createplan.c.html#LN2161"><span class='Ref_To_Local'>sortclauses</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2161"><span class='Ref_To_Local'>sortclauses</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2196"><span class='Ref_To_Local'>sgc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN2197"><span class='Ref_To_Local'>new_pathkeys</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/paths.h.html#LN205"><span class='Ref_to_Proto'>make_pathkeys_for_sortclauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2137"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                         <a href="createplan.c.html#LN2161"><span class='Ref_To_Local'>sortclauses</span></a><span class='Delimiter'>, 
</span>                                                         <a href="createplan.c.html#LN2137"><span class='Ref_to_Parameter'>tlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2197"><span class='Ref_To_Local'>new_pathkeys</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2162"><span class='Ref_To_Local'>pathkeys</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* this sort clause is actually significant */ 
</span>                <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="createplan.c.html#LN2143"><span class='Ref_to_Parameter'>ordColIdx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>[</span><span class='Operator'>*</span><a href="createplan.c.html#LN2142"><span class='Ref_to_Parameter'>ordNumCols</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN2138"><span class='Ref_to_Parameter'>sortColIdx</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN2163"><span class='Ref_To_Local'>scidx</span></a><span class='Operator'>++</span><span class='Delimiter'>]; 
</span>                <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="createplan.c.html#LN2144"><span class='Ref_to_Parameter'>ordOperators</span></a><span class='Parentheses'>)</span><span class='Delimiter'>[</span><span class='Operator'>*</span><a href="createplan.c.html#LN2142"><span class='Ref_to_Parameter'>ordNumCols</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN2196"><span class='Ref_To_Local'>sgc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1165"><span class='Ref_to_Member'>eqop</span></a><span class='Delimiter'>; 
</span>                <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="createplan.c.html#LN2142"><span class='Ref_to_Parameter'>ordNumCols</span></a><span class='Parentheses'>)</span><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                <a href="createplan.c.html#LN2162"><span class='Ref_To_Local'>pathkeys</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN2197"><span class='Ref_To_Local'>new_pathkeys</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>        <span class='Comment_Multi_Line'>/* complain if we didn't eat exactly the right number of sort cols */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN2163"><span class='Ref_To_Local'>scidx</span></a> <span class='Operator'>!= </span><a href="createplan.c.html#LN2138"><span class='Ref_to_Parameter'>numSortCols</span></a><span class='Parentheses'>) 
</span>            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"failed to deconstruct sort operators into partitioning/ordering operators"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end get_column_info_for_window &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_setop_plan 
 * 
 *    Create a SetOp plan for 'best_path' and (recursively) plans 
 *    for its subpaths. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN876"><span class='Ref_to_Struct'>SetOp</span></a> <span class='Operator'>* 
</span><a name="LN2225"></a><span class='Declare_Function'>create_setop_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1530"><span class='Ref_to_Struct'>SetOpPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>flags</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2227"></a>    <a href="../../../include/nodes/plannodes.h.html#LN876"><span class='Ref_to_Struct'>SetOp</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span><a name="LN2228"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplan</span><span class='Delimiter'>; 
</span><a name="LN2229"></a>    <span class='Keyword'>long</span>        <span class='Declare_Local'>numGroups</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * SetOp doesn't project, so tlist requirements pass through; moreover we 
     * need grouping columns to be labeled. 
     */ 
</span>    <a href="createplan.c.html#LN2228"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2225"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2225"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1533"><span class='Ref_to_Member'>subpath</span></a><span class='Delimiter'>, 
</span>                                  <a href="createplan.c.html#LN2225"><span class='Ref_to_Parameter'>flags</span></a> <span class='Operator'>| </span><a href="createplan.c.html#LN67"><span class='Ref_to_Const'>CP_LABEL_TLIST</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Convert numGroups to long int --- but 'ware overflow! */ 
</span>    <a href="createplan.c.html#LN2229"><span class='Ref_To_Local'>numGroups</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>long</span><span class='Parentheses'>) </span><a href="../../../interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2225"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1539"><span class='Ref_to_Member'>numGroups</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>double</span><span class='Parentheses'>) </span>LONG_MAX<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN2227"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN270"><span class='Ref_to_Proto'>make_setop</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2225"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1534"><span class='Ref_to_Member'>cmd</span></a><span class='Delimiter'>, 
</span>                      <a href="createplan.c.html#LN2225"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1535"><span class='Ref_to_Member'>strategy</span></a><span class='Delimiter'>, 
</span>                      <a href="createplan.c.html#LN2228"><span class='Ref_To_Local'>subplan</span></a><span class='Delimiter'>, 
</span>                      <a href="createplan.c.html#LN2225"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1536"><span class='Ref_to_Member'>distinctList</span></a><span class='Delimiter'>, 
</span>                      <a href="createplan.c.html#LN2225"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1537"><span class='Ref_to_Member'>flagColIdx</span></a><span class='Delimiter'>, 
</span>                      <a href="createplan.c.html#LN2225"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1538"><span class='Ref_to_Member'>firstFlag</span></a><span class='Delimiter'>, 
</span>                      <a href="createplan.c.html#LN2229"><span class='Ref_To_Local'>numGroups</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN2227"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN878"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN2225"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN2227"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_setop_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_recursiveunion_plan 
 * 
 *    Create a RecursiveUnion plan for 'best_path' and (recursively) plans 
 *    for its subpaths. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN279"><span class='Ref_to_Struct'>RecursiveUnion</span></a> <span class='Operator'>* 
</span><a name="LN2261"></a><span class='Declare_Function'>create_recursiveunion_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1545"><span class='Ref_to_Struct'>RecursiveUnionPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2263"></a>    <a href="../../../include/nodes/plannodes.h.html#LN279"><span class='Ref_to_Struct'>RecursiveUnion</span></a> <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span><a name="LN2264"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>leftplan</span><span class='Delimiter'>; 
</span><a name="LN2265"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>rightplan</span><span class='Delimiter'>; 
</span><a name="LN2266"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>tlist</span><span class='Delimiter'>; 
</span><a name="LN2267"></a>    <span class='Keyword'>long</span>        <span class='Declare_Local'>numGroups</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Need both children to produce same tlist, so force it */ 
</span>    <a href="createplan.c.html#LN2264"><span class='Ref_To_Local'>leftplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2261"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2261"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1548"><span class='Ref_to_Member'>leftpath</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN65"><span class='Ref_to_Const'>CP_EXACT_TLIST</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN2265"><span class='Ref_To_Local'>rightplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2261"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2261"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1549"><span class='Ref_to_Member'>rightpath</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN65"><span class='Ref_to_Const'>CP_EXACT_TLIST</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN2266"><span class='Ref_To_Local'>tlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN74"><span class='Ref_to_Proto'>build_path_tlist</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2261"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN2261"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1547"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Convert numGroups to long int --- but 'ware overflow! */ 
</span>    <a href="createplan.c.html#LN2267"><span class='Ref_To_Local'>numGroups</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>long</span><span class='Parentheses'>) </span><a href="../../../interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2261"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1552"><span class='Ref_to_Member'>numGroups</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>double</span><span class='Parentheses'>) </span>LONG_MAX<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN2263"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN206"><span class='Ref_to_Proto'>make_recursive_union</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2266"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, 
</span>                                <a href="createplan.c.html#LN2264"><span class='Ref_To_Local'>leftplan</span></a><span class='Delimiter'>, 
</span>                                <a href="createplan.c.html#LN2265"><span class='Ref_To_Local'>rightplan</span></a><span class='Delimiter'>, 
</span>                                <a href="createplan.c.html#LN2261"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1551"><span class='Ref_to_Member'>wtParam</span></a><span class='Delimiter'>, 
</span>                                <a href="createplan.c.html#LN2261"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1550"><span class='Ref_to_Member'>distinctList</span></a><span class='Delimiter'>, 
</span>                                <a href="createplan.c.html#LN2267"><span class='Ref_To_Local'>numGroups</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN2263"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN281"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN2261"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN2263"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_recursiveunion_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_lockrows_plan 
 * 
 *    Create a LockRows plan for 'best_path' and (recursively) plans 
 *    for its subpaths. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN899"><span class='Ref_to_Struct'>LockRows</span></a> <span class='Operator'>* 
</span><a name="LN2297"></a><span class='Declare_Function'>create_lockrows_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1558"><span class='Ref_to_Struct'>LockRowsPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN2298"></a>                     <span class='Keyword'>int </span><span class='Declare_Parameter'>flags</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2300"></a>    <a href="../../../include/nodes/plannodes.h.html#LN899"><span class='Ref_to_Struct'>LockRows</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span><a name="LN2301"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplan</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* LockRows doesn't project, so tlist requirements pass through */ 
</span>    <a href="createplan.c.html#LN2301"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2297"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2297"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1561"><span class='Ref_to_Member'>subpath</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2298"><span class='Ref_to_Parameter'>flags</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN2300"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN273"><span class='Ref_to_Proto'>make_lockrows</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2301"><span class='Ref_To_Local'>subplan</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2297"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1562"><span class='Ref_to_Member'>rowMarks</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2297"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1563"><span class='Ref_to_Member'>epqParam</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN2300"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN901"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN2297"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN2300"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * create_modifytable_plan 
 *    Create a ModifyTable plan for 'best_path'. 
 * 
 *    Returns a Plan node. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN213"><span class='Ref_to_Struct'>ModifyTable</span></a> <span class='Operator'>* 
</span><a name="LN2320"></a><span class='Declare_Function'>create_modifytable_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1573"><span class='Ref_to_Struct'>ModifyTablePath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2322"></a>    <a href="../../../include/nodes/plannodes.h.html#LN213"><span class='Ref_to_Struct'>ModifyTable</span></a> <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span><a name="LN2323"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplans</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN2324"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>subpaths</span><span class='Delimiter'>, 
</span><a name="LN2325"></a>               <span class='Operator'>*</span><span class='Declare_Local'>subroots</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Build the plan for each input path */ 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN179"><span class='Ref_to_Macro'>forboth</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2324"><span class='Ref_To_Local'>subpaths</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2320"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1582"><span class='Ref_to_Member'>subpaths</span></a><span class='Delimiter'>, 
</span>            <a href="createplan.c.html#LN2325"><span class='Ref_To_Local'>subroots</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2320"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1583"><span class='Ref_to_Member'>subroots</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2331"></a>        <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subpath</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2324"><span class='Ref_To_Local'>subpaths</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2332"></a>        <a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>subroot</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2325"><span class='Ref_To_Local'>subroots</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2333"></a>        <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplan</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * In an inherited UPDATE/DELETE, reference the per-child modified 
         * subroot while creating Plans from Paths for the child rel.  This is 
         * a kluge, but otherwise it's too hard to ensure that Plan creation 
         * functions (particularly in FDWs) don't depend on the contents of 
         * "root" matching what they saw at Path creation time.  The main 
         * downside is that creation functions for Plans that might appear 
         * below a ModifyTable cannot expect to modify the contents of "root" 
         * and have it "stick" for subsequent processing such as setrefs.c. 
         * That's not great, but it seems better than the alternative. 
         */ 
</span>        <a href="createplan.c.html#LN2333"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2332"><span class='Ref_To_Local'>subroot</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2331"><span class='Ref_To_Local'>subpath</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN65"><span class='Ref_to_Const'>CP_EXACT_TLIST</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Transfer resname/resjunk labeling, too, to keep executor happy */ 
</span>        <a href="../../../include/optimizer/tlist.h.html#LN33"><span class='Ref_to_Proto'>apply_tlist_labeling</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2333"><span class='Ref_To_Local'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2332"><span class='Ref_To_Local'>subroot</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN280"><span class='Ref_to_Member'>processed_tlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN2323"><span class='Ref_To_Local'>subplans</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2323"><span class='Ref_To_Local'>subplans</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2333"><span class='Ref_To_Local'>subplan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="createplan.c.html#LN2322"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN276"><span class='Ref_to_Proto'>make_modifytable</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2320"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                            <a href="createplan.c.html#LN2320"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1576"><span class='Ref_to_Member'>operation</span></a><span class='Delimiter'>, 
</span>                            <a href="createplan.c.html#LN2320"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1577"><span class='Ref_to_Member'>canSetTag</span></a><span class='Delimiter'>, 
</span>                            <a href="createplan.c.html#LN2320"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1578"><span class='Ref_to_Member'>nominalRelation</span></a><span class='Delimiter'>, 
</span>                            <a href="createplan.c.html#LN2320"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1580"><span class='Ref_to_Member'>partitioned_rels</span></a><span class='Delimiter'>, 
</span>                            <a href="createplan.c.html#LN2320"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1581"><span class='Ref_to_Member'>resultRelations</span></a><span class='Delimiter'>, 
</span>                            <a href="createplan.c.html#LN2323"><span class='Ref_To_Local'>subplans</span></a><span class='Delimiter'>, 
</span>                            <a href="createplan.c.html#LN2320"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1584"><span class='Ref_to_Member'>withCheckOptionLists</span></a><span class='Delimiter'>, 
</span>                            <a href="createplan.c.html#LN2320"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1585"><span class='Ref_to_Member'>returningLists</span></a><span class='Delimiter'>, 
</span>                            <a href="createplan.c.html#LN2320"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1586"><span class='Ref_to_Member'>rowMarks</span></a><span class='Delimiter'>, 
</span>                            <a href="createplan.c.html#LN2320"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1587"><span class='Ref_to_Member'>onconflict</span></a><span class='Delimiter'>, 
</span>                            <a href="createplan.c.html#LN2320"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1588"><span class='Ref_to_Member'>epqParam</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN2322"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN215"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN2320"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1575"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN2322"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_modifytable_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_limit_plan 
 * 
 *    Create a Limit plan for 'best_path' and (recursively) plans 
 *    for its subpaths. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN913"><span class='Ref_to_Struct'>Limit</span></a> <span class='Operator'>* 
</span><a name="LN2379"></a><span class='Declare_Function'>create_limit_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1594"><span class='Ref_to_Struct'>LimitPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>flags</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2381"></a>    <a href="../../../include/nodes/plannodes.h.html#LN913"><span class='Ref_to_Struct'>Limit</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span><a name="LN2382"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplan</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Limit doesn't project, so tlist requirements pass through */ 
</span>    <a href="createplan.c.html#LN2382"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2379"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2379"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1597"><span class='Ref_to_Member'>subpath</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2379"><span class='Ref_to_Parameter'>flags</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN2381"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/planmain.h.html#LN65"><span class='Ref_to_Proto'>make_limit</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2382"><span class='Ref_To_Local'>subplan</span></a><span class='Delimiter'>, 
</span>                      <a href="createplan.c.html#LN2379"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1598"><span class='Ref_to_Member'>limitOffset</span></a><span class='Delimiter'>, 
</span>                      <a href="createplan.c.html#LN2379"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1599"><span class='Ref_to_Member'>limitCount</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN2381"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN915"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN2379"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN2381"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/***************************************************************************** 
 * 
 *  BASE-RELATION SCAN METHODS 
 * 
 *****************************************************************************/ 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_seqscan_plan 
 *   Returns a seqscan plan for the base relation scanned by 'best_path' 
 *   with restriction clauses 'scan_clauses' and targetlist 'tlist'. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN335"><span class='Ref_to_Typedef'>SeqScan</span></a> <span class='Operator'>* 
</span><a name="LN2410"></a><span class='Declare_Function'>create_seqscan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN2411"></a>                    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2413"></a>    <a href="../../../include/nodes/plannodes.h.html#LN335"><span class='Ref_to_Typedef'>SeqScan</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>scan_plan</span><span class='Delimiter'>; 
</span><a name="LN2414"></a>    <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>       <span class='Declare_Local'>scan_relid</span> <span class='Operator'>= </span><a href="createplan.c.html#LN2410"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN552"><span class='Ref_to_Member'>relid</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* it should be a base rel... */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN2414"><span class='Ref_To_Local'>scan_relid</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN2410"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN554"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/parsenodes.h.html#LN922"><span class='Ref_to_EnumConst'>RTE_RELATION</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Sort clauses into best execution order */ 
</span>    <a href="createplan.c.html#LN2411"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN161"><span class='Ref_to_Proto'>order_qual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2410"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2411"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Reduce RestrictInfo list to bare expressions; ignore pseudoconstants */ 
</span>    <a href="createplan.c.html#LN2411"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/restrictinfo.h.html#LN35"><span class='Ref_to_Proto'>extract_actual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2411"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Replace any outer-relation variables with nestloop params */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN2410"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="createplan.c.html#LN2411"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2410"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN2411"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="createplan.c.html#LN2413"><span class='Ref_To_Local'>scan_plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN166"><span class='Ref_to_Proto'>make_seqscan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2411"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>, 
</span>                             <a href="createplan.c.html#LN2411"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Delimiter'>, 
</span>                             <a href="createplan.c.html#LN2414"><span class='Ref_To_Local'>scan_relid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN2413"><span class='Ref_To_Local'>scan_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2410"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN2413"><span class='Ref_To_Local'>scan_plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_seqscan_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_samplescan_plan 
 *   Returns a samplescan plan for the base relation scanned by 'best_path' 
 *   with restriction clauses 'scan_clauses' and targetlist 'tlist'. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN341"><span class='Ref_to_Struct'>SampleScan</span></a> <span class='Operator'>* 
</span><a name="LN2448"></a><span class='Declare_Function'>create_samplescan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN2449"></a>                       <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2451"></a>    <a href="../../../include/nodes/plannodes.h.html#LN341"><span class='Ref_to_Struct'>SampleScan</span></a> <span class='Operator'>*</span><span class='Declare_Local'>scan_plan</span><span class='Delimiter'>; 
</span><a name="LN2452"></a>    <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>       <span class='Declare_Local'>scan_relid</span> <span class='Operator'>= </span><a href="createplan.c.html#LN2448"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN552"><span class='Ref_to_Member'>relid</span></a><span class='Delimiter'>; 
</span><a name="LN2453"></a>    <a href="../../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span><span class='Delimiter'>; 
</span><a name="LN2454"></a>    <a href="../../../include/nodes/parsenodes.h.html#LN1071"><span class='Ref_to_Struct'>TableSampleClause</span></a> <span class='Operator'>*</span><span class='Declare_Local'>tsc</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* it should be a base rel with a tablesample clause... */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN2452"><span class='Ref_To_Local'>scan_relid</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN2453"><span class='Ref_To_Local'>rte</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/relation.h.html#LN324"><span class='Ref_to_Macro'>planner_rt_fetch</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2452"><span class='Ref_To_Local'>scan_relid</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2448"><span class='Ref_to_Parameter'>root</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN2453"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/parsenodes.h.html#LN922"><span class='Ref_to_EnumConst'>RTE_RELATION</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN2454"><span class='Ref_To_Local'>tsc</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN2453"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN949"><span class='Ref_to_Member'>tablesample</span></a><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN2454"><span class='Ref_To_Local'>tsc</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Sort clauses into best execution order */ 
</span>    <a href="createplan.c.html#LN2449"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN161"><span class='Ref_to_Proto'>order_qual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2448"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2449"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Reduce RestrictInfo list to bare expressions; ignore pseudoconstants */ 
</span>    <a href="createplan.c.html#LN2449"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/restrictinfo.h.html#LN35"><span class='Ref_to_Proto'>extract_actual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2449"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Replace any outer-relation variables with nestloop params */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN2448"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="createplan.c.html#LN2449"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2448"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN2449"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN2454"><span class='Ref_To_Local'>tsc</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/parsenodes.h.html#LN1071"><span class='Ref_to_Struct'>TableSampleClause</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2448"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN2454"><span class='Ref_To_Local'>tsc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="createplan.c.html#LN2451"><span class='Ref_To_Local'>scan_plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN167"><span class='Ref_to_Proto'>make_samplescan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2449"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>, 
</span>                                <a href="createplan.c.html#LN2449"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Delimiter'>, 
</span>                                <a href="createplan.c.html#LN2452"><span class='Ref_To_Local'>scan_relid</span></a><span class='Delimiter'>, 
</span>                                <a href="createplan.c.html#LN2454"><span class='Ref_To_Local'>tsc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN2451"><span class='Ref_To_Local'>scan_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN343"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2448"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN2451"><span class='Ref_To_Local'>scan_plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_samplescan_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_indexscan_plan 
 *    Returns an indexscan plan for the base relation scanned by 'best_path' 
 *    with restriction clauses 'scan_clauses' and targetlist 'tlist'. 
 * 
 * We use this for both plain IndexScans and IndexOnlyScans, because the 
 * qual preprocessing work is the same for both.  Note that the caller tells 
 * us which to build --- we don't look at best_path-&GT;path.pathtype, because 
 * create_bitmap_subplan needs to be able to override the prior decision. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN325"><span class='Ref_to_Struct'>Scan</span></a> <span class='Operator'>* 
</span><a name="LN2499"></a><span class='Declare_Function'>create_indexscan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN2500"></a>                      <a href="../../../include/nodes/relation.h.html#LN1027"><span class='Ref_to_Struct'>IndexPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN2501"></a>                      <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, 
</span><a name="LN2502"></a>                      <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Delimiter'>, 
</span><a name="LN2503"></a>                      <span class='Keyword'>bool </span><span class='Declare_Parameter'>indexonly</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2505"></a>    <a href="../../../include/nodes/plannodes.h.html#LN325"><span class='Ref_to_Struct'>Scan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>scan_plan</span><span class='Delimiter'>; 
</span><a name="LN2506"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>indexquals</span> <span class='Operator'>= </span><a href="createplan.c.html#LN2500"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1032"><span class='Ref_to_Member'>indexquals</span></a><span class='Delimiter'>; 
</span><a name="LN2507"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>indexorderbys</span> <span class='Operator'>= </span><a href="createplan.c.html#LN2500"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1034"><span class='Ref_to_Member'>indexorderbys</span></a><span class='Delimiter'>; 
</span><a name="LN2508"></a>    <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>       <span class='Declare_Local'>baserelid</span> <span class='Operator'>= </span><a href="createplan.c.html#LN2500"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1029"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN552"><span class='Ref_to_Member'>relid</span></a><span class='Delimiter'>; 
</span><a name="LN2509"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>indexoid</span> <span class='Operator'>= </span><a href="createplan.c.html#LN2500"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1030"><span class='Ref_to_Member'>indexinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN630"><span class='Ref_to_Member'>indexoid</span></a><span class='Delimiter'>; 
</span><a name="LN2510"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>qpqual</span><span class='Delimiter'>; 
</span><a name="LN2511"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>stripped_indexquals</span><span class='Delimiter'>; 
</span><a name="LN2512"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>fixed_indexquals</span><span class='Delimiter'>; 
</span><a name="LN2513"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>fixed_indexorderbys</span><span class='Delimiter'>; 
</span><a name="LN2514"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>indexorderbyops</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN2515"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* it should be a base rel... */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN2508"><span class='Ref_To_Local'>baserelid</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN2500"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1029"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN554"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/parsenodes.h.html#LN922"><span class='Ref_to_EnumConst'>RTE_RELATION</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Build "stripped" indexquals structure (no RestrictInfos) to pass to 
     * executor as indexqualorig 
     */ 
</span>    <a href="createplan.c.html#LN2511"><span class='Ref_To_Local'>stripped_indexquals</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/restrictinfo.h.html#LN34"><span class='Ref_to_Proto'>get_actual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2506"><span class='Ref_To_Local'>indexquals</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * The executor needs a copy with the indexkey on the left of each clause 
     * and with index Vars substituted for table ones. 
     */ 
</span>    <a href="createplan.c.html#LN2512"><span class='Ref_To_Local'>fixed_indexquals</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN157"><span class='Ref_to_Proto'>fix_indexqual_references</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2499"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2500"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Likewise fix up index attr references in the ORDER BY expressions. 
     */ 
</span>    <a href="createplan.c.html#LN2513"><span class='Ref_To_Local'>fixed_indexorderbys</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN158"><span class='Ref_to_Proto'>fix_indexorderby_references</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2499"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2500"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * The qpqual list must contain all restrictions not automatically handled 
     * by the index, other than pseudoconstant clauses which will be handled 
     * by a separate gating plan node.  All the predicates in the indexquals 
     * will be checked (either by the index itself, or by nodeIndexscan.c), 
     * but if there are any "special" operators involved then they must be 
     * included in qpqual.  The upshot is that qpqual must contain 
     * scan_clauses minus whatever appears in indexquals. 
     * 
     * In normal cases simple pointer equality checks will be enough to spot 
     * duplicate RestrictInfos, so we try that first. 
     * 
     * Another common case is that a scan_clauses entry is generated from the 
     * same EquivalenceClass as some indexqual, and is therefore redundant 
     * with it, though not equal.  (This happens when indxpath.c prefers a 
     * different derived equality than what generate_join_implied_equalities 
     * picked for a parameterized scan's ppi_clauses.) 
     * 
     * In some situations (particularly with OR'd index conditions) we may 
     * have scan_clauses that are not equal to, but are logically implied by, 
     * the index quals; so we also try a predicate_implied_by() check to see 
     * if we can discard quals that way.  (predicate_implied_by assumes its 
     * first input contains only immutable functions, so we have to check 
     * that.) 
     * 
     * Note: if you change this bit of code you should also look at 
     * extract_nonindex_conditions() in costsize.c. 
     */ 
</span>    <a href="createplan.c.html#LN2510"><span class='Ref_To_Local'>qpqual</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2515"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2502"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2569"></a>        <a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rinfo</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN108"><span class='Ref_to_Macro'>lfirst_node</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2515"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN2569"><span class='Ref_To_Local'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1754"><span class='Ref_to_Member'>pseudoconstant</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* we may drop pseudoconstants here */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN229"><span class='Ref_to_Proto'>list_member_ptr</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2506"><span class='Ref_To_Local'>indexquals</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2569"><span class='Ref_To_Local'>rinfo</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>continue</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* simple duplicate */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/optimizer/paths.h.html#LN168"><span class='Ref_to_Proto'>is_redundant_derived_clause</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2569"><span class='Ref_To_Local'>rinfo</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2506"><span class='Ref_To_Local'>indexquals</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>continue</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* derived from same EquivalenceClass */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/optimizer/clauses.h.html#LN59"><span class='Ref_to_Proto'>contain_mutable_functions</span></a><span class='Parentheses'>((</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN2569"><span class='Ref_To_Local'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1746"><span class='Ref_to_Member'>clause</span></a><span class='Parentheses'>)</span> <span class='Operator'>&& 
</span>            <a href="../../../include/optimizer/predtest.h.html#LN19"><span class='Ref_to_Proto'>predicate_implied_by</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN138"><span class='Ref_to_Macro'>list_make1</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2569"><span class='Ref_To_Local'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1746"><span class='Ref_to_Member'>clause</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="createplan.c.html#LN2506"><span class='Ref_To_Local'>indexquals</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>continue</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* provably implied by indexquals */ 
</span>        <a href="createplan.c.html#LN2510"><span class='Ref_To_Local'>qpqual</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2510"><span class='Ref_To_Local'>qpqual</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2569"><span class='Ref_To_Local'>rinfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Sort clauses into best execution order */ 
</span>    <a href="createplan.c.html#LN2510"><span class='Ref_To_Local'>qpqual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN161"><span class='Ref_to_Proto'>order_qual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2499"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2510"><span class='Ref_To_Local'>qpqual</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Reduce RestrictInfo list to bare expressions; ignore pseudoconstants */ 
</span>    <a href="createplan.c.html#LN2510"><span class='Ref_To_Local'>qpqual</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/restrictinfo.h.html#LN35"><span class='Ref_to_Proto'>extract_actual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2510"><span class='Ref_To_Local'>qpqual</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We have to replace any outer-relation variables with nestloop params in 
     * the indexqualorig, qpqual, and indexorderbyorig expressions.  A bit 
     * annoying to have to do this separately from the processing in 
     * fix_indexqual_references --- rethink this when generalizing the inner 
     * indexscan support.  But note we can't really do this earlier because 
     * it'd break the comparisons to predicates above ... (or would it?  Those 
     * wouldn't have outer refs) 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN2500"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1029"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="createplan.c.html#LN2511"><span class='Ref_To_Local'>stripped_indexquals</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2499"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN2511"><span class='Ref_To_Local'>stripped_indexquals</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN2510"><span class='Ref_To_Local'>qpqual</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2499"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN2510"><span class='Ref_To_Local'>qpqual</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN2507"><span class='Ref_To_Local'>indexorderbys</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2499"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN2507"><span class='Ref_To_Local'>indexorderbys</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If there are ORDER BY expressions, look up the sort operators for their 
     * result datatypes. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN2507"><span class='Ref_To_Local'>indexorderbys</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2614"></a>        <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>pathkeyCell</span><span class='Delimiter'>, 
</span><a name="LN2615"></a>                   <span class='Operator'>*</span><span class='Declare_Local'>exprCell</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * PathKey contains OID of the btree opfamily we're sorting by, but 
         * that's not quite enough because we need the expression's datatype 
         * to look up the sort operator in the operator family. 
         */ 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2500"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1029"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN967"><span class='Ref_to_Member'>pathkeys</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2507"><span class='Ref_To_Local'>indexorderbys</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../../include/nodes/pg_list.h.html#LN179"><span class='Ref_to_Macro'>forboth</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2614"><span class='Ref_To_Local'>pathkeyCell</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2500"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1029"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN967"><span class='Ref_to_Member'>pathkeys</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2615"><span class='Ref_To_Local'>exprCell</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2507"><span class='Ref_To_Local'>indexorderbys</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN2625"></a>            <a href="../../../include/nodes/relation.h.html#LN845"><span class='Ref_to_Struct'>PathKey</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>pathkey</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN845"><span class='Ref_to_Struct'>PathKey</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2614"><span class='Ref_To_Local'>pathkeyCell</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2626"></a>            <a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>expr</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2615"><span class='Ref_To_Local'>exprCell</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2627"></a>            <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>exprtype</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodeFuncs.h.html#LN31"><span class='Ref_to_Proto'>exprType</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2626"><span class='Ref_To_Local'>expr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2628"></a>            <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>sortop</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Get sort operator from opfamily */ 
</span>            <a href="createplan.c.html#LN2628"><span class='Ref_To_Local'>sortop</span></a> <span class='Operator'>= </span><a href="../../../include/utils/lsyscache.h.html#LN70"><span class='Ref_to_Proto'>get_opfamily_member</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2625"><span class='Ref_To_Local'>pathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN850"><span class='Ref_to_Member'>pk_opfamily</span></a><span class='Delimiter'>, 
</span>                                         <a href="createplan.c.html#LN2627"><span class='Ref_To_Local'>exprtype</span></a><span class='Delimiter'>, 
</span>                                         <a href="createplan.c.html#LN2627"><span class='Ref_To_Local'>exprtype</span></a><span class='Delimiter'>, 
</span>                                         <a href="createplan.c.html#LN2625"><span class='Ref_To_Local'>pathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN851"><span class='Ref_to_Member'>pk_strategy</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2628"><span class='Ref_To_Local'>sortop</span></a><span class='Parentheses'>))</span> 
                <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"failed to find sort operator for ORDER BY expression"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN2514"><span class='Ref_To_Local'>indexorderbyops</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN162"><span class='Ref_to_Func'>lappend_oid</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2514"><span class='Ref_To_Local'>indexorderbyops</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2628"><span class='Ref_To_Local'>sortop</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if indexorderbys &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Finally ready to build the plan node */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN2503"><span class='Ref_to_Parameter'>indexonly</span></a><span class='Parentheses'>) 
</span>        <a href="createplan.c.html#LN2505"><span class='Ref_To_Local'>scan_plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN325"><span class='Ref_to_Struct'>Scan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN174"><span class='Ref_to_Proto'>make_indexonlyscan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2501"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>, 
</span>                                                <a href="createplan.c.html#LN2510"><span class='Ref_To_Local'>qpqual</span></a><span class='Delimiter'>, 
</span>                                                <a href="createplan.c.html#LN2508"><span class='Ref_To_Local'>baserelid</span></a><span class='Delimiter'>, 
</span>                                                <a href="createplan.c.html#LN2509"><span class='Ref_To_Local'>indexoid</span></a><span class='Delimiter'>, 
</span>                                                <a href="createplan.c.html#LN2512"><span class='Ref_To_Local'>fixed_indexquals</span></a><span class='Delimiter'>, 
</span>                                                <a href="createplan.c.html#LN2513"><span class='Ref_To_Local'>fixed_indexorderbys</span></a><span class='Delimiter'>, 
</span>                                            <a href="createplan.c.html#LN2500"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1030"><span class='Ref_to_Member'>indexinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN655"><span class='Ref_to_Member'>indextlist</span></a><span class='Delimiter'>, 
</span>                                                <a href="createplan.c.html#LN2500"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1036"><span class='Ref_to_Member'>indexscandir</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="createplan.c.html#LN2505"><span class='Ref_To_Local'>scan_plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN325"><span class='Ref_to_Struct'>Scan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN169"><span class='Ref_to_Proto'>make_indexscan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2501"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>, 
</span>                                            <a href="createplan.c.html#LN2510"><span class='Ref_To_Local'>qpqual</span></a><span class='Delimiter'>, 
</span>                                            <a href="createplan.c.html#LN2508"><span class='Ref_To_Local'>baserelid</span></a><span class='Delimiter'>, 
</span>                                            <a href="createplan.c.html#LN2509"><span class='Ref_To_Local'>indexoid</span></a><span class='Delimiter'>, 
</span>                                            <a href="createplan.c.html#LN2512"><span class='Ref_To_Local'>fixed_indexquals</span></a><span class='Delimiter'>, 
</span>                                            <a href="createplan.c.html#LN2511"><span class='Ref_To_Local'>stripped_indexquals</span></a><span class='Delimiter'>, 
</span>                                            <a href="createplan.c.html#LN2513"><span class='Ref_To_Local'>fixed_indexorderbys</span></a><span class='Delimiter'>, 
</span>                                            <a href="createplan.c.html#LN2507"><span class='Ref_To_Local'>indexorderbys</span></a><span class='Delimiter'>, 
</span>                                            <a href="createplan.c.html#LN2514"><span class='Ref_To_Local'>indexorderbyops</span></a><span class='Delimiter'>, 
</span>                                            <a href="createplan.c.html#LN2500"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1036"><span class='Ref_to_Member'>indexscandir</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN2505"><span class='Ref_To_Local'>scan_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN2500"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1029"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN2505"><span class='Ref_To_Local'>scan_plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_indexscan_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_bitmap_scan_plan 
 *    Returns a bitmap scan plan for the base relation scanned by 'best_path' 
 *    with restriction clauses 'scan_clauses' and targetlist 'tlist'. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN459"><span class='Ref_to_Struct'>BitmapHeapScan</span></a> <span class='Operator'>* 
</span><a name="LN2674"></a><span class='Declare_Function'>create_bitmap_scan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN2675"></a>                        <a href="../../../include/nodes/relation.h.html#LN1058"><span class='Ref_to_Struct'>BitmapHeapPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN2676"></a>                        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, 
</span><a name="LN2677"></a>                        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2679"></a>    <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>       <span class='Declare_Local'>baserelid</span> <span class='Operator'>= </span><a href="createplan.c.html#LN2675"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1060"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN552"><span class='Ref_to_Member'>relid</span></a><span class='Delimiter'>; 
</span><a name="LN2680"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>bitmapqualplan</span><span class='Delimiter'>; 
</span><a name="LN2681"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>bitmapqualorig</span><span class='Delimiter'>; 
</span><a name="LN2682"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>indexquals</span><span class='Delimiter'>; 
</span><a name="LN2683"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>indexECs</span><span class='Delimiter'>; 
</span><a name="LN2684"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>qpqual</span><span class='Delimiter'>; 
</span><a name="LN2685"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span><a name="LN2686"></a>    <a href="../../../include/nodes/plannodes.h.html#LN459"><span class='Ref_to_Struct'>BitmapHeapScan</span></a> <span class='Operator'>*</span><span class='Declare_Local'>scan_plan</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* it should be a base rel... */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN2679"><span class='Ref_To_Local'>baserelid</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN2675"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1060"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN554"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/parsenodes.h.html#LN922"><span class='Ref_to_EnumConst'>RTE_RELATION</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Process the bitmapqual tree into a Plan tree and qual lists */ 
</span>    <a href="createplan.c.html#LN2680"><span class='Ref_To_Local'>bitmapqualplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN125"><span class='Ref_to_Proto'>create_bitmap_subplan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2674"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2675"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1061"><span class='Ref_to_Member'>bitmapqual</span></a><span class='Delimiter'>, 
</span>                                           <span class='Operator'>&</span><a href="createplan.c.html#LN2681"><span class='Ref_To_Local'>bitmapqualorig</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN2682"><span class='Ref_To_Local'>indexquals</span></a><span class='Delimiter'>, 
</span>                                           <span class='Operator'>&</span><a href="createplan.c.html#LN2683"><span class='Ref_To_Local'>indexECs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN2675"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1060"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN957"><span class='Ref_to_Member'>parallel_aware</span></a><span class='Parentheses'>) 
</span>        <a href="createplan.c.html#LN127"><span class='Ref_to_Proto'>bitmap_subplan_mark_shared</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2680"><span class='Ref_To_Local'>bitmapqualplan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * The qpqual list must contain all restrictions not automatically handled 
     * by the index, other than pseudoconstant clauses which will be handled 
     * by a separate gating plan node.  All the predicates in the indexquals 
     * will be checked (either by the index itself, or by 
     * nodeBitmapHeapscan.c), but if there are any "special" operators 
     * involved then they must be added to qpqual.  The upshot is that qpqual 
     * must contain scan_clauses minus whatever appears in indexquals. 
     * 
     * This loop is similar to the comparable code in create_indexscan_plan(), 
     * but with some differences because it has to compare the scan clauses to 
     * stripped (no RestrictInfos) indexquals.  See comments there for more 
     * info. 
     * 
     * In normal cases simple equal() checks will be enough to spot duplicate 
     * clauses, so we try that first.  We next see if the scan clause is 
     * redundant with any top-level indexqual by virtue of being generated 
     * from the same EC.  After that, try predicate_implied_by(). 
     * 
     * Unlike create_indexscan_plan(), the predicate_implied_by() test here is 
     * useful for getting rid of qpquals that are implied by index predicates, 
     * because the predicate conditions are included in the "indexquals" 
     * returned by create_bitmap_subplan().  Bitmap scans have to do it that 
     * way because predicate conditions need to be rechecked if the scan 
     * becomes lossy, so they have to be included in bitmapqualorig. 
     */ 
</span>    <a href="createplan.c.html#LN2684"><span class='Ref_To_Local'>qpqual</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2685"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2677"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2729"></a>        <a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rinfo</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN108"><span class='Ref_to_Macro'>lfirst_node</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2685"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2730"></a>        <a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>clause</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN2729"><span class='Ref_To_Local'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1746"><span class='Ref_to_Member'>clause</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN2729"><span class='Ref_To_Local'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1754"><span class='Ref_to_Member'>pseudoconstant</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* we may drop pseudoconstants here */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN228"><span class='Ref_to_Proto'>list_member</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2682"><span class='Ref_To_Local'>indexquals</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2730"><span class='Ref_To_Local'>clause</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>continue</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* simple duplicate */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN2729"><span class='Ref_To_Local'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1780"><span class='Ref_to_Member'>parent_ec</span></a> <span class='Operator'>&& </span><a href="../../../include/nodes/pg_list.h.html#LN229"><span class='Ref_to_Proto'>list_member_ptr</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2683"><span class='Ref_To_Local'>indexECs</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2729"><span class='Ref_To_Local'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1780"><span class='Ref_to_Member'>parent_ec</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>continue</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* derived from same EquivalenceClass */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/optimizer/clauses.h.html#LN59"><span class='Ref_to_Proto'>contain_mutable_functions</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2730"><span class='Ref_To_Local'>clause</span></a><span class='Parentheses'>)</span> <span class='Operator'>&& 
</span>            <a href="../../../include/optimizer/predtest.h.html#LN19"><span class='Ref_to_Proto'>predicate_implied_by</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN138"><span class='Ref_to_Macro'>list_make1</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2730"><span class='Ref_To_Local'>clause</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="createplan.c.html#LN2682"><span class='Ref_To_Local'>indexquals</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>continue</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* provably implied by indexquals */ 
</span>        <a href="createplan.c.html#LN2684"><span class='Ref_To_Local'>qpqual</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2684"><span class='Ref_To_Local'>qpqual</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2729"><span class='Ref_To_Local'>rinfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Sort clauses into best execution order */ 
</span>    <a href="createplan.c.html#LN2684"><span class='Ref_To_Local'>qpqual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN161"><span class='Ref_to_Proto'>order_qual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2674"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2684"><span class='Ref_To_Local'>qpqual</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Reduce RestrictInfo list to bare expressions; ignore pseudoconstants */ 
</span>    <a href="createplan.c.html#LN2684"><span class='Ref_To_Local'>qpqual</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/restrictinfo.h.html#LN35"><span class='Ref_to_Proto'>extract_actual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2684"><span class='Ref_To_Local'>qpqual</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * When dealing with special operators, we will at this point have 
     * duplicate clauses in qpqual and bitmapqualorig.  We may as well drop 
     * 'em from bitmapqualorig, since there's no point in making the tests 
     * twice. 
     */ 
</span>    <a href="createplan.c.html#LN2681"><span class='Ref_To_Local'>bitmapqualorig</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN251"><span class='Ref_to_Proto'>list_difference_ptr</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2681"><span class='Ref_To_Local'>bitmapqualorig</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2684"><span class='Ref_To_Local'>qpqual</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We have to replace any outer-relation variables with nestloop params in 
     * the qpqual and bitmapqualorig expressions.  (This was already done for 
     * expressions attached to plan nodes in the bitmapqualplan tree.) 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN2675"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1060"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="createplan.c.html#LN2684"><span class='Ref_To_Local'>qpqual</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2674"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN2684"><span class='Ref_To_Local'>qpqual</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN2681"><span class='Ref_To_Local'>bitmapqualorig</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2674"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN2681"><span class='Ref_To_Local'>bitmapqualorig</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Finally ready to build the plan node */ 
</span>    <a href="createplan.c.html#LN2686"><span class='Ref_To_Local'>scan_plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN182"><span class='Ref_to_Proto'>make_bitmap_heapscan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2676"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>, 
</span>                                     <a href="createplan.c.html#LN2684"><span class='Ref_To_Local'>qpqual</span></a><span class='Delimiter'>, 
</span>                                     <a href="createplan.c.html#LN2680"><span class='Ref_To_Local'>bitmapqualplan</span></a><span class='Delimiter'>, 
</span>                                     <a href="createplan.c.html#LN2681"><span class='Ref_To_Local'>bitmapqualorig</span></a><span class='Delimiter'>, 
</span>                                     <a href="createplan.c.html#LN2679"><span class='Ref_To_Local'>baserelid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN2686"><span class='Ref_To_Local'>scan_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN461"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN2675"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1060"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN2686"><span class='Ref_To_Local'>scan_plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_bitmap_scan_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Given a bitmapqual tree, generate the Plan tree that implements it 
 * 
 * As byproducts, we also return in *qual and *indexqual the qual lists 
 * (in implicit-AND form, without RestrictInfos) describing the original index 
 * conditions and the generated indexqual conditions.  (These are the same in 
 * simple cases, but when special index operators are involved, the former 
 * list includes the special conditions while the latter includes the actual 
 * indexable conditions derived from them.)  Both lists include partial-index 
 * predicates, because we have to recheck predicates as well as index 
 * conditions if the bitmap scan becomes lossy. 
 * 
 * In addition, we return a list of EquivalenceClass pointers for all the 
 * top-level indexquals that were possibly-redundantly derived from ECs. 
 * This allows removal of scan_clauses that are redundant with such quals. 
 * (We do not attempt to detect such redundancies for quals that are within 
 * OR subtrees.  This could be done in a less hacky way if we returned the 
 * indexquals in RestrictInfo form, but that would be slower and still pretty 
 * messy, since we'd have to build new RestrictInfos in many cases.) 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>* 
</span><a name="LN2804"></a><span class='Declare_Function'>create_bitmap_subplan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>bitmapqual</span><span class='Delimiter'>, 
</span><a name="LN2805"></a>                      <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>qual</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>indexqual</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>indexECs</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2807"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2804"><span class='Ref_to_Parameter'>bitmapqual</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1070"><span class='Ref_to_Struct'>BitmapAndPath</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN2811"></a>        <a href="../../../include/nodes/relation.h.html#LN1070"><span class='Ref_to_Struct'>BitmapAndPath</span></a> <span class='Operator'>*</span><span class='Declare_Local'>apath</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1070"><span class='Ref_to_Struct'>BitmapAndPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN2804"><span class='Ref_to_Parameter'>bitmapqual</span></a><span class='Delimiter'>; 
</span><a name="LN2812"></a>        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplans</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN2813"></a>        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subquals</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN2814"></a>        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subindexquals</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN2815"></a>        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subindexECs</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN2816"></a>        <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * There may well be redundant quals among the subplans, since a 
         * top-level WHERE qual might have gotten used to form several 
         * different index quals.  We don't try exceedingly hard to eliminate 
         * redundancies, but we do eliminate obvious duplicates by using 
         * list_concat_unique. 
         */ 
</span>        <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2816"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2811"><span class='Ref_To_Local'>apath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1073"><span class='Ref_to_Member'>bitmapquals</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN2827"></a>            <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplan</span><span class='Delimiter'>; 
</span><a name="LN2828"></a>            <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subqual</span><span class='Delimiter'>; 
</span><a name="LN2829"></a>            <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subindexqual</span><span class='Delimiter'>; 
</span><a name="LN2830"></a>            <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subindexEC</span><span class='Delimiter'>; 
</span> 
            <a href="createplan.c.html#LN2827"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN125"><span class='Ref_to_Proto'>create_bitmap_subplan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2804"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2816"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                            <span class='Operator'>&</span><a href="createplan.c.html#LN2828"><span class='Ref_To_Local'>subqual</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN2829"><span class='Ref_To_Local'>subindexqual</span></a><span class='Delimiter'>, 
</span>                                            <span class='Operator'>&</span><a href="createplan.c.html#LN2830"><span class='Ref_To_Local'>subindexEC</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN2812"><span class='Ref_To_Local'>subplans</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2812"><span class='Ref_To_Local'>subplans</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2827"><span class='Ref_To_Local'>subplan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN2813"><span class='Ref_To_Local'>subquals</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN260"><span class='Ref_to_Proto'>list_concat_unique</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2813"><span class='Ref_To_Local'>subquals</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2828"><span class='Ref_To_Local'>subqual</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN2814"><span class='Ref_To_Local'>subindexquals</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN260"><span class='Ref_to_Proto'>list_concat_unique</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2814"><span class='Ref_To_Local'>subindexquals</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2829"><span class='Ref_To_Local'>subindexqual</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* Duplicates in indexECs aren't worth getting rid of */ 
</span>            <a href="createplan.c.html#LN2815"><span class='Ref_To_Local'>subindexECs</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN219"><span class='Ref_to_Proto'>list_concat</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2815"><span class='Ref_To_Local'>subindexECs</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2830"><span class='Ref_To_Local'>subindexEC</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="createplan.c.html#LN2807"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN212"><span class='Ref_to_Proto'>make_bitmap_and</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2812"><span class='Ref_To_Local'>subplans</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN2807"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN124"><span class='Ref_to_Member'>startup_cost</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN2811"><span class='Ref_To_Local'>apath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1072"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN964"><span class='Ref_to_Member'>startup_cost</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN2807"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN125"><span class='Ref_to_Member'>total_cost</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN2811"><span class='Ref_To_Local'>apath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1072"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN965"><span class='Ref_to_Member'>total_cost</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN2807"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN130"><span class='Ref_to_Member'>plan_rows</span></a> <span class='Operator'>= 
</span>            <a href="../../../include/optimizer/cost.h.html#LN71"><span class='Ref_to_Proto'>clamp_row_est</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2811"><span class='Ref_To_Local'>apath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1074"><span class='Ref_to_Member'>bitmapselectivity</span></a> <span class='Operator'>* </span><a href="createplan.c.html#LN2811"><span class='Ref_To_Local'>apath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1072"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN564"><span class='Ref_to_Member'>tuples</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN2807"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN131"><span class='Ref_to_Member'>plan_width</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>;</span>   <span class='Comment_Single_Line'>/* meaningless */ 
</span>        <a href="createplan.c.html#LN2807"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN136"><span class='Ref_to_Member'>parallel_aware</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN2807"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN137"><span class='Ref_to_Member'>parallel_safe</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN2811"><span class='Ref_To_Local'>apath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1072"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN958"><span class='Ref_to_Member'>parallel_safe</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="createplan.c.html#LN2805"><span class='Ref_to_Parameter'>qual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN2813"><span class='Ref_To_Local'>subquals</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="createplan.c.html#LN2805"><span class='Ref_to_Parameter'>indexqual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN2814"><span class='Ref_To_Local'>subindexquals</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="createplan.c.html#LN2805"><span class='Ref_to_Parameter'>indexECs</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN2815"><span class='Ref_To_Local'>subindexECs</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if IsA(bitmapqual,Bitmap... &raquo; </span> 
    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2804"><span class='Ref_to_Parameter'>bitmapqual</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1083"><span class='Ref_to_Struct'>BitmapOrPath</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN2855"></a>        <a href="../../../include/nodes/relation.h.html#LN1083"><span class='Ref_to_Struct'>BitmapOrPath</span></a> <span class='Operator'>*</span><span class='Declare_Local'>opath</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1083"><span class='Ref_to_Struct'>BitmapOrPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN2804"><span class='Ref_to_Parameter'>bitmapqual</span></a><span class='Delimiter'>; 
</span><a name="LN2856"></a>        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplans</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN2857"></a>        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subquals</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN2858"></a>        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subindexquals</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN2859"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>const_true_subqual</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN2860"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>const_true_subindexqual</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN2861"></a>        <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Here, we only detect qual-free subplans.  A qual-free subplan would 
         * cause us to generate "... OR true ..."  which we may as well reduce 
         * to just "true".  We do not try to eliminate redundant subclauses 
         * because (a) it's not as likely as in the AND case, and (b) we might 
         * well be working with hundreds or even thousands of OR conditions, 
         * perhaps from a long IN list.  The performance of list_append_unique 
         * would be unacceptable. 
         */ 
</span>        <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2861"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2855"><span class='Ref_To_Local'>opath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1086"><span class='Ref_to_Member'>bitmapquals</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN2874"></a>            <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplan</span><span class='Delimiter'>; 
</span><a name="LN2875"></a>            <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subqual</span><span class='Delimiter'>; 
</span><a name="LN2876"></a>            <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subindexqual</span><span class='Delimiter'>; 
</span><a name="LN2877"></a>            <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subindexEC</span><span class='Delimiter'>; 
</span> 
            <a href="createplan.c.html#LN2874"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN125"><span class='Ref_to_Proto'>create_bitmap_subplan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2804"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2861"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                            <span class='Operator'>&</span><a href="createplan.c.html#LN2875"><span class='Ref_To_Local'>subqual</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN2876"><span class='Ref_To_Local'>subindexqual</span></a><span class='Delimiter'>, 
</span>                                            <span class='Operator'>&</span><a href="createplan.c.html#LN2877"><span class='Ref_To_Local'>subindexEC</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN2856"><span class='Ref_To_Local'>subplans</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2856"><span class='Ref_To_Local'>subplans</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2874"><span class='Ref_To_Local'>subplan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN2875"><span class='Ref_To_Local'>subqual</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>                <a href="createplan.c.html#LN2859"><span class='Ref_To_Local'>const_true_subqual</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="createplan.c.html#LN2859"><span class='Ref_To_Local'>const_true_subqual</span></a><span class='Parentheses'>) 
</span>                <a href="createplan.c.html#LN2857"><span class='Ref_To_Local'>subquals</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2857"><span class='Ref_To_Local'>subquals</span></a><span class='Delimiter'>, 
</span>                                   <a href="../../../include/optimizer/clauses.h.html#LN45"><span class='Ref_to_Proto'>make_ands_explicit</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2875"><span class='Ref_To_Local'>subqual</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN2876"><span class='Ref_To_Local'>subindexqual</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>                <a href="createplan.c.html#LN2860"><span class='Ref_To_Local'>const_true_subindexqual</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="createplan.c.html#LN2860"><span class='Ref_To_Local'>const_true_subindexqual</span></a><span class='Parentheses'>) 
</span>                <a href="createplan.c.html#LN2858"><span class='Ref_To_Local'>subindexquals</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2858"><span class='Ref_To_Local'>subindexquals</span></a><span class='Delimiter'>, 
</span>                                        <a href="../../../include/optimizer/clauses.h.html#LN45"><span class='Ref_to_Proto'>make_ands_explicit</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2876"><span class='Ref_To_Local'>subindexqual</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * In the presence of ScalarArrayOpExpr quals, we might have built 
         * BitmapOrPaths with just one subpath; don't add an OR step. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2856"><span class='Ref_To_Local'>subplans</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="createplan.c.html#LN2807"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2856"><span class='Ref_To_Local'>subplans</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="createplan.c.html#LN2807"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN213"><span class='Ref_to_Proto'>make_bitmap_or</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2856"><span class='Ref_To_Local'>subplans</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN2807"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN124"><span class='Ref_to_Member'>startup_cost</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN2855"><span class='Ref_To_Local'>opath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1085"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN964"><span class='Ref_to_Member'>startup_cost</span></a><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN2807"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN125"><span class='Ref_to_Member'>total_cost</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN2855"><span class='Ref_To_Local'>opath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1085"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN965"><span class='Ref_to_Member'>total_cost</span></a><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN2807"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN130"><span class='Ref_to_Member'>plan_rows</span></a> <span class='Operator'>= 
</span>                <a href="../../../include/optimizer/cost.h.html#LN71"><span class='Ref_to_Proto'>clamp_row_est</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2855"><span class='Ref_To_Local'>opath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1087"><span class='Ref_to_Member'>bitmapselectivity</span></a> <span class='Operator'>* </span><a href="createplan.c.html#LN2855"><span class='Ref_To_Local'>opath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1085"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN564"><span class='Ref_to_Member'>tuples</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN2807"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN131"><span class='Ref_to_Member'>plan_width</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* meaningless */ 
</span>            <a href="createplan.c.html#LN2807"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN136"><span class='Ref_to_Member'>parallel_aware</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN2807"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN137"><span class='Ref_to_Member'>parallel_safe</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN2855"><span class='Ref_To_Local'>opath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1085"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN958"><span class='Ref_to_Member'>parallel_safe</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If there were constant-TRUE subquals, the OR reduces to constant 
         * TRUE.  Also, avoid generating one-element ORs, which could happen 
         * due to redundancy elimination or ScalarArrayOpExpr quals. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN2859"><span class='Ref_To_Local'>const_true_subqual</span></a><span class='Parentheses'>) 
</span>            <span class='Operator'>*</span><a href="createplan.c.html#LN2805"><span class='Ref_to_Parameter'>qual</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2857"><span class='Ref_To_Local'>subquals</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
            <span class='Operator'>*</span><a href="createplan.c.html#LN2805"><span class='Ref_to_Parameter'>qual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN2857"><span class='Ref_To_Local'>subquals</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <span class='Operator'>*</span><a href="createplan.c.html#LN2805"><span class='Ref_to_Parameter'>qual</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN138"><span class='Ref_to_Macro'>list_make1</span></a><span class='Parentheses'>(</span><a href="../../../include/optimizer/clauses.h.html#LN40"><span class='Ref_to_Proto'>make_orclause</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2857"><span class='Ref_To_Local'>subquals</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN2860"><span class='Ref_To_Local'>const_true_subindexqual</span></a><span class='Parentheses'>) 
</span>            <span class='Operator'>*</span><a href="createplan.c.html#LN2805"><span class='Ref_to_Parameter'>indexqual</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2858"><span class='Ref_To_Local'>subindexquals</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
            <span class='Operator'>*</span><a href="createplan.c.html#LN2805"><span class='Ref_to_Parameter'>indexqual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN2858"><span class='Ref_To_Local'>subindexquals</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <span class='Operator'>*</span><a href="createplan.c.html#LN2805"><span class='Ref_to_Parameter'>indexqual</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN138"><span class='Ref_to_Macro'>list_make1</span></a><span class='Parentheses'>(</span><a href="../../../include/optimizer/clauses.h.html#LN40"><span class='Ref_to_Proto'>make_orclause</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2858"><span class='Ref_To_Local'>subindexquals</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="createplan.c.html#LN2805"><span class='Ref_to_Parameter'>indexECs</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if IsA(bitmapqual,Bitmap... &raquo; </span> 
    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2804"><span class='Ref_to_Parameter'>bitmapqual</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1027"><span class='Ref_to_Struct'>IndexPath</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN2936"></a>        <a href="../../../include/nodes/relation.h.html#LN1027"><span class='Ref_to_Struct'>IndexPath</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>ipath</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1027"><span class='Ref_to_Struct'>IndexPath</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN2804"><span class='Ref_to_Parameter'>bitmapqual</span></a><span class='Delimiter'>; 
</span><a name="LN2937"></a>        <a href="../../../include/nodes/plannodes.h.html#LN385"><span class='Ref_to_Struct'>IndexScan</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>iscan</span><span class='Delimiter'>; 
</span><a name="LN2938"></a>        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subindexECs</span><span class='Delimiter'>; 
</span><a name="LN2939"></a>        <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Use the regular indexscan plan build machinery... */ 
</span>        <a href="createplan.c.html#LN2937"><span class='Ref_To_Local'>iscan</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN575"><span class='Ref_to_Macro'>castNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN385"><span class='Ref_to_Struct'>IndexScan</span></a><span class='Delimiter'>, 
</span>                         <a href="createplan.c.html#LN120"><span class='Ref_to_Proto'>create_indexscan_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2804"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2936"><span class='Ref_To_Local'>ipath</span></a><span class='Delimiter'>, 
</span>                                               <a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* then convert to a bitmap indexscan */ 
</span>        <a href="createplan.c.html#LN2807"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN179"><span class='Ref_to_Proto'>make_bitmap_indexscan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2937"><span class='Ref_To_Local'>iscan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN387"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN328"><span class='Ref_to_Member'>scanrelid</span></a><span class='Delimiter'>, 
</span>                                              <a href="createplan.c.html#LN2937"><span class='Ref_To_Local'>iscan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN388"><span class='Ref_to_Member'>indexid</span></a><span class='Delimiter'>, 
</span>                                              <a href="createplan.c.html#LN2937"><span class='Ref_To_Local'>iscan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN389"><span class='Ref_to_Member'>indexqual</span></a><span class='Delimiter'>, 
</span>                                              <a href="createplan.c.html#LN2937"><span class='Ref_To_Local'>iscan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN390"><span class='Ref_to_Member'>indexqualorig</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* and set its cost/width fields appropriately */ 
</span>        <a href="createplan.c.html#LN2807"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN124"><span class='Ref_to_Member'>startup_cost</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN2807"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN125"><span class='Ref_to_Member'>total_cost</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN2936"><span class='Ref_To_Local'>ipath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1037"><span class='Ref_to_Member'>indextotalcost</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN2807"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN130"><span class='Ref_to_Member'>plan_rows</span></a> <span class='Operator'>= 
</span>            <a href="../../../include/optimizer/cost.h.html#LN71"><span class='Ref_to_Proto'>clamp_row_est</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2936"><span class='Ref_To_Local'>ipath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1038"><span class='Ref_to_Member'>indexselectivity</span></a> <span class='Operator'>* </span><a href="createplan.c.html#LN2936"><span class='Ref_To_Local'>ipath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1029"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN564"><span class='Ref_to_Member'>tuples</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN2807"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN131"><span class='Ref_to_Member'>plan_width</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>;</span>   <span class='Comment_Single_Line'>/* meaningless */ 
</span>        <a href="createplan.c.html#LN2807"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN136"><span class='Ref_to_Member'>parallel_aware</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN2807"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN137"><span class='Ref_to_Member'>parallel_safe</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN2936"><span class='Ref_To_Local'>ipath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1029"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN958"><span class='Ref_to_Member'>parallel_safe</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="createplan.c.html#LN2805"><span class='Ref_to_Parameter'>qual</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/restrictinfo.h.html#LN34"><span class='Ref_to_Proto'>get_actual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2936"><span class='Ref_To_Local'>ipath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1031"><span class='Ref_to_Member'>indexclauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="createplan.c.html#LN2805"><span class='Ref_to_Parameter'>indexqual</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/restrictinfo.h.html#LN34"><span class='Ref_to_Proto'>get_actual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2936"><span class='Ref_To_Local'>ipath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1032"><span class='Ref_to_Member'>indexquals</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2939"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2936"><span class='Ref_To_Local'>ipath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1030"><span class='Ref_to_Member'>indexinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN653"><span class='Ref_to_Member'>indpred</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN2962"></a>            <a href="../../../include/nodes/primnodes.h.html#LN131"><span class='Ref_to_Struct'>Expr</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>pred</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN131"><span class='Ref_to_Struct'>Expr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2939"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * We know that the index predicate must have been implied by the 
             * query condition as a whole, but it may or may not be implied by 
             * the conditions that got pushed into the bitmapqual.  Avoid 
             * generating redundant conditions. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/optimizer/predtest.h.html#LN19"><span class='Ref_to_Proto'>predicate_implied_by</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN138"><span class='Ref_to_Macro'>list_make1</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2962"><span class='Ref_To_Local'>pred</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="createplan.c.html#LN2936"><span class='Ref_To_Local'>ipath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1031"><span class='Ref_to_Member'>indexclauses</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Operator'>*</span><a href="createplan.c.html#LN2805"><span class='Ref_to_Parameter'>qual</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="createplan.c.html#LN2805"><span class='Ref_to_Parameter'>qual</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2962"><span class='Ref_To_Local'>pred</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Operator'>*</span><a href="createplan.c.html#LN2805"><span class='Ref_to_Parameter'>indexqual</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="createplan.c.html#LN2805"><span class='Ref_to_Parameter'>indexqual</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2962"><span class='Ref_To_Local'>pred</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>        <a href="createplan.c.html#LN2938"><span class='Ref_To_Local'>subindexECs</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>        <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2939"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2936"><span class='Ref_To_Local'>ipath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1032"><span class='Ref_to_Member'>indexquals</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN2979"></a>            <a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rinfo</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2939"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN2979"><span class='Ref_To_Local'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1780"><span class='Ref_to_Member'>parent_ec</span></a><span class='Parentheses'>) 
</span>                <a href="createplan.c.html#LN2938"><span class='Ref_To_Local'>subindexECs</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2938"><span class='Ref_To_Local'>subindexECs</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN2979"><span class='Ref_To_Local'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1780"><span class='Ref_to_Member'>parent_ec</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Operator'>*</span><a href="createplan.c.html#LN2805"><span class='Ref_to_Parameter'>indexECs</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN2938"><span class='Ref_To_Local'>subindexECs</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if IsA(bitmapqual,IndexP... &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized node type: %d"</span><span class='Delimiter'>, </span><a href="../../../include/nodes/nodes.h.html#LN513"><span class='Ref_to_Macro'>nodeTag</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN2804"><span class='Ref_to_Parameter'>bitmapqual</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN2807"><span class='Ref_To_Local'>plan</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>            <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN2807"><span class='Ref_To_Local'>plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_bitmap_subplan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_tidscan_plan 
 *   Returns a tidscan plan for the base relation scanned by 'best_path' 
 *   with restriction clauses 'scan_clauses' and targetlist 'tlist'. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN472"><span class='Ref_to_Struct'>TidScan</span></a> <span class='Operator'>* 
</span><a name="LN3001"></a><span class='Declare_Function'>create_tidscan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1097"><span class='Ref_to_Struct'>TidPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN3002"></a>                    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3004"></a>    <a href="../../../include/nodes/plannodes.h.html#LN472"><span class='Ref_to_Struct'>TidScan</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>scan_plan</span><span class='Delimiter'>; 
</span><a name="LN3005"></a>    <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>       <span class='Declare_Local'>scan_relid</span> <span class='Operator'>= </span><a href="createplan.c.html#LN3001"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1099"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN552"><span class='Ref_to_Member'>relid</span></a><span class='Delimiter'>; 
</span><a name="LN3006"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>tidquals</span> <span class='Operator'>= </span><a href="createplan.c.html#LN3001"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1100"><span class='Ref_to_Member'>tidquals</span></a><span class='Delimiter'>; 
</span><a name="LN3007"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>ortidquals</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* it should be a base rel... */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN3005"><span class='Ref_To_Local'>scan_relid</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN3001"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1099"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN554"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/parsenodes.h.html#LN922"><span class='Ref_to_EnumConst'>RTE_RELATION</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Sort clauses into best execution order */ 
</span>    <a href="createplan.c.html#LN3002"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN161"><span class='Ref_to_Proto'>order_qual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3001"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3002"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Reduce RestrictInfo list to bare expressions; ignore pseudoconstants */ 
</span>    <a href="createplan.c.html#LN3002"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/restrictinfo.h.html#LN35"><span class='Ref_to_Proto'>extract_actual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3002"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Replace any outer-relation variables with nestloop params */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3001"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1099"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="createplan.c.html#LN3006"><span class='Ref_To_Local'>tidquals</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3001"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3006"><span class='Ref_To_Local'>tidquals</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN3002"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3001"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3002"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Remove any clauses that are TID quals.  This is a bit tricky since the 
     * tidquals list has implicit OR semantics. 
     */ 
</span>    <a href="createplan.c.html#LN3007"><span class='Ref_To_Local'>ortidquals</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3006"><span class='Ref_To_Local'>tidquals</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3007"><span class='Ref_To_Local'>ortidquals</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
        <a href="createplan.c.html#LN3007"><span class='Ref_To_Local'>ortidquals</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN138"><span class='Ref_to_Macro'>list_make1</span></a><span class='Parentheses'>(</span><a href="../../../include/optimizer/clauses.h.html#LN40"><span class='Ref_to_Proto'>make_orclause</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3007"><span class='Ref_To_Local'>ortidquals</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN3002"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN250"><span class='Ref_to_Proto'>list_difference</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3002"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3007"><span class='Ref_To_Local'>ortidquals</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN3004"><span class='Ref_To_Local'>scan_plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN187"><span class='Ref_to_Proto'>make_tidscan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3002"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>, 
</span>                             <a href="createplan.c.html#LN3002"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Delimiter'>, 
</span>                             <a href="createplan.c.html#LN3005"><span class='Ref_To_Local'>scan_relid</span></a><span class='Delimiter'>, 
</span>                             <a href="createplan.c.html#LN3006"><span class='Ref_To_Local'>tidquals</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN3004"><span class='Ref_To_Local'>scan_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN474"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN3001"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1099"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN3004"><span class='Ref_To_Local'>scan_plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_tidscan_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_subqueryscan_plan 
 *   Returns a subqueryscan plan for the base relation scanned by 'best_path' 
 *   with restriction clauses 'scan_clauses' and targetlist 'tlist'. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN494"><span class='Ref_to_Struct'>SubqueryScan</span></a> <span class='Operator'>* 
</span><a name="LN3053"></a><span class='Declare_Function'>create_subqueryscan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1111"><span class='Ref_to_Struct'>SubqueryScanPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN3054"></a>                         <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3056"></a>    <a href="../../../include/nodes/plannodes.h.html#LN494"><span class='Ref_to_Struct'>SubqueryScan</span></a> <span class='Operator'>*</span><span class='Declare_Local'>scan_plan</span><span class='Delimiter'>; 
</span><a name="LN3057"></a>    <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rel</span> <span class='Operator'>= </span><a href="createplan.c.html#LN3053"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1113"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Delimiter'>; 
</span><a name="LN3058"></a>    <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>       <span class='Declare_Local'>scan_relid</span> <span class='Operator'>= </span><a href="createplan.c.html#LN3057"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN552"><span class='Ref_to_Member'>relid</span></a><span class='Delimiter'>; 
</span><a name="LN3059"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>subplan</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* it should be a subquery base rel... */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN3058"><span class='Ref_To_Local'>scan_relid</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN3057"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN554"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/parsenodes.h.html#LN923"><span class='Ref_to_EnumConst'>RTE_SUBQUERY</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Recursively create Plan from Path for subquery.  Since we are entering 
     * a different planner context (subroot), recurse to create_plan not 
     * create_plan_recurse. 
     */ 
</span>    <a href="createplan.c.html#LN3059"><span class='Ref_To_Local'>subplan</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/planmain.h.html#LN49"><span class='Ref_to_Proto'>create_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3057"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN566"><span class='Ref_to_Member'>subroot</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3053"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1114"><span class='Ref_to_Member'>subpath</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Sort clauses into best execution order */ 
</span>    <a href="createplan.c.html#LN3054"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN161"><span class='Ref_to_Proto'>order_qual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3053"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3054"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Reduce RestrictInfo list to bare expressions; ignore pseudoconstants */ 
</span>    <a href="createplan.c.html#LN3054"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/restrictinfo.h.html#LN35"><span class='Ref_to_Proto'>extract_actual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3054"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Replace any outer-relation variables with nestloop params */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3053"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1113"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="createplan.c.html#LN3054"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3053"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3054"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN155"><span class='Ref_to_Proto'>process_subquery_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3053"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                         <a href="createplan.c.html#LN3057"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN567"><span class='Ref_to_Member'>subplan_params</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="createplan.c.html#LN3056"><span class='Ref_To_Local'>scan_plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN189"><span class='Ref_to_Proto'>make_subqueryscan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3054"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>, 
</span>                                  <a href="createplan.c.html#LN3054"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Delimiter'>, 
</span>                                  <a href="createplan.c.html#LN3058"><span class='Ref_To_Local'>scan_relid</span></a><span class='Delimiter'>, 
</span>                                  <a href="createplan.c.html#LN3059"><span class='Ref_To_Local'>subplan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN3056"><span class='Ref_To_Local'>scan_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN496"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN3053"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1113"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN3056"><span class='Ref_To_Local'>scan_plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_subqueryscan_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_functionscan_plan 
 *   Returns a functionscan plan for the base relation scanned by 'best_path' 
 *   with restriction clauses 'scan_clauses' and targetlist 'tlist'. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN504"><span class='Ref_to_Struct'>FunctionScan</span></a> <span class='Operator'>* 
</span><a name="LN3103"></a><span class='Declare_Function'>create_functionscan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN3104"></a>                         <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3106"></a>    <a href="../../../include/nodes/plannodes.h.html#LN504"><span class='Ref_to_Struct'>FunctionScan</span></a> <span class='Operator'>*</span><span class='Declare_Local'>scan_plan</span><span class='Delimiter'>; 
</span><a name="LN3107"></a>    <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>       <span class='Declare_Local'>scan_relid</span> <span class='Operator'>= </span><a href="createplan.c.html#LN3103"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN552"><span class='Ref_to_Member'>relid</span></a><span class='Delimiter'>; 
</span><a name="LN3108"></a>    <a href="../../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span><span class='Delimiter'>; 
</span><a name="LN3109"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>functions</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* it should be a function base rel... */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN3107"><span class='Ref_To_Local'>scan_relid</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN3108"><span class='Ref_To_Local'>rte</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/relation.h.html#LN324"><span class='Ref_to_Macro'>planner_rt_fetch</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3107"><span class='Ref_To_Local'>scan_relid</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3103"><span class='Ref_to_Parameter'>root</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN3108"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/parsenodes.h.html#LN925"><span class='Ref_to_EnumConst'>RTE_FUNCTION</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN3109"><span class='Ref_To_Local'>functions</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3108"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN985"><span class='Ref_to_Member'>functions</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Sort clauses into best execution order */ 
</span>    <a href="createplan.c.html#LN3104"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN161"><span class='Ref_to_Proto'>order_qual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3103"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3104"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Reduce RestrictInfo list to bare expressions; ignore pseudoconstants */ 
</span>    <a href="createplan.c.html#LN3104"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/restrictinfo.h.html#LN35"><span class='Ref_to_Proto'>extract_actual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3104"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Replace any outer-relation variables with nestloop params */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3103"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="createplan.c.html#LN3104"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3103"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3104"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* The function expressions could contain nestloop params, too */ 
</span>        <a href="createplan.c.html#LN3109"><span class='Ref_To_Local'>functions</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3103"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3109"><span class='Ref_To_Local'>functions</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="createplan.c.html#LN3106"><span class='Ref_To_Local'>scan_plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN193"><span class='Ref_to_Proto'>make_functionscan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3104"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3104"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3107"><span class='Ref_To_Local'>scan_relid</span></a><span class='Delimiter'>, 
</span>                                  <a href="createplan.c.html#LN3109"><span class='Ref_To_Local'>functions</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3108"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN986"><span class='Ref_to_Member'>funcordinality</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN3106"><span class='Ref_To_Local'>scan_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN506"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3103"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN3106"><span class='Ref_To_Local'>scan_plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_functionscan_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_tablefuncscan_plan 
 *   Returns a tablefuncscan plan for the base relation scanned by 'best_path' 
 *   with restriction clauses 'scan_clauses' and targetlist 'tlist'. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN525"><span class='Ref_to_Struct'>TableFuncScan</span></a> <span class='Operator'>* 
</span><a name="LN3146"></a><span class='Declare_Function'>create_tablefuncscan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN3147"></a>                          <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3149"></a>    <a href="../../../include/nodes/plannodes.h.html#LN525"><span class='Ref_to_Struct'>TableFuncScan</span></a> <span class='Operator'>*</span><span class='Declare_Local'>scan_plan</span><span class='Delimiter'>; 
</span><a name="LN3150"></a>    <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>       <span class='Declare_Local'>scan_relid</span> <span class='Operator'>= </span><a href="createplan.c.html#LN3146"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN552"><span class='Ref_to_Member'>relid</span></a><span class='Delimiter'>; 
</span><a name="LN3151"></a>    <a href="../../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span><span class='Delimiter'>; 
</span><a name="LN3152"></a>    <a href="../../../include/nodes/primnodes.h.html#LN78"><span class='Ref_to_Struct'>TableFunc</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>tablefunc</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* it should be a function base rel... */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN3150"><span class='Ref_To_Local'>scan_relid</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN3151"><span class='Ref_To_Local'>rte</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/relation.h.html#LN324"><span class='Ref_to_Macro'>planner_rt_fetch</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3150"><span class='Ref_To_Local'>scan_relid</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3146"><span class='Ref_to_Parameter'>root</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN3151"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/parsenodes.h.html#LN926"><span class='Ref_to_EnumConst'>RTE_TABLEFUNC</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN3152"><span class='Ref_To_Local'>tablefunc</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3151"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN991"><span class='Ref_to_Member'>tablefunc</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Sort clauses into best execution order */ 
</span>    <a href="createplan.c.html#LN3147"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN161"><span class='Ref_to_Proto'>order_qual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3146"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3147"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Reduce RestrictInfo list to bare expressions; ignore pseudoconstants */ 
</span>    <a href="createplan.c.html#LN3147"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/restrictinfo.h.html#LN35"><span class='Ref_to_Proto'>extract_actual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3147"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Replace any outer-relation variables with nestloop params */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3146"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="createplan.c.html#LN3147"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3146"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3147"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* The function expressions could contain nestloop params, too */ 
</span>        <a href="createplan.c.html#LN3152"><span class='Ref_To_Local'>tablefunc</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN78"><span class='Ref_to_Struct'>TableFunc</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3146"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3152"><span class='Ref_To_Local'>tablefunc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="createplan.c.html#LN3149"><span class='Ref_To_Local'>scan_plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN197"><span class='Ref_to_Proto'>make_tablefuncscan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3147"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3147"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3150"><span class='Ref_To_Local'>scan_relid</span></a><span class='Delimiter'>, 
</span>                                   <a href="createplan.c.html#LN3152"><span class='Ref_To_Local'>tablefunc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN3149"><span class='Ref_To_Local'>scan_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN527"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3146"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN3149"><span class='Ref_To_Local'>scan_plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_tablefuncscan_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_valuesscan_plan 
 *   Returns a valuesscan plan for the base relation scanned by 'best_path' 
 *   with restriction clauses 'scan_clauses' and targetlist 'tlist'. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN515"><span class='Ref_to_Struct'>ValuesScan</span></a> <span class='Operator'>* 
</span><a name="LN3189"></a><span class='Declare_Function'>create_valuesscan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN3190"></a>                       <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3192"></a>    <a href="../../../include/nodes/plannodes.h.html#LN515"><span class='Ref_to_Struct'>ValuesScan</span></a> <span class='Operator'>*</span><span class='Declare_Local'>scan_plan</span><span class='Delimiter'>; 
</span><a name="LN3193"></a>    <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>       <span class='Declare_Local'>scan_relid</span> <span class='Operator'>= </span><a href="createplan.c.html#LN3189"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN552"><span class='Ref_to_Member'>relid</span></a><span class='Delimiter'>; 
</span><a name="LN3194"></a>    <a href="../../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span><span class='Delimiter'>; 
</span><a name="LN3195"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>values_lists</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* it should be a values base rel... */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN3193"><span class='Ref_To_Local'>scan_relid</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN3194"><span class='Ref_To_Local'>rte</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/relation.h.html#LN324"><span class='Ref_to_Macro'>planner_rt_fetch</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3193"><span class='Ref_To_Local'>scan_relid</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3189"><span class='Ref_to_Parameter'>root</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN3194"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/parsenodes.h.html#LN927"><span class='Ref_to_EnumConst'>RTE_VALUES</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN3195"><span class='Ref_To_Local'>values_lists</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3194"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN996"><span class='Ref_to_Member'>values_lists</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Sort clauses into best execution order */ 
</span>    <a href="createplan.c.html#LN3190"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN161"><span class='Ref_to_Proto'>order_qual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3189"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3190"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Reduce RestrictInfo list to bare expressions; ignore pseudoconstants */ 
</span>    <a href="createplan.c.html#LN3190"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/restrictinfo.h.html#LN35"><span class='Ref_to_Proto'>extract_actual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3190"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Replace any outer-relation variables with nestloop params */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3189"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="createplan.c.html#LN3190"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3189"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3190"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* The values lists could contain nestloop params, too */ 
</span>        <a href="createplan.c.html#LN3195"><span class='Ref_To_Local'>values_lists</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3189"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3195"><span class='Ref_To_Local'>values_lists</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="createplan.c.html#LN3192"><span class='Ref_To_Local'>scan_plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN195"><span class='Ref_to_Proto'>make_valuesscan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3190"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3190"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3193"><span class='Ref_To_Local'>scan_relid</span></a><span class='Delimiter'>, 
</span>                                <a href="createplan.c.html#LN3195"><span class='Ref_To_Local'>values_lists</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN3192"><span class='Ref_To_Local'>scan_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN517"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3189"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN3192"><span class='Ref_To_Local'>scan_plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_valuesscan_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_ctescan_plan 
 *   Returns a ctescan plan for the base relation scanned by 'best_path' 
 *   with restriction clauses 'scan_clauses' and targetlist 'tlist'. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN535"><span class='Ref_to_Struct'>CteScan</span></a> <span class='Operator'>* 
</span><a name="LN3233"></a><span class='Declare_Function'>create_ctescan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN3234"></a>                    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3236"></a>    <a href="../../../include/nodes/plannodes.h.html#LN535"><span class='Ref_to_Struct'>CteScan</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>scan_plan</span><span class='Delimiter'>; 
</span><a name="LN3237"></a>    <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>       <span class='Declare_Local'>scan_relid</span> <span class='Operator'>= </span><a href="createplan.c.html#LN3233"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN552"><span class='Ref_to_Member'>relid</span></a><span class='Delimiter'>; 
</span><a name="LN3238"></a>    <a href="../../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span><span class='Delimiter'>; 
</span><a name="LN3239"></a>    <a href="../../../include/nodes/primnodes.h.html#LN678"><span class='Ref_to_Struct'>SubPlan</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>ctesplan</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN3240"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>plan_id</span><span class='Delimiter'>; 
</span><a name="LN3241"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>cte_param_id</span><span class='Delimiter'>; 
</span><a name="LN3242"></a>    <a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>cteroot</span><span class='Delimiter'>; 
</span><a name="LN3243"></a>    <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>       <span class='Declare_Local'>levelsup</span><span class='Delimiter'>; 
</span><a name="LN3244"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>ndx</span><span class='Delimiter'>; 
</span><a name="LN3245"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN3237"><span class='Ref_To_Local'>scan_relid</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN3238"><span class='Ref_To_Local'>rte</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/relation.h.html#LN324"><span class='Ref_to_Macro'>planner_rt_fetch</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3237"><span class='Ref_To_Local'>scan_relid</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3233"><span class='Ref_to_Parameter'>root</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN3238"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/parsenodes.h.html#LN928"><span class='Ref_to_EnumConst'>RTE_CTE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="createplan.c.html#LN3238"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1003"><span class='Ref_to_Member'>self_reference</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Find the referenced CTE, and locate the SubPlan previously made for it. 
     */ 
</span>    <a href="createplan.c.html#LN3243"><span class='Ref_To_Local'>levelsup</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3238"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1002"><span class='Ref_to_Member'>ctelevelsup</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN3242"><span class='Ref_To_Local'>cteroot</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3233"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3243"><span class='Ref_To_Local'>levelsup</span></a><span class='Operator'>-- &GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="createplan.c.html#LN3242"><span class='Ref_To_Local'>cteroot</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3242"><span class='Ref_To_Local'>cteroot</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN160"><span class='Ref_to_Member'>parent_root</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="createplan.c.html#LN3242"><span class='Ref_To_Local'>cteroot</span></a><span class='Parentheses'>)</span>           <span class='Comment_Single_Line'>/* shouldn't happen */ 
</span>            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"bad levelsup for CTE \"%s\""</span><span class='Delimiter'>, </span><a href="createplan.c.html#LN3238"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1001"><span class='Ref_to_Member'>ctename</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Note: cte_plan_ids can be shorter than cteList, if we are still working 
     * on planning the CTEs (ie, this is a side-reference from another CTE). 
     * So we mustn't use forboth here. 
     */ 
</span>    <a href="createplan.c.html#LN3244"><span class='Ref_To_Local'>ndx</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3245"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3242"><span class='Ref_To_Local'>cteroot</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN154"><span class='Ref_to_Member'>parse</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN132"><span class='Ref_to_Member'>cteList</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3272"></a>        <a href="../../../include/nodes/parsenodes.h.html#LN1339"><span class='Ref_to_Struct'>CommonTableExpr</span></a> <span class='Operator'>*</span><span class='Declare_Local'>cte</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/parsenodes.h.html#LN1339"><span class='Ref_to_Struct'>CommonTableExpr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3245"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="createplan.c.html#LN3272"><span class='Ref_To_Local'>cte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1342"><span class='Ref_to_Member'>ctename</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3238"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1001"><span class='Ref_to_Member'>ctename</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN3244"><span class='Ref_To_Local'>ndx</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3245"><span class='Ref_To_Local'>lc</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span>             <span class='Comment_Single_Line'>/* shouldn't happen */ 
</span>        <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"could not find CTE \"%s\""</span><span class='Delimiter'>, </span><a href="createplan.c.html#LN3238"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1001"><span class='Ref_to_Member'>ctename</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3244"><span class='Ref_To_Local'>ndx</span></a> <span class='Operator'>&GT;= </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3242"><span class='Ref_To_Local'>cteroot</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN229"><span class='Ref_to_Member'>cte_plan_ids</span></a><span class='Parentheses'>))</span> 
        <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"could not find plan for CTE \"%s\""</span><span class='Delimiter'>, </span><a href="createplan.c.html#LN3238"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1001"><span class='Ref_to_Member'>ctename</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN3240"><span class='Ref_To_Local'>plan_id</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN224"><span class='Ref_to_Proto'>list_nth_int</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3242"><span class='Ref_To_Local'>cteroot</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN229"><span class='Ref_to_Member'>cte_plan_ids</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3244"><span class='Ref_To_Local'>ndx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN3240"><span class='Ref_To_Local'>plan_id</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3245"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3242"><span class='Ref_To_Local'>cteroot</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN227"><span class='Ref_to_Member'>init_plans</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="createplan.c.html#LN3239"><span class='Ref_To_Local'>ctesplan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN678"><span class='Ref_to_Struct'>SubPlan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3245"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3239"><span class='Ref_To_Local'>ctesplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN687"><span class='Ref_to_Member'>plan_id</span></a> <span class='Operator'>== </span><a href="createplan.c.html#LN3240"><span class='Ref_To_Local'>plan_id</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3245"><span class='Ref_To_Local'>lc</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span>             <span class='Comment_Single_Line'>/* shouldn't happen */ 
</span>        <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"could not find plan for CTE \"%s\""</span><span class='Delimiter'>, </span><a href="createplan.c.html#LN3238"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1001"><span class='Ref_to_Member'>ctename</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We need the CTE param ID, which is the sole member of the SubPlan's 
     * setParam list. 
     */ 
</span>    <a href="createplan.c.html#LN3241"><span class='Ref_To_Local'>cte_param_id</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN111"><span class='Ref_to_Macro'>linitial_int</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3239"><span class='Ref_To_Local'>ctesplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN705"><span class='Ref_to_Member'>setParam</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Sort clauses into best execution order */ 
</span>    <a href="createplan.c.html#LN3234"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN161"><span class='Ref_to_Proto'>order_qual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3233"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3234"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Reduce RestrictInfo list to bare expressions; ignore pseudoconstants */ 
</span>    <a href="createplan.c.html#LN3234"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/restrictinfo.h.html#LN35"><span class='Ref_to_Proto'>extract_actual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3234"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Replace any outer-relation variables with nestloop params */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3233"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="createplan.c.html#LN3234"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3233"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3234"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="createplan.c.html#LN3236"><span class='Ref_To_Local'>scan_plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN199"><span class='Ref_to_Proto'>make_ctescan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3234"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3234"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3237"><span class='Ref_To_Local'>scan_relid</span></a><span class='Delimiter'>, 
</span>                             <a href="createplan.c.html#LN3240"><span class='Ref_To_Local'>plan_id</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3241"><span class='Ref_To_Local'>cte_param_id</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN3236"><span class='Ref_To_Local'>scan_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN537"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3233"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN3236"><span class='Ref_To_Local'>scan_plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_ctescan_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_namedtuplestorescan_plan 
 *   Returns a tuplestorescan plan for the base relation scanned by 
 *  'best_path' with restriction clauses 'scan_clauses' and targetlist 
 *  'tlist'. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN546"><span class='Ref_to_Struct'>NamedTuplestoreScan</span></a> <span class='Operator'>* 
</span><a name="LN3327"></a><span class='Declare_Function'>create_namedtuplestorescan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN3328"></a>                                <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3330"></a>    <a href="../../../include/nodes/plannodes.h.html#LN546"><span class='Ref_to_Struct'>NamedTuplestoreScan</span></a> <span class='Operator'>*</span><span class='Declare_Local'>scan_plan</span><span class='Delimiter'>; 
</span><a name="LN3331"></a>    <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>       <span class='Declare_Local'>scan_relid</span> <span class='Operator'>= </span><a href="createplan.c.html#LN3327"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN552"><span class='Ref_to_Member'>relid</span></a><span class='Delimiter'>; 
</span><a name="LN3332"></a>    <a href="../../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN3331"><span class='Ref_To_Local'>scan_relid</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN3332"><span class='Ref_To_Local'>rte</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/relation.h.html#LN324"><span class='Ref_to_Macro'>planner_rt_fetch</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3331"><span class='Ref_To_Local'>scan_relid</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3327"><span class='Ref_to_Parameter'>root</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN3332"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/parsenodes.h.html#LN929"><span class='Ref_to_EnumConst'>RTE_NAMEDTUPLESTORE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Sort clauses into best execution order */ 
</span>    <a href="createplan.c.html#LN3328"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN161"><span class='Ref_to_Proto'>order_qual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3327"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3328"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Reduce RestrictInfo list to bare expressions; ignore pseudoconstants */ 
</span>    <a href="createplan.c.html#LN3328"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/restrictinfo.h.html#LN35"><span class='Ref_to_Proto'>extract_actual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3328"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Replace any outer-relation variables with nestloop params */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3327"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="createplan.c.html#LN3328"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3327"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3328"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="createplan.c.html#LN3330"><span class='Ref_To_Local'>scan_plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN201"><span class='Ref_to_Proto'>make_namedtuplestorescan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3328"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3328"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3331"><span class='Ref_To_Local'>scan_relid</span></a><span class='Delimiter'>, 
</span>                                         <a href="createplan.c.html#LN3332"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1016"><span class='Ref_to_Member'>enrname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN3330"><span class='Ref_To_Local'>scan_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN548"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3327"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN3330"><span class='Ref_To_Local'>scan_plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_namedtuplestorescan_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_worktablescan_plan 
 *   Returns a worktablescan plan for the base relation scanned by 'best_path' 
 *   with restriction clauses 'scan_clauses' and targetlist 'tlist'. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN556"><span class='Ref_to_Struct'>WorkTableScan</span></a> <span class='Operator'>* 
</span><a name="LN3365"></a><span class='Declare_Function'>create_worktablescan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN3366"></a>                          <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3368"></a>    <a href="../../../include/nodes/plannodes.h.html#LN556"><span class='Ref_to_Struct'>WorkTableScan</span></a> <span class='Operator'>*</span><span class='Declare_Local'>scan_plan</span><span class='Delimiter'>; 
</span><a name="LN3369"></a>    <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>       <span class='Declare_Local'>scan_relid</span> <span class='Operator'>= </span><a href="createplan.c.html#LN3365"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN552"><span class='Ref_to_Member'>relid</span></a><span class='Delimiter'>; 
</span><a name="LN3370"></a>    <a href="../../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span><span class='Delimiter'>; 
</span><a name="LN3371"></a>    <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>       <span class='Declare_Local'>levelsup</span><span class='Delimiter'>; 
</span><a name="LN3372"></a>    <a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>cteroot</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN3369"><span class='Ref_To_Local'>scan_relid</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN3370"><span class='Ref_To_Local'>rte</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/relation.h.html#LN324"><span class='Ref_to_Macro'>planner_rt_fetch</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3369"><span class='Ref_To_Local'>scan_relid</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3365"><span class='Ref_to_Parameter'>root</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN3370"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/parsenodes.h.html#LN928"><span class='Ref_to_EnumConst'>RTE_CTE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN3370"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1003"><span class='Ref_to_Member'>self_reference</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We need to find the worktable param ID, which is in the plan level 
     * that's processing the recursive UNION, which is one level *below* where 
     * the CTE comes from. 
     */ 
</span>    <a href="createplan.c.html#LN3371"><span class='Ref_To_Local'>levelsup</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3370"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1002"><span class='Ref_to_Member'>ctelevelsup</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3371"><span class='Ref_To_Local'>levelsup</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span>          <span class='Comment_Single_Line'>/* shouldn't happen */ 
</span>        <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"bad levelsup for CTE \"%s\""</span><span class='Delimiter'>, </span><a href="createplan.c.html#LN3370"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1001"><span class='Ref_to_Member'>ctename</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN3371"><span class='Ref_To_Local'>levelsup</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN3372"><span class='Ref_To_Local'>cteroot</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3365"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3371"><span class='Ref_To_Local'>levelsup</span></a><span class='Operator'>-- &GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="createplan.c.html#LN3372"><span class='Ref_To_Local'>cteroot</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3372"><span class='Ref_To_Local'>cteroot</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN160"><span class='Ref_to_Member'>parent_root</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="createplan.c.html#LN3372"><span class='Ref_To_Local'>cteroot</span></a><span class='Parentheses'>)</span>           <span class='Comment_Single_Line'>/* shouldn't happen */ 
</span>            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"bad levelsup for CTE \"%s\""</span><span class='Delimiter'>, </span><a href="createplan.c.html#LN3370"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1001"><span class='Ref_to_Member'>ctename</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3372"><span class='Ref_To_Local'>cteroot</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN307"><span class='Ref_to_Member'>wt_param_id</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span>       <span class='Comment_Single_Line'>/* shouldn't happen */ 
</span>        <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"could not find param ID for CTE \"%s\""</span><span class='Delimiter'>, </span><a href="createplan.c.html#LN3370"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1001"><span class='Ref_to_Member'>ctename</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Sort clauses into best execution order */ 
</span>    <a href="createplan.c.html#LN3366"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN161"><span class='Ref_to_Proto'>order_qual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3365"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3366"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Reduce RestrictInfo list to bare expressions; ignore pseudoconstants */ 
</span>    <a href="createplan.c.html#LN3366"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/restrictinfo.h.html#LN35"><span class='Ref_to_Proto'>extract_actual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3366"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Replace any outer-relation variables with nestloop params */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3365"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="createplan.c.html#LN3366"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3365"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3366"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="createplan.c.html#LN3368"><span class='Ref_To_Local'>scan_plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN203"><span class='Ref_to_Proto'>make_worktablescan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3366"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3366"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3369"><span class='Ref_To_Local'>scan_relid</span></a><span class='Delimiter'>, 
</span>                                   <a href="createplan.c.html#LN3372"><span class='Ref_To_Local'>cteroot</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN307"><span class='Ref_to_Member'>wt_param_id</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN3368"><span class='Ref_To_Local'>scan_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN558"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3365"><span class='Ref_to_Parameter'>best_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN3368"><span class='Ref_To_Local'>scan_plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_worktablescan_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_foreignscan_plan 
 *   Returns a foreignscan plan for the relation scanned by 'best_path' 
 *   with restriction clauses 'scan_clauses' and targetlist 'tlist'. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN594"><span class='Ref_to_Struct'>ForeignScan</span></a> <span class='Operator'>* 
</span><a name="LN3425"></a><span class='Declare_Function'>create_foreignscan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1127"><span class='Ref_to_Struct'>ForeignPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN3426"></a>                        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3428"></a>    <a href="../../../include/nodes/plannodes.h.html#LN594"><span class='Ref_to_Struct'>ForeignScan</span></a> <span class='Operator'>*</span><span class='Declare_Local'>scan_plan</span><span class='Delimiter'>; 
</span><a name="LN3429"></a>    <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rel</span> <span class='Operator'>= </span><a href="createplan.c.html#LN3425"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1129"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Delimiter'>; 
</span><a name="LN3430"></a>    <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>       <span class='Declare_Local'>scan_relid</span> <span class='Operator'>= </span><a href="createplan.c.html#LN3429"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN552"><span class='Ref_to_Member'>relid</span></a><span class='Delimiter'>; 
</span><a name="LN3431"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>rel_oid</span> <span class='Operator'>= </span><a href="../../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span><a name="LN3432"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>outer_plan</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN3429"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN575"><span class='Ref_to_Member'>fdwroutine</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* transform the child path if any */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3425"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1130"><span class='Ref_to_Member'>fdw_outerpath</span></a><span class='Parentheses'>) 
</span>        <a href="createplan.c.html#LN3432"><span class='Ref_To_Local'>outer_plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3425"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3425"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1130"><span class='Ref_to_Member'>fdw_outerpath</span></a><span class='Delimiter'>, 
</span>                                         <a href="createplan.c.html#LN65"><span class='Ref_to_Const'>CP_EXACT_TLIST</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If we're scanning a base relation, fetch its OID.  (Irrelevant if 
     * scanning a join relation.) 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3430"><span class='Ref_To_Local'>scan_relid</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3447"></a>        <a href="../../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span><span class='Delimiter'>; 
</span> 
        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN3429"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN554"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/parsenodes.h.html#LN922"><span class='Ref_to_EnumConst'>RTE_RELATION</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN3447"><span class='Ref_To_Local'>rte</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/relation.h.html#LN324"><span class='Ref_to_Macro'>planner_rt_fetch</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3430"><span class='Ref_To_Local'>scan_relid</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3425"><span class='Ref_to_Parameter'>root</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN3447"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/parsenodes.h.html#LN922"><span class='Ref_to_EnumConst'>RTE_RELATION</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN3431"><span class='Ref_To_Local'>rel_oid</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3447"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN947"><span class='Ref_to_Member'>relid</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Sort clauses into best execution order.  We do this first since the FDW 
     * might have more info than we do and wish to adjust the ordering. 
     */ 
</span>    <a href="createplan.c.html#LN3426"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN161"><span class='Ref_to_Proto'>order_qual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3425"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3426"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Let the FDW perform its processing on the restriction clauses and 
     * generate the plan node.  Note that the FDW might remove restriction 
     * clauses that it intends to execute remotely, or even add more (if it 
     * has selected some join clauses for remote use but also wants them 
     * rechecked locally). 
     */ 
</span>    <a href="createplan.c.html#LN3428"><span class='Ref_To_Local'>scan_plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3429"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN575"><span class='Ref_to_Member'>fdwroutine</span></a><span class='Operator'>-&GT;</span><a href="../../../include/foreign/fdwapi.h.html#LN175"><span class='Ref_to_Member'>GetForeignPlan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3425"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3429"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3431"><span class='Ref_To_Local'>rel_oid</span></a><span class='Delimiter'>, 
</span>                                                <a href="createplan.c.html#LN3425"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, 
</span>                                                <a href="createplan.c.html#LN3426"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3426"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Delimiter'>, 
</span>                                                <a href="createplan.c.html#LN3432"><span class='Ref_To_Local'>outer_plan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Copy cost data from Path to Plan; no need to make FDW do this */ 
</span>    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN3428"><span class='Ref_To_Local'>scan_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN596"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN3425"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1129"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Copy foreign server OID; likewise, no need to make FDW do this */ 
</span>    <a href="createplan.c.html#LN3428"><span class='Ref_To_Local'>scan_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN598"><span class='Ref_to_Member'>fs_server</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3429"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN571"><span class='Ref_to_Member'>serverid</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Likewise, copy the relids that are represented by this foreign scan. An 
     * upper rel doesn't have relids set, but it covers all the base relations 
     * participating in the underlying scan, so use root's all_baserels. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN512"><span class='Ref_to_Macro'>IS_UPPER_REL</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3429"><span class='Ref_To_Local'>rel</span></a><span class='Parentheses'>))</span> 
        <a href="createplan.c.html#LN3428"><span class='Ref_To_Local'>scan_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN604"><span class='Ref_to_Member'>fs_relids</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3425"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN195"><span class='Ref_to_Member'>all_baserels</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="createplan.c.html#LN3428"><span class='Ref_To_Local'>scan_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN604"><span class='Ref_to_Member'>fs_relids</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3425"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1129"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If this is a foreign join, and to make it valid to push down we had to 
     * assume that the current user is the same as some user explicitly named 
     * in the query, mark the finished plan as depending on the current user. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3429"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN573"><span class='Ref_to_Member'>useridiscurrent</span></a><span class='Parentheses'>) 
</span>        <a href="createplan.c.html#LN3425"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN156"><span class='Ref_to_Member'>glob</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN126"><span class='Ref_to_Member'>dependsOnRole</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Replace any outer-relation variables with nestloop params in the qual, 
     * fdw_exprs and fdw_recheck_quals expressions.  We do this last so that 
     * the FDW doesn't have to be involved.  (Note that parts of fdw_exprs or 
     * fdw_recheck_quals could have come from join clauses, so doing this 
     * beforehand on the scan_clauses wouldn't work.)  We assume 
     * fdw_scan_tlist contains no such variables. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3425"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1129"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="createplan.c.html#LN3428"><span class='Ref_To_Local'>scan_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN596"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3425"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3428"><span class='Ref_To_Local'>scan_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN596"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN3428"><span class='Ref_To_Local'>scan_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN599"><span class='Ref_to_Member'>fdw_exprs</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3425"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3428"><span class='Ref_To_Local'>scan_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN599"><span class='Ref_to_Member'>fdw_exprs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN3428"><span class='Ref_To_Local'>scan_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN602"><span class='Ref_to_Member'>fdw_recheck_quals</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3425"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                    <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3428"><span class='Ref_To_Local'>scan_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN602"><span class='Ref_to_Member'>fdw_recheck_quals</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If rel is a base relation, detect whether any system columns are 
     * requested from the rel.  (If rel is a join relation, rel-&GT;relid will be 
     * 0, but there can be no Var with relid 0 in the rel's targetlist or the 
     * restriction clauses, so we skip this in that case.  Note that any such 
     * columns in base relations that were joined are assumed to be contained 
     * in fdw_scan_tlist.)  This is a bit of a kluge and might go away 
     * someday, so we intentionally leave it out of the API presented to FDWs. 
     */ 
</span>    <a href="createplan.c.html#LN3428"><span class='Ref_To_Local'>scan_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN605"><span class='Ref_to_Member'>fsSystemCol</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3430"><span class='Ref_To_Local'>scan_relid</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3528"></a>        <a href="../../../include/nodes/bitmapset.h.html#LN36"><span class='Ref_to_Struct'>Bitmapset</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>attrs_used</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN3529"></a>        <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span><a name="LN3530"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * First, examine all the attributes needed for joins or final output. 
         * Note: we must look at rel's targetlist, not the attr_needed data, 
         * because attr_needed isn't computed for inheritance child rels. 
         */ 
</span>        <a href="../../../include/optimizer/var.h.html#LN31"><span class='Ref_to_Proto'>pull_varattnos</span></a><span class='Parentheses'>((</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3429"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN535"><span class='Ref_to_Member'>reltarget</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN882"><span class='Ref_to_Member'>exprs</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3430"><span class='Ref_To_Local'>scan_relid</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN3528"><span class='Ref_To_Local'>attrs_used</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Add all the attributes used by restriction clauses. */ 
</span>        <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3529"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3429"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN583"><span class='Ref_to_Member'>baserestrictinfo</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN3542"></a>            <a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rinfo</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3529"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="../../../include/optimizer/var.h.html#LN31"><span class='Ref_to_Proto'>pull_varattnos</span></a><span class='Parentheses'>((</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3542"><span class='Ref_To_Local'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1746"><span class='Ref_to_Member'>clause</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3430"><span class='Ref_To_Local'>scan_relid</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN3528"><span class='Ref_To_Local'>attrs_used</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* Now, are any system columns requested from rel? */ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3530"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="../../../include/access/sysattr.h.html#LN27"><span class='Ref_to_Const'>FirstLowInvalidHeapAttributeNumber</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; </span><a href="createplan.c.html#LN3530"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="createplan.c.html#LN3530"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/bitmapset.h.html#LN75"><span class='Ref_to_Proto'>bms_is_member</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3530"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>- </span><a href="../../../include/access/sysattr.h.html#LN27"><span class='Ref_to_Const'>FirstLowInvalidHeapAttributeNumber</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3528"><span class='Ref_To_Local'>attrs_used</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span>                <a href="createplan.c.html#LN3428"><span class='Ref_To_Local'>scan_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN605"><span class='Ref_to_Member'>fsSystemCol</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="../../../include/nodes/bitmapset.h.html#LN68"><span class='Ref_to_Proto'>bms_free</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3528"><span class='Ref_To_Local'>attrs_used</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if scan_relid&GT;0 &raquo; </span> 
 
    <span class='Control'>return</span> <a href="createplan.c.html#LN3428"><span class='Ref_To_Local'>scan_plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_foreignscan_plan &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * create_custom_plan 
 * 
 * Transform a CustomPath into a Plan. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN623"><span class='Ref_to_Struct'>CustomScan</span></a> <span class='Operator'>* 
</span><a name="LN3569"></a><span class='Declare_Function'>create_customscan_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1155"><span class='Ref_to_Struct'>CustomPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Delimiter'>, 
</span><a name="LN3570"></a>                       <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scan_clauses</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3572"></a>    <a href="../../../include/nodes/plannodes.h.html#LN623"><span class='Ref_to_Struct'>CustomScan</span></a> <span class='Operator'>*</span><span class='Declare_Local'>cplan</span><span class='Delimiter'>; 
</span><a name="LN3573"></a>    <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rel</span> <span class='Operator'>= </span><a href="createplan.c.html#LN3569"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1157"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Delimiter'>; 
</span><a name="LN3574"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>custom_plans</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN3575"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Recursively transform child paths. */ 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3575"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3569"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1160"><span class='Ref_to_Member'>custom_paths</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3580"></a>        <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3569"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3575"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                               <a href="createplan.c.html#LN65"><span class='Ref_to_Const'>CP_EXACT_TLIST</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN3574"><span class='Ref_To_Local'>custom_plans</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3574"><span class='Ref_To_Local'>custom_plans</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3580"><span class='Ref_To_Local'>plan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Sort clauses into the best execution order, although custom-scan 
     * provider can reorder them again. 
     */ 
</span>    <a href="createplan.c.html#LN3570"><span class='Ref_to_Parameter'>scan_clauses</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN161"><span class='Ref_to_Proto'>order_qual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3569"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3570"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Invoke custom plan provider to create the Plan node represented by the 
     * CustomPath. 
     */ 
</span>    <a href="createplan.c.html#LN3572"><span class='Ref_To_Local'>cplan</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN575"><span class='Ref_to_Macro'>castNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN623"><span class='Ref_to_Struct'>CustomScan</span></a><span class='Delimiter'>, 
</span>                     <a href="createplan.c.html#LN3569"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1162"><span class='Ref_to_Member'>methods</span></a><span class='Operator'>-&GT;</span>PlanCustomPath<span class='Parentheses'>(</span><a href="createplan.c.html#LN3569"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                        <a href="createplan.c.html#LN3573"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>, 
</span>                                                        <a href="createplan.c.html#LN3569"><span class='Ref_to_Parameter'>best_path</span></a><span class='Delimiter'>, 
</span>                                                        <a href="createplan.c.html#LN3570"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>, 
</span>                                                        <a href="createplan.c.html#LN3570"><span class='Ref_to_Parameter'>scan_clauses</span></a><span class='Delimiter'>, 
</span>                                                        <a href="createplan.c.html#LN3574"><span class='Ref_To_Local'>custom_plans</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Copy cost data from Path to Plan; no need to make custom-plan providers 
     * do this 
     */ 
</span>    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN3572"><span class='Ref_To_Local'>cplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN625"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN3569"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1157"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Likewise, copy the relids that are represented by this custom scan */ 
</span>    <a href="createplan.c.html#LN3572"><span class='Ref_To_Local'>cplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN633"><span class='Ref_to_Member'>custom_relids</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3569"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1157"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Replace any outer-relation variables with nestloop params in the qual 
     * and custom_exprs expressions.  We do this last so that the custom-plan 
     * provider doesn't have to be involved.  (Note that parts of custom_exprs 
     * could have come from join clauses, so doing this beforehand on the 
     * scan_clauses wouldn't work.)  We assume custom_scan_tlist contains no 
     * such variables. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3569"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1157"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="createplan.c.html#LN3572"><span class='Ref_To_Local'>cplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN625"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3569"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3572"><span class='Ref_To_Local'>cplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN625"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN3572"><span class='Ref_To_Local'>cplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN629"><span class='Ref_to_Member'>custom_exprs</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3569"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3572"><span class='Ref_To_Local'>cplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN629"><span class='Ref_to_Member'>custom_exprs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN3572"><span class='Ref_To_Local'>cplan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_customscan_plan &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/***************************************************************************** 
 * 
 *  JOIN METHODS 
 * 
 *****************************************************************************/ 
</span> 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN684"><span class='Ref_to_Struct'>NestLoop</span></a> <span class='Operator'>* 
</span><a name="LN3640"></a><span class='Declare_Function'>create_nestloop_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN3641"></a>                     <a href="../../../include/nodes/relation.h.html#LN1311"><span class='Ref_to_Typedef'>NestPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3643"></a>    <a href="../../../include/nodes/plannodes.h.html#LN684"><span class='Ref_to_Struct'>NestLoop</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>join_plan</span><span class='Delimiter'>; 
</span><a name="LN3644"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>outer_plan</span><span class='Delimiter'>; 
</span><a name="LN3645"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>inner_plan</span><span class='Delimiter'>; 
</span><a name="LN3646"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>tlist</span> <span class='Operator'>= </span><a href="createplan.c.html#LN74"><span class='Ref_to_Proto'>build_path_tlist</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3640"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN3641"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1288"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN3647"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>joinrestrictclauses</span> <span class='Operator'>= </span><a href="createplan.c.html#LN3641"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1298"><span class='Ref_to_Member'>joinrestrictinfo</span></a><span class='Delimiter'>; 
</span><a name="LN3648"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>joinclauses</span><span class='Delimiter'>; 
</span><a name="LN3649"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>otherclauses</span><span class='Delimiter'>; 
</span><a name="LN3650"></a>    <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a>      <span class='Declare_Local'>outerrelids</span><span class='Delimiter'>; 
</span><a name="LN3651"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>nestParams</span><span class='Delimiter'>; 
</span><a name="LN3652"></a>    <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a>      <span class='Declare_Local'>saveOuterRels</span> <span class='Operator'>= </span><a href="createplan.c.html#LN3640"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN311"><span class='Ref_to_Member'>curOuterRels</span></a><span class='Delimiter'>; 
</span><a name="LN3653"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>cell</span><span class='Delimiter'>; 
</span><a name="LN3654"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>prev</span><span class='Delimiter'>; 
</span><a name="LN3655"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>next</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* NestLoop can project, so no need to be picky about child tlists */ 
</span>    <a href="createplan.c.html#LN3644"><span class='Ref_To_Local'>outer_plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3640"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3641"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1295"><span class='Ref_to_Member'>outerjoinpath</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* For a nestloop, include outer relids in curOuterRels for inner side */ 
</span>    <a href="createplan.c.html#LN3640"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN311"><span class='Ref_to_Member'>curOuterRels</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/bitmapset.h.html#LN70"><span class='Ref_to_Proto'>bms_union</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3640"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN311"><span class='Ref_to_Member'>curOuterRels</span></a><span class='Delimiter'>, 
</span>                                   <a href="createplan.c.html#LN3641"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1295"><span class='Ref_to_Member'>outerjoinpath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN3645"><span class='Ref_To_Local'>inner_plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3640"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3641"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1296"><span class='Ref_to_Member'>innerjoinpath</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Restore curOuterRels */ 
</span>    <a href="../../../include/nodes/bitmapset.h.html#LN68"><span class='Ref_to_Proto'>bms_free</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3640"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN311"><span class='Ref_to_Member'>curOuterRels</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN3640"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN311"><span class='Ref_to_Member'>curOuterRels</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3652"><span class='Ref_To_Local'>saveOuterRels</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Sort join qual clauses into best execution order */ 
</span>    <a href="createplan.c.html#LN3647"><span class='Ref_To_Local'>joinrestrictclauses</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN161"><span class='Ref_to_Proto'>order_qual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3640"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3647"><span class='Ref_To_Local'>joinrestrictclauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Get the join qual clauses (in plain expression form) */ 
</span>    <span class='Comment_Multi_Line'>/* Any pseudoconstant clauses are ignored here */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN720"><span class='Ref_to_Macro'>IS_OUTER_JOIN</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3641"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1290"><span class='Ref_to_Member'>jointype</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../../include/optimizer/restrictinfo.h.html#LN37"><span class='Ref_to_Proto'>extract_actual_join_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3647"><span class='Ref_To_Local'>joinrestrictclauses</span></a><span class='Delimiter'>, 
</span>                                    <span class='Operator'>&</span><a href="createplan.c.html#LN3648"><span class='Ref_To_Local'>joinclauses</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN3649"><span class='Ref_To_Local'>otherclauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* We can treat all clauses alike for an inner join */ 
</span>        <a href="createplan.c.html#LN3648"><span class='Ref_To_Local'>joinclauses</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/restrictinfo.h.html#LN35"><span class='Ref_to_Proto'>extract_actual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3647"><span class='Ref_To_Local'>joinrestrictclauses</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN3649"><span class='Ref_To_Local'>otherclauses</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Replace any outer-relation variables with nestloop params */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3641"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1288"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="createplan.c.html#LN3648"><span class='Ref_To_Local'>joinclauses</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3640"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3648"><span class='Ref_To_Local'>joinclauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN3649"><span class='Ref_To_Local'>otherclauses</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3640"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3649"><span class='Ref_To_Local'>otherclauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Identify any nestloop parameters that should be supplied by this join 
     * node, and move them from root-&GT;curOuterParams to the nestParams list. 
     */ 
</span>    <a href="createplan.c.html#LN3650"><span class='Ref_To_Local'>outerrelids</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3641"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1295"><span class='Ref_to_Member'>outerjoinpath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN3651"><span class='Ref_To_Local'>nestParams</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN3654"><span class='Ref_To_Local'>prev</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3653"><span class='Ref_To_Local'>cell</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN75"><span class='Ref_to_Func'>list_head</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3640"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN312"><span class='Ref_to_Member'>curOuterParams</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="createplan.c.html#LN3653"><span class='Ref_To_Local'>cell</span></a><span class='Delimiter'>; </span><a href="createplan.c.html#LN3653"><span class='Ref_To_Local'>cell</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3655"><span class='Ref_To_Local'>next</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span><a name="LN3705"></a>        <a href="../../../include/nodes/plannodes.h.html#LN690"><span class='Ref_to_Struct'>NestLoopParam</span></a> <span class='Operator'>*</span><span class='Declare_Local'>nlp</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN690"><span class='Ref_to_Struct'>NestLoopParam</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3653"><span class='Ref_To_Local'>cell</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN3655"><span class='Ref_To_Local'>next</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN104"><span class='Ref_to_Macro'>lnext</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3653"><span class='Ref_To_Local'>cell</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3705"><span class='Ref_To_Local'>nlp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN694"><span class='Ref_to_Member'>paramval</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>            <a href="../../../include/nodes/bitmapset.h.html#LN75"><span class='Ref_to_Proto'>bms_is_member</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3705"><span class='Ref_To_Local'>nlp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN694"><span class='Ref_to_Member'>paramval</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN165"><span class='Ref_to_Member'>varno</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3650"><span class='Ref_To_Local'>outerrelids</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="createplan.c.html#LN3640"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN312"><span class='Ref_to_Member'>curOuterParams</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN238"><span class='Ref_to_Proto'>list_delete_cell</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3640"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN312"><span class='Ref_to_Member'>curOuterParams</span></a><span class='Delimiter'>, 
</span>                                                    <a href="createplan.c.html#LN3653"><span class='Ref_To_Local'>cell</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3654"><span class='Ref_To_Local'>prev</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN3651"><span class='Ref_To_Local'>nestParams</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3651"><span class='Ref_To_Local'>nestParams</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3705"><span class='Ref_To_Local'>nlp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3705"><span class='Ref_To_Local'>nlp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN694"><span class='Ref_to_Member'>paramval</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1846"><span class='Ref_to_Struct'>PlaceHolderVar</span></a><span class='Parentheses'>)</span> <span class='Operator'>&& 
</span>                 <a href="../../../include/nodes/bitmapset.h.html#LN76"><span class='Ref_to_Proto'>bms_overlap</span></a><span class='Parentheses'>(((</span><a href="../../../include/nodes/relation.h.html#LN1846"><span class='Ref_to_Struct'>PlaceHolderVar</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3705"><span class='Ref_To_Local'>nlp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN694"><span class='Ref_to_Member'>paramval</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>phrels<span class='Delimiter'>, 
</span>                             <a href="createplan.c.html#LN3650"><span class='Ref_To_Local'>outerrelids</span></a><span class='Parentheses'>)</span> <span class='Operator'>&& 
</span>                 <a href="../../../include/nodes/bitmapset.h.html#LN73"><span class='Ref_to_Proto'>bms_is_subset</span></a><span class='Parentheses'>(</span><a href="../../../include/optimizer/placeholder.h.html#LN21"><span class='Ref_to_Proto'>find_placeholder_info</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3640"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                            <span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1846"><span class='Ref_to_Struct'>PlaceHolderVar</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3705"><span class='Ref_To_Local'>nlp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN694"><span class='Ref_to_Member'>paramval</span></a><span class='Delimiter'>, 
</span>                                                     <span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>ph_eval_at<span class='Delimiter'>, 
</span>                               <a href="createplan.c.html#LN3650"><span class='Ref_To_Local'>outerrelids</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="createplan.c.html#LN3640"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN312"><span class='Ref_to_Member'>curOuterParams</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN238"><span class='Ref_to_Proto'>list_delete_cell</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3640"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN312"><span class='Ref_to_Member'>curOuterParams</span></a><span class='Delimiter'>, 
</span>                                                    <a href="createplan.c.html#LN3653"><span class='Ref_To_Local'>cell</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3654"><span class='Ref_To_Local'>prev</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN3651"><span class='Ref_To_Local'>nestParams</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3651"><span class='Ref_To_Local'>nestParams</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3705"><span class='Ref_To_Local'>nlp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
            <a href="createplan.c.html#LN3654"><span class='Ref_To_Local'>prev</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3653"><span class='Ref_To_Local'>cell</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for cell=list_head(root-&GT;... &raquo; </span> 
 
    <a href="createplan.c.html#LN3643"><span class='Ref_To_Local'>join_plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN214"><span class='Ref_to_Proto'>make_nestloop</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3646"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, 
</span>                              <a href="createplan.c.html#LN3648"><span class='Ref_To_Local'>joinclauses</span></a><span class='Delimiter'>, 
</span>                              <a href="createplan.c.html#LN3649"><span class='Ref_To_Local'>otherclauses</span></a><span class='Delimiter'>, 
</span>                              <a href="createplan.c.html#LN3651"><span class='Ref_To_Local'>nestParams</span></a><span class='Delimiter'>, 
</span>                              <a href="createplan.c.html#LN3644"><span class='Ref_To_Local'>outer_plan</span></a><span class='Delimiter'>, 
</span>                              <a href="createplan.c.html#LN3645"><span class='Ref_To_Local'>inner_plan</span></a><span class='Delimiter'>, 
</span>                              <a href="createplan.c.html#LN3641"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1290"><span class='Ref_to_Member'>jointype</span></a><span class='Delimiter'>, 
</span>                              <a href="createplan.c.html#LN3641"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1292"><span class='Ref_to_Member'>inner_unique</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN3643"><span class='Ref_To_Local'>join_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN686"><span class='Ref_to_Member'>join</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN667"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN3641"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1288"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN3643"><span class='Ref_To_Local'>join_plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_nestloop_plan &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN708"><span class='Ref_to_Struct'>MergeJoin</span></a> <span class='Operator'>* 
</span><a name="LN3746"></a><span class='Declare_Function'>create_mergejoin_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN3747"></a>                      <a href="../../../include/nodes/relation.h.html#LN1348"><span class='Ref_to_Struct'>MergePath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3749"></a>    <a href="../../../include/nodes/plannodes.h.html#LN708"><span class='Ref_to_Struct'>MergeJoin</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>join_plan</span><span class='Delimiter'>; 
</span><a name="LN3750"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>outer_plan</span><span class='Delimiter'>; 
</span><a name="LN3751"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>inner_plan</span><span class='Delimiter'>; 
</span><a name="LN3752"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>tlist</span> <span class='Operator'>= </span><a href="createplan.c.html#LN74"><span class='Ref_to_Proto'>build_path_tlist</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3746"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1350"><span class='Ref_to_Member'>jpath</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN1288"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN3753"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>joinclauses</span><span class='Delimiter'>; 
</span><a name="LN3754"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>otherclauses</span><span class='Delimiter'>; 
</span><a name="LN3755"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>mergeclauses</span><span class='Delimiter'>; 
</span><a name="LN3756"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>outerpathkeys</span><span class='Delimiter'>; 
</span><a name="LN3757"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>innerpathkeys</span><span class='Delimiter'>; 
</span><a name="LN3758"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>nClauses</span><span class='Delimiter'>; 
</span><a name="LN3759"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>mergefamilies</span><span class='Delimiter'>; 
</span><a name="LN3760"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>mergecollations</span><span class='Delimiter'>; 
</span><a name="LN3761"></a>    <span class='Keyword'>int</span>        <span class='Operator'>*</span><span class='Declare_Local'>mergestrategies</span><span class='Delimiter'>; 
</span><a name="LN3762"></a>    <span class='Keyword'>bool</span>       <span class='Operator'>*</span><span class='Declare_Local'>mergenullsfirst</span><span class='Delimiter'>; 
</span><a name="LN3763"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN3764"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span><a name="LN3765"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lop</span><span class='Delimiter'>; 
</span><a name="LN3766"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lip</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * MergeJoin can project, so we don't have to demand exact tlists from the 
     * inputs.  However, if we're intending to sort an input's result, it's 
     * best to request a small tlist so we aren't sorting more data than 
     * necessary. 
     */ 
</span>    <a href="createplan.c.html#LN3750"><span class='Ref_To_Local'>outer_plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3746"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1350"><span class='Ref_to_Member'>jpath</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN1295"><span class='Ref_to_Member'>outerjoinpath</span></a><span class='Delimiter'>, 
</span>                     <span class='Parentheses'>(</span><a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1352"><span class='Ref_to_Member'>outersortkeys</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="createplan.c.html#LN66"><span class='Ref_to_Const'>CP_SMALL_TLIST</span></a> <span class='Operator'>: </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN3751"><span class='Ref_To_Local'>inner_plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3746"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1350"><span class='Ref_to_Member'>jpath</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN1296"><span class='Ref_to_Member'>innerjoinpath</span></a><span class='Delimiter'>, 
</span>                     <span class='Parentheses'>(</span><a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1353"><span class='Ref_to_Member'>innersortkeys</span></a> <span class='Operator'>!= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="createplan.c.html#LN66"><span class='Ref_to_Const'>CP_SMALL_TLIST</span></a> <span class='Operator'>: </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Sort join qual clauses into best execution order */ 
</span>    <span class='Comment_Multi_Line'>/* NB: do NOT reorder the mergeclauses */ 
</span>    <a href="createplan.c.html#LN3753"><span class='Ref_To_Local'>joinclauses</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN161"><span class='Ref_to_Proto'>order_qual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3746"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1350"><span class='Ref_to_Member'>jpath</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN1298"><span class='Ref_to_Member'>joinrestrictinfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Get the join qual clauses (in plain expression form) */ 
</span>    <span class='Comment_Multi_Line'>/* Any pseudoconstant clauses are ignored here */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN720"><span class='Ref_to_Macro'>IS_OUTER_JOIN</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1350"><span class='Ref_to_Member'>jpath</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN1290"><span class='Ref_to_Member'>jointype</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../../include/optimizer/restrictinfo.h.html#LN37"><span class='Ref_to_Proto'>extract_actual_join_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3753"><span class='Ref_To_Local'>joinclauses</span></a><span class='Delimiter'>, 
</span>                                    <span class='Operator'>&</span><a href="createplan.c.html#LN3753"><span class='Ref_To_Local'>joinclauses</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN3754"><span class='Ref_To_Local'>otherclauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* We can treat all clauses alike for an inner join */ 
</span>        <a href="createplan.c.html#LN3753"><span class='Ref_To_Local'>joinclauses</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/restrictinfo.h.html#LN35"><span class='Ref_to_Proto'>extract_actual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3753"><span class='Ref_To_Local'>joinclauses</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN3754"><span class='Ref_To_Local'>otherclauses</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Remove the mergeclauses from the list of join qual clauses, leaving the 
     * list of quals that must be checked as qpquals. 
     */ 
</span>    <a href="createplan.c.html#LN3755"><span class='Ref_To_Local'>mergeclauses</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/restrictinfo.h.html#LN34"><span class='Ref_to_Proto'>get_actual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1351"><span class='Ref_to_Member'>path_mergeclauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN3753"><span class='Ref_To_Local'>joinclauses</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN250"><span class='Ref_to_Proto'>list_difference</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3753"><span class='Ref_To_Local'>joinclauses</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3755"><span class='Ref_To_Local'>mergeclauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Replace any outer-relation variables with nestloop params.  There 
     * should not be any in the mergeclauses. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1350"><span class='Ref_to_Member'>jpath</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN1288"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="createplan.c.html#LN3753"><span class='Ref_To_Local'>joinclauses</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3746"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3753"><span class='Ref_To_Local'>joinclauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN3754"><span class='Ref_To_Local'>otherclauses</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3746"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3754"><span class='Ref_To_Local'>otherclauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Rearrange mergeclauses, if needed, so that the outer variable is always 
     * on the left; mark the mergeclause restrictinfos with correct 
     * outer_is_left status. 
     */ 
</span>    <a href="createplan.c.html#LN3755"><span class='Ref_To_Local'>mergeclauses</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN160"><span class='Ref_to_Proto'>get_switched_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1351"><span class='Ref_to_Member'>path_mergeclauses</span></a><span class='Delimiter'>, 
</span>                             <a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1350"><span class='Ref_to_Member'>jpath</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN1295"><span class='Ref_to_Member'>outerjoinpath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Create explicit sort nodes for the outer and inner paths if necessary. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1352"><span class='Ref_to_Member'>outersortkeys</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3830"></a>        <a href="../../../include/nodes/plannodes.h.html#LN743"><span class='Ref_to_Struct'>Sort</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>sort</span> <span class='Operator'>= </span><a href="createplan.c.html#LN252"><span class='Ref_to_Proto'>make_sort_from_pathkeys</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3750"><span class='Ref_To_Local'>outer_plan</span></a><span class='Delimiter'>, 
</span>                                                   <a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1352"><span class='Ref_to_Member'>outersortkeys</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN164"><span class='Ref_to_Proto'>label_sort_with_costsize</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3746"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3830"><span class='Ref_To_Local'>sort</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN3750"><span class='Ref_To_Local'>outer_plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3830"><span class='Ref_To_Local'>sort</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN3756"><span class='Ref_To_Local'>outerpathkeys</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1352"><span class='Ref_to_Member'>outersortkeys</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
        <a href="createplan.c.html#LN3756"><span class='Ref_To_Local'>outerpathkeys</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1350"><span class='Ref_to_Member'>jpath</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN1295"><span class='Ref_to_Member'>outerjoinpath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN967"><span class='Ref_to_Member'>pathkeys</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1353"><span class='Ref_to_Member'>innersortkeys</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3842"></a>        <a href="../../../include/nodes/plannodes.h.html#LN743"><span class='Ref_to_Struct'>Sort</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>sort</span> <span class='Operator'>= </span><a href="createplan.c.html#LN252"><span class='Ref_to_Proto'>make_sort_from_pathkeys</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3751"><span class='Ref_To_Local'>inner_plan</span></a><span class='Delimiter'>, 
</span>                                                   <a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1353"><span class='Ref_to_Member'>innersortkeys</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN164"><span class='Ref_to_Proto'>label_sort_with_costsize</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3746"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3842"><span class='Ref_To_Local'>sort</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN3751"><span class='Ref_To_Local'>inner_plan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN3842"><span class='Ref_To_Local'>sort</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN3757"><span class='Ref_To_Local'>innerpathkeys</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1353"><span class='Ref_to_Member'>innersortkeys</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
        <a href="createplan.c.html#LN3757"><span class='Ref_To_Local'>innerpathkeys</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1350"><span class='Ref_to_Member'>jpath</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN1296"><span class='Ref_to_Member'>innerjoinpath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN967"><span class='Ref_to_Member'>pathkeys</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If specified, add a materialize node to shield the inner plan from the 
     * need to handle mark/restore. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1355"><span class='Ref_to_Member'>materialize_inner</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3858"></a>        <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>matplan</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN256"><span class='Ref_to_Proto'>make_material</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3751"><span class='Ref_To_Local'>inner_plan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * We assume the materialize will not spill to disk, and therefore 
         * charge just cpu_operator_cost per tuple.  (Keep this estimate in 
         * sync with final_cost_mergejoin.) 
         */ 
</span>        <a href="createplan.c.html#LN163"><span class='Ref_to_Proto'>copy_plan_costsize</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3858"><span class='Ref_To_Local'>matplan</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3751"><span class='Ref_To_Local'>inner_plan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN3858"><span class='Ref_To_Local'>matplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN125"><span class='Ref_to_Member'>total_cost</span></a> <span class='Operator'>+= </span><a href="../path/costsize.c.html#LN107"><span class='Ref_to_Global_Var'>cpu_operator_cost</span></a> <span class='Operator'>* </span><a href="createplan.c.html#LN3858"><span class='Ref_To_Local'>matplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN130"><span class='Ref_to_Member'>plan_rows</span></a><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN3751"><span class='Ref_To_Local'>inner_plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3858"><span class='Ref_To_Local'>matplan</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Compute the opfamily/collation/strategy/nullsfirst arrays needed by the 
     * executor.  The information is in the pathkeys for the two inputs, but 
     * we need to be careful about the possibility of mergeclauses sharing a 
     * pathkey (compare find_mergeclauses_for_pathkeys()). 
     */ 
</span>    <a href="createplan.c.html#LN3758"><span class='Ref_To_Local'>nClauses</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3755"><span class='Ref_To_Local'>mergeclauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN3758"><span class='Ref_To_Local'>nClauses</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1351"><span class='Ref_to_Member'>path_mergeclauses</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN3759"><span class='Ref_To_Local'>mergefamilies</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3758"><span class='Ref_To_Local'>nClauses</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN3760"><span class='Ref_To_Local'>mergecollations</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3758"><span class='Ref_To_Local'>nClauses</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN3761"><span class='Ref_To_Local'>mergestrategies</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3758"><span class='Ref_To_Local'>nClauses</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN3762"><span class='Ref_To_Local'>mergenullsfirst</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3758"><span class='Ref_To_Local'>nClauses</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Keyword'>bool</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN3765"><span class='Ref_To_Local'>lop</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN75"><span class='Ref_to_Func'>list_head</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3756"><span class='Ref_To_Local'>outerpathkeys</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN3766"><span class='Ref_To_Local'>lip</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN75"><span class='Ref_to_Func'>list_head</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3757"><span class='Ref_To_Local'>innerpathkeys</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN3763"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3764"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1351"><span class='Ref_to_Member'>path_mergeclauses</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3889"></a>        <a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rinfo</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN108"><span class='Ref_to_Macro'>lfirst_node</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3764"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN3890"></a>        <a href="../../../include/nodes/relation.h.html#LN766"><span class='Ref_to_Struct'>EquivalenceClass</span></a> <span class='Operator'>*</span><span class='Declare_Local'>oeclass</span><span class='Delimiter'>; 
</span><a name="LN3891"></a>        <a href="../../../include/nodes/relation.h.html#LN766"><span class='Ref_to_Struct'>EquivalenceClass</span></a> <span class='Operator'>*</span><span class='Declare_Local'>ieclass</span><span class='Delimiter'>; 
</span><a name="LN3892"></a>        <a href="../../../include/nodes/relation.h.html#LN845"><span class='Ref_to_Struct'>PathKey</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>opathkey</span><span class='Delimiter'>; 
</span><a name="LN3893"></a>        <a href="../../../include/nodes/relation.h.html#LN845"><span class='Ref_to_Struct'>PathKey</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>ipathkey</span><span class='Delimiter'>; 
</span><a name="LN3894"></a>        <a href="../../../include/nodes/relation.h.html#LN766"><span class='Ref_to_Struct'>EquivalenceClass</span></a> <span class='Operator'>*</span><span class='Declare_Local'>opeclass</span><span class='Delimiter'>; 
</span><a name="LN3895"></a>        <a href="../../../include/nodes/relation.h.html#LN766"><span class='Ref_to_Struct'>EquivalenceClass</span></a> <span class='Operator'>*</span><span class='Declare_Local'>ipeclass</span><span class='Delimiter'>; 
</span><a name="LN3896"></a>        <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l2</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* fetch outer/inner eclass from mergeclause */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3889"><span class='Ref_To_Local'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1801"><span class='Ref_to_Member'>outer_is_left</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="createplan.c.html#LN3890"><span class='Ref_To_Local'>oeclass</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3889"><span class='Ref_To_Local'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1794"><span class='Ref_to_Member'>left_ec</span></a><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN3891"><span class='Ref_To_Local'>ieclass</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3889"><span class='Ref_To_Local'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1795"><span class='Ref_to_Member'>right_ec</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="createplan.c.html#LN3890"><span class='Ref_To_Local'>oeclass</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3889"><span class='Ref_To_Local'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1795"><span class='Ref_to_Member'>right_ec</span></a><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN3891"><span class='Ref_To_Local'>ieclass</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3889"><span class='Ref_To_Local'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1794"><span class='Ref_to_Member'>left_ec</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN3890"><span class='Ref_To_Local'>oeclass</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN3891"><span class='Ref_To_Local'>ieclass</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * For debugging purposes, we check that the eclasses match the paths' 
         * pathkeys.  In typical cases the merge clauses are one-to-one with 
         * the pathkeys, but when dealing with partially redundant query 
         * conditions, we might have clauses that re-reference earlier path 
         * keys.  The case that we need to reject is where a pathkey is 
         * entirely skipped over. 
         * 
         * lop and lip reference the first as-yet-unused pathkey elements; 
         * it's okay to match them, or any element before them.  If they're 
         * NULL then we have found all pathkey elements to be used. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3765"><span class='Ref_To_Local'>lop</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="createplan.c.html#LN3892"><span class='Ref_To_Local'>opathkey</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN845"><span class='Ref_to_Struct'>PathKey</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3765"><span class='Ref_To_Local'>lop</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN3894"><span class='Ref_To_Local'>opeclass</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3892"><span class='Ref_To_Local'>opathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN849"><span class='Ref_to_Member'>pk_eclass</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3890"><span class='Ref_To_Local'>oeclass</span></a> <span class='Operator'>== </span><a href="createplan.c.html#LN3894"><span class='Ref_To_Local'>opeclass</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* fast path for typical case */ 
</span>                <a href="createplan.c.html#LN3765"><span class='Ref_To_Local'>lop</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN104"><span class='Ref_to_Macro'>lnext</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3765"><span class='Ref_To_Local'>lop</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* redundant clauses ... must match something before lop */ 
</span>                <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3896"><span class='Ref_To_Local'>l2</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3756"><span class='Ref_To_Local'>outerpathkeys</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3896"><span class='Ref_To_Local'>l2</span></a> <span class='Operator'>== </span><a href="createplan.c.html#LN3765"><span class='Ref_To_Local'>lop</span></a><span class='Parentheses'>) 
</span>                        <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <a href="createplan.c.html#LN3892"><span class='Ref_To_Local'>opathkey</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN845"><span class='Ref_to_Struct'>PathKey</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3896"><span class='Ref_To_Local'>l2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <a href="createplan.c.html#LN3894"><span class='Ref_To_Local'>opeclass</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3892"><span class='Ref_To_Local'>opathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN849"><span class='Ref_to_Member'>pk_eclass</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3890"><span class='Ref_To_Local'>oeclass</span></a> <span class='Operator'>== </span><a href="createplan.c.html#LN3894"><span class='Ref_To_Local'>opeclass</span></a><span class='Parentheses'>) 
</span>                        <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3890"><span class='Ref_To_Local'>oeclass</span></a> <span class='Operator'>!= </span><a href="createplan.c.html#LN3894"><span class='Ref_To_Local'>opeclass</span></a><span class='Parentheses'>) 
</span>                    <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"outer pathkeys do not match mergeclauses"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if lop &raquo; </span> 
        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* redundant clauses ... must match some already-used pathkey */ 
</span>            <a href="createplan.c.html#LN3892"><span class='Ref_To_Local'>opathkey</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN3894"><span class='Ref_To_Local'>opeclass</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3896"><span class='Ref_To_Local'>l2</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3756"><span class='Ref_To_Local'>outerpathkeys</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="createplan.c.html#LN3892"><span class='Ref_To_Local'>opathkey</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN845"><span class='Ref_to_Struct'>PathKey</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3896"><span class='Ref_To_Local'>l2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="createplan.c.html#LN3894"><span class='Ref_To_Local'>opeclass</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3892"><span class='Ref_To_Local'>opathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN849"><span class='Ref_to_Member'>pk_eclass</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3890"><span class='Ref_To_Local'>oeclass</span></a> <span class='Operator'>== </span><a href="createplan.c.html#LN3894"><span class='Ref_To_Local'>opeclass</span></a><span class='Parentheses'>) 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3896"><span class='Ref_To_Local'>l2</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"outer pathkeys do not match mergeclauses"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3766"><span class='Ref_To_Local'>lip</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="createplan.c.html#LN3893"><span class='Ref_To_Local'>ipathkey</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN845"><span class='Ref_to_Struct'>PathKey</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3766"><span class='Ref_To_Local'>lip</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN3895"><span class='Ref_To_Local'>ipeclass</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3893"><span class='Ref_To_Local'>ipathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN849"><span class='Ref_to_Member'>pk_eclass</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3891"><span class='Ref_To_Local'>ieclass</span></a> <span class='Operator'>== </span><a href="createplan.c.html#LN3895"><span class='Ref_To_Local'>ipeclass</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* fast path for typical case */ 
</span>                <a href="createplan.c.html#LN3766"><span class='Ref_To_Local'>lip</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN104"><span class='Ref_to_Macro'>lnext</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3766"><span class='Ref_To_Local'>lip</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* redundant clauses ... must match something before lip */ 
</span>                <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3896"><span class='Ref_To_Local'>l2</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3757"><span class='Ref_To_Local'>innerpathkeys</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3896"><span class='Ref_To_Local'>l2</span></a> <span class='Operator'>== </span><a href="createplan.c.html#LN3766"><span class='Ref_To_Local'>lip</span></a><span class='Parentheses'>) 
</span>                        <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <a href="createplan.c.html#LN3893"><span class='Ref_To_Local'>ipathkey</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN845"><span class='Ref_to_Struct'>PathKey</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3896"><span class='Ref_To_Local'>l2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <a href="createplan.c.html#LN3895"><span class='Ref_To_Local'>ipeclass</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3893"><span class='Ref_To_Local'>ipathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN849"><span class='Ref_to_Member'>pk_eclass</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3891"><span class='Ref_To_Local'>ieclass</span></a> <span class='Operator'>== </span><a href="createplan.c.html#LN3895"><span class='Ref_To_Local'>ipeclass</span></a><span class='Parentheses'>) 
</span>                        <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3891"><span class='Ref_To_Local'>ieclass</span></a> <span class='Operator'>!= </span><a href="createplan.c.html#LN3895"><span class='Ref_To_Local'>ipeclass</span></a><span class='Parentheses'>) 
</span>                    <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"inner pathkeys do not match mergeclauses"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if lip &raquo; </span> 
        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* redundant clauses ... must match some already-used pathkey */ 
</span>            <a href="createplan.c.html#LN3893"><span class='Ref_To_Local'>ipathkey</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN3895"><span class='Ref_To_Local'>ipeclass</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3896"><span class='Ref_To_Local'>l2</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN3757"><span class='Ref_To_Local'>innerpathkeys</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="createplan.c.html#LN3893"><span class='Ref_To_Local'>ipathkey</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN845"><span class='Ref_to_Struct'>PathKey</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3896"><span class='Ref_To_Local'>l2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="createplan.c.html#LN3895"><span class='Ref_To_Local'>ipeclass</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN3893"><span class='Ref_To_Local'>ipathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN849"><span class='Ref_to_Member'>pk_eclass</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3891"><span class='Ref_To_Local'>ieclass</span></a> <span class='Operator'>== </span><a href="createplan.c.html#LN3895"><span class='Ref_To_Local'>ipeclass</span></a><span class='Parentheses'>) 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3896"><span class='Ref_To_Local'>l2</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"inner pathkeys do not match mergeclauses"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* pathkeys should match each other too (more debugging) */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN3892"><span class='Ref_To_Local'>opathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN850"><span class='Ref_to_Member'>pk_opfamily</span></a> <span class='Operator'>!= </span><a href="createplan.c.html#LN3893"><span class='Ref_To_Local'>ipathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN850"><span class='Ref_to_Member'>pk_opfamily</span></a> <span class='Operator'>|| 
</span>            <a href="createplan.c.html#LN3892"><span class='Ref_To_Local'>opathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN849"><span class='Ref_to_Member'>pk_eclass</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN771"><span class='Ref_to_Member'>ec_collation</span></a> <span class='Operator'>!= </span><a href="createplan.c.html#LN3893"><span class='Ref_To_Local'>ipathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN849"><span class='Ref_to_Member'>pk_eclass</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN771"><span class='Ref_to_Member'>ec_collation</span></a> <span class='Operator'>|| 
</span>            <a href="createplan.c.html#LN3892"><span class='Ref_To_Local'>opathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN851"><span class='Ref_to_Member'>pk_strategy</span></a> <span class='Operator'>!= </span><a href="createplan.c.html#LN3893"><span class='Ref_To_Local'>ipathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN851"><span class='Ref_to_Member'>pk_strategy</span></a> <span class='Operator'>|| 
</span>            <a href="createplan.c.html#LN3892"><span class='Ref_To_Local'>opathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN852"><span class='Ref_to_Member'>pk_nulls_first</span></a> <span class='Operator'>!= </span><a href="createplan.c.html#LN3893"><span class='Ref_To_Local'>ipathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN852"><span class='Ref_to_Member'>pk_nulls_first</span></a><span class='Parentheses'>) 
</span>            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"left and right pathkeys do not match in mergejoin"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* OK, save info for executor */ 
</span>        <a href="createplan.c.html#LN3759"><span class='Ref_To_Local'>mergefamilies</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN3763"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN3892"><span class='Ref_To_Local'>opathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN850"><span class='Ref_to_Member'>pk_opfamily</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN3760"><span class='Ref_To_Local'>mergecollations</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN3763"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN3892"><span class='Ref_To_Local'>opathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN849"><span class='Ref_to_Member'>pk_eclass</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN771"><span class='Ref_to_Member'>ec_collation</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN3761"><span class='Ref_To_Local'>mergestrategies</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN3763"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN3892"><span class='Ref_To_Local'>opathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN851"><span class='Ref_to_Member'>pk_strategy</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN3762"><span class='Ref_To_Local'>mergenullsfirst</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN3763"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN3892"><span class='Ref_To_Local'>opathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN852"><span class='Ref_to_Member'>pk_nulls_first</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN3763"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Note: it is not an error if we have additional pathkey elements (i.e., 
     * lop or lip isn't NULL here).  The input paths might be better-sorted 
     * than we need for the current mergejoin. 
     */ 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Now we can build the mergejoin node. 
     */ 
</span>    <a href="createplan.c.html#LN3749"><span class='Ref_To_Local'>join_plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN227"><span class='Ref_to_Proto'>make_mergejoin</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN3752"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, 
</span>                               <a href="createplan.c.html#LN3753"><span class='Ref_To_Local'>joinclauses</span></a><span class='Delimiter'>, 
</span>                               <a href="createplan.c.html#LN3754"><span class='Ref_To_Local'>otherclauses</span></a><span class='Delimiter'>, 
</span>                               <a href="createplan.c.html#LN3755"><span class='Ref_To_Local'>mergeclauses</span></a><span class='Delimiter'>, 
</span>                               <a href="createplan.c.html#LN3759"><span class='Ref_To_Local'>mergefamilies</span></a><span class='Delimiter'>, 
</span>                               <a href="createplan.c.html#LN3760"><span class='Ref_To_Local'>mergecollations</span></a><span class='Delimiter'>, 
</span>                               <a href="createplan.c.html#LN3761"><span class='Ref_To_Local'>mergestrategies</span></a><span class='Delimiter'>, 
</span>                               <a href="createplan.c.html#LN3762"><span class='Ref_To_Local'>mergenullsfirst</span></a><span class='Delimiter'>, 
</span>                               <a href="createplan.c.html#LN3750"><span class='Ref_To_Local'>outer_plan</span></a><span class='Delimiter'>, 
</span>                               <a href="createplan.c.html#LN3751"><span class='Ref_To_Local'>inner_plan</span></a><span class='Delimiter'>, 
</span>                               <a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1350"><span class='Ref_to_Member'>jpath</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN1290"><span class='Ref_to_Member'>jointype</span></a><span class='Delimiter'>, 
</span>                               <a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1350"><span class='Ref_to_Member'>jpath</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN1292"><span class='Ref_to_Member'>inner_unique</span></a><span class='Delimiter'>, 
</span>                               <a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1354"><span class='Ref_to_Member'>skip_mark_restore</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Costs of sort and material steps are included in path cost already */ 
</span>    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN3749"><span class='Ref_To_Local'>join_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN710"><span class='Ref_to_Member'>join</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN667"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN3747"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1350"><span class='Ref_to_Member'>jpath</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN1288"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN3749"><span class='Ref_To_Local'>join_plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_mergejoin_plan &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN724"><span class='Ref_to_Struct'>HashJoin</span></a> <span class='Operator'>* 
</span><a name="LN4051"></a><span class='Declare_Function'>create_hashjoin_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN4052"></a>                     <a href="../../../include/nodes/relation.h.html#LN1367"><span class='Ref_to_Struct'>HashPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>best_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4054"></a>    <a href="../../../include/nodes/plannodes.h.html#LN724"><span class='Ref_to_Struct'>HashJoin</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>join_plan</span><span class='Delimiter'>; 
</span><a name="LN4055"></a>    <a href="../../../include/nodes/plannodes.h.html#LN863"><span class='Ref_to_Struct'>Hash</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>hash_plan</span><span class='Delimiter'>; 
</span><a name="LN4056"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>outer_plan</span><span class='Delimiter'>; 
</span><a name="LN4057"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>inner_plan</span><span class='Delimiter'>; 
</span><a name="LN4058"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>tlist</span> <span class='Operator'>= </span><a href="createplan.c.html#LN74"><span class='Ref_to_Proto'>build_path_tlist</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4051"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN4052"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1369"><span class='Ref_to_Member'>jpath</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN1288"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN4059"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>joinclauses</span><span class='Delimiter'>; 
</span><a name="LN4060"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>otherclauses</span><span class='Delimiter'>; 
</span><a name="LN4061"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>hashclauses</span><span class='Delimiter'>; 
</span><a name="LN4062"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>skewTable</span> <span class='Operator'>= </span><a href="../../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span><a name="LN4063"></a>    <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a>  <span class='Declare_Local'>skewColumn</span> <span class='Operator'>= </span><a href="../../../include/access/attnum.h.html#LN22"><span class='Ref_to_Const'>InvalidAttrNumber</span></a><span class='Delimiter'>; 
</span><a name="LN4064"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>skewInherit</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * HashJoin can project, so we don't have to demand exact tlists from the 
     * inputs.  However, it's best to request a small tlist from the inner 
     * side, so that we aren't storing more data than necessary.  Likewise, if 
     * we anticipate batching, request a small tlist from the outer side so 
     * that we don't put extra data in the outer batch files. 
     */ 
</span>    <a href="createplan.c.html#LN4056"><span class='Ref_To_Local'>outer_plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4051"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4052"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1369"><span class='Ref_to_Member'>jpath</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN1295"><span class='Ref_to_Member'>outerjoinpath</span></a><span class='Delimiter'>, 
</span>                          <span class='Parentheses'>(</span><a href="createplan.c.html#LN4052"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1371"><span class='Ref_to_Member'>num_batches</span></a> <span class='Operator'>&GT; </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="createplan.c.html#LN66"><span class='Ref_to_Const'>CP_SMALL_TLIST</span></a> <span class='Operator'>: </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN4057"><span class='Ref_To_Local'>inner_plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN70"><span class='Ref_to_Proto'>create_plan_recurse</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4051"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4052"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1369"><span class='Ref_to_Member'>jpath</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN1296"><span class='Ref_to_Member'>innerjoinpath</span></a><span class='Delimiter'>, 
</span>                                     <a href="createplan.c.html#LN66"><span class='Ref_to_Const'>CP_SMALL_TLIST</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Sort join qual clauses into best execution order */ 
</span>    <a href="createplan.c.html#LN4059"><span class='Ref_To_Local'>joinclauses</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN161"><span class='Ref_to_Proto'>order_qual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4051"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4052"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1369"><span class='Ref_to_Member'>jpath</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN1298"><span class='Ref_to_Member'>joinrestrictinfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* There's no point in sorting the hash clauses ... */ 
</span> 
    <span class='Comment_Multi_Line'>/* Get the join qual clauses (in plain expression form) */ 
</span>    <span class='Comment_Multi_Line'>/* Any pseudoconstant clauses are ignored here */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN720"><span class='Ref_to_Macro'>IS_OUTER_JOIN</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4052"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1369"><span class='Ref_to_Member'>jpath</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN1290"><span class='Ref_to_Member'>jointype</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../../include/optimizer/restrictinfo.h.html#LN37"><span class='Ref_to_Proto'>extract_actual_join_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4059"><span class='Ref_To_Local'>joinclauses</span></a><span class='Delimiter'>, 
</span>                                    <span class='Operator'>&</span><a href="createplan.c.html#LN4059"><span class='Ref_To_Local'>joinclauses</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN4060"><span class='Ref_To_Local'>otherclauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* We can treat all clauses alike for an inner join */ 
</span>        <a href="createplan.c.html#LN4059"><span class='Ref_To_Local'>joinclauses</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/restrictinfo.h.html#LN35"><span class='Ref_to_Proto'>extract_actual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4059"><span class='Ref_To_Local'>joinclauses</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN4060"><span class='Ref_To_Local'>otherclauses</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Remove the hashclauses from the list of join qual clauses, leaving the 
     * list of quals that must be checked as qpquals. 
     */ 
</span>    <a href="createplan.c.html#LN4061"><span class='Ref_To_Local'>hashclauses</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/restrictinfo.h.html#LN34"><span class='Ref_to_Proto'>get_actual_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4052"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1370"><span class='Ref_to_Member'>path_hashclauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4059"><span class='Ref_To_Local'>joinclauses</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN250"><span class='Ref_to_Proto'>list_difference</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4059"><span class='Ref_To_Local'>joinclauses</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4061"><span class='Ref_To_Local'>hashclauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Replace any outer-relation variables with nestloop params.  There 
     * should not be any in the hashclauses. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN4052"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1369"><span class='Ref_to_Member'>jpath</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN1288"><span class='Ref_to_Member'>path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="createplan.c.html#LN4059"><span class='Ref_To_Local'>joinclauses</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4051"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4059"><span class='Ref_To_Local'>joinclauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN4060"><span class='Ref_To_Local'>otherclauses</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4051"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4060"><span class='Ref_To_Local'>otherclauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Rearrange hashclauses, if needed, so that the outer variable is always 
     * on the left. 
     */ 
</span>    <a href="createplan.c.html#LN4061"><span class='Ref_To_Local'>hashclauses</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN160"><span class='Ref_to_Proto'>get_switched_clauses</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4052"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1370"><span class='Ref_to_Member'>path_hashclauses</span></a><span class='Delimiter'>, 
</span>                             <a href="createplan.c.html#LN4052"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1369"><span class='Ref_to_Member'>jpath</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN1295"><span class='Ref_to_Member'>outerjoinpath</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If there is a single join clause and we can identify the outer variable 
     * as a simple column reference, supply its identity for possible use in 
     * skew optimization.  (Note: in principle we could do skew optimization 
     * with multiple join clauses, but we'd have to be able to determine the 
     * most common combinations of outer values, which we don't currently have 
     * enough stats for.) 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4061"><span class='Ref_To_Local'>hashclauses</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span><a name="LN4133"></a>        <a href="../../../include/nodes/primnodes.h.html#LN491"><span class='Ref_to_Struct'>OpExpr</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>clause</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN491"><span class='Ref_to_Struct'>OpExpr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4061"><span class='Ref_To_Local'>hashclauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN4134"></a>        <a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>node</span><span class='Delimiter'>; 
</span> 
        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/optimizer/clauses.h.html#LN19"><span class='Ref_to_Macro'>is_opclause</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4133"><span class='Ref_To_Local'>clause</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN4134"><span class='Ref_To_Local'>node</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4133"><span class='Ref_To_Local'>clause</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN500"><span class='Ref_to_Member'>args</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4134"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/primnodes.h.html#LN786"><span class='Ref_to_Struct'>RelabelType</span></a><span class='Parentheses'>))</span> 
            <a href="createplan.c.html#LN4134"><span class='Ref_To_Local'>node</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) ((</span><a href="../../../include/nodes/primnodes.h.html#LN786"><span class='Ref_to_Struct'>RelabelType</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4134"><span class='Ref_To_Local'>node</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>arg<span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4134"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN4142"></a>            <a href="../../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>var</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4134"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
</span><a name="LN4143"></a>            <a href="../../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span><span class='Delimiter'>; 
</span> 
            <a href="createplan.c.html#LN4143"><span class='Ref_To_Local'>rte</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4051"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN187"><span class='Ref_to_Member'>simple_rte_array</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN4142"><span class='Ref_To_Local'>var</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN165"><span class='Ref_to_Member'>varno</span></a><span class='Delimiter'>]; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN4143"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/parsenodes.h.html#LN922"><span class='Ref_to_EnumConst'>RTE_RELATION</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="createplan.c.html#LN4062"><span class='Ref_To_Local'>skewTable</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4143"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN947"><span class='Ref_to_Member'>relid</span></a><span class='Delimiter'>; 
</span>                <a href="createplan.c.html#LN4063"><span class='Ref_To_Local'>skewColumn</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4142"><span class='Ref_To_Local'>var</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN167"><span class='Ref_to_Member'>varattno</span></a><span class='Delimiter'>; 
</span>                <a href="createplan.c.html#LN4064"><span class='Ref_To_Local'>skewInherit</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4143"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1025"><span class='Ref_to_Member'>inh</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if list_length(hashclaus... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* 
     * Build the hash node and hash join node. 
     */ 
</span>    <a href="createplan.c.html#LN4055"><span class='Ref_To_Local'>hash_plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN223"><span class='Ref_to_Proto'>make_hash</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4057"><span class='Ref_To_Local'>inner_plan</span></a><span class='Delimiter'>, 
</span>                          <a href="createplan.c.html#LN4062"><span class='Ref_To_Local'>skewTable</span></a><span class='Delimiter'>, 
</span>                          <a href="createplan.c.html#LN4063"><span class='Ref_To_Local'>skewColumn</span></a><span class='Delimiter'>, 
</span>                          <a href="createplan.c.html#LN4064"><span class='Ref_To_Local'>skewInherit</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Set Hash node's startup & total costs equal to total cost of input 
     * plan; this only affects EXPLAIN display not decisions. 
     */ 
</span>    <a href="createplan.c.html#LN163"><span class='Ref_to_Proto'>copy_plan_costsize</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN4055"><span class='Ref_To_Local'>hash_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN865"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4057"><span class='Ref_To_Local'>inner_plan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4055"><span class='Ref_To_Local'>hash_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN865"><span class='Ref_to_Member'>plan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN124"><span class='Ref_to_Member'>startup_cost</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4055"><span class='Ref_To_Local'>hash_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN865"><span class='Ref_to_Member'>plan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN125"><span class='Ref_to_Member'>total_cost</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN4054"><span class='Ref_To_Local'>join_plan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN218"><span class='Ref_to_Proto'>make_hashjoin</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4058"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, 
</span>                              <a href="createplan.c.html#LN4059"><span class='Ref_To_Local'>joinclauses</span></a><span class='Delimiter'>, 
</span>                              <a href="createplan.c.html#LN4060"><span class='Ref_To_Local'>otherclauses</span></a><span class='Delimiter'>, 
</span>                              <a href="createplan.c.html#LN4061"><span class='Ref_To_Local'>hashclauses</span></a><span class='Delimiter'>, 
</span>                              <a href="createplan.c.html#LN4056"><span class='Ref_To_Local'>outer_plan</span></a><span class='Delimiter'>, 
</span>                              <span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4055"><span class='Ref_To_Local'>hash_plan</span></a><span class='Delimiter'>, 
</span>                              <a href="createplan.c.html#LN4052"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1369"><span class='Ref_to_Member'>jpath</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN1290"><span class='Ref_to_Member'>jointype</span></a><span class='Delimiter'>, 
</span>                              <a href="createplan.c.html#LN4052"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1369"><span class='Ref_to_Member'>jpath</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN1292"><span class='Ref_to_Member'>inner_unique</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN162"><span class='Ref_to_Proto'>copy_generic_path_info</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN4054"><span class='Ref_To_Local'>join_plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN726"><span class='Ref_to_Member'>join</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN667"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="createplan.c.html#LN4052"><span class='Ref_to_Parameter'>best_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1369"><span class='Ref_to_Member'>jpath</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN1288"><span class='Ref_to_Member'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN4054"><span class='Ref_To_Local'>join_plan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end create_hashjoin_plan &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/***************************************************************************** 
 * 
 *  SUPPORTING ROUTINES 
 * 
 *****************************************************************************/ 
</span> 
<span class='Comment_Multi_Line'>/* 
 * replace_nestloop_params 
 *    Replace outer-relation Vars and PlaceHolderVars in the given expression 
 *    with nestloop Params 
 * 
 * All Vars and PlaceHolderVars belonging to the relation(s) identified by 
 * root-&GT;curOuterRels are replaced by Params, and entries are added to 
 * root-&GT;curOuterParams if not already present. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>* 
</span><a name="LN4201"></a><span class='Declare_Function'>replace_nestloop_params</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>expr</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* No setup needed for tree walk, so away we go */ 
</span>    <span class='Control'>return</span> <a href="createplan.c.html#LN154"><span class='Ref_to_Proto'>replace_nestloop_params_mutator</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4201"><span class='Ref_to_Parameter'>expr</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4201"><span class='Ref_to_Parameter'>root</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static </span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>* 
</span><a name="LN4208"></a><span class='Declare_Function'>replace_nestloop_params_mutator</span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN4208"><span class='Ref_to_Parameter'>node</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4208"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN4214"></a>        <a href="../../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>var</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4208"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span><a name="LN4215"></a>        <a href="../../../include/nodes/primnodes.h.html#LN240"><span class='Ref_to_Struct'>Param</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>param</span><span class='Delimiter'>; 
</span><a name="LN4216"></a>        <a href="../../../include/nodes/plannodes.h.html#LN690"><span class='Ref_to_Struct'>NestLoopParam</span></a> <span class='Operator'>*</span><span class='Declare_Local'>nlp</span><span class='Delimiter'>; 
</span><a name="LN4217"></a>        <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Upper-level Vars should be long gone at this point */ 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN4214"><span class='Ref_To_Local'>var</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN172"><span class='Ref_to_Member'>varlevelsup</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* If not to be replaced, we can just return the Var unmodified */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/nodes/bitmapset.h.html#LN75"><span class='Ref_to_Proto'>bms_is_member</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4214"><span class='Ref_To_Local'>var</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN165"><span class='Ref_to_Member'>varno</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4208"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN311"><span class='Ref_to_Member'>curOuterRels</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="createplan.c.html#LN4208"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* Create a Param representing the Var */ 
</span>        <a href="createplan.c.html#LN4215"><span class='Ref_To_Local'>param</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/subselect.h.html#LN37"><span class='Ref_to_Proto'>assign_nestloop_param_var</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4208"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4214"><span class='Ref_To_Local'>var</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* Is this param already listed in root-&GT;curOuterParams? */ 
</span>        <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4217"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4208"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN312"><span class='Ref_to_Member'>curOuterParams</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="createplan.c.html#LN4216"><span class='Ref_To_Local'>nlp</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN690"><span class='Ref_to_Struct'>NestLoopParam</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4217"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN4216"><span class='Ref_To_Local'>nlp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN693"><span class='Ref_to_Member'>paramno</span></a> <span class='Operator'>== </span><a href="createplan.c.html#LN4215"><span class='Ref_To_Local'>param</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN244"><span class='Ref_to_Member'>paramid</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN626"><span class='Ref_to_Proto'>equal</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4214"><span class='Ref_To_Local'>var</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4216"><span class='Ref_To_Local'>nlp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN694"><span class='Ref_to_Member'>paramval</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <span class='Comment_Multi_Line'>/* Present, so we can just return the Param */ 
</span>                <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4215"><span class='Ref_To_Local'>param</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>        <span class='Comment_Multi_Line'>/* No, so add it */ 
</span>        <a href="createplan.c.html#LN4216"><span class='Ref_To_Local'>nlp</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN690"><span class='Ref_to_Struct'>NestLoopParam</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN4216"><span class='Ref_To_Local'>nlp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN693"><span class='Ref_to_Member'>paramno</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4215"><span class='Ref_To_Local'>param</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN244"><span class='Ref_to_Member'>paramid</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN4216"><span class='Ref_To_Local'>nlp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN694"><span class='Ref_to_Member'>paramval</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4214"><span class='Ref_To_Local'>var</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN4208"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN312"><span class='Ref_to_Member'>curOuterParams</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4208"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN312"><span class='Ref_to_Member'>curOuterParams</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4216"><span class='Ref_To_Local'>nlp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* And return the replacement Param */ 
</span>        <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4215"><span class='Ref_To_Local'>param</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if IsA(node,Var) &raquo; </span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4208"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1846"><span class='Ref_to_Struct'>PlaceHolderVar</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN4247"></a>        <a href="../../../include/nodes/relation.h.html#LN1846"><span class='Ref_to_Struct'>PlaceHolderVar</span></a> <span class='Operator'>*</span><span class='Declare_Local'>phv</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1846"><span class='Ref_to_Struct'>PlaceHolderVar</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4208"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span><a name="LN4248"></a>        <a href="../../../include/nodes/primnodes.h.html#LN240"><span class='Ref_to_Struct'>Param</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>param</span><span class='Delimiter'>; 
</span><a name="LN4249"></a>        <a href="../../../include/nodes/plannodes.h.html#LN690"><span class='Ref_to_Struct'>NestLoopParam</span></a> <span class='Operator'>*</span><span class='Declare_Local'>nlp</span><span class='Delimiter'>; 
</span><a name="LN4250"></a>        <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Upper-level PlaceHolderVars should be long gone at this point */ 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN4247"><span class='Ref_To_Local'>phv</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1852"><span class='Ref_to_Member'>phlevelsup</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Check whether we need to replace the PHV.  We use bms_overlap as a 
         * cheap/quick test to see if the PHV might be evaluated in the outer 
         * rels, and then grab its PlaceHolderInfo to tell for sure. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/nodes/bitmapset.h.html#LN76"><span class='Ref_to_Proto'>bms_overlap</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4247"><span class='Ref_To_Local'>phv</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1850"><span class='Ref_to_Member'>phrels</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4208"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN311"><span class='Ref_to_Member'>curOuterRels</span></a><span class='Parentheses'>)</span> <span class='Operator'>|| 
</span>          <span class='Operator'>!</span><a href="../../../include/nodes/bitmapset.h.html#LN73"><span class='Ref_to_Proto'>bms_is_subset</span></a><span class='Parentheses'>(</span><a href="../../../include/optimizer/placeholder.h.html#LN21"><span class='Ref_to_Proto'>find_placeholder_info</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4208"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4247"><span class='Ref_To_Local'>phv</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2063"><span class='Ref_to_Member'>ph_eval_at</span></a><span class='Delimiter'>, 
</span>                         <a href="createplan.c.html#LN4208"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN311"><span class='Ref_to_Member'>curOuterRels</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * We can't replace the whole PHV, but we might still need to 
             * replace Vars or PHVs within its expression, in case it ends up 
             * actually getting evaluated here.  (It might get evaluated in 
             * this plan node, or some child node; in the latter case we don't 
             * really need to process the expression here, but we haven't got 
             * enough info to tell if that's the case.)  Flat-copy the PHV 
             * node and then recurse on its expression. 
             * 
             * Note that after doing this, we might have different 
             * representations of the contents of the same PHV in different 
             * parts of the plan tree.  This is OK because equal() will just 
             * match on phid/phlevelsup, so setrefs.c will still recognize an 
             * upper-level reference to a lower-level copy of the same PHV. 
             */ 
</span><a name="LN4279"></a>            <a href="../../../include/nodes/relation.h.html#LN1846"><span class='Ref_to_Struct'>PlaceHolderVar</span></a> <span class='Operator'>*</span><span class='Declare_Local'>newphv</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1846"><span class='Ref_to_Struct'>PlaceHolderVar</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            memcpy<span class='Parentheses'>(</span><a href="createplan.c.html#LN4279"><span class='Ref_To_Local'>newphv</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4247"><span class='Ref_To_Local'>phv</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1846"><span class='Ref_to_Struct'>PlaceHolderVar</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN4279"><span class='Ref_To_Local'>newphv</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1849"><span class='Ref_to_Member'>phexpr</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN131"><span class='Ref_to_Struct'>Expr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>                <a href="createplan.c.html#LN154"><span class='Ref_to_Proto'>replace_nestloop_params_mutator</span></a><span class='Parentheses'>((</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4247"><span class='Ref_To_Local'>phv</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1849"><span class='Ref_to_Member'>phexpr</span></a><span class='Delimiter'>, 
</span>                                                <a href="createplan.c.html#LN4208"><span class='Ref_to_Parameter'>root</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4279"><span class='Ref_To_Local'>newphv</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if !bms_overlap(phv-&GT;phr... &raquo; </span> 
        <span class='Comment_Multi_Line'>/* Create a Param representing the PlaceHolderVar */ 
</span>        <a href="createplan.c.html#LN4248"><span class='Ref_To_Local'>param</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/subselect.h.html#LN38"><span class='Ref_to_Proto'>assign_nestloop_param_placeholdervar</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4208"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4247"><span class='Ref_To_Local'>phv</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* Is this param already listed in root-&GT;curOuterParams? */ 
</span>        <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4250"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4208"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN312"><span class='Ref_to_Member'>curOuterParams</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="createplan.c.html#LN4249"><span class='Ref_To_Local'>nlp</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN690"><span class='Ref_to_Struct'>NestLoopParam</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4250"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN4249"><span class='Ref_To_Local'>nlp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN693"><span class='Ref_to_Member'>paramno</span></a> <span class='Operator'>== </span><a href="createplan.c.html#LN4248"><span class='Ref_To_Local'>param</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN244"><span class='Ref_to_Member'>paramid</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN626"><span class='Ref_to_Proto'>equal</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4247"><span class='Ref_To_Local'>phv</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4249"><span class='Ref_To_Local'>nlp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN694"><span class='Ref_to_Member'>paramval</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <span class='Comment_Multi_Line'>/* Present, so we can just return the Param */ 
</span>                <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4248"><span class='Ref_To_Local'>param</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>        <span class='Comment_Multi_Line'>/* No, so add it */ 
</span>        <a href="createplan.c.html#LN4249"><span class='Ref_To_Local'>nlp</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN690"><span class='Ref_to_Struct'>NestLoopParam</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN4249"><span class='Ref_To_Local'>nlp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN693"><span class='Ref_to_Member'>paramno</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4248"><span class='Ref_To_Local'>param</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN244"><span class='Ref_to_Member'>paramid</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN4249"><span class='Ref_To_Local'>nlp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN694"><span class='Ref_to_Member'>paramval</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4247"><span class='Ref_To_Local'>phv</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN4208"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN312"><span class='Ref_to_Member'>curOuterParams</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4208"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN312"><span class='Ref_to_Member'>curOuterParams</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4249"><span class='Ref_To_Local'>nlp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* And return the replacement Param */ 
</span>        <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4248"><span class='Ref_To_Local'>param</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if IsA(node,PlaceHolderV... &raquo; </span> 
    <span class='Control'>return</span> <a href="../../../include/nodes/nodeFuncs.h.html#LN54"><span class='Ref_to_Proto'>expression_tree_mutator</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4208"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, 
</span>                                   <a href="createplan.c.html#LN154"><span class='Ref_to_Proto'>replace_nestloop_params_mutator</span></a><span class='Delimiter'>, 
</span>                                   <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4208"><span class='Ref_to_Parameter'>root</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end replace_nestloop_params_mutator &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * process_subquery_nestloop_params 
 *    Handle params of a parameterized subquery that need to be fed 
 *    from an outer nestloop. 
 * 
 * Currently, that would be *all* params that a subquery in FROM has demanded 
 * from the current query level, since they must be LATERAL references. 
 * 
 * The subplan's references to the outer variables are already represented 
 * as PARAM_EXEC Params, so we need not modify the subplan here.  What we 
 * do need to do is add entries to root-&GT;curOuterParams to signal the parent 
 * nestloop plan node that it must provide these values. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN4327"></a><span class='Declare_Function'>process_subquery_nestloop_params</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>subplan_params</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4329"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>ppl</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4329"><span class='Ref_To_Local'>ppl</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4327"><span class='Ref_to_Parameter'>subplan_params</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN4333"></a>        <a href="../../../include/nodes/relation.h.html#LN2134"><span class='Ref_to_Struct'>PlannerParamItem</span></a> <span class='Operator'>*</span><span class='Declare_Local'>pitem</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN2134"><span class='Ref_to_Struct'>PlannerParamItem</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4329"><span class='Ref_To_Local'>ppl</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4333"><span class='Ref_To_Local'>pitem</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2138"><span class='Ref_to_Member'>item</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN4337"></a>            <a href="../../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>var</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4333"><span class='Ref_To_Local'>pitem</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2138"><span class='Ref_to_Member'>item</span></a><span class='Delimiter'>; 
</span><a name="LN4338"></a>            <a href="../../../include/nodes/plannodes.h.html#LN690"><span class='Ref_to_Struct'>NestLoopParam</span></a> <span class='Operator'>*</span><span class='Declare_Local'>nlp</span><span class='Delimiter'>; 
</span><a name="LN4339"></a>            <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* If not from a nestloop outer rel, complain */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/nodes/bitmapset.h.html#LN75"><span class='Ref_to_Proto'>bms_is_member</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4337"><span class='Ref_To_Local'>var</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN165"><span class='Ref_to_Member'>varno</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4327"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN311"><span class='Ref_to_Member'>curOuterRels</span></a><span class='Parentheses'>))</span> 
                <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"non-LATERAL parameter required by subquery"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* Is this param already listed in root-&GT;curOuterParams? */ 
</span>            <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4339"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4327"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN312"><span class='Ref_to_Member'>curOuterParams</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="createplan.c.html#LN4338"><span class='Ref_To_Local'>nlp</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN690"><span class='Ref_to_Struct'>NestLoopParam</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4339"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN4338"><span class='Ref_To_Local'>nlp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN693"><span class='Ref_to_Member'>paramno</span></a> <span class='Operator'>== </span><a href="createplan.c.html#LN4333"><span class='Ref_To_Local'>pitem</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2139"><span class='Ref_to_Member'>paramId</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN626"><span class='Ref_to_Proto'>equal</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4337"><span class='Ref_To_Local'>var</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4338"><span class='Ref_To_Local'>nlp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN694"><span class='Ref_to_Member'>paramval</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* Present, so nothing to do */ 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN4339"><span class='Ref_To_Local'>lc</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* No, so add it */ 
</span>                <a href="createplan.c.html#LN4338"><span class='Ref_To_Local'>nlp</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN690"><span class='Ref_to_Struct'>NestLoopParam</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="createplan.c.html#LN4338"><span class='Ref_To_Local'>nlp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN693"><span class='Ref_to_Member'>paramno</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4333"><span class='Ref_To_Local'>pitem</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2139"><span class='Ref_to_Member'>paramId</span></a><span class='Delimiter'>; 
</span>                <a href="createplan.c.html#LN4338"><span class='Ref_To_Local'>nlp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN694"><span class='Ref_to_Member'>paramval</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN618"><span class='Ref_to_Macro'>copyObject</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4337"><span class='Ref_To_Local'>var</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="createplan.c.html#LN4327"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN312"><span class='Ref_to_Member'>curOuterParams</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4327"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN312"><span class='Ref_to_Member'>curOuterParams</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4338"><span class='Ref_To_Local'>nlp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if IsA(pitem-&GT;item,Var) &raquo; </span> 
        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4333"><span class='Ref_To_Local'>pitem</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2138"><span class='Ref_to_Member'>item</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1846"><span class='Ref_to_Struct'>PlaceHolderVar</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN4366"></a>            <a href="../../../include/nodes/relation.h.html#LN1846"><span class='Ref_to_Struct'>PlaceHolderVar</span></a> <span class='Operator'>*</span><span class='Declare_Local'>phv</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1846"><span class='Ref_to_Struct'>PlaceHolderVar</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4333"><span class='Ref_To_Local'>pitem</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2138"><span class='Ref_to_Member'>item</span></a><span class='Delimiter'>; 
</span><a name="LN4367"></a>            <a href="../../../include/nodes/plannodes.h.html#LN690"><span class='Ref_to_Struct'>NestLoopParam</span></a> <span class='Operator'>*</span><span class='Declare_Local'>nlp</span><span class='Delimiter'>; 
</span><a name="LN4368"></a>            <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* If not from a nestloop outer rel, complain */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/nodes/bitmapset.h.html#LN73"><span class='Ref_to_Proto'>bms_is_subset</span></a><span class='Parentheses'>(</span><a href="../../../include/optimizer/placeholder.h.html#LN21"><span class='Ref_to_Proto'>find_placeholder_info</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4327"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4366"><span class='Ref_To_Local'>phv</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2063"><span class='Ref_to_Member'>ph_eval_at</span></a><span class='Delimiter'>, 
</span>                               <a href="createplan.c.html#LN4327"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN311"><span class='Ref_to_Member'>curOuterRels</span></a><span class='Parentheses'>))</span> 
                <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"non-LATERAL parameter required by subquery"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* Is this param already listed in root-&GT;curOuterParams? */ 
</span>            <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4368"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4327"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN312"><span class='Ref_to_Member'>curOuterParams</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="createplan.c.html#LN4367"><span class='Ref_To_Local'>nlp</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN690"><span class='Ref_to_Struct'>NestLoopParam</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4368"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN4367"><span class='Ref_To_Local'>nlp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN693"><span class='Ref_to_Member'>paramno</span></a> <span class='Operator'>== </span><a href="createplan.c.html#LN4333"><span class='Ref_To_Local'>pitem</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2139"><span class='Ref_to_Member'>paramId</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN626"><span class='Ref_to_Proto'>equal</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4366"><span class='Ref_To_Local'>phv</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4367"><span class='Ref_To_Local'>nlp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN694"><span class='Ref_to_Member'>paramval</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* Present, so nothing to do */ 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN4368"><span class='Ref_To_Local'>lc</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* No, so add it */ 
</span>                <a href="createplan.c.html#LN4367"><span class='Ref_To_Local'>nlp</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN690"><span class='Ref_to_Struct'>NestLoopParam</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="createplan.c.html#LN4367"><span class='Ref_To_Local'>nlp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN693"><span class='Ref_to_Member'>paramno</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4333"><span class='Ref_To_Local'>pitem</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN2139"><span class='Ref_to_Member'>paramId</span></a><span class='Delimiter'>; 
</span>                <a href="createplan.c.html#LN4367"><span class='Ref_To_Local'>nlp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN694"><span class='Ref_to_Member'>paramval</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/nodes.h.html#LN618"><span class='Ref_to_Macro'>copyObject</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4366"><span class='Ref_To_Local'>phv</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="createplan.c.html#LN4327"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN312"><span class='Ref_to_Member'>curOuterParams</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4327"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN312"><span class='Ref_to_Member'>curOuterParams</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4367"><span class='Ref_To_Local'>nlp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if IsA(pitem-&GT;item,Place... &raquo; </span> 
        <span class='Control'>else</span> 
            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unexpected type of subquery parameter"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end process_subquery_nestloop_params &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * fix_indexqual_references 
 *    Adjust indexqual clauses to the form the executor's indexqual 
 *    machinery needs. 
 * 
 * We have four tasks here: 
 *  * Remove RestrictInfo nodes from the input clauses. 
 *  * Replace any outer-relation Var or PHV nodes with nestloop Params. 
 *    (XXX eventually, that responsibility should go elsewhere?) 
 *  * Index keys must be represented by Var nodes with varattno set to the 
 *    index's attribute number, not the attribute number in the original rel. 
 *  * If the index key is on the right, commute the clause to put it on the 
 *    left. 
 * 
 * The result is a modified copy of the path's indexquals list --- the 
 * original is not changed.  Note also that the copy shares no substructure 
 * with the original; this is needed in case there is a subplan in it (we need 
 * two separate copies of the subplan tree, or things will go awry). 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>* 
</span><a name="LN4419"></a><span class='Declare_Function'>fix_indexqual_references</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1027"><span class='Ref_to_Struct'>IndexPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>index_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4421"></a>    <a href="../../../include/nodes/relation.h.html#LN626"><span class='Ref_to_Struct'>IndexOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>index</span> <span class='Operator'>= </span><a href="createplan.c.html#LN4419"><span class='Ref_to_Parameter'>index_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1030"><span class='Ref_to_Member'>indexinfo</span></a><span class='Delimiter'>; 
</span><a name="LN4422"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>fixed_indexquals</span><span class='Delimiter'>; 
</span><a name="LN4423"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lcc</span><span class='Delimiter'>, 
</span><a name="LN4424"></a>               <span class='Operator'>*</span><span class='Declare_Local'>lci</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN4422"><span class='Ref_To_Local'>fixed_indexquals</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/nodes/pg_list.h.html#LN179"><span class='Ref_to_Macro'>forboth</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4423"><span class='Ref_To_Local'>lcc</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4419"><span class='Ref_to_Parameter'>index_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1032"><span class='Ref_to_Member'>indexquals</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4424"><span class='Ref_To_Local'>lci</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4419"><span class='Ref_to_Parameter'>index_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1033"><span class='Ref_to_Member'>indexqualcols</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN4430"></a>        <a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rinfo</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN108"><span class='Ref_to_Macro'>lfirst_node</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4423"><span class='Ref_To_Local'>lcc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN4431"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>indexcol</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN106"><span class='Ref_to_Macro'>lfirst_int</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4424"><span class='Ref_To_Local'>lci</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN4432"></a>        <a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>clause</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Replace any outer-relation variables with nestloop params. 
         * 
         * This also makes a copy of the clause, so it's safe to modify it 
         * in-place below. 
         */ 
</span>        <a href="createplan.c.html#LN4432"><span class='Ref_To_Local'>clause</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4419"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4430"><span class='Ref_To_Local'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1746"><span class='Ref_to_Member'>clause</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4432"><span class='Ref_To_Local'>clause</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/primnodes.h.html#LN491"><span class='Ref_to_Struct'>OpExpr</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN4444"></a>            <a href="../../../include/nodes/primnodes.h.html#LN491"><span class='Ref_to_Struct'>OpExpr</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>op</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN491"><span class='Ref_to_Struct'>OpExpr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4432"><span class='Ref_To_Local'>clause</span></a><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4444"><span class='Ref_To_Local'>op</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN500"><span class='Ref_to_Member'>args</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>2</span><span class='Parentheses'>)</span> 
                <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"indexqual clause is not binary opclause"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Check to see if the indexkey is on the right; if so, commute 
             * the clause.  The indexkey should be the side that refers to 
             * (only) the base relation. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/nodes/bitmapset.h.html#LN66"><span class='Ref_to_Proto'>bms_equal</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4430"><span class='Ref_To_Local'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1773"><span class='Ref_to_Member'>left_relids</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4421"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN632"><span class='Ref_to_Member'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Parentheses'>))</span> 
                <a href="../../../include/optimizer/clauses.h.html#LN77"><span class='Ref_to_Proto'>CommuteOpExpr</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4444"><span class='Ref_To_Local'>op</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Now replace the indexkey expression with an index Var. 
             */ 
</span>            <a href="../../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4444"><span class='Ref_To_Local'>op</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN500"><span class='Ref_to_Member'>args</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="createplan.c.html#LN159"><span class='Ref_to_Proto'>fix_indexqual_operand</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4444"><span class='Ref_To_Local'>op</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN500"><span class='Ref_to_Member'>args</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                                       <a href="createplan.c.html#LN4421"><span class='Ref_To_Local'>index</span></a><span class='Delimiter'>, 
</span>                                                       <a href="createplan.c.html#LN4431"><span class='Ref_To_Local'>indexcol</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if IsA(clause,OpExpr) &raquo; </span> 
        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4432"><span class='Ref_To_Local'>clause</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/primnodes.h.html#LN1026"><span class='Ref_to_Struct'>RowCompareExpr</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN4466"></a>            <a href="../../../include/nodes/primnodes.h.html#LN1026"><span class='Ref_to_Struct'>RowCompareExpr</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rc</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN1026"><span class='Ref_to_Struct'>RowCompareExpr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4432"><span class='Ref_To_Local'>clause</span></a><span class='Delimiter'>; 
</span><a name="LN4467"></a>            <a href="../../../include/nodes/primnodes.h.html#LN131"><span class='Ref_to_Struct'>Expr</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>newrc</span><span class='Delimiter'>; 
</span><a name="LN4468"></a>            <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>indexcolnos</span><span class='Delimiter'>; 
</span><a name="LN4469"></a>            <span class='Keyword'>bool</span>        <span class='Declare_Local'>var_on_left</span><span class='Delimiter'>; 
</span><a name="LN4470"></a>            <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lca</span><span class='Delimiter'>, 
</span><a name="LN4471"></a>                       <span class='Operator'>*</span><span class='Declare_Local'>lcai</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Re-discover which index columns are used in the rowcompare. 
             */ 
</span>            <a href="createplan.c.html#LN4467"><span class='Ref_To_Local'>newrc</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/paths.h.html#LN81"><span class='Ref_to_Proto'>adjust_rowcompare_for_index</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4466"><span class='Ref_To_Local'>rc</span></a><span class='Delimiter'>, 
</span>                                                <a href="createplan.c.html#LN4421"><span class='Ref_To_Local'>index</span></a><span class='Delimiter'>, 
</span>                                                <a href="createplan.c.html#LN4431"><span class='Ref_To_Local'>indexcol</span></a><span class='Delimiter'>, 
</span>                                                <span class='Operator'>&</span><a href="createplan.c.html#LN4468"><span class='Ref_To_Local'>indexcolnos</span></a><span class='Delimiter'>, 
</span>                                                <span class='Operator'>&</span><a href="createplan.c.html#LN4469"><span class='Ref_To_Local'>var_on_left</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Trouble if adjust_rowcompare_for_index thought the 
             * RowCompareExpr didn't match the index as-is; the clause should 
             * have gone through that routine already. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN4467"><span class='Ref_To_Local'>newrc</span></a> <span class='Operator'>!= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN131"><span class='Ref_to_Struct'>Expr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4466"><span class='Ref_To_Local'>rc</span></a><span class='Parentheses'>)</span> 
                <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"inconsistent results from adjust_rowcompare_for_index"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Check to see if the indexkey is on the right; if so, commute 
             * the clause. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="createplan.c.html#LN4469"><span class='Ref_To_Local'>var_on_left</span></a><span class='Parentheses'>) 
</span>                <a href="../../../include/optimizer/clauses.h.html#LN78"><span class='Ref_to_Proto'>CommuteRowCompareExpr</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4466"><span class='Ref_To_Local'>rc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Now replace the indexkey expressions with index Vars. 
             */ 
</span>            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4466"><span class='Ref_To_Local'>rc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN1033"><span class='Ref_to_Member'>largs</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4468"><span class='Ref_To_Local'>indexcolnos</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="../../../include/nodes/pg_list.h.html#LN179"><span class='Ref_to_Macro'>forboth</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4470"><span class='Ref_To_Local'>lca</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4466"><span class='Ref_To_Local'>rc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN1033"><span class='Ref_to_Member'>largs</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4471"><span class='Ref_To_Local'>lcai</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4468"><span class='Ref_To_Local'>indexcolnos</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4470"><span class='Ref_To_Local'>lca</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="createplan.c.html#LN159"><span class='Ref_to_Proto'>fix_indexqual_operand</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4470"><span class='Ref_To_Local'>lca</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                                    <a href="createplan.c.html#LN4421"><span class='Ref_To_Local'>index</span></a><span class='Delimiter'>, 
</span>                                                    <a href="../../../include/nodes/pg_list.h.html#LN106"><span class='Ref_to_Macro'>lfirst_int</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4471"><span class='Ref_To_Local'>lcai</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if IsA(clause,RowCompare... &raquo; </span> 
        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4432"><span class='Ref_To_Local'>clause</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/primnodes.h.html#LN534"><span class='Ref_to_Struct'>ScalarArrayOpExpr</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN4510"></a>            <a href="../../../include/nodes/primnodes.h.html#LN534"><span class='Ref_to_Struct'>ScalarArrayOpExpr</span></a> <span class='Operator'>*</span><span class='Declare_Local'>saop</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN534"><span class='Ref_to_Struct'>ScalarArrayOpExpr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4432"><span class='Ref_To_Local'>clause</span></a><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Never need to commute... */ 
</span> 
            <span class='Comment_Multi_Line'>/* Replace the indexkey expression with an index Var. */ 
</span>            <a href="../../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4510"><span class='Ref_To_Local'>saop</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN541"><span class='Ref_to_Member'>args</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="createplan.c.html#LN159"><span class='Ref_to_Proto'>fix_indexqual_operand</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4510"><span class='Ref_To_Local'>saop</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN541"><span class='Ref_to_Member'>args</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                                         <a href="createplan.c.html#LN4421"><span class='Ref_To_Local'>index</span></a><span class='Delimiter'>, 
</span>                                                         <a href="createplan.c.html#LN4431"><span class='Ref_To_Local'>indexcol</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4432"><span class='Ref_To_Local'>clause</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/primnodes.h.html#LN1175"><span class='Ref_to_Struct'>NullTest</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN4521"></a>            <a href="../../../include/nodes/primnodes.h.html#LN1175"><span class='Ref_to_Struct'>NullTest</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>nt</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN1175"><span class='Ref_to_Struct'>NullTest</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4432"><span class='Ref_To_Local'>clause</span></a><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Replace the indexkey expression with an index Var. */ 
</span>            <a href="createplan.c.html#LN4521"><span class='Ref_To_Local'>nt</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN1178"><span class='Ref_to_Member'>arg</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN131"><span class='Ref_to_Struct'>Expr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN159"><span class='Ref_to_Proto'>fix_indexqual_operand</span></a><span class='Parentheses'>((</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4521"><span class='Ref_To_Local'>nt</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN1178"><span class='Ref_to_Member'>arg</span></a><span class='Delimiter'>, 
</span>                                                     <a href="createplan.c.html#LN4421"><span class='Ref_To_Local'>index</span></a><span class='Delimiter'>, 
</span>                                                     <a href="createplan.c.html#LN4431"><span class='Ref_To_Local'>indexcol</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unsupported indexqual type: %d"</span><span class='Delimiter'>, 
</span>                 <span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="../../../include/nodes/nodes.h.html#LN513"><span class='Ref_to_Macro'>nodeTag</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4432"><span class='Ref_To_Local'>clause</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN4422"><span class='Ref_To_Local'>fixed_indexquals</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4422"><span class='Ref_To_Local'>fixed_indexquals</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4432"><span class='Ref_To_Local'>clause</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN4422"><span class='Ref_To_Local'>fixed_indexquals</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end fix_indexqual_references &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * fix_indexorderby_references 
 *    Adjust indexorderby clauses to the form the executor's index 
 *    machinery needs. 
 * 
 * This is a simplified version of fix_indexqual_references.  The input does 
 * not have RestrictInfo nodes, and we assume that indxpath.c already 
 * commuted the clauses to put the index keys on the left.  Also, we don't 
 * bother to support any cases except simple OpExprs, since nothing else 
 * is allowed for ordering operators. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>* 
</span><a name="LN4550"></a><span class='Declare_Function'>fix_indexorderby_references</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1027"><span class='Ref_to_Struct'>IndexPath</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>index_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4552"></a>    <a href="../../../include/nodes/relation.h.html#LN626"><span class='Ref_to_Struct'>IndexOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>index</span> <span class='Operator'>= </span><a href="createplan.c.html#LN4550"><span class='Ref_to_Parameter'>index_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1030"><span class='Ref_to_Member'>indexinfo</span></a><span class='Delimiter'>; 
</span><a name="LN4553"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>fixed_indexorderbys</span><span class='Delimiter'>; 
</span><a name="LN4554"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lcc</span><span class='Delimiter'>, 
</span><a name="LN4555"></a>               <span class='Operator'>*</span><span class='Declare_Local'>lci</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN4553"><span class='Ref_To_Local'>fixed_indexorderbys</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/nodes/pg_list.h.html#LN179"><span class='Ref_to_Macro'>forboth</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4554"><span class='Ref_To_Local'>lcc</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4550"><span class='Ref_to_Parameter'>index_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1034"><span class='Ref_to_Member'>indexorderbys</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4555"><span class='Ref_To_Local'>lci</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4550"><span class='Ref_to_Parameter'>index_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1035"><span class='Ref_to_Member'>indexorderbycols</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN4561"></a>        <a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>clause</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4554"><span class='Ref_To_Local'>lcc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN4562"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>indexcol</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN106"><span class='Ref_to_Macro'>lfirst_int</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4555"><span class='Ref_To_Local'>lci</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Replace any outer-relation variables with nestloop params. 
         * 
         * This also makes a copy of the clause, so it's safe to modify it 
         * in-place below. 
         */ 
</span>        <a href="createplan.c.html#LN4561"><span class='Ref_To_Local'>clause</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN153"><span class='Ref_to_Proto'>replace_nestloop_params</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4550"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4561"><span class='Ref_To_Local'>clause</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4561"><span class='Ref_To_Local'>clause</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/primnodes.h.html#LN491"><span class='Ref_to_Struct'>OpExpr</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN4574"></a>            <a href="../../../include/nodes/primnodes.h.html#LN491"><span class='Ref_to_Struct'>OpExpr</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>op</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN491"><span class='Ref_to_Struct'>OpExpr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4561"><span class='Ref_To_Local'>clause</span></a><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4574"><span class='Ref_To_Local'>op</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN500"><span class='Ref_to_Member'>args</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>2</span><span class='Parentheses'>)</span> 
                <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"indexorderby clause is not binary opclause"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Now replace the indexkey expression with an index Var. 
             */ 
</span>            <a href="../../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4574"><span class='Ref_To_Local'>op</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN500"><span class='Ref_to_Member'>args</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="createplan.c.html#LN159"><span class='Ref_to_Proto'>fix_indexqual_operand</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4574"><span class='Ref_To_Local'>op</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN500"><span class='Ref_to_Member'>args</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                                       <a href="createplan.c.html#LN4552"><span class='Ref_To_Local'>index</span></a><span class='Delimiter'>, 
</span>                                                       <a href="createplan.c.html#LN4562"><span class='Ref_To_Local'>indexcol</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unsupported indexorderby type: %d"</span><span class='Delimiter'>, 
</span>                 <span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="../../../include/nodes/nodes.h.html#LN513"><span class='Ref_to_Macro'>nodeTag</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4561"><span class='Ref_To_Local'>clause</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN4553"><span class='Ref_To_Local'>fixed_indexorderbys</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4553"><span class='Ref_To_Local'>fixed_indexorderbys</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4561"><span class='Ref_To_Local'>clause</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN4553"><span class='Ref_To_Local'>fixed_indexorderbys</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end fix_indexorderby_references &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * fix_indexqual_operand 
 *    Convert an indexqual expression to a Var referencing the index column. 
 * 
 * We represent index keys by Var nodes having varno == INDEX_VAR and varattno 
 * equal to the index's attribute number (index column position). 
 * 
 * Most of the code here is just for sanity cross-checking that the given 
 * expression actually matches the index column it's claimed to. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>* 
</span><a name="LN4607"></a><span class='Declare_Function'>fix_indexqual_operand</span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN626"><span class='Ref_to_Struct'>IndexOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>index</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>indexcol</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4609"></a>    <a href="../../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN4610"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>pos</span><span class='Delimiter'>; 
</span><a name="LN4611"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>indexpr_item</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Remove any binary-compatible relabeling of the indexkey 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4607"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/primnodes.h.html#LN786"><span class='Ref_to_Struct'>RelabelType</span></a><span class='Parentheses'>))</span> 
        <a href="createplan.c.html#LN4607"><span class='Ref_to_Parameter'>node</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) ((</span><a href="../../../include/nodes/primnodes.h.html#LN786"><span class='Ref_to_Struct'>RelabelType</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4607"><span class='Ref_to_Parameter'>node</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>arg<span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN4607"><span class='Ref_to_Parameter'>indexcol</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="createplan.c.html#LN4607"><span class='Ref_to_Parameter'>indexcol</span></a> <span class='Operator'>&LT; </span><a href="createplan.c.html#LN4607"><span class='Ref_to_Parameter'>index</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN640"><span class='Ref_to_Member'>ncolumns</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN4607"><span class='Ref_to_Parameter'>index</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN641"><span class='Ref_to_Member'>indexkeys</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN4607"><span class='Ref_to_Parameter'>indexcol</span></a><span class='Delimiter'>] </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* It's a simple index column */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4607"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a><span class='Parentheses'>)</span> <span class='Operator'>&& 
</span>            <span class='Parentheses'>((</span><a href="../../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4607"><span class='Ref_to_Parameter'>node</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>varno <span class='Operator'>== </span><a href="createplan.c.html#LN4607"><span class='Ref_to_Parameter'>index</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN632"><span class='Ref_to_Member'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN552"><span class='Ref_to_Member'>relid</span></a> <span class='Operator'>&& 
</span>            <span class='Parentheses'>((</span><a href="../../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4607"><span class='Ref_to_Parameter'>node</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>varattno <span class='Operator'>== </span><a href="createplan.c.html#LN4607"><span class='Ref_to_Parameter'>index</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN641"><span class='Ref_to_Member'>indexkeys</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN4607"><span class='Ref_to_Parameter'>indexcol</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="createplan.c.html#LN4609"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/nodes.h.html#LN618"><span class='Ref_to_Macro'>copyObject</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4607"><span class='Ref_to_Parameter'>node</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN4609"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN165"><span class='Ref_to_Member'>varno</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/primnodes.h.html#LN154"><span class='Ref_to_Const'>INDEX_VAR</span></a><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN4609"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN167"><span class='Ref_to_Member'>varattno</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4607"><span class='Ref_to_Parameter'>indexcol</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4609"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"index key does not match expected index column"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* It's an index expression, so find and cross-check the expression */ 
</span>    <a href="createplan.c.html#LN4611"><span class='Ref_To_Local'>indexpr_item</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN75"><span class='Ref_to_Func'>list_head</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4607"><span class='Ref_to_Parameter'>index</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN652"><span class='Ref_to_Member'>indexprs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN4610"><span class='Ref_To_Local'>pos</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="createplan.c.html#LN4610"><span class='Ref_To_Local'>pos</span></a> <span class='Operator'>&LT; </span><a href="createplan.c.html#LN4607"><span class='Ref_to_Parameter'>index</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN640"><span class='Ref_to_Member'>ncolumns</span></a><span class='Delimiter'>; </span><a href="createplan.c.html#LN4610"><span class='Ref_To_Local'>pos</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN4607"><span class='Ref_to_Parameter'>index</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN641"><span class='Ref_to_Member'>indexkeys</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN4610"><span class='Ref_To_Local'>pos</span></a><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN4611"><span class='Ref_To_Local'>indexpr_item</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"too few entries in indexprs list"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN4610"><span class='Ref_To_Local'>pos</span></a> <span class='Operator'>== </span><a href="createplan.c.html#LN4607"><span class='Ref_to_Parameter'>indexcol</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN4647"></a>                <a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>indexkey</span><span class='Delimiter'>; 
</span> 
                <a href="createplan.c.html#LN4647"><span class='Ref_To_Local'>indexkey</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4611"><span class='Ref_To_Local'>indexpr_item</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN4647"><span class='Ref_To_Local'>indexkey</span></a> <span class='Operator'>&& </span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4647"><span class='Ref_To_Local'>indexkey</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/primnodes.h.html#LN786"><span class='Ref_to_Struct'>RelabelType</span></a><span class='Parentheses'>))</span> 
                    <a href="createplan.c.html#LN4647"><span class='Ref_To_Local'>indexkey</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) ((</span><a href="../../../include/nodes/primnodes.h.html#LN786"><span class='Ref_to_Struct'>RelabelType</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4647"><span class='Ref_To_Local'>indexkey</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>arg<span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN626"><span class='Ref_to_Proto'>equal</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4607"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4647"><span class='Ref_To_Local'>indexkey</span></a><span class='Parentheses'>))</span> 
                <span class='Delimiter'>{ 
</span>                    <a href="createplan.c.html#LN4609"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/makefuncs.h.html#LN25"><span class='Ref_to_Proto'>makeVar</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN154"><span class='Ref_to_Const'>INDEX_VAR</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4607"><span class='Ref_to_Parameter'>indexcol</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>, 
</span>                                     <a href="../../../include/nodes/nodeFuncs.h.html#LN31"><span class='Ref_to_Proto'>exprType</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4611"><span class='Ref_To_Local'>indexpr_item</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, 
</span>                                     <a href="../../../include/nodes/nodeFuncs.h.html#LN38"><span class='Ref_to_Proto'>exprCollation</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4611"><span class='Ref_To_Local'>indexpr_item</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, 
</span>                                     <span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4609"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                    <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"index key does not match expected index column"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <a href="createplan.c.html#LN4611"><span class='Ref_To_Local'>indexpr_item</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN104"><span class='Ref_to_Macro'>lnext</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4611"><span class='Ref_To_Local'>indexpr_item</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if index-&GT;indexkeys[pos]... &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for pos=0;pos&LT;index-&GT;ncol... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Oops... */ 
</span>    <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"index key does not match expected index column"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span><span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end fix_indexqual_operand &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * get_switched_clauses 
 *    Given a list of merge or hash joinclauses (as RestrictInfo nodes), 
 *    extract the bare clauses, and rearrange the elements within the 
 *    clauses, if needed, so the outer join variable is on the left and 
 *    the inner is on the right.  The original clause data structure is not 
 *    touched; a modified list is returned.  We do, however, set the transient 
 *    outer_is_left field in each RestrictInfo to show which side was which. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>* 
</span><a name="LN4682"></a><span class='Declare_Function'>get_switched_clauses</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>clauses</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a> <span class='Declare_Parameter'>outerrelids</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4684"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>t_list</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN4685"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4685"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4682"><span class='Ref_to_Parameter'>clauses</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN4689"></a>        <a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>restrictinfo</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4685"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN4690"></a>        <a href="../../../include/nodes/primnodes.h.html#LN491"><span class='Ref_to_Struct'>OpExpr</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>clause</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN491"><span class='Ref_to_Struct'>OpExpr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4689"><span class='Ref_To_Local'>restrictinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1746"><span class='Ref_to_Member'>clause</span></a><span class='Delimiter'>; 
</span> 
        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/optimizer/clauses.h.html#LN19"><span class='Ref_to_Macro'>is_opclause</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4690"><span class='Ref_To_Local'>clause</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/bitmapset.h.html#LN73"><span class='Ref_to_Proto'>bms_is_subset</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4689"><span class='Ref_To_Local'>restrictinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1774"><span class='Ref_to_Member'>right_relids</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4682"><span class='Ref_to_Parameter'>outerrelids</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * Duplicate just enough of the structure to allow commuting the 
             * clause without changing the original list.  Could use 
             * copyObject, but a complete deep copy is overkill. 
             */ 
</span><a name="LN4700"></a>            <a href="../../../include/nodes/primnodes.h.html#LN491"><span class='Ref_to_Struct'>OpExpr</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>temp</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN491"><span class='Ref_to_Struct'>OpExpr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="createplan.c.html#LN4700"><span class='Ref_To_Local'>temp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN494"><span class='Ref_to_Member'>opno</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4690"><span class='Ref_To_Local'>clause</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN494"><span class='Ref_to_Member'>opno</span></a><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN4700"><span class='Ref_To_Local'>temp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN495"><span class='Ref_to_Member'>opfuncid</span></a> <span class='Operator'>= </span><a href="../../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN4700"><span class='Ref_To_Local'>temp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN496"><span class='Ref_to_Member'>opresulttype</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4690"><span class='Ref_To_Local'>clause</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN496"><span class='Ref_to_Member'>opresulttype</span></a><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN4700"><span class='Ref_To_Local'>temp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN497"><span class='Ref_to_Member'>opretset</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4690"><span class='Ref_To_Local'>clause</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN497"><span class='Ref_to_Member'>opretset</span></a><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN4700"><span class='Ref_To_Local'>temp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN498"><span class='Ref_to_Member'>opcollid</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4690"><span class='Ref_To_Local'>clause</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN498"><span class='Ref_to_Member'>opcollid</span></a><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN4700"><span class='Ref_To_Local'>temp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN499"><span class='Ref_to_Member'>inputcollid</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4690"><span class='Ref_To_Local'>clause</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN499"><span class='Ref_to_Member'>inputcollid</span></a><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN4700"><span class='Ref_To_Local'>temp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN500"><span class='Ref_to_Member'>args</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN268"><span class='Ref_to_Proto'>list_copy</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4690"><span class='Ref_To_Local'>clause</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN500"><span class='Ref_to_Member'>args</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN4700"><span class='Ref_To_Local'>temp</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN501"><span class='Ref_to_Member'>location</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4690"><span class='Ref_To_Local'>clause</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN501"><span class='Ref_to_Member'>location</span></a><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* Commute it --- note this modifies the temp node in-place. */ 
</span>            <a href="../../../include/optimizer/clauses.h.html#LN77"><span class='Ref_to_Proto'>CommuteOpExpr</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4700"><span class='Ref_To_Local'>temp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN4684"><span class='Ref_To_Local'>t_list</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4684"><span class='Ref_To_Local'>t_list</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4700"><span class='Ref_To_Local'>temp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN4689"><span class='Ref_To_Local'>restrictinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1801"><span class='Ref_to_Member'>outer_is_left</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if bms_is_subset(restric... &raquo; </span> 
        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/nodes/bitmapset.h.html#LN73"><span class='Ref_to_Proto'>bms_is_subset</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4689"><span class='Ref_To_Local'>restrictinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1773"><span class='Ref_to_Member'>left_relids</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4682"><span class='Ref_to_Parameter'>outerrelids</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN4684"><span class='Ref_To_Local'>t_list</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4684"><span class='Ref_To_Local'>t_list</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4690"><span class='Ref_To_Local'>clause</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN4689"><span class='Ref_To_Local'>restrictinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1801"><span class='Ref_to_Member'>outer_is_left</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="createplan.c.html#LN4684"><span class='Ref_To_Local'>t_list</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end get_switched_clauses &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * order_qual_clauses 
 *      Given a list of qual clauses that will all be evaluated at the same 
 *      plan node, sort the list into the order we want to check the quals 
 *      in at runtime. 
 * 
 * When security barrier quals are used in the query, we may have quals with 
 * different security levels in the list.  Quals of lower security_level 
 * must go before quals of higher security_level, except that we can grant 
 * exceptions to move up quals that are leakproof.  When security level 
 * doesn't force the decision, we prefer to order clauses by estimated 
 * execution cost, cheapest first. 
 * 
 * Ideally the order should be driven by a combination of execution cost and 
 * selectivity, but it's not immediately clear how to account for both, 
 * and given the uncertainty of the estimates the reliability of the decisions 
 * would be doubtful anyway.  So we just order by security level then 
 * estimated per-tuple cost, being careful not to change the order when 
 * (as is often the case) the estimates are identical. 
 * 
 * Although this will work on either bare clauses or RestrictInfos, it's 
 * much faster to apply it to RestrictInfos, since it can re-use cost 
 * information that is cached in RestrictInfos.  XXX in the bare-clause 
 * case, we are also not able to apply security considerations.  That is 
 * all right for the moment, because the bare-clause case doesn't occur 
 * anywhere that barrier quals could be present, but it would be better to 
 * get rid of it. 
 * 
 * Note: some callers pass lists that contain entries that will later be 
 * removed; this is the easiest way to let this routine see RestrictInfos 
 * instead of bare clauses.  This is another reason why trying to consider 
 * selectivity in the ordering would likely do the wrong thing. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>* 
</span><a name="LN4759"></a><span class='Declare_Function'>order_qual_clauses</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>clauses</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>typedef</span> <span class='Control'>struct</span> 
    <span class='Delimiter'>{ 
</span><a name="LN4763"></a>        <a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Member'>clause</span><span class='Delimiter'>; 
</span><a name="LN4764"></a>        <a href="../../../include/nodes/nodes.h.html#LN638"><span class='Ref_to_Typedef'>Cost</span></a>        <span class='Declare_Member'>cost</span><span class='Delimiter'>; 
</span><a name="LN4765"></a>        <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>       <span class='Declare_Member'>security_level</span><span class='Delimiter'>; 
</span><a name="LN4766"></a>    <span class='Delimiter'>} </span><span class='Declare_Local'>QualItem</span><span class='Delimiter'>; 
</span><a name="LN4767"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>nitems</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4759"><span class='Ref_to_Parameter'>clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN4768"></a>    <a href="createplan.c.html#LN4766"><span class='Ref_to_Typedef'>QualItem</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>items</span><span class='Delimiter'>; 
</span><a name="LN4769"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span><a name="LN4770"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN4771"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* No need to work hard for 0 or 1 clause */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN4767"><span class='Ref_To_Local'>nitems</span></a> <span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="createplan.c.html#LN4759"><span class='Ref_to_Parameter'>clauses</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Collect the items and costs into an array.  This is to avoid repeated 
     * cost_qual_eval work if the inputs aren't RestrictInfos. 
     */ 
</span>    <a href="createplan.c.html#LN4768"><span class='Ref_To_Local'>items</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="createplan.c.html#LN4766"><span class='Ref_to_Typedef'>QualItem</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4767"><span class='Ref_To_Local'>nitems</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN4766"><span class='Ref_to_Typedef'>QualItem</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4770"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4769"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4759"><span class='Ref_to_Parameter'>clauses</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN4785"></a>        <a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>clause</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4769"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN4786"></a>        <a href="../../../include/nodes/relation.h.html#LN42"><span class='Ref_to_Struct'>QualCost</span></a>    <span class='Declare_Local'>qcost</span><span class='Delimiter'>; 
</span> 
        <a href="../../../include/optimizer/cost.h.html#LN158"><span class='Ref_to_Proto'>cost_qual_eval_node</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN4786"><span class='Ref_To_Local'>qcost</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4785"><span class='Ref_To_Local'>clause</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4759"><span class='Ref_to_Parameter'>root</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN4768"><span class='Ref_To_Local'>items</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN4770"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="createplan.c.html#LN4763"><span class='Ref_to_Member'>clause</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4785"><span class='Ref_To_Local'>clause</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN4768"><span class='Ref_To_Local'>items</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN4770"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="createplan.c.html#LN4764"><span class='Ref_to_Member'>cost</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4786"><span class='Ref_To_Local'>qcost</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN45"><span class='Ref_to_Member'>per_tuple</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4785"><span class='Ref_To_Local'>clause</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN4793"></a>            <a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rinfo</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4785"><span class='Ref_To_Local'>clause</span></a><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * If a clause is leakproof, it doesn't have to be constrained by 
             * its nominal security level.  If it's also reasonably cheap 
             * (here defined as 10X cpu_operator_cost), pretend it has 
             * security_level 0, which will allow it to go in front of 
             * more-expensive quals of lower security levels.  Of course, that 
             * will also force it to go in front of cheaper quals of its own 
             * security level, which is not so great, but we can alleviate 
             * that risk by applying the cost limit cutoff. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN4793"><span class='Ref_To_Local'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1756"><span class='Ref_to_Member'>leakproof</span></a> <span class='Operator'>&& </span><a href="createplan.c.html#LN4768"><span class='Ref_To_Local'>items</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN4770"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="createplan.c.html#LN4764"><span class='Ref_to_Member'>cost</span></a> <span class='Operator'>&LT; </span><span class='Number'>10</span> <span class='Operator'>* </span><a href="../path/costsize.c.html#LN107"><span class='Ref_to_Global_Var'>cpu_operator_cost</span></a><span class='Parentheses'>) 
</span>                <a href="createplan.c.html#LN4768"><span class='Ref_To_Local'>items</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN4770"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="createplan.c.html#LN4765"><span class='Ref_to_Member'>security_level</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="createplan.c.html#LN4768"><span class='Ref_To_Local'>items</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN4770"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="createplan.c.html#LN4765"><span class='Ref_to_Member'>security_level</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4793"><span class='Ref_To_Local'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1758"><span class='Ref_to_Member'>security_level</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
            <a href="createplan.c.html#LN4768"><span class='Ref_To_Local'>items</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN4770"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="createplan.c.html#LN4765"><span class='Ref_to_Member'>security_level</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN4770"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Sort.  We don't use qsort() because it's not guaranteed stable for 
     * equal keys.  The expected number of entries is small enough that a 
     * simple insertion sort should be good enough. 
     */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN4770"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; </span><a href="createplan.c.html#LN4770"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="createplan.c.html#LN4767"><span class='Ref_To_Local'>nitems</span></a><span class='Delimiter'>; </span><a href="createplan.c.html#LN4770"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN4822"></a>        <a href="createplan.c.html#LN4766"><span class='Ref_to_Typedef'>QualItem</span></a>    <span class='Declare_Local'>newitem</span> <span class='Operator'>= </span><a href="createplan.c.html#LN4768"><span class='Ref_To_Local'>items</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN4770"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span><a name="LN4823"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* insert newitem into the already-sorted subarray */ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN4823"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4770"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; </span><a href="createplan.c.html#LN4823"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="createplan.c.html#LN4823"><span class='Ref_To_Local'>j</span></a><span class='Operator'>--</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN4828"></a>            <a href="createplan.c.html#LN4766"><span class='Ref_to_Typedef'>QualItem</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>olditem</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN4768"><span class='Ref_To_Local'>items</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN4823"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN4822"><span class='Ref_To_Local'>newitem</span></a><span class='Operator'>.</span><a href="createplan.c.html#LN4765"><span class='Ref_to_Member'>security_level</span></a> <span class='Operator'>&GT; </span><a href="createplan.c.html#LN4828"><span class='Ref_To_Local'>olditem</span></a><span class='Operator'>-&GT;</span><a href="createplan.c.html#LN4765"><span class='Ref_to_Member'>security_level</span></a> <span class='Operator'>|| 
</span>                <span class='Parentheses'>(</span><a href="createplan.c.html#LN4822"><span class='Ref_To_Local'>newitem</span></a><span class='Operator'>.</span><a href="createplan.c.html#LN4765"><span class='Ref_to_Member'>security_level</span></a> <span class='Operator'>== </span><a href="createplan.c.html#LN4828"><span class='Ref_To_Local'>olditem</span></a><span class='Operator'>-&GT;</span><a href="createplan.c.html#LN4765"><span class='Ref_to_Member'>security_level</span></a> <span class='Operator'>&& 
</span>                 <a href="createplan.c.html#LN4822"><span class='Ref_To_Local'>newitem</span></a><span class='Operator'>.</span><a href="createplan.c.html#LN4764"><span class='Ref_to_Member'>cost</span></a> <span class='Operator'>&GT;= </span><a href="createplan.c.html#LN4828"><span class='Ref_To_Local'>olditem</span></a><span class='Operator'>-&GT;</span><a href="createplan.c.html#LN4764"><span class='Ref_to_Member'>cost</span></a><span class='Parentheses'>))</span> 
                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN4768"><span class='Ref_To_Local'>items</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN4823"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>] </span><span class='Operator'>= *</span><a href="createplan.c.html#LN4828"><span class='Ref_To_Local'>olditem</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="createplan.c.html#LN4768"><span class='Ref_To_Local'>items</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN4823"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN4822"><span class='Ref_To_Local'>newitem</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Convert back to a list */ 
</span>    <a href="createplan.c.html#LN4771"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN4770"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="createplan.c.html#LN4770"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="createplan.c.html#LN4767"><span class='Ref_To_Local'>nitems</span></a><span class='Delimiter'>; </span><a href="createplan.c.html#LN4770"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <a href="createplan.c.html#LN4771"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4771"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4768"><span class='Ref_To_Local'>items</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN4770"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="createplan.c.html#LN4763"><span class='Ref_to_Member'>clause</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN4771"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end order_qual_clauses &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Copy cost and size info from a Path node to the Plan node created from it. 
 * The executor usually won't use this info, but it's needed by EXPLAIN. 
 * Also copy the parallel-related flags, which the executor *will* use. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN4853"></a><span class='Declare_Function'>copy_generic_path_info</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dest</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>src</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="createplan.c.html#LN4853"><span class='Ref_to_Parameter'>dest</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN124"><span class='Ref_to_Member'>startup_cost</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4853"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN964"><span class='Ref_to_Member'>startup_cost</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4853"><span class='Ref_to_Parameter'>dest</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN125"><span class='Ref_to_Member'>total_cost</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4853"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN965"><span class='Ref_to_Member'>total_cost</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4853"><span class='Ref_to_Parameter'>dest</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN130"><span class='Ref_to_Member'>plan_rows</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4853"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN963"><span class='Ref_to_Member'>rows</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4853"><span class='Ref_to_Parameter'>dest</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN131"><span class='Ref_to_Member'>plan_width</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4853"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN953"><span class='Ref_to_Member'>pathtarget</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN885"><span class='Ref_to_Member'>width</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4853"><span class='Ref_to_Parameter'>dest</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN136"><span class='Ref_to_Member'>parallel_aware</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4853"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN957"><span class='Ref_to_Member'>parallel_aware</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4853"><span class='Ref_to_Parameter'>dest</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN137"><span class='Ref_to_Member'>parallel_safe</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4853"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN958"><span class='Ref_to_Member'>parallel_safe</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Copy cost and size info from a lower plan node to an inserted node. 
 * (Most callers alter the info after copying it.) 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN4868"></a><span class='Declare_Function'>copy_plan_costsize</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>dest</span><span class='Delimiter'>, </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>src</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="createplan.c.html#LN4868"><span class='Ref_to_Parameter'>dest</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN124"><span class='Ref_to_Member'>startup_cost</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4868"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN124"><span class='Ref_to_Member'>startup_cost</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4868"><span class='Ref_to_Parameter'>dest</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN125"><span class='Ref_to_Member'>total_cost</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4868"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN125"><span class='Ref_to_Member'>total_cost</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4868"><span class='Ref_to_Parameter'>dest</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN130"><span class='Ref_to_Member'>plan_rows</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4868"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN130"><span class='Ref_to_Member'>plan_rows</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4868"><span class='Ref_to_Parameter'>dest</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN131"><span class='Ref_to_Member'>plan_width</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4868"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN131"><span class='Ref_to_Member'>plan_width</span></a><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* Assume the inserted node is not parallel-aware. */ 
</span>    <a href="createplan.c.html#LN4868"><span class='Ref_to_Parameter'>dest</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN136"><span class='Ref_to_Member'>parallel_aware</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* Assume the inserted node is parallel-safe, if child plan is. */ 
</span>    <a href="createplan.c.html#LN4868"><span class='Ref_to_Parameter'>dest</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN137"><span class='Ref_to_Member'>parallel_safe</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4868"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN137"><span class='Ref_to_Member'>parallel_safe</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Some places in this file build Sort nodes that don't have a directly 
 * corresponding Path node.  The cost of the sort is, or should have been, 
 * included in the cost of the Path node we're working from, but since it's 
 * not split out, we have to re-figure it using cost_sort().  This is just 
 * to label the Sort node nicely for EXPLAIN. 
 * 
 * limit_tuples is as for cost_sort (in particular, pass -1 if no limit) 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN4890"></a><span class='Declare_Function'>label_sort_with_costsize</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/plannodes.h.html#LN743"><span class='Ref_to_Struct'>Sort</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>plan</span><span class='Delimiter'>, </span><span class='Keyword'>double </span><span class='Declare_Parameter'>limit_tuples</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4892"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>lefttree</span> <span class='Operator'>= </span><a href="createplan.c.html#LN4890"><span class='Ref_to_Parameter'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN745"><span class='Ref_to_Member'>plan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a><span class='Delimiter'>; 
</span><a name="LN4893"></a>    <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>        <span class='Declare_Local'>sort_path</span><span class='Delimiter'>;</span>      <span class='Comment_Single_Line'>/* dummy for result of cost_sort */ 
</span> 
    <a href="../../../include/optimizer/cost.h.html#LN103"><span class='Ref_to_Proto'>cost_sort</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN4893"><span class='Ref_To_Local'>sort_path</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN4890"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>, 
</span>              <a href="createplan.c.html#LN4892"><span class='Ref_To_Local'>lefttree</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN125"><span class='Ref_to_Member'>total_cost</span></a><span class='Delimiter'>, 
</span>              <a href="createplan.c.html#LN4892"><span class='Ref_To_Local'>lefttree</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN130"><span class='Ref_to_Member'>plan_rows</span></a><span class='Delimiter'>, 
</span>              <a href="createplan.c.html#LN4892"><span class='Ref_To_Local'>lefttree</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN131"><span class='Ref_to_Member'>plan_width</span></a><span class='Delimiter'>, 
</span>              <span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Delimiter'>, 
</span>              <a href="../../utils/init/globals.c.html#LN112"><span class='Ref_to_Global_Var'>work_mem</span></a><span class='Delimiter'>, 
</span>              <a href="createplan.c.html#LN4890"><span class='Ref_to_Parameter'>limit_tuples</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4890"><span class='Ref_to_Parameter'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN745"><span class='Ref_to_Member'>plan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN124"><span class='Ref_to_Member'>startup_cost</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4893"><span class='Ref_To_Local'>sort_path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN964"><span class='Ref_to_Member'>startup_cost</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4890"><span class='Ref_to_Parameter'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN745"><span class='Ref_to_Member'>plan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN125"><span class='Ref_to_Member'>total_cost</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4893"><span class='Ref_To_Local'>sort_path</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN965"><span class='Ref_to_Member'>total_cost</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4890"><span class='Ref_to_Parameter'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN745"><span class='Ref_to_Member'>plan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN130"><span class='Ref_to_Member'>plan_rows</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4892"><span class='Ref_To_Local'>lefttree</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN130"><span class='Ref_to_Member'>plan_rows</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4890"><span class='Ref_to_Parameter'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN745"><span class='Ref_to_Member'>plan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN131"><span class='Ref_to_Member'>plan_width</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4892"><span class='Ref_To_Local'>lefttree</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN131"><span class='Ref_to_Member'>plan_width</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4890"><span class='Ref_to_Parameter'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN745"><span class='Ref_to_Member'>plan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN136"><span class='Ref_to_Member'>parallel_aware</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4890"><span class='Ref_to_Parameter'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN745"><span class='Ref_to_Member'>plan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN137"><span class='Ref_to_Member'>parallel_safe</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4892"><span class='Ref_To_Local'>lefttree</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN137"><span class='Ref_to_Member'>parallel_safe</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end label_sort_with_costsize &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * bitmap_subplan_mark_shared 
 *   Set isshared flag in bitmap subplan so that it will be created in 
 *   shared memory. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN4916"></a><span class='Declare_Function'>bitmap_subplan_mark_shared</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>plan</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4916"><span class='Ref_to_Parameter'>plan</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/plannodes.h.html#LN299"><span class='Ref_to_Struct'>BitmapAnd</span></a><span class='Parentheses'>))</span> 
        <a href="createplan.c.html#LN127"><span class='Ref_to_Proto'>bitmap_subplan_mark_shared</span></a><span class='Parentheses'>(</span> 
                                <a href="../../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(((</span><a href="../../../include/nodes/plannodes.h.html#LN299"><span class='Ref_to_Struct'>BitmapAnd</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4916"><span class='Ref_to_Parameter'>plan</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>bitmapplans<span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4916"><span class='Ref_to_Parameter'>plan</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/plannodes.h.html#LN313"><span class='Ref_to_Struct'>BitmapOr</span></a><span class='Parentheses'>))</span> 
        <span class='Parentheses'>((</span><a href="../../../include/nodes/plannodes.h.html#LN313"><span class='Ref_to_Struct'>BitmapOr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4916"><span class='Ref_to_Parameter'>plan</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>isshared <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4916"><span class='Ref_to_Parameter'>plan</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/plannodes.h.html#LN441"><span class='Ref_to_Struct'>BitmapIndexScan</span></a><span class='Parentheses'>))</span> 
        <span class='Parentheses'>((</span><a href="../../../include/nodes/plannodes.h.html#LN441"><span class='Ref_to_Struct'>BitmapIndexScan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN4916"><span class='Ref_to_Parameter'>plan</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>isshared <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized node type: %d"</span><span class='Delimiter'>, </span><a href="../../../include/nodes/nodes.h.html#LN513"><span class='Ref_to_Macro'>nodeTag</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN4916"><span class='Ref_to_Parameter'>plan</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/***************************************************************************** 
 * 
 *  PLAN NODE BUILDING ROUTINES 
 * 
 * In general, these functions are not passed the original Path and therefore 
 * leave it to the caller to fill in the cost/width fields from the Path, 
 * typically by calling copy_generic_path_info().  This convention is 
 * somewhat historical, but it does support a few places above where we build 
 * a plan node without having an exactly corresponding Path node.  Under no 
 * circumstances should one of these functions do its own cost calculations, 
 * as that would be redundant with calculations done while building Paths. 
 * 
 *****************************************************************************/ 
</span> 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN335"><span class='Ref_to_Typedef'>SeqScan</span></a> <span class='Operator'>* 
</span><a name="LN4944"></a><span class='Declare_Function'>make_seqscan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, 
</span><a name="LN4945"></a>             <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, 
</span><a name="LN4946"></a>             <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4948"></a>    <a href="../../../include/nodes/plannodes.h.html#LN335"><span class='Ref_to_Typedef'>SeqScan</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN335"><span class='Ref_to_Typedef'>SeqScan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN4949"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN4948"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN4949"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4944"><span class='Ref_to_Parameter'>qptlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4949"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4945"><span class='Ref_to_Parameter'>qpqual</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4949"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4949"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4948"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN328"><span class='Ref_to_Member'>scanrelid</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4946"><span class='Ref_to_Parameter'>scanrelid</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN4948"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN341"><span class='Ref_to_Struct'>SampleScan</span></a> <span class='Operator'>* 
</span><a name="LN4961"></a><span class='Declare_Function'>make_samplescan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, 
</span><a name="LN4962"></a>                <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, 
</span><a name="LN4963"></a>                <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Delimiter'>, 
</span><a name="LN4964"></a>                <a href="../../../include/nodes/parsenodes.h.html#LN1071"><span class='Ref_to_Struct'>TableSampleClause</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tsc</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4966"></a>    <a href="../../../include/nodes/plannodes.h.html#LN341"><span class='Ref_to_Struct'>SampleScan</span></a> <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN341"><span class='Ref_to_Struct'>SampleScan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN4967"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN4966"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN343"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN4967"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4961"><span class='Ref_to_Parameter'>qptlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4967"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4962"><span class='Ref_to_Parameter'>qpqual</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4967"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4967"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4966"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN343"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN328"><span class='Ref_to_Member'>scanrelid</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4963"><span class='Ref_to_Parameter'>scanrelid</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4966"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN345"><span class='Ref_to_Member'>tablesample</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4964"><span class='Ref_to_Parameter'>tsc</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN4966"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN385"><span class='Ref_to_Struct'>IndexScan</span></a> <span class='Operator'>* 
</span><a name="LN4980"></a><span class='Declare_Function'>make_indexscan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, 
</span><a name="LN4981"></a>               <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, 
</span><a name="LN4982"></a>               <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Delimiter'>, 
</span><a name="LN4983"></a>               <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>indexid</span><span class='Delimiter'>, 
</span><a name="LN4984"></a>               <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>indexqual</span><span class='Delimiter'>, 
</span><a name="LN4985"></a>               <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>indexqualorig</span><span class='Delimiter'>, 
</span><a name="LN4986"></a>               <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>indexorderby</span><span class='Delimiter'>, 
</span><a name="LN4987"></a>               <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>indexorderbyorig</span><span class='Delimiter'>, 
</span><a name="LN4988"></a>               <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>indexorderbyops</span><span class='Delimiter'>, 
</span><a name="LN4989"></a>               <a href="../../../include/access/sdir.h.html#LN21"><span class='Ref_to_Enum'>ScanDirection</span></a> <span class='Declare_Parameter'>indexscandir</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN4991"></a>    <a href="../../../include/nodes/plannodes.h.html#LN385"><span class='Ref_to_Struct'>IndexScan</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN385"><span class='Ref_to_Struct'>IndexScan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN4992"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN4991"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN387"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN4992"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4980"><span class='Ref_to_Parameter'>qptlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4992"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4981"><span class='Ref_to_Parameter'>qpqual</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4992"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4992"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4991"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN387"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN328"><span class='Ref_to_Member'>scanrelid</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4982"><span class='Ref_to_Parameter'>scanrelid</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4991"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN388"><span class='Ref_to_Member'>indexid</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4983"><span class='Ref_to_Parameter'>indexid</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4991"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN389"><span class='Ref_to_Member'>indexqual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4984"><span class='Ref_to_Parameter'>indexqual</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4991"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN390"><span class='Ref_to_Member'>indexqualorig</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4985"><span class='Ref_to_Parameter'>indexqualorig</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4991"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN391"><span class='Ref_to_Member'>indexorderby</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4986"><span class='Ref_to_Parameter'>indexorderby</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4991"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN392"><span class='Ref_to_Member'>indexorderbyorig</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4987"><span class='Ref_to_Parameter'>indexorderbyorig</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4991"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN393"><span class='Ref_to_Member'>indexorderbyops</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4988"><span class='Ref_to_Parameter'>indexorderbyops</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN4991"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN394"><span class='Ref_to_Member'>indexorderdir</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN4989"><span class='Ref_to_Parameter'>indexscandir</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN4991"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_indexscan &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN414"><span class='Ref_to_Struct'>IndexOnlyScan</span></a> <span class='Operator'>* 
</span><a name="LN5011"></a><span class='Declare_Function'>make_indexonlyscan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, 
</span><a name="LN5012"></a>                   <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, 
</span><a name="LN5013"></a>                   <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Delimiter'>, 
</span><a name="LN5014"></a>                   <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>indexid</span><span class='Delimiter'>, 
</span><a name="LN5015"></a>                   <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>indexqual</span><span class='Delimiter'>, 
</span><a name="LN5016"></a>                   <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>indexorderby</span><span class='Delimiter'>, 
</span><a name="LN5017"></a>                   <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>indextlist</span><span class='Delimiter'>, 
</span><a name="LN5018"></a>                   <a href="../../../include/access/sdir.h.html#LN21"><span class='Ref_to_Enum'>ScanDirection</span></a> <span class='Declare_Parameter'>indexscandir</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5020"></a>    <a href="../../../include/nodes/plannodes.h.html#LN414"><span class='Ref_to_Struct'>IndexOnlyScan</span></a> <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN414"><span class='Ref_to_Struct'>IndexOnlyScan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5021"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN5020"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN416"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN5021"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5011"><span class='Ref_to_Parameter'>qptlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5021"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5012"><span class='Ref_to_Parameter'>qpqual</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5021"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5021"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5020"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN416"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN328"><span class='Ref_to_Member'>scanrelid</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5013"><span class='Ref_to_Parameter'>scanrelid</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5020"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN417"><span class='Ref_to_Member'>indexid</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5014"><span class='Ref_to_Parameter'>indexid</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5020"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN418"><span class='Ref_to_Member'>indexqual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5015"><span class='Ref_to_Parameter'>indexqual</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5020"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN419"><span class='Ref_to_Member'>indexorderby</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5016"><span class='Ref_to_Parameter'>indexorderby</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5020"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN420"><span class='Ref_to_Member'>indextlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5017"><span class='Ref_to_Parameter'>indextlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5020"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN421"><span class='Ref_to_Member'>indexorderdir</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5018"><span class='Ref_to_Parameter'>indexscandir</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN5020"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_indexonlyscan &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN441"><span class='Ref_to_Struct'>BitmapIndexScan</span></a> <span class='Operator'>* 
</span><a name="LN5038"></a><span class='Declare_Function'>make_bitmap_indexscan</span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Delimiter'>, 
</span><a name="LN5039"></a>                      <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>indexid</span><span class='Delimiter'>, 
</span><a name="LN5040"></a>                      <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>indexqual</span><span class='Delimiter'>, 
</span><a name="LN5041"></a>                      <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>indexqualorig</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5043"></a>    <a href="../../../include/nodes/plannodes.h.html#LN441"><span class='Ref_to_Struct'>BitmapIndexScan</span></a> <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN441"><span class='Ref_to_Struct'>BitmapIndexScan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5044"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN5043"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN443"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN5044"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* not used */ 
</span>    <a href="createplan.c.html#LN5044"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* not used */ 
</span>    <a href="createplan.c.html#LN5044"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5044"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5043"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN443"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN328"><span class='Ref_to_Member'>scanrelid</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5038"><span class='Ref_to_Parameter'>scanrelid</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5043"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN444"><span class='Ref_to_Member'>indexid</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5039"><span class='Ref_to_Parameter'>indexid</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5043"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN446"><span class='Ref_to_Member'>indexqual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5040"><span class='Ref_to_Parameter'>indexqual</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5043"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN447"><span class='Ref_to_Member'>indexqualorig</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5041"><span class='Ref_to_Parameter'>indexqualorig</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN5043"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_bitmap_indexscan &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN459"><span class='Ref_to_Struct'>BitmapHeapScan</span></a> <span class='Operator'>* 
</span><a name="LN5059"></a><span class='Declare_Function'>make_bitmap_heapscan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, 
</span><a name="LN5060"></a>                     <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, 
</span><a name="LN5061"></a>                     <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, 
</span><a name="LN5062"></a>                     <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>bitmapqualorig</span><span class='Delimiter'>, 
</span><a name="LN5063"></a>                     <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5065"></a>    <a href="../../../include/nodes/plannodes.h.html#LN459"><span class='Ref_to_Struct'>BitmapHeapScan</span></a> <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN459"><span class='Ref_to_Struct'>BitmapHeapScan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5066"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN5065"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN461"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN5066"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5059"><span class='Ref_to_Parameter'>qptlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5066"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5060"><span class='Ref_to_Parameter'>qpqual</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5066"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5061"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5066"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5065"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN461"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN328"><span class='Ref_to_Member'>scanrelid</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5063"><span class='Ref_to_Parameter'>scanrelid</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5065"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN462"><span class='Ref_to_Member'>bitmapqualorig</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5062"><span class='Ref_to_Parameter'>bitmapqualorig</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN5065"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN472"><span class='Ref_to_Struct'>TidScan</span></a> <span class='Operator'>* 
</span><a name="LN5079"></a><span class='Declare_Function'>make_tidscan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, 
</span><a name="LN5080"></a>             <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, 
</span><a name="LN5081"></a>             <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Delimiter'>, 
</span><a name="LN5082"></a>             <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tidquals</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5084"></a>    <a href="../../../include/nodes/plannodes.h.html#LN472"><span class='Ref_to_Struct'>TidScan</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN472"><span class='Ref_to_Struct'>TidScan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5085"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN5084"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN474"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN5085"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5079"><span class='Ref_to_Parameter'>qptlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5085"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5080"><span class='Ref_to_Parameter'>qpqual</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5085"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5085"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5084"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN474"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN328"><span class='Ref_to_Member'>scanrelid</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5081"><span class='Ref_to_Parameter'>scanrelid</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5084"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN475"><span class='Ref_to_Member'>tidquals</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5082"><span class='Ref_to_Parameter'>tidquals</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN5084"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN494"><span class='Ref_to_Struct'>SubqueryScan</span></a> <span class='Operator'>* 
</span><a name="LN5098"></a><span class='Declare_Function'>make_subqueryscan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, 
</span><a name="LN5099"></a>                  <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, 
</span><a name="LN5100"></a>                  <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Delimiter'>, 
</span><a name="LN5101"></a>                  <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>subplan</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5103"></a>    <a href="../../../include/nodes/plannodes.h.html#LN494"><span class='Ref_to_Struct'>SubqueryScan</span></a> <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN494"><span class='Ref_to_Struct'>SubqueryScan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5104"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN5103"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN496"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN5104"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5098"><span class='Ref_to_Parameter'>qptlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5104"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5099"><span class='Ref_to_Parameter'>qpqual</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5104"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5104"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5103"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN496"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN328"><span class='Ref_to_Member'>scanrelid</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5100"><span class='Ref_to_Parameter'>scanrelid</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5103"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN497"><span class='Ref_to_Member'>subplan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5101"><span class='Ref_to_Parameter'>subplan</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN5103"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN504"><span class='Ref_to_Struct'>FunctionScan</span></a> <span class='Operator'>* 
</span><a name="LN5117"></a><span class='Declare_Function'>make_functionscan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, 
</span><a name="LN5118"></a>                  <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, 
</span><a name="LN5119"></a>                  <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Delimiter'>, 
</span><a name="LN5120"></a>                  <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>functions</span><span class='Delimiter'>, 
</span><a name="LN5121"></a>                  <span class='Keyword'>bool </span><span class='Declare_Parameter'>funcordinality</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5123"></a>    <a href="../../../include/nodes/plannodes.h.html#LN504"><span class='Ref_to_Struct'>FunctionScan</span></a> <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN504"><span class='Ref_to_Struct'>FunctionScan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5124"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN5123"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN506"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN5124"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5117"><span class='Ref_to_Parameter'>qptlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5124"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5118"><span class='Ref_to_Parameter'>qpqual</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5124"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5124"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5123"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN506"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN328"><span class='Ref_to_Member'>scanrelid</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5119"><span class='Ref_to_Parameter'>scanrelid</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5123"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN507"><span class='Ref_to_Member'>functions</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5120"><span class='Ref_to_Parameter'>functions</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5123"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN508"><span class='Ref_to_Member'>funcordinality</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5121"><span class='Ref_to_Parameter'>funcordinality</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN5123"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_functionscan &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN525"><span class='Ref_to_Struct'>TableFuncScan</span></a> <span class='Operator'>* 
</span><a name="LN5138"></a><span class='Declare_Function'>make_tablefuncscan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, 
</span><a name="LN5139"></a>                   <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, 
</span><a name="LN5140"></a>                   <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Delimiter'>, 
</span><a name="LN5141"></a>                   <a href="../../../include/nodes/primnodes.h.html#LN78"><span class='Ref_to_Struct'>TableFunc</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tablefunc</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5143"></a>    <a href="../../../include/nodes/plannodes.h.html#LN525"><span class='Ref_to_Struct'>TableFuncScan</span></a> <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN525"><span class='Ref_to_Struct'>TableFuncScan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5144"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN5143"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN527"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN5144"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5138"><span class='Ref_to_Parameter'>qptlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5144"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5139"><span class='Ref_to_Parameter'>qpqual</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5144"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5144"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5143"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN527"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN328"><span class='Ref_to_Member'>scanrelid</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5140"><span class='Ref_to_Parameter'>scanrelid</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5143"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN528"><span class='Ref_to_Member'>tablefunc</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5141"><span class='Ref_to_Parameter'>tablefunc</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN5143"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN515"><span class='Ref_to_Struct'>ValuesScan</span></a> <span class='Operator'>* 
</span><a name="LN5157"></a><span class='Declare_Function'>make_valuesscan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, 
</span><a name="LN5158"></a>                <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, 
</span><a name="LN5159"></a>                <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Delimiter'>, 
</span><a name="LN5160"></a>                <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>values_lists</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5162"></a>    <a href="../../../include/nodes/plannodes.h.html#LN515"><span class='Ref_to_Struct'>ValuesScan</span></a> <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN515"><span class='Ref_to_Struct'>ValuesScan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5163"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN5162"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN517"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN5163"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5157"><span class='Ref_to_Parameter'>qptlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5163"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5158"><span class='Ref_to_Parameter'>qpqual</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5163"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5163"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5162"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN517"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN328"><span class='Ref_to_Member'>scanrelid</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5159"><span class='Ref_to_Parameter'>scanrelid</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5162"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN518"><span class='Ref_to_Member'>values_lists</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5160"><span class='Ref_to_Parameter'>values_lists</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN5162"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN535"><span class='Ref_to_Struct'>CteScan</span></a> <span class='Operator'>* 
</span><a name="LN5176"></a><span class='Declare_Function'>make_ctescan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, 
</span><a name="LN5177"></a>             <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, 
</span><a name="LN5178"></a>             <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Delimiter'>, 
</span><a name="LN5179"></a>             <span class='Keyword'>int </span><span class='Declare_Parameter'>ctePlanId</span><span class='Delimiter'>, 
</span><a name="LN5180"></a>             <span class='Keyword'>int </span><span class='Declare_Parameter'>cteParam</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5182"></a>    <a href="../../../include/nodes/plannodes.h.html#LN535"><span class='Ref_to_Struct'>CteScan</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN535"><span class='Ref_to_Struct'>CteScan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5183"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN5182"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN537"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN5183"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5176"><span class='Ref_to_Parameter'>qptlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5183"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5177"><span class='Ref_to_Parameter'>qpqual</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5183"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5183"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5182"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN537"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN328"><span class='Ref_to_Member'>scanrelid</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5178"><span class='Ref_to_Parameter'>scanrelid</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5182"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN538"><span class='Ref_to_Member'>ctePlanId</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5179"><span class='Ref_to_Parameter'>ctePlanId</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5182"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN539"><span class='Ref_to_Member'>cteParam</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5180"><span class='Ref_to_Parameter'>cteParam</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN5182"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_ctescan &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN546"><span class='Ref_to_Struct'>NamedTuplestoreScan</span></a> <span class='Operator'>* 
</span><a name="LN5197"></a><span class='Declare_Function'>make_namedtuplestorescan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, 
</span><a name="LN5198"></a>                         <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, 
</span><a name="LN5199"></a>                         <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Delimiter'>, 
</span><a name="LN5200"></a>                         <span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>enrname</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5202"></a>    <a href="../../../include/nodes/plannodes.h.html#LN546"><span class='Ref_to_Struct'>NamedTuplestoreScan</span></a> <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN546"><span class='Ref_to_Struct'>NamedTuplestoreScan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5203"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN5202"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN548"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* cost should be inserted by caller */ 
</span>    <a href="createplan.c.html#LN5203"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5197"><span class='Ref_to_Parameter'>qptlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5203"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5198"><span class='Ref_to_Parameter'>qpqual</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5203"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5203"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5202"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN548"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN328"><span class='Ref_to_Member'>scanrelid</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5199"><span class='Ref_to_Parameter'>scanrelid</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5202"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN549"><span class='Ref_to_Member'>enrname</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5200"><span class='Ref_to_Parameter'>enrname</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN5202"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN556"><span class='Ref_to_Struct'>WorkTableScan</span></a> <span class='Operator'>* 
</span><a name="LN5217"></a><span class='Declare_Function'>make_worktablescan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, 
</span><a name="LN5218"></a>                   <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, 
</span><a name="LN5219"></a>                   <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Delimiter'>, 
</span><a name="LN5220"></a>                   <span class='Keyword'>int </span><span class='Declare_Parameter'>wtParam</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5222"></a>    <a href="../../../include/nodes/plannodes.h.html#LN556"><span class='Ref_to_Struct'>WorkTableScan</span></a> <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN556"><span class='Ref_to_Struct'>WorkTableScan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5223"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN5222"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN558"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN5223"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5217"><span class='Ref_to_Parameter'>qptlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5223"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5218"><span class='Ref_to_Parameter'>qpqual</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5223"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5223"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5222"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN558"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN328"><span class='Ref_to_Member'>scanrelid</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5219"><span class='Ref_to_Parameter'>scanrelid</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5222"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN559"><span class='Ref_to_Member'>wtParam</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5220"><span class='Ref_to_Parameter'>wtParam</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN5222"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/nodes/plannodes.h.html#LN594"><span class='Ref_to_Struct'>ForeignScan</span></a> <span class='Operator'>* 
</span><a name="LN5236"></a><span class='Declare_Function'>make_foreignscan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, 
</span><a name="LN5237"></a>                 <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, 
</span><a name="LN5238"></a>                 <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>scanrelid</span><span class='Delimiter'>, 
</span><a name="LN5239"></a>                 <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>fdw_exprs</span><span class='Delimiter'>, 
</span><a name="LN5240"></a>                 <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>fdw_private</span><span class='Delimiter'>, 
</span><a name="LN5241"></a>                 <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>fdw_scan_tlist</span><span class='Delimiter'>, 
</span><a name="LN5242"></a>                 <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>fdw_recheck_quals</span><span class='Delimiter'>, 
</span><a name="LN5243"></a>                 <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outer_plan</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5245"></a>    <a href="../../../include/nodes/plannodes.h.html#LN594"><span class='Ref_to_Struct'>ForeignScan</span></a> <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN594"><span class='Ref_to_Struct'>ForeignScan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5246"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN5245"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN596"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN327"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* cost will be filled in by create_foreignscan_plan */ 
</span>    <a href="createplan.c.html#LN5246"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5236"><span class='Ref_to_Parameter'>qptlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5246"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5237"><span class='Ref_to_Parameter'>qpqual</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5246"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5243"><span class='Ref_to_Parameter'>outer_plan</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5246"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5245"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN596"><span class='Ref_to_Member'>scan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN328"><span class='Ref_to_Member'>scanrelid</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5238"><span class='Ref_to_Parameter'>scanrelid</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5245"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN597"><span class='Ref_to_Member'>operation</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN650"><span class='Ref_to_EnumConst'>CMD_SELECT</span></a><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* fs_server will be filled in by create_foreignscan_plan */ 
</span>    <a href="createplan.c.html#LN5245"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN598"><span class='Ref_to_Member'>fs_server</span></a> <span class='Operator'>= </span><a href="../../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5245"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN599"><span class='Ref_to_Member'>fdw_exprs</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5239"><span class='Ref_to_Parameter'>fdw_exprs</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5245"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN600"><span class='Ref_to_Member'>fdw_private</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5240"><span class='Ref_to_Parameter'>fdw_private</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5245"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN601"><span class='Ref_to_Member'>fdw_scan_tlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5241"><span class='Ref_to_Parameter'>fdw_scan_tlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5245"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN602"><span class='Ref_to_Member'>fdw_recheck_quals</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5242"><span class='Ref_to_Parameter'>fdw_recheck_quals</span></a><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* fs_relids will be filled in by create_foreignscan_plan */ 
</span>    <a href="createplan.c.html#LN5245"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN604"><span class='Ref_to_Member'>fs_relids</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* fsSystemCol will be filled in by create_foreignscan_plan */ 
</span>    <a href="createplan.c.html#LN5245"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN605"><span class='Ref_to_Member'>fsSystemCol</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN5245"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_foreignscan &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN244"><span class='Ref_to_Struct'>Append</span></a> <span class='Operator'>* 
</span><a name="LN5270"></a><span class='Declare_Function'>make_append</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>appendplans</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>partitioned_rels</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5272"></a>    <a href="../../../include/nodes/plannodes.h.html#LN244"><span class='Ref_to_Struct'>Append</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN244"><span class='Ref_to_Struct'>Append</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5273"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN5272"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN246"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN5273"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5270"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5273"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5273"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5273"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5272"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN248"><span class='Ref_to_Member'>partitioned_rels</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5270"><span class='Ref_to_Parameter'>partitioned_rels</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5272"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN249"><span class='Ref_to_Member'>appendplans</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5270"><span class='Ref_to_Parameter'>appendplans</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN5272"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN279"><span class='Ref_to_Struct'>RecursiveUnion</span></a> <span class='Operator'>* 
</span><a name="LN5286"></a><span class='Declare_Function'>make_recursive_union</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, 
</span><a name="LN5287"></a>                     <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, 
</span><a name="LN5288"></a>                     <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>righttree</span><span class='Delimiter'>, 
</span><a name="LN5289"></a>                     <span class='Keyword'>int </span><span class='Declare_Parameter'>wtParam</span><span class='Delimiter'>, 
</span><a name="LN5290"></a>                     <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>distinctList</span><span class='Delimiter'>, 
</span><a name="LN5291"></a>                     <span class='Keyword'>long </span><span class='Declare_Parameter'>numGroups</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5293"></a>    <a href="../../../include/nodes/plannodes.h.html#LN279"><span class='Ref_to_Struct'>RecursiveUnion</span></a> <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN279"><span class='Ref_to_Struct'>RecursiveUnion</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5294"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN5293"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN281"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span><a name="LN5295"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>numCols</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5290"><span class='Ref_to_Parameter'>distinctList</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN5294"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5286"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5294"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5294"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5287"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5294"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5288"><span class='Ref_to_Parameter'>righttree</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5293"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN282"><span class='Ref_to_Member'>wtParam</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5289"><span class='Ref_to_Parameter'>wtParam</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * convert SortGroupClause list into arrays of attr indexes and equality 
     * operators, as wanted by executor 
     */ 
</span>    <a href="createplan.c.html#LN5293"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN284"><span class='Ref_to_Member'>numCols</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5295"><span class='Ref_To_Local'>numCols</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN5295"><span class='Ref_To_Local'>numCols</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN5310"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>keyno</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN5311"></a>        <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Local'>dupColIdx</span><span class='Delimiter'>; 
</span><a name="LN5312"></a>        <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>dupOperators</span><span class='Delimiter'>; 
</span><a name="LN5313"></a>        <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>slitem</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN5311"><span class='Ref_To_Local'>dupColIdx</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="createplan.c.html#LN5295"><span class='Ref_To_Local'>numCols</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN5312"><span class='Ref_To_Local'>dupOperators</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="createplan.c.html#LN5295"><span class='Ref_To_Local'>numCols</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5313"><span class='Ref_To_Local'>slitem</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5290"><span class='Ref_to_Parameter'>distinctList</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN5320"></a>            <a href="../../../include/nodes/parsenodes.h.html#LN1161"><span class='Ref_to_Struct'>SortGroupClause</span></a> <span class='Operator'>*</span><span class='Declare_Local'>sortcl</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/parsenodes.h.html#LN1161"><span class='Ref_to_Struct'>SortGroupClause</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5313"><span class='Ref_To_Local'>slitem</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5321"></a>            <a href="../../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>tle</span> <span class='Operator'>= </span><a href="../../../include/optimizer/tlist.h.html#LN37"><span class='Ref_to_Proto'>get_sortgroupclause_tle</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5320"><span class='Ref_To_Local'>sortcl</span></a><span class='Delimiter'>, 
</span>                                                       <a href="createplan.c.html#LN5294"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="createplan.c.html#LN5311"><span class='Ref_To_Local'>dupColIdx</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN5310"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN5321"><span class='Ref_To_Local'>tle</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN1367"><span class='Ref_to_Member'>resno</span></a><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN5312"><span class='Ref_To_Local'>dupOperators</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN5310"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN5320"><span class='Ref_To_Local'>sortcl</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1165"><span class='Ref_to_Member'>eqop</span></a><span class='Delimiter'>; 
</span>            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5312"><span class='Ref_To_Local'>dupOperators</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN5310"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN5310"><span class='Ref_To_Local'>keyno</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="createplan.c.html#LN5293"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN286"><span class='Ref_to_Member'>dupColIdx</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5311"><span class='Ref_To_Local'>dupColIdx</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN5293"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN287"><span class='Ref_to_Member'>dupOperators</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5312"><span class='Ref_To_Local'>dupOperators</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if numCols&GT;0 &raquo; </span> 
    <a href="createplan.c.html#LN5293"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN288"><span class='Ref_to_Member'>numGroups</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5291"><span class='Ref_to_Parameter'>numGroups</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN5293"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_recursive_union &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN299"><span class='Ref_to_Struct'>BitmapAnd</span></a> <span class='Operator'>* 
</span><a name="LN5338"></a><span class='Declare_Function'>make_bitmap_and</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>bitmapplans</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5340"></a>    <a href="../../../include/nodes/plannodes.h.html#LN299"><span class='Ref_to_Struct'>BitmapAnd</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN299"><span class='Ref_to_Struct'>BitmapAnd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5341"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN5340"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN301"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN5341"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5341"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5341"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5341"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5340"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN302"><span class='Ref_to_Member'>bitmapplans</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5338"><span class='Ref_to_Parameter'>bitmapplans</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN5340"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN313"><span class='Ref_to_Struct'>BitmapOr</span></a> <span class='Operator'>* 
</span><a name="LN5353"></a><span class='Declare_Function'>make_bitmap_or</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>bitmapplans</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5355"></a>    <a href="../../../include/nodes/plannodes.h.html#LN313"><span class='Ref_to_Struct'>BitmapOr</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN313"><span class='Ref_to_Struct'>BitmapOr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5356"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN5355"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN315"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN5356"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5356"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5356"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5356"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5355"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN317"><span class='Ref_to_Member'>bitmapplans</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5353"><span class='Ref_to_Parameter'>bitmapplans</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN5355"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN684"><span class='Ref_to_Struct'>NestLoop</span></a> <span class='Operator'>* 
</span><a name="LN5368"></a><span class='Declare_Function'>make_nestloop</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, 
</span><a name="LN5369"></a>              <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinclauses</span><span class='Delimiter'>, 
</span><a name="LN5370"></a>              <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>otherclauses</span><span class='Delimiter'>, 
</span><a name="LN5371"></a>              <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>nestParams</span><span class='Delimiter'>, 
</span><a name="LN5372"></a>              <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, 
</span><a name="LN5373"></a>              <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>righttree</span><span class='Delimiter'>, 
</span><a name="LN5374"></a>              <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, 
</span><a name="LN5375"></a>              <span class='Keyword'>bool </span><span class='Declare_Parameter'>inner_unique</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5377"></a>    <a href="../../../include/nodes/plannodes.h.html#LN684"><span class='Ref_to_Struct'>NestLoop</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN684"><span class='Ref_to_Struct'>NestLoop</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5378"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN5377"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN686"><span class='Ref_to_Member'>join</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN667"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN5378"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5368"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5378"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5370"><span class='Ref_to_Parameter'>otherclauses</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5378"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5372"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5378"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5373"><span class='Ref_to_Parameter'>righttree</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5377"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN686"><span class='Ref_to_Member'>join</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN668"><span class='Ref_to_Member'>jointype</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5374"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5377"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN686"><span class='Ref_to_Member'>join</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN669"><span class='Ref_to_Member'>inner_unique</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5375"><span class='Ref_to_Parameter'>inner_unique</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5377"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN686"><span class='Ref_to_Member'>join</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN670"><span class='Ref_to_Member'>joinqual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5369"><span class='Ref_to_Parameter'>joinclauses</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5377"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN687"><span class='Ref_to_Member'>nestParams</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5371"><span class='Ref_to_Parameter'>nestParams</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN5377"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_nestloop &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN724"><span class='Ref_to_Struct'>HashJoin</span></a> <span class='Operator'>* 
</span><a name="LN5393"></a><span class='Declare_Function'>make_hashjoin</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, 
</span><a name="LN5394"></a>              <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinclauses</span><span class='Delimiter'>, 
</span><a name="LN5395"></a>              <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>otherclauses</span><span class='Delimiter'>, 
</span><a name="LN5396"></a>              <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>hashclauses</span><span class='Delimiter'>, 
</span><a name="LN5397"></a>              <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, 
</span><a name="LN5398"></a>              <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>righttree</span><span class='Delimiter'>, 
</span><a name="LN5399"></a>              <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, 
</span><a name="LN5400"></a>              <span class='Keyword'>bool </span><span class='Declare_Parameter'>inner_unique</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5402"></a>    <a href="../../../include/nodes/plannodes.h.html#LN724"><span class='Ref_to_Struct'>HashJoin</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN724"><span class='Ref_to_Struct'>HashJoin</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5403"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN5402"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN726"><span class='Ref_to_Member'>join</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN667"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN5403"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5393"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5403"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5395"><span class='Ref_to_Parameter'>otherclauses</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5403"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5397"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5403"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5398"><span class='Ref_to_Parameter'>righttree</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5402"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN727"><span class='Ref_to_Member'>hashclauses</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5396"><span class='Ref_to_Parameter'>hashclauses</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5402"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN726"><span class='Ref_to_Member'>join</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN668"><span class='Ref_to_Member'>jointype</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5399"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5402"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN726"><span class='Ref_to_Member'>join</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN669"><span class='Ref_to_Member'>inner_unique</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5400"><span class='Ref_to_Parameter'>inner_unique</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5402"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN726"><span class='Ref_to_Member'>join</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN670"><span class='Ref_to_Member'>joinqual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5394"><span class='Ref_to_Parameter'>joinclauses</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN5402"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_hashjoin &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN863"><span class='Ref_to_Struct'>Hash</span></a> <span class='Operator'>* 
</span><a name="LN5418"></a><span class='Declare_Function'>make_hash</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, 
</span><a name="LN5419"></a>          <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>skewTable</span><span class='Delimiter'>, 
</span><a name="LN5420"></a>          <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Declare_Parameter'>skewColumn</span><span class='Delimiter'>, 
</span><a name="LN5421"></a>          <span class='Keyword'>bool </span><span class='Declare_Parameter'>skewInherit</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5423"></a>    <a href="../../../include/nodes/plannodes.h.html#LN863"><span class='Ref_to_Struct'>Hash</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN863"><span class='Ref_to_Struct'>Hash</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5424"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN5423"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN865"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN5424"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5418"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5424"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5424"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5418"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5424"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN5423"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN866"><span class='Ref_to_Member'>skewTable</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5419"><span class='Ref_to_Parameter'>skewTable</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5423"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN867"><span class='Ref_to_Member'>skewColumn</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5420"><span class='Ref_to_Parameter'>skewColumn</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5423"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN868"><span class='Ref_to_Member'>skewInherit</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5421"><span class='Ref_to_Parameter'>skewInherit</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN5423"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_hash &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN708"><span class='Ref_to_Struct'>MergeJoin</span></a> <span class='Operator'>* 
</span><a name="LN5439"></a><span class='Declare_Function'>make_mergejoin</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, 
</span><a name="LN5440"></a>               <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinclauses</span><span class='Delimiter'>, 
</span><a name="LN5441"></a>               <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>otherclauses</span><span class='Delimiter'>, 
</span><a name="LN5442"></a>               <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>mergeclauses</span><span class='Delimiter'>, 
</span><a name="LN5443"></a>               <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>mergefamilies</span><span class='Delimiter'>, 
</span><a name="LN5444"></a>               <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>mergecollations</span><span class='Delimiter'>, 
</span><a name="LN5445"></a>               <span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>mergestrategies</span><span class='Delimiter'>, 
</span><a name="LN5446"></a>               <span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>mergenullsfirst</span><span class='Delimiter'>, 
</span><a name="LN5447"></a>               <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, 
</span><a name="LN5448"></a>               <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>righttree</span><span class='Delimiter'>, 
</span><a name="LN5449"></a>               <a href="../../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, 
</span><a name="LN5450"></a>               <span class='Keyword'>bool </span><span class='Declare_Parameter'>inner_unique</span><span class='Delimiter'>, 
</span><a name="LN5451"></a>               <span class='Keyword'>bool </span><span class='Declare_Parameter'>skip_mark_restore</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5453"></a>    <a href="../../../include/nodes/plannodes.h.html#LN708"><span class='Ref_to_Struct'>MergeJoin</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN708"><span class='Ref_to_Struct'>MergeJoin</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5454"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN5453"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN710"><span class='Ref_to_Member'>join</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN667"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN5454"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5439"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5454"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5441"><span class='Ref_to_Parameter'>otherclauses</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5454"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5447"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5454"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5448"><span class='Ref_to_Parameter'>righttree</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5453"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN711"><span class='Ref_to_Member'>skip_mark_restore</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5451"><span class='Ref_to_Parameter'>skip_mark_restore</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5453"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN712"><span class='Ref_to_Member'>mergeclauses</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5442"><span class='Ref_to_Parameter'>mergeclauses</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5453"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN714"><span class='Ref_to_Member'>mergeFamilies</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5443"><span class='Ref_to_Parameter'>mergefamilies</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5453"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN715"><span class='Ref_to_Member'>mergeCollations</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5444"><span class='Ref_to_Parameter'>mergecollations</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5453"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN716"><span class='Ref_to_Member'>mergeStrategies</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5445"><span class='Ref_to_Parameter'>mergestrategies</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5453"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN717"><span class='Ref_to_Member'>mergeNullsFirst</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5446"><span class='Ref_to_Parameter'>mergenullsfirst</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5453"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN710"><span class='Ref_to_Member'>join</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN668"><span class='Ref_to_Member'>jointype</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5449"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5453"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN710"><span class='Ref_to_Member'>join</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN669"><span class='Ref_to_Member'>inner_unique</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5450"><span class='Ref_to_Parameter'>inner_unique</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5453"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN710"><span class='Ref_to_Member'>join</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN670"><span class='Ref_to_Member'>joinqual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5440"><span class='Ref_to_Parameter'>joinclauses</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN5453"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_mergejoin &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * make_sort --- basic routine to build a Sort plan node 
 * 
 * Caller must have built the sortColIdx, sortOperators, collations, and 
 * nullsFirst arrays already. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN743"><span class='Ref_to_Struct'>Sort</span></a> <span class='Operator'>* 
</span><a name="LN5480"></a><span class='Declare_Function'>make_sort</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>numCols</span><span class='Delimiter'>, 
</span><a name="LN5481"></a>          <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>sortColIdx</span><span class='Delimiter'>, </span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>sortOperators</span><span class='Delimiter'>, 
</span><a name="LN5482"></a>          <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>collations</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>nullsFirst</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5484"></a>    <a href="../../../include/nodes/plannodes.h.html#LN743"><span class='Ref_to_Struct'>Sort</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN743"><span class='Ref_to_Struct'>Sort</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5485"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN5484"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN745"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN5485"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5480"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5485"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5485"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5480"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5485"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5484"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN746"><span class='Ref_to_Member'>numCols</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5480"><span class='Ref_to_Parameter'>numCols</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5484"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN747"><span class='Ref_to_Member'>sortColIdx</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5481"><span class='Ref_to_Parameter'>sortColIdx</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5484"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN748"><span class='Ref_to_Member'>sortOperators</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5481"><span class='Ref_to_Parameter'>sortOperators</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5484"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN749"><span class='Ref_to_Member'>collations</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5482"><span class='Ref_to_Parameter'>collations</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5484"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN750"><span class='Ref_to_Member'>nullsFirst</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5482"><span class='Ref_to_Parameter'>nullsFirst</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN5484"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_sort &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * prepare_sort_from_pathkeys 
 *    Prepare to sort according to given pathkeys 
 * 
 * This is used to set up for Sort, MergeAppend, and Gather Merge nodes.  It 
 * calculates the executor's representation of the sort key information, and 
 * adjusts the plan targetlist if needed to add resjunk sort columns. 
 * 
 * Input parameters: 
 *    'lefttree' is the plan node which yields input tuples 
 *    'pathkeys' is the list of pathkeys by which the result is to be sorted 
 *    'relids' identifies the child relation being sorted, if any 
 *    'reqColIdx' is NULL or an array of required sort key column numbers 
 *    'adjust_tlist_in_place' is TRUE if lefttree must be modified in-place 
 * 
 * We must convert the pathkey information into arrays of sort key column 
 * numbers, sort operator OIDs, collation OIDs, and nulls-first flags, 
 * which is the representation the executor wants.  These are returned into 
 * the output parameters *p_numsortkeys etc. 
 * 
 * When looking for matches to an EquivalenceClass's members, we will only 
 * consider child EC members if they match 'relids'.  This protects against 
 * possible incorrect matches to child expressions that contain no Vars. 
 * 
 * If reqColIdx isn't NULL then it contains sort key column numbers that 
 * we should match.  This is used when making child plans for a MergeAppend; 
 * it's an error if we can't match the columns. 
 * 
 * If the pathkeys include expressions that aren't simple Vars, we will 
 * usually need to add resjunk items to the input plan's targetlist to 
 * compute these expressions, since a Sort or MergeAppend node itself won't 
 * do any such calculations.  If the input plan type isn't one that can do 
 * projections, this means adding a Result node just to do the projection. 
 * However, the caller can pass adjust_tlist_in_place = TRUE to force the 
 * lefttree tlist to be modified in-place regardless of whether the node type 
 * can project --- we use this for fixing the tlist of MergeAppend itself. 
 * 
 * Returns the node which is to be the input to the Sort (either lefttree, 
 * or a Result stacked atop lefttree). 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>* 
</span><a name="LN5541"></a><span class='Declare_Function'>prepare_sort_from_pathkeys</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pathkeys</span><span class='Delimiter'>, 
</span><a name="LN5542"></a>                           <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a> <span class='Declare_Parameter'>relids</span><span class='Delimiter'>, 
</span><a name="LN5543"></a>                           <span class='Keyword'>const </span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>reqColIdx</span><span class='Delimiter'>, 
</span><a name="LN5544"></a>                           <span class='Keyword'>bool </span><span class='Declare_Parameter'>adjust_tlist_in_place</span><span class='Delimiter'>, 
</span><a name="LN5545"></a>                           <span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>p_numsortkeys</span><span class='Delimiter'>, 
</span><a name="LN5546"></a>                           <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>p_sortColIdx</span><span class='Delimiter'>, 
</span><a name="LN5547"></a>                           <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>p_sortOperators</span><span class='Delimiter'>, 
</span><a name="LN5548"></a>                           <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>p_collations</span><span class='Delimiter'>, 
</span><a name="LN5549"></a>                           <span class='Keyword'>bool </span><span class='Operator'>**</span><span class='Declare_Parameter'>p_nullsFirst</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5551"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>tlist</span> <span class='Operator'>= </span><a href="createplan.c.html#LN5541"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Delimiter'>; 
</span><a name="LN5552"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN5553"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>numsortkeys</span><span class='Delimiter'>; 
</span><a name="LN5554"></a>    <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Local'>sortColIdx</span><span class='Delimiter'>; 
</span><a name="LN5555"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>sortOperators</span><span class='Delimiter'>; 
</span><a name="LN5556"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>collations</span><span class='Delimiter'>; 
</span><a name="LN5557"></a>    <span class='Keyword'>bool</span>       <span class='Operator'>*</span><span class='Declare_Local'>nullsFirst</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We will need at most list_length(pathkeys) sort columns; possibly less 
     */ 
</span>    <a href="createplan.c.html#LN5553"><span class='Ref_To_Local'>numsortkeys</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5541"><span class='Ref_to_Parameter'>pathkeys</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5554"><span class='Ref_To_Local'>sortColIdx</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5553"><span class='Ref_To_Local'>numsortkeys</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5555"><span class='Ref_To_Local'>sortOperators</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5553"><span class='Ref_To_Local'>numsortkeys</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5556"><span class='Ref_To_Local'>collations</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5553"><span class='Ref_To_Local'>numsortkeys</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5557"><span class='Ref_To_Local'>nullsFirst</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5553"><span class='Ref_To_Local'>numsortkeys</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Keyword'>bool</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN5553"><span class='Ref_To_Local'>numsortkeys</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5552"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5541"><span class='Ref_to_Parameter'>pathkeys</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN5572"></a>        <a href="../../../include/nodes/relation.h.html#LN845"><span class='Ref_to_Struct'>PathKey</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>pathkey</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN845"><span class='Ref_to_Struct'>PathKey</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5552"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5573"></a>        <a href="../../../include/nodes/relation.h.html#LN766"><span class='Ref_to_Struct'>EquivalenceClass</span></a> <span class='Operator'>*</span><span class='Declare_Local'>ec</span> <span class='Operator'>= </span><a href="createplan.c.html#LN5572"><span class='Ref_To_Local'>pathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN849"><span class='Ref_to_Member'>pk_eclass</span></a><span class='Delimiter'>; 
</span><a name="LN5574"></a>        <a href="../../../include/nodes/relation.h.html#LN816"><span class='Ref_to_Struct'>EquivalenceMember</span></a> <span class='Operator'>*</span><span class='Declare_Local'>em</span><span class='Delimiter'>; 
</span><a name="LN5575"></a>        <a href="../../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>tle</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN5576"></a>        <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>pk_datatype</span> <span class='Operator'>= </span><a href="../../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span><a name="LN5577"></a>        <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>sortop</span><span class='Delimiter'>; 
</span><a name="LN5578"></a>        <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN5573"><span class='Ref_To_Local'>ec</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN778"><span class='Ref_to_Member'>ec_has_volatile</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * If the pathkey's EquivalenceClass is volatile, then it must 
             * have come from an ORDER BY clause, and we have to match it to 
             * that same targetlist entry. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN5573"><span class='Ref_To_Local'>ec</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN781"><span class='Ref_to_Member'>ec_sortref</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span>    <span class='Comment_Single_Line'>/* can't happen */ 
</span>                <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"volatile EquivalenceClass has no sortref"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN5575"><span class='Ref_To_Local'>tle</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/tlist.h.html#LN35"><span class='Ref_to_Proto'>get_sortgroupref_tle</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5573"><span class='Ref_To_Local'>ec</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN781"><span class='Ref_to_Member'>ec_sortref</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5551"><span class='Ref_To_Local'>tlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN5575"><span class='Ref_To_Local'>tle</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5573"><span class='Ref_To_Local'>ec</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN772"><span class='Ref_to_Member'>ec_members</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN5576"><span class='Ref_To_Local'>pk_datatype</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="../../../include/nodes/relation.h.html#LN816"><span class='Ref_to_Struct'>EquivalenceMember</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5573"><span class='Ref_To_Local'>ec</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN772"><span class='Ref_to_Member'>ec_members</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>em_datatype<span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN5543"><span class='Ref_to_Parameter'>reqColIdx</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * If we are given a sort column number to match, only consider 
             * the single TLE at that position.  It's possible that there is 
             * no such TLE, in which case fall through and generate a resjunk 
             * targetentry (we assume this must have happened in the parent 
             * plan as well).  If there is a TLE but it doesn't match the 
             * pathkey's EC, we do the same, which is probably the wrong thing 
             * but we'll leave it to caller to complain about the mismatch. 
             */ 
</span>            <a href="createplan.c.html#LN5575"><span class='Ref_To_Local'>tle</span></a> <span class='Operator'>= </span><a href="../../../include/parser/parsetree.h.html#LN69"><span class='Ref_to_Proto'>get_tle_by_resno</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5551"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5543"><span class='Ref_to_Parameter'>reqColIdx</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN5553"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN5575"><span class='Ref_To_Local'>tle</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="createplan.c.html#LN5574"><span class='Ref_To_Local'>em</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN249"><span class='Ref_to_Proto'>find_ec_member_for_tle</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5573"><span class='Ref_To_Local'>ec</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5575"><span class='Ref_To_Local'>tle</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5542"><span class='Ref_to_Parameter'>relids</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN5574"><span class='Ref_To_Local'>em</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Comment_Multi_Line'>/* found expr at right place in tlist */ 
</span>                    <a href="createplan.c.html#LN5576"><span class='Ref_To_Local'>pk_datatype</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5574"><span class='Ref_To_Local'>em</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN825"><span class='Ref_to_Member'>em_datatype</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                    <a href="createplan.c.html#LN5575"><span class='Ref_To_Local'>tle</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if reqColIdx!=NULL &raquo; </span> 
        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * Otherwise, we can sort by any non-constant expression listed in 
             * the pathkey's EquivalenceClass.  For now, we take the first 
             * tlist item found in the EC. If there's no match, we'll generate 
             * a resjunk entry using the first EC member that is an expression 
             * in the input's vars.  (The non-const restriction only matters 
             * if the EC is below_outer_join; but if it isn't, it won't 
             * contain consts anyway, else we'd have discarded the pathkey as 
             * redundant.) 
             * 
             * XXX if we have a choice, is there any way of figuring out which 
             * might be cheapest to execute?  (For example, int4lt is likely 
             * much cheaper to execute than numericlt, but both might appear 
             * in the same equivalence class...)  Not clear that we ever will 
             * have an interesting choice in practice, so it may not matter. 
             */ 
</span>            <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5578"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5551"><span class='Ref_To_Local'>tlist</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="createplan.c.html#LN5575"><span class='Ref_To_Local'>tle</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5578"><span class='Ref_To_Local'>j</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="createplan.c.html#LN5574"><span class='Ref_To_Local'>em</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN249"><span class='Ref_to_Proto'>find_ec_member_for_tle</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5573"><span class='Ref_To_Local'>ec</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5575"><span class='Ref_To_Local'>tle</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5542"><span class='Ref_to_Parameter'>relids</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN5574"><span class='Ref_To_Local'>em</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Comment_Multi_Line'>/* found expr already in tlist */ 
</span>                    <a href="createplan.c.html#LN5576"><span class='Ref_To_Local'>pk_datatype</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5574"><span class='Ref_To_Local'>em</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN825"><span class='Ref_to_Member'>em_datatype</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <a href="createplan.c.html#LN5575"><span class='Ref_To_Local'>tle</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="createplan.c.html#LN5575"><span class='Ref_To_Local'>tle</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * No matching tlist item; look for a computable expression. Note 
             * that we treat Aggrefs as if they were variables; this is 
             * necessary when attempting to sort the output from an Agg node 
             * for use in a WindowFunc (since grouping_planner will have 
             * treated the Aggrefs as variables, too).  Likewise, if we find a 
             * WindowFunc in a sort expression, treat it as a variable. 
             */ 
</span><a name="LN5660"></a>            <a href="../../../include/nodes/primnodes.h.html#LN131"><span class='Ref_to_Struct'>Expr</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>sortexpr</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
            <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5578"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5573"><span class='Ref_To_Local'>ec</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN772"><span class='Ref_to_Member'>ec_members</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN5664"></a>                <a href="../../../include/nodes/relation.h.html#LN816"><span class='Ref_to_Struct'>EquivalenceMember</span></a> <span class='Operator'>*</span><span class='Declare_Local'>em</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN816"><span class='Ref_to_Struct'>EquivalenceMember</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5578"><span class='Ref_To_Local'>j</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5665"></a>                <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>exprvars</span><span class='Delimiter'>; 
</span><a name="LN5666"></a>                <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>k</span><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* 
                 * We shouldn't be trying to sort by an equivalence class that 
                 * contains a constant, so no need to consider such cases any 
                 * further. 
                 */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN5664"><span class='Ref_To_Local'>em</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN823"><span class='Ref_to_Member'>em_is_const</span></a><span class='Parentheses'>) 
</span>                    <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* 
                 * Ignore child members unless they match the rel being 
                 * sorted. 
                 */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN5664"><span class='Ref_To_Local'>em</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN824"><span class='Ref_to_Member'>em_is_child</span></a> <span class='Operator'>&& 
</span>                    <span class='Operator'>!</span><a href="../../../include/nodes/bitmapset.h.html#LN66"><span class='Ref_to_Proto'>bms_equal</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5664"><span class='Ref_To_Local'>em</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN821"><span class='Ref_to_Member'>em_relids</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5542"><span class='Ref_to_Parameter'>relids</span></a><span class='Parentheses'>))</span> 
                    <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
                <a href="createplan.c.html#LN5660"><span class='Ref_To_Local'>sortexpr</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5664"><span class='Ref_To_Local'>em</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN820"><span class='Ref_to_Member'>em_expr</span></a><span class='Delimiter'>; 
</span>                <a href="createplan.c.html#LN5665"><span class='Ref_To_Local'>exprvars</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/var.h.html#LN36"><span class='Ref_to_Proto'>pull_var_clause</span></a><span class='Parentheses'>((</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN5660"><span class='Ref_To_Local'>sortexpr</span></a><span class='Delimiter'>, 
</span>                                           <a href="../../../include/optimizer/var.h.html#LN19"><span class='Ref_to_Const'>PVC_INCLUDE_AGGREGATES</span></a> <span class='Operator'>| 
</span>                                           <a href="../../../include/optimizer/var.h.html#LN21"><span class='Ref_to_Const'>PVC_INCLUDE_WINDOWFUNCS</span></a> <span class='Operator'>| 
</span>                                           <a href="../../../include/optimizer/var.h.html#LN23"><span class='Ref_to_Const'>PVC_INCLUDE_PLACEHOLDERS</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5666"><span class='Ref_To_Local'>k</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5665"><span class='Ref_To_Local'>exprvars</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/optimizer/tlist.h.html#LN20"><span class='Ref_to_Proto'>tlist_member_ignore_relabel</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5666"><span class='Ref_To_Local'>k</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="createplan.c.html#LN5551"><span class='Ref_To_Local'>tlist</span></a><span class='Parentheses'>))</span> 
                        <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <a href="../../../include/nodes/pg_list.h.html#LN265"><span class='Ref_to_Proto'>list_free</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5665"><span class='Ref_To_Local'>exprvars</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="createplan.c.html#LN5666"><span class='Ref_To_Local'>k</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <a href="createplan.c.html#LN5576"><span class='Ref_To_Local'>pk_datatype</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5664"><span class='Ref_To_Local'>em</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN825"><span class='Ref_to_Member'>em_datatype</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>;</span>      <span class='Comment_Single_Line'>/* found usable expression */ 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="createplan.c.html#LN5578"><span class='Ref_To_Local'>j</span></a><span class='Parentheses'>) 
</span>                <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"could not find pathkey item to sort"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Do we need to insert a Result node? 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="createplan.c.html#LN5544"><span class='Ref_to_Parameter'>adjust_tlist_in_place</span></a> <span class='Operator'>&& 
</span>                <span class='Operator'>!</span><a href="../../../include/optimizer/planmain.h.html#LN56"><span class='Ref_to_Proto'>is_projection_capable_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5541"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* copy needed so we don't modify input's tlist below */ 
</span>                <a href="createplan.c.html#LN5551"><span class='Ref_To_Local'>tlist</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN618"><span class='Ref_to_Macro'>copyObject</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5551"><span class='Ref_To_Local'>tlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="createplan.c.html#LN5541"><span class='Ref_to_Parameter'>lefttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN90"><span class='Ref_to_Proto'>inject_projection_plan</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5541"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5551"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, 
</span>                                                  <a href="createplan.c.html#LN5541"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN137"><span class='Ref_to_Member'>parallel_safe</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Comment_Multi_Line'>/* Don't bother testing is_projection_capable_plan again */ 
</span>            <a href="createplan.c.html#LN5544"><span class='Ref_to_Parameter'>adjust_tlist_in_place</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Add resjunk entry to input's tlist 
             */ 
</span>            <a href="createplan.c.html#LN5575"><span class='Ref_To_Local'>tle</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/makefuncs.h.html#LN40"><span class='Ref_to_Proto'>makeTargetEntry</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5660"><span class='Ref_To_Local'>sortexpr</span></a><span class='Delimiter'>, 
</span>                                  <a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5551"><span class='Ref_To_Local'>tlist</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>, 
</span>                                  <span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                                  <span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN5551"><span class='Ref_To_Local'>tlist</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5551"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5575"><span class='Ref_To_Local'>tle</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN5541"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5551"><span class='Ref_To_Local'>tlist</span></a><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* just in case NIL before */ 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if !tle &raquo; </span> 
 
        <span class='Comment_Multi_Line'>/* 
         * Look up the correct sort operator from the PathKey's slightly 
         * abstracted representation. 
         */ 
</span>        <a href="createplan.c.html#LN5577"><span class='Ref_To_Local'>sortop</span></a> <span class='Operator'>= </span><a href="../../../include/utils/lsyscache.h.html#LN70"><span class='Ref_to_Proto'>get_opfamily_member</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5572"><span class='Ref_To_Local'>pathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN850"><span class='Ref_to_Member'>pk_opfamily</span></a><span class='Delimiter'>, 
</span>                                     <a href="createplan.c.html#LN5576"><span class='Ref_To_Local'>pk_datatype</span></a><span class='Delimiter'>, 
</span>                                     <a href="createplan.c.html#LN5576"><span class='Ref_To_Local'>pk_datatype</span></a><span class='Delimiter'>, 
</span>                                     <a href="createplan.c.html#LN5572"><span class='Ref_To_Local'>pathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN851"><span class='Ref_to_Member'>pk_strategy</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5577"><span class='Ref_To_Local'>sortop</span></a><span class='Parentheses'>))</span>    <span class='Comment_Single_Line'>/* should not happen */ 
</span>            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"could not find member %d(%u,%u) of opfamily %u"</span><span class='Delimiter'>, 
</span>                 <a href="createplan.c.html#LN5572"><span class='Ref_To_Local'>pathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN851"><span class='Ref_to_Member'>pk_strategy</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5576"><span class='Ref_To_Local'>pk_datatype</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5576"><span class='Ref_To_Local'>pk_datatype</span></a><span class='Delimiter'>, 
</span>                 <a href="createplan.c.html#LN5572"><span class='Ref_To_Local'>pathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN850"><span class='Ref_to_Member'>pk_opfamily</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Add the column to the sort arrays */ 
</span>        <a href="createplan.c.html#LN5554"><span class='Ref_To_Local'>sortColIdx</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN5553"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN5575"><span class='Ref_To_Local'>tle</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN1367"><span class='Ref_to_Member'>resno</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN5555"><span class='Ref_To_Local'>sortOperators</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN5553"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN5577"><span class='Ref_To_Local'>sortop</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN5556"><span class='Ref_To_Local'>collations</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN5553"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN5573"><span class='Ref_To_Local'>ec</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN771"><span class='Ref_to_Member'>ec_collation</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN5557"><span class='Ref_To_Local'>nullsFirst</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN5553"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN5572"><span class='Ref_To_Local'>pathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN852"><span class='Ref_to_Member'>pk_nulls_first</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN5553"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Return results */ 
</span>    <span class='Operator'>*</span><a href="createplan.c.html#LN5545"><span class='Ref_to_Parameter'>p_numsortkeys</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5553"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="createplan.c.html#LN5546"><span class='Ref_to_Parameter'>p_sortColIdx</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5554"><span class='Ref_To_Local'>sortColIdx</span></a><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="createplan.c.html#LN5547"><span class='Ref_to_Parameter'>p_sortOperators</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5555"><span class='Ref_To_Local'>sortOperators</span></a><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="createplan.c.html#LN5548"><span class='Ref_to_Parameter'>p_collations</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5556"><span class='Ref_To_Local'>collations</span></a><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="createplan.c.html#LN5549"><span class='Ref_to_Parameter'>p_nullsFirst</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5557"><span class='Ref_To_Local'>nullsFirst</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN5541"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end prepare_sort_from_pathkeys &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * find_ec_member_for_tle 
 *      Locate an EquivalenceClass member matching the given TLE, if any 
 * 
 * Child EC members are ignored unless they match 'relids'. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/relation.h.html#LN816"><span class='Ref_to_Struct'>EquivalenceMember</span></a> <span class='Operator'>* 
</span><a name="LN5768"></a><span class='Declare_Function'>find_ec_member_for_tle</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN766"><span class='Ref_to_Struct'>EquivalenceClass</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>ec</span><span class='Delimiter'>, 
</span><a name="LN5769"></a>                       <a href="../../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tle</span><span class='Delimiter'>, 
</span><a name="LN5770"></a>                       <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a> <span class='Declare_Parameter'>relids</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5772"></a>    <a href="../../../include/nodes/primnodes.h.html#LN131"><span class='Ref_to_Struct'>Expr</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>tlexpr</span><span class='Delimiter'>; 
</span><a name="LN5773"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* We ignore binary-compatible relabeling on both ends */ 
</span>    <a href="createplan.c.html#LN5772"><span class='Ref_To_Local'>tlexpr</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5769"><span class='Ref_to_Parameter'>tle</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN1366"><span class='Ref_to_Member'>expr</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN5772"><span class='Ref_To_Local'>tlexpr</span></a> <span class='Operator'>&& </span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5772"><span class='Ref_To_Local'>tlexpr</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/primnodes.h.html#LN786"><span class='Ref_to_Struct'>RelabelType</span></a><span class='Parentheses'>))</span> 
        <a href="createplan.c.html#LN5772"><span class='Ref_To_Local'>tlexpr</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="../../../include/nodes/primnodes.h.html#LN786"><span class='Ref_to_Struct'>RelabelType</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN5772"><span class='Ref_To_Local'>tlexpr</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>arg<span class='Delimiter'>; 
</span> 
    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5773"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5768"><span class='Ref_to_Parameter'>ec</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN772"><span class='Ref_to_Member'>ec_members</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN5782"></a>        <a href="../../../include/nodes/relation.h.html#LN816"><span class='Ref_to_Struct'>EquivalenceMember</span></a> <span class='Operator'>*</span><span class='Declare_Local'>em</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN816"><span class='Ref_to_Struct'>EquivalenceMember</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5773"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5783"></a>        <a href="../../../include/nodes/primnodes.h.html#LN131"><span class='Ref_to_Struct'>Expr</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>emexpr</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * We shouldn't be trying to sort by an equivalence class that 
         * contains a constant, so no need to consider such cases any further. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN5782"><span class='Ref_To_Local'>em</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN823"><span class='Ref_to_Member'>em_is_const</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Ignore child members unless they match the rel being sorted. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN5782"><span class='Ref_To_Local'>em</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN824"><span class='Ref_to_Member'>em_is_child</span></a> <span class='Operator'>&& 
</span>            <span class='Operator'>!</span><a href="../../../include/nodes/bitmapset.h.html#LN66"><span class='Ref_to_Proto'>bms_equal</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5782"><span class='Ref_To_Local'>em</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN821"><span class='Ref_to_Member'>em_relids</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5770"><span class='Ref_to_Parameter'>relids</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Match if same expression (after stripping relabel) */ 
</span>        <a href="createplan.c.html#LN5783"><span class='Ref_To_Local'>emexpr</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5782"><span class='Ref_To_Local'>em</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN820"><span class='Ref_to_Member'>em_expr</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN5783"><span class='Ref_To_Local'>emexpr</span></a> <span class='Operator'>&& </span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5783"><span class='Ref_To_Local'>emexpr</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/primnodes.h.html#LN786"><span class='Ref_to_Struct'>RelabelType</span></a><span class='Parentheses'>))</span> 
            <a href="createplan.c.html#LN5783"><span class='Ref_To_Local'>emexpr</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="../../../include/nodes/primnodes.h.html#LN786"><span class='Ref_to_Struct'>RelabelType</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN5783"><span class='Ref_To_Local'>emexpr</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>arg<span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN626"><span class='Ref_to_Proto'>equal</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5783"><span class='Ref_To_Local'>emexpr</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5772"><span class='Ref_To_Local'>tlexpr</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="createplan.c.html#LN5782"><span class='Ref_To_Local'>em</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end find_ec_member_for_tle &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * make_sort_from_pathkeys 
 *    Create sort plan to sort according to given pathkeys 
 * 
 *    'lefttree' is the node which yields input tuples 
 *    'pathkeys' is the list of pathkeys by which the result is to be sorted 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN743"><span class='Ref_to_Struct'>Sort</span></a> <span class='Operator'>* 
</span><a name="LN5819"></a><span class='Declare_Function'>make_sort_from_pathkeys</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pathkeys</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5821"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>numsortkeys</span><span class='Delimiter'>; 
</span><a name="LN5822"></a>    <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Local'>sortColIdx</span><span class='Delimiter'>; 
</span><a name="LN5823"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>sortOperators</span><span class='Delimiter'>; 
</span><a name="LN5824"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>collations</span><span class='Delimiter'>; 
</span><a name="LN5825"></a>    <span class='Keyword'>bool</span>       <span class='Operator'>*</span><span class='Declare_Local'>nullsFirst</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Compute sort column info, and adjust lefttree as needed */ 
</span>    <a href="createplan.c.html#LN5819"><span class='Ref_to_Parameter'>lefttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN240"><span class='Ref_to_Proto'>prepare_sort_from_pathkeys</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5819"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5819"><span class='Ref_to_Parameter'>pathkeys</span></a><span class='Delimiter'>, 
</span>                                          <span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                                          <span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                                          <span class='Boolean'>false</span><span class='Delimiter'>, 
</span>                                          <span class='Operator'>&</span><a href="createplan.c.html#LN5821"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Delimiter'>, 
</span>                                          <span class='Operator'>&</span><a href="createplan.c.html#LN5822"><span class='Ref_To_Local'>sortColIdx</span></a><span class='Delimiter'>, 
</span>                                          <span class='Operator'>&</span><a href="createplan.c.html#LN5823"><span class='Ref_To_Local'>sortOperators</span></a><span class='Delimiter'>, 
</span>                                          <span class='Operator'>&</span><a href="createplan.c.html#LN5824"><span class='Ref_To_Local'>collations</span></a><span class='Delimiter'>, 
</span>                                          <span class='Operator'>&</span><a href="createplan.c.html#LN5825"><span class='Ref_To_Local'>nullsFirst</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Now build the Sort node */ 
</span>    <span class='Control'>return</span> <a href="createplan.c.html#LN237"><span class='Ref_to_Proto'>make_sort</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5819"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5821"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Delimiter'>, 
</span>                     <a href="createplan.c.html#LN5822"><span class='Ref_To_Local'>sortColIdx</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5823"><span class='Ref_To_Local'>sortOperators</span></a><span class='Delimiter'>, 
</span>                     <a href="createplan.c.html#LN5824"><span class='Ref_To_Local'>collations</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5825"><span class='Ref_To_Local'>nullsFirst</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_sort_from_pathkeys &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * make_sort_from_sortclauses 
 *    Create sort plan to sort according to given sortclauses 
 * 
 *    'sortcls' is a list of SortGroupClauses 
 *    'lefttree' is the node which yields input tuples 
 */ 
</span><a href="../../../include/nodes/plannodes.h.html#LN743"><span class='Ref_to_Struct'>Sort</span></a> <span class='Operator'>* 
</span><a name="LN5852"></a><span class='Declare_Function'>make_sort_from_sortclauses</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>sortcls</span><span class='Delimiter'>, </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5854"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>sub_tlist</span> <span class='Operator'>= </span><a href="createplan.c.html#LN5852"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Delimiter'>; 
</span><a name="LN5855"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span><a name="LN5856"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>numsortkeys</span><span class='Delimiter'>; 
</span><a name="LN5857"></a>    <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Local'>sortColIdx</span><span class='Delimiter'>; 
</span><a name="LN5858"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>sortOperators</span><span class='Delimiter'>; 
</span><a name="LN5859"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>collations</span><span class='Delimiter'>; 
</span><a name="LN5860"></a>    <span class='Keyword'>bool</span>       <span class='Operator'>*</span><span class='Declare_Local'>nullsFirst</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Convert list-ish representation to arrays wanted by executor */ 
</span>    <a href="createplan.c.html#LN5856"><span class='Ref_To_Local'>numsortkeys</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5852"><span class='Ref_to_Parameter'>sortcls</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5857"><span class='Ref_To_Local'>sortColIdx</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5856"><span class='Ref_To_Local'>numsortkeys</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5858"><span class='Ref_To_Local'>sortOperators</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5856"><span class='Ref_To_Local'>numsortkeys</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5859"><span class='Ref_To_Local'>collations</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5856"><span class='Ref_To_Local'>numsortkeys</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5860"><span class='Ref_To_Local'>nullsFirst</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5856"><span class='Ref_To_Local'>numsortkeys</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Keyword'>bool</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN5856"><span class='Ref_To_Local'>numsortkeys</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5855"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5852"><span class='Ref_to_Parameter'>sortcls</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN5872"></a>        <a href="../../../include/nodes/parsenodes.h.html#LN1161"><span class='Ref_to_Struct'>SortGroupClause</span></a> <span class='Operator'>*</span><span class='Declare_Local'>sortcl</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/parsenodes.h.html#LN1161"><span class='Ref_to_Struct'>SortGroupClause</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5855"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5873"></a>        <a href="../../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>tle</span> <span class='Operator'>= </span><a href="../../../include/optimizer/tlist.h.html#LN37"><span class='Ref_to_Proto'>get_sortgroupclause_tle</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5872"><span class='Ref_To_Local'>sortcl</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5854"><span class='Ref_To_Local'>sub_tlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN5857"><span class='Ref_To_Local'>sortColIdx</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN5856"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN5873"><span class='Ref_To_Local'>tle</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN1367"><span class='Ref_to_Member'>resno</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN5858"><span class='Ref_To_Local'>sortOperators</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN5856"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN5872"><span class='Ref_To_Local'>sortcl</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1166"><span class='Ref_to_Member'>sortop</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN5859"><span class='Ref_To_Local'>collations</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN5856"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/nodes/nodeFuncs.h.html#LN38"><span class='Ref_to_Proto'>exprCollation</span></a><span class='Parentheses'>((</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN5873"><span class='Ref_To_Local'>tle</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN1366"><span class='Ref_to_Member'>expr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN5860"><span class='Ref_To_Local'>nullsFirst</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN5856"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN5872"><span class='Ref_To_Local'>sortcl</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1167"><span class='Ref_to_Member'>nulls_first</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN5856"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN237"><span class='Ref_to_Proto'>make_sort</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5852"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5856"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Delimiter'>, 
</span>                     <a href="createplan.c.html#LN5857"><span class='Ref_To_Local'>sortColIdx</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5858"><span class='Ref_To_Local'>sortOperators</span></a><span class='Delimiter'>, 
</span>                     <a href="createplan.c.html#LN5859"><span class='Ref_To_Local'>collations</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5860"><span class='Ref_To_Local'>nullsFirst</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_sort_from_sortclauses &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * make_sort_from_groupcols 
 *    Create sort plan to sort based on grouping columns 
 * 
 * 'groupcls' is the list of SortGroupClauses 
 * 'grpColIdx' gives the column numbers to use 
 * 
 * This might look like it could be merged with make_sort_from_sortclauses, 
 * but presently we *must* use the grpColIdx[] array to locate sort columns, 
 * because the child plan's tlist is not marked with ressortgroupref info 
 * appropriate to the grouping node.  So, only the sort ordering info 
 * is used from the SortGroupClause entries. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN743"><span class='Ref_to_Struct'>Sort</span></a> <span class='Operator'>* 
</span><a name="LN5901"></a><span class='Declare_Function'>make_sort_from_groupcols</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>groupcls</span><span class='Delimiter'>, 
</span><a name="LN5902"></a>                         <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>grpColIdx</span><span class='Delimiter'>, 
</span><a name="LN5903"></a>                         <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5905"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>sub_tlist</span> <span class='Operator'>= </span><a href="createplan.c.html#LN5903"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Delimiter'>; 
</span><a name="LN5906"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span><a name="LN5907"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>numsortkeys</span><span class='Delimiter'>; 
</span><a name="LN5908"></a>    <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Local'>sortColIdx</span><span class='Delimiter'>; 
</span><a name="LN5909"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>sortOperators</span><span class='Delimiter'>; 
</span><a name="LN5910"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>collations</span><span class='Delimiter'>; 
</span><a name="LN5911"></a>    <span class='Keyword'>bool</span>       <span class='Operator'>*</span><span class='Declare_Local'>nullsFirst</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Convert list-ish representation to arrays wanted by executor */ 
</span>    <a href="createplan.c.html#LN5907"><span class='Ref_To_Local'>numsortkeys</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5901"><span class='Ref_to_Parameter'>groupcls</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5908"><span class='Ref_To_Local'>sortColIdx</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5907"><span class='Ref_To_Local'>numsortkeys</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5909"><span class='Ref_To_Local'>sortOperators</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5907"><span class='Ref_To_Local'>numsortkeys</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5910"><span class='Ref_To_Local'>collations</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5907"><span class='Ref_To_Local'>numsortkeys</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5911"><span class='Ref_To_Local'>nullsFirst</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5907"><span class='Ref_To_Local'>numsortkeys</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Keyword'>bool</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN5907"><span class='Ref_To_Local'>numsortkeys</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5906"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5901"><span class='Ref_to_Parameter'>groupcls</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN5923"></a>        <a href="../../../include/nodes/parsenodes.h.html#LN1161"><span class='Ref_to_Struct'>SortGroupClause</span></a> <span class='Operator'>*</span><span class='Declare_Local'>grpcl</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/parsenodes.h.html#LN1161"><span class='Ref_to_Struct'>SortGroupClause</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5906"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5924"></a>        <a href="../../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>tle</span> <span class='Operator'>= </span><a href="../../../include/parser/parsetree.h.html#LN69"><span class='Ref_to_Proto'>get_tle_by_resno</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5905"><span class='Ref_To_Local'>sub_tlist</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5902"><span class='Ref_to_Parameter'>grpColIdx</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN5907"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="createplan.c.html#LN5924"><span class='Ref_To_Local'>tle</span></a><span class='Parentheses'>) 
</span>            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"could not retrieve tle for sort-from-groupcols"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN5908"><span class='Ref_To_Local'>sortColIdx</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN5907"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN5924"><span class='Ref_To_Local'>tle</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN1367"><span class='Ref_to_Member'>resno</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN5909"><span class='Ref_To_Local'>sortOperators</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN5907"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN5923"><span class='Ref_To_Local'>grpcl</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1166"><span class='Ref_to_Member'>sortop</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN5910"><span class='Ref_To_Local'>collations</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN5907"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/nodes/nodeFuncs.h.html#LN38"><span class='Ref_to_Proto'>exprCollation</span></a><span class='Parentheses'>((</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN5924"><span class='Ref_To_Local'>tle</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN1366"><span class='Ref_to_Member'>expr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN5911"><span class='Ref_To_Local'>nullsFirst</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN5907"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN5923"><span class='Ref_To_Local'>grpcl</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1167"><span class='Ref_to_Member'>nulls_first</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN5907"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN237"><span class='Ref_to_Proto'>make_sort</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5903"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5907"><span class='Ref_To_Local'>numsortkeys</span></a><span class='Delimiter'>, 
</span>                     <a href="createplan.c.html#LN5908"><span class='Ref_To_Local'>sortColIdx</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5909"><span class='Ref_To_Local'>sortOperators</span></a><span class='Delimiter'>, 
</span>                     <a href="createplan.c.html#LN5910"><span class='Ref_To_Local'>collations</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN5911"><span class='Ref_To_Local'>nullsFirst</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_sort_from_groupcols &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN734"><span class='Ref_to_Struct'>Material</span></a> <span class='Operator'>* 
</span><a name="LN5942"></a><span class='Declare_Function'>make_material</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5944"></a>    <a href="../../../include/nodes/plannodes.h.html#LN734"><span class='Ref_to_Struct'>Material</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN734"><span class='Ref_to_Struct'>Material</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN5945"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN5944"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN736"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN5945"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5942"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5945"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5945"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5942"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5945"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN5944"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * materialize_finished_plan: stick a Material node atop a completed plan 
 * 
 * There are a couple of places where we want to attach a Material node 
 * after completion of create_plan(), without any MaterialPath path. 
 * Those places should probably be refactored someday to do this on the 
 * Path representation, but it's not worth the trouble yet. 
 */ 
</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>* 
</span><a name="LN5964"></a><span class='Declare_Function'>materialize_finished_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>subplan</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN5966"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>matplan</span><span class='Delimiter'>; 
</span><a name="LN5967"></a>    <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a>        <span class='Declare_Local'>matpath</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* dummy for result of cost_material */ 
</span> 
    <a href="createplan.c.html#LN5966"><span class='Ref_To_Local'>matplan</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="createplan.c.html#LN256"><span class='Ref_to_Proto'>make_material</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN5964"><span class='Ref_to_Parameter'>subplan</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * XXX horrid kluge: if there are any initPlans attached to the subplan, 
     * move them up to the Material node, which is now effectively the top 
     * plan node in its query level.  This prevents failure in 
     * SS_finalize_plan(), which see for comments.  We don't bother adjusting 
     * the subplan's cost estimate for this. 
     */ 
</span>    <a href="createplan.c.html#LN5966"><span class='Ref_To_Local'>matplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN147"><span class='Ref_to_Member'>initPlan</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5964"><span class='Ref_to_Parameter'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN147"><span class='Ref_to_Member'>initPlan</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5964"><span class='Ref_to_Parameter'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN147"><span class='Ref_to_Member'>initPlan</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Set cost data */ 
</span>    <a href="../../../include/optimizer/cost.h.html#LN111"><span class='Ref_to_Proto'>cost_material</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="createplan.c.html#LN5967"><span class='Ref_To_Local'>matpath</span></a><span class='Delimiter'>, 
</span>                  <a href="createplan.c.html#LN5964"><span class='Ref_to_Parameter'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN124"><span class='Ref_to_Member'>startup_cost</span></a><span class='Delimiter'>, 
</span>                  <a href="createplan.c.html#LN5964"><span class='Ref_to_Parameter'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN125"><span class='Ref_to_Member'>total_cost</span></a><span class='Delimiter'>, 
</span>                  <a href="createplan.c.html#LN5964"><span class='Ref_to_Parameter'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN130"><span class='Ref_to_Member'>plan_rows</span></a><span class='Delimiter'>, 
</span>                  <a href="createplan.c.html#LN5964"><span class='Ref_to_Parameter'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN131"><span class='Ref_to_Member'>plan_width</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5966"><span class='Ref_To_Local'>matplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN124"><span class='Ref_to_Member'>startup_cost</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5967"><span class='Ref_To_Local'>matpath</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN964"><span class='Ref_to_Member'>startup_cost</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5966"><span class='Ref_To_Local'>matplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN125"><span class='Ref_to_Member'>total_cost</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5967"><span class='Ref_To_Local'>matpath</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN965"><span class='Ref_to_Member'>total_cost</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5966"><span class='Ref_To_Local'>matplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN130"><span class='Ref_to_Member'>plan_rows</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5964"><span class='Ref_to_Parameter'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN130"><span class='Ref_to_Member'>plan_rows</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5966"><span class='Ref_To_Local'>matplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN131"><span class='Ref_to_Member'>plan_width</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5964"><span class='Ref_to_Parameter'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN131"><span class='Ref_to_Member'>plan_width</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5966"><span class='Ref_To_Local'>matplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN136"><span class='Ref_to_Member'>parallel_aware</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN5966"><span class='Ref_To_Local'>matplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN137"><span class='Ref_to_Member'>parallel_safe</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5964"><span class='Ref_to_Parameter'>subplan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN137"><span class='Ref_to_Member'>parallel_safe</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN5966"><span class='Ref_To_Local'>matplan</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end materialize_finished_plan &raquo; </span> 
 
<a href="../../../include/nodes/plannodes.h.html#LN781"><span class='Ref_to_Struct'>Agg</span></a> <span class='Operator'>* 
</span><a name="LN5998"></a><span class='Declare_Function'>make_agg</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qual</span><span class='Delimiter'>, 
</span><a name="LN5999"></a>         <a href="../../../include/nodes/nodes.h.html#LN733"><span class='Ref_to_Enum'>AggStrategy</span></a> <span class='Declare_Parameter'>aggstrategy</span><span class='Delimiter'>, </span><a href="../../../include/nodes/nodes.h.html#LN755"><span class='Ref_to_Enum'>AggSplit</span></a> <span class='Declare_Parameter'>aggsplit</span><span class='Delimiter'>, 
</span><a name="LN6000"></a>         <span class='Keyword'>int </span><span class='Declare_Parameter'>numGroupCols</span><span class='Delimiter'>, </span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>grpColIdx</span><span class='Delimiter'>, </span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>grpOperators</span><span class='Delimiter'>, 
</span><a name="LN6001"></a>         <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>groupingSets</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>chain</span><span class='Delimiter'>, 
</span><a name="LN6002"></a>         <span class='Keyword'>double </span><span class='Declare_Parameter'>dNumGroups</span><span class='Delimiter'>, </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN6004"></a>    <a href="../../../include/nodes/plannodes.h.html#LN781"><span class='Ref_to_Struct'>Agg</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN781"><span class='Ref_to_Struct'>Agg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN6005"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN6004"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN783"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span><a name="LN6006"></a>    <span class='Keyword'>long</span>        <span class='Declare_Local'>numGroups</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Reduce to long, but 'ware overflow! */ 
</span>    <a href="createplan.c.html#LN6006"><span class='Ref_To_Local'>numGroups</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>long</span><span class='Parentheses'>) </span><a href="../../../interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6002"><span class='Ref_to_Parameter'>dNumGroups</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>double</span><span class='Parentheses'>) </span>LONG_MAX<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN6004"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN784"><span class='Ref_to_Member'>aggstrategy</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5999"><span class='Ref_to_Parameter'>aggstrategy</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6004"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN785"><span class='Ref_to_Member'>aggsplit</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5999"><span class='Ref_to_Parameter'>aggsplit</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6004"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN786"><span class='Ref_to_Member'>numCols</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6000"><span class='Ref_to_Parameter'>numGroupCols</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6004"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN787"><span class='Ref_to_Member'>grpColIdx</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6000"><span class='Ref_to_Parameter'>grpColIdx</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6004"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN788"><span class='Ref_to_Member'>grpOperators</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6000"><span class='Ref_to_Parameter'>grpOperators</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6004"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN789"><span class='Ref_to_Member'>numGroups</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6006"><span class='Ref_To_Local'>numGroups</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6004"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN790"><span class='Ref_to_Member'>aggParams</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* SS_finalize_plan() will fill this */ 
</span>    <a href="createplan.c.html#LN6004"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN792"><span class='Ref_to_Member'>groupingSets</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6001"><span class='Ref_to_Parameter'>groupingSets</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6004"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN793"><span class='Ref_to_Member'>chain</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6001"><span class='Ref_to_Parameter'>chain</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN6005"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5998"><span class='Ref_to_Parameter'>qual</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6005"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN5998"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6005"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6002"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6005"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN6004"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_agg &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN800"><span class='Ref_to_Struct'>WindowAgg</span></a> <span class='Operator'>* 
</span><a name="LN6030"></a><span class='Declare_Function'>make_windowagg</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>winref</span><span class='Delimiter'>, 
</span><a name="LN6031"></a>               <span class='Keyword'>int </span><span class='Declare_Parameter'>partNumCols</span><span class='Delimiter'>, </span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>partColIdx</span><span class='Delimiter'>, </span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>partOperators</span><span class='Delimiter'>, 
</span><a name="LN6032"></a>               <span class='Keyword'>int </span><span class='Declare_Parameter'>ordNumCols</span><span class='Delimiter'>, </span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>ordColIdx</span><span class='Delimiter'>, </span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>ordOperators</span><span class='Delimiter'>, 
</span><a name="LN6033"></a>               <span class='Keyword'>int </span><span class='Declare_Parameter'>frameOptions</span><span class='Delimiter'>, </span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>startOffset</span><span class='Delimiter'>, </span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>endOffset</span><span class='Delimiter'>, 
</span><a name="LN6034"></a>               <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN6036"></a>    <a href="../../../include/nodes/plannodes.h.html#LN800"><span class='Ref_to_Struct'>WindowAgg</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN800"><span class='Ref_to_Struct'>WindowAgg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN6037"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN6036"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN802"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN6036"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN803"><span class='Ref_to_Member'>winref</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6030"><span class='Ref_to_Parameter'>winref</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6036"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN804"><span class='Ref_to_Member'>partNumCols</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6031"><span class='Ref_to_Parameter'>partNumCols</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6036"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN805"><span class='Ref_to_Member'>partColIdx</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6031"><span class='Ref_to_Parameter'>partColIdx</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6036"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN806"><span class='Ref_to_Member'>partOperators</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6031"><span class='Ref_to_Parameter'>partOperators</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6036"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN807"><span class='Ref_to_Member'>ordNumCols</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6032"><span class='Ref_to_Parameter'>ordNumCols</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6036"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN808"><span class='Ref_to_Member'>ordColIdx</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6032"><span class='Ref_to_Parameter'>ordColIdx</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6036"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN809"><span class='Ref_to_Member'>ordOperators</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6032"><span class='Ref_to_Parameter'>ordOperators</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6036"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN810"><span class='Ref_to_Member'>frameOptions</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6033"><span class='Ref_to_Parameter'>frameOptions</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6036"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN811"><span class='Ref_to_Member'>startOffset</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6033"><span class='Ref_to_Parameter'>startOffset</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6036"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN812"><span class='Ref_to_Member'>endOffset</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6033"><span class='Ref_to_Parameter'>endOffset</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN6037"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6030"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6037"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6034"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6037"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* WindowAgg nodes never have a qual clause */ 
</span>    <a href="createplan.c.html#LN6037"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN6036"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_windowagg &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN759"><span class='Ref_to_Struct'>Group</span></a> <span class='Operator'>* 
</span><a name="LN6060"></a><span class='Declare_Function'>make_group</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, 
</span><a name="LN6061"></a>           <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qual</span><span class='Delimiter'>, 
</span><a name="LN6062"></a>           <span class='Keyword'>int </span><span class='Declare_Parameter'>numGroupCols</span><span class='Delimiter'>, 
</span><a name="LN6063"></a>           <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>grpColIdx</span><span class='Delimiter'>, 
</span><a name="LN6064"></a>           <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>grpOperators</span><span class='Delimiter'>, 
</span><a name="LN6065"></a>           <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN6067"></a>    <a href="../../../include/nodes/plannodes.h.html#LN759"><span class='Ref_to_Struct'>Group</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN759"><span class='Ref_to_Struct'>Group</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN6068"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN6067"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN761"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN6067"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN762"><span class='Ref_to_Member'>numCols</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6062"><span class='Ref_to_Parameter'>numGroupCols</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6067"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN763"><span class='Ref_to_Member'>grpColIdx</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6063"><span class='Ref_to_Parameter'>grpColIdx</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6067"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN764"><span class='Ref_to_Member'>grpOperators</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6064"><span class='Ref_to_Parameter'>grpOperators</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN6068"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6061"><span class='Ref_to_Parameter'>qual</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6068"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6060"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6068"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6065"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6068"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN6067"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_group &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * distinctList is a list of SortGroupClauses, identifying the targetlist items 
 * that should be considered by the Unique filter.  The input path must 
 * already be sorted accordingly. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN819"><span class='Ref_to_Struct'>Unique</span></a> <span class='Operator'>* 
</span><a name="LN6088"></a><span class='Declare_Function'>make_unique_from_sortclauses</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>distinctList</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN6090"></a>    <a href="../../../include/nodes/plannodes.h.html#LN819"><span class='Ref_to_Struct'>Unique</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN819"><span class='Ref_to_Struct'>Unique</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN6091"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN6090"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN821"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span><a name="LN6092"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>numCols</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6088"><span class='Ref_to_Parameter'>distinctList</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN6093"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>keyno</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN6094"></a>    <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Local'>uniqColIdx</span><span class='Delimiter'>; 
</span><a name="LN6095"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>uniqOperators</span><span class='Delimiter'>; 
</span><a name="LN6096"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>slitem</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN6091"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6088"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6091"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6091"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6088"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6091"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * convert SortGroupClause list into arrays of attr indexes and equality 
     * operators, as wanted by executor 
     */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN6092"><span class='Ref_To_Local'>numCols</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6094"><span class='Ref_To_Local'>uniqColIdx</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="createplan.c.html#LN6092"><span class='Ref_To_Local'>numCols</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6095"><span class='Ref_To_Local'>uniqOperators</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="createplan.c.html#LN6092"><span class='Ref_To_Local'>numCols</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6096"><span class='Ref_To_Local'>slitem</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN6088"><span class='Ref_to_Parameter'>distinctList</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN6113"></a>        <a href="../../../include/nodes/parsenodes.h.html#LN1161"><span class='Ref_to_Struct'>SortGroupClause</span></a> <span class='Operator'>*</span><span class='Declare_Local'>sortcl</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/parsenodes.h.html#LN1161"><span class='Ref_to_Struct'>SortGroupClause</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6096"><span class='Ref_To_Local'>slitem</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN6114"></a>        <a href="../../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>tle</span> <span class='Operator'>= </span><a href="../../../include/optimizer/tlist.h.html#LN37"><span class='Ref_to_Proto'>get_sortgroupclause_tle</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6113"><span class='Ref_To_Local'>sortcl</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN6091"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN6094"><span class='Ref_To_Local'>uniqColIdx</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN6093"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN6114"><span class='Ref_To_Local'>tle</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN1367"><span class='Ref_to_Member'>resno</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN6095"><span class='Ref_To_Local'>uniqOperators</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN6093"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN6113"><span class='Ref_To_Local'>sortcl</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1165"><span class='Ref_to_Member'>eqop</span></a><span class='Delimiter'>; 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6095"><span class='Ref_To_Local'>uniqOperators</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN6093"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN6093"><span class='Ref_To_Local'>keyno</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="createplan.c.html#LN6090"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN822"><span class='Ref_to_Member'>numCols</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6092"><span class='Ref_To_Local'>numCols</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6090"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN823"><span class='Ref_to_Member'>uniqColIdx</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6094"><span class='Ref_To_Local'>uniqColIdx</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6090"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN824"><span class='Ref_to_Member'>uniqOperators</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6095"><span class='Ref_To_Local'>uniqOperators</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN6090"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_unique_from_sortclauses &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * as above, but use pathkeys to identify the sort columns and semantics 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN819"><span class='Ref_to_Struct'>Unique</span></a> <span class='Operator'>* 
</span><a name="LN6133"></a><span class='Declare_Function'>make_unique_from_pathkeys</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pathkeys</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>numCols</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN6135"></a>    <a href="../../../include/nodes/plannodes.h.html#LN819"><span class='Ref_to_Struct'>Unique</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN819"><span class='Ref_to_Struct'>Unique</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN6136"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN6135"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN821"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span><a name="LN6137"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>keyno</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN6138"></a>    <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Local'>uniqColIdx</span><span class='Delimiter'>; 
</span><a name="LN6139"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>uniqOperators</span><span class='Delimiter'>; 
</span><a name="LN6140"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN6136"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6133"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6136"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6136"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6133"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6136"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Convert pathkeys list into arrays of attr indexes and equality 
     * operators, as wanted by executor.  This has a lot in common with 
     * prepare_sort_from_pathkeys ... maybe unify sometime? 
     */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN6133"><span class='Ref_to_Parameter'>numCols</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="createplan.c.html#LN6133"><span class='Ref_to_Parameter'>numCols</span></a> <span class='Operator'>&LT;= </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6133"><span class='Ref_to_Parameter'>pathkeys</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6138"><span class='Ref_To_Local'>uniqColIdx</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="createplan.c.html#LN6133"><span class='Ref_to_Parameter'>numCols</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6139"><span class='Ref_To_Local'>uniqOperators</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="createplan.c.html#LN6133"><span class='Ref_to_Parameter'>numCols</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6140"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN6133"><span class='Ref_to_Parameter'>pathkeys</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN6158"></a>        <a href="../../../include/nodes/relation.h.html#LN845"><span class='Ref_to_Struct'>PathKey</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>pathkey</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN845"><span class='Ref_to_Struct'>PathKey</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6140"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN6159"></a>        <a href="../../../include/nodes/relation.h.html#LN766"><span class='Ref_to_Struct'>EquivalenceClass</span></a> <span class='Operator'>*</span><span class='Declare_Local'>ec</span> <span class='Operator'>= </span><a href="createplan.c.html#LN6158"><span class='Ref_To_Local'>pathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN849"><span class='Ref_to_Member'>pk_eclass</span></a><span class='Delimiter'>; 
</span><a name="LN6160"></a>        <a href="../../../include/nodes/relation.h.html#LN816"><span class='Ref_to_Struct'>EquivalenceMember</span></a> <span class='Operator'>*</span><span class='Declare_Local'>em</span><span class='Delimiter'>; 
</span><a name="LN6161"></a>        <a href="../../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>tle</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN6162"></a>        <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>pk_datatype</span> <span class='Operator'>= </span><a href="../../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span><a name="LN6163"></a>        <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>eqop</span><span class='Delimiter'>; 
</span><a name="LN6164"></a>        <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Ignore pathkeys beyond the specified number of columns */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN6137"><span class='Ref_To_Local'>keyno</span></a> <span class='Operator'>&GT;= </span><a href="createplan.c.html#LN6133"><span class='Ref_to_Parameter'>numCols</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN6159"><span class='Ref_To_Local'>ec</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN778"><span class='Ref_to_Member'>ec_has_volatile</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * If the pathkey's EquivalenceClass is volatile, then it must 
             * have come from an ORDER BY clause, and we have to match it to 
             * that same targetlist entry. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN6159"><span class='Ref_To_Local'>ec</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN781"><span class='Ref_to_Member'>ec_sortref</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span>    <span class='Comment_Single_Line'>/* can't happen */ 
</span>                <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"volatile EquivalenceClass has no sortref"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN6161"><span class='Ref_To_Local'>tle</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/tlist.h.html#LN35"><span class='Ref_to_Proto'>get_sortgroupref_tle</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6159"><span class='Ref_To_Local'>ec</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN781"><span class='Ref_to_Member'>ec_sortref</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN6136"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN6161"><span class='Ref_To_Local'>tle</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6159"><span class='Ref_To_Local'>ec</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN772"><span class='Ref_to_Member'>ec_members</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="createplan.c.html#LN6162"><span class='Ref_To_Local'>pk_datatype</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="../../../include/nodes/relation.h.html#LN816"><span class='Ref_to_Struct'>EquivalenceMember</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6159"><span class='Ref_To_Local'>ec</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN772"><span class='Ref_to_Member'>ec_members</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>em_datatype<span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * Otherwise, we can use any non-constant expression listed in the 
             * pathkey's EquivalenceClass.  For now, we take the first tlist 
             * item found in the EC. 
             */ 
</span>            <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6164"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN6136"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="createplan.c.html#LN6161"><span class='Ref_To_Local'>tle</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6164"><span class='Ref_To_Local'>j</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="createplan.c.html#LN6160"><span class='Ref_To_Local'>em</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN249"><span class='Ref_to_Proto'>find_ec_member_for_tle</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6159"><span class='Ref_To_Local'>ec</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN6161"><span class='Ref_To_Local'>tle</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN6160"><span class='Ref_To_Local'>em</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Comment_Multi_Line'>/* found expr already in tlist */ 
</span>                    <a href="createplan.c.html#LN6162"><span class='Ref_To_Local'>pk_datatype</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6160"><span class='Ref_To_Local'>em</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN825"><span class='Ref_to_Member'>em_datatype</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <a href="createplan.c.html#LN6161"><span class='Ref_To_Local'>tle</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="createplan.c.html#LN6161"><span class='Ref_To_Local'>tle</span></a><span class='Parentheses'>) 
</span>            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"could not find pathkey item to sort"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Look up the correct equality operator from the PathKey's slightly 
         * abstracted representation. 
         */ 
</span>        <a href="createplan.c.html#LN6163"><span class='Ref_To_Local'>eqop</span></a> <span class='Operator'>= </span><a href="../../../include/utils/lsyscache.h.html#LN70"><span class='Ref_to_Proto'>get_opfamily_member</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6158"><span class='Ref_To_Local'>pathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN850"><span class='Ref_to_Member'>pk_opfamily</span></a><span class='Delimiter'>, 
</span>                                   <a href="createplan.c.html#LN6162"><span class='Ref_To_Local'>pk_datatype</span></a><span class='Delimiter'>, 
</span>                                   <a href="createplan.c.html#LN6162"><span class='Ref_To_Local'>pk_datatype</span></a><span class='Delimiter'>, 
</span>                                   <a href="../../../include/access/stratnum.h.html#LN30"><span class='Ref_to_Const'>BTEqualStrategyNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6163"><span class='Ref_To_Local'>eqop</span></a><span class='Parentheses'>))</span>  <span class='Comment_Single_Line'>/* should not happen */ 
</span>            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"could not find member %d(%u,%u) of opfamily %u"</span><span class='Delimiter'>, 
</span>                 <a href="../../../include/access/stratnum.h.html#LN30"><span class='Ref_to_Const'>BTEqualStrategyNumber</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN6162"><span class='Ref_To_Local'>pk_datatype</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN6162"><span class='Ref_To_Local'>pk_datatype</span></a><span class='Delimiter'>, 
</span>                 <a href="createplan.c.html#LN6158"><span class='Ref_To_Local'>pathkey</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN850"><span class='Ref_to_Member'>pk_opfamily</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN6138"><span class='Ref_To_Local'>uniqColIdx</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN6137"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN6161"><span class='Ref_To_Local'>tle</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN1367"><span class='Ref_to_Member'>resno</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN6139"><span class='Ref_To_Local'>uniqOperators</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN6137"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN6163"><span class='Ref_To_Local'>eqop</span></a><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN6137"><span class='Ref_To_Local'>keyno</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="createplan.c.html#LN6135"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN822"><span class='Ref_to_Member'>numCols</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6133"><span class='Ref_to_Parameter'>numCols</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6135"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN823"><span class='Ref_to_Member'>uniqColIdx</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6138"><span class='Ref_To_Local'>uniqColIdx</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6135"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN824"><span class='Ref_to_Member'>uniqOperators</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6139"><span class='Ref_To_Local'>uniqOperators</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN6135"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_unique_from_pathkeys &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN831"><span class='Ref_to_Struct'>Gather</span></a> <span class='Operator'>* 
</span><a name="LN6235"></a><span class='Declare_Function'>make_gather</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qptlist</span><span class='Delimiter'>, 
</span><a name="LN6236"></a>            <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qpqual</span><span class='Delimiter'>, 
</span><a name="LN6237"></a>            <span class='Keyword'>int </span><span class='Declare_Parameter'>nworkers</span><span class='Delimiter'>, 
</span><a name="LN6238"></a>            <span class='Keyword'>bool </span><span class='Declare_Parameter'>single_copy</span><span class='Delimiter'>, 
</span><a name="LN6239"></a>            <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>subplan</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN6241"></a>    <a href="../../../include/nodes/plannodes.h.html#LN831"><span class='Ref_to_Struct'>Gather</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN831"><span class='Ref_to_Struct'>Gather</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN6242"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN6241"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN833"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN6242"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6235"><span class='Ref_to_Parameter'>qptlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6242"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6236"><span class='Ref_to_Parameter'>qpqual</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6242"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6239"><span class='Ref_to_Parameter'>subplan</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6242"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6241"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN834"><span class='Ref_to_Member'>num_workers</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6237"><span class='Ref_to_Parameter'>nworkers</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6241"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN835"><span class='Ref_to_Member'>single_copy</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6238"><span class='Ref_to_Parameter'>single_copy</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6241"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN836"><span class='Ref_to_Member'>invisible</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN6241"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_gather &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * distinctList is a list of SortGroupClauses, identifying the targetlist 
 * items that should be considered by the SetOp filter.  The input path must 
 * already be sorted accordingly. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN876"><span class='Ref_to_Struct'>SetOp</span></a> <span class='Operator'>* 
</span><a name="LN6261"></a><span class='Declare_Function'>make_setop</span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN777"><span class='Ref_to_Enum'>SetOpCmd</span></a> <span class='Declare_Parameter'>cmd</span><span class='Delimiter'>, </span><a href="../../../include/nodes/nodes.h.html#LN785"><span class='Ref_to_Enum'>SetOpStrategy</span></a> <span class='Declare_Parameter'>strategy</span><span class='Delimiter'>, </span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, 
</span><a name="LN6262"></a>           <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>distinctList</span><span class='Delimiter'>, </span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Declare_Parameter'>flagColIdx</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>firstFlag</span><span class='Delimiter'>, 
</span><a name="LN6263"></a>           <span class='Keyword'>long </span><span class='Declare_Parameter'>numGroups</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN6265"></a>    <a href="../../../include/nodes/plannodes.h.html#LN876"><span class='Ref_to_Struct'>SetOp</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN876"><span class='Ref_to_Struct'>SetOp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN6266"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN6265"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN878"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span><a name="LN6267"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>numCols</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6262"><span class='Ref_to_Parameter'>distinctList</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN6268"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>keyno</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN6269"></a>    <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Local'>dupColIdx</span><span class='Delimiter'>; 
</span><a name="LN6270"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>dupOperators</span><span class='Delimiter'>; 
</span><a name="LN6271"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>slitem</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN6266"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6261"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6266"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6266"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6261"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6266"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * convert SortGroupClause list into arrays of attr indexes and equality 
     * operators, as wanted by executor 
     */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN6267"><span class='Ref_To_Local'>numCols</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6269"><span class='Ref_To_Local'>dupColIdx</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="createplan.c.html#LN6267"><span class='Ref_To_Local'>numCols</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6270"><span class='Ref_To_Local'>dupOperators</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="createplan.c.html#LN6267"><span class='Ref_To_Local'>numCols</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6271"><span class='Ref_To_Local'>slitem</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN6262"><span class='Ref_to_Parameter'>distinctList</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN6288"></a>        <a href="../../../include/nodes/parsenodes.h.html#LN1161"><span class='Ref_to_Struct'>SortGroupClause</span></a> <span class='Operator'>*</span><span class='Declare_Local'>sortcl</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/parsenodes.h.html#LN1161"><span class='Ref_to_Struct'>SortGroupClause</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6271"><span class='Ref_To_Local'>slitem</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN6289"></a>        <a href="../../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>tle</span> <span class='Operator'>= </span><a href="../../../include/optimizer/tlist.h.html#LN37"><span class='Ref_to_Proto'>get_sortgroupclause_tle</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6288"><span class='Ref_To_Local'>sortcl</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN6266"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN6269"><span class='Ref_To_Local'>dupColIdx</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN6268"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN6289"><span class='Ref_To_Local'>tle</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN1367"><span class='Ref_to_Member'>resno</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN6270"><span class='Ref_To_Local'>dupOperators</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN6268"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="createplan.c.html#LN6288"><span class='Ref_To_Local'>sortcl</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1165"><span class='Ref_to_Member'>eqop</span></a><span class='Delimiter'>; 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6270"><span class='Ref_To_Local'>dupOperators</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN6268"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN6268"><span class='Ref_To_Local'>keyno</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="createplan.c.html#LN6265"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN879"><span class='Ref_to_Member'>cmd</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6261"><span class='Ref_to_Parameter'>cmd</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6265"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN880"><span class='Ref_to_Member'>strategy</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6261"><span class='Ref_to_Parameter'>strategy</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6265"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN881"><span class='Ref_to_Member'>numCols</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6267"><span class='Ref_To_Local'>numCols</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6265"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN883"><span class='Ref_to_Member'>dupColIdx</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6269"><span class='Ref_To_Local'>dupColIdx</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6265"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN884"><span class='Ref_to_Member'>dupOperators</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6270"><span class='Ref_To_Local'>dupOperators</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6265"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN885"><span class='Ref_to_Member'>flagColIdx</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6262"><span class='Ref_to_Parameter'>flagColIdx</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6265"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN886"><span class='Ref_to_Member'>firstFlag</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6262"><span class='Ref_to_Parameter'>firstFlag</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6265"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN887"><span class='Ref_to_Member'>numGroups</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6263"><span class='Ref_to_Parameter'>numGroups</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN6265"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_setop &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * make_lockrows 
 *    Build a LockRows plan node 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN899"><span class='Ref_to_Struct'>LockRows</span></a> <span class='Operator'>* 
</span><a name="LN6314"></a><span class='Declare_Function'>make_lockrows</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rowMarks</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>epqParam</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN6316"></a>    <a href="../../../include/nodes/plannodes.h.html#LN899"><span class='Ref_to_Struct'>LockRows</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN899"><span class='Ref_to_Struct'>LockRows</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN6317"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN6316"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN901"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN6317"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6314"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6317"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6317"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6314"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6317"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN6316"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN902"><span class='Ref_to_Member'>rowMarks</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6314"><span class='Ref_to_Parameter'>rowMarks</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6316"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN903"><span class='Ref_to_Member'>epqParam</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6314"><span class='Ref_to_Parameter'>epqParam</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN6316"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * make_limit 
 *    Build a Limit plan node 
 */ 
</span><a href="../../../include/nodes/plannodes.h.html#LN913"><span class='Ref_to_Struct'>Limit</span></a> <span class='Operator'>* 
</span><a name="LN6335"></a><span class='Declare_Function'>make_limit</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>lefttree</span><span class='Delimiter'>, </span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>limitOffset</span><span class='Delimiter'>, </span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>limitCount</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN6337"></a>    <a href="../../../include/nodes/plannodes.h.html#LN913"><span class='Ref_to_Struct'>Limit</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN913"><span class='Ref_to_Struct'>Limit</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN6338"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN6337"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN915"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN6338"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6335"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6338"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6338"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6335"><span class='Ref_to_Parameter'>lefttree</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6338"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN6337"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN916"><span class='Ref_to_Member'>limitOffset</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6335"><span class='Ref_to_Parameter'>limitOffset</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6337"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN917"><span class='Ref_to_Member'>limitCount</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6335"><span class='Ref_to_Parameter'>limitCount</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN6337"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * make_result 
 *    Build a Result plan node 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN187"><span class='Ref_to_Struct'>Result</span></a> <span class='Operator'>* 
</span><a name="LN6356"></a><span class='Declare_Function'>make_result</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, 
</span><a name="LN6357"></a>            <a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>resconstantqual</span><span class='Delimiter'>, 
</span><a name="LN6358"></a>            <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>subplan</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN6360"></a>    <a href="../../../include/nodes/plannodes.h.html#LN187"><span class='Ref_to_Struct'>Result</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN187"><span class='Ref_to_Struct'>Result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN6361"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN6360"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN189"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN6361"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6356"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6361"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6361"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6358"><span class='Ref_to_Parameter'>subplan</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6361"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6360"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN190"><span class='Ref_to_Member'>resconstantqual</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6357"><span class='Ref_to_Parameter'>resconstantqual</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN6360"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * make_project_set 
 *    Build a ProjectSet plan node 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN199"><span class='Ref_to_Struct'>ProjectSet</span></a> <span class='Operator'>* 
</span><a name="LN6377"></a><span class='Declare_Function'>make_project_set</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, 
</span><a name="LN6378"></a>                 <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>subplan</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN6380"></a>    <a href="../../../include/nodes/plannodes.h.html#LN199"><span class='Ref_to_Struct'>ProjectSet</span></a> <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN199"><span class='Ref_to_Struct'>ProjectSet</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN6381"></a>    <a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>plan</span> <span class='Operator'>= &</span><a href="createplan.c.html#LN6380"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN201"><span class='Ref_to_Member'>plan</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN6381"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6377"><span class='Ref_to_Parameter'>tlist</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6381"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6381"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6378"><span class='Ref_to_Parameter'>subplan</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6381"><span class='Ref_To_Local'>plan</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN6380"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * make_modifytable 
 *    Build a ModifyTable plan node 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/plannodes.h.html#LN213"><span class='Ref_to_Struct'>ModifyTable</span></a> <span class='Operator'>* 
</span><a name="LN6396"></a><span class='Declare_Function'>make_modifytable</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN6397"></a>                 <a href="../../../include/nodes/nodes.h.html#LN647"><span class='Ref_to_Enum'>CmdType</span></a> <span class='Declare_Parameter'>operation</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>canSetTag</span><span class='Delimiter'>, 
</span><a name="LN6398"></a>                 <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>nominalRelation</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>partitioned_rels</span><span class='Delimiter'>, 
</span><a name="LN6399"></a>                 <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>resultRelations</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>subplans</span><span class='Delimiter'>, 
</span><a name="LN6400"></a>                 <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>withCheckOptionLists</span><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>returningLists</span><span class='Delimiter'>, 
</span><a name="LN6401"></a>                 <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rowMarks</span><span class='Delimiter'>, </span><a href="../../../include/nodes/primnodes.h.html#LN1482"><span class='Ref_to_Struct'>OnConflictExpr</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>onconflict</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>epqParam</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN6403"></a>    <a href="../../../include/nodes/plannodes.h.html#LN213"><span class='Ref_to_Struct'>ModifyTable</span></a> <span class='Operator'>*</span><span class='Declare_Local'>node</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN213"><span class='Ref_to_Struct'>ModifyTable</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN6404"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>fdw_private_list</span><span class='Delimiter'>; 
</span><a name="LN6405"></a>    <a href="../../../include/nodes/bitmapset.h.html#LN36"><span class='Ref_to_Struct'>Bitmapset</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>direct_modify_plans</span><span class='Delimiter'>; 
</span><a name="LN6406"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span><a name="LN6407"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6399"><span class='Ref_to_Parameter'>resultRelations</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6399"><span class='Ref_to_Parameter'>subplans</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN6400"><span class='Ref_to_Parameter'>withCheckOptionLists</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a> <span class='Operator'>|| 
</span>           <a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6399"><span class='Ref_to_Parameter'>resultRelations</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6400"><span class='Ref_to_Parameter'>withCheckOptionLists</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN6400"><span class='Ref_to_Parameter'>returningLists</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a> <span class='Operator'>|| 
</span>           <a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6399"><span class='Ref_to_Parameter'>resultRelations</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6400"><span class='Ref_to_Parameter'>returningLists</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN215"><span class='Ref_to_Member'>plan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN145"><span class='Ref_to_Member'>lefttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN215"><span class='Ref_to_Member'>plan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN146"><span class='Ref_to_Member'>righttree</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN215"><span class='Ref_to_Member'>plan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN144"><span class='Ref_to_Member'>qual</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* setrefs.c will fill in the targetlist, if needed */ 
</span>    <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN215"><span class='Ref_to_Member'>plan</span></a><span class='Operator'>.</span><a href="../../../include/nodes/plannodes.h.html#LN143"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
    <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN216"><span class='Ref_to_Member'>operation</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6397"><span class='Ref_to_Parameter'>operation</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN217"><span class='Ref_to_Member'>canSetTag</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6397"><span class='Ref_to_Parameter'>canSetTag</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN218"><span class='Ref_to_Member'>nominalRelation</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6398"><span class='Ref_to_Parameter'>nominalRelation</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN220"><span class='Ref_to_Member'>partitioned_rels</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6398"><span class='Ref_to_Parameter'>partitioned_rels</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN221"><span class='Ref_to_Member'>resultRelations</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6399"><span class='Ref_to_Parameter'>resultRelations</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN222"><span class='Ref_to_Member'>resultRelIndex</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>;</span>  <span class='Comment_Single_Line'>/* will be set correctly in setrefs.c */ 
</span>    <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN223"><span class='Ref_to_Member'>rootResultRelIndex</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>;</span>      <span class='Comment_Single_Line'>/* will be set correctly in setrefs.c */ 
</span>    <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN224"><span class='Ref_to_Member'>plans</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6399"><span class='Ref_to_Parameter'>subplans</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="createplan.c.html#LN6401"><span class='Ref_to_Parameter'>onconflict</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN231"><span class='Ref_to_Member'>onConflictAction</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN799"><span class='Ref_to_EnumConst'>ONCONFLICT_NONE</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN233"><span class='Ref_to_Member'>onConflictSet</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN234"><span class='Ref_to_Member'>onConflictWhere</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN232"><span class='Ref_to_Member'>arbiterIndexes</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN235"><span class='Ref_to_Member'>exclRelRTI</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN236"><span class='Ref_to_Member'>exclRelTlist</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN231"><span class='Ref_to_Member'>onConflictAction</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6401"><span class='Ref_to_Parameter'>onconflict</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN1485"><span class='Ref_to_Member'>action</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN233"><span class='Ref_to_Member'>onConflictSet</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6401"><span class='Ref_to_Parameter'>onconflict</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN1494"><span class='Ref_to_Member'>onConflictSet</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN234"><span class='Ref_to_Member'>onConflictWhere</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6401"><span class='Ref_to_Parameter'>onconflict</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN1495"><span class='Ref_to_Member'>onConflictWhere</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If a set of unique index inference elements was provided (an 
         * INSERT...ON CONFLICT "inference specification"), then infer 
         * appropriate unique indexes (or throw an error if none are 
         * available). 
         */ 
</span>        <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN232"><span class='Ref_to_Member'>arbiterIndexes</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/plancat.h.html#LN30"><span class='Ref_to_Proto'>infer_arbiter_indexes</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6396"><span class='Ref_to_Parameter'>root</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN235"><span class='Ref_to_Member'>exclRelRTI</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6401"><span class='Ref_to_Parameter'>onconflict</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN1496"><span class='Ref_to_Member'>exclRelIndex</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN236"><span class='Ref_to_Member'>exclRelTlist</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6401"><span class='Ref_to_Parameter'>onconflict</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN1497"><span class='Ref_to_Member'>exclRelTlist</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN225"><span class='Ref_to_Member'>withCheckOptionLists</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6400"><span class='Ref_to_Parameter'>withCheckOptionLists</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN226"><span class='Ref_to_Member'>returningLists</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6400"><span class='Ref_to_Parameter'>returningLists</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN229"><span class='Ref_to_Member'>rowMarks</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6401"><span class='Ref_to_Parameter'>rowMarks</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN230"><span class='Ref_to_Member'>epqParam</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6401"><span class='Ref_to_Parameter'>epqParam</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * For each result relation that is a foreign table, allow the FDW to 
     * construct private plan data, and accumulate it all into a list. 
     */ 
</span>    <a href="createplan.c.html#LN6404"><span class='Ref_To_Local'>fdw_private_list</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6405"><span class='Ref_To_Local'>direct_modify_plans</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6407"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6406"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN6399"><span class='Ref_to_Parameter'>resultRelations</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN6469"></a>        <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>       <span class='Declare_Local'>rti</span> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN106"><span class='Ref_to_Macro'>lfirst_int</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6406"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN6470"></a>        <a href="../../../include/foreign/fdwapi.h.html#LN168"><span class='Ref_to_Struct'>FdwRoutine</span></a> <span class='Operator'>*</span><span class='Declare_Local'>fdwroutine</span><span class='Delimiter'>; 
</span><a name="LN6471"></a>        <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>fdw_private</span><span class='Delimiter'>; 
</span><a name="LN6472"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>direct_modify</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If possible, we want to get the FdwRoutine from our RelOptInfo for 
         * the table.  But sometimes we don't have a RelOptInfo and must get 
         * it the hard way.  (In INSERT, the target relation is not scanned, 
         * so it's not a baserel; and there are also corner cases for 
         * updatable views where the target rel isn't a baserel.) 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN6469"><span class='Ref_To_Local'>rti</span></a> <span class='Operator'>&LT; </span><a href="createplan.c.html#LN6396"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN179"><span class='Ref_to_Member'>simple_rel_array_size</span></a> <span class='Operator'>&& 
</span>            <a href="createplan.c.html#LN6396"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN178"><span class='Ref_to_Member'>simple_rel_array</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN6469"><span class='Ref_To_Local'>rti</span></a><span class='Delimiter'>] </span><span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN6484"></a>            <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>resultRel</span> <span class='Operator'>= </span><a href="createplan.c.html#LN6396"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN178"><span class='Ref_to_Member'>simple_rel_array</span></a><span class='Delimiter'>[</span><a href="createplan.c.html#LN6469"><span class='Ref_To_Local'>rti</span></a><span class='Delimiter'>]; 
</span> 
            <a href="createplan.c.html#LN6470"><span class='Ref_To_Local'>fdwroutine</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6484"><span class='Ref_To_Local'>resultRel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN575"><span class='Ref_to_Member'>fdwroutine</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span><a name="LN6490"></a>            <a href="../../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span> <span class='Operator'>= </span><a href="../../../include/nodes/relation.h.html#LN324"><span class='Ref_to_Macro'>planner_rt_fetch</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6469"><span class='Ref_To_Local'>rti</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN6396"><span class='Ref_to_Parameter'>root</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="createplan.c.html#LN6490"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/parsenodes.h.html#LN922"><span class='Ref_to_EnumConst'>RTE_RELATION</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN6490"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN948"><span class='Ref_to_Member'>relkind</span></a> <span class='Operator'>== </span><a href="../../../include/catalog/pg_class.h.html#LN166"><span class='Ref_to_Const'>RELKIND_FOREIGN_TABLE</span></a><span class='Parentheses'>) 
</span>                <a href="createplan.c.html#LN6470"><span class='Ref_To_Local'>fdwroutine</span></a> <span class='Operator'>= </span><a href="../../../include/foreign/fdwapi.h.html#LN235"><span class='Ref_to_Proto'>GetFdwRoutineByRelId</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6490"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN947"><span class='Ref_to_Member'>relid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="createplan.c.html#LN6470"><span class='Ref_To_Local'>fdwroutine</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If the target foreign table has any row-level triggers, we can't 
         * modify the foreign table directly. 
         */ 
</span>        <a href="createplan.c.html#LN6472"><span class='Ref_To_Local'>direct_modify</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN6470"><span class='Ref_To_Local'>fdwroutine</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& 
</span>            <a href="createplan.c.html#LN6470"><span class='Ref_To_Local'>fdwroutine</span></a><span class='Operator'>-&GT;</span><a href="../../../include/foreign/fdwapi.h.html#LN201"><span class='Ref_to_Member'>PlanDirectModify</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& 
</span>            <a href="createplan.c.html#LN6470"><span class='Ref_To_Local'>fdwroutine</span></a><span class='Operator'>-&GT;</span><a href="../../../include/foreign/fdwapi.h.html#LN202"><span class='Ref_to_Member'>BeginDirectModify</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& 
</span>            <a href="createplan.c.html#LN6470"><span class='Ref_To_Local'>fdwroutine</span></a><span class='Operator'>-&GT;</span><a href="../../../include/foreign/fdwapi.h.html#LN203"><span class='Ref_to_Member'>IterateDirectModify</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& 
</span>            <a href="createplan.c.html#LN6470"><span class='Ref_To_Local'>fdwroutine</span></a><span class='Operator'>-&GT;</span><a href="../../../include/foreign/fdwapi.h.html#LN204"><span class='Ref_to_Member'>EndDirectModify</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& 
</span>            <span class='Operator'>!</span><a href="../../../include/optimizer/plancat.h.html#LN57"><span class='Ref_to_Proto'>has_row_triggers</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6396"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN6469"><span class='Ref_To_Local'>rti</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN6397"><span class='Ref_to_Parameter'>operation</span></a><span class='Parentheses'>))</span> 
            <a href="createplan.c.html#LN6472"><span class='Ref_To_Local'>direct_modify</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6470"><span class='Ref_To_Local'>fdwroutine</span></a><span class='Operator'>-&GT;</span><a href="../../../include/foreign/fdwapi.h.html#LN201"><span class='Ref_to_Member'>PlanDirectModify</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6396"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN6469"><span class='Ref_To_Local'>rti</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN6407"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN6472"><span class='Ref_To_Local'>direct_modify</span></a><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN6405"><span class='Ref_To_Local'>direct_modify_plans</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/bitmapset.h.html#LN89"><span class='Ref_to_Proto'>bms_add_member</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6405"><span class='Ref_To_Local'>direct_modify_plans</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN6407"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="createplan.c.html#LN6472"><span class='Ref_To_Local'>direct_modify</span></a> <span class='Operator'>&& 
</span>            <a href="createplan.c.html#LN6470"><span class='Ref_To_Local'>fdwroutine</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& 
</span>            <a href="createplan.c.html#LN6470"><span class='Ref_To_Local'>fdwroutine</span></a><span class='Operator'>-&GT;</span><a href="../../../include/foreign/fdwapi.h.html#LN194"><span class='Ref_to_Member'>PlanForeignModify</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>            <a href="createplan.c.html#LN6471"><span class='Ref_To_Local'>fdw_private</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6470"><span class='Ref_To_Local'>fdwroutine</span></a><span class='Operator'>-&GT;</span><a href="../../../include/foreign/fdwapi.h.html#LN194"><span class='Ref_to_Member'>PlanForeignModify</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6396"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN6469"><span class='Ref_To_Local'>rti</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN6407"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="createplan.c.html#LN6471"><span class='Ref_To_Local'>fdw_private</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN6404"><span class='Ref_To_Local'>fdw_private_list</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6404"><span class='Ref_To_Local'>fdw_private_list</span></a><span class='Delimiter'>, </span><a href="createplan.c.html#LN6471"><span class='Ref_To_Local'>fdw_private</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="createplan.c.html#LN6407"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN227"><span class='Ref_to_Member'>fdwPrivLists</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6404"><span class='Ref_To_Local'>fdw_private_list</span></a><span class='Delimiter'>; 
</span>    <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/plannodes.h.html#LN228"><span class='Ref_to_Member'>fdwDirectModifyPlans</span></a> <span class='Operator'>= </span><a href="createplan.c.html#LN6405"><span class='Ref_To_Local'>direct_modify_plans</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="createplan.c.html#LN6403"><span class='Ref_To_Local'>node</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_modifytable &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * is_projection_capable_path 
 *      Check whether a given Path node is able to do projection. 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN6534"></a><span class='Declare_Function'>is_projection_capable_path</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* Most plan types can project, so just list the ones that can't */ 
</span>    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="createplan.c.html#LN6534"><span class='Ref_to_Parameter'>path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN950"><span class='Ref_to_Member'>pathtype</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN81"><span class='Ref_to_EnumConst'>T_Hash</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN73"><span class='Ref_to_EnumConst'>T_Material</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN74"><span class='Ref_to_EnumConst'>T_Sort</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN78"><span class='Ref_to_EnumConst'>T_Unique</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN82"><span class='Ref_to_EnumConst'>T_SetOp</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN83"><span class='Ref_to_EnumConst'>T_LockRows</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN84"><span class='Ref_to_EnumConst'>T_Limit</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN46"><span class='Ref_to_EnumConst'>T_ModifyTable</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN48"><span class='Ref_to_EnumConst'>T_MergeAppend</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN49"><span class='Ref_to_EnumConst'>T_RecursiveUnion</span></a><span class='Operator'>: 
</span>            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN47"><span class='Ref_to_EnumConst'>T_Append</span></a><span class='Operator'>: 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Append can't project, but if it's being used to represent a 
             * dummy path, claim that it can project.  This prevents us from 
             * converting a rel from dummy to non-dummy status by applying a 
             * projection to its dummy path. 
             */ 
</span>            <span class='Control'>return</span> <a href="../../../include/nodes/relation.h.html#LN1182"><span class='Ref_to_Macro'>IS_DUMMY_PATH</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6534"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN45"><span class='Ref_to_EnumConst'>T_ProjectSet</span></a><span class='Operator'>: 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Although ProjectSet certainly projects, say "no" because we 
             * don't want the planner to randomly replace its tlist with 
             * something else; the SRFs have to stay at top level.  This might 
             * get relaxed later. 
             */ 
</span>            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch path-&GT;pathtype &raquo; </span> 
    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end is_projection_capable_path &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * is_projection_capable_plan 
 *      Check whether a given Plan node is able to do projection. 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN6579"></a><span class='Declare_Function'>is_projection_capable_plan</span><span class='Parentheses'>(</span><a href="../../../include/nodes/plannodes.h.html#LN117"><span class='Ref_to_Struct'>Plan</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>plan</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* Most plan types can project, so just list the ones that can't */ 
</span>    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN513"><span class='Ref_to_Macro'>nodeTag</span></a><span class='Parentheses'>(</span><a href="createplan.c.html#LN6579"><span class='Ref_to_Parameter'>plan</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN81"><span class='Ref_to_EnumConst'>T_Hash</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN73"><span class='Ref_to_EnumConst'>T_Material</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN74"><span class='Ref_to_EnumConst'>T_Sort</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN78"><span class='Ref_to_EnumConst'>T_Unique</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN82"><span class='Ref_to_EnumConst'>T_SetOp</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN83"><span class='Ref_to_EnumConst'>T_LockRows</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN84"><span class='Ref_to_EnumConst'>T_Limit</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN46"><span class='Ref_to_EnumConst'>T_ModifyTable</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN47"><span class='Ref_to_EnumConst'>T_Append</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN48"><span class='Ref_to_EnumConst'>T_MergeAppend</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN49"><span class='Ref_to_EnumConst'>T_RecursiveUnion</span></a><span class='Operator'>: 
</span>            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/nodes.h.html#LN45"><span class='Ref_to_EnumConst'>T_ProjectSet</span></a><span class='Operator'>: 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Although ProjectSet certainly projects, say "no" because we 
             * don't want the planner to randomly replace its tlist with 
             * something else; the SRFs have to stay at top level.  This might 
             * get relaxed later. 
             */ 
</span>            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch nodeTag(plan) &raquo; </span> 
    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end is_projection_capable_plan &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>