<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\backend\optimizer\util\relnode.c</title>
<LINK REL=StyleSheet HREF="../../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\backend\optimizer\util\relnode.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:43 2017
</td></tr>
<tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
</span><span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * relnode.c 
 *    Relation-node lookup/construction routines 
 * 
 * Portions Copyright (c) 1996-2017, PostgreSQL Global Development Group 
 * Portions Copyright (c) 1994, Regents of the University of California 
 * 
 * 
 * IDENTIFICATION 
 *    src/backend/optimizer/util/relnode.c 
 * 
 *------------------------------------------------------------------------- 
 */ 
</span><span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>&LT;limits.h&GT;</span> 
 
<span class='Keyword'>#include </span><span class='String'>"miscadmin.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/clauses.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/cost.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/pathnode.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/paths.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/placeholder.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/plancat.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/restrictinfo.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/tlist.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/hsearch.h"</span> 
 
 
<a name="LN30"></a><span class='Control'>typedef</span> <span class='Control'>struct</span> <span class='Declare_Struct'>JoinHashEntry</span> 
<span class='Delimiter'>{ 
</span><a name="LN32"></a>    <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a>      <span class='Declare_Member'>join_relids</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* hash key --- MUST BE FIRST */ 
</span><a name="LN33"></a>    <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Member'>join_rel</span><span class='Delimiter'>; 
</span><a name="LN34"></a>} <span class='Declare_Typedef'>JoinHashEntry</span><span class='Delimiter'>; 
</span> 
<a name="LN36"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>build_joinrel_tlist</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN37"></a>                    <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>input_rel</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN38"></a><span class='Keyword'>static </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>build_joinrel_restrictlist</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN39"></a>                           <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN40"></a>                           <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outer_rel</span><span class='Delimiter'>, 
</span><a name="LN41"></a>                           <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>inner_rel</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN42"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>build_joinrel_joinlist</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN43"></a>                       <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outer_rel</span><span class='Delimiter'>, 
</span><a name="LN44"></a>                       <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>inner_rel</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN45"></a><span class='Keyword'>static </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>subbuild_joinrel_restrictlist</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN46"></a>                              <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joininfo_list</span><span class='Delimiter'>, 
</span><a name="LN47"></a>                              <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>new_restrictlist</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN48"></a><span class='Keyword'>static </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>subbuild_joinrel_joinlist</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN49"></a>                          <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joininfo_list</span><span class='Delimiter'>, 
</span><a name="LN50"></a>                          <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>new_joininfo</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN51"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>set_foreign_rel_properties</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN52"></a>                           <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outer_rel</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>inner_rel</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN53"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>add_join_rel</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * setup_simple_rel_arrays 
 *    Prepare the arrays we use for quickly accessing base relations. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN61"></a><span class='Declare_Function'>setup_simple_rel_arrays</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN63"></a>    <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>       <span class='Declare_Local'>rti</span><span class='Delimiter'>; 
</span><a name="LN64"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Arrays are accessed using RT indexes (1..N) */ 
</span>    <a href="relnode.c.html#LN61"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN179"><span class='Ref_to_Member'>simple_rel_array_size</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN61"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN154"><span class='Ref_to_Member'>parse</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN134"><span class='Ref_to_Member'>rtable</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* simple_rel_array is initialized to all NULLs */ 
</span>    <a href="relnode.c.html#LN61"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN178"><span class='Ref_to_Member'>simple_rel_array</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>**</span><span class='Parentheses'>) 
</span>        <a href="../../../include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN61"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN179"><span class='Ref_to_Member'>simple_rel_array_size</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* simple_rte_array is an array equivalent of the rtable list */ 
</span>    <a href="relnode.c.html#LN61"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN187"><span class='Ref_to_Member'>simple_rte_array</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>**</span><span class='Parentheses'>) 
</span>        <a href="../../../include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN61"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN179"><span class='Ref_to_Member'>simple_rel_array_size</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN63"><span class='Ref_To_Local'>rti</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN64"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN61"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN154"><span class='Ref_to_Member'>parse</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN134"><span class='Ref_to_Member'>rtable</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN79"></a>        <a href="../../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN64"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="relnode.c.html#LN61"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN187"><span class='Ref_to_Member'>simple_rte_array</span></a><span class='Delimiter'>[</span><a href="relnode.c.html#LN63"><span class='Ref_To_Local'>rti</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="relnode.c.html#LN79"><span class='Ref_To_Local'>rte</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end setup_simple_rel_arrays &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * build_simple_rel 
 *    Construct a new RelOptInfo for a base relation or 'other' relation. 
 */ 
</span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>* 
</span><a name="LN90"></a><span class='Declare_Function'>build_simple_rel</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>relid</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>parent</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN92"></a>    <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rel</span><span class='Delimiter'>; 
</span><a name="LN93"></a>    <a href="../../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Rel should not exist already */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="relnode.c.html#LN90"><span class='Ref_to_Parameter'>relid</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="relnode.c.html#LN90"><span class='Ref_to_Parameter'>relid</span></a> <span class='Operator'>&LT; </span><a href="relnode.c.html#LN90"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN179"><span class='Ref_to_Member'>simple_rel_array_size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="relnode.c.html#LN90"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN178"><span class='Ref_to_Member'>simple_rel_array</span></a><span class='Delimiter'>[</span><a href="relnode.c.html#LN90"><span class='Ref_to_Parameter'>relid</span></a><span class='Delimiter'>] </span><span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"rel %d already exists"</span><span class='Delimiter'>, </span><a href="relnode.c.html#LN90"><span class='Ref_to_Parameter'>relid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Fetch RTE for relation */ 
</span>    <a href="relnode.c.html#LN93"><span class='Ref_To_Local'>rte</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN90"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN187"><span class='Ref_to_Member'>simple_rte_array</span></a><span class='Delimiter'>[</span><a href="relnode.c.html#LN90"><span class='Ref_to_Parameter'>relid</span></a><span class='Delimiter'>]; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="relnode.c.html#LN93"><span class='Ref_To_Local'>rte</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN521"><span class='Ref_to_Member'>reloptkind</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN90"><span class='Ref_to_Parameter'>parent</span></a> <span class='Operator'>? </span><a href="../../../include/nodes/relation.h.html#LN495"><span class='Ref_to_EnumConst'>RELOPT_OTHER_MEMBER_REL</span></a> <span class='Operator'>: </span><a href="../../../include/nodes/relation.h.html#LN493"><span class='Ref_to_EnumConst'>RELOPT_BASEREL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/bitmapset.h.html#LN67"><span class='Ref_to_Proto'>bms_make_singleton</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN90"><span class='Ref_to_Parameter'>relid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN527"><span class='Ref_to_Member'>rows</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* cheap startup cost is interesting iff not all tuples to be retrieved */ 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN530"><span class='Ref_to_Member'>consider_startup</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="relnode.c.html#LN90"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN290"><span class='Ref_to_Member'>tuple_fraction</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN531"><span class='Ref_to_Member'>consider_param_startup</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* might get changed later */ 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN532"><span class='Ref_to_Member'>consider_parallel</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* might get changed later */ 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN535"><span class='Ref_to_Member'>reltarget</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/tlist.h.html#LN57"><span class='Ref_to_Proto'>create_empty_pathtarget</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN538"><span class='Ref_to_Member'>pathlist</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN539"><span class='Ref_to_Member'>ppilist</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN540"><span class='Ref_to_Member'>partial_pathlist</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN541"><span class='Ref_to_Member'>cheapest_startup_path</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN542"><span class='Ref_to_Member'>cheapest_total_path</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN543"><span class='Ref_to_Member'>cheapest_unique_path</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN544"><span class='Ref_to_Member'>cheapest_parameterized_paths</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN548"><span class='Ref_to_Member'>direct_lateral_relids</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN549"><span class='Ref_to_Member'>lateral_relids</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN552"><span class='Ref_to_Member'>relid</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN90"><span class='Ref_to_Parameter'>relid</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN554"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN93"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* min_attr, max_attr, attr_needed, attr_widths are set below */ 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN559"><span class='Ref_to_Member'>lateral_vars</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN560"><span class='Ref_to_Member'>lateral_referencers</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN561"><span class='Ref_to_Member'>indexlist</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN562"><span class='Ref_to_Member'>statlist</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN563"><span class='Ref_to_Member'>pages</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN564"><span class='Ref_to_Member'>tuples</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN565"><span class='Ref_to_Member'>allvisfrac</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN566"><span class='Ref_to_Member'>subroot</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN567"><span class='Ref_to_Member'>subplan_params</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN568"><span class='Ref_to_Member'>rel_parallel_workers</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* set up in get_relation_info */ 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN571"><span class='Ref_to_Member'>serverid</span></a> <span class='Operator'>= </span><a href="../../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN572"><span class='Ref_to_Member'>userid</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN93"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1028"><span class='Ref_to_Member'>checkAsUser</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN573"><span class='Ref_to_Member'>useridiscurrent</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN575"><span class='Ref_to_Member'>fdwroutine</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN576"><span class='Ref_to_Member'>fdw_private</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN579"><span class='Ref_to_Member'>unique_for_rels</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN580"><span class='Ref_to_Member'>non_unique_for_rels</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN583"><span class='Ref_to_Member'>baserestrictinfo</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN585"><span class='Ref_to_Member'>baserestrictcost</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN44"><span class='Ref_to_Member'>startup</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN585"><span class='Ref_to_Member'>baserestrictcost</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN45"><span class='Ref_to_Member'>per_tuple</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN586"><span class='Ref_to_Member'>baserestrict_min_security</span></a> <span class='Operator'>= </span>UINT_MAX<span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN588"><span class='Ref_to_Member'>joininfo</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN590"><span class='Ref_to_Member'>has_eclass_joins</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Pass top parent's relids down the inheritance hierarchy. If the parent 
     * has top_parent_relids set, it's a direct or an indirect child of the 
     * top parent indicated by top_parent_relids. By extension this child is 
     * also an indirect child of that parent. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="relnode.c.html#LN90"><span class='Ref_to_Parameter'>parent</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="relnode.c.html#LN90"><span class='Ref_to_Parameter'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN593"><span class='Ref_to_Member'>top_parent_relids</span></a><span class='Parentheses'>) 
</span>            <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN593"><span class='Ref_to_Member'>top_parent_relids</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN90"><span class='Ref_to_Parameter'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN593"><span class='Ref_to_Member'>top_parent_relids</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN593"><span class='Ref_to_Member'>top_parent_relids</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/bitmapset.h.html#LN65"><span class='Ref_to_Proto'>bms_copy</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN90"><span class='Ref_to_Parameter'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
        <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN593"><span class='Ref_to_Member'>top_parent_relids</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Check type of rtable entry */ 
</span>    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="relnode.c.html#LN93"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/parsenodes.h.html#LN922"><span class='Ref_to_EnumConst'>RTE_RELATION</span></a><span class='Operator'>: 
</span>            <span class='Comment_Multi_Line'>/* Table --- retrieve statistics from the system catalogs */ 
</span>            <a href="../../../include/optimizer/plancat.h.html#LN27"><span class='Ref_to_Proto'>get_relation_info</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN90"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN93"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN947"><span class='Ref_to_Member'>relid</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN93"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1025"><span class='Ref_to_Member'>inh</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/parsenodes.h.html#LN923"><span class='Ref_to_EnumConst'>RTE_SUBQUERY</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/parsenodes.h.html#LN925"><span class='Ref_to_EnumConst'>RTE_FUNCTION</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/parsenodes.h.html#LN926"><span class='Ref_to_EnumConst'>RTE_TABLEFUNC</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/parsenodes.h.html#LN927"><span class='Ref_to_EnumConst'>RTE_VALUES</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/parsenodes.h.html#LN928"><span class='Ref_to_EnumConst'>RTE_CTE</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../../include/nodes/parsenodes.h.html#LN929"><span class='Ref_to_EnumConst'>RTE_NAMEDTUPLESTORE</span></a><span class='Operator'>: 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Subquery, function, tablefunc, or values list --- set up attr 
             * range and arrays 
             * 
             * Note: 0 is included in range to support whole-row Vars 
             */ 
</span>            <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN555"><span class='Ref_to_Member'>min_attr</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN556"><span class='Ref_to_Member'>max_attr</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN93"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN557"><span class='Ref_to_Member'>attr_needed</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>                <a href="../../../include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>((</span><a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN556"><span class='Ref_to_Member'>max_attr</span></a> <span class='Operator'>- </span><a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN555"><span class='Ref_to_Member'>min_attr</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN558"><span class='Ref_to_Member'>attr_widths</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>                <a href="../../../include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>((</span><a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN556"><span class='Ref_to_Member'>max_attr</span></a> <span class='Operator'>- </span><a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN555"><span class='Ref_to_Member'>min_attr</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized RTE kind: %d"</span><span class='Delimiter'>, 
</span>                 <span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="relnode.c.html#LN93"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch rte-&GT;rtekind &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Save the finished struct in the query's simple_rel_array */ 
</span>    <a href="relnode.c.html#LN90"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN178"><span class='Ref_to_Member'>simple_rel_array</span></a><span class='Delimiter'>[</span><a href="relnode.c.html#LN90"><span class='Ref_to_Parameter'>relid</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * This is a convenient spot at which to note whether rels participating 
     * in the query have any securityQuals attached.  If so, increase 
     * root-&GT;qual_security_level to ensure it's larger than the maximum 
     * security level needed for securityQuals. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="relnode.c.html#LN93"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1032"><span class='Ref_to_Member'>securityQuals</span></a><span class='Parentheses'>) 
</span>        <a href="relnode.c.html#LN90"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN293"><span class='Ref_to_Member'>qual_security_level</span></a> <span class='Operator'>= </span><a href="../../../interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN90"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN293"><span class='Ref_to_Member'>qual_security_level</span></a><span class='Delimiter'>, 
</span>                                        <a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN93"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1032"><span class='Ref_to_Member'>securityQuals</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If this rel is an appendrel parent, recurse to build "other rel" 
     * RelOptInfos for its children.  They are "other rels" because they are 
     * not in the main join tree, but we will need RelOptInfos to plan access 
     * to them. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="relnode.c.html#LN93"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/parsenodes.h.html#LN1025"><span class='Ref_to_Member'>inh</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN219"></a>        <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
        <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN219"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN90"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN251"><span class='Ref_to_Member'>append_rel_list</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN223"></a>            <a href="../../../include/nodes/relation.h.html#LN1964"><span class='Ref_to_Struct'>AppendRelInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>appinfo</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1964"><span class='Ref_to_Struct'>AppendRelInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN219"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* append_rel_list contains all append rels; ignore others */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="relnode.c.html#LN223"><span class='Ref_To_Local'>appinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1974"><span class='Ref_to_Member'>parent_relid</span></a> <span class='Operator'>!= </span><a href="relnode.c.html#LN90"><span class='Ref_to_Parameter'>relid</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
            <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="relnode.c.html#LN89"><span class='Ref_to_Func'>build_simple_rel</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN90"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN223"><span class='Ref_To_Local'>appinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1975"><span class='Ref_to_Member'>child_relid</span></a><span class='Delimiter'>, 
</span>                                    <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="relnode.c.html#LN92"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end build_simple_rel &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * find_base_rel 
 *    Find a base or other relation entry, which must already exist. 
 */ 
</span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>* 
</span><a name="LN242"></a><span class='Declare_Function'>find_base_rel</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>relid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN244"></a>    <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rel</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="relnode.c.html#LN242"><span class='Ref_to_Parameter'>relid</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="relnode.c.html#LN242"><span class='Ref_to_Parameter'>relid</span></a> <span class='Operator'>&LT; </span><a href="relnode.c.html#LN242"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN179"><span class='Ref_to_Member'>simple_rel_array_size</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="relnode.c.html#LN244"><span class='Ref_To_Local'>rel</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN242"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN178"><span class='Ref_to_Member'>simple_rel_array</span></a><span class='Delimiter'>[</span><a href="relnode.c.html#LN242"><span class='Ref_to_Parameter'>relid</span></a><span class='Delimiter'>]; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="relnode.c.html#LN244"><span class='Ref_To_Local'>rel</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <a href="relnode.c.html#LN244"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"no relation entry for relid %d"</span><span class='Delimiter'>, </span><a href="relnode.c.html#LN242"><span class='Ref_to_Parameter'>relid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span><span class='Delimiter'>} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * build_join_rel_hash 
 *    Construct the auxiliary hash table for join relations. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN265"></a><span class='Declare_Function'>build_join_rel_hash</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN267"></a>    <a href="../../utils/hash/dynahash.c.html#LN192"><span class='Ref_to_Struct'>HTAB</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>hashtab</span><span class='Delimiter'>; 
</span><a name="LN268"></a>    <a href="../../../include/utils/hsearch.h.html#LN64"><span class='Ref_to_Struct'>HASHCTL</span></a>     <span class='Declare_Local'>hash_ctl</span><span class='Delimiter'>; 
</span><a name="LN269"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Create the hash table */ 
</span>    <a href="../../../include/c.h.html#LN856"><span class='Ref_to_Macro'>MemSet</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="relnode.c.html#LN268"><span class='Ref_To_Local'>hash_ctl</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="relnode.c.html#LN268"><span class='Ref_To_Local'>hash_ctl</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN268"><span class='Ref_To_Local'>hash_ctl</span></a><span class='Operator'>.</span><a href="../../../include/utils/hsearch.h.html#LN71"><span class='Ref_to_Member'>keysize</span></a> <span class='Operator'>= </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN268"><span class='Ref_To_Local'>hash_ctl</span></a><span class='Operator'>.</span><a href="../../../include/utils/hsearch.h.html#LN72"><span class='Ref_to_Member'>entrysize</span></a> <span class='Operator'>= </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="relnode.c.html#LN30"><span class='Ref_to_Struct'>JoinHashEntry</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN268"><span class='Ref_To_Local'>hash_ctl</span></a><span class='Operator'>.</span><a href="../../../include/utils/hsearch.h.html#LN73"><span class='Ref_to_Member'>hash</span></a> <span class='Operator'>= </span><a href="../../utils/hash/hashfn.c.html#LN74"><span class='Ref_to_Func'>bitmap_hash</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN268"><span class='Ref_To_Local'>hash_ctl</span></a><span class='Operator'>.</span><a href="../../../include/utils/hsearch.h.html#LN74"><span class='Ref_to_Member'>match</span></a> <span class='Operator'>= </span><a href="../../utils/hash/hashfn.c.html#LN84"><span class='Ref_to_Func'>bitmap_match</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN268"><span class='Ref_To_Local'>hash_ctl</span></a><span class='Operator'>.</span><a href="../../../include/utils/hsearch.h.html#LN77"><span class='Ref_to_Member'>hcxt</span></a> <span class='Operator'>= </span><a href="../../utils/mmgr/mcxt.c.html#LN36"><span class='Ref_to_Global_Var'>CurrentMemoryContext</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN267"><span class='Ref_To_Local'>hashtab</span></a> <span class='Operator'>= </span><a href="../../../include/utils/hsearch.h.html#LN121"><span class='Ref_to_Proto'>hash_create</span></a><span class='Parentheses'>(</span><span class='String'>"JoinRelHashTable"</span><span class='Delimiter'>, 
</span>                          <span class='Number'>256L</span><span class='Delimiter'>, 
</span>                          <span class='Operator'>&</span><a href="relnode.c.html#LN268"><span class='Ref_To_Local'>hash_ctl</span></a><span class='Delimiter'>, 
</span>                    <a href="../../../include/utils/hsearch.h.html#LN86"><span class='Ref_to_Const'>HASH_ELEM</span></a> <span class='Operator'>| </span><a href="../../../include/utils/hsearch.h.html#LN88"><span class='Ref_to_Const'>HASH_FUNCTION</span></a> <span class='Operator'>| </span><a href="../../../include/utils/hsearch.h.html#LN89"><span class='Ref_to_Const'>HASH_COMPARE</span></a> <span class='Operator'>| </span><a href="../../../include/utils/hsearch.h.html#LN92"><span class='Ref_to_Const'>HASH_CONTEXT</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Insert all the already-existing joinrels */ 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN269"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN265"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN214"><span class='Ref_to_Member'>join_rel_list</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN286"></a>        <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rel</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN269"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN287"></a>        <a href="relnode.c.html#LN30"><span class='Ref_to_Struct'>JoinHashEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>hentry</span><span class='Delimiter'>; 
</span><a name="LN288"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>found</span><span class='Delimiter'>; 
</span> 
        <a href="relnode.c.html#LN287"><span class='Ref_To_Local'>hentry</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="relnode.c.html#LN30"><span class='Ref_to_Struct'>JoinHashEntry</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/utils/hsearch.h.html#LN125"><span class='Ref_to_Proto'>hash_search</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN267"><span class='Ref_To_Local'>hashtab</span></a><span class='Delimiter'>, 
</span>                                               <span class='Operator'>&</span><span class='Parentheses'>(</span><a href="relnode.c.html#LN286"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                               <a href="../../../include/utils/hsearch.h.html#LN105"><span class='Ref_to_EnumConst'>HASH_ENTER</span></a><span class='Delimiter'>, 
</span>                                               <span class='Operator'>&</span><a href="relnode.c.html#LN288"><span class='Ref_To_Local'>found</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="relnode.c.html#LN288"><span class='Ref_To_Local'>found</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="relnode.c.html#LN287"><span class='Ref_To_Local'>hentry</span></a><span class='Operator'>-&GT;</span><a href="relnode.c.html#LN33"><span class='Ref_to_Member'>join_rel</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN286"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="relnode.c.html#LN265"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN215"><span class='Ref_to_Member'>join_rel_hash</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN267"><span class='Ref_To_Local'>hashtab</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end build_join_rel_hash &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * find_join_rel 
 *    Returns relation entry corresponding to 'relids' (a set of RT indexes), 
 *    or NULL if none exists.  This is for join relations. 
 */ 
</span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>* 
</span><a name="LN307"></a><span class='Declare_Function'>find_join_rel</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a> <span class='Declare_Parameter'>relids</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* 
     * Switch to using hash lookup when list grows "too long".  The threshold 
     * is arbitrary and is known only here. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="relnode.c.html#LN307"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN215"><span class='Ref_to_Member'>join_rel_hash</span></a> <span class='Operator'>&& </span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN307"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN214"><span class='Ref_to_Member'>join_rel_list</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><span class='Number'>32</span><span class='Parentheses'>)</span> 
        <a href="relnode.c.html#LN264"><span class='Ref_to_Func'>build_join_rel_hash</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN307"><span class='Ref_to_Parameter'>root</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Use either hashtable lookup or linear search, as appropriate. 
     * 
     * Note: the seemingly redundant hashkey variable is used to avoid taking 
     * the address of relids; unless the compiler is exceedingly smart, doing 
     * so would force relids out of a register and thus probably slow down the 
     * list-search case. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="relnode.c.html#LN307"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN215"><span class='Ref_to_Member'>join_rel_hash</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN326"></a>        <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a>      <span class='Declare_Local'>hashkey</span> <span class='Operator'>= </span><a href="relnode.c.html#LN307"><span class='Ref_to_Parameter'>relids</span></a><span class='Delimiter'>; 
</span><a name="LN327"></a>        <a href="relnode.c.html#LN30"><span class='Ref_to_Struct'>JoinHashEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>hentry</span><span class='Delimiter'>; 
</span> 
        <a href="relnode.c.html#LN327"><span class='Ref_To_Local'>hentry</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="relnode.c.html#LN30"><span class='Ref_to_Struct'>JoinHashEntry</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/utils/hsearch.h.html#LN125"><span class='Ref_to_Proto'>hash_search</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN307"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN215"><span class='Ref_to_Member'>join_rel_hash</span></a><span class='Delimiter'>, 
</span>                                               <span class='Operator'>&</span><a href="relnode.c.html#LN326"><span class='Ref_To_Local'>hashkey</span></a><span class='Delimiter'>, 
</span>                                               <a href="../../../include/utils/hsearch.h.html#LN104"><span class='Ref_to_EnumConst'>HASH_FIND</span></a><span class='Delimiter'>, 
</span>                                               <span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="relnode.c.html#LN327"><span class='Ref_To_Local'>hentry</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <a href="relnode.c.html#LN327"><span class='Ref_To_Local'>hentry</span></a><span class='Operator'>-&GT;</span><a href="relnode.c.html#LN33"><span class='Ref_to_Member'>join_rel</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span><a name="LN338"></a>        <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
        <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN338"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN307"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN214"><span class='Ref_to_Member'>join_rel_list</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN342"></a>            <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rel</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN338"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/bitmapset.h.html#LN66"><span class='Ref_to_Proto'>bms_equal</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN342"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN307"><span class='Ref_to_Parameter'>relids</span></a><span class='Parentheses'>))</span> 
                <span class='Control'>return</span> <a href="relnode.c.html#LN342"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end find_join_rel &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * set_foreign_rel_properties 
 *      Set up foreign-join fields if outer and inner relation are foreign 
 *      tables (or joins) belonging to the same server and assigned to the same 
 *      user to check access permissions as. 
 * 
 * In addition to an exact match of userid, we allow the case where one side 
 * has zero userid (implying current user) and the other side has explicit 
 * userid that happens to equal the current user; but in that case, pushdown of 
 * the join is only valid for the current user.  The useridiscurrent field 
 * records whether we had to make such an assumption for this join or any 
 * sub-join. 
 * 
 * Otherwise these fields are left invalid, so GetForeignJoinPaths will not be 
 * called for the join relation. 
 * 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN370"></a><span class='Declare_Function'>set_foreign_rel_properties</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outer_rel</span><span class='Delimiter'>, 
</span><a name="LN371"></a>                           <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>inner_rel</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN571"><span class='Ref_to_Member'>serverid</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>        <a href="relnode.c.html#LN371"><span class='Ref_to_Parameter'>inner_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN571"><span class='Ref_to_Member'>serverid</span></a> <span class='Operator'>== </span><a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN571"><span class='Ref_to_Member'>serverid</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="relnode.c.html#LN371"><span class='Ref_to_Parameter'>inner_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN572"><span class='Ref_to_Member'>userid</span></a> <span class='Operator'>== </span><a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN572"><span class='Ref_to_Member'>userid</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN571"><span class='Ref_to_Member'>serverid</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN571"><span class='Ref_to_Member'>serverid</span></a><span class='Delimiter'>; 
</span>            <a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN572"><span class='Ref_to_Member'>userid</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN572"><span class='Ref_to_Member'>userid</span></a><span class='Delimiter'>; 
</span>            <a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN573"><span class='Ref_to_Member'>useridiscurrent</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN573"><span class='Ref_to_Member'>useridiscurrent</span></a> <span class='Operator'>|| </span><a href="relnode.c.html#LN371"><span class='Ref_to_Parameter'>inner_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN573"><span class='Ref_to_Member'>useridiscurrent</span></a><span class='Delimiter'>; 
</span>            <a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN575"><span class='Ref_to_Member'>fdwroutine</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN575"><span class='Ref_to_Member'>fdwroutine</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN371"><span class='Ref_to_Parameter'>inner_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN572"><span class='Ref_to_Member'>userid</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>                 <a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN572"><span class='Ref_to_Member'>userid</span></a> <span class='Operator'>== </span><a href="../../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>())</span> 
        <span class='Delimiter'>{ 
</span>            <a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN571"><span class='Ref_to_Member'>serverid</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN571"><span class='Ref_to_Member'>serverid</span></a><span class='Delimiter'>; 
</span>            <a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN572"><span class='Ref_to_Member'>userid</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN572"><span class='Ref_to_Member'>userid</span></a><span class='Delimiter'>; 
</span>            <a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN573"><span class='Ref_to_Member'>useridiscurrent</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN575"><span class='Ref_to_Member'>fdwroutine</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN575"><span class='Ref_to_Member'>fdwroutine</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN572"><span class='Ref_to_Member'>userid</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>                 <a href="relnode.c.html#LN371"><span class='Ref_to_Parameter'>inner_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN572"><span class='Ref_to_Member'>userid</span></a> <span class='Operator'>== </span><a href="../../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>())</span> 
        <span class='Delimiter'>{ 
</span>            <a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN571"><span class='Ref_to_Member'>serverid</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN571"><span class='Ref_to_Member'>serverid</span></a><span class='Delimiter'>; 
</span>            <a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN572"><span class='Ref_to_Member'>userid</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN371"><span class='Ref_to_Parameter'>inner_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN572"><span class='Ref_to_Member'>userid</span></a><span class='Delimiter'>; 
</span>            <a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN573"><span class='Ref_to_Member'>useridiscurrent</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN575"><span class='Ref_to_Member'>fdwroutine</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN370"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN575"><span class='Ref_to_Member'>fdwroutine</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if OidIsValid(outer_rel-... &raquo; </span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end set_foreign_rel_properties &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * add_join_rel 
 *      Add given join relation to the list of join relations in the given 
 *      PlannerInfo. Also add it to the auxiliary hashtable if there is one. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN408"></a><span class='Declare_Function'>add_join_rel</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* GEQO requires us to append the new joinrel to the end of the list! */ 
</span>    <a href="relnode.c.html#LN408"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN214"><span class='Ref_to_Member'>join_rel_list</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN408"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN214"><span class='Ref_to_Member'>join_rel_list</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN408"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* store it into the auxiliary hashtable if there is one. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="relnode.c.html#LN408"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN215"><span class='Ref_to_Member'>join_rel_hash</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN416"></a>        <a href="relnode.c.html#LN30"><span class='Ref_to_Struct'>JoinHashEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>hentry</span><span class='Delimiter'>; 
</span><a name="LN417"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>found</span><span class='Delimiter'>; 
</span> 
        <a href="relnode.c.html#LN416"><span class='Ref_To_Local'>hentry</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="relnode.c.html#LN30"><span class='Ref_to_Struct'>JoinHashEntry</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/utils/hsearch.h.html#LN125"><span class='Ref_to_Proto'>hash_search</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN408"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN215"><span class='Ref_to_Member'>join_rel_hash</span></a><span class='Delimiter'>, 
</span>                                               <span class='Operator'>&</span><span class='Parentheses'>(</span><a href="relnode.c.html#LN408"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                               <a href="../../../include/utils/hsearch.h.html#LN105"><span class='Ref_to_EnumConst'>HASH_ENTER</span></a><span class='Delimiter'>, 
</span>                                               <span class='Operator'>&</span><a href="relnode.c.html#LN417"><span class='Ref_To_Local'>found</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="relnode.c.html#LN417"><span class='Ref_To_Local'>found</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="relnode.c.html#LN416"><span class='Ref_To_Local'>hentry</span></a><span class='Operator'>-&GT;</span><a href="relnode.c.html#LN33"><span class='Ref_to_Member'>join_rel</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN408"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end add_join_rel &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * build_join_rel 
 *    Returns relation entry corresponding to the union of two given rels, 
 *    creating a new relation entry if none already exists. 
 * 
 * 'joinrelids' is the Relids set that uniquely identifies the join 
 * 'outer_rel' and 'inner_rel' are relation nodes for the relations to be 
 *      joined 
 * 'sjinfo': join context info 
 * 'restrictlist_ptr': result variable.  If not NULL, *restrictlist_ptr 
 *      receives the list of RestrictInfo nodes that apply to this 
 *      particular pair of joinable relations. 
 * 
 * restrictlist_ptr makes the routine's API a little grotty, but it saves 
 * duplicated calculation of the restrictlist... 
 */ 
</span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>* 
</span><a name="LN445"></a><span class='Declare_Function'>build_join_rel</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN446"></a>               <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a> <span class='Declare_Parameter'>joinrelids</span><span class='Delimiter'>, 
</span><a name="LN447"></a>               <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outer_rel</span><span class='Delimiter'>, 
</span><a name="LN448"></a>               <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>inner_rel</span><span class='Delimiter'>, 
</span><a name="LN449"></a>               <a href="../../../include/nodes/relation.h.html#LN1913"><span class='Ref_to_Struct'>SpecialJoinInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>sjinfo</span><span class='Delimiter'>, 
</span><a name="LN450"></a>               <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>restrictlist_ptr</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN452"></a>    <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>joinrel</span><span class='Delimiter'>; 
</span><a name="LN453"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>restrictlist</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * See if we already have a joinrel for this set of base rels. 
     */ 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/pathnode.h.html#LN258"><span class='Ref_to_Proto'>find_join_rel</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN445"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN446"><span class='Ref_to_Parameter'>joinrelids</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Yes, so we only need to figure the restrictlist for this particular 
         * pair of component relations. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="relnode.c.html#LN450"><span class='Ref_to_Parameter'>restrictlist_ptr</span></a><span class='Parentheses'>) 
</span>            <span class='Operator'>*</span><a href="relnode.c.html#LN450"><span class='Ref_to_Parameter'>restrictlist_ptr</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN38"><span class='Ref_to_Proto'>build_joinrel_restrictlist</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN445"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                           <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Delimiter'>, 
</span>                                                           <a href="relnode.c.html#LN447"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Delimiter'>, 
</span>                                                           <a href="relnode.c.html#LN448"><span class='Ref_to_Parameter'>inner_rel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Nope, so make one. 
     */ 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN521"><span class='Ref_to_Member'>reloptkind</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/relation.h.html#LN494"><span class='Ref_to_EnumConst'>RELOPT_JOINREL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/bitmapset.h.html#LN65"><span class='Ref_to_Proto'>bms_copy</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN446"><span class='Ref_to_Parameter'>joinrelids</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN527"><span class='Ref_to_Member'>rows</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* cheap startup cost is interesting iff not all tuples to be retrieved */ 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN530"><span class='Ref_to_Member'>consider_startup</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="relnode.c.html#LN445"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN290"><span class='Ref_to_Member'>tuple_fraction</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN531"><span class='Ref_to_Member'>consider_param_startup</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN532"><span class='Ref_to_Member'>consider_parallel</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN535"><span class='Ref_to_Member'>reltarget</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/tlist.h.html#LN57"><span class='Ref_to_Proto'>create_empty_pathtarget</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN538"><span class='Ref_to_Member'>pathlist</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN539"><span class='Ref_to_Member'>ppilist</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN540"><span class='Ref_to_Member'>partial_pathlist</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN541"><span class='Ref_to_Member'>cheapest_startup_path</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN542"><span class='Ref_to_Member'>cheapest_total_path</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN543"><span class='Ref_to_Member'>cheapest_unique_path</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN544"><span class='Ref_to_Member'>cheapest_parameterized_paths</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* init direct_lateral_relids from children; we'll finish it up below */ 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN548"><span class='Ref_to_Member'>direct_lateral_relids</span></a> <span class='Operator'>= 
</span>        <a href="../../../include/nodes/bitmapset.h.html#LN70"><span class='Ref_to_Proto'>bms_union</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN447"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN548"><span class='Ref_to_Member'>direct_lateral_relids</span></a><span class='Delimiter'>, 
</span>                  <a href="relnode.c.html#LN448"><span class='Ref_to_Parameter'>inner_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN548"><span class='Ref_to_Member'>direct_lateral_relids</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN549"><span class='Ref_to_Member'>lateral_relids</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/pathnode.h.html#LN265"><span class='Ref_to_Proto'>min_join_parameterization</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN445"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, 
</span>                                                        <a href="relnode.c.html#LN447"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN448"><span class='Ref_to_Parameter'>inner_rel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN552"><span class='Ref_to_Member'>relid</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>;</span>         <span class='Comment_Single_Line'>/* indicates not a baserel */ 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN554"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/parsenodes.h.html#LN924"><span class='Ref_to_EnumConst'>RTE_JOIN</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN555"><span class='Ref_to_Member'>min_attr</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN556"><span class='Ref_to_Member'>max_attr</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN557"><span class='Ref_to_Member'>attr_needed</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN558"><span class='Ref_to_Member'>attr_widths</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN559"><span class='Ref_to_Member'>lateral_vars</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN560"><span class='Ref_to_Member'>lateral_referencers</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN561"><span class='Ref_to_Member'>indexlist</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN562"><span class='Ref_to_Member'>statlist</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN563"><span class='Ref_to_Member'>pages</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN564"><span class='Ref_to_Member'>tuples</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN565"><span class='Ref_to_Member'>allvisfrac</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN566"><span class='Ref_to_Member'>subroot</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN567"><span class='Ref_to_Member'>subplan_params</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN568"><span class='Ref_to_Member'>rel_parallel_workers</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN571"><span class='Ref_to_Member'>serverid</span></a> <span class='Operator'>= </span><a href="../../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN572"><span class='Ref_to_Member'>userid</span></a> <span class='Operator'>= </span><a href="../../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN573"><span class='Ref_to_Member'>useridiscurrent</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN575"><span class='Ref_to_Member'>fdwroutine</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN576"><span class='Ref_to_Member'>fdw_private</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN579"><span class='Ref_to_Member'>unique_for_rels</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN580"><span class='Ref_to_Member'>non_unique_for_rels</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN583"><span class='Ref_to_Member'>baserestrictinfo</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN585"><span class='Ref_to_Member'>baserestrictcost</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN44"><span class='Ref_to_Member'>startup</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN585"><span class='Ref_to_Member'>baserestrictcost</span></a><span class='Operator'>.</span><a href="../../../include/nodes/relation.h.html#LN45"><span class='Ref_to_Member'>per_tuple</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN586"><span class='Ref_to_Member'>baserestrict_min_security</span></a> <span class='Operator'>= </span>UINT_MAX<span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN588"><span class='Ref_to_Member'>joininfo</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN590"><span class='Ref_to_Member'>has_eclass_joins</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN593"><span class='Ref_to_Member'>top_parent_relids</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Compute information relevant to the foreign relations. */ 
</span>    <a href="relnode.c.html#LN51"><span class='Ref_to_Proto'>set_foreign_rel_properties</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN447"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN448"><span class='Ref_to_Parameter'>inner_rel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Create a new tlist containing just the vars that need to be output from 
     * this join (ie, are needed for higher joinclauses or final output). 
     * 
     * NOTE: the tlist order for a join rel will depend on which pair of outer 
     * and inner rels we first try to build it from.  But the contents should 
     * be the same regardless. 
     */ 
</span>    <a href="relnode.c.html#LN36"><span class='Ref_to_Proto'>build_joinrel_tlist</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN445"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN447"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN36"><span class='Ref_to_Proto'>build_joinrel_tlist</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN445"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN448"><span class='Ref_to_Parameter'>inner_rel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/optimizer/placeholder.h.html#LN28"><span class='Ref_to_Proto'>add_placeholders_to_joinrel</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN445"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN447"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN448"><span class='Ref_to_Parameter'>inner_rel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * add_placeholders_to_joinrel also took care of adding the ph_lateral 
     * sets of any PlaceHolderVars computed here to direct_lateral_relids, so 
     * now we can finish computing that.  This is much like the computation of 
     * the transitively-closed lateral_relids in min_join_parameterization, 
     * except that here we *do* have to consider the added PHVs. 
     */ 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN548"><span class='Ref_to_Member'>direct_lateral_relids</span></a> <span class='Operator'>= 
</span>        <a href="../../../include/nodes/bitmapset.h.html#LN93"><span class='Ref_to_Proto'>bms_del_members</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN548"><span class='Ref_to_Member'>direct_lateral_relids</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/bitmapset.h.html#LN85"><span class='Ref_to_Proto'>bms_is_empty</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN548"><span class='Ref_to_Member'>direct_lateral_relids</span></a><span class='Parentheses'>))</span> 
        <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN548"><span class='Ref_to_Member'>direct_lateral_relids</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Construct restrict and join clause lists for the new joinrel. (The 
     * caller might or might not need the restrictlist, but I need it anyway 
     * for set_joinrel_size_estimates().) 
     */ 
</span>    <a href="relnode.c.html#LN453"><span class='Ref_To_Local'>restrictlist</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN38"><span class='Ref_to_Proto'>build_joinrel_restrictlist</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN445"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Delimiter'>, 
</span>                                              <a href="relnode.c.html#LN447"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN448"><span class='Ref_to_Parameter'>inner_rel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="relnode.c.html#LN450"><span class='Ref_to_Parameter'>restrictlist_ptr</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="relnode.c.html#LN450"><span class='Ref_to_Parameter'>restrictlist_ptr</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN453"><span class='Ref_To_Local'>restrictlist</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN42"><span class='Ref_to_Proto'>build_joinrel_joinlist</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN447"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN448"><span class='Ref_to_Parameter'>inner_rel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * This is also the right place to check whether the joinrel has any 
     * pending EquivalenceClass joins. 
     */ 
</span>    <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN590"><span class='Ref_to_Member'>has_eclass_joins</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/paths.h.html#LN163"><span class='Ref_to_Proto'>has_relevant_eclass_joinclause</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN445"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Set estimates of the joinrel's size. 
     */ 
</span>    <a href="../../../include/optimizer/cost.h.html#LN176"><span class='Ref_to_Proto'>set_joinrel_size_estimates</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN445"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN447"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN448"><span class='Ref_to_Parameter'>inner_rel</span></a><span class='Delimiter'>, 
</span>                               <a href="relnode.c.html#LN449"><span class='Ref_to_Parameter'>sjinfo</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN453"><span class='Ref_To_Local'>restrictlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Set the consider_parallel flag if this joinrel could potentially be 
     * scanned within a parallel worker.  If this flag is false for either 
     * inner_rel or outer_rel, then it must be false for the joinrel also. 
     * Even if both are true, there might be parallel-restricted expressions 
     * in the targetlist or quals. 
     * 
     * Note that if there are more than two rels in this relation, they could 
     * be divided between inner_rel and outer_rel in any arbitrary way.  We 
     * assume this doesn't matter, because we should hit all the same baserels 
     * and joinclauses while building up to this joinrel no matter which we 
     * take; therefore, we should make the same decision here however we get 
     * here. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="relnode.c.html#LN448"><span class='Ref_to_Parameter'>inner_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN532"><span class='Ref_to_Member'>consider_parallel</span></a> <span class='Operator'>&& </span><a href="relnode.c.html#LN447"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN532"><span class='Ref_to_Member'>consider_parallel</span></a> <span class='Operator'>&& 
</span>        <a href="../../../include/optimizer/clauses.h.html#LN63"><span class='Ref_to_Proto'>is_parallel_safe</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN445"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="relnode.c.html#LN453"><span class='Ref_To_Local'>restrictlist</span></a><span class='Parentheses'>)</span> <span class='Operator'>&& 
</span>        <a href="../../../include/optimizer/clauses.h.html#LN63"><span class='Ref_to_Proto'>is_parallel_safe</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN445"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN535"><span class='Ref_to_Member'>reltarget</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN882"><span class='Ref_to_Member'>exprs</span></a><span class='Parentheses'>))</span> 
        <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN532"><span class='Ref_to_Member'>consider_parallel</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Add the joinrel to the PlannerInfo. */ 
</span>    <a href="relnode.c.html#LN53"><span class='Ref_to_Proto'>add_join_rel</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN445"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Also, if dynamic-programming join search is active, add the new joinrel 
     * to the appropriate sublist.  Note: you might think the Assert on number 
     * of members should be for equality, but some of the level 1 rels might 
     * have been joinrels already, so we can only assert &LT;=. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="relnode.c.html#LN445"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN224"><span class='Ref_to_Member'>join_rel_level</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="relnode.c.html#LN445"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN225"><span class='Ref_to_Member'>join_cur_level</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="relnode.c.html#LN445"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN225"><span class='Ref_to_Member'>join_cur_level</span></a> <span class='Operator'>&LT;= </span><a href="../../../include/nodes/bitmapset.h.html#LN81"><span class='Ref_to_Proto'>bms_num_members</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="relnode.c.html#LN445"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN224"><span class='Ref_to_Member'>join_rel_level</span></a><span class='Delimiter'>[</span><a href="relnode.c.html#LN445"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN225"><span class='Ref_to_Member'>join_cur_level</span></a><span class='Delimiter'>] </span><span class='Operator'>= 
</span>            <a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN445"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN224"><span class='Ref_to_Member'>join_rel_level</span></a><span class='Delimiter'>[</span><a href="relnode.c.html#LN445"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN225"><span class='Ref_to_Member'>join_cur_level</span></a><span class='Delimiter'>], </span><a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="relnode.c.html#LN452"><span class='Ref_To_Local'>joinrel</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end build_join_rel &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * min_join_parameterization 
 * 
 * Determine the minimum possible parameterization of a joinrel, that is, the 
 * set of other rels it contains LATERAL references to.  We save this value in 
 * the join's RelOptInfo.  This function is split out of build_join_rel() 
 * because join_is_legal() needs the value to check a prospective join. 
 */ 
</span><a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a> 
<a name="LN628"></a><span class='Declare_Function'>min_join_parameterization</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN629"></a>                          <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a> <span class='Declare_Parameter'>joinrelids</span><span class='Delimiter'>, 
</span><a name="LN630"></a>                          <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outer_rel</span><span class='Delimiter'>, 
</span><a name="LN631"></a>                          <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>inner_rel</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN633"></a>    <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a>      <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Basically we just need the union of the inputs' lateral_relids, less 
     * whatever is already in the join. 
     * 
     * It's not immediately obvious that this is a valid way to compute the 
     * result, because it might seem that we're ignoring possible lateral refs 
     * of PlaceHolderVars that are due to be computed at the join but not in 
     * either input.  However, because create_lateral_join_info() already 
     * charged all such PHV refs to each member baserel of the join, they'll 
     * be accounted for already in the inputs' lateral_relids.  Likewise, we 
     * do not need to worry about doing transitive closure here, because that 
     * was already accounted for in the original baserel lateral_relids. 
     */ 
</span>    <a href="relnode.c.html#LN633"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/bitmapset.h.html#LN70"><span class='Ref_to_Proto'>bms_union</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN630"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN549"><span class='Ref_to_Member'>lateral_relids</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN631"><span class='Ref_to_Parameter'>inner_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN549"><span class='Ref_to_Member'>lateral_relids</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN633"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/bitmapset.h.html#LN93"><span class='Ref_to_Proto'>bms_del_members</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN633"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN629"><span class='Ref_to_Parameter'>joinrelids</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Maintain invariant that result is exactly NULL if empty */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/bitmapset.h.html#LN85"><span class='Ref_to_Proto'>bms_is_empty</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN633"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span> 
        <a href="relnode.c.html#LN633"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="relnode.c.html#LN633"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end min_join_parameterization &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * build_joinrel_tlist 
 *    Builds a join relation's target list from an input relation. 
 *    (This is invoked twice to handle the two input relations.) 
 * 
 * The join's targetlist includes all Vars of its member relations that 
 * will still be needed above the join.  This subroutine adds all such 
 * Vars from the specified input rel's tlist to the join rel's tlist. 
 * 
 * We also compute the expected width of the join's output, making use 
 * of data that was cached at the baserel level by set_rel_width(). 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN671"></a><span class='Declare_Function'>build_joinrel_tlist</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN672"></a>                    <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>input_rel</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN674"></a>    <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a>      <span class='Declare_Local'>relids</span> <span class='Operator'>= </span><a href="relnode.c.html#LN671"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>; 
</span><a name="LN675"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>vars</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN675"><span class='Ref_To_Local'>vars</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN672"><span class='Ref_to_Parameter'>input_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN535"><span class='Ref_to_Member'>reltarget</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN882"><span class='Ref_to_Member'>exprs</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN679"></a>        <a href="../../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>var</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN675"><span class='Ref_To_Local'>vars</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN680"></a>        <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>baserel</span><span class='Delimiter'>; 
</span><a name="LN681"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>ndx</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Ignore PlaceHolderVars in the input tlists; we'll make our own 
         * decisions about whether to copy them. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN679"><span class='Ref_To_Local'>var</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN1846"><span class='Ref_to_Struct'>PlaceHolderVar</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Otherwise, anything in a baserel or joinrel targetlist ought to be 
         * a Var.  (More general cases can only appear in appendrel child 
         * rels, which will never be seen here.) 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN679"><span class='Ref_To_Local'>var</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a><span class='Parentheses'>))</span> 
            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unexpected node type in rel targetlist: %d"</span><span class='Delimiter'>, 
</span>                 <span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="../../../include/nodes/nodes.h.html#LN513"><span class='Ref_to_Macro'>nodeTag</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN679"><span class='Ref_To_Local'>var</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Get the Var's original base rel */ 
</span>        <a href="relnode.c.html#LN680"><span class='Ref_To_Local'>baserel</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN241"><span class='Ref_to_Func'>find_base_rel</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN671"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN679"><span class='Ref_To_Local'>var</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN165"><span class='Ref_to_Member'>varno</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Is it still needed above this joinrel? */ 
</span>        <a href="relnode.c.html#LN681"><span class='Ref_To_Local'>ndx</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN679"><span class='Ref_To_Local'>var</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN167"><span class='Ref_to_Member'>varattno</span></a> <span class='Operator'>- </span><a href="relnode.c.html#LN680"><span class='Ref_To_Local'>baserel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN555"><span class='Ref_to_Member'>min_attr</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/bitmapset.h.html#LN78"><span class='Ref_to_Proto'>bms_nonempty_difference</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN680"><span class='Ref_To_Local'>baserel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN557"><span class='Ref_to_Member'>attr_needed</span></a><span class='Delimiter'>[</span><a href="relnode.c.html#LN681"><span class='Ref_To_Local'>ndx</span></a><span class='Delimiter'>], </span><a href="relnode.c.html#LN674"><span class='Ref_To_Local'>relids</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Yup, add it to the output */ 
</span>            <a href="relnode.c.html#LN671"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN535"><span class='Ref_to_Member'>reltarget</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN882"><span class='Ref_to_Member'>exprs</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN671"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN535"><span class='Ref_to_Member'>reltarget</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN882"><span class='Ref_to_Member'>exprs</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN679"><span class='Ref_To_Local'>var</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* Vars have cost zero, so no need to adjust reltarget-&GT;cost */ 
</span>            <a href="relnode.c.html#LN671"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN535"><span class='Ref_to_Member'>reltarget</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN885"><span class='Ref_to_Member'>width</span></a> <span class='Operator'>+= </span><a href="relnode.c.html#LN680"><span class='Ref_To_Local'>baserel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN558"><span class='Ref_to_Member'>attr_widths</span></a><span class='Delimiter'>[</span><a href="relnode.c.html#LN681"><span class='Ref_To_Local'>ndx</span></a><span class='Delimiter'>]; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end build_joinrel_tlist &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * build_joinrel_restrictlist 
 * build_joinrel_joinlist 
 *    These routines build lists of restriction and join clauses for a 
 *    join relation from the joininfo lists of the relations it joins. 
 * 
 *    These routines are separate because the restriction list must be 
 *    built afresh for each pair of input sub-relations we consider, whereas 
 *    the join list need only be computed once for any join RelOptInfo. 
 *    The join list is fully determined by the set of rels making up the 
 *    joinrel, so we should get the same results (up to ordering) from any 
 *    candidate pair of sub-relations.  But the restriction list is whatever 
 *    is not handled in the sub-relations, so it depends on which 
 *    sub-relations are considered. 
 * 
 *    If a join clause from an input relation refers to base rels still not 
 *    present in the joinrel, then it is still a join clause for the joinrel; 
 *    we put it into the joininfo list for the joinrel.  Otherwise, 
 *    the clause is now a restrict clause for the joined relation, and we 
 *    return it to the caller of build_joinrel_restrictlist() to be stored in 
 *    join paths made from this pair of sub-relations.  (It will not need to 
 *    be considered further up the join tree.) 
 * 
 *    In many case we will find the same RestrictInfos in both input 
 *    relations' joinlists, so be careful to eliminate duplicates. 
 *    Pointer equality should be a sufficient test for dups, since all 
 *    the various joinlist entries ultimately refer to RestrictInfos 
 *    pushed into them by distribute_restrictinfo_to_rels(). 
 * 
 * 'joinrel' is a join relation node 
 * 'outer_rel' and 'inner_rel' are a pair of relations that can be joined 
 *      to form joinrel. 
 * 
 * build_joinrel_restrictlist() returns a list of relevant restrictinfos, 
 * whereas build_joinrel_joinlist() stores its results in the joinrel's 
 * joininfo list.  One or the other must accept each given clause! 
 * 
 * NB: Formerly, we made deep(!) copies of each input RestrictInfo to pass 
 * up to the join relation.  I believe this is no longer necessary, because 
 * RestrictInfo nodes are no longer context-dependent.  Instead, just include 
 * the original nodes in the lists made for the join relation. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>* 
</span><a name="LN757"></a><span class='Declare_Function'>build_joinrel_restrictlist</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, 
</span><a name="LN758"></a>                           <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN759"></a>                           <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outer_rel</span><span class='Delimiter'>, 
</span><a name="LN760"></a>                           <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>inner_rel</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN762"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Collect all the clauses that syntactically belong at this level, 
     * eliminating any duplicates (important since we will see many of the 
     * same clauses arriving from both input relations). 
     */ 
</span>    <a href="relnode.c.html#LN762"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN45"><span class='Ref_to_Proto'>subbuild_joinrel_restrictlist</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN758"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN759"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN588"><span class='Ref_to_Member'>joininfo</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN762"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN45"><span class='Ref_to_Proto'>subbuild_joinrel_restrictlist</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN758"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN760"><span class='Ref_to_Parameter'>inner_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN588"><span class='Ref_to_Member'>joininfo</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN762"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Add on any clauses derived from EquivalenceClasses.  These cannot be 
     * redundant with the clauses in the joininfo lists, so don't bother 
     * checking. 
     */ 
</span>    <a href="relnode.c.html#LN762"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN219"><span class='Ref_to_Proto'>list_concat</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN762"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, 
</span>                         <a href="../../../include/optimizer/paths.h.html#LN139"><span class='Ref_to_Proto'>generate_join_implied_equalities</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN757"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                          <a href="relnode.c.html#LN758"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, 
</span>                                                          <a href="relnode.c.html#LN759"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, 
</span>                                                          <a href="relnode.c.html#LN760"><span class='Ref_to_Parameter'>inner_rel</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="relnode.c.html#LN762"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end build_joinrel_restrictlist &raquo; </span> 
 
<span class='Keyword'>static void 
</span><a name="LN787"></a><span class='Declare_Function'>build_joinrel_joinlist</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN788"></a>                       <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outer_rel</span><span class='Delimiter'>, 
</span><a name="LN789"></a>                       <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>inner_rel</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN791"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Collect all the clauses that syntactically belong above this level, 
     * eliminating any duplicates (important since we will see many of the 
     * same clauses arriving from both input relations). 
     */ 
</span>    <a href="relnode.c.html#LN791"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN48"><span class='Ref_to_Proto'>subbuild_joinrel_joinlist</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN787"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN788"><span class='Ref_to_Parameter'>outer_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN588"><span class='Ref_to_Member'>joininfo</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN791"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN48"><span class='Ref_to_Proto'>subbuild_joinrel_joinlist</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN787"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN789"><span class='Ref_to_Parameter'>inner_rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN588"><span class='Ref_to_Member'>joininfo</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN791"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="relnode.c.html#LN787"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN588"><span class='Ref_to_Member'>joininfo</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN791"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>* 
</span><a name="LN805"></a><span class='Declare_Function'>subbuild_joinrel_restrictlist</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN806"></a>                              <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joininfo_list</span><span class='Delimiter'>, 
</span><a name="LN807"></a>                              <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>new_restrictlist</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN809"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN809"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN806"><span class='Ref_to_Parameter'>joininfo_list</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN813"></a>        <a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rinfo</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN809"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/bitmapset.h.html#LN73"><span class='Ref_to_Proto'>bms_is_subset</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN813"><span class='Ref_To_Local'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1764"><span class='Ref_to_Member'>required_relids</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN805"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * This clause becomes a restriction clause for the joinrel, since 
             * it refers to no outside rels.  Add it to the list, being 
             * careful to eliminate duplicates. (Since RestrictInfo nodes in 
             * different joinlists will have been multiply-linked rather than 
             * copied, pointer equality should be a sufficient test.) 
             */ 
</span>            <a href="relnode.c.html#LN807"><span class='Ref_to_Parameter'>new_restrictlist</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN256"><span class='Ref_to_Proto'>list_append_unique_ptr</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN807"><span class='Ref_to_Parameter'>new_restrictlist</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN813"><span class='Ref_To_Local'>rinfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * This clause is still a join clause at this level, so we ignore 
             * it in this routine. 
             */ 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="relnode.c.html#LN807"><span class='Ref_to_Parameter'>new_restrictlist</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end subbuild_joinrel_restrictlist &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>* 
</span><a name="LN839"></a><span class='Declare_Function'>subbuild_joinrel_joinlist</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN840"></a>                          <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joininfo_list</span><span class='Delimiter'>, 
</span><a name="LN841"></a>                          <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>new_joininfo</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN843"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN843"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN840"><span class='Ref_to_Parameter'>joininfo_list</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN847"></a>        <a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rinfo</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN843"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/bitmapset.h.html#LN73"><span class='Ref_to_Proto'>bms_is_subset</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN847"><span class='Ref_To_Local'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1764"><span class='Ref_to_Member'>required_relids</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN839"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * This clause becomes a restriction clause for the joinrel, since 
             * it refers to no outside rels.  So we can ignore it in this 
             * routine. 
             */ 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * This clause is still a join clause at this level, so add it to 
             * the new joininfo list, being careful to eliminate duplicates. 
             * (Since RestrictInfo nodes in different joinlists will have been 
             * multiply-linked rather than copied, pointer equality should be 
             * a sufficient test.) 
             */ 
</span>            <a href="relnode.c.html#LN841"><span class='Ref_to_Parameter'>new_joininfo</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN256"><span class='Ref_to_Proto'>list_append_unique_ptr</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN841"><span class='Ref_to_Parameter'>new_joininfo</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN847"><span class='Ref_To_Local'>rinfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="relnode.c.html#LN841"><span class='Ref_to_Parameter'>new_joininfo</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end subbuild_joinrel_joinlist &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * build_empty_join_rel 
 *      Build a dummy join relation describing an empty set of base rels. 
 * 
 * This is used for queries with empty FROM clauses, such as "SELECT 2+2" or 
 * "INSERT INTO foo VALUES(...)".  We don't try very hard to make the empty 
 * joinrel completely valid, since no real planning will be done with it --- 
 * we just need it to carry a simple Result path out of query_planner(). 
 */ 
</span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>* 
</span><a name="LN884"></a><span class='Declare_Function'>build_empty_join_rel</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN886"></a>    <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>joinrel</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* The dummy join relation should be the only one ... */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="relnode.c.html#LN884"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN214"><span class='Ref_to_Member'>join_rel_list</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="relnode.c.html#LN886"><span class='Ref_To_Local'>joinrel</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN886"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN521"><span class='Ref_to_Member'>reloptkind</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/relation.h.html#LN494"><span class='Ref_to_EnumConst'>RELOPT_JOINREL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN886"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* empty set */ 
</span>    <a href="relnode.c.html#LN886"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN527"><span class='Ref_to_Member'>rows</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>;</span>          <span class='Comment_Single_Line'>/* we produce one row for such cases */ 
</span>    <a href="relnode.c.html#LN886"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN554"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/parsenodes.h.html#LN924"><span class='Ref_to_EnumConst'>RTE_JOIN</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN886"><span class='Ref_To_Local'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN535"><span class='Ref_to_Member'>reltarget</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/tlist.h.html#LN57"><span class='Ref_to_Proto'>create_empty_pathtarget</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="relnode.c.html#LN884"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN214"><span class='Ref_to_Member'>join_rel_list</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN884"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN214"><span class='Ref_to_Member'>join_rel_list</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN886"><span class='Ref_To_Local'>joinrel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="relnode.c.html#LN886"><span class='Ref_To_Local'>joinrel</span></a><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * fetch_upper_rel 
 *      Build a RelOptInfo describing some post-scan/join query processing, 
 *      or return a pre-existing one if somebody already built it. 
 * 
 * An "upper" relation is identified by an UpperRelationKind and a Relids set. 
 * The meaning of the Relids set is not specified here, and very likely will 
 * vary for different relation kinds. 
 * 
 * Most of the fields in an upper-level RelOptInfo are not used and are not 
 * set here (though makeNode should ensure they're zeroes).  We basically only 
 * care about fields that are of interest to add_path() and set_cheapest(). 
 */ 
</span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>* 
</span><a name="LN918"></a><span class='Declare_Function'>fetch_upper_rel</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN70"><span class='Ref_to_Enum'>UpperRelationKind</span></a> <span class='Declare_Parameter'>kind</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a> <span class='Declare_Parameter'>relids</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN920"></a>    <a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>upperrel</span><span class='Delimiter'>; 
</span><a name="LN921"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * For the moment, our indexing data structure is just a List for each 
     * relation kind.  If we ever get so many of one kind that this stops 
     * working well, we can improve it.  No code outside this function should 
     * assume anything about how to find a particular upperrel. 
     */ 
</span> 
    <span class='Comment_Multi_Line'>/* If we already made this upperrel for the query, return it */ 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN921"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN918"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN271"><span class='Ref_to_Member'>upper_rels</span></a><span class='Delimiter'>[</span><a href="relnode.c.html#LN918"><span class='Ref_to_Parameter'>kind</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="relnode.c.html#LN920"><span class='Ref_To_Local'>upperrel</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN921"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/bitmapset.h.html#LN66"><span class='Ref_to_Proto'>bms_equal</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN920"><span class='Ref_To_Local'>upperrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN918"><span class='Ref_to_Parameter'>relids</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="relnode.c.html#LN920"><span class='Ref_To_Local'>upperrel</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="relnode.c.html#LN920"><span class='Ref_To_Local'>upperrel</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN920"><span class='Ref_To_Local'>upperrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN521"><span class='Ref_to_Member'>reloptkind</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/relation.h.html#LN496"><span class='Ref_to_EnumConst'>RELOPT_UPPER_REL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN920"><span class='Ref_To_Local'>upperrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/bitmapset.h.html#LN65"><span class='Ref_to_Proto'>bms_copy</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN918"><span class='Ref_to_Parameter'>relids</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* cheap startup cost is interesting iff not all tuples to be retrieved */ 
</span>    <a href="relnode.c.html#LN920"><span class='Ref_To_Local'>upperrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN530"><span class='Ref_to_Member'>consider_startup</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="relnode.c.html#LN918"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN290"><span class='Ref_to_Member'>tuple_fraction</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN920"><span class='Ref_To_Local'>upperrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN531"><span class='Ref_to_Member'>consider_param_startup</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN920"><span class='Ref_To_Local'>upperrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN532"><span class='Ref_to_Member'>consider_parallel</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* might get changed later */ 
</span>    <a href="relnode.c.html#LN920"><span class='Ref_To_Local'>upperrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN535"><span class='Ref_to_Member'>reltarget</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/tlist.h.html#LN57"><span class='Ref_to_Proto'>create_empty_pathtarget</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN920"><span class='Ref_To_Local'>upperrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN538"><span class='Ref_to_Member'>pathlist</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN920"><span class='Ref_To_Local'>upperrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN541"><span class='Ref_to_Member'>cheapest_startup_path</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN920"><span class='Ref_To_Local'>upperrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN542"><span class='Ref_to_Member'>cheapest_total_path</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN920"><span class='Ref_To_Local'>upperrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN543"><span class='Ref_to_Member'>cheapest_unique_path</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN920"><span class='Ref_To_Local'>upperrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN544"><span class='Ref_to_Member'>cheapest_parameterized_paths</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
    <a href="relnode.c.html#LN918"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN271"><span class='Ref_to_Member'>upper_rels</span></a><span class='Delimiter'>[</span><a href="relnode.c.html#LN918"><span class='Ref_to_Parameter'>kind</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN918"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN271"><span class='Ref_to_Member'>upper_rels</span></a><span class='Delimiter'>[</span><a href="relnode.c.html#LN918"><span class='Ref_to_Parameter'>kind</span></a><span class='Delimiter'>], </span><a href="relnode.c.html#LN920"><span class='Ref_To_Local'>upperrel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="relnode.c.html#LN920"><span class='Ref_To_Local'>upperrel</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end fetch_upper_rel &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * find_childrel_appendrelinfo 
 *      Get the AppendRelInfo associated with an appendrel child rel. 
 * 
 * This search could be eliminated by storing a link in child RelOptInfos, 
 * but for now it doesn't seem performance-critical.  (Also, it might be 
 * difficult to maintain such a link during mutation of the append_rel_list.) 
 */ 
</span><a href="../../../include/nodes/relation.h.html#LN1964"><span class='Ref_to_Struct'>AppendRelInfo</span></a> <span class='Operator'>* 
</span><a name="LN969"></a><span class='Declare_Function'>find_childrel_appendrelinfo</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rel</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN971"></a>    <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>       <span class='Declare_Local'>relid</span> <span class='Operator'>= </span><a href="relnode.c.html#LN969"><span class='Ref_to_Parameter'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN552"><span class='Ref_to_Member'>relid</span></a><span class='Delimiter'>; 
</span><a name="LN972"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Should only be called on child rels */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="relnode.c.html#LN969"><span class='Ref_to_Parameter'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN521"><span class='Ref_to_Member'>reloptkind</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/relation.h.html#LN495"><span class='Ref_to_EnumConst'>RELOPT_OTHER_MEMBER_REL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN972"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN969"><span class='Ref_to_Parameter'>root</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN251"><span class='Ref_to_Member'>append_rel_list</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN979"></a>        <a href="../../../include/nodes/relation.h.html#LN1964"><span class='Ref_to_Struct'>AppendRelInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>appinfo</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1964"><span class='Ref_to_Struct'>AppendRelInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN972"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="relnode.c.html#LN979"><span class='Ref_To_Local'>appinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1975"><span class='Ref_to_Member'>child_relid</span></a> <span class='Operator'>== </span><a href="relnode.c.html#LN971"><span class='Ref_To_Local'>relid</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <a href="relnode.c.html#LN979"><span class='Ref_To_Local'>appinfo</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* should have found the entry ... */ 
</span>    <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"child rel %d not found in append_rel_list"</span><span class='Delimiter'>, </span><a href="relnode.c.html#LN971"><span class='Ref_To_Local'>relid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* not reached */ 
</span><span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end find_childrel_appendrelinfo &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * find_childrel_parents 
 *      Compute the set of parent relids of an appendrel child rel. 
 * 
 * Since appendrels can be nested, a child could have multiple levels of 
 * appendrel ancestors.  This function computes a Relids set of all the 
 * parent relation IDs. 
 */ 
</span><a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a> 
<a name="LN999"></a><span class='Declare_Function'>find_childrel_parents</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rel</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1001"></a>    <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a>      <span class='Declare_Local'>result</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="relnode.c.html#LN999"><span class='Ref_to_Parameter'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN521"><span class='Ref_to_Member'>reloptkind</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/relation.h.html#LN495"><span class='Ref_to_EnumConst'>RELOPT_OTHER_MEMBER_REL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>do</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1007"></a>        <a href="../../../include/nodes/relation.h.html#LN1964"><span class='Ref_to_Struct'>AppendRelInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>appinfo</span> <span class='Operator'>= </span><a href="../../../include/optimizer/pathnode.h.html#LN272"><span class='Ref_to_Proto'>find_childrel_appendrelinfo</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN999"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN999"><span class='Ref_to_Parameter'>rel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1008"></a>        <a href="../../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>       <span class='Declare_Local'>prelid</span> <span class='Operator'>= </span><a href="relnode.c.html#LN1007"><span class='Ref_To_Local'>appinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1974"><span class='Ref_to_Member'>parent_relid</span></a><span class='Delimiter'>; 
</span> 
        <a href="relnode.c.html#LN1001"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/bitmapset.h.html#LN89"><span class='Ref_to_Proto'>bms_add_member</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1001"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1008"><span class='Ref_To_Local'>prelid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* traverse up to the parent rel, loop if it's also a child rel */ 
</span>        <a href="relnode.c.html#LN999"><span class='Ref_to_Parameter'>rel</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN241"><span class='Ref_to_Func'>find_base_rel</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN999"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1008"><span class='Ref_To_Local'>prelid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} </span><span class='Control'>while</span> <span class='Parentheses'>(</span><a href="relnode.c.html#LN999"><span class='Ref_to_Parameter'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN521"><span class='Ref_to_Member'>reloptkind</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/relation.h.html#LN495"><span class='Ref_to_EnumConst'>RELOPT_OTHER_MEMBER_REL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="relnode.c.html#LN999"><span class='Ref_to_Parameter'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN521"><span class='Ref_to_Member'>reloptkind</span></a> <span class='Operator'>== </span><a href="../../../include/nodes/relation.h.html#LN493"><span class='Ref_to_EnumConst'>RELOPT_BASEREL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="relnode.c.html#LN1001"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end find_childrel_parents &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * get_baserel_parampathinfo 
 *      Get the ParamPathInfo for a parameterized path for a base relation, 
 *      constructing one if we don't have one already. 
 * 
 * This centralizes estimating the rowcounts for parameterized paths. 
 * We need to cache those to be sure we use the same rowcount for all paths 
 * of the same parameterization for a given rel.  This is also a convenient 
 * place to determine which movable join clauses the parameterized path will 
 * be responsible for evaluating. 
 */ 
</span><a href="../../../include/nodes/relation.h.html#LN907"><span class='Ref_to_Struct'>ParamPathInfo</span></a> <span class='Operator'>* 
</span><a name="LN1034"></a><span class='Declare_Function'>get_baserel_parampathinfo</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>baserel</span><span class='Delimiter'>, 
</span><a name="LN1035"></a>                          <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a> <span class='Declare_Parameter'>required_outer</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1037"></a>    <a href="../../../include/nodes/relation.h.html#LN907"><span class='Ref_to_Struct'>ParamPathInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>ppi</span><span class='Delimiter'>; 
</span><a name="LN1038"></a>    <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a>      <span class='Declare_Local'>joinrelids</span><span class='Delimiter'>; 
</span><a name="LN1039"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>pclauses</span><span class='Delimiter'>; 
</span><a name="LN1040"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>rows</span><span class='Delimiter'>; 
</span><a name="LN1041"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Unparameterized paths have no ParamPathInfo */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/bitmapset.h.html#LN85"><span class='Ref_to_Proto'>bms_is_empty</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1035"><span class='Ref_to_Parameter'>required_outer</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/nodes/bitmapset.h.html#LN76"><span class='Ref_to_Proto'>bms_overlap</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1034"><span class='Ref_to_Parameter'>baserel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1035"><span class='Ref_to_Parameter'>required_outer</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* If we already have a PPI for this parameterization, just return it */ 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1041"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1034"><span class='Ref_to_Parameter'>baserel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN539"><span class='Ref_to_Member'>ppilist</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="relnode.c.html#LN1037"><span class='Ref_To_Local'>ppi</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN907"><span class='Ref_to_Struct'>ParamPathInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1041"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/bitmapset.h.html#LN66"><span class='Ref_to_Proto'>bms_equal</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1037"><span class='Ref_To_Local'>ppi</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN911"><span class='Ref_to_Member'>ppi_req_outer</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1035"><span class='Ref_to_Parameter'>required_outer</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="relnode.c.html#LN1037"><span class='Ref_To_Local'>ppi</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Identify all joinclauses that are movable to this base rel given this 
     * parameterization. 
     */ 
</span>    <a href="relnode.c.html#LN1038"><span class='Ref_To_Local'>joinrelids</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/bitmapset.h.html#LN70"><span class='Ref_to_Proto'>bms_union</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1034"><span class='Ref_to_Parameter'>baserel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1035"><span class='Ref_to_Parameter'>required_outer</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN1039"><span class='Ref_To_Local'>pclauses</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1041"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1034"><span class='Ref_to_Parameter'>baserel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN588"><span class='Ref_to_Member'>joininfo</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1065"></a>        <a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rinfo</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1041"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/optimizer/restrictinfo.h.html#LN41"><span class='Ref_to_Proto'>join_clause_is_movable_into</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1065"><span class='Ref_To_Local'>rinfo</span></a><span class='Delimiter'>, 
</span>                                        <a href="relnode.c.html#LN1034"><span class='Ref_to_Parameter'>baserel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, 
</span>                                        <a href="relnode.c.html#LN1038"><span class='Ref_To_Local'>joinrelids</span></a><span class='Parentheses'>))</span> 
            <a href="relnode.c.html#LN1039"><span class='Ref_To_Local'>pclauses</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1039"><span class='Ref_To_Local'>pclauses</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1065"><span class='Ref_To_Local'>rinfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Add in joinclauses generated by EquivalenceClasses, too.  (These 
     * necessarily satisfy join_clause_is_movable_into.) 
     */ 
</span>    <a href="relnode.c.html#LN1039"><span class='Ref_To_Local'>pclauses</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN219"><span class='Ref_to_Proto'>list_concat</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1039"><span class='Ref_To_Local'>pclauses</span></a><span class='Delimiter'>, 
</span>                           <a href="../../../include/optimizer/paths.h.html#LN139"><span class='Ref_to_Proto'>generate_join_implied_equalities</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1034"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                            <a href="relnode.c.html#LN1038"><span class='Ref_To_Local'>joinrelids</span></a><span class='Delimiter'>, 
</span>                                                            <a href="relnode.c.html#LN1035"><span class='Ref_to_Parameter'>required_outer</span></a><span class='Delimiter'>, 
</span>                                                            <a href="relnode.c.html#LN1034"><span class='Ref_to_Parameter'>baserel</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Estimate the number of rows returned by the parameterized scan */ 
</span>    <a href="relnode.c.html#LN1040"><span class='Ref_To_Local'>rows</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/cost.h.html#LN167"><span class='Ref_to_Proto'>get_parameterized_baserel_size</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1034"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1034"><span class='Ref_to_Parameter'>baserel</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1039"><span class='Ref_To_Local'>pclauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* And now we can build the ParamPathInfo */ 
</span>    <a href="relnode.c.html#LN1037"><span class='Ref_To_Local'>ppi</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN907"><span class='Ref_to_Struct'>ParamPathInfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN1037"><span class='Ref_To_Local'>ppi</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN911"><span class='Ref_to_Member'>ppi_req_outer</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN1035"><span class='Ref_to_Parameter'>required_outer</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN1037"><span class='Ref_To_Local'>ppi</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN912"><span class='Ref_to_Member'>ppi_rows</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN1040"><span class='Ref_To_Local'>rows</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN1037"><span class='Ref_To_Local'>ppi</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN913"><span class='Ref_to_Member'>ppi_clauses</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN1039"><span class='Ref_To_Local'>pclauses</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN1034"><span class='Ref_to_Parameter'>baserel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN539"><span class='Ref_to_Member'>ppilist</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1034"><span class='Ref_to_Parameter'>baserel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN539"><span class='Ref_to_Member'>ppilist</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1037"><span class='Ref_To_Local'>ppi</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="relnode.c.html#LN1037"><span class='Ref_To_Local'>ppi</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end get_baserel_parampathinfo &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * get_joinrel_parampathinfo 
 *      Get the ParamPathInfo for a parameterized path for a join relation, 
 *      constructing one if we don't have one already. 
 * 
 * This centralizes estimating the rowcounts for parameterized paths. 
 * We need to cache those to be sure we use the same rowcount for all paths 
 * of the same parameterization for a given rel.  This is also a convenient 
 * place to determine which movable join clauses the parameterized path will 
 * be responsible for evaluating. 
 * 
 * outer_path and inner_path are a pair of input paths that can be used to 
 * construct the join, and restrict_clauses is the list of regular join 
 * clauses (including clauses derived from EquivalenceClasses) that must be 
 * applied at the join node when using these inputs. 
 * 
 * Unlike the situation for base rels, the set of movable join clauses to be 
 * enforced at a join varies with the selected pair of input paths, so we 
 * must calculate that and pass it back, even if we already have a matching 
 * ParamPathInfo.  We handle this by adding any clauses moved down to this 
 * join to *restrict_clauses, which is an in/out parameter.  (The addition 
 * is done in such a way as to not modify the passed-in List structure.) 
 * 
 * Note: when considering a nestloop join, the caller must have removed from 
 * restrict_clauses any movable clauses that are themselves scheduled to be 
 * pushed into the right-hand path.  We do not do that here since it's 
 * unnecessary for other join types. 
 */ 
</span><a href="../../../include/nodes/relation.h.html#LN907"><span class='Ref_to_Struct'>ParamPathInfo</span></a> <span class='Operator'>* 
</span><a name="LN1125"></a><span class='Declare_Function'>get_joinrel_parampathinfo</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN150"><span class='Ref_to_Struct'>PlannerInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>root</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>joinrel</span><span class='Delimiter'>, 
</span><a name="LN1126"></a>                          <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>outer_path</span><span class='Delimiter'>, 
</span><a name="LN1127"></a>                          <a href="../../../include/nodes/relation.h.html#LN946"><span class='Ref_to_Struct'>Path</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>inner_path</span><span class='Delimiter'>, 
</span><a name="LN1128"></a>                          <a href="../../../include/nodes/relation.h.html#LN1913"><span class='Ref_to_Struct'>SpecialJoinInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>sjinfo</span><span class='Delimiter'>, 
</span><a name="LN1129"></a>                          <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a> <span class='Declare_Parameter'>required_outer</span><span class='Delimiter'>, 
</span><a name="LN1130"></a>                          <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>restrict_clauses</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1132"></a>    <a href="../../../include/nodes/relation.h.html#LN907"><span class='Ref_to_Struct'>ParamPathInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>ppi</span><span class='Delimiter'>; 
</span><a name="LN1133"></a>    <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a>      <span class='Declare_Local'>join_and_req</span><span class='Delimiter'>; 
</span><a name="LN1134"></a>    <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a>      <span class='Declare_Local'>outer_and_req</span><span class='Delimiter'>; 
</span><a name="LN1135"></a>    <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a>      <span class='Declare_Local'>inner_and_req</span><span class='Delimiter'>; 
</span><a name="LN1136"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>pclauses</span><span class='Delimiter'>; 
</span><a name="LN1137"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>eclauses</span><span class='Delimiter'>; 
</span><a name="LN1138"></a>    <a href="../../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>dropped_ecs</span><span class='Delimiter'>; 
</span><a name="LN1139"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>rows</span><span class='Delimiter'>; 
</span><a name="LN1140"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Unparameterized paths have no ParamPathInfo or extra join clauses */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/bitmapset.h.html#LN85"><span class='Ref_to_Proto'>bms_is_empty</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1129"><span class='Ref_to_Parameter'>required_outer</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/nodes/bitmapset.h.html#LN76"><span class='Ref_to_Proto'>bms_overlap</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1125"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1129"><span class='Ref_to_Parameter'>required_outer</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Identify all joinclauses that are movable to this join rel given this 
     * parameterization.  These are the clauses that are movable into this 
     * join, but not movable into either input path.  Treat an unparameterized 
     * input path as not accepting parameterized clauses (because it won't, 
     * per the shortcut exit above), even though the joinclause movement rules 
     * might allow the same clauses to be moved into a parameterized path for 
     * that rel. 
     */ 
</span>    <a href="relnode.c.html#LN1133"><span class='Ref_To_Local'>join_and_req</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/bitmapset.h.html#LN70"><span class='Ref_to_Proto'>bms_union</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1125"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1129"><span class='Ref_to_Parameter'>required_outer</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="relnode.c.html#LN1126"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a><span class='Parentheses'>) 
</span>        <a href="relnode.c.html#LN1134"><span class='Ref_To_Local'>outer_and_req</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/bitmapset.h.html#LN70"><span class='Ref_to_Proto'>bms_union</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1126"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, 
</span>                                  <a href="../../../include/nodes/relation.h.html#LN972"><span class='Ref_to_Macro'>PATH_REQ_OUTER</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1126"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="relnode.c.html#LN1134"><span class='Ref_To_Local'>outer_and_req</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>   <span class='Comment_Single_Line'>/* outer path does not accept parameters */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="relnode.c.html#LN1127"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN955"><span class='Ref_to_Member'>param_info</span></a><span class='Parentheses'>) 
</span>        <a href="relnode.c.html#LN1135"><span class='Ref_To_Local'>inner_and_req</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/bitmapset.h.html#LN70"><span class='Ref_to_Proto'>bms_union</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1127"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, 
</span>                                  <a href="../../../include/nodes/relation.h.html#LN972"><span class='Ref_to_Macro'>PATH_REQ_OUTER</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1127"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="relnode.c.html#LN1135"><span class='Ref_To_Local'>inner_and_req</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>   <span class='Comment_Single_Line'>/* inner path does not accept parameters */ 
</span> 
    <a href="relnode.c.html#LN1136"><span class='Ref_To_Local'>pclauses</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1140"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1125"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN588"><span class='Ref_to_Member'>joininfo</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1172"></a>        <a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rinfo</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1140"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/optimizer/restrictinfo.h.html#LN41"><span class='Ref_to_Proto'>join_clause_is_movable_into</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1172"><span class='Ref_To_Local'>rinfo</span></a><span class='Delimiter'>, 
</span>                                        <a href="relnode.c.html#LN1125"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, 
</span>                                        <a href="relnode.c.html#LN1133"><span class='Ref_To_Local'>join_and_req</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>            <span class='Operator'>!</span><a href="../../../include/optimizer/restrictinfo.h.html#LN41"><span class='Ref_to_Proto'>join_clause_is_movable_into</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1172"><span class='Ref_To_Local'>rinfo</span></a><span class='Delimiter'>, 
</span>                                         <a href="relnode.c.html#LN1126"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, 
</span>                                         <a href="relnode.c.html#LN1134"><span class='Ref_To_Local'>outer_and_req</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>            <span class='Operator'>!</span><a href="../../../include/optimizer/restrictinfo.h.html#LN41"><span class='Ref_to_Proto'>join_clause_is_movable_into</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1172"><span class='Ref_To_Local'>rinfo</span></a><span class='Delimiter'>, 
</span>                                         <a href="relnode.c.html#LN1127"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, 
</span>                                         <a href="relnode.c.html#LN1135"><span class='Ref_To_Local'>inner_and_req</span></a><span class='Parentheses'>))</span> 
            <a href="relnode.c.html#LN1136"><span class='Ref_To_Local'>pclauses</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1136"><span class='Ref_To_Local'>pclauses</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1172"><span class='Ref_To_Local'>rinfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Consider joinclauses generated by EquivalenceClasses, too */ 
</span>    <a href="relnode.c.html#LN1137"><span class='Ref_To_Local'>eclauses</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/paths.h.html#LN139"><span class='Ref_to_Proto'>generate_join_implied_equalities</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1125"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                <a href="relnode.c.html#LN1133"><span class='Ref_To_Local'>join_and_req</span></a><span class='Delimiter'>, 
</span>                                                <a href="relnode.c.html#LN1129"><span class='Ref_to_Parameter'>required_outer</span></a><span class='Delimiter'>, 
</span>                                                <a href="relnode.c.html#LN1125"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* We only want ones that aren't movable to lower levels */ 
</span>    <a href="relnode.c.html#LN1138"><span class='Ref_To_Local'>dropped_ecs</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1140"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1137"><span class='Ref_To_Local'>eclauses</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1195"></a>        <a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rinfo</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1140"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * In principle, join_clause_is_movable_into() should accept anything 
         * returned by generate_join_implied_equalities(); but because its 
         * analysis is only approximate, sometimes it doesn't.  So we 
         * currently cannot use this Assert; instead just assume it's okay to 
         * apply the joinclause at this level. 
         */ 
</span><span class='Directive'>#ifdef</span> NOT_USED 
        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/optimizer/restrictinfo.h.html#LN41"><span class='Ref_to_Proto'>join_clause_is_movable_into</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1195"><span class='Ref_To_Local'>rinfo</span></a><span class='Delimiter'>, 
</span>                                           <a href="relnode.c.html#LN1125"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, 
</span>                                           <a href="relnode.c.html#LN1133"><span class='Ref_To_Local'>join_and_req</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/optimizer/restrictinfo.h.html#LN41"><span class='Ref_to_Proto'>join_clause_is_movable_into</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1195"><span class='Ref_To_Local'>rinfo</span></a><span class='Delimiter'>, 
</span>                                        <a href="relnode.c.html#LN1126"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, 
</span>                                        <a href="relnode.c.html#LN1134"><span class='Ref_To_Local'>outer_and_req</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>continue</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* drop if movable into LHS */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/optimizer/restrictinfo.h.html#LN41"><span class='Ref_to_Proto'>join_clause_is_movable_into</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1195"><span class='Ref_To_Local'>rinfo</span></a><span class='Delimiter'>, 
</span>                                        <a href="relnode.c.html#LN1127"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, 
</span>                                        <a href="relnode.c.html#LN1135"><span class='Ref_To_Local'>inner_and_req</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* drop if movable into RHS, but remember EC for use below */ 
</span>            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="relnode.c.html#LN1195"><span class='Ref_To_Local'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1794"><span class='Ref_to_Member'>left_ec</span></a> <span class='Operator'>== </span><a href="relnode.c.html#LN1195"><span class='Ref_To_Local'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1795"><span class='Ref_to_Member'>right_ec</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="relnode.c.html#LN1138"><span class='Ref_To_Local'>dropped_ecs</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1138"><span class='Ref_To_Local'>dropped_ecs</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1195"><span class='Ref_To_Local'>rinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN1794"><span class='Ref_to_Member'>left_ec</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="relnode.c.html#LN1136"><span class='Ref_To_Local'>pclauses</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1136"><span class='Ref_To_Local'>pclauses</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1195"><span class='Ref_To_Local'>rinfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * EquivalenceClasses are harder to deal with than we could wish, because 
     * of the fact that a given EC can generate different clauses depending on 
     * context.  Suppose we have an EC {X.X, Y.Y, Z.Z} where X and Y are the 
     * LHS and RHS of the current join and Z is in required_outer, and further 
     * suppose that the inner_path is parameterized by both X and Z.  The code 
     * above will have produced either Z.Z = X.X or Z.Z = Y.Y from that EC, 
     * and in the latter case will have discarded it as being movable into the 
     * RHS.  However, the EC machinery might have produced either Y.Y = X.X or 
     * Y.Y = Z.Z as the EC enforcement clause within the inner_path; it will 
     * not have produced both, and we can't readily tell from here which one 
     * it did pick.  If we add no clause to this join, we'll end up with 
     * insufficient enforcement of the EC; either Z.Z or X.X will fail to be 
     * constrained to be equal to the other members of the EC.  (When we come 
     * to join Z to this X/Y path, we will certainly drop whichever EC clause 
     * is generated at that join, so this omission won't get fixed later.) 
     * 
     * To handle this, for each EC we discarded such a clause from, try to 
     * generate a clause connecting the required_outer rels to the join's LHS 
     * ("Z.Z = X.X" in the terms of the above example).  If successful, and if 
     * the clause can't be moved to the LHS, add it to the current join's 
     * restriction clauses.  (If an EC cannot generate such a clause then it 
     * has nothing that needs to be enforced here, while if the clause can be 
     * moved into the LHS then it should have been enforced within that path.) 
     * 
     * Note that we don't need similar processing for ECs whose clause was 
     * considered to be movable into the LHS, because the LHS can't refer to 
     * the RHS so there is no comparable ambiguity about what it might 
     * actually be enforcing internally. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="relnode.c.html#LN1138"><span class='Ref_To_Local'>dropped_ecs</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1257"></a>        <a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a>      <span class='Declare_Local'>real_outer_and_req</span><span class='Delimiter'>; 
</span> 
        <a href="relnode.c.html#LN1257"><span class='Ref_To_Local'>real_outer_and_req</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/bitmapset.h.html#LN70"><span class='Ref_to_Proto'>bms_union</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1126"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, 
</span>                                       <a href="relnode.c.html#LN1129"><span class='Ref_to_Parameter'>required_outer</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="relnode.c.html#LN1137"><span class='Ref_To_Local'>eclauses</span></a> <span class='Operator'>= 
</span>            <a href="../../../include/optimizer/paths.h.html#LN143"><span class='Ref_to_Proto'>generate_join_implied_equalities_for_ecs</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1125"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, 
</span>                                                     <a href="relnode.c.html#LN1138"><span class='Ref_To_Local'>dropped_ecs</span></a><span class='Delimiter'>, 
</span>                                                     <a href="relnode.c.html#LN1257"><span class='Ref_To_Local'>real_outer_and_req</span></a><span class='Delimiter'>, 
</span>                                                     <a href="relnode.c.html#LN1129"><span class='Ref_to_Parameter'>required_outer</span></a><span class='Delimiter'>, 
</span>                                                     <a href="relnode.c.html#LN1126"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1140"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1137"><span class='Ref_To_Local'>eclauses</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN1269"></a>            <a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rinfo</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN1742"><span class='Ref_to_Struct'>RestrictInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1140"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* As above, can't quite assert this here */ 
</span><span class='Directive'>#ifdef</span> NOT_USED 
            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/optimizer/restrictinfo.h.html#LN41"><span class='Ref_to_Proto'>join_clause_is_movable_into</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1269"><span class='Ref_To_Local'>rinfo</span></a><span class='Delimiter'>, 
</span>                                               <a href="relnode.c.html#LN1126"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, 
</span>                                               <a href="relnode.c.html#LN1257"><span class='Ref_To_Local'>real_outer_and_req</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/optimizer/restrictinfo.h.html#LN41"><span class='Ref_to_Proto'>join_clause_is_movable_into</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1269"><span class='Ref_To_Local'>rinfo</span></a><span class='Delimiter'>, 
</span>                                             <a href="relnode.c.html#LN1126"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN952"><span class='Ref_to_Member'>parent</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, 
</span>                                             <a href="relnode.c.html#LN1134"><span class='Ref_To_Local'>outer_and_req</span></a><span class='Parentheses'>))</span> 
                <a href="relnode.c.html#LN1136"><span class='Ref_To_Local'>pclauses</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1136"><span class='Ref_To_Local'>pclauses</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1269"><span class='Ref_To_Local'>rinfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if dropped_ecs &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* 
     * Now, attach the identified moved-down clauses to the caller's 
     * restrict_clauses list.  By using list_concat in this order, we leave 
     * the original list structure of restrict_clauses undamaged. 
     */ 
</span>    <span class='Operator'>*</span><a href="relnode.c.html#LN1130"><span class='Ref_to_Parameter'>restrict_clauses</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN219"><span class='Ref_to_Proto'>list_concat</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1136"><span class='Ref_To_Local'>pclauses</span></a><span class='Delimiter'>, </span><span class='Operator'>*</span><a href="relnode.c.html#LN1130"><span class='Ref_to_Parameter'>restrict_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* If we already have a PPI for this parameterization, just return it */ 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1140"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1125"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN539"><span class='Ref_to_Member'>ppilist</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="relnode.c.html#LN1132"><span class='Ref_To_Local'>ppi</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN907"><span class='Ref_to_Struct'>ParamPathInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1140"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/bitmapset.h.html#LN66"><span class='Ref_to_Proto'>bms_equal</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1132"><span class='Ref_To_Local'>ppi</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN911"><span class='Ref_to_Member'>ppi_req_outer</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1129"><span class='Ref_to_Parameter'>required_outer</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="relnode.c.html#LN1132"><span class='Ref_To_Local'>ppi</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Estimate the number of rows returned by the parameterized join */ 
</span>    <a href="relnode.c.html#LN1139"><span class='Ref_To_Local'>rows</span></a> <span class='Operator'>= </span><a href="../../../include/optimizer/cost.h.html#LN170"><span class='Ref_to_Proto'>get_parameterized_joinrel_size</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1125"><span class='Ref_to_Parameter'>root</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1125"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Delimiter'>, 
</span>                                          <a href="relnode.c.html#LN1126"><span class='Ref_to_Parameter'>outer_path</span></a><span class='Delimiter'>, 
</span>                                          <a href="relnode.c.html#LN1127"><span class='Ref_to_Parameter'>inner_path</span></a><span class='Delimiter'>, 
</span>                                          <a href="relnode.c.html#LN1128"><span class='Ref_to_Parameter'>sjinfo</span></a><span class='Delimiter'>, 
</span>                                          <span class='Operator'>*</span><a href="relnode.c.html#LN1130"><span class='Ref_to_Parameter'>restrict_clauses</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * And now we can build the ParamPathInfo.  No point in saving the 
     * input-pair-dependent clause list, though. 
     * 
     * Note: in GEQO mode, we'll be called in a temporary memory context, but 
     * the joinrel structure is there too, so no problem. 
     */ 
</span>    <a href="relnode.c.html#LN1132"><span class='Ref_To_Local'>ppi</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN907"><span class='Ref_to_Struct'>ParamPathInfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN1132"><span class='Ref_To_Local'>ppi</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN911"><span class='Ref_to_Member'>ppi_req_outer</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN1129"><span class='Ref_to_Parameter'>required_outer</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN1132"><span class='Ref_To_Local'>ppi</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN912"><span class='Ref_to_Member'>ppi_rows</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN1139"><span class='Ref_To_Local'>rows</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN1132"><span class='Ref_To_Local'>ppi</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN913"><span class='Ref_to_Member'>ppi_clauses</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN1125"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN539"><span class='Ref_to_Member'>ppilist</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1125"><span class='Ref_to_Parameter'>joinrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN539"><span class='Ref_to_Member'>ppilist</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1132"><span class='Ref_To_Local'>ppi</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="relnode.c.html#LN1132"><span class='Ref_To_Local'>ppi</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end get_joinrel_parampathinfo &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * get_appendrel_parampathinfo 
 *      Get the ParamPathInfo for a parameterized path for an append relation. 
 * 
 * For an append relation, the rowcount estimate will just be the sum of 
 * the estimates for its children.  However, we still need a ParamPathInfo 
 * to flag the fact that the path requires parameters.  So this just creates 
 * a suitable struct with zero ppi_rows (and no ppi_clauses either, since 
 * the Append node isn't responsible for checking quals). 
 */ 
</span><a href="../../../include/nodes/relation.h.html#LN907"><span class='Ref_to_Struct'>ParamPathInfo</span></a> <span class='Operator'>* 
</span><a name="LN1333"></a><span class='Declare_Function'>get_appendrel_parampathinfo</span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN517"><span class='Ref_to_Struct'>RelOptInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>appendrel</span><span class='Delimiter'>, </span><a href="../../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a> <span class='Declare_Parameter'>required_outer</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1335"></a>    <a href="../../../include/nodes/relation.h.html#LN907"><span class='Ref_to_Struct'>ParamPathInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>ppi</span><span class='Delimiter'>; 
</span><a name="LN1336"></a>    <a href="../../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Unparameterized paths have no ParamPathInfo */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/bitmapset.h.html#LN85"><span class='Ref_to_Proto'>bms_is_empty</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1333"><span class='Ref_to_Parameter'>required_outer</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/nodes/bitmapset.h.html#LN76"><span class='Ref_to_Proto'>bms_overlap</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1333"><span class='Ref_to_Parameter'>appendrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN524"><span class='Ref_to_Member'>relids</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1333"><span class='Ref_to_Parameter'>required_outer</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* If we already have a PPI for this parameterization, just return it */ 
</span>    <a href="../../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1336"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1333"><span class='Ref_to_Parameter'>appendrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN539"><span class='Ref_to_Member'>ppilist</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="relnode.c.html#LN1335"><span class='Ref_To_Local'>ppi</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN907"><span class='Ref_to_Struct'>ParamPathInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1336"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/bitmapset.h.html#LN66"><span class='Ref_to_Proto'>bms_equal</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1335"><span class='Ref_To_Local'>ppi</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN911"><span class='Ref_to_Member'>ppi_req_outer</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1333"><span class='Ref_to_Parameter'>required_outer</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <a href="relnode.c.html#LN1335"><span class='Ref_To_Local'>ppi</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Else build the ParamPathInfo */ 
</span>    <a href="relnode.c.html#LN1335"><span class='Ref_To_Local'>ppi</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/relation.h.html#LN907"><span class='Ref_to_Struct'>ParamPathInfo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN1335"><span class='Ref_To_Local'>ppi</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN911"><span class='Ref_to_Member'>ppi_req_outer</span></a> <span class='Operator'>= </span><a href="relnode.c.html#LN1333"><span class='Ref_to_Parameter'>required_outer</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN1335"><span class='Ref_To_Local'>ppi</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN912"><span class='Ref_to_Member'>ppi_rows</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN1335"><span class='Ref_To_Local'>ppi</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN913"><span class='Ref_to_Member'>ppi_clauses</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="relnode.c.html#LN1333"><span class='Ref_to_Parameter'>appendrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN539"><span class='Ref_to_Member'>ppilist</span></a> <span class='Operator'>= </span><a href="../../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="relnode.c.html#LN1333"><span class='Ref_to_Parameter'>appendrel</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/relation.h.html#LN539"><span class='Ref_to_Member'>ppilist</span></a><span class='Delimiter'>, </span><a href="relnode.c.html#LN1335"><span class='Ref_To_Local'>ppi</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="relnode.c.html#LN1335"><span class='Ref_To_Local'>ppi</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end get_appendrel_parampathinfo &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>