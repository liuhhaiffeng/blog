<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\backend\parser\parse_relation.c</title>
<LINK REL=StyleSheet HREF="../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\backend\parser\parse_relation.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:45 2017
</td></tr>
<tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * parse_relation.c 
 *    parser support routines dealing with relations 
 * 
 * Portions Copyright (c) 1996-2017, PostgreSQL Global Development Group 
 * Portions Copyright (c) 1994, Regents of the University of California 
 * 
 * 
 * IDENTIFICATION 
 *    src/backend/parser/parse_relation.c 
 * 
 *------------------------------------------------------------------------- 
 */ 
</span><span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>&LT;ctype.h&GT;</span> 
 
<span class='Keyword'>#include </span><span class='String'>"access/htup_details.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/sysattr.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/heap.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/namespace.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_type.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"funcapi.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"nodes/makefuncs.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"nodes/nodeFuncs.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parsetree.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parse_enr.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parse_relation.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parse_type.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/builtins.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/lsyscache.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/rel.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/syscache.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/varlena.h"</span> 
 
 
<a name="LN37"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>MAX_FUZZY_DISTANCE</span>              <span class='Number'>3</span> 
 
<a name="LN39"></a><span class='Keyword'>static </span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>scanNameSpaceForRefname</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, 
</span><a name="LN40"></a>                        <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>refname</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>location</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN41"></a><span class='Keyword'>static </span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>scanNameSpaceForRelid</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>relid</span><span class='Delimiter'>, 
</span><a name="LN42"></a>                      <span class='Keyword'>int </span><span class='Declare_Parameter'>location</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN43"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>check_lateral_ref_ok</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><a href="../../include/parser/parse_node.h.html#LN239"><span class='Ref_to_Struct'>ParseNamespaceItem</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>nsitem</span><span class='Delimiter'>, 
</span><a name="LN44"></a>                     <span class='Keyword'>int </span><span class='Declare_Parameter'>location</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN45"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>markRTEForSelectPriv</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rte</span><span class='Delimiter'>, 
</span><a name="LN46"></a>                     <span class='Keyword'>int </span><span class='Declare_Parameter'>rtindex</span><span class='Delimiter'>, </span><a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Declare_Parameter'>col</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN47"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>expandRelation</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>relid</span><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN38"><span class='Ref_to_Struct'>Alias</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>eref</span><span class='Delimiter'>, 
</span><a name="LN48"></a>               <span class='Keyword'>int </span><span class='Declare_Parameter'>rtindex</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>sublevels_up</span><span class='Delimiter'>, 
</span><a name="LN49"></a>               <span class='Keyword'>int </span><span class='Declare_Parameter'>location</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>include_dropped</span><span class='Delimiter'>, 
</span><a name="LN50"></a>               <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>colnames</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>colvars</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN51"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>expandTupleDesc</span><span class='Parentheses'>(</span><a href="../../include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a> <span class='Declare_Parameter'>tupdesc</span><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN38"><span class='Ref_to_Struct'>Alias</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>eref</span><span class='Delimiter'>, 
</span><a name="LN52"></a>                <span class='Keyword'>int </span><span class='Declare_Parameter'>count</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>offset</span><span class='Delimiter'>, 
</span><a name="LN53"></a>                <span class='Keyword'>int </span><span class='Declare_Parameter'>rtindex</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>sublevels_up</span><span class='Delimiter'>, 
</span><a name="LN54"></a>                <span class='Keyword'>int </span><span class='Declare_Parameter'>location</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>include_dropped</span><span class='Delimiter'>, 
</span><a name="LN55"></a>                <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>colnames</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>colvars</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN56"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>specialAttNum</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>attname</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN57"></a><span class='Keyword'>static bool </span><span class='Declare_Prototype'>isQueryUsingTempRelation_walker</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, </span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * refnameRangeTblEntry 
 *    Given a possibly-qualified refname, look to see if it matches any RTE. 
 *    If so, return a pointer to the RangeTblEntry; else return NULL. 
 * 
 *    Optionally get RTE's nesting depth (0 = current) into *sublevels_up. 
 *    If sublevels_up is NULL, only consider items at the current nesting 
 *    level. 
 * 
 * An unqualified refname (schemaname == NULL) can match any RTE with matching 
 * alias, or matching unqualified relname in the case of alias-less relation 
 * RTEs.  It is possible that such a refname matches multiple RTEs in the 
 * nearest nesting level that has a match; if so, we report an error via 
 * ereport(). 
 * 
 * A qualified refname (schemaname != NULL) can only match a relation RTE 
 * that (a) has no alias and (b) is for the same relation identified by 
 * schemaname.refname.  In this case we convert schemaname.refname to a 
 * relation OID and search by relid, rather than by alias name.  This is 
 * peculiar, but it's what SQL says to do. 
 */ 
</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>* 
</span><a name="LN82"></a><span class='Declare_Function'>refnameRangeTblEntry</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, 
</span><a name="LN83"></a>                     <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>schemaname</span><span class='Delimiter'>, 
</span><a name="LN84"></a>                     <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>refname</span><span class='Delimiter'>, 
</span><a name="LN85"></a>                     <span class='Keyword'>int </span><span class='Declare_Parameter'>location</span><span class='Delimiter'>, 
</span><a name="LN86"></a>                     <span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>sublevels_up</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN88"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>relId</span> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN86"><span class='Ref_to_Parameter'>sublevels_up</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="parse_relation.c.html#LN86"><span class='Ref_to_Parameter'>sublevels_up</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN83"><span class='Ref_to_Parameter'>schemaname</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN95"></a>        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceId</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * We can use LookupNamespaceNoError() here because we are only 
         * interested in finding existing RTEs.  Checking USAGE permission on 
         * the schema is unnecessary since it would have already been checked 
         * when the RTE was made.  Furthermore, we want to report "RTE not 
         * found", not "no permissions for schema", if the name happens to 
         * match a schema name the user hasn't got access to. 
         */ 
</span>        <a href="parse_relation.c.html#LN95"><span class='Ref_To_Local'>namespaceId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN112"><span class='Ref_to_Proto'>LookupNamespaceNoError</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN83"><span class='Ref_to_Parameter'>schemaname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN95"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN88"><span class='Ref_To_Local'>relId</span></a> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN123"><span class='Ref_to_Proto'>get_relname_relid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN84"><span class='Ref_to_Parameter'>refname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN95"><span class='Ref_To_Local'>namespaceId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN88"><span class='Ref_To_Local'>relId</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN82"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN115"></a>        <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN88"><span class='Ref_To_Local'>relId</span></a><span class='Parentheses'>))</span> 
            <a href="parse_relation.c.html#LN115"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN41"><span class='Ref_to_Proto'>scanNameSpaceForRelid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN82"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN88"><span class='Ref_To_Local'>relId</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN85"><span class='Ref_to_Parameter'>location</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="parse_relation.c.html#LN115"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN39"><span class='Ref_to_Proto'>scanNameSpaceForRefname</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN82"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN84"><span class='Ref_to_Parameter'>refname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN85"><span class='Ref_to_Parameter'>location</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN115"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <a href="parse_relation.c.html#LN115"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN86"><span class='Ref_to_Parameter'>sublevels_up</span></a><span class='Parentheses'>) 
</span>            <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="parse_relation.c.html#LN86"><span class='Ref_to_Parameter'>sublevels_up</span></a><span class='Parentheses'>)</span><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <a href="parse_relation.c.html#LN82"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN82"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN166"><span class='Ref_to_Member'>parentParseState</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end refnameRangeTblEntry &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Search the query's table namespace for an RTE matching the 
 * given unqualified refname.  Return the RTE if a unique match, or NULL 
 * if no match.  Raise error if multiple matches. 
 * 
 * Note: it might seem that we shouldn't have to worry about the possibility 
 * of multiple matches; after all, the SQL standard disallows duplicate table 
 * aliases within a given SELECT level.  Historically, however, Postgres has 
 * been laxer than that.  For example, we allow 
 *      SELECT ... FROM tab1 x CROSS JOIN (tab2 x CROSS JOIN tab3 y) z 
 * on the grounds that the aliased join (z) hides the aliases within it, 
 * therefore there is no conflict between the two RTEs named "x".  However, 
 * if tab3 is a LATERAL subquery, then from within the subquery both "x"es 
 * are visible.  Rather than rejecting queries that used to work, we allow 
 * this situation, and complain only if there's actually an ambiguous 
 * reference to "x". 
 */ 
</span><span class='Keyword'>static </span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>* 
</span><a name="LN153"></a><span class='Declare_Function'>scanNameSpaceForRefname</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>refname</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>location</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN155"></a>    <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>result</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN156"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN156"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN153"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN172"><span class='Ref_to_Member'>p_namespace</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN160"></a>        <a href="../../include/parser/parse_node.h.html#LN239"><span class='Ref_to_Struct'>ParseNamespaceItem</span></a> <span class='Operator'>*</span><span class='Declare_Local'>nsitem</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN239"><span class='Ref_to_Struct'>ParseNamespaceItem</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN156"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN161"></a>        <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN160"><span class='Ref_To_Local'>nsitem</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN241"><span class='Ref_to_Member'>p_rte</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Ignore columns-only items */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_relation.c.html#LN160"><span class='Ref_To_Local'>nsitem</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN242"><span class='Ref_to_Member'>p_rel_visible</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* If not inside LATERAL, ignore lateral-only items */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN160"><span class='Ref_To_Local'>nsitem</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN244"><span class='Ref_to_Member'>p_lateral_only</span></a> <span class='Operator'>&& !</span><a href="parse_relation.c.html#LN153"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN174"><span class='Ref_to_Member'>p_lateral_active</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="parse_relation.c.html#LN161"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN153"><span class='Ref_to_Parameter'>refname</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN155"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_AMBIGUOUS_ALIAS<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"table reference \"%s\" is ambiguous"</span><span class='Delimiter'>, 
</span>                                <a href="parse_relation.c.html#LN153"><span class='Ref_to_Parameter'>refname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN153"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN153"><span class='Ref_to_Parameter'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <a href="parse_relation.c.html#LN43"><span class='Ref_to_Proto'>check_lateral_ref_ok</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN153"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN160"><span class='Ref_To_Local'>nsitem</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN153"><span class='Ref_to_Parameter'>location</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_relation.c.html#LN155"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN161"><span class='Ref_To_Local'>rte</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="parse_relation.c.html#LN155"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end scanNameSpaceForRefname &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Search the query's table namespace for a relation RTE matching the 
 * given relation OID.  Return the RTE if a unique match, or NULL 
 * if no match.  Raise error if multiple matches. 
 * 
 * See the comments for refnameRangeTblEntry to understand why this 
 * acts the way it does. 
 */ 
</span><span class='Keyword'>static </span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>* 
</span><a name="LN194"></a><span class='Declare_Function'>scanNameSpaceForRelid</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>relid</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>location</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN196"></a>    <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>result</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN197"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN197"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN194"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN172"><span class='Ref_to_Member'>p_namespace</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN201"></a>        <a href="../../include/parser/parse_node.h.html#LN239"><span class='Ref_to_Struct'>ParseNamespaceItem</span></a> <span class='Operator'>*</span><span class='Declare_Local'>nsitem</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN239"><span class='Ref_to_Struct'>ParseNamespaceItem</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN197"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN202"></a>        <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN201"><span class='Ref_To_Local'>nsitem</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN241"><span class='Ref_to_Member'>p_rte</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Ignore columns-only items */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_relation.c.html#LN201"><span class='Ref_To_Local'>nsitem</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN242"><span class='Ref_to_Member'>p_rel_visible</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* If not inside LATERAL, ignore lateral-only items */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN201"><span class='Ref_To_Local'>nsitem</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN244"><span class='Ref_to_Member'>p_lateral_only</span></a> <span class='Operator'>&& !</span><a href="parse_relation.c.html#LN194"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN174"><span class='Ref_to_Member'>p_lateral_active</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* yes, the test for alias == NULL should be there... */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN202"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN922"><span class='Ref_to_EnumConst'>RTE_RELATION</span></a> <span class='Operator'>&& 
</span>            <a href="parse_relation.c.html#LN202"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN947"><span class='Ref_to_Member'>relid</span></a> <span class='Operator'>== </span><a href="parse_relation.c.html#LN194"><span class='Ref_to_Parameter'>relid</span></a> <span class='Operator'>&& 
</span>            <a href="parse_relation.c.html#LN202"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1022"><span class='Ref_to_Member'>alias</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN196"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_AMBIGUOUS_ALIAS<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"table reference %u is ambiguous"</span><span class='Delimiter'>, 
</span>                                <a href="parse_relation.c.html#LN194"><span class='Ref_to_Parameter'>relid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN194"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN194"><span class='Ref_to_Parameter'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <a href="parse_relation.c.html#LN43"><span class='Ref_to_Proto'>check_lateral_ref_ok</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN194"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN201"><span class='Ref_To_Local'>nsitem</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN194"><span class='Ref_to_Parameter'>location</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_relation.c.html#LN196"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN202"><span class='Ref_To_Local'>rte</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="parse_relation.c.html#LN196"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end scanNameSpaceForRelid &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Search the query's CTE namespace for a CTE matching the given unqualified 
 * refname.  Return the CTE (and its levelsup count) if a match, or NULL 
 * if no match.  We need not worry about multiple matches, since parse_cte.c 
 * rejects WITH lists containing duplicate CTE names. 
 */ 
</span><a href="../../include/nodes/parsenodes.h.html#LN1339"><span class='Ref_to_Struct'>CommonTableExpr</span></a> <span class='Operator'>* 
</span><a name="LN236"></a><span class='Declare_Function'>scanNameSpaceForCTE</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>refname</span><span class='Delimiter'>, 
</span><a name="LN237"></a>                    <a href="../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>ctelevelsup</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN239"></a>    <a href="../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>       <span class='Declare_Local'>levelsup</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN239"><span class='Ref_To_Local'>levelsup</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>         <a href="parse_relation.c.html#LN236"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>         <a href="parse_relation.c.html#LN236"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN236"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN166"><span class='Ref_to_Member'>parentParseState</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN239"><span class='Ref_To_Local'>levelsup</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN245"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN245"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN236"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN175"><span class='Ref_to_Member'>p_ctenamespace</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN249"></a>            <a href="../../include/nodes/parsenodes.h.html#LN1339"><span class='Ref_to_Struct'>CommonTableExpr</span></a> <span class='Operator'>*</span><span class='Declare_Local'>cte</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN1339"><span class='Ref_to_Struct'>CommonTableExpr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN245"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="parse_relation.c.html#LN249"><span class='Ref_To_Local'>cte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1342"><span class='Ref_to_Member'>ctename</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN236"><span class='Ref_to_Parameter'>refname</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Operator'>*</span><a href="parse_relation.c.html#LN237"><span class='Ref_to_Parameter'>ctelevelsup</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN239"><span class='Ref_To_Local'>levelsup</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>return</span> <a href="parse_relation.c.html#LN249"><span class='Ref_To_Local'>cte</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end scanNameSpaceForCTE &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Search for a possible "future CTE", that is one that is not yet in scope 
 * according to the WITH scoping rules.  This has nothing to do with valid 
 * SQL semantics, but it's important for error reporting purposes. 
 */ 
</span><span class='Keyword'>static bool 
</span><a name="LN267"></a><span class='Declare_Function'>isFutureCTE</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>refname</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>; </span><a href="parse_relation.c.html#LN267"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; </span><a href="parse_relation.c.html#LN267"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN267"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN166"><span class='Ref_to_Member'>parentParseState</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN271"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN271"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN267"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN176"><span class='Ref_to_Member'>p_future_ctes</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN275"></a>            <a href="../../include/nodes/parsenodes.h.html#LN1339"><span class='Ref_to_Struct'>CommonTableExpr</span></a> <span class='Operator'>*</span><span class='Declare_Local'>cte</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN1339"><span class='Ref_to_Struct'>CommonTableExpr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN271"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="parse_relation.c.html#LN275"><span class='Ref_To_Local'>cte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1342"><span class='Ref_to_Member'>ctename</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN267"><span class='Ref_to_Parameter'>refname</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Search the query's ephemeral named relation namespace for a relation 
 * matching the given unqualified refname. 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN289"></a><span class='Declare_Function'>scanNameSpaceForENR</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>refname</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="parse_enr.c.html#LN18"><span class='Ref_to_Func'>name_matches_visible_ENR</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN289"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN289"><span class='Ref_to_Parameter'>refname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * searchRangeTableForRel 
 *    See if any RangeTblEntry could possibly match the RangeVar. 
 *    If so, return a pointer to the RangeTblEntry; else return NULL. 
 * 
 * This is different from refnameRangeTblEntry in that it considers every 
 * entry in the ParseState's rangetable(s), not only those that are currently 
 * visible in the p_namespace list(s).  This behavior is invalid per the SQL 
 * spec, and it may give ambiguous results (there might be multiple equally 
 * valid matches, but only one will be returned).  This must be used ONLY 
 * as a heuristic in giving suitable error messages.  See errorMissingRTE. 
 * 
 * Notice that we consider both matches on actual relation (or CTE) name 
 * and matches on alias. 
 */ 
</span><span class='Keyword'>static </span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>* 
</span><a name="LN310"></a><span class='Declare_Function'>searchRangeTableForRel</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN62"><span class='Ref_to_Struct'>RangeVar</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>relation</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN312"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>refname</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN310"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Delimiter'>; 
</span><a name="LN313"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>relId</span> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span><a name="LN314"></a>    <a href="../../include/nodes/parsenodes.h.html#LN1339"><span class='Ref_to_Struct'>CommonTableExpr</span></a> <span class='Operator'>*</span><span class='Declare_Local'>cte</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN315"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>isenr</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN316"></a>    <a href="../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>       <span class='Declare_Local'>ctelevelsup</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN317"></a>    <a href="../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>       <span class='Declare_Local'>levelsup</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If it's an unqualified name, check for possible CTE matches. A CTE 
     * hides any real relation matches.  If no CTE, look for a matching 
     * relation. 
     * 
     * NB: It's not critical that RangeVarGetRelid return the correct answer 
     * here in the face of concurrent DDL.  If it doesn't, the worst case 
     * scenario is a less-clear error message.  Also, the tables involved in 
     * the query are already locked, which reduces the number of cases in 
     * which surprising behavior can occur.  So we do the name lookup 
     * unlocked. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_relation.c.html#LN310"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="parse_relation.c.html#LN314"><span class='Ref_To_Local'>cte</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_relation.h.html#LN41"><span class='Ref_to_Proto'>scanNameSpaceForCTE</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN310"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN312"><span class='Ref_To_Local'>refname</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="parse_relation.c.html#LN316"><span class='Ref_To_Local'>ctelevelsup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_relation.c.html#LN314"><span class='Ref_To_Local'>cte</span></a><span class='Parentheses'>) 
</span>            <a href="parse_relation.c.html#LN315"><span class='Ref_To_Local'>isenr</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_relation.h.html#LN44"><span class='Ref_to_Proto'>scanNameSpaceForENR</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN310"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN312"><span class='Ref_To_Local'>refname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_relation.c.html#LN314"><span class='Ref_To_Local'>cte</span></a> <span class='Operator'>&& !</span><a href="parse_relation.c.html#LN315"><span class='Ref_To_Local'>isenr</span></a><span class='Parentheses'>) 
</span>        <a href="parse_relation.c.html#LN313"><span class='Ref_To_Local'>relId</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN52"><span class='Ref_to_Macro'>RangeVarGetRelid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN310"><span class='Ref_to_Parameter'>relation</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN33"><span class='Ref_to_Const'>NoLock</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Now look for RTEs matching either the relation/CTE/ENR or the alias */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN317"><span class='Ref_To_Local'>levelsup</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>         <a href="parse_relation.c.html#LN310"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>         <a href="parse_relation.c.html#LN310"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN310"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN166"><span class='Ref_to_Member'>parentParseState</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN317"><span class='Ref_To_Local'>levelsup</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN346"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN346"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN310"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN350"></a>            <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN346"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN350"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN922"><span class='Ref_to_EnumConst'>RTE_RELATION</span></a> <span class='Operator'>&& 
</span>                <a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN313"><span class='Ref_To_Local'>relId</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>                <a href="parse_relation.c.html#LN350"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN947"><span class='Ref_to_Member'>relid</span></a> <span class='Operator'>== </span><a href="parse_relation.c.html#LN313"><span class='Ref_To_Local'>relId</span></a><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <a href="parse_relation.c.html#LN350"><span class='Ref_To_Local'>rte</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN350"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN928"><span class='Ref_to_EnumConst'>RTE_CTE</span></a> <span class='Operator'>&& 
</span>                <a href="parse_relation.c.html#LN314"><span class='Ref_To_Local'>cte</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& 
</span>                <a href="parse_relation.c.html#LN350"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1002"><span class='Ref_to_Member'>ctelevelsup</span></a> <span class='Operator'>+ </span><a href="parse_relation.c.html#LN317"><span class='Ref_To_Local'>levelsup</span></a> <span class='Operator'>== </span><a href="parse_relation.c.html#LN316"><span class='Ref_To_Local'>ctelevelsup</span></a> <span class='Operator'>&& 
</span>                strcmp<span class='Parentheses'>(</span><a href="parse_relation.c.html#LN350"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1001"><span class='Ref_to_Member'>ctename</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN312"><span class='Ref_To_Local'>refname</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <a href="parse_relation.c.html#LN350"><span class='Ref_To_Local'>rte</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN350"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN929"><span class='Ref_to_EnumConst'>RTE_NAMEDTUPLESTORE</span></a> <span class='Operator'>&& 
</span>                <a href="parse_relation.c.html#LN315"><span class='Ref_To_Local'>isenr</span></a> <span class='Operator'>&& 
</span>                strcmp<span class='Parentheses'>(</span><a href="parse_relation.c.html#LN350"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1016"><span class='Ref_to_Member'>enrname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN312"><span class='Ref_To_Local'>refname</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <a href="parse_relation.c.html#LN350"><span class='Ref_To_Local'>rte</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="parse_relation.c.html#LN350"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN312"><span class='Ref_To_Local'>refname</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <a href="parse_relation.c.html#LN350"><span class='Ref_To_Local'>rte</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for levelsup=0;pstate!=NU... &raquo; </span> 
    <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end searchRangeTableForRel &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Check for relation-name conflicts between two namespace lists. 
 * Raise an error if any is found. 
 * 
 * Note: we assume that each given argument does not contain conflicts 
 * itself; we just want to know if the two can be merged together. 
 * 
 * Per SQL, two alias-less plain relation RTEs do not conflict even if 
 * they have the same eref-&GT;aliasname (ie, same relation name), if they 
 * are for different relation OIDs (implying they are in different schemas). 
 * 
 * We ignore the lateral-only flags in the namespace items: the lists must 
 * not conflict, even when all items are considered visible.  However, 
 * columns-only items should be ignored. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN388"></a><span class='Declare_Function'>checkNameSpaceConflicts</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>namespace1</span><span class='Delimiter'>, 
</span><a name="LN389"></a>                        <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>namespace2</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN391"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l1</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN391"><span class='Ref_To_Local'>l1</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN388"><span class='Ref_to_Parameter'>namespace1</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN395"></a>        <a href="../../include/parser/parse_node.h.html#LN239"><span class='Ref_to_Struct'>ParseNamespaceItem</span></a> <span class='Operator'>*</span><span class='Declare_Local'>nsitem1</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN239"><span class='Ref_to_Struct'>ParseNamespaceItem</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN391"><span class='Ref_To_Local'>l1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN396"></a>        <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte1</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN395"><span class='Ref_To_Local'>nsitem1</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN241"><span class='Ref_to_Member'>p_rte</span></a><span class='Delimiter'>; 
</span><a name="LN397"></a>        <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>aliasname1</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN396"><span class='Ref_To_Local'>rte1</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a><span class='Delimiter'>; 
</span><a name="LN398"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l2</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_relation.c.html#LN395"><span class='Ref_To_Local'>nsitem1</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN242"><span class='Ref_to_Member'>p_rel_visible</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN398"><span class='Ref_To_Local'>l2</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN389"><span class='Ref_to_Parameter'>namespace2</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN405"></a>            <a href="../../include/parser/parse_node.h.html#LN239"><span class='Ref_to_Struct'>ParseNamespaceItem</span></a> <span class='Operator'>*</span><span class='Declare_Local'>nsitem2</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN239"><span class='Ref_to_Struct'>ParseNamespaceItem</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN398"><span class='Ref_To_Local'>l2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN406"></a>            <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte2</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN405"><span class='Ref_To_Local'>nsitem2</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN241"><span class='Ref_to_Member'>p_rte</span></a><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_relation.c.html#LN405"><span class='Ref_To_Local'>nsitem2</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN242"><span class='Ref_to_Member'>p_rel_visible</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="parse_relation.c.html#LN406"><span class='Ref_To_Local'>rte2</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN397"><span class='Ref_To_Local'>aliasname1</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>continue</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* definitely no conflict */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN396"><span class='Ref_To_Local'>rte1</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN922"><span class='Ref_to_EnumConst'>RTE_RELATION</span></a> <span class='Operator'>&& </span><a href="parse_relation.c.html#LN396"><span class='Ref_To_Local'>rte1</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1022"><span class='Ref_to_Member'>alias</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>&& 
</span>                <a href="parse_relation.c.html#LN406"><span class='Ref_To_Local'>rte2</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN922"><span class='Ref_to_EnumConst'>RTE_RELATION</span></a> <span class='Operator'>&& </span><a href="parse_relation.c.html#LN406"><span class='Ref_To_Local'>rte2</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1022"><span class='Ref_to_Member'>alias</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>&& 
</span>                <a href="parse_relation.c.html#LN396"><span class='Ref_To_Local'>rte1</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN947"><span class='Ref_to_Member'>relid</span></a> <span class='Operator'>!= </span><a href="parse_relation.c.html#LN406"><span class='Ref_To_Local'>rte2</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN947"><span class='Ref_to_Member'>relid</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* no conflict per SQL rule */ 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DUPLICATE_ALIAS<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"table name \"%s\" specified more than once"</span><span class='Delimiter'>, 
</span>                            <a href="parse_relation.c.html#LN397"><span class='Ref_To_Local'>aliasname1</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end checkNameSpaceConflicts &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Complain if a namespace item is currently disallowed as a LATERAL reference. 
 * This enforces both SQL:2008's rather odd idea of what to do with a LATERAL 
 * reference to the wrong side of an outer join, and our own prohibition on 
 * referencing the target table of an UPDATE or DELETE as a lateral reference 
 * in a FROM/USING clause. 
 * 
 * Convenience subroutine to avoid multiple copies of a rather ugly ereport. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN434"></a><span class='Declare_Function'>check_lateral_ref_ok</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><a href="../../include/parser/parse_node.h.html#LN239"><span class='Ref_to_Struct'>ParseNamespaceItem</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>nsitem</span><span class='Delimiter'>, 
</span><a name="LN435"></a>                     <span class='Keyword'>int </span><span class='Declare_Parameter'>location</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN434"><span class='Ref_to_Parameter'>nsitem</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN244"><span class='Ref_to_Member'>p_lateral_only</span></a> <span class='Operator'>&& !</span><a href="parse_relation.c.html#LN434"><span class='Ref_to_Parameter'>nsitem</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN245"><span class='Ref_to_Member'>p_lateral_ok</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* SQL:2008 demands this be an error, not an invisible item */ 
</span><a name="LN440"></a>        <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN434"><span class='Ref_to_Parameter'>nsitem</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN241"><span class='Ref_to_Member'>p_rte</span></a><span class='Delimiter'>; 
</span><a name="LN441"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>refname</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN440"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a><span class='Delimiter'>; 
</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_COLUMN_REFERENCE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>            <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"invalid reference to FROM-clause entry for table \"%s\""</span><span class='Delimiter'>, 
</span>                   <a href="parse_relation.c.html#LN441"><span class='Ref_To_Local'>refname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN440"><span class='Ref_To_Local'>rte</span></a> <span class='Operator'>== </span><a href="parse_relation.c.html#LN434"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN179"><span class='Ref_to_Member'>p_target_rangetblentry</span></a><span class='Parentheses'>) </span><span class='Operator'>? 
</span>                 <a href="../utils/error/elog.c.html#LN985"><span class='Ref_to_Func'>errhint</span></a><span class='Parentheses'>(</span><span class='String'>"There is an entry for table \"%s\", but it cannot be referenced from this part of the query."</span><span class='Delimiter'>, 
</span>                         <a href="parse_relation.c.html#LN441"><span class='Ref_To_Local'>refname</span></a><span class='Parentheses'>) </span><span class='Operator'>: 
</span>                 <a href="../utils/error/elog.c.html#LN871"><span class='Ref_to_Func'>errdetail</span></a><span class='Parentheses'>(</span><span class='String'>"The combining JOIN type must be INNER or LEFT for a LATERAL reference."</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN434"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN435"><span class='Ref_to_Parameter'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end check_lateral_ref_ok &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * given an RTE, return RT index (starting with 1) of the entry, 
 * and optionally get its nesting depth (0 = current).  If sublevels_up 
 * is NULL, only consider rels at the current nesting level. 
 * Raises error if RTE not found. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN462"></a><span class='Declare_Function'>RTERangeTablePosn</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rte</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>sublevels_up</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN464"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>index</span><span class='Delimiter'>; 
</span><a name="LN465"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN462"><span class='Ref_to_Parameter'>sublevels_up</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="parse_relation.c.html#LN462"><span class='Ref_to_Parameter'>sublevels_up</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN462"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="parse_relation.c.html#LN464"><span class='Ref_To_Local'>index</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN465"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN462"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN462"><span class='Ref_to_Parameter'>rte</span></a> <span class='Operator'>== </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN465"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>))</span> 
                <span class='Control'>return</span> <a href="parse_relation.c.html#LN464"><span class='Ref_To_Local'>index</span></a><span class='Delimiter'>; 
</span>            <a href="parse_relation.c.html#LN464"><span class='Ref_To_Local'>index</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="parse_relation.c.html#LN462"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN462"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN166"><span class='Ref_to_Member'>parentParseState</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN462"><span class='Ref_to_Parameter'>sublevels_up</span></a><span class='Parentheses'>) 
</span>            <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="parse_relation.c.html#LN462"><span class='Ref_to_Parameter'>sublevels_up</span></a><span class='Parentheses'>)</span><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"RTE not found (internal error)"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>;</span>                   <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span><span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end RTERangeTablePosn &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Given an RT index and nesting depth, find the corresponding RTE. 
 * This is the inverse of RTERangeTablePosn. 
 */ 
</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>* 
</span><a name="LN495"></a><span class='Declare_Function'>GetRTEByRangeTablePosn</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, 
</span><a name="LN496"></a>                       <span class='Keyword'>int </span><span class='Declare_Parameter'>varno</span><span class='Delimiter'>, 
</span><a name="LN497"></a>                       <span class='Keyword'>int </span><span class='Declare_Parameter'>sublevels_up</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN497"><span class='Ref_to_Parameter'>sublevels_up</span></a><span class='Operator'>-- &GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="parse_relation.c.html#LN495"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN495"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN166"><span class='Ref_to_Member'>parentParseState</span></a><span class='Delimiter'>; 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN495"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN496"><span class='Ref_to_Parameter'>varno</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="parse_relation.c.html#LN496"><span class='Ref_to_Parameter'>varno</span></a> <span class='Operator'>&LT;= </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN495"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="../../include/parser/parsetree.h.html#LN30"><span class='Ref_to_Macro'>rt_fetch</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN496"><span class='Ref_to_Parameter'>varno</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN495"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Fetch the CTE for a CTE-reference RTE. 
 * 
 * rtelevelsup is the number of query levels above the given pstate that the 
 * RTE came from.  Callers that don't have this information readily available 
 * may pass -1 instead. 
 */ 
</span><a href="../../include/nodes/parsenodes.h.html#LN1339"><span class='Ref_to_Struct'>CommonTableExpr</span></a> <span class='Operator'>* 
</span><a name="LN516"></a><span class='Declare_Function'>GetCTEForRTE</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rte</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>rtelevelsup</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN518"></a>    <a href="../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>       <span class='Declare_Local'>levelsup</span><span class='Delimiter'>; 
</span><a name="LN519"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Determine RTE's levelsup if caller didn't know it */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN516"><span class='Ref_to_Parameter'>rtelevelsup</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="../../include/parser/parse_relation.h.html#LN47"><span class='Ref_to_Proto'>RTERangeTablePosn</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN516"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN516"><span class='Ref_to_Parameter'>rte</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="parse_relation.c.html#LN516"><span class='Ref_to_Parameter'>rtelevelsup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN516"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN928"><span class='Ref_to_EnumConst'>RTE_CTE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN518"><span class='Ref_To_Local'>levelsup</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN516"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1002"><span class='Ref_to_Member'>ctelevelsup</span></a> <span class='Operator'>+ </span><a href="parse_relation.c.html#LN516"><span class='Ref_to_Parameter'>rtelevelsup</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN518"><span class='Ref_To_Local'>levelsup</span></a><span class='Operator'>-- &GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="parse_relation.c.html#LN516"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN516"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN166"><span class='Ref_to_Member'>parentParseState</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_relation.c.html#LN516"><span class='Ref_to_Parameter'>pstate</span></a><span class='Parentheses'>)</span>            <span class='Comment_Single_Line'>/* shouldn't happen */ 
</span>            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"bad levelsup for CTE \"%s\""</span><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN516"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1001"><span class='Ref_to_Member'>ctename</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN519"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN516"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN175"><span class='Ref_to_Member'>p_ctenamespace</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN535"></a>        <a href="../../include/nodes/parsenodes.h.html#LN1339"><span class='Ref_to_Struct'>CommonTableExpr</span></a> <span class='Operator'>*</span><span class='Declare_Local'>cte</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN1339"><span class='Ref_to_Struct'>CommonTableExpr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN519"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="parse_relation.c.html#LN535"><span class='Ref_To_Local'>cte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1342"><span class='Ref_to_Member'>ctename</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN516"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1001"><span class='Ref_to_Member'>ctename</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <a href="parse_relation.c.html#LN535"><span class='Ref_To_Local'>cte</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* shouldn't happen */ 
</span>    <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"could not find CTE \"%s\""</span><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN516"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1001"><span class='Ref_to_Member'>ctename</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span><span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end GetCTEForRTE &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * updateFuzzyAttrMatchState 
 *    Using Levenshtein distance, consider if column is best fuzzy match. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN550"></a><span class='Declare_Function'>updateFuzzyAttrMatchState</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>fuzzy_rte_penalty</span><span class='Delimiter'>, 
</span><a name="LN551"></a>                          <a href="../../include/parser/parse_relation.h.html#LN26"><span class='Ref_to_Typedef'>FuzzyAttrMatchState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>fuzzystate</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rte</span><span class='Delimiter'>, 
</span><a name="LN552"></a>                          <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>actual</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>match</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>attnum</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN554"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>columndistance</span><span class='Delimiter'>; 
</span><a name="LN555"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>matchlen</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Bail before computing the Levenshtein distance if there's no hope. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN550"><span class='Ref_to_Parameter'>fuzzy_rte_penalty</span></a> <span class='Operator'>&GT; </span><a href="parse_relation.c.html#LN551"><span class='Ref_to_Parameter'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN28"><span class='Ref_to_Member'>distance</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Outright reject dropped columns, which can appear here with apparent 
     * empty actual names, per remarks within scanRTEForColumn(). 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN552"><span class='Ref_to_Parameter'>actual</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Use Levenshtein to compute match distance. */ 
</span>    <a href="parse_relation.c.html#LN555"><span class='Ref_To_Local'>matchlen</span></a> <span class='Operator'>= </span>strlen<span class='Parentheses'>(</span><a href="parse_relation.c.html#LN552"><span class='Ref_to_Parameter'>match</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN554"><span class='Ref_To_Local'>columndistance</span></a> <span class='Operator'>= 
</span>        <a href="../../include/utils/varlena.h.html#LN24"><span class='Ref_to_Proto'>varstr_levenshtein_less_equal</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN552"><span class='Ref_to_Parameter'>actual</span></a><span class='Delimiter'>, </span>strlen<span class='Parentheses'>(</span><a href="parse_relation.c.html#LN552"><span class='Ref_to_Parameter'>actual</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN552"><span class='Ref_to_Parameter'>match</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN555"><span class='Ref_To_Local'>matchlen</span></a><span class='Delimiter'>, 
</span>                                      <span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, 
</span>                                      <a href="parse_relation.c.html#LN551"><span class='Ref_to_Parameter'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN28"><span class='Ref_to_Member'>distance</span></a> <span class='Operator'>+ </span><span class='Number'>1</span> 
                                      <span class='Operator'>- </span><a href="parse_relation.c.html#LN550"><span class='Ref_to_Parameter'>fuzzy_rte_penalty</span></a><span class='Delimiter'>, 
</span>                                      <span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If more than half the characters are different, don't treat it as a 
     * match, to avoid making ridiculous suggestions. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN554"><span class='Ref_To_Local'>columndistance</span></a> <span class='Operator'>&GT; </span><a href="parse_relation.c.html#LN555"><span class='Ref_To_Local'>matchlen</span></a> <span class='Operator'>/ </span><span class='Number'>2</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * From this point on, we can ignore the distinction between the RTE-name 
     * distance and the column-name distance. 
     */ 
</span>    <a href="parse_relation.c.html#LN554"><span class='Ref_To_Local'>columndistance</span></a> <span class='Operator'>+= </span><a href="parse_relation.c.html#LN550"><span class='Ref_to_Parameter'>fuzzy_rte_penalty</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If the new distance is less than or equal to that of the best match 
     * found so far, update fuzzystate. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN554"><span class='Ref_To_Local'>columndistance</span></a> <span class='Operator'>&LT; </span><a href="parse_relation.c.html#LN551"><span class='Ref_to_Parameter'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN28"><span class='Ref_to_Member'>distance</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Store new lowest observed distance for RTE */ 
</span>        <a href="parse_relation.c.html#LN551"><span class='Ref_to_Parameter'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN28"><span class='Ref_to_Member'>distance</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN554"><span class='Ref_To_Local'>columndistance</span></a><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN551"><span class='Ref_to_Parameter'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN29"><span class='Ref_to_Member'>rfirst</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN551"><span class='Ref_to_Parameter'>rte</span></a><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN551"><span class='Ref_to_Parameter'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN30"><span class='Ref_to_Member'>first</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN552"><span class='Ref_to_Parameter'>attnum</span></a><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN551"><span class='Ref_to_Parameter'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN31"><span class='Ref_to_Member'>rsecond</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN551"><span class='Ref_to_Parameter'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN32"><span class='Ref_to_Member'>second</span></a> <span class='Operator'>= </span><a href="../../include/access/attnum.h.html#LN22"><span class='Ref_to_Const'>InvalidAttrNumber</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN554"><span class='Ref_To_Local'>columndistance</span></a> <span class='Operator'>== </span><a href="parse_relation.c.html#LN551"><span class='Ref_to_Parameter'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN28"><span class='Ref_to_Member'>distance</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * This match distance may equal a prior match within this same range 
         * table.  When that happens, the prior match may also be given, but 
         * only if there is no more than two equally distant matches from the 
         * RTE (in turn, our caller will only accept two equally distant 
         * matches overall). 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/access/attnum.h.html#LN33"><span class='Ref_to_Macro'>AttributeNumberIsValid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN551"><span class='Ref_to_Parameter'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN32"><span class='Ref_to_Member'>second</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Too many RTE-level matches */ 
</span>            <a href="parse_relation.c.html#LN551"><span class='Ref_to_Parameter'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN29"><span class='Ref_to_Member'>rfirst</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <a href="parse_relation.c.html#LN551"><span class='Ref_to_Parameter'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN30"><span class='Ref_to_Member'>first</span></a> <span class='Operator'>= </span><a href="../../include/access/attnum.h.html#LN22"><span class='Ref_to_Const'>InvalidAttrNumber</span></a><span class='Delimiter'>; 
</span>            <a href="parse_relation.c.html#LN551"><span class='Ref_to_Parameter'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN31"><span class='Ref_to_Member'>rsecond</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <a href="parse_relation.c.html#LN551"><span class='Ref_to_Parameter'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN32"><span class='Ref_to_Member'>second</span></a> <span class='Operator'>= </span><a href="../../include/access/attnum.h.html#LN22"><span class='Ref_to_Const'>InvalidAttrNumber</span></a><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* Clearly, distance is too low a bar (for *any* RTE) */ 
</span>            <a href="parse_relation.c.html#LN551"><span class='Ref_to_Parameter'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN28"><span class='Ref_to_Member'>distance</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN554"><span class='Ref_To_Local'>columndistance</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/access/attnum.h.html#LN33"><span class='Ref_to_Macro'>AttributeNumberIsValid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN551"><span class='Ref_to_Parameter'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN30"><span class='Ref_to_Member'>first</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Record as provisional second match for RTE */ 
</span>            <a href="parse_relation.c.html#LN551"><span class='Ref_to_Parameter'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN31"><span class='Ref_to_Member'>rsecond</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN551"><span class='Ref_to_Parameter'>rte</span></a><span class='Delimiter'>; 
</span>            <a href="parse_relation.c.html#LN551"><span class='Ref_to_Parameter'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN32"><span class='Ref_to_Member'>second</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN552"><span class='Ref_to_Parameter'>attnum</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN551"><span class='Ref_to_Parameter'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN28"><span class='Ref_to_Member'>distance</span></a> <span class='Operator'>&LT;= </span><a href="parse_relation.c.html#LN37"><span class='Ref_to_Const'>MAX_FUZZY_DISTANCE</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * Record as provisional first match (this can occasionally occur 
             * because previous lowest distance was "too low a bar", rather 
             * than being associated with a real match) 
             */ 
</span>            <a href="parse_relation.c.html#LN551"><span class='Ref_to_Parameter'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN29"><span class='Ref_to_Member'>rfirst</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN551"><span class='Ref_to_Parameter'>rte</span></a><span class='Delimiter'>; 
</span>            <a href="parse_relation.c.html#LN551"><span class='Ref_to_Parameter'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN30"><span class='Ref_to_Member'>first</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN552"><span class='Ref_to_Parameter'>attnum</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if columndistance==fuzzy... &raquo; </span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end updateFuzzyAttrMatchState &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * scanRTEForColumn 
 *    Search the column names of a single RTE for the given name. 
 *    If found, return an appropriate Var node, else return NULL. 
 *    If the name proves ambiguous within this RTE, raise error. 
 * 
 * Side effect: if we find a match, mark the RTE as requiring read access 
 * for the column. 
 * 
 * Additional side effect: if fuzzystate is non-NULL, check non-system columns 
 * for an approximate match and update fuzzystate accordingly. 
 */ 
</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>* 
</span><a name="LN654"></a><span class='Declare_Function'>scanRTEForColumn</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rte</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>colname</span><span class='Delimiter'>, 
</span><a name="LN655"></a>                 <span class='Keyword'>int </span><span class='Declare_Parameter'>location</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>fuzzy_rte_penalty</span><span class='Delimiter'>, 
</span><a name="LN656"></a>                 <a href="../../include/parser/parse_relation.h.html#LN26"><span class='Ref_to_Typedef'>FuzzyAttrMatchState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>fuzzystate</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN658"></a>    <a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>result</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN659"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>attnum</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN660"></a>    <a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>var</span><span class='Delimiter'>; 
</span><a name="LN661"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>c</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Scan the user column names (or aliases) for a match. Complain if 
     * multiple matches. 
     * 
     * Note: eref-&GT;colnames may include entries for dropped columns, but those 
     * will be empty strings that cannot match any legal SQL identifier, so we 
     * don't bother to test for that case here. 
     * 
     * Should this somehow go wrong and we try to access a dropped column, 
     * we'll still catch it by virtue of the checks in 
     * get_rte_attribute_type(), which is called by make_var().  That routine 
     * has to do a cache lookup anyway, so the check there is cheap.  Callers 
     * interested in finding match with shortest distance need to defend 
     * against this directly, though. 
     */ 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN661"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN654"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN680"></a>        <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>attcolname</span> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN661"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <a href="parse_relation.c.html#LN659"><span class='Ref_To_Local'>attnum</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="parse_relation.c.html#LN680"><span class='Ref_To_Local'>attcolname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN654"><span class='Ref_to_Parameter'>colname</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN658"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_AMBIGUOUS_COLUMN<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"column reference \"%s\" is ambiguous"</span><span class='Delimiter'>, 
</span>                                <a href="parse_relation.c.html#LN654"><span class='Ref_to_Parameter'>colname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN654"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN655"><span class='Ref_to_Parameter'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <a href="parse_relation.c.html#LN660"><span class='Ref_To_Local'>var</span></a> <span class='Operator'>= </span><a href="parse_node.c.html#LN187"><span class='Ref_to_Func'>make_var</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN654"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN654"><span class='Ref_to_Parameter'>rte</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN659"><span class='Ref_To_Local'>attnum</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN655"><span class='Ref_to_Parameter'>location</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* Require read access to the column */ 
</span>            <a href="../../include/parser/parse_relation.h.html#LN60"><span class='Ref_to_Proto'>markVarForSelectPriv</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN654"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN660"><span class='Ref_To_Local'>var</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN654"><span class='Ref_to_Parameter'>rte</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_relation.c.html#LN658"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_relation.c.html#LN660"><span class='Ref_To_Local'>var</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* Updating fuzzy match state, if provided. */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN656"><span class='Ref_to_Parameter'>fuzzystate</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>            <a href="parse_relation.c.html#LN549"><span class='Ref_to_Func'>updateFuzzyAttrMatchState</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN655"><span class='Ref_to_Parameter'>fuzzy_rte_penalty</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN656"><span class='Ref_to_Parameter'>fuzzystate</span></a><span class='Delimiter'>, 
</span>                                      <a href="parse_relation.c.html#LN654"><span class='Ref_to_Parameter'>rte</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN680"><span class='Ref_To_Local'>attcolname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN654"><span class='Ref_to_Parameter'>colname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN659"><span class='Ref_To_Local'>attnum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If we have a unique match, return it.  Note that this allows a user 
     * alias to override a system column name (such as OID) without error. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN658"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="parse_relation.c.html#LN658"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If the RTE represents a real relation, consider system column names. 
     * Composites are only used for pseudo-relations like ON CONFLICT's 
     * excluded. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN654"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN922"><span class='Ref_to_EnumConst'>RTE_RELATION</span></a> <span class='Operator'>&& 
</span>        <a href="parse_relation.c.html#LN654"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN948"><span class='Ref_to_Member'>relkind</span></a> <span class='Operator'>!= </span><a href="../../include/catalog/pg_class.h.html#LN165"><span class='Ref_to_Const'>RELKIND_COMPOSITE_TYPE</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* quick check to see if name could be a system column */ 
</span>        <a href="parse_relation.c.html#LN659"><span class='Ref_To_Local'>attnum</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN56"><span class='Ref_to_Proto'>specialAttNum</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN654"><span class='Ref_to_Parameter'>colname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* In constraint check, no system column is allowed except tableOid */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN654"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN182"><span class='Ref_to_Member'>p_expr_kind</span></a> <span class='Operator'>== </span><a href="../../include/parser/parse_node.h.html#LN59"><span class='Ref_to_EnumConst'>EXPR_KIND_CHECK_CONSTRAINT</span></a> <span class='Operator'>&& 
</span>            <a href="parse_relation.c.html#LN659"><span class='Ref_To_Local'>attnum</span></a> <span class='Operator'>&LT; </span><a href="../../include/access/attnum.h.html#LN22"><span class='Ref_to_Const'>InvalidAttrNumber</span></a> <span class='Operator'>&& </span><a href="parse_relation.c.html#LN659"><span class='Ref_To_Local'>attnum</span></a> <span class='Operator'>!= </span><a href="../../include/access/sysattr.h.html#LN26"><span class='Ref_to_Const'>TableOidAttributeNumber</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_COLUMN_REFERENCE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"system column \"%s\" reference in check constraint is invalid"</span><span class='Delimiter'>, 
</span>                            <a href="parse_relation.c.html#LN654"><span class='Ref_to_Parameter'>colname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN654"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN655"><span class='Ref_to_Parameter'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN659"><span class='Ref_To_Local'>attnum</span></a> <span class='Operator'>!= </span><a href="../../include/access/attnum.h.html#LN22"><span class='Ref_to_Const'>InvalidAttrNumber</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* now check to see if column actually is defined */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN175"><span class='Ref_to_Macro'>SearchSysCacheExists2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN40"><span class='Ref_to_EnumConst'>ATTNUM</span></a><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN654"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN947"><span class='Ref_to_Member'>relid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                      <a href="../../include/postgres.h.html#LN456"><span class='Ref_to_Macro'>Int16GetDatum</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN659"><span class='Ref_To_Local'>attnum</span></a><span class='Parentheses'>)))</span> 
            <span class='Delimiter'>{ 
</span>                <a href="parse_relation.c.html#LN660"><span class='Ref_To_Local'>var</span></a> <span class='Operator'>= </span><a href="parse_node.c.html#LN187"><span class='Ref_to_Func'>make_var</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN654"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN654"><span class='Ref_to_Parameter'>rte</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN659"><span class='Ref_To_Local'>attnum</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN655"><span class='Ref_to_Parameter'>location</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Comment_Multi_Line'>/* Require read access to the column */ 
</span>                <a href="../../include/parser/parse_relation.h.html#LN60"><span class='Ref_to_Proto'>markVarForSelectPriv</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN654"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN660"><span class='Ref_To_Local'>var</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN654"><span class='Ref_to_Parameter'>rte</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="parse_relation.c.html#LN658"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_relation.c.html#LN660"><span class='Ref_To_Local'>var</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if rte-&GT;rtekind==RTE_REL... &raquo; </span> 
 
    <span class='Control'>return</span> <a href="parse_relation.c.html#LN658"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end scanRTEForColumn &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * colNameToVar 
 *    Search for an unqualified column name. 
 *    If found, return the appropriate Var node (or expression). 
 *    If not found, return NULL.  If the name proves ambiguous, raise error. 
 *    If localonly is true, only names in the innermost query are considered. 
 */ 
</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>* 
</span><a name="LN756"></a><span class='Declare_Function'>colNameToVar</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>colname</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>localonly</span><span class='Delimiter'>, 
</span><a name="LN757"></a>             <span class='Keyword'>int </span><span class='Declare_Parameter'>location</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN759"></a>    <a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>result</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN760"></a>    <a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Local'>orig_pstate</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN756"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN756"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN764"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN764"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN756"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN172"><span class='Ref_to_Member'>p_namespace</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN768"></a>            <a href="../../include/parser/parse_node.h.html#LN239"><span class='Ref_to_Struct'>ParseNamespaceItem</span></a> <span class='Operator'>*</span><span class='Declare_Local'>nsitem</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN239"><span class='Ref_to_Struct'>ParseNamespaceItem</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN764"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN769"></a>            <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN768"><span class='Ref_To_Local'>nsitem</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN241"><span class='Ref_to_Member'>p_rte</span></a><span class='Delimiter'>; 
</span><a name="LN770"></a>            <a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>newresult</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Ignore table-only items */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_relation.c.html#LN768"><span class='Ref_To_Local'>nsitem</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN243"><span class='Ref_to_Member'>p_cols_visible</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* If not inside LATERAL, ignore lateral-only items */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN768"><span class='Ref_To_Local'>nsitem</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN244"><span class='Ref_to_Member'>p_lateral_only</span></a> <span class='Operator'>&& !</span><a href="parse_relation.c.html#LN756"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN174"><span class='Ref_to_Member'>p_lateral_active</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* use orig_pstate here to get the right sublevels_up */ 
</span>            <a href="parse_relation.c.html#LN770"><span class='Ref_To_Local'>newresult</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_relation.h.html#LN55"><span class='Ref_to_Proto'>scanRTEForColumn</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN760"><span class='Ref_To_Local'>orig_pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN769"><span class='Ref_To_Local'>rte</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN756"><span class='Ref_to_Parameter'>colname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN757"><span class='Ref_to_Parameter'>location</span></a><span class='Delimiter'>, 
</span>                                         <span class='Number'>0</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN770"><span class='Ref_To_Local'>newresult</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN759"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) 
</span>                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_AMBIGUOUS_COLUMN<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"column reference \"%s\" is ambiguous"</span><span class='Delimiter'>, 
</span>                                    <a href="parse_relation.c.html#LN756"><span class='Ref_to_Parameter'>colname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN756"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN757"><span class='Ref_to_Parameter'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <a href="parse_relation.c.html#LN43"><span class='Ref_to_Proto'>check_lateral_ref_ok</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN756"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN768"><span class='Ref_To_Local'>nsitem</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN757"><span class='Ref_to_Parameter'>location</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="parse_relation.c.html#LN759"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN770"><span class='Ref_To_Local'>newresult</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN759"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span><a href="parse_relation.c.html#LN756"><span class='Ref_to_Parameter'>localonly</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>break</span><span class='Delimiter'>;</span>              <span class='Comment_Single_Line'>/* found, or don't want to look at parent */ 
</span> 
        <a href="parse_relation.c.html#LN756"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN756"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN166"><span class='Ref_to_Member'>parentParseState</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while pstate!=NULL &raquo; </span> 
 
    <span class='Control'>return</span> <a href="parse_relation.c.html#LN759"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end colNameToVar &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * searchRangeTableForCol 
 *    See if any RangeTblEntry could possibly provide the given column name (or 
 *    find the best match available).  Returns state with relevant details. 
 * 
 * This is different from colNameToVar in that it considers every entry in 
 * the ParseState's rangetable(s), not only those that are currently visible 
 * in the p_namespace list(s).  This behavior is invalid per the SQL spec, 
 * and it may give ambiguous results (there might be multiple equally valid 
 * matches, but only one will be returned).  This must be used ONLY as a 
 * heuristic in giving suitable error messages.  See errorMissingColumn. 
 * 
 * This function is also different in that it will consider approximate 
 * matches -- if the user entered an alias/column pair that is only slightly 
 * different from a valid pair, we may be able to infer what they meant to 
 * type and provide a reasonable hint. 
 * 
 * The FuzzyAttrMatchState will have 'rfirst' pointing to the best RTE 
 * containing the most promising match for the alias and column name.  If 
 * the alias and column names match exactly, 'first' will be InvalidAttrNumber; 
 * otherwise, it will be the attribute number for the match.  In the latter 
 * case, 'rsecond' may point to a second, equally close approximate match, 
 * and 'second' will contain the attribute number for the second match. 
 */ 
</span><span class='Keyword'>static </span><a href="../../include/parser/parse_relation.h.html#LN26"><span class='Ref_to_Typedef'>FuzzyAttrMatchState</span></a> <span class='Operator'>* 
</span><a name="LN830"></a><span class='Declare_Function'>searchRangeTableForCol</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>alias</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>colname</span><span class='Delimiter'>, 
</span><a name="LN831"></a>                       <span class='Keyword'>int </span><span class='Declare_Parameter'>location</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN833"></a>    <a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Local'>orig_pstate</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN830"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>; 
</span><a name="LN834"></a>    <a href="../../include/parser/parse_relation.h.html#LN26"><span class='Ref_to_Typedef'>FuzzyAttrMatchState</span></a> <span class='Operator'>*</span><span class='Declare_Local'>fuzzystate</span> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_relation.h.html#LN26"><span class='Ref_to_Typedef'>FuzzyAttrMatchState</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN834"><span class='Ref_To_Local'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN28"><span class='Ref_to_Member'>distance</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN37"><span class='Ref_to_Const'>MAX_FUZZY_DISTANCE</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN834"><span class='Ref_To_Local'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN29"><span class='Ref_to_Member'>rfirst</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN834"><span class='Ref_To_Local'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN31"><span class='Ref_to_Member'>rsecond</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN834"><span class='Ref_To_Local'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN30"><span class='Ref_to_Member'>first</span></a> <span class='Operator'>= </span><a href="../../include/access/attnum.h.html#LN22"><span class='Ref_to_Const'>InvalidAttrNumber</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN834"><span class='Ref_To_Local'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN32"><span class='Ref_to_Member'>second</span></a> <span class='Operator'>= </span><a href="../../include/access/attnum.h.html#LN22"><span class='Ref_to_Const'>InvalidAttrNumber</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN830"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN844"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN844"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN830"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN848"></a>            <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN844"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN849"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>fuzzy_rte_penalty</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Typically, it is not useful to look for matches within join 
             * RTEs; they effectively duplicate other RTEs for our purposes, 
             * and if a match is chosen from a join RTE, an unhelpful alias is 
             * displayed in the final diagnostic message. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN848"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN924"><span class='Ref_to_EnumConst'>RTE_JOIN</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * If the user didn't specify an alias, then matches against one 
             * RTE are as good as another.  But if the user did specify an 
             * alias, then we want at least a fuzzy - and preferably an exact 
             * - match for the range table entry. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN830"><span class='Ref_to_Parameter'>alias</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                <a href="parse_relation.c.html#LN849"><span class='Ref_To_Local'>fuzzy_rte_penalty</span></a> <span class='Operator'>= 
</span>                    <a href="../../include/utils/varlena.h.html#LN24"><span class='Ref_to_Proto'>varstr_levenshtein_less_equal</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN830"><span class='Ref_to_Parameter'>alias</span></a><span class='Delimiter'>, </span>strlen<span class='Parentheses'>(</span><a href="parse_relation.c.html#LN830"><span class='Ref_to_Parameter'>alias</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                                  <a href="parse_relation.c.html#LN848"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a><span class='Delimiter'>, 
</span>                                                strlen<span class='Parentheses'>(</span><a href="parse_relation.c.html#LN848"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                                  <span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, 
</span>                                                  <a href="parse_relation.c.html#LN37"><span class='Ref_to_Const'>MAX_FUZZY_DISTANCE</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>, 
</span>                                                  <span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Scan for a matching column; if we find an exact match, we're 
             * done.  Otherwise, update fuzzystate. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/parser/parse_relation.h.html#LN55"><span class='Ref_to_Proto'>scanRTEForColumn</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN833"><span class='Ref_To_Local'>orig_pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN848"><span class='Ref_To_Local'>rte</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN830"><span class='Ref_to_Parameter'>colname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN831"><span class='Ref_to_Parameter'>location</span></a><span class='Delimiter'>, 
</span>                                 <a href="parse_relation.c.html#LN849"><span class='Ref_To_Local'>fuzzy_rte_penalty</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN834"><span class='Ref_To_Local'>fuzzystate</span></a><span class='Parentheses'>) 
</span>                <span class='Operator'>&& </span><a href="parse_relation.c.html#LN849"><span class='Ref_To_Local'>fuzzy_rte_penalty</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Delimiter'>{ 
</span>                <a href="parse_relation.c.html#LN834"><span class='Ref_To_Local'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN29"><span class='Ref_to_Member'>rfirst</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN848"><span class='Ref_To_Local'>rte</span></a><span class='Delimiter'>; 
</span>                <a href="parse_relation.c.html#LN834"><span class='Ref_To_Local'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN30"><span class='Ref_to_Member'>first</span></a> <span class='Operator'>= </span><a href="../../include/access/attnum.h.html#LN22"><span class='Ref_to_Const'>InvalidAttrNumber</span></a><span class='Delimiter'>; 
</span>                <a href="parse_relation.c.html#LN834"><span class='Ref_To_Local'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN31"><span class='Ref_to_Member'>rsecond</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>                <a href="parse_relation.c.html#LN834"><span class='Ref_To_Local'>fuzzystate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN32"><span class='Ref_to_Member'>second</span></a> <span class='Operator'>= </span><a href="../../include/access/attnum.h.html#LN22"><span class='Ref_to_Const'>InvalidAttrNumber</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>return</span> <a href="parse_relation.c.html#LN834"><span class='Ref_To_Local'>fuzzystate</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="parse_relation.c.html#LN830"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN830"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN166"><span class='Ref_to_Member'>parentParseState</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while pstate!=NULL &raquo; </span> 
 
    <span class='Control'>return</span> <a href="parse_relation.c.html#LN834"><span class='Ref_To_Local'>fuzzystate</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end searchRangeTableForCol &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * markRTEForSelectPriv 
 *     Mark the specified column of an RTE as requiring SELECT privilege 
 * 
 * col == InvalidAttrNumber means a "whole row" reference 
 * 
 * The caller should pass the actual RTE if it has it handy; otherwise pass 
 * NULL, and we'll look it up here.  (This uglification of the API is 
 * worthwhile because nearly all external callers have the RTE at hand.) 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN908"></a><span class='Declare_Function'>markRTEForSelectPriv</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rte</span><span class='Delimiter'>, 
</span><a name="LN909"></a>                     <span class='Keyword'>int </span><span class='Declare_Parameter'>rtindex</span><span class='Delimiter'>, </span><a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Declare_Parameter'>col</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN908"><span class='Ref_to_Parameter'>rte</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <a href="parse_relation.c.html#LN908"><span class='Ref_to_Parameter'>rte</span></a> <span class='Operator'>= </span><a href="../../include/parser/parsetree.h.html#LN30"><span class='Ref_to_Macro'>rt_fetch</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN909"><span class='Ref_to_Parameter'>rtindex</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN908"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN908"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN922"><span class='Ref_to_EnumConst'>RTE_RELATION</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Make sure the rel as a whole is marked for SELECT access */ 
</span>        <a href="parse_relation.c.html#LN908"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1027"><span class='Ref_to_Member'>requiredPerms</span></a> <span class='Operator'>|= </span><a href="../../include/nodes/parsenodes.h.html#LN72"><span class='Ref_to_Const'>ACL_SELECT</span></a><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* Must offset the attnum to fit in a bitmapset */ 
</span>        <a href="parse_relation.c.html#LN908"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1029"><span class='Ref_to_Member'>selectedCols</span></a> <span class='Operator'>= </span><a href="../../include/nodes/bitmapset.h.html#LN89"><span class='Ref_to_Proto'>bms_add_member</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN908"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1029"><span class='Ref_to_Member'>selectedCols</span></a><span class='Delimiter'>, 
</span>                                   <a href="parse_relation.c.html#LN909"><span class='Ref_to_Parameter'>col</span></a> <span class='Operator'>- </span><a href="../../include/access/sysattr.h.html#LN27"><span class='Ref_to_Const'>FirstLowInvalidHeapAttributeNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN908"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN924"><span class='Ref_to_EnumConst'>RTE_JOIN</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN909"><span class='Ref_to_Parameter'>col</span></a> <span class='Operator'>== </span><a href="../../include/access/attnum.h.html#LN22"><span class='Ref_to_Const'>InvalidAttrNumber</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * A whole-row reference to a join has to be treated as whole-row 
             * references to the two inputs. 
             */ 
</span><a name="LN930"></a>            <a href="../../include/nodes/primnodes.h.html#LN1444"><span class='Ref_to_Struct'>JoinExpr</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN909"><span class='Ref_to_Parameter'>rtindex</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="parse_relation.c.html#LN909"><span class='Ref_to_Parameter'>rtindex</span></a> <span class='Operator'>&LT;= </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN908"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN169"><span class='Ref_to_Member'>p_joinexprs</span></a><span class='Parentheses'>))</span> 
                <a href="parse_relation.c.html#LN930"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN226"><span class='Ref_to_Macro'>list_nth_node</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN1444"><span class='Ref_to_Struct'>JoinExpr</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN908"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN169"><span class='Ref_to_Member'>p_joinexprs</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN909"><span class='Ref_to_Parameter'>rtindex</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="parse_relation.c.html#LN930"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN930"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"could not find JoinExpr for whole-row reference"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Note: we can't see FromExpr here */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN930"><span class='Ref_To_Local'>j</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1449"><span class='Ref_to_Member'>larg</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN1415"><span class='Ref_to_Struct'>RangeTblRef</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span><a name="LN942"></a>                <span class='Keyword'>int</span>         <span class='Declare_Local'>varno</span> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="../../include/nodes/primnodes.h.html#LN1415"><span class='Ref_to_Struct'>RangeTblRef</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_relation.c.html#LN930"><span class='Ref_To_Local'>j</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1449"><span class='Ref_to_Member'>larg</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>rtindex<span class='Delimiter'>; 
</span> 
                <a href="parse_relation.c.html#LN45"><span class='Ref_to_Proto'>markRTEForSelectPriv</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN908"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN942"><span class='Ref_To_Local'>varno</span></a><span class='Delimiter'>, </span><a href="../../include/access/attnum.h.html#LN22"><span class='Ref_to_Const'>InvalidAttrNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN930"><span class='Ref_To_Local'>j</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1449"><span class='Ref_to_Member'>larg</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN1444"><span class='Ref_to_Struct'>JoinExpr</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span><a name="LN948"></a>                <span class='Keyword'>int</span>         <span class='Declare_Local'>varno</span> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="../../include/nodes/primnodes.h.html#LN1444"><span class='Ref_to_Struct'>JoinExpr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_relation.c.html#LN930"><span class='Ref_To_Local'>j</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1449"><span class='Ref_to_Member'>larg</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>rtindex<span class='Delimiter'>; 
</span> 
                <a href="parse_relation.c.html#LN45"><span class='Ref_to_Proto'>markRTEForSelectPriv</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN908"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN948"><span class='Ref_To_Local'>varno</span></a><span class='Delimiter'>, </span><a href="../../include/access/attnum.h.html#LN22"><span class='Ref_to_Const'>InvalidAttrNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
                <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized node type: %d"</span><span class='Delimiter'>, 
</span>                     <span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="../../include/nodes/nodes.h.html#LN513"><span class='Ref_to_Macro'>nodeTag</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN930"><span class='Ref_To_Local'>j</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1449"><span class='Ref_to_Member'>larg</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN930"><span class='Ref_To_Local'>j</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1450"><span class='Ref_to_Member'>rarg</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN1415"><span class='Ref_to_Struct'>RangeTblRef</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span><a name="LN957"></a>                <span class='Keyword'>int</span>         <span class='Declare_Local'>varno</span> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="../../include/nodes/primnodes.h.html#LN1415"><span class='Ref_to_Struct'>RangeTblRef</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_relation.c.html#LN930"><span class='Ref_To_Local'>j</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1450"><span class='Ref_to_Member'>rarg</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>rtindex<span class='Delimiter'>; 
</span> 
                <a href="parse_relation.c.html#LN45"><span class='Ref_to_Proto'>markRTEForSelectPriv</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN908"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN957"><span class='Ref_To_Local'>varno</span></a><span class='Delimiter'>, </span><a href="../../include/access/attnum.h.html#LN22"><span class='Ref_to_Const'>InvalidAttrNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN930"><span class='Ref_To_Local'>j</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1450"><span class='Ref_to_Member'>rarg</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN1444"><span class='Ref_to_Struct'>JoinExpr</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span><a name="LN963"></a>                <span class='Keyword'>int</span>         <span class='Declare_Local'>varno</span> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="../../include/nodes/primnodes.h.html#LN1444"><span class='Ref_to_Struct'>JoinExpr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_relation.c.html#LN930"><span class='Ref_To_Local'>j</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1450"><span class='Ref_to_Member'>rarg</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>rtindex<span class='Delimiter'>; 
</span> 
                <a href="parse_relation.c.html#LN45"><span class='Ref_to_Proto'>markRTEForSelectPriv</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN908"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN963"><span class='Ref_To_Local'>varno</span></a><span class='Delimiter'>, </span><a href="../../include/access/attnum.h.html#LN22"><span class='Ref_to_Const'>InvalidAttrNumber</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
                <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized node type: %d"</span><span class='Delimiter'>, 
</span>                     <span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="../../include/nodes/nodes.h.html#LN513"><span class='Ref_to_Macro'>nodeTag</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN930"><span class='Ref_To_Local'>j</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1450"><span class='Ref_to_Member'>rarg</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if col==InvalidAttrNumbe... &raquo; </span> 
        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * Regular join attribute, look at the alias-variable list. 
             * 
             * The aliasvar could be either a Var or a COALESCE expression, 
             * but in the latter case we should already have marked the two 
             * referent variables as being selected, due to their use in the 
             * JOIN clause.  So we need only be concerned with the Var case. 
             * But we do need to drill down through implicit coercions. 
             */ 
</span><a name="LN982"></a>            <a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>aliasvar</span><span class='Delimiter'>; 
</span> 
            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN909"><span class='Ref_to_Parameter'>col</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="parse_relation.c.html#LN909"><span class='Ref_to_Parameter'>col</span></a> <span class='Operator'>&LT;= </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN908"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN975"><span class='Ref_to_Member'>joinaliasvars</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="parse_relation.c.html#LN982"><span class='Ref_To_Local'>aliasvar</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN223"><span class='Ref_to_Proto'>list_nth</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN908"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN975"><span class='Ref_to_Member'>joinaliasvars</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN909"><span class='Ref_to_Parameter'>col</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_relation.c.html#LN982"><span class='Ref_To_Local'>aliasvar</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/nodeFuncs.h.html#LN35"><span class='Ref_to_Proto'>strip_implicit_coercions</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_relation.c.html#LN982"><span class='Ref_To_Local'>aliasvar</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN982"><span class='Ref_To_Local'>aliasvar</span></a> <span class='Operator'>&& </span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN982"><span class='Ref_To_Local'>aliasvar</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a><span class='Parentheses'>))</span> 
                <a href="../../include/parser/parse_relation.h.html#LN60"><span class='Ref_to_Proto'>markVarForSelectPriv</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN908"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN982"><span class='Ref_To_Local'>aliasvar</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if rte-&GT;rtekind==RTE_JOI... &raquo; </span> 
    <span class='Comment_Multi_Line'>/* other RTE types don't require privilege marking */ 
</span><span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end markRTEForSelectPriv &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * markVarForSelectPriv 
 *     Mark the RTE referenced by a Var as requiring SELECT privilege 
 * 
 * The caller should pass the Var's referenced RTE if it has it handy 
 * (nearly all do); otherwise pass NULL. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN1002"></a><span class='Declare_Function'>markVarForSelectPriv</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>var</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rte</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1004"></a>    <a href="../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a>       <span class='Declare_Local'>lv</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1002"><span class='Ref_to_Parameter'>var</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* Find the appropriate pstate if it's an uplevel Var */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1004"><span class='Ref_To_Local'>lv</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="parse_relation.c.html#LN1004"><span class='Ref_To_Local'>lv</span></a> <span class='Operator'>&LT; </span><a href="parse_relation.c.html#LN1002"><span class='Ref_to_Parameter'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN172"><span class='Ref_to_Member'>varlevelsup</span></a><span class='Delimiter'>; </span><a href="parse_relation.c.html#LN1004"><span class='Ref_To_Local'>lv</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <a href="parse_relation.c.html#LN1002"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1002"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN166"><span class='Ref_to_Member'>parentParseState</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN45"><span class='Ref_to_Proto'>markRTEForSelectPriv</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1002"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1002"><span class='Ref_to_Parameter'>rte</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1002"><span class='Ref_to_Parameter'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN165"><span class='Ref_to_Member'>varno</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1002"><span class='Ref_to_Parameter'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN167"><span class='Ref_to_Member'>varattno</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * buildRelationAliases 
 *      Construct the eref column name list for a relation RTE. 
 *      This code is also used for function RTEs. 
 * 
 * tupdesc: the physical column information 
 * alias: the user-supplied alias, or NULL if none 
 * eref: the eref Alias to store column names in 
 * 
 * eref-&GT;colnames is filled in.  Also, alias-&GT;colnames is rebuilt to insert 
 * empty strings for any dropped columns, so that it will be one-to-one with 
 * physical column numbers. 
 * 
 * It is an error for there to be more aliases present than required. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN1029"></a><span class='Declare_Function'>buildRelationAliases</span><span class='Parentheses'>(</span><a href="../../include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a> <span class='Declare_Parameter'>tupdesc</span><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN38"><span class='Ref_to_Struct'>Alias</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>alias</span><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN38"><span class='Ref_to_Struct'>Alias</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>eref</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1031"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>maxattrs</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1029"><span class='Ref_to_Parameter'>tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Delimiter'>; 
</span><a name="LN1032"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>aliaslc</span><span class='Delimiter'>; 
</span><a name="LN1033"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>numaliases</span><span class='Delimiter'>; 
</span><a name="LN1034"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>varattno</span><span class='Delimiter'>; 
</span><a name="LN1035"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>numdropped</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1029"><span class='Ref_to_Parameter'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a> <span class='Operator'>== </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1029"><span class='Ref_to_Parameter'>alias</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="parse_relation.c.html#LN1032"><span class='Ref_To_Local'>aliaslc</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN75"><span class='Ref_to_Func'>list_head</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1029"><span class='Ref_to_Parameter'>alias</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN1033"><span class='Ref_To_Local'>numaliases</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1029"><span class='Ref_to_Parameter'>alias</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* We'll rebuild the alias colname list */ 
</span>        <a href="parse_relation.c.html#LN1029"><span class='Ref_to_Parameter'>alias</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="parse_relation.c.html#LN1032"><span class='Ref_To_Local'>aliaslc</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN1033"><span class='Ref_To_Local'>numaliases</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1034"><span class='Ref_To_Local'>varattno</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="parse_relation.c.html#LN1034"><span class='Ref_To_Local'>varattno</span></a> <span class='Operator'>&LT; </span><a href="parse_relation.c.html#LN1031"><span class='Ref_To_Local'>maxattrs</span></a><span class='Delimiter'>; </span><a href="parse_relation.c.html#LN1034"><span class='Ref_To_Local'>varattno</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1054"></a>        <a href="../../include/catalog/pg_attribute.h.html#LN186"><span class='Ref_to_Typedef'>Form_pg_attribute</span></a> <span class='Declare_Local'>attr</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1029"><span class='Ref_to_Parameter'>tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN73"><span class='Ref_to_Member'>attrs</span></a><span class='Delimiter'>[</span><a href="parse_relation.c.html#LN1034"><span class='Ref_To_Local'>varattno</span></a><span class='Delimiter'>]; 
</span><a name="LN1055"></a>        <a href="../../include/nodes/value.h.html#LN41"><span class='Ref_to_Struct'>Value</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>attrname</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1054"><span class='Ref_To_Local'>attr</span></a><span class='Operator'>-&GT;</span>attisdropped<span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Always insert an empty string for a dropped column */ 
</span>            <a href="parse_relation.c.html#LN1055"><span class='Ref_To_Local'>attrname</span></a> <span class='Operator'>= </span><a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><span class='String'>""</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1032"><span class='Ref_To_Local'>aliaslc</span></a><span class='Parentheses'>) 
</span>                <a href="parse_relation.c.html#LN1029"><span class='Ref_to_Parameter'>alias</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1029"><span class='Ref_to_Parameter'>alias</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1055"><span class='Ref_To_Local'>attrname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_relation.c.html#LN1035"><span class='Ref_To_Local'>numdropped</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1032"><span class='Ref_To_Local'>aliaslc</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Use the next user-supplied alias */ 
</span>            <a href="parse_relation.c.html#LN1055"><span class='Ref_To_Local'>attrname</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/value.h.html#LN41"><span class='Ref_to_Struct'>Value</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1032"><span class='Ref_To_Local'>aliaslc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_relation.c.html#LN1032"><span class='Ref_To_Local'>aliaslc</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN104"><span class='Ref_to_Macro'>lnext</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1032"><span class='Ref_To_Local'>aliaslc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_relation.c.html#LN1029"><span class='Ref_to_Parameter'>alias</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1029"><span class='Ref_to_Parameter'>alias</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1055"><span class='Ref_To_Local'>attrname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="parse_relation.c.html#LN1055"><span class='Ref_To_Local'>attrname</span></a> <span class='Operator'>= </span><a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1054"><span class='Ref_To_Local'>attr</span></a><span class='Operator'>-&GT;</span>attname<span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* we're done with the alias if any */ 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="parse_relation.c.html#LN1029"><span class='Ref_to_Parameter'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1029"><span class='Ref_to_Parameter'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1055"><span class='Ref_To_Local'>attrname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for varattno=0;varattno&LT;m... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Too many user-supplied aliases? */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1032"><span class='Ref_To_Local'>aliaslc</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_COLUMN_REFERENCE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"table \"%s\" has %d columns available but %d columns specified"</span><span class='Delimiter'>, 
</span>                        <a href="parse_relation.c.html#LN1029"><span class='Ref_to_Parameter'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1031"><span class='Ref_To_Local'>maxattrs</span></a> <span class='Operator'>- </span><a href="parse_relation.c.html#LN1035"><span class='Ref_To_Local'>numdropped</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1033"><span class='Ref_To_Local'>numaliases</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end buildRelationAliases &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * chooseScalarFunctionAlias 
 *      Select the column alias for a function in a function RTE, 
 *      when the function returns a scalar type (not composite or RECORD). 
 * 
 * funcexpr: transformed expression tree for the function call 
 * funcname: function name (as determined by FigureColname) 
 * alias: the user-supplied alias for the RTE, or NULL if none 
 * nfuncs: the number of functions appearing in the function RTE 
 * 
 * Note that the name we choose might be overridden later, if the user-given 
 * alias includes column alias names.  That's of no concern here. 
 */ 
</span><span class='Keyword'>static char </span><span class='Operator'>* 
</span><a name="LN1103"></a><span class='Declare_Function'>chooseScalarFunctionAlias</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>funcexpr</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>funcname</span><span class='Delimiter'>, 
</span><a name="LN1104"></a>                          <a href="../../include/nodes/primnodes.h.html#LN38"><span class='Ref_to_Struct'>Alias</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>alias</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>nfuncs</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1106"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>pname</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If the expression is a simple function call, and the function has a 
     * single OUT parameter that is named, use the parameter's name. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1103"><span class='Ref_to_Parameter'>funcexpr</span></a> <span class='Operator'>&& </span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1103"><span class='Ref_to_Parameter'>funcexpr</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN444"><span class='Ref_to_Struct'>FuncExpr</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="parse_relation.c.html#LN1106"><span class='Ref_To_Local'>pname</span></a> <span class='Operator'>= </span><a href="../../include/funcapi.h.html#LN179"><span class='Ref_to_Proto'>get_func_result_name</span></a><span class='Parentheses'>(((</span><a href="../../include/nodes/primnodes.h.html#LN444"><span class='Ref_to_Struct'>FuncExpr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_relation.c.html#LN1103"><span class='Ref_to_Parameter'>funcexpr</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>funcid<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1106"><span class='Ref_To_Local'>pname</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <a href="parse_relation.c.html#LN1106"><span class='Ref_To_Local'>pname</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If there's just one function in the RTE, and the user gave an RTE alias 
     * name, use that name.  (This makes FROM func() AS foo use "foo" as the 
     * column name as well as the table alias.) 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1104"><span class='Ref_to_Parameter'>nfuncs</span></a> <span class='Operator'>== </span><span class='Number'>1</span> <span class='Operator'>&& </span><a href="parse_relation.c.html#LN1104"><span class='Ref_to_Parameter'>alias</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="parse_relation.c.html#LN1104"><span class='Ref_to_Parameter'>alias</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Otherwise use the function name. 
     */ 
</span>    <span class='Control'>return</span> <a href="parse_relation.c.html#LN1103"><span class='Ref_to_Parameter'>funcname</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end chooseScalarFunctionAlias &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Open a table during parse analysis 
 * 
 * This is essentially just the same as heap_openrv(), except that it caters 
 * to some parser-specific error reporting needs, notably that it arranges 
 * to include the RangeVar's parse location in any resulting error. 
 * 
 * Note: properly, lockmode should be declared LOCKMODE not int, but that 
 * would require importing storage/lock.h into parse_relation.h.  Since 
 * LOCKMODE is typedef'd as int anyway, that seems like overkill. 
 */ 
</span><a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a> 
<a name="LN1145"></a><span class='Declare_Function'>parserOpenTable</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../../include/nodes/primnodes.h.html#LN62"><span class='Ref_to_Struct'>RangeVar</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>relation</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>lockmode</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1147"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>rel</span><span class='Delimiter'>; 
</span><a name="LN1148"></a>    <a href="../../include/parser/parse_node.h.html#LN249"><span class='Ref_to_Struct'>ParseCallbackState</span></a> <span class='Declare_Local'>pcbstate</span><span class='Delimiter'>; 
</span> 
    <a href="parse_node.c.html#LN143"><span class='Ref_to_Func'>setup_parser_errposition_callback</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="parse_relation.c.html#LN1148"><span class='Ref_To_Local'>pcbstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1145"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1145"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN72"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1147"><span class='Ref_To_Local'>rel</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN93"><span class='Ref_to_Proto'>heap_openrv_extended</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1145"><span class='Ref_to_Parameter'>relation</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1145"><span class='Ref_to_Parameter'>lockmode</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1147"><span class='Ref_To_Local'>rel</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1145"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span><a href="../../bin/scripts/vacuumdb.c.html#LN25"><span class='Ref_to_Const'>ERRCODE_UNDEFINED_TABLE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"relation \"%s.%s\" does not exist"</span><span class='Delimiter'>, 
</span>                            <a href="parse_relation.c.html#LN1145"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1145"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * An unqualified name might be a named ephemeral relation. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../utils/misc/queryenvironment.c.html#LN43"><span class='Ref_to_Func'>get_visible_ENR_metadata</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1145"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN191"><span class='Ref_to_Member'>p_queryEnv</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1145"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>))</span> 
                <a href="parse_relation.c.html#LN1147"><span class='Ref_To_Local'>rel</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * An unqualified name might have been meant as a reference to 
             * some not-yet-in-scope CTE.  The bare "does not exist" message 
             * has proven remarkably unhelpful for figuring out such problems, 
             * so we take pains to offer a specific hint. 
             */ 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN266"><span class='Ref_to_Func'>isFutureCTE</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1145"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1145"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>))</span> 
                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span><a href="../../bin/scripts/vacuumdb.c.html#LN25"><span class='Ref_to_Const'>ERRCODE_UNDEFINED_TABLE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"relation \"%s\" does not exist"</span><span class='Delimiter'>, 
</span>                                <a href="parse_relation.c.html#LN1145"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN871"><span class='Ref_to_Func'>errdetail</span></a><span class='Parentheses'>(</span><span class='String'>"There is a WITH item named \"%s\", but it cannot be referenced from this part of the query."</span><span class='Delimiter'>, 
</span>                                   <a href="parse_relation.c.html#LN1145"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN985"><span class='Ref_to_Func'>errhint</span></a><span class='Parentheses'>(</span><span class='String'>"Use WITH RECURSIVE, or re-order the WITH items to remove forward references."</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span><a href="../../bin/scripts/vacuumdb.c.html#LN25"><span class='Ref_to_Const'>ERRCODE_UNDEFINED_TABLE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"relation \"%s\" does not exist"</span><span class='Delimiter'>, 
</span>                                <a href="parse_relation.c.html#LN1145"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if rel==NULL &raquo; </span> 
    <a href="parse_node.c.html#LN159"><span class='Ref_to_Func'>cancel_parser_errposition_callback</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="parse_relation.c.html#LN1148"><span class='Ref_To_Local'>pcbstate</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="parse_relation.c.html#LN1147"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end parserOpenTable &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Add an entry for a relation to the pstate's range table (p_rtable). 
 * 
 * Note: formerly this checked for refname conflicts, but that's wrong. 
 * Caller is responsible for checking for conflicts in the appropriate scope. 
 */ 
</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>* 
</span><a name="LN1199"></a><span class='Declare_Function'>addRangeTableEntry</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, 
</span><a name="LN1200"></a>                   <a href="../../include/nodes/primnodes.h.html#LN62"><span class='Ref_to_Struct'>RangeVar</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>relation</span><span class='Delimiter'>, 
</span><a name="LN1201"></a>                   <a href="../../include/nodes/primnodes.h.html#LN38"><span class='Ref_to_Struct'>Alias</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>alias</span><span class='Delimiter'>, 
</span><a name="LN1202"></a>                   <span class='Keyword'>bool </span><span class='Declare_Parameter'>inh</span><span class='Delimiter'>, 
</span><a name="LN1203"></a>                   <span class='Keyword'>bool </span><span class='Declare_Parameter'>inFromCl</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1205"></a>    <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1206"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>refname</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1201"><span class='Ref_to_Parameter'>alias</span></a> <span class='Operator'>? </span><a href="parse_relation.c.html#LN1201"><span class='Ref_to_Parameter'>alias</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a> <span class='Operator'>: </span><a href="parse_relation.c.html#LN1200"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Delimiter'>; 
</span><a name="LN1207"></a>    <a href="../../include/storage/lockdefs.h.html#LN25"><span class='Ref_to_Typedef'>LOCKMODE</span></a>    <span class='Declare_Local'>lockmode</span><span class='Delimiter'>; 
</span><a name="LN1208"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>rel</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1199"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1205"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN922"><span class='Ref_to_EnumConst'>RTE_RELATION</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1205"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1022"><span class='Ref_to_Member'>alias</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1201"><span class='Ref_to_Parameter'>alias</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Get the rel's OID.  This access also ensures that we have an up-to-date 
     * relcache entry for the rel.  Since this is typically the first access 
     * to a rel in a statement, be careful to get the right access level 
     * depending on whether we're doing SELECT FOR UPDATE/SHARE. 
     */ 
</span>    <a href="parse_relation.c.html#LN1207"><span class='Ref_To_Local'>lockmode</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_relation.h.html#LN113"><span class='Ref_to_Proto'>isLockedRefname</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1199"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1206"><span class='Ref_To_Local'>refname</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="../../include/storage/lockdefs.h.html#LN36"><span class='Ref_to_Const'>RowShareLock</span></a> <span class='Operator'>: </span><a href="../../include/storage/lockdefs.h.html#LN35"><span class='Ref_to_Const'>AccessShareLock</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1208"><span class='Ref_To_Local'>rel</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_relation.h.html#LN62"><span class='Ref_to_Proto'>parserOpenTable</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1199"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1200"><span class='Ref_to_Parameter'>relation</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1207"><span class='Ref_To_Local'>lockmode</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1205"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN947"><span class='Ref_to_Member'>relid</span></a> <span class='Operator'>= </span><a href="../../include/utils/rel.h.html#LN416"><span class='Ref_to_Macro'>RelationGetRelid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1208"><span class='Ref_To_Local'>rel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1205"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN948"><span class='Ref_to_Member'>relkind</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1208"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relkind<span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Build the list of effective column names using user-supplied aliases 
     * and/or actual column names. 
     */ 
</span>    <a href="parse_relation.c.html#LN1205"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a> <span class='Operator'>= </span><a href="../../include/nodes/makefuncs.h.html#LN63"><span class='Ref_to_Proto'>makeAlias</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1206"><span class='Ref_To_Local'>refname</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1028"><span class='Ref_to_Func'>buildRelationAliases</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1208"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN114"><span class='Ref_to_Member'>rd_att</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1201"><span class='Ref_to_Parameter'>alias</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1205"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Drop the rel refcount, but keep the access lock till end of transaction 
     * so that the table can't be deleted or have its schema modified 
     * underneath us. 
     */ 
</span>    <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1208"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN33"><span class='Ref_to_Const'>NoLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Set flags and access permissions. 
     * 
     * The initial default on access checks is always check-for-READ-access, 
     * which is the right thing for all except target tables. 
     */ 
</span>    <a href="parse_relation.c.html#LN1205"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1024"><span class='Ref_to_Member'>lateral</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1205"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1025"><span class='Ref_to_Member'>inh</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1202"><span class='Ref_to_Parameter'>inh</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1205"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1026"><span class='Ref_to_Member'>inFromCl</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1203"><span class='Ref_to_Parameter'>inFromCl</span></a><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1205"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1027"><span class='Ref_to_Member'>requiredPerms</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN72"><span class='Ref_to_Const'>ACL_SELECT</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1205"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1028"><span class='Ref_to_Member'>checkAsUser</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>;</span>      <span class='Comment_Single_Line'>/* not set-uid by default, either */ 
</span>    <a href="parse_relation.c.html#LN1205"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1029"><span class='Ref_to_Member'>selectedCols</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1205"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1030"><span class='Ref_to_Member'>insertedCols</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1205"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1031"><span class='Ref_to_Member'>updatedCols</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Add completed RTE to pstate's range table list, but not to join list 
     * nor namespace --- caller must do that if appropriate. 
     */ 
</span>    <a href="parse_relation.c.html#LN1199"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1199"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1205"><span class='Ref_To_Local'>rte</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="parse_relation.c.html#LN1205"><span class='Ref_To_Local'>rte</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end addRangeTableEntry &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Add an entry for a relation to the pstate's range table (p_rtable). 
 * 
 * This is just like addRangeTableEntry() except that it makes an RTE 
 * given an already-open relation instead of a RangeVar reference. 
 */ 
</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>* 
</span><a name="LN1272"></a><span class='Declare_Function'>addRangeTableEntryForRelation</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, 
</span><a name="LN1273"></a>                              <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a> <span class='Declare_Parameter'>rel</span><span class='Delimiter'>, 
</span><a name="LN1274"></a>                              <a href="../../include/nodes/primnodes.h.html#LN38"><span class='Ref_to_Struct'>Alias</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>alias</span><span class='Delimiter'>, 
</span><a name="LN1275"></a>                              <span class='Keyword'>bool </span><span class='Declare_Parameter'>inh</span><span class='Delimiter'>, 
</span><a name="LN1276"></a>                              <span class='Keyword'>bool </span><span class='Declare_Parameter'>inFromCl</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1278"></a>    <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1279"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>refname</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1274"><span class='Ref_to_Parameter'>alias</span></a> <span class='Operator'>? </span><a href="parse_relation.c.html#LN1274"><span class='Ref_to_Parameter'>alias</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a> <span class='Operator'>: </span><a href="../../include/utils/rel.h.html#LN436"><span class='Ref_to_Macro'>RelationGetRelationName</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1273"><span class='Ref_to_Parameter'>rel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1272"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1278"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN922"><span class='Ref_to_EnumConst'>RTE_RELATION</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1278"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1022"><span class='Ref_to_Member'>alias</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1274"><span class='Ref_to_Parameter'>alias</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1278"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN947"><span class='Ref_to_Member'>relid</span></a> <span class='Operator'>= </span><a href="../../include/utils/rel.h.html#LN416"><span class='Ref_to_Macro'>RelationGetRelid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1273"><span class='Ref_to_Parameter'>rel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1278"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN948"><span class='Ref_to_Member'>relkind</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1273"><span class='Ref_to_Parameter'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relkind<span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Build the list of effective column names using user-supplied aliases 
     * and/or actual column names. 
     */ 
</span>    <a href="parse_relation.c.html#LN1278"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a> <span class='Operator'>= </span><a href="../../include/nodes/makefuncs.h.html#LN63"><span class='Ref_to_Proto'>makeAlias</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1279"><span class='Ref_To_Local'>refname</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1028"><span class='Ref_to_Func'>buildRelationAliases</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1273"><span class='Ref_to_Parameter'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN114"><span class='Ref_to_Member'>rd_att</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1274"><span class='Ref_to_Parameter'>alias</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1278"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Set flags and access permissions. 
     * 
     * The initial default on access checks is always check-for-READ-access, 
     * which is the right thing for all except target tables. 
     */ 
</span>    <a href="parse_relation.c.html#LN1278"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1024"><span class='Ref_to_Member'>lateral</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1278"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1025"><span class='Ref_to_Member'>inh</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1275"><span class='Ref_to_Parameter'>inh</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1278"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1026"><span class='Ref_to_Member'>inFromCl</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1276"><span class='Ref_to_Parameter'>inFromCl</span></a><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1278"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1027"><span class='Ref_to_Member'>requiredPerms</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN72"><span class='Ref_to_Const'>ACL_SELECT</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1278"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1028"><span class='Ref_to_Member'>checkAsUser</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>;</span>      <span class='Comment_Single_Line'>/* not set-uid by default, either */ 
</span>    <a href="parse_relation.c.html#LN1278"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1029"><span class='Ref_to_Member'>selectedCols</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1278"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1030"><span class='Ref_to_Member'>insertedCols</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1278"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1031"><span class='Ref_to_Member'>updatedCols</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Add completed RTE to pstate's range table list, but not to join list 
     * nor namespace --- caller must do that if appropriate. 
     */ 
</span>    <a href="parse_relation.c.html#LN1272"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1272"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1278"><span class='Ref_To_Local'>rte</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="parse_relation.c.html#LN1278"><span class='Ref_To_Local'>rte</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end addRangeTableEntryForRelation &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Add an entry for a subquery to the pstate's range table (p_rtable). 
 * 
 * This is just like addRangeTableEntry() except that it makes a subquery RTE. 
 * Note that an alias clause *must* be supplied. 
 */ 
</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>* 
</span><a name="LN1327"></a><span class='Declare_Function'>addRangeTableEntryForSubquery</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, 
</span><a name="LN1328"></a>                              <a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>subquery</span><span class='Delimiter'>, 
</span><a name="LN1329"></a>                              <a href="../../include/nodes/primnodes.h.html#LN38"><span class='Ref_to_Struct'>Alias</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>alias</span><span class='Delimiter'>, 
</span><a name="LN1330"></a>                              <span class='Keyword'>bool </span><span class='Declare_Parameter'>lateral</span><span class='Delimiter'>, 
</span><a name="LN1331"></a>                              <span class='Keyword'>bool </span><span class='Declare_Parameter'>inFromCl</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1333"></a>    <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1334"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>refname</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1329"><span class='Ref_to_Parameter'>alias</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a><span class='Delimiter'>; 
</span><a name="LN1335"></a>    <a href="../../include/nodes/primnodes.h.html#LN38"><span class='Ref_to_Struct'>Alias</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>eref</span><span class='Delimiter'>; 
</span><a name="LN1336"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>numaliases</span><span class='Delimiter'>; 
</span><a name="LN1337"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>varattno</span><span class='Delimiter'>; 
</span><a name="LN1338"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>tlistitem</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1327"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1333"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN923"><span class='Ref_to_EnumConst'>RTE_SUBQUERY</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1333"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN947"><span class='Ref_to_Member'>relid</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1333"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN954"><span class='Ref_to_Member'>subquery</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1328"><span class='Ref_to_Parameter'>subquery</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1333"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1022"><span class='Ref_to_Member'>alias</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1329"><span class='Ref_to_Parameter'>alias</span></a><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1335"><span class='Ref_To_Local'>eref</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN618"><span class='Ref_to_Macro'>copyObject</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1329"><span class='Ref_to_Parameter'>alias</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1336"><span class='Ref_To_Local'>numaliases</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1335"><span class='Ref_To_Local'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* fill in any unspecified alias columns */ 
</span>    <a href="parse_relation.c.html#LN1337"><span class='Ref_To_Local'>varattno</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1338"><span class='Ref_To_Local'>tlistitem</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1328"><span class='Ref_to_Parameter'>subquery</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN137"><span class='Ref_to_Member'>targetList</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1354"></a>        <a href="../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>te</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1338"><span class='Ref_To_Local'>tlistitem</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1354"><span class='Ref_To_Local'>te</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1373"><span class='Ref_to_Member'>resjunk</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN1337"><span class='Ref_To_Local'>varattno</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1337"><span class='Ref_To_Local'>varattno</span></a> <span class='Operator'>== </span><a href="parse_relation.c.html#LN1354"><span class='Ref_To_Local'>te</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1367"><span class='Ref_to_Member'>resno</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1337"><span class='Ref_To_Local'>varattno</span></a> <span class='Operator'>&GT; </span><a href="parse_relation.c.html#LN1336"><span class='Ref_To_Local'>numaliases</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN1362"></a>            <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>attrname</span><span class='Delimiter'>; 
</span> 
            <a href="parse_relation.c.html#LN1362"><span class='Ref_To_Local'>attrname</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1354"><span class='Ref_To_Local'>te</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1368"><span class='Ref_to_Member'>resname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_relation.c.html#LN1335"><span class='Ref_To_Local'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1335"><span class='Ref_To_Local'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Delimiter'>, </span><a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1362"><span class='Ref_To_Local'>attrname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1337"><span class='Ref_To_Local'>varattno</span></a> <span class='Operator'>&LT; </span><a href="parse_relation.c.html#LN1336"><span class='Ref_To_Local'>numaliases</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_COLUMN_REFERENCE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"table \"%s\" has %d columns available but %d columns specified"</span><span class='Delimiter'>, 
</span>                        <a href="parse_relation.c.html#LN1334"><span class='Ref_To_Local'>refname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1337"><span class='Ref_To_Local'>varattno</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1336"><span class='Ref_To_Local'>numaliases</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1333"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1335"><span class='Ref_To_Local'>eref</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Set flags and access permissions. 
     * 
     * Subqueries are never checked for access rights. 
     */ 
</span>    <a href="parse_relation.c.html#LN1333"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1024"><span class='Ref_to_Member'>lateral</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1330"><span class='Ref_to_Parameter'>lateral</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1333"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1025"><span class='Ref_to_Member'>inh</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* never true for subqueries */ 
</span>    <a href="parse_relation.c.html#LN1333"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1026"><span class='Ref_to_Member'>inFromCl</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1331"><span class='Ref_to_Parameter'>inFromCl</span></a><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1333"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1027"><span class='Ref_to_Member'>requiredPerms</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1333"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1028"><span class='Ref_to_Member'>checkAsUser</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1333"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1029"><span class='Ref_to_Member'>selectedCols</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1333"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1030"><span class='Ref_to_Member'>insertedCols</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1333"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1031"><span class='Ref_to_Member'>updatedCols</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Add completed RTE to pstate's range table list, but not to join list 
     * nor namespace --- caller must do that if appropriate. 
     */ 
</span>    <a href="parse_relation.c.html#LN1327"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1327"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1333"><span class='Ref_To_Local'>rte</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="parse_relation.c.html#LN1333"><span class='Ref_To_Local'>rte</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end addRangeTableEntryForSubquery &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Add an entry for a function (or functions) to the pstate's range table 
 * (p_rtable). 
 * 
 * This is just like addRangeTableEntry() except that it makes a function RTE. 
 */ 
</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>* 
</span><a name="LN1407"></a><span class='Declare_Function'>addRangeTableEntryForFunction</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, 
</span><a name="LN1408"></a>                              <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>funcnames</span><span class='Delimiter'>, 
</span><a name="LN1409"></a>                              <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>funcexprs</span><span class='Delimiter'>, 
</span><a name="LN1410"></a>                              <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>coldeflists</span><span class='Delimiter'>, 
</span><a name="LN1411"></a>                              <a href="../../include/nodes/parsenodes.h.html#LN553"><span class='Ref_to_Struct'>RangeFunction</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rangefunc</span><span class='Delimiter'>, 
</span><a name="LN1412"></a>                              <span class='Keyword'>bool </span><span class='Declare_Parameter'>lateral</span><span class='Delimiter'>, 
</span><a name="LN1413"></a>                              <span class='Keyword'>bool </span><span class='Declare_Parameter'>inFromCl</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1415"></a>    <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1416"></a>    <a href="../../include/nodes/primnodes.h.html#LN38"><span class='Ref_to_Struct'>Alias</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>alias</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1411"><span class='Ref_to_Parameter'>rangefunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN560"><span class='Ref_to_Member'>alias</span></a><span class='Delimiter'>; 
</span><a name="LN1417"></a>    <a href="../../include/nodes/primnodes.h.html#LN38"><span class='Ref_to_Struct'>Alias</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>eref</span><span class='Delimiter'>; 
</span><a name="LN1418"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>aliasname</span><span class='Delimiter'>; 
</span><a name="LN1419"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>nfuncs</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1409"><span class='Ref_to_Parameter'>funcexprs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1420"></a>    <a href="../../include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>functupdescs</span><span class='Delimiter'>; 
</span><a name="LN1421"></a>    <a href="../../include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a>   <span class='Declare_Local'>tupdesc</span><span class='Delimiter'>; 
</span><a name="LN1422"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc1</span><span class='Delimiter'>, 
</span><a name="LN1423"></a>               <span class='Operator'>*</span><span class='Declare_Local'>lc2</span><span class='Delimiter'>, 
</span><a name="LN1424"></a>               <span class='Operator'>*</span><span class='Declare_Local'>lc3</span><span class='Delimiter'>; 
</span><a name="LN1425"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN1426"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span><a name="LN1427"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>funcno</span><span class='Delimiter'>; 
</span><a name="LN1428"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>natts</span><span class='Delimiter'>, 
</span><a name="LN1429"></a>                <span class='Declare_Local'>totalatts</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1407"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1415"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN925"><span class='Ref_to_EnumConst'>RTE_FUNCTION</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1415"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN947"><span class='Ref_to_Member'>relid</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1415"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN954"><span class='Ref_to_Member'>subquery</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1415"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN985"><span class='Ref_to_Member'>functions</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* we'll fill this list below */ 
</span>    <a href="parse_relation.c.html#LN1415"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN986"><span class='Ref_to_Member'>funcordinality</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1411"><span class='Ref_to_Parameter'>rangefunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN557"><span class='Ref_to_Member'>ordinality</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1415"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1022"><span class='Ref_to_Member'>alias</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1416"><span class='Ref_To_Local'>alias</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Choose the RTE alias name.  We default to using the first function's 
     * name even when there's more than one; which is maybe arguable but beats 
     * using something constant like "table". 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1416"><span class='Ref_To_Local'>alias</span></a><span class='Parentheses'>) 
</span>        <a href="parse_relation.c.html#LN1418"><span class='Ref_To_Local'>aliasname</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1416"><span class='Ref_To_Local'>alias</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="parse_relation.c.html#LN1418"><span class='Ref_To_Local'>aliasname</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1408"><span class='Ref_to_Parameter'>funcnames</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1417"><span class='Ref_To_Local'>eref</span></a> <span class='Operator'>= </span><a href="../../include/nodes/makefuncs.h.html#LN63"><span class='Ref_to_Proto'>makeAlias</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1418"><span class='Ref_To_Local'>aliasname</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1415"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1417"><span class='Ref_To_Local'>eref</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Process each function ... */ 
</span>    <a href="parse_relation.c.html#LN1420"><span class='Ref_To_Local'>functupdescs</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1419"><span class='Ref_To_Local'>nfuncs</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1429"><span class='Ref_To_Local'>totalatts</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1427"><span class='Ref_To_Local'>funcno</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../../include/nodes/pg_list.h.html#LN202"><span class='Ref_to_Macro'>forthree</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1422"><span class='Ref_To_Local'>lc1</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1409"><span class='Ref_to_Parameter'>funcexprs</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1423"><span class='Ref_To_Local'>lc2</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1408"><span class='Ref_to_Parameter'>funcnames</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1424"><span class='Ref_To_Local'>lc3</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1410"><span class='Ref_to_Parameter'>coldeflists</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1460"></a>        <a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>funcexpr</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1422"><span class='Ref_To_Local'>lc1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1461"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>funcname</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1423"><span class='Ref_To_Local'>lc2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1462"></a>        <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>coldeflist</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1424"><span class='Ref_To_Local'>lc3</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1463"></a>        <a href="../../include/nodes/parsenodes.h.html#LN1051"><span class='Ref_to_Struct'>RangeTblFunction</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rtfunc</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN1051"><span class='Ref_to_Struct'>RangeTblFunction</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1464"></a>        <a href="../../include/funcapi.h.html#LN149"><span class='Ref_to_Enum'>TypeFuncClass</span></a> <span class='Declare_Local'>functypclass</span><span class='Delimiter'>; 
</span><a name="LN1465"></a>        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>funcrettype</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Initialize RangeTblFunction node */ 
</span>        <a href="parse_relation.c.html#LN1463"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1055"><span class='Ref_to_Member'>funcexpr</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1460"><span class='Ref_To_Local'>funcexpr</span></a><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN1463"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1058"><span class='Ref_to_Member'>funccolnames</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN1463"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1059"><span class='Ref_to_Member'>funccoltypes</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN1463"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1060"><span class='Ref_to_Member'>funccoltypmods</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN1463"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1061"><span class='Ref_to_Member'>funccolcollations</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN1463"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1063"><span class='Ref_to_Member'>funcparams</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>      <span class='Comment_Single_Line'>/* not set until planning */ 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Now determine if the function returns a simple or composite type. 
         */ 
</span>        <a href="parse_relation.c.html#LN1464"><span class='Ref_To_Local'>functypclass</span></a> <span class='Operator'>= </span><a href="../../include/funcapi.h.html#LN160"><span class='Ref_to_Proto'>get_expr_result_type</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1460"><span class='Ref_To_Local'>funcexpr</span></a><span class='Delimiter'>, 
</span>                                            <span class='Operator'>&</span><a href="parse_relation.c.html#LN1465"><span class='Ref_To_Local'>funcrettype</span></a><span class='Delimiter'>, 
</span>                                            <span class='Operator'>&</span><a href="parse_relation.c.html#LN1421"><span class='Ref_To_Local'>tupdesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * A coldeflist is required if the function returns RECORD and hasn't 
         * got a predetermined record type, and is prohibited otherwise. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1462"><span class='Ref_To_Local'>coldeflist</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1464"><span class='Ref_To_Local'>functypclass</span></a> <span class='Operator'>!= </span><a href="../../include/funcapi.h.html#LN153"><span class='Ref_to_EnumConst'>TYPEFUNC_RECORD</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"a column definition list is only allowed for functions returning \"record\""</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1407"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, 
</span>                                        <a href="../../include/nodes/nodeFuncs.h.html#LN43"><span class='Ref_to_Proto'>exprLocation</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_relation.c.html#LN1462"><span class='Ref_To_Local'>coldeflist</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1464"><span class='Ref_To_Local'>functypclass</span></a> <span class='Operator'>== </span><a href="../../include/funcapi.h.html#LN153"><span class='Ref_to_EnumConst'>TYPEFUNC_RECORD</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"a column definition list is required for functions returning \"record\""</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1407"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/nodeFuncs.h.html#LN43"><span class='Ref_to_Proto'>exprLocation</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1460"><span class='Ref_To_Local'>funcexpr</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1464"><span class='Ref_To_Local'>functypclass</span></a> <span class='Operator'>== </span><a href="../../include/funcapi.h.html#LN152"><span class='Ref_to_EnumConst'>TYPEFUNC_COMPOSITE</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Composite data type, e.g. a table's row type */ 
</span>            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1421"><span class='Ref_To_Local'>tupdesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1464"><span class='Ref_To_Local'>functypclass</span></a> <span class='Operator'>== </span><a href="../../include/funcapi.h.html#LN151"><span class='Ref_to_EnumConst'>TYPEFUNC_SCALAR</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Base data type, i.e. scalar */ 
</span>            <a href="parse_relation.c.html#LN1421"><span class='Ref_To_Local'>tupdesc</span></a> <span class='Operator'>= </span><a href="../access/common/tupdesc.c.html#LN39"><span class='Ref_to_Func'>CreateTemplateTupleDesc</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../include/access/tupdesc.h.html#LN114"><span class='Ref_to_Proto'>TupleDescInitEntry</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1421"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, 
</span>                               <span class='Parentheses'>(</span><a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Number'>1</span><span class='Delimiter'>, 
</span>                               <a href="parse_relation.c.html#LN1102"><span class='Ref_to_Func'>chooseScalarFunctionAlias</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1460"><span class='Ref_To_Local'>funcexpr</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1461"><span class='Ref_To_Local'>funcname</span></a><span class='Delimiter'>, 
</span>                                                         <a href="parse_relation.c.html#LN1416"><span class='Ref_To_Local'>alias</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1419"><span class='Ref_To_Local'>nfuncs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                               <a href="parse_relation.c.html#LN1465"><span class='Ref_To_Local'>funcrettype</span></a><span class='Delimiter'>, 
</span>                               <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, 
</span>                               <span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1464"><span class='Ref_To_Local'>functypclass</span></a> <span class='Operator'>== </span><a href="../../include/funcapi.h.html#LN153"><span class='Ref_to_EnumConst'>TYPEFUNC_RECORD</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN1523"></a>            <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>col</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Use the column definition list to construct a tupdesc and fill 
             * in the RangeTblFunction's lists. 
             */ 
</span>            <a href="parse_relation.c.html#LN1421"><span class='Ref_To_Local'>tupdesc</span></a> <span class='Operator'>= </span><a href="../access/common/tupdesc.c.html#LN39"><span class='Ref_to_Func'>CreateTemplateTupleDesc</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1462"><span class='Ref_To_Local'>coldeflist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_relation.c.html#LN1425"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1523"><span class='Ref_To_Local'>col</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1462"><span class='Ref_To_Local'>coldeflist</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN1533"></a>                <a href="../../include/nodes/parsenodes.h.html#LN636"><span class='Ref_to_Struct'>ColumnDef</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>n</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN636"><span class='Ref_to_Struct'>ColumnDef</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1523"><span class='Ref_To_Local'>col</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1534"></a>                <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>attrname</span><span class='Delimiter'>; 
</span><a name="LN1535"></a>                <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>attrtype</span><span class='Delimiter'>; 
</span><a name="LN1536"></a>                <a href="../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>attrtypmod</span><span class='Delimiter'>; 
</span><a name="LN1537"></a>                <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>attrcollation</span><span class='Delimiter'>; 
</span> 
                <a href="parse_relation.c.html#LN1534"><span class='Ref_To_Local'>attrname</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1533"><span class='Ref_To_Local'>n</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN639"><span class='Ref_to_Member'>colname</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1533"><span class='Ref_To_Local'>n</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN640"><span class='Ref_to_Member'>typeName</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN210"><span class='Ref_to_Member'>setof</span></a><span class='Parentheses'>) 
</span>                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_TABLE_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"column \"%s\" cannot be declared SETOF"</span><span class='Delimiter'>, 
</span>                                    <a href="parse_relation.c.html#LN1534"><span class='Ref_To_Local'>attrname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1407"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1533"><span class='Ref_To_Local'>n</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN654"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <a href="../../include/parser/parse_type.h.html#LN28"><span class='Ref_to_Proto'>typenameTypeIdAndMod</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1407"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1533"><span class='Ref_To_Local'>n</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN640"><span class='Ref_to_Member'>typeName</span></a><span class='Delimiter'>, 
</span>                                     <span class='Operator'>&</span><a href="parse_relation.c.html#LN1535"><span class='Ref_To_Local'>attrtype</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="parse_relation.c.html#LN1536"><span class='Ref_To_Local'>attrtypmod</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="parse_relation.c.html#LN1537"><span class='Ref_To_Local'>attrcollation</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_type.h.html#LN35"><span class='Ref_to_Proto'>GetColumnDefCollation</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1407"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1533"><span class='Ref_To_Local'>n</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1535"><span class='Ref_To_Local'>attrtype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="../../include/access/tupdesc.h.html#LN114"><span class='Ref_to_Proto'>TupleDescInitEntry</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1421"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, 
</span>                                   <span class='Parentheses'>(</span><a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><a href="parse_relation.c.html#LN1425"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>, 
</span>                                   <a href="parse_relation.c.html#LN1534"><span class='Ref_To_Local'>attrname</span></a><span class='Delimiter'>, 
</span>                                   <a href="parse_relation.c.html#LN1535"><span class='Ref_To_Local'>attrtype</span></a><span class='Delimiter'>, 
</span>                                   <a href="parse_relation.c.html#LN1536"><span class='Ref_To_Local'>attrtypmod</span></a><span class='Delimiter'>, 
</span>                                   <span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="../../include/access/tupdesc.h.html#LN128"><span class='Ref_to_Proto'>TupleDescInitEntryCollation</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1421"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, 
</span>                                            <span class='Parentheses'>(</span><a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><a href="parse_relation.c.html#LN1425"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>, 
</span>                                            <a href="parse_relation.c.html#LN1537"><span class='Ref_To_Local'>attrcollation</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="parse_relation.c.html#LN1463"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1058"><span class='Ref_to_Member'>funccolnames</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1463"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1058"><span class='Ref_to_Member'>funccolnames</span></a><span class='Delimiter'>, 
</span>                                               <a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1534"><span class='Ref_To_Local'>attrname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <a href="parse_relation.c.html#LN1463"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1059"><span class='Ref_to_Member'>funccoltypes</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN162"><span class='Ref_to_Func'>lappend_oid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1463"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1059"><span class='Ref_to_Member'>funccoltypes</span></a><span class='Delimiter'>, 
</span>                                                   <a href="parse_relation.c.html#LN1535"><span class='Ref_To_Local'>attrtype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="parse_relation.c.html#LN1463"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1060"><span class='Ref_to_Member'>funccoltypmods</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN144"><span class='Ref_to_Func'>lappend_int</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1463"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1060"><span class='Ref_to_Member'>funccoltypmods</span></a><span class='Delimiter'>, 
</span>                                                     <a href="parse_relation.c.html#LN1536"><span class='Ref_To_Local'>attrtypmod</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="parse_relation.c.html#LN1463"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1061"><span class='Ref_to_Member'>funccolcollations</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN162"><span class='Ref_to_Func'>lappend_oid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1463"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1061"><span class='Ref_to_Member'>funccolcollations</span></a><span class='Delimiter'>, 
</span>                                                        <a href="parse_relation.c.html#LN1537"><span class='Ref_To_Local'>attrcollation</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <a href="parse_relation.c.html#LN1425"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Ensure that the coldeflist defines a legal set of names (no 
             * duplicates) and datatypes (no pseudo-types, for instance). 
             */ 
</span>            <a href="../../include/catalog/heap.h.html#LN128"><span class='Ref_to_Proto'>CheckAttributeNamesTypes</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1421"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/pg_class.h.html#LN165"><span class='Ref_to_Const'>RELKIND_COMPOSITE_TYPE</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if functypclass==TYPEFUN... &raquo; </span> 
        <span class='Control'>else</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATATYPE_MISMATCH<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"function \"%s\" in FROM has unsupported return type %s"</span><span class='Delimiter'>, 
</span>                    <a href="parse_relation.c.html#LN1461"><span class='Ref_To_Local'>funcname</span></a><span class='Delimiter'>, </span><a href="../utils/adt/format_type.c.html#LN92"><span class='Ref_to_Func'>format_type_be</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1465"><span class='Ref_To_Local'>funcrettype</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, 
</span>                     <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1407"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/nodeFuncs.h.html#LN43"><span class='Ref_to_Proto'>exprLocation</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1460"><span class='Ref_To_Local'>funcexpr</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Finish off the RangeTblFunction and add it to the RTE's list */ 
</span>        <a href="parse_relation.c.html#LN1463"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1056"><span class='Ref_to_Member'>funccolcount</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1421"><span class='Ref_To_Local'>tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN1415"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN985"><span class='Ref_to_Member'>functions</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1415"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN985"><span class='Ref_to_Member'>functions</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1463"><span class='Ref_To_Local'>rtfunc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Save the tupdesc for use below */ 
</span>        <a href="parse_relation.c.html#LN1420"><span class='Ref_To_Local'>functupdescs</span></a><span class='Delimiter'>[</span><a href="parse_relation.c.html#LN1427"><span class='Ref_To_Local'>funcno</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="parse_relation.c.html#LN1421"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN1429"><span class='Ref_To_Local'>totalatts</span></a> <span class='Operator'>+= </span><a href="parse_relation.c.html#LN1421"><span class='Ref_To_Local'>tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN1427"><span class='Ref_To_Local'>funcno</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If there's more than one function, or we want an ordinality column, we 
     * have to produce a merged tupdesc. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1419"><span class='Ref_To_Local'>nfuncs</span></a> <span class='Operator'>&GT; </span><span class='Number'>1</span> <span class='Operator'>|| </span><a href="parse_relation.c.html#LN1411"><span class='Ref_to_Parameter'>rangefunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN557"><span class='Ref_to_Member'>ordinality</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1411"><span class='Ref_to_Parameter'>rangefunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN557"><span class='Ref_to_Member'>ordinality</span></a><span class='Parentheses'>) 
</span>            <a href="parse_relation.c.html#LN1429"><span class='Ref_To_Local'>totalatts</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Merge the tuple descs of each function into a composite one */ 
</span>        <a href="parse_relation.c.html#LN1421"><span class='Ref_To_Local'>tupdesc</span></a> <span class='Operator'>= </span><a href="../access/common/tupdesc.c.html#LN39"><span class='Ref_to_Func'>CreateTemplateTupleDesc</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1429"><span class='Ref_To_Local'>totalatts</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN1428"><span class='Ref_To_Local'>natts</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1425"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="parse_relation.c.html#LN1425"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="parse_relation.c.html#LN1419"><span class='Ref_To_Local'>nfuncs</span></a><span class='Delimiter'>; </span><a href="parse_relation.c.html#LN1425"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1426"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; </span><a href="parse_relation.c.html#LN1426"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT;= </span><a href="parse_relation.c.html#LN1420"><span class='Ref_To_Local'>functupdescs</span></a><span class='Delimiter'>[</span><a href="parse_relation.c.html#LN1425"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Delimiter'>; </span><a href="parse_relation.c.html#LN1426"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>                <a href="../../include/access/tupdesc.h.html#LN92"><span class='Ref_to_Proto'>TupleDescCopyEntry</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1421"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, </span><span class='Operator'>++</span><a href="parse_relation.c.html#LN1428"><span class='Ref_To_Local'>natts</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1420"><span class='Ref_To_Local'>functupdescs</span></a><span class='Delimiter'>[</span><a href="parse_relation.c.html#LN1425"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>], </span><a href="parse_relation.c.html#LN1426"><span class='Ref_To_Local'>j</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* Add the ordinality column if needed */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1411"><span class='Ref_to_Parameter'>rangefunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN557"><span class='Ref_to_Member'>ordinality</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/access/tupdesc.h.html#LN114"><span class='Ref_to_Proto'>TupleDescInitEntry</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1421"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, 
</span>                               <span class='Parentheses'>(</span><a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Operator'>++</span><a href="parse_relation.c.html#LN1428"><span class='Ref_To_Local'>natts</span></a><span class='Delimiter'>, 
</span>                               <span class='String'>"ordinality"</span><span class='Delimiter'>, 
</span>                               <a href="../../interfaces/ecpg/ecpglib/pg_type.h.html#LN21"><span class='Ref_to_Const'>INT8OID</span></a><span class='Delimiter'>, 
</span>                               <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, 
</span>                               <span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1428"><span class='Ref_To_Local'>natts</span></a> <span class='Operator'>== </span><a href="parse_relation.c.html#LN1429"><span class='Ref_To_Local'>totalatts</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if nfuncs&GT;1||rangefunc-&GT;... &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* We can just use the single function's tupdesc as-is */ 
</span>        <a href="parse_relation.c.html#LN1421"><span class='Ref_To_Local'>tupdesc</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1420"><span class='Ref_To_Local'>functupdescs</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Use the tupdesc while assigning column aliases for the RTE */ 
</span>    <a href="parse_relation.c.html#LN1028"><span class='Ref_to_Func'>buildRelationAliases</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1421"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1416"><span class='Ref_To_Local'>alias</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1417"><span class='Ref_To_Local'>eref</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Set flags and access permissions. 
     * 
     * Functions are never checked for access rights (at least, not by the RTE 
     * permissions mechanism). 
     */ 
</span>    <a href="parse_relation.c.html#LN1415"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1024"><span class='Ref_to_Member'>lateral</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1412"><span class='Ref_to_Parameter'>lateral</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1415"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1025"><span class='Ref_to_Member'>inh</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* never true for functions */ 
</span>    <a href="parse_relation.c.html#LN1415"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1026"><span class='Ref_to_Member'>inFromCl</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1413"><span class='Ref_to_Parameter'>inFromCl</span></a><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1415"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1027"><span class='Ref_to_Member'>requiredPerms</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1415"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1028"><span class='Ref_to_Member'>checkAsUser</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1415"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1029"><span class='Ref_to_Member'>selectedCols</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1415"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1030"><span class='Ref_to_Member'>insertedCols</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1415"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1031"><span class='Ref_to_Member'>updatedCols</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Add completed RTE to pstate's range table list, but not to join list 
     * nor namespace --- caller must do that if appropriate. 
     */ 
</span>    <a href="parse_relation.c.html#LN1407"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1407"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1415"><span class='Ref_To_Local'>rte</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="parse_relation.c.html#LN1415"><span class='Ref_To_Local'>rte</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end addRangeTableEntryForFunction &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Add an entry for a table function to the pstate's range table (p_rtable). 
 * 
 * This is much like addRangeTableEntry() except that it makes a tablefunc RTE. 
 */ 
</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>* 
</span><a name="LN1662"></a><span class='Declare_Function'>addRangeTableEntryForTableFunc</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, 
</span><a name="LN1663"></a>                               <a href="../../include/nodes/primnodes.h.html#LN78"><span class='Ref_to_Struct'>TableFunc</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tf</span><span class='Delimiter'>, 
</span><a name="LN1664"></a>                               <a href="../../include/nodes/primnodes.h.html#LN38"><span class='Ref_to_Struct'>Alias</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>alias</span><span class='Delimiter'>, 
</span><a name="LN1665"></a>                               <span class='Keyword'>bool </span><span class='Declare_Parameter'>lateral</span><span class='Delimiter'>, 
</span><a name="LN1666"></a>                               <span class='Keyword'>bool </span><span class='Declare_Parameter'>inFromCl</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1668"></a>    <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1669"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>refname</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1664"><span class='Ref_to_Parameter'>alias</span></a> <span class='Operator'>? </span><a href="parse_relation.c.html#LN1664"><span class='Ref_to_Parameter'>alias</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a> <span class='Operator'>: </span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><span class='String'>"xmltable"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1670"></a>    <a href="../../include/nodes/primnodes.h.html#LN38"><span class='Ref_to_Struct'>Alias</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>eref</span><span class='Delimiter'>; 
</span><a name="LN1671"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>numaliases</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1662"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1668"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN926"><span class='Ref_to_EnumConst'>RTE_TABLEFUNC</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1668"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN947"><span class='Ref_to_Member'>relid</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1668"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN954"><span class='Ref_to_Member'>subquery</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1668"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN991"><span class='Ref_to_Member'>tablefunc</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1663"><span class='Ref_to_Parameter'>tf</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1668"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1012"><span class='Ref_to_Member'>coltypes</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1663"><span class='Ref_to_Parameter'>tf</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN86"><span class='Ref_to_Member'>coltypes</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1668"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1013"><span class='Ref_to_Member'>coltypmods</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1663"><span class='Ref_to_Parameter'>tf</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN87"><span class='Ref_to_Member'>coltypmods</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1668"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1014"><span class='Ref_to_Member'>colcollations</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1663"><span class='Ref_to_Parameter'>tf</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN88"><span class='Ref_to_Member'>colcollations</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1668"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1022"><span class='Ref_to_Member'>alias</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1664"><span class='Ref_to_Parameter'>alias</span></a><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1670"><span class='Ref_To_Local'>eref</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1664"><span class='Ref_to_Parameter'>alias</span></a> <span class='Operator'>? </span><a href="../../include/nodes/nodes.h.html#LN618"><span class='Ref_to_Macro'>copyObject</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1664"><span class='Ref_to_Parameter'>alias</span></a><span class='Parentheses'>) </span><span class='Operator'>: </span><a href="../../include/nodes/makefuncs.h.html#LN63"><span class='Ref_to_Proto'>makeAlias</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1669"><span class='Ref_To_Local'>refname</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1671"><span class='Ref_To_Local'>numaliases</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1670"><span class='Ref_To_Local'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* fill in any unspecified alias columns */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1671"><span class='Ref_To_Local'>numaliases</span></a> <span class='Operator'>&LT; </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1663"><span class='Ref_to_Parameter'>tf</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN85"><span class='Ref_to_Member'>colnames</span></a><span class='Parentheses'>))</span> 
        <a href="parse_relation.c.html#LN1670"><span class='Ref_To_Local'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN219"><span class='Ref_to_Proto'>list_concat</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1670"><span class='Ref_To_Local'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Delimiter'>, 
</span>                                   <a href="../../include/nodes/pg_list.h.html#LN269"><span class='Ref_to_Proto'>list_copy_tail</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1663"><span class='Ref_to_Parameter'>tf</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN85"><span class='Ref_to_Member'>colnames</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1671"><span class='Ref_To_Local'>numaliases</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1668"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1670"><span class='Ref_To_Local'>eref</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Set flags and access permissions. 
     * 
     * Tablefuncs are never checked for access rights (at least, not by the 
     * RTE permissions mechanism). 
     */ 
</span>    <a href="parse_relation.c.html#LN1668"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1024"><span class='Ref_to_Member'>lateral</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1665"><span class='Ref_to_Parameter'>lateral</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1668"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1025"><span class='Ref_to_Member'>inh</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* never true for tablefunc RTEs */ 
</span>    <a href="parse_relation.c.html#LN1668"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1026"><span class='Ref_to_Member'>inFromCl</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1666"><span class='Ref_to_Parameter'>inFromCl</span></a><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1668"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1027"><span class='Ref_to_Member'>requiredPerms</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1668"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1028"><span class='Ref_to_Member'>checkAsUser</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1668"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1029"><span class='Ref_to_Member'>selectedCols</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1668"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1030"><span class='Ref_to_Member'>insertedCols</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1668"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1031"><span class='Ref_to_Member'>updatedCols</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Add completed RTE to pstate's range table list, but not to join list 
     * nor namespace --- caller must do that if appropriate. 
     */ 
</span>    <a href="parse_relation.c.html#LN1662"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1662"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1668"><span class='Ref_To_Local'>rte</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="parse_relation.c.html#LN1668"><span class='Ref_To_Local'>rte</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end addRangeTableEntryForTableFunc &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Add an entry for a VALUES list to the pstate's range table (p_rtable). 
 * 
 * This is much like addRangeTableEntry() except that it makes a values RTE. 
 */ 
</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>* 
</span><a name="LN1725"></a><span class='Declare_Function'>addRangeTableEntryForValues</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, 
</span><a name="LN1726"></a>                            <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>exprs</span><span class='Delimiter'>, 
</span><a name="LN1727"></a>                            <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>coltypes</span><span class='Delimiter'>, 
</span><a name="LN1728"></a>                            <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>coltypmods</span><span class='Delimiter'>, 
</span><a name="LN1729"></a>                            <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>colcollations</span><span class='Delimiter'>, 
</span><a name="LN1730"></a>                            <a href="../../include/nodes/primnodes.h.html#LN38"><span class='Ref_to_Struct'>Alias</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>alias</span><span class='Delimiter'>, 
</span><a name="LN1731"></a>                            <span class='Keyword'>bool </span><span class='Declare_Parameter'>lateral</span><span class='Delimiter'>, 
</span><a name="LN1732"></a>                            <span class='Keyword'>bool </span><span class='Declare_Parameter'>inFromCl</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1734"></a>    <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1735"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>refname</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1730"><span class='Ref_to_Parameter'>alias</span></a> <span class='Operator'>? </span><a href="parse_relation.c.html#LN1730"><span class='Ref_to_Parameter'>alias</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a> <span class='Operator'>: </span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><span class='String'>"*VALUES*"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1736"></a>    <a href="../../include/nodes/primnodes.h.html#LN38"><span class='Ref_to_Struct'>Alias</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>eref</span><span class='Delimiter'>; 
</span><a name="LN1737"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>numaliases</span><span class='Delimiter'>; 
</span><a name="LN1738"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>numcolumns</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1725"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1734"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN927"><span class='Ref_to_EnumConst'>RTE_VALUES</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1734"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN947"><span class='Ref_to_Member'>relid</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1734"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN954"><span class='Ref_to_Member'>subquery</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1734"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN996"><span class='Ref_to_Member'>values_lists</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1726"><span class='Ref_to_Parameter'>exprs</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1734"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1012"><span class='Ref_to_Member'>coltypes</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1727"><span class='Ref_to_Parameter'>coltypes</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1734"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1013"><span class='Ref_to_Member'>coltypmods</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1728"><span class='Ref_to_Parameter'>coltypmods</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1734"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1014"><span class='Ref_to_Member'>colcollations</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1729"><span class='Ref_to_Parameter'>colcollations</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1734"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1022"><span class='Ref_to_Member'>alias</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1730"><span class='Ref_to_Parameter'>alias</span></a><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1736"><span class='Ref_To_Local'>eref</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1730"><span class='Ref_to_Parameter'>alias</span></a> <span class='Operator'>? </span><a href="../../include/nodes/nodes.h.html#LN618"><span class='Ref_to_Macro'>copyObject</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1730"><span class='Ref_to_Parameter'>alias</span></a><span class='Parentheses'>) </span><span class='Operator'>: </span><a href="../../include/nodes/makefuncs.h.html#LN63"><span class='Ref_to_Proto'>makeAlias</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1735"><span class='Ref_To_Local'>refname</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* fill in any unspecified alias columns */ 
</span>    <a href="parse_relation.c.html#LN1738"><span class='Ref_To_Local'>numcolumns</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1726"><span class='Ref_to_Parameter'>exprs</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1737"><span class='Ref_To_Local'>numaliases</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1736"><span class='Ref_To_Local'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1737"><span class='Ref_To_Local'>numaliases</span></a> <span class='Operator'>&LT; </span><a href="parse_relation.c.html#LN1738"><span class='Ref_To_Local'>numcolumns</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1758"></a>        <span class='Keyword'>char</span>        <span class='Declare_Local'>attrname</span><span class='Delimiter'>[</span><span class='Number'>64</span><span class='Delimiter'>]; 
</span> 
        <a href="parse_relation.c.html#LN1737"><span class='Ref_To_Local'>numaliases</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <a href="../../pl/plperl/plperl.h.html#LN60"><span class='Ref_to_Macro'>snprintf</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1758"><span class='Ref_To_Local'>attrname</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1758"><span class='Ref_To_Local'>attrname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='String'>"column%d"</span><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1737"><span class='Ref_To_Local'>numaliases</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN1736"><span class='Ref_To_Local'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1736"><span class='Ref_To_Local'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Delimiter'>, 
</span>                                 <a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1758"><span class='Ref_To_Local'>attrname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1738"><span class='Ref_To_Local'>numcolumns</span></a> <span class='Operator'>&LT; </span><a href="parse_relation.c.html#LN1737"><span class='Ref_To_Local'>numaliases</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_COLUMN_REFERENCE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"VALUES lists \"%s\" have %d columns available but %d columns specified"</span><span class='Delimiter'>, 
</span>                        <a href="parse_relation.c.html#LN1735"><span class='Ref_To_Local'>refname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1738"><span class='Ref_To_Local'>numcolumns</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1737"><span class='Ref_To_Local'>numaliases</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1734"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1736"><span class='Ref_To_Local'>eref</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Set flags and access permissions. 
     * 
     * Subqueries are never checked for access rights. 
     */ 
</span>    <a href="parse_relation.c.html#LN1734"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1024"><span class='Ref_to_Member'>lateral</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1731"><span class='Ref_to_Parameter'>lateral</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1734"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1025"><span class='Ref_to_Member'>inh</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* never true for values RTEs */ 
</span>    <a href="parse_relation.c.html#LN1734"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1026"><span class='Ref_to_Member'>inFromCl</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1732"><span class='Ref_to_Parameter'>inFromCl</span></a><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1734"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1027"><span class='Ref_to_Member'>requiredPerms</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1734"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1028"><span class='Ref_to_Member'>checkAsUser</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1734"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1029"><span class='Ref_to_Member'>selectedCols</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1734"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1030"><span class='Ref_to_Member'>insertedCols</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1734"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1031"><span class='Ref_to_Member'>updatedCols</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Add completed RTE to pstate's range table list, but not to join list 
     * nor namespace --- caller must do that if appropriate. 
     */ 
</span>    <a href="parse_relation.c.html#LN1725"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1725"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1734"><span class='Ref_To_Local'>rte</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="parse_relation.c.html#LN1734"><span class='Ref_To_Local'>rte</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end addRangeTableEntryForValues &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Add an entry for a join to the pstate's range table (p_rtable). 
 * 
 * This is much like addRangeTableEntry() except that it makes a join RTE. 
 */ 
</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>* 
</span><a name="LN1803"></a><span class='Declare_Function'>addRangeTableEntryForJoin</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, 
</span><a name="LN1804"></a>                          <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>colnames</span><span class='Delimiter'>, 
</span><a name="LN1805"></a>                          <a href="../../include/nodes/nodes.h.html#LN671"><span class='Ref_to_Enum'>JoinType</span></a> <span class='Declare_Parameter'>jointype</span><span class='Delimiter'>, 
</span><a name="LN1806"></a>                          <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>aliasvars</span><span class='Delimiter'>, 
</span><a name="LN1807"></a>                          <a href="../../include/nodes/primnodes.h.html#LN38"><span class='Ref_to_Struct'>Alias</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>alias</span><span class='Delimiter'>, 
</span><a name="LN1808"></a>                          <span class='Keyword'>bool </span><span class='Declare_Parameter'>inFromCl</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1810"></a>    <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1811"></a>    <a href="../../include/nodes/primnodes.h.html#LN38"><span class='Ref_to_Struct'>Alias</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>eref</span><span class='Delimiter'>; 
</span><a name="LN1812"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>numaliases</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1803"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Fail if join has too many columns --- we must be able to reference any 
     * of the columns with an AttrNumber. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1806"><span class='Ref_to_Parameter'>aliasvars</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><a href="../../include/access/attnum.h.html#LN23"><span class='Ref_to_Const'>MaxAttrNumber</span></a><span class='Parentheses'>)</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_PROGRAM_LIMIT_EXCEEDED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"joins can have at most %d columns"</span><span class='Delimiter'>, 
</span>                        <a href="../../include/access/attnum.h.html#LN23"><span class='Ref_to_Const'>MaxAttrNumber</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1810"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN924"><span class='Ref_to_EnumConst'>RTE_JOIN</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1810"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN947"><span class='Ref_to_Member'>relid</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1810"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN954"><span class='Ref_to_Member'>subquery</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1810"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN974"><span class='Ref_to_Member'>jointype</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1805"><span class='Ref_to_Parameter'>jointype</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1810"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN975"><span class='Ref_to_Member'>joinaliasvars</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1806"><span class='Ref_to_Parameter'>aliasvars</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1810"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1022"><span class='Ref_to_Member'>alias</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1807"><span class='Ref_to_Parameter'>alias</span></a><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1811"><span class='Ref_To_Local'>eref</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1807"><span class='Ref_to_Parameter'>alias</span></a> <span class='Operator'>? </span><a href="../../include/nodes/nodes.h.html#LN618"><span class='Ref_to_Macro'>copyObject</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1807"><span class='Ref_to_Parameter'>alias</span></a><span class='Parentheses'>) </span><span class='Operator'>: </span><a href="../../include/nodes/makefuncs.h.html#LN63"><span class='Ref_to_Proto'>makeAlias</span></a><span class='Parentheses'>(</span><span class='String'>"unnamed_join"</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1812"><span class='Ref_To_Local'>numaliases</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1811"><span class='Ref_To_Local'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* fill in any unspecified alias columns */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1812"><span class='Ref_To_Local'>numaliases</span></a> <span class='Operator'>&LT; </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1804"><span class='Ref_to_Parameter'>colnames</span></a><span class='Parentheses'>))</span> 
        <a href="parse_relation.c.html#LN1811"><span class='Ref_To_Local'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN219"><span class='Ref_to_Proto'>list_concat</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1811"><span class='Ref_To_Local'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Delimiter'>, 
</span>                                     <a href="../../include/nodes/pg_list.h.html#LN269"><span class='Ref_to_Proto'>list_copy_tail</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1804"><span class='Ref_to_Parameter'>colnames</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1812"><span class='Ref_To_Local'>numaliases</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1810"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1811"><span class='Ref_To_Local'>eref</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Set flags and access permissions. 
     * 
     * Joins are never checked for access rights. 
     */ 
</span>    <a href="parse_relation.c.html#LN1810"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1024"><span class='Ref_to_Member'>lateral</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1810"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1025"><span class='Ref_to_Member'>inh</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* never true for joins */ 
</span>    <a href="parse_relation.c.html#LN1810"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1026"><span class='Ref_to_Member'>inFromCl</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1808"><span class='Ref_to_Parameter'>inFromCl</span></a><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1810"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1027"><span class='Ref_to_Member'>requiredPerms</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1810"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1028"><span class='Ref_to_Member'>checkAsUser</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1810"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1029"><span class='Ref_to_Member'>selectedCols</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1810"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1030"><span class='Ref_to_Member'>insertedCols</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1810"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1031"><span class='Ref_to_Member'>updatedCols</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Add completed RTE to pstate's range table list, but not to join list 
     * nor namespace --- caller must do that if appropriate. 
     */ 
</span>    <a href="parse_relation.c.html#LN1803"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1803"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1810"><span class='Ref_To_Local'>rte</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="parse_relation.c.html#LN1810"><span class='Ref_To_Local'>rte</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end addRangeTableEntryForJoin &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Add an entry for a CTE reference to the pstate's range table (p_rtable). 
 * 
 * This is much like addRangeTableEntry() except that it makes a CTE RTE. 
 */ 
</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>* 
</span><a name="LN1873"></a><span class='Declare_Function'>addRangeTableEntryForCTE</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, 
</span><a name="LN1874"></a>                         <a href="../../include/nodes/parsenodes.h.html#LN1339"><span class='Ref_to_Struct'>CommonTableExpr</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cte</span><span class='Delimiter'>, 
</span><a name="LN1875"></a>                         <a href="../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>levelsup</span><span class='Delimiter'>, 
</span><a name="LN1876"></a>                         <a href="../../include/nodes/primnodes.h.html#LN62"><span class='Ref_to_Struct'>RangeVar</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rv</span><span class='Delimiter'>, 
</span><a name="LN1877"></a>                         <span class='Keyword'>bool </span><span class='Declare_Parameter'>inFromCl</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1879"></a>    <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1880"></a>    <a href="../../include/nodes/primnodes.h.html#LN38"><span class='Ref_to_Struct'>Alias</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>alias</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1876"><span class='Ref_to_Parameter'>rv</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN71"><span class='Ref_to_Member'>alias</span></a><span class='Delimiter'>; 
</span><a name="LN1881"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>refname</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1880"><span class='Ref_To_Local'>alias</span></a> <span class='Operator'>? </span><a href="parse_relation.c.html#LN1880"><span class='Ref_To_Local'>alias</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a> <span class='Operator'>: </span><a href="parse_relation.c.html#LN1874"><span class='Ref_to_Parameter'>cte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1342"><span class='Ref_to_Member'>ctename</span></a><span class='Delimiter'>; 
</span><a name="LN1882"></a>    <a href="../../include/nodes/primnodes.h.html#LN38"><span class='Ref_to_Struct'>Alias</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>eref</span><span class='Delimiter'>; 
</span><a name="LN1883"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>numaliases</span><span class='Delimiter'>; 
</span><a name="LN1884"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>varattno</span><span class='Delimiter'>; 
</span><a name="LN1885"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1873"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1879"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN928"><span class='Ref_to_EnumConst'>RTE_CTE</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1879"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1001"><span class='Ref_to_Member'>ctename</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1874"><span class='Ref_to_Parameter'>cte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1342"><span class='Ref_to_Member'>ctename</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1879"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1002"><span class='Ref_to_Member'>ctelevelsup</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1875"><span class='Ref_to_Parameter'>levelsup</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Self-reference if and only if CTE's parse analysis isn't completed */ 
</span>    <a href="parse_relation.c.html#LN1879"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1003"><span class='Ref_to_Member'>self_reference</span></a> <span class='Operator'>= !</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1874"><span class='Ref_to_Parameter'>cte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1345"><span class='Ref_to_Member'>ctequery</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1874"><span class='Ref_to_Parameter'>cte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1348"><span class='Ref_to_Member'>cterecursive</span></a> <span class='Operator'>|| !</span><a href="parse_relation.c.html#LN1879"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1003"><span class='Ref_to_Member'>self_reference</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* Bump the CTE's refcount if this isn't a self-reference */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_relation.c.html#LN1879"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1003"><span class='Ref_to_Member'>self_reference</span></a><span class='Parentheses'>) 
</span>        <a href="parse_relation.c.html#LN1874"><span class='Ref_to_Parameter'>cte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1349"><span class='Ref_to_Member'>cterefcount</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We throw error if the CTE is INSERT/UPDATE/DELETE without RETURNING. 
     * This won't get checked in case of a self-reference, but that's OK 
     * because data-modifying CTEs aren't allowed to be recursive anyhow. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1874"><span class='Ref_to_Parameter'>cte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1345"><span class='Ref_to_Member'>ctequery</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1907"></a>        <a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>ctequery</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_relation.c.html#LN1874"><span class='Ref_to_Parameter'>cte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1345"><span class='Ref_to_Member'>ctequery</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1907"><span class='Ref_To_Local'>ctequery</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN109"><span class='Ref_to_Member'>commandType</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/nodes.h.html#LN650"><span class='Ref_to_EnumConst'>CMD_SELECT</span></a> <span class='Operator'>&& 
</span>            <a href="parse_relation.c.html#LN1907"><span class='Ref_To_Local'>ctequery</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN143"><span class='Ref_to_Member'>returningList</span></a> <span class='Operator'>== </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"WITH query \"%s\" does not have a RETURNING clause"</span><span class='Delimiter'>, 
</span>                        <a href="parse_relation.c.html#LN1874"><span class='Ref_to_Parameter'>cte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1342"><span class='Ref_to_Member'>ctename</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1873"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1876"><span class='Ref_to_Parameter'>rv</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN72"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="parse_relation.c.html#LN1879"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1012"><span class='Ref_to_Member'>coltypes</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1874"><span class='Ref_to_Parameter'>cte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1352"><span class='Ref_to_Member'>ctecoltypes</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1879"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1013"><span class='Ref_to_Member'>coltypmods</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1874"><span class='Ref_to_Parameter'>cte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1353"><span class='Ref_to_Member'>ctecoltypmods</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1879"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1014"><span class='Ref_to_Member'>colcollations</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1874"><span class='Ref_to_Parameter'>cte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1354"><span class='Ref_to_Member'>ctecolcollations</span></a><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1879"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1022"><span class='Ref_to_Member'>alias</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1880"><span class='Ref_To_Local'>alias</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1880"><span class='Ref_To_Local'>alias</span></a><span class='Parentheses'>) 
</span>        <a href="parse_relation.c.html#LN1882"><span class='Ref_To_Local'>eref</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN618"><span class='Ref_to_Macro'>copyObject</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1880"><span class='Ref_To_Local'>alias</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="parse_relation.c.html#LN1882"><span class='Ref_To_Local'>eref</span></a> <span class='Operator'>= </span><a href="../../include/nodes/makefuncs.h.html#LN63"><span class='Ref_to_Proto'>makeAlias</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1881"><span class='Ref_To_Local'>refname</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1883"><span class='Ref_To_Local'>numaliases</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1882"><span class='Ref_To_Local'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* fill in any unspecified alias columns */ 
</span>    <a href="parse_relation.c.html#LN1884"><span class='Ref_To_Local'>varattno</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1885"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1874"><span class='Ref_to_Parameter'>cte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1351"><span class='Ref_to_Member'>ctecolnames</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="parse_relation.c.html#LN1884"><span class='Ref_To_Local'>varattno</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1884"><span class='Ref_To_Local'>varattno</span></a> <span class='Operator'>&GT; </span><a href="parse_relation.c.html#LN1883"><span class='Ref_To_Local'>numaliases</span></a><span class='Parentheses'>) 
</span>            <a href="parse_relation.c.html#LN1882"><span class='Ref_To_Local'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1882"><span class='Ref_To_Local'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1885"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1884"><span class='Ref_To_Local'>varattno</span></a> <span class='Operator'>&LT; </span><a href="parse_relation.c.html#LN1883"><span class='Ref_To_Local'>numaliases</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_COLUMN_REFERENCE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"table \"%s\" has %d columns available but %d columns specified"</span><span class='Delimiter'>, 
</span>                        <a href="parse_relation.c.html#LN1881"><span class='Ref_To_Local'>refname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1884"><span class='Ref_To_Local'>varattno</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1883"><span class='Ref_To_Local'>numaliases</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1879"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1882"><span class='Ref_To_Local'>eref</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Set flags and access permissions. 
     * 
     * Subqueries are never checked for access rights. 
     */ 
</span>    <a href="parse_relation.c.html#LN1879"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1024"><span class='Ref_to_Member'>lateral</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1879"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1025"><span class='Ref_to_Member'>inh</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* never true for subqueries */ 
</span>    <a href="parse_relation.c.html#LN1879"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1026"><span class='Ref_to_Member'>inFromCl</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1877"><span class='Ref_to_Parameter'>inFromCl</span></a><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1879"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1027"><span class='Ref_to_Member'>requiredPerms</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1879"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1028"><span class='Ref_to_Member'>checkAsUser</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1879"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1029"><span class='Ref_to_Member'>selectedCols</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1879"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1030"><span class='Ref_to_Member'>insertedCols</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1879"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1031"><span class='Ref_to_Member'>updatedCols</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Add completed RTE to pstate's range table list, but not to join list 
     * nor namespace --- caller must do that if appropriate. 
     */ 
</span>    <a href="parse_relation.c.html#LN1873"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1873"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1879"><span class='Ref_To_Local'>rte</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="parse_relation.c.html#LN1879"><span class='Ref_To_Local'>rte</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end addRangeTableEntryForCTE &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Add an entry for an ephemeral named relation reference to the pstate's 
 * range table (p_rtable). 
 * 
 * It is expected that the RangeVar, which up until now is only known to be an 
 * ephemeral named relation, will (in conjunction with the QueryEnvironment in 
 * the ParseState), create a RangeTblEntry for a specific *kind* of ephemeral 
 * named relation, based on enrtype. 
 * 
 * This is much like addRangeTableEntry() except that it makes an RTE for an 
 * ephemeral named relation. 
 */ 
</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>* 
</span><a name="LN1982"></a><span class='Declare_Function'>addRangeTableEntryForENR</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, 
</span><a name="LN1983"></a>                         <a href="../../include/nodes/primnodes.h.html#LN62"><span class='Ref_to_Struct'>RangeVar</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rv</span><span class='Delimiter'>, 
</span><a name="LN1984"></a>                         <span class='Keyword'>bool </span><span class='Declare_Parameter'>inFromCl</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1986"></a>    <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1987"></a>    <a href="../../include/nodes/primnodes.h.html#LN38"><span class='Ref_to_Struct'>Alias</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>alias</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1983"><span class='Ref_to_Parameter'>rv</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN71"><span class='Ref_to_Member'>alias</span></a><span class='Delimiter'>; 
</span><a name="LN1988"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>refname</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1987"><span class='Ref_To_Local'>alias</span></a> <span class='Operator'>? </span><a href="parse_relation.c.html#LN1987"><span class='Ref_To_Local'>alias</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a> <span class='Operator'>: </span><a href="parse_relation.c.html#LN1983"><span class='Ref_to_Parameter'>rv</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Delimiter'>; 
</span><a name="LN1989"></a>    <a href="../../include/utils/queryenvironment.h.html#LN43"><span class='Ref_to_Typedef'>EphemeralNamedRelationMetadata</span></a> <span class='Declare_Local'>enrmd</span><span class='Delimiter'>; 
</span><a name="LN1990"></a>    <a href="../../include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a>   <span class='Declare_Local'>tupdesc</span><span class='Delimiter'>; 
</span><a name="LN1991"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>attno</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1982"><span class='Ref_to_Parameter'>pstate</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1989"><span class='Ref_To_Local'>enrmd</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_enr.h.html#LN19"><span class='Ref_to_Proto'>get_visible_ENR</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1982"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1983"><span class='Ref_to_Parameter'>rv</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1989"><span class='Ref_To_Local'>enrmd</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1989"><span class='Ref_To_Local'>enrmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/queryenvironment.h.html#LN39"><span class='Ref_to_Member'>enrtype</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../include/utils/queryenvironment.h.html#LN21"><span class='Ref_to_EnumConst'>ENR_NAMED_TUPLESTORE</span></a><span class='Operator'>: 
</span>            <a href="parse_relation.c.html#LN1986"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN929"><span class='Ref_to_EnumConst'>RTE_NAMEDTUPLESTORE</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unexpected enrtype: %d"</span><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1989"><span class='Ref_To_Local'>enrmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/queryenvironment.h.html#LN39"><span class='Ref_to_Member'>enrtype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* for fussy compilers */ 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Record dependency on a relation.  This allows plans to be invalidated 
     * if they access transition tables linked to a table that is altered. 
     */ 
</span>    <a href="parse_relation.c.html#LN1986"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN947"><span class='Ref_to_Member'>relid</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1989"><span class='Ref_To_Local'>enrmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/queryenvironment.h.html#LN36"><span class='Ref_to_Member'>reliddesc</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Build the list of effective column names using user-supplied aliases 
     * and/or actual column names.  Also build the cannibalized fields. 
     */ 
</span>    <a href="parse_relation.c.html#LN1990"><span class='Ref_To_Local'>tupdesc</span></a> <span class='Operator'>= </span><a href="../../include/utils/queryenvironment.h.html#LN71"><span class='Ref_to_Proto'>ENRMetadataGetTupDesc</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1989"><span class='Ref_To_Local'>enrmd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1986"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a> <span class='Operator'>= </span><a href="../../include/nodes/makefuncs.h.html#LN63"><span class='Ref_to_Proto'>makeAlias</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1988"><span class='Ref_To_Local'>refname</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1028"><span class='Ref_to_Func'>buildRelationAliases</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1990"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1987"><span class='Ref_To_Local'>alias</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1986"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1986"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1016"><span class='Ref_to_Member'>enrname</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1989"><span class='Ref_To_Local'>enrmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/queryenvironment.h.html#LN33"><span class='Ref_to_Member'>name</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1986"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1017"><span class='Ref_to_Member'>enrtuples</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1989"><span class='Ref_To_Local'>enrmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/queryenvironment.h.html#LN40"><span class='Ref_to_Member'>enrtuples</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1986"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1012"><span class='Ref_to_Member'>coltypes</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1986"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1013"><span class='Ref_to_Member'>coltypmods</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1986"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1014"><span class='Ref_to_Member'>colcollations</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1991"><span class='Ref_To_Local'>attno</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; </span><a href="parse_relation.c.html#LN1991"><span class='Ref_To_Local'>attno</span></a> <span class='Operator'>&LT;= </span><a href="parse_relation.c.html#LN1990"><span class='Ref_To_Local'>tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="parse_relation.c.html#LN1991"><span class='Ref_To_Local'>attno</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1990"><span class='Ref_To_Local'>tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN73"><span class='Ref_to_Member'>attrs</span></a><span class='Delimiter'>[</span><a href="parse_relation.c.html#LN1991"><span class='Ref_To_Local'>attno</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span>atttypid <span class='Operator'>== </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a> <span class='Operator'>&& 
</span>            <span class='Operator'>!</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1990"><span class='Ref_To_Local'>tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN73"><span class='Ref_to_Member'>attrs</span></a><span class='Delimiter'>[</span><a href="parse_relation.c.html#LN1991"><span class='Ref_To_Local'>attno</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span>attisdropped<span class='Parentheses'>))</span> 
            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"atttypid was invalid for column which has not been dropped from \"%s\""</span><span class='Delimiter'>, 
</span>                 <a href="parse_relation.c.html#LN1983"><span class='Ref_to_Parameter'>rv</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN1986"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1012"><span class='Ref_to_Member'>coltypes</span></a> <span class='Operator'>= 
</span>            <a href="../nodes/list.c.html#LN162"><span class='Ref_to_Func'>lappend_oid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1986"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1012"><span class='Ref_to_Member'>coltypes</span></a><span class='Delimiter'>, 
</span>                        <a href="parse_relation.c.html#LN1990"><span class='Ref_To_Local'>tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN73"><span class='Ref_to_Member'>attrs</span></a><span class='Delimiter'>[</span><a href="parse_relation.c.html#LN1991"><span class='Ref_To_Local'>attno</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span>atttypid<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN1986"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1013"><span class='Ref_to_Member'>coltypmods</span></a> <span class='Operator'>= 
</span>            <a href="../nodes/list.c.html#LN144"><span class='Ref_to_Func'>lappend_int</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1986"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1013"><span class='Ref_to_Member'>coltypmods</span></a><span class='Delimiter'>, 
</span>                        <a href="parse_relation.c.html#LN1990"><span class='Ref_To_Local'>tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN73"><span class='Ref_to_Member'>attrs</span></a><span class='Delimiter'>[</span><a href="parse_relation.c.html#LN1991"><span class='Ref_To_Local'>attno</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span>atttypmod<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN1986"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1014"><span class='Ref_to_Member'>colcollations</span></a> <span class='Operator'>= 
</span>            <a href="../nodes/list.c.html#LN162"><span class='Ref_to_Func'>lappend_oid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1986"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1014"><span class='Ref_to_Member'>colcollations</span></a><span class='Delimiter'>, 
</span>                        <a href="parse_relation.c.html#LN1990"><span class='Ref_To_Local'>tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN73"><span class='Ref_to_Member'>attrs</span></a><span class='Delimiter'>[</span><a href="parse_relation.c.html#LN1991"><span class='Ref_To_Local'>attno</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span>attcollation<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Set flags and access permissions. 
     * 
     * ENRs are never checked for access rights. 
     */ 
</span>    <a href="parse_relation.c.html#LN1986"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1024"><span class='Ref_to_Member'>lateral</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1986"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1025"><span class='Ref_to_Member'>inh</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* never true for ENRs */ 
</span>    <a href="parse_relation.c.html#LN1986"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1026"><span class='Ref_to_Member'>inFromCl</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN1984"><span class='Ref_to_Parameter'>inFromCl</span></a><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN1986"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1027"><span class='Ref_to_Member'>requiredPerms</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1986"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1028"><span class='Ref_to_Member'>checkAsUser</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN1986"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1029"><span class='Ref_to_Member'>selectedCols</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Add completed RTE to pstate's range table list, but not to join list 
     * nor namespace --- caller must do that if appropriate. 
     */ 
</span>    <a href="parse_relation.c.html#LN1982"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN1982"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN1986"><span class='Ref_To_Local'>rte</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="parse_relation.c.html#LN1986"><span class='Ref_To_Local'>rte</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end addRangeTableEntryForENR &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * Has the specified refname been selected FOR UPDATE/FOR SHARE? 
 * 
 * This is used when we have not yet done transformLockingClause, but need 
 * to know the correct lock to take during initial opening of relations. 
 * 
 * Note: we pay no attention to whether it's FOR UPDATE vs FOR SHARE, 
 * since the table-level lock is the same either way. 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN2076"></a><span class='Declare_Function'>isLockedRefname</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>refname</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2078"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If we are in a subquery specified as locked FOR UPDATE/SHARE from 
     * parent level, then act as though there's a generic FOR UPDATE here. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2076"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN186"><span class='Ref_to_Member'>p_locked_from_parent</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2078"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2076"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN185"><span class='Ref_to_Member'>p_locking_clause</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2089"></a>        <a href="../../include/nodes/parsenodes.h.html#LN734"><span class='Ref_to_Struct'>LockingClause</span></a> <span class='Operator'>*</span><span class='Declare_Local'>lc</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN734"><span class='Ref_to_Struct'>LockingClause</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2078"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2089"><span class='Ref_To_Local'>lc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN737"><span class='Ref_to_Member'>lockedRels</span></a> <span class='Operator'>== </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* all tables used in query */ 
</span>            <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* just the named tables */ 
</span><a name="LN2099"></a>            <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l2</span><span class='Delimiter'>; 
</span> 
            <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2099"><span class='Ref_To_Local'>l2</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2089"><span class='Ref_To_Local'>lc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN737"><span class='Ref_to_Member'>lockedRels</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN2103"></a>                <a href="../../include/nodes/primnodes.h.html#LN62"><span class='Ref_to_Struct'>RangeVar</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>thisrel</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN62"><span class='Ref_to_Struct'>RangeVar</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2099"><span class='Ref_To_Local'>l2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2076"><span class='Ref_to_Parameter'>refname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2103"><span class='Ref_To_Local'>thisrel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end isLockedRefname &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Add the given RTE as a top-level entry in the pstate's join list 
 * and/or namespace list.  (We assume caller has checked for any 
 * namespace conflicts.)  The RTE is always marked as unconditionally 
 * visible, that is, not LATERAL-only. 
 * 
 * Note: some callers know that they can find the new ParseNamespaceItem 
 * at the end of the pstate-&GT;p_namespace list.  This is a bit ugly but not 
 * worth complicating this function's signature for. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN2124"></a><span class='Declare_Function'>addRTEtoQuery</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rte</span><span class='Delimiter'>, 
</span><a name="LN2125"></a>              <span class='Keyword'>bool </span><span class='Declare_Parameter'>addToJoinList</span><span class='Delimiter'>, 
</span><a name="LN2126"></a>              <span class='Keyword'>bool </span><span class='Declare_Parameter'>addToRelNameSpace</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>addToVarNameSpace</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2125"><span class='Ref_to_Parameter'>addToJoinList</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2130"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>rtindex</span> <span class='Operator'>= </span><a href="../../include/parser/parse_relation.h.html#LN47"><span class='Ref_to_Proto'>RTERangeTablePosn</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2124"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2124"><span class='Ref_to_Parameter'>rte</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2131"></a>        <a href="../../include/nodes/primnodes.h.html#LN1415"><span class='Ref_to_Struct'>RangeTblRef</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rtr</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN1415"><span class='Ref_to_Struct'>RangeTblRef</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="parse_relation.c.html#LN2131"><span class='Ref_To_Local'>rtr</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1418"><span class='Ref_to_Member'>rtindex</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN2130"><span class='Ref_To_Local'>rtindex</span></a><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN2124"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN170"><span class='Ref_to_Member'>p_joinlist</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2124"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN170"><span class='Ref_to_Member'>p_joinlist</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2131"><span class='Ref_To_Local'>rtr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2126"><span class='Ref_to_Parameter'>addToRelNameSpace</span></a> <span class='Operator'>|| </span><a href="parse_relation.c.html#LN2126"><span class='Ref_to_Parameter'>addToVarNameSpace</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2138"></a>        <a href="../../include/parser/parse_node.h.html#LN239"><span class='Ref_to_Struct'>ParseNamespaceItem</span></a> <span class='Operator'>*</span><span class='Declare_Local'>nsitem</span><span class='Delimiter'>; 
</span> 
        <a href="parse_relation.c.html#LN2138"><span class='Ref_To_Local'>nsitem</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN239"><span class='Ref_to_Struct'>ParseNamespaceItem</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN239"><span class='Ref_to_Struct'>ParseNamespaceItem</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN2138"><span class='Ref_To_Local'>nsitem</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN241"><span class='Ref_to_Member'>p_rte</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN2124"><span class='Ref_to_Parameter'>rte</span></a><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN2138"><span class='Ref_To_Local'>nsitem</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN242"><span class='Ref_to_Member'>p_rel_visible</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN2126"><span class='Ref_to_Parameter'>addToRelNameSpace</span></a><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN2138"><span class='Ref_To_Local'>nsitem</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN243"><span class='Ref_to_Member'>p_cols_visible</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN2126"><span class='Ref_to_Parameter'>addToVarNameSpace</span></a><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN2138"><span class='Ref_To_Local'>nsitem</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN244"><span class='Ref_to_Member'>p_lateral_only</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN2138"><span class='Ref_To_Local'>nsitem</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN245"><span class='Ref_to_Member'>p_lateral_ok</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN2124"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN172"><span class='Ref_to_Member'>p_namespace</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2124"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN172"><span class='Ref_to_Member'>p_namespace</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2138"><span class='Ref_To_Local'>nsitem</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end addRTEtoQuery &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * expandRTE -- expand the columns of a rangetable entry 
 * 
 * This creates lists of an RTE's column names (aliases if provided, else 
 * real names) and Vars for each column.  Only user columns are considered. 
 * If include_dropped is FALSE then dropped columns are omitted from the 
 * results.  If include_dropped is TRUE then empty strings and NULL constants 
 * (not Vars!) are returned for dropped columns. 
 * 
 * rtindex, sublevels_up, and location are the varno, varlevelsup, and location 
 * values to use in the created Vars.  Ordinarily rtindex should match the 
 * actual position of the RTE in its rangetable. 
 * 
 * The output lists go into *colnames and *colvars. 
 * If only one of the two kinds of output list is needed, pass NULL for the 
 * output pointer for the unwanted one. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN2168"></a><span class='Declare_Function'>expandRTE</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rte</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>rtindex</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>sublevels_up</span><span class='Delimiter'>, 
</span><a name="LN2169"></a>          <span class='Keyword'>int </span><span class='Declare_Parameter'>location</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>include_dropped</span><span class='Delimiter'>, 
</span><a name="LN2170"></a>          <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>colnames</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>colvars</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2172"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>varattno</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colnames</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colnames</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colvars</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colvars</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN922"><span class='Ref_to_EnumConst'>RTE_RELATION</span></a><span class='Operator'>: 
</span>            <span class='Comment_Multi_Line'>/* Ordinary relation RTE */ 
</span>            <a href="parse_relation.c.html#LN47"><span class='Ref_to_Proto'>expandRelation</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN947"><span class='Ref_to_Member'>relid</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Delimiter'>, 
</span>                           <a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rtindex</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>sublevels_up</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2169"><span class='Ref_to_Parameter'>location</span></a><span class='Delimiter'>, 
</span>                           <a href="parse_relation.c.html#LN2169"><span class='Ref_to_Parameter'>include_dropped</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colnames</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colvars</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN923"><span class='Ref_to_EnumConst'>RTE_SUBQUERY</span></a><span class='Operator'>: 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Subquery RTE */ 
</span><a name="LN2190"></a>                <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>aliasp_item</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN75"><span class='Ref_to_Func'>list_head</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2191"></a>                <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>tlistitem</span><span class='Delimiter'>; 
</span> 
                <a href="parse_relation.c.html#LN2172"><span class='Ref_To_Local'>varattno</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2191"><span class='Ref_To_Local'>tlistitem</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN954"><span class='Ref_to_Member'>subquery</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN137"><span class='Ref_to_Member'>targetList</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span><a name="LN2196"></a>                    <a href="../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>te</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2191"><span class='Ref_To_Local'>tlistitem</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2196"><span class='Ref_To_Local'>te</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1373"><span class='Ref_to_Member'>resjunk</span></a><span class='Parentheses'>) 
</span>                        <span class='Control'>continue</span><span class='Delimiter'>; 
</span>                    <a href="parse_relation.c.html#LN2172"><span class='Ref_To_Local'>varattno</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2172"><span class='Ref_To_Local'>varattno</span></a> <span class='Operator'>== </span><a href="parse_relation.c.html#LN2196"><span class='Ref_To_Local'>te</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1367"><span class='Ref_to_Member'>resno</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colnames</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <span class='Comment_Multi_Line'>/* Assume there is one alias per target item */ 
</span><a name="LN2206"></a>                        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>label</span> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2190"><span class='Ref_To_Local'>aliasp_item</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
                        <span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colnames</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colnames</span></a><span class='Delimiter'>, </span><a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2206"><span class='Ref_To_Local'>label</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                        <a href="parse_relation.c.html#LN2190"><span class='Ref_To_Local'>aliasp_item</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN104"><span class='Ref_to_Macro'>lnext</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2190"><span class='Ref_To_Local'>aliasp_item</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span> 
                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colvars</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span><a name="LN2214"></a>                        <a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>varnode</span><span class='Delimiter'>; 
</span> 
                        <a href="parse_relation.c.html#LN2214"><span class='Ref_To_Local'>varnode</span></a> <span class='Operator'>= </span><a href="../../include/nodes/makefuncs.h.html#LN25"><span class='Ref_to_Proto'>makeVar</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rtindex</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2172"><span class='Ref_To_Local'>varattno</span></a><span class='Delimiter'>, 
</span>                                          <a href="../../include/nodes/nodeFuncs.h.html#LN31"><span class='Ref_to_Proto'>exprType</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_relation.c.html#LN2196"><span class='Ref_To_Local'>te</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1366"><span class='Ref_to_Member'>expr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                          <a href="../../include/nodes/nodeFuncs.h.html#LN32"><span class='Ref_to_Proto'>exprTypmod</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_relation.c.html#LN2196"><span class='Ref_To_Local'>te</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1366"><span class='Ref_to_Member'>expr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                          <a href="../../include/nodes/nodeFuncs.h.html#LN38"><span class='Ref_to_Proto'>exprCollation</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_relation.c.html#LN2196"><span class='Ref_To_Local'>te</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1366"><span class='Ref_to_Member'>expr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                          <a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>sublevels_up</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                        <a href="parse_relation.c.html#LN2214"><span class='Ref_To_Local'>varnode</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN177"><span class='Ref_to_Member'>location</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN2169"><span class='Ref_to_Parameter'>location</span></a><span class='Delimiter'>; 
</span> 
                        <span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colvars</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colvars</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2214"><span class='Ref_To_Local'>varnode</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN925"><span class='Ref_to_EnumConst'>RTE_FUNCTION</span></a><span class='Operator'>: 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Function RTE */ 
</span><a name="LN2231"></a>                <span class='Keyword'>int</span>         <span class='Declare_Local'>atts_done</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN2232"></a>                <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
                <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2232"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN985"><span class='Ref_to_Member'>functions</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span><a name="LN2236"></a>                    <a href="../../include/nodes/parsenodes.h.html#LN1051"><span class='Ref_to_Struct'>RangeTblFunction</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rtfunc</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN1051"><span class='Ref_to_Struct'>RangeTblFunction</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2232"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2237"></a>                    <a href="../../include/funcapi.h.html#LN149"><span class='Ref_to_Enum'>TypeFuncClass</span></a> <span class='Declare_Local'>functypclass</span><span class='Delimiter'>; 
</span><a name="LN2238"></a>                    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>funcrettype</span><span class='Delimiter'>; 
</span><a name="LN2239"></a>                    <a href="../../include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a>   <span class='Declare_Local'>tupdesc</span><span class='Delimiter'>; 
</span> 
                    <a href="parse_relation.c.html#LN2237"><span class='Ref_To_Local'>functypclass</span></a> <span class='Operator'>= </span><a href="../../include/funcapi.h.html#LN160"><span class='Ref_to_Proto'>get_expr_result_type</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2236"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1055"><span class='Ref_to_Member'>funcexpr</span></a><span class='Delimiter'>, 
</span>                                                        <span class='Operator'>&</span><a href="parse_relation.c.html#LN2238"><span class='Ref_To_Local'>funcrettype</span></a><span class='Delimiter'>, 
</span>                                                        <span class='Operator'>&</span><a href="parse_relation.c.html#LN2239"><span class='Ref_To_Local'>tupdesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2237"><span class='Ref_To_Local'>functypclass</span></a> <span class='Operator'>== </span><a href="../../include/funcapi.h.html#LN152"><span class='Ref_to_EnumConst'>TYPEFUNC_COMPOSITE</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <span class='Comment_Multi_Line'>/* Composite data type, e.g. a table's row type */ 
</span>                        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2239"><span class='Ref_To_Local'>tupdesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                        <a href="parse_relation.c.html#LN51"><span class='Ref_to_Proto'>expandTupleDesc</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2239"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Delimiter'>, 
</span>                                        <a href="parse_relation.c.html#LN2236"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1056"><span class='Ref_to_Member'>funccolcount</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2231"><span class='Ref_To_Local'>atts_done</span></a><span class='Delimiter'>, 
</span>                                        <a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rtindex</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>sublevels_up</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2169"><span class='Ref_to_Parameter'>location</span></a><span class='Delimiter'>, 
</span>                                        <a href="parse_relation.c.html#LN2169"><span class='Ref_to_Parameter'>include_dropped</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colnames</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colvars</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2237"><span class='Ref_To_Local'>functypclass</span></a> <span class='Operator'>== </span><a href="../../include/funcapi.h.html#LN151"><span class='Ref_to_EnumConst'>TYPEFUNC_SCALAR</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <span class='Comment_Multi_Line'>/* Base data type, i.e. scalar */ 
</span>                        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colnames</span></a><span class='Parentheses'>) 
</span>                            <span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colnames</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colnames</span></a><span class='Delimiter'>, 
</span>                                                <a href="../../include/nodes/pg_list.h.html#LN223"><span class='Ref_to_Proto'>list_nth</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Delimiter'>, 
</span>                                                         <a href="parse_relation.c.html#LN2231"><span class='Ref_To_Local'>atts_done</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
                        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colvars</span></a><span class='Parentheses'>) 
</span>                        <span class='Delimiter'>{ 
</span><a name="LN2263"></a>                            <a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>varnode</span><span class='Delimiter'>; 
</span> 
                            <a href="parse_relation.c.html#LN2263"><span class='Ref_To_Local'>varnode</span></a> <span class='Operator'>= </span><a href="../../include/nodes/makefuncs.h.html#LN25"><span class='Ref_to_Proto'>makeVar</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rtindex</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2231"><span class='Ref_To_Local'>atts_done</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>, 
</span>                                              <a href="parse_relation.c.html#LN2238"><span class='Ref_To_Local'>funcrettype</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, 
</span>                                              <a href="../../include/nodes/nodeFuncs.h.html#LN38"><span class='Ref_to_Proto'>exprCollation</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2236"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1055"><span class='Ref_to_Member'>funcexpr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                              <a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>sublevels_up</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                            <a href="parse_relation.c.html#LN2263"><span class='Ref_To_Local'>varnode</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN177"><span class='Ref_to_Member'>location</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN2169"><span class='Ref_to_Parameter'>location</span></a><span class='Delimiter'>; 
</span> 
                            <span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colvars</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colvars</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2263"><span class='Ref_To_Local'>varnode</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                        <span class='Delimiter'>} 
</span>                    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if functypclass==TYPEFUN... &raquo; </span> 
                    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2237"><span class='Ref_To_Local'>functypclass</span></a> <span class='Operator'>== </span><a href="../../include/funcapi.h.html#LN153"><span class='Ref_to_EnumConst'>TYPEFUNC_RECORD</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colnames</span></a><span class='Parentheses'>) 
</span>                        <span class='Delimiter'>{ 
</span><a name="LN2278"></a>                            <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>namelist</span><span class='Delimiter'>; 
</span> 
                            <span class='Comment_Multi_Line'>/* extract appropriate subset of column list */ 
</span>                            <a href="parse_relation.c.html#LN2278"><span class='Ref_To_Local'>namelist</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN269"><span class='Ref_to_Proto'>list_copy_tail</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Delimiter'>, 
</span>                                                      <a href="parse_relation.c.html#LN2231"><span class='Ref_To_Local'>atts_done</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                            <a href="parse_relation.c.html#LN2278"><span class='Ref_To_Local'>namelist</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN220"><span class='Ref_to_Proto'>list_truncate</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2278"><span class='Ref_To_Local'>namelist</span></a><span class='Delimiter'>, 
</span>                                                     <a href="parse_relation.c.html#LN2236"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1056"><span class='Ref_to_Member'>funccolcount</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                            <span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colnames</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN219"><span class='Ref_to_Proto'>list_concat</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colnames</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2278"><span class='Ref_To_Local'>namelist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                        <span class='Delimiter'>} 
</span> 
                        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colvars</span></a><span class='Parentheses'>) 
</span>                        <span class='Delimiter'>{ 
</span><a name="LN2290"></a>                            <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l1</span><span class='Delimiter'>; 
</span><a name="LN2291"></a>                            <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l2</span><span class='Delimiter'>; 
</span><a name="LN2292"></a>                            <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l3</span><span class='Delimiter'>; 
</span><a name="LN2293"></a>                            <span class='Keyword'>int</span>         <span class='Declare_Local'>attnum</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN2231"><span class='Ref_To_Local'>atts_done</span></a><span class='Delimiter'>; 
</span> 
                            <a href="../../include/nodes/pg_list.h.html#LN202"><span class='Ref_to_Macro'>forthree</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2290"><span class='Ref_To_Local'>l1</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2236"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1059"><span class='Ref_to_Member'>funccoltypes</span></a><span class='Delimiter'>, 
</span>                                     <a href="parse_relation.c.html#LN2291"><span class='Ref_To_Local'>l2</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2236"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1060"><span class='Ref_to_Member'>funccoltypmods</span></a><span class='Delimiter'>, 
</span>                                     <a href="parse_relation.c.html#LN2292"><span class='Ref_To_Local'>l3</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2236"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1061"><span class='Ref_to_Member'>funccolcollations</span></a><span class='Parentheses'>) 
</span>                            <span class='Delimiter'>{ 
</span><a name="LN2299"></a>                                <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>attrtype</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2290"><span class='Ref_To_Local'>l1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2300"></a>                                <a href="../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>attrtypmod</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN106"><span class='Ref_to_Macro'>lfirst_int</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2291"><span class='Ref_To_Local'>l2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2301"></a>                                <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>attrcollation</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2292"><span class='Ref_To_Local'>l3</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2302"></a>                                <a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>varnode</span><span class='Delimiter'>; 
</span> 
                                <a href="parse_relation.c.html#LN2293"><span class='Ref_To_Local'>attnum</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                                <a href="parse_relation.c.html#LN2302"><span class='Ref_To_Local'>varnode</span></a> <span class='Operator'>= </span><a href="../../include/nodes/makefuncs.h.html#LN25"><span class='Ref_to_Proto'>makeVar</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rtindex</span></a><span class='Delimiter'>, 
</span>                                                  <a href="parse_relation.c.html#LN2293"><span class='Ref_To_Local'>attnum</span></a><span class='Delimiter'>, 
</span>                                                  <a href="parse_relation.c.html#LN2299"><span class='Ref_To_Local'>attrtype</span></a><span class='Delimiter'>, 
</span>                                                  <a href="parse_relation.c.html#LN2300"><span class='Ref_To_Local'>attrtypmod</span></a><span class='Delimiter'>, 
</span>                                                  <a href="parse_relation.c.html#LN2301"><span class='Ref_To_Local'>attrcollation</span></a><span class='Delimiter'>, 
</span>                                                  <a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>sublevels_up</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                                <a href="parse_relation.c.html#LN2302"><span class='Ref_To_Local'>varnode</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN177"><span class='Ref_to_Member'>location</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN2169"><span class='Ref_to_Parameter'>location</span></a><span class='Delimiter'>; 
</span>                                <span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colvars</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colvars</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2302"><span class='Ref_To_Local'>varnode</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                            <span class='Delimiter'>} 
</span>                        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if colvars &raquo; </span> 
                    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if functypclass==TYPEFUN... &raquo; </span> 
                    <span class='Control'>else</span> 
                    <span class='Delimiter'>{ 
</span>                        <span class='Comment_Multi_Line'>/* addRangeTableEntryForFunction should've caught this */ 
</span>                        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"function in FROM has unsupported return type"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    <a href="parse_relation.c.html#LN2231"><span class='Ref_To_Local'>atts_done</span></a> <span class='Operator'>+= </span><a href="parse_relation.c.html#LN2236"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1056"><span class='Ref_to_Member'>funccolcount</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span> 
                <span class='Comment_Multi_Line'>/* Append the ordinality column if any */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN986"><span class='Ref_to_Member'>funcordinality</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colnames</span></a><span class='Parentheses'>) 
</span>                        <span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colnames</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colnames</span></a><span class='Delimiter'>, 
</span>                                            <a href="../../include/nodes/pg_list.h.html#LN130"><span class='Ref_to_Macro'>llast</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colvars</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span><a name="LN2333"></a>                        <a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>varnode</span> <span class='Operator'>= </span><a href="../../include/nodes/makefuncs.h.html#LN25"><span class='Ref_to_Proto'>makeVar</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rtindex</span></a><span class='Delimiter'>, 
</span>                                                      <a href="parse_relation.c.html#LN2231"><span class='Ref_To_Local'>atts_done</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>, 
</span>                                                      <a href="../../interfaces/ecpg/ecpglib/pg_type.h.html#LN21"><span class='Ref_to_Const'>INT8OID</span></a><span class='Delimiter'>, 
</span>                                                      <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, 
</span>                                                      <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>, 
</span>                                                      <a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>sublevels_up</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                        <span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colvars</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colvars</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2333"><span class='Ref_To_Local'>varnode</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN924"><span class='Ref_to_EnumConst'>RTE_JOIN</span></a><span class='Operator'>: 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Join RTE */ 
</span><a name="LN2348"></a>                <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>colname</span><span class='Delimiter'>; 
</span><a name="LN2349"></a>                <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>aliasvar</span><span class='Delimiter'>; 
</span> 
                <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN975"><span class='Ref_to_Member'>joinaliasvars</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
                <a href="parse_relation.c.html#LN2172"><span class='Ref_To_Local'>varattno</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                <a href="../../include/nodes/pg_list.h.html#LN179"><span class='Ref_to_Macro'>forboth</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2348"><span class='Ref_To_Local'>colname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2349"><span class='Ref_To_Local'>aliasvar</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN975"><span class='Ref_to_Member'>joinaliasvars</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span><a name="LN2356"></a>                    <a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>avar</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2349"><span class='Ref_To_Local'>aliasvar</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                    <a href="parse_relation.c.html#LN2172"><span class='Ref_To_Local'>varattno</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * During ordinary parsing, there will never be any 
                     * deleted columns in the join; but we have to check since 
                     * this routine is also used by the rewriter, and joins 
                     * found in stored rules might have join columns for 
                     * since-deleted columns.  This will be signaled by a null 
                     * pointer in the alias-vars list. 
                     */ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2356"><span class='Ref_To_Local'>avar</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2169"><span class='Ref_to_Parameter'>include_dropped</span></a><span class='Parentheses'>) 
</span>                        <span class='Delimiter'>{ 
</span>                            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colnames</span></a><span class='Parentheses'>) 
</span>                                <span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colnames</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colnames</span></a><span class='Delimiter'>, 
</span>                                                    <a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><span class='String'>""</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colvars</span></a><span class='Parentheses'>) 
</span>                            <span class='Delimiter'>{ 
</span>                                <span class='Comment_Multi_Line'>/* 
                                 * Can't use join's column type here (it might 
                                 * be dropped!); but it doesn't really matter 
                                 * what type the Const claims to be. 
                                 */ 
</span>                                <span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colvars</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colvars</span></a><span class='Delimiter'>, 
</span>                                                   <a href="../../include/nodes/makefuncs.h.html#LN57"><span class='Ref_to_Proto'>makeNullConst</span></a><span class='Parentheses'>(</span><a href="../../interfaces/ecpg/ecpglib/pg_type.h.html#LN24"><span class='Ref_to_Const'>INT4OID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, 
</span>                                                                 <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                            <span class='Delimiter'>} 
</span>                        <span class='Delimiter'>} 
</span>                        <span class='Control'>continue</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if avar==NULL &raquo; </span> 
 
                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colnames</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span><a name="LN2392"></a>                        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>label</span> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2348"><span class='Ref_To_Local'>colname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
                        <span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colnames</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colnames</span></a><span class='Delimiter'>, 
</span>                                            <a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2392"><span class='Ref_To_Local'>label</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span> 
                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colvars</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span><a name="LN2400"></a>                        <a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>varnode</span><span class='Delimiter'>; 
</span> 
                        <a href="parse_relation.c.html#LN2400"><span class='Ref_To_Local'>varnode</span></a> <span class='Operator'>= </span><a href="../../include/nodes/makefuncs.h.html#LN25"><span class='Ref_to_Proto'>makeVar</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rtindex</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2172"><span class='Ref_To_Local'>varattno</span></a><span class='Delimiter'>, 
</span>                                          <a href="../../include/nodes/nodeFuncs.h.html#LN31"><span class='Ref_to_Proto'>exprType</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2356"><span class='Ref_To_Local'>avar</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                          <a href="../../include/nodes/nodeFuncs.h.html#LN32"><span class='Ref_to_Proto'>exprTypmod</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2356"><span class='Ref_To_Local'>avar</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                          <a href="../../include/nodes/nodeFuncs.h.html#LN38"><span class='Ref_to_Proto'>exprCollation</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2356"><span class='Ref_To_Local'>avar</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                          <a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>sublevels_up</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                        <a href="parse_relation.c.html#LN2400"><span class='Ref_To_Local'>varnode</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN177"><span class='Ref_to_Member'>location</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN2169"><span class='Ref_to_Parameter'>location</span></a><span class='Delimiter'>; 
</span> 
                        <span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colvars</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colvars</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2400"><span class='Ref_To_Local'>varnode</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN926"><span class='Ref_to_EnumConst'>RTE_TABLEFUNC</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN927"><span class='Ref_to_EnumConst'>RTE_VALUES</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN928"><span class='Ref_to_EnumConst'>RTE_CTE</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN929"><span class='Ref_to_EnumConst'>RTE_NAMEDTUPLESTORE</span></a><span class='Operator'>: 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Tablefunc, Values or CTE RTE */ 
</span><a name="LN2420"></a>                <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>aliasp_item</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN75"><span class='Ref_to_Func'>list_head</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2421"></a>                <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lct</span><span class='Delimiter'>; 
</span><a name="LN2422"></a>                <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lcm</span><span class='Delimiter'>; 
</span><a name="LN2423"></a>                <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lcc</span><span class='Delimiter'>; 
</span> 
                <a href="parse_relation.c.html#LN2172"><span class='Ref_To_Local'>varattno</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                <a href="../../include/nodes/pg_list.h.html#LN202"><span class='Ref_to_Macro'>forthree</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2421"><span class='Ref_To_Local'>lct</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1012"><span class='Ref_to_Member'>coltypes</span></a><span class='Delimiter'>, 
</span>                         <a href="parse_relation.c.html#LN2422"><span class='Ref_To_Local'>lcm</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1013"><span class='Ref_to_Member'>coltypmods</span></a><span class='Delimiter'>, 
</span>                         <a href="parse_relation.c.html#LN2423"><span class='Ref_To_Local'>lcc</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1014"><span class='Ref_to_Member'>colcollations</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span><a name="LN2430"></a>                    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>coltype</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2421"><span class='Ref_To_Local'>lct</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2431"></a>                    <a href="../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>coltypmod</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN106"><span class='Ref_to_Macro'>lfirst_int</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2422"><span class='Ref_To_Local'>lcm</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2432"></a>                    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>colcoll</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2423"><span class='Ref_To_Local'>lcc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                    <a href="parse_relation.c.html#LN2172"><span class='Ref_To_Local'>varattno</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span> 
                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colnames</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <span class='Comment_Multi_Line'>/* Assume there is one alias per output column */ 
</span><a name="LN2439"></a>                        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>label</span> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2420"><span class='Ref_To_Local'>aliasp_item</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
                        <span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colnames</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colnames</span></a><span class='Delimiter'>, 
</span>                                            <a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2439"><span class='Ref_To_Local'>label</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                        <a href="parse_relation.c.html#LN2420"><span class='Ref_To_Local'>aliasp_item</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN104"><span class='Ref_to_Macro'>lnext</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2420"><span class='Ref_To_Local'>aliasp_item</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span> 
                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colvars</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span><a name="LN2448"></a>                        <a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>varnode</span><span class='Delimiter'>; 
</span> 
                        <a href="parse_relation.c.html#LN2448"><span class='Ref_To_Local'>varnode</span></a> <span class='Operator'>= </span><a href="../../include/nodes/makefuncs.h.html#LN25"><span class='Ref_to_Proto'>makeVar</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rtindex</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2172"><span class='Ref_To_Local'>varattno</span></a><span class='Delimiter'>, 
</span>                                          <a href="parse_relation.c.html#LN2430"><span class='Ref_To_Local'>coltype</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2431"><span class='Ref_To_Local'>coltypmod</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2432"><span class='Ref_To_Local'>colcoll</span></a><span class='Delimiter'>, 
</span>                                          <a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>sublevels_up</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                        <a href="parse_relation.c.html#LN2448"><span class='Ref_To_Local'>varnode</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN177"><span class='Ref_to_Member'>location</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN2169"><span class='Ref_to_Parameter'>location</span></a><span class='Delimiter'>; 
</span> 
                        <span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colvars</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="parse_relation.c.html#LN2170"><span class='Ref_to_Parameter'>colvars</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2448"><span class='Ref_To_Local'>varnode</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized RTE kind: %d"</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="parse_relation.c.html#LN2168"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch rte-&GT;rtekind &raquo; </span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end expandRTE &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * expandRelation -- expandRTE subroutine 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN2469"></a><span class='Declare_Function'>expandRelation</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>relid</span><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN38"><span class='Ref_to_Struct'>Alias</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>eref</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>rtindex</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>sublevels_up</span><span class='Delimiter'>, 
</span><a name="LN2470"></a>               <span class='Keyword'>int </span><span class='Declare_Parameter'>location</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>include_dropped</span><span class='Delimiter'>, 
</span><a name="LN2471"></a>               <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>colnames</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>colvars</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2473"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>rel</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Get the tupledesc and turn it over to expandTupleDesc */ 
</span>    <a href="parse_relation.c.html#LN2473"><span class='Ref_To_Local'>rel</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN84"><span class='Ref_to_Proto'>relation_open</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2469"><span class='Ref_to_Parameter'>relid</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN35"><span class='Ref_to_Const'>AccessShareLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_relation.c.html#LN51"><span class='Ref_to_Proto'>expandTupleDesc</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2473"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN114"><span class='Ref_to_Member'>rd_att</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2469"><span class='Ref_to_Parameter'>eref</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2473"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN114"><span class='Ref_to_Member'>rd_att</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, 
</span>                    <a href="parse_relation.c.html#LN2469"><span class='Ref_to_Parameter'>rtindex</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2469"><span class='Ref_to_Parameter'>sublevels_up</span></a><span class='Delimiter'>, 
</span>                    <a href="parse_relation.c.html#LN2470"><span class='Ref_to_Parameter'>location</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2470"><span class='Ref_to_Parameter'>include_dropped</span></a><span class='Delimiter'>, 
</span>                    <a href="parse_relation.c.html#LN2471"><span class='Ref_to_Parameter'>colnames</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2471"><span class='Ref_to_Parameter'>colvars</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/access/heapam.h.html#LN89"><span class='Ref_to_Proto'>relation_close</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2473"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN35"><span class='Ref_to_Const'>AccessShareLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * expandTupleDesc -- expandRTE subroutine 
 * 
 * Generate names and/or Vars for the first "count" attributes of the tupdesc, 
 * and append them to colnames/colvars.  "offset" is added to the varattno 
 * that each Var would otherwise have, and we also skip the first "offset" 
 * entries in eref-&GT;colnames.  (These provisions allow use of this code for 
 * an individual composite-returning function in an RTE_FUNCTION RTE.) 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN2494"></a><span class='Declare_Function'>expandTupleDesc</span><span class='Parentheses'>(</span><a href="../../include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a> <span class='Declare_Parameter'>tupdesc</span><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN38"><span class='Ref_to_Struct'>Alias</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>eref</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>count</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>offset</span><span class='Delimiter'>, 
</span><a name="LN2495"></a>                <span class='Keyword'>int </span><span class='Declare_Parameter'>rtindex</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>sublevels_up</span><span class='Delimiter'>, 
</span><a name="LN2496"></a>                <span class='Keyword'>int </span><span class='Declare_Parameter'>location</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>include_dropped</span><span class='Delimiter'>, 
</span><a name="LN2497"></a>                <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>colnames</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>colvars</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2499"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>aliascell</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN75"><span class='Ref_to_Func'>list_head</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2494"><span class='Ref_to_Parameter'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2500"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>varattno</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2497"><span class='Ref_to_Parameter'>colnames</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2504"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2504"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="parse_relation.c.html#LN2504"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="parse_relation.c.html#LN2494"><span class='Ref_to_Parameter'>offset</span></a><span class='Delimiter'>; </span><a href="parse_relation.c.html#LN2504"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2499"><span class='Ref_To_Local'>aliascell</span></a><span class='Parentheses'>) 
</span>                <a href="parse_relation.c.html#LN2499"><span class='Ref_To_Local'>aliascell</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN104"><span class='Ref_to_Macro'>lnext</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2499"><span class='Ref_To_Local'>aliascell</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2494"><span class='Ref_to_Parameter'>count</span></a> <span class='Operator'>&LT;= </span><a href="parse_relation.c.html#LN2494"><span class='Ref_to_Parameter'>tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2500"><span class='Ref_To_Local'>varattno</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="parse_relation.c.html#LN2500"><span class='Ref_To_Local'>varattno</span></a> <span class='Operator'>&LT; </span><a href="parse_relation.c.html#LN2494"><span class='Ref_to_Parameter'>count</span></a><span class='Delimiter'>; </span><a href="parse_relation.c.html#LN2500"><span class='Ref_To_Local'>varattno</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2516"></a>        <a href="../../include/catalog/pg_attribute.h.html#LN186"><span class='Ref_to_Typedef'>Form_pg_attribute</span></a> <span class='Declare_Local'>attr</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN2494"><span class='Ref_to_Parameter'>tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN73"><span class='Ref_to_Member'>attrs</span></a><span class='Delimiter'>[</span><a href="parse_relation.c.html#LN2500"><span class='Ref_To_Local'>varattno</span></a><span class='Delimiter'>]; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2516"><span class='Ref_To_Local'>attr</span></a><span class='Operator'>-&GT;</span>attisdropped<span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2496"><span class='Ref_to_Parameter'>include_dropped</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2497"><span class='Ref_to_Parameter'>colnames</span></a><span class='Parentheses'>) 
</span>                    <span class='Operator'>*</span><a href="parse_relation.c.html#LN2497"><span class='Ref_to_Parameter'>colnames</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="parse_relation.c.html#LN2497"><span class='Ref_to_Parameter'>colnames</span></a><span class='Delimiter'>, </span><a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><span class='String'>""</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2497"><span class='Ref_to_Parameter'>colvars</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Comment_Multi_Line'>/* 
                     * can't use atttypid here, but it doesn't really matter 
                     * what type the Const claims to be. 
                     */ 
</span>                    <span class='Operator'>*</span><a href="parse_relation.c.html#LN2497"><span class='Ref_to_Parameter'>colvars</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="parse_relation.c.html#LN2497"><span class='Ref_to_Parameter'>colvars</span></a><span class='Delimiter'>, 
</span>                                     <a href="../../include/nodes/makefuncs.h.html#LN57"><span class='Ref_to_Proto'>makeNullConst</span></a><span class='Parentheses'>(</span><a href="../../interfaces/ecpg/ecpglib/pg_type.h.html#LN24"><span class='Ref_to_Const'>INT4OID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2499"><span class='Ref_To_Local'>aliascell</span></a><span class='Parentheses'>) 
</span>                <a href="parse_relation.c.html#LN2499"><span class='Ref_To_Local'>aliascell</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN104"><span class='Ref_to_Macro'>lnext</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2499"><span class='Ref_To_Local'>aliascell</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if attr-&GT;attisdropped &raquo; </span> 
 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2497"><span class='Ref_to_Parameter'>colnames</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN2541"></a>            <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>label</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2499"><span class='Ref_To_Local'>aliascell</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="parse_relation.c.html#LN2541"><span class='Ref_To_Local'>label</span></a> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2499"><span class='Ref_To_Local'>aliascell</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <a href="parse_relation.c.html#LN2499"><span class='Ref_To_Local'>aliascell</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN104"><span class='Ref_to_Macro'>lnext</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2499"><span class='Ref_To_Local'>aliascell</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* If we run out of aliases, use the underlying name */ 
</span>                <a href="parse_relation.c.html#LN2541"><span class='Ref_To_Local'>label</span></a> <span class='Operator'>= </span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2516"><span class='Ref_To_Local'>attr</span></a><span class='Operator'>-&GT;</span>attname<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Operator'>*</span><a href="parse_relation.c.html#LN2497"><span class='Ref_to_Parameter'>colnames</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="parse_relation.c.html#LN2497"><span class='Ref_to_Parameter'>colnames</span></a><span class='Delimiter'>, </span><a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2541"><span class='Ref_To_Local'>label</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2497"><span class='Ref_to_Parameter'>colvars</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN2558"></a>            <a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>varnode</span><span class='Delimiter'>; 
</span> 
            <a href="parse_relation.c.html#LN2558"><span class='Ref_To_Local'>varnode</span></a> <span class='Operator'>= </span><a href="../../include/nodes/makefuncs.h.html#LN25"><span class='Ref_to_Proto'>makeVar</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2495"><span class='Ref_to_Parameter'>rtindex</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2500"><span class='Ref_To_Local'>varattno</span></a> <span class='Operator'>+ </span><a href="parse_relation.c.html#LN2494"><span class='Ref_to_Parameter'>offset</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>, 
</span>                              <a href="parse_relation.c.html#LN2516"><span class='Ref_To_Local'>attr</span></a><span class='Operator'>-&GT;</span>atttypid<span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2516"><span class='Ref_To_Local'>attr</span></a><span class='Operator'>-&GT;</span>atttypmod<span class='Delimiter'>, 
</span>                              <a href="parse_relation.c.html#LN2516"><span class='Ref_To_Local'>attr</span></a><span class='Operator'>-&GT;</span>attcollation<span class='Delimiter'>, 
</span>                              <a href="parse_relation.c.html#LN2495"><span class='Ref_to_Parameter'>sublevels_up</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_relation.c.html#LN2558"><span class='Ref_To_Local'>varnode</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN177"><span class='Ref_to_Member'>location</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN2496"><span class='Ref_to_Parameter'>location</span></a><span class='Delimiter'>; 
</span> 
            <span class='Operator'>*</span><a href="parse_relation.c.html#LN2497"><span class='Ref_to_Parameter'>colvars</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="parse_relation.c.html#LN2497"><span class='Ref_to_Parameter'>colvars</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2558"><span class='Ref_To_Local'>varnode</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for varattno=0;varattno&LT;c... &raquo; </span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end expandTupleDesc &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * expandRelAttrs - 
 *    Workhorse for "*" expansion: produce a list of targetentries 
 *    for the attributes of the RTE 
 * 
 * As with expandRTE, rtindex/sublevels_up determine the varno/varlevelsup 
 * fields of the Vars produced, and location sets their location. 
 * pstate-&GT;p_next_resno determines the resnos assigned to the TLEs. 
 * The referenced columns are marked as requiring SELECT access. 
 */ 
</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>* 
</span><a name="LN2582"></a><span class='Declare_Function'>expandRelAttrs</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rte</span><span class='Delimiter'>, 
</span><a name="LN2583"></a>               <span class='Keyword'>int </span><span class='Declare_Parameter'>rtindex</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>sublevels_up</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>location</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2585"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>names</span><span class='Delimiter'>, 
</span><a name="LN2586"></a>               <span class='Operator'>*</span><span class='Declare_Local'>vars</span><span class='Delimiter'>; 
</span><a name="LN2587"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>name</span><span class='Delimiter'>, 
</span><a name="LN2588"></a>               <span class='Operator'>*</span><span class='Declare_Local'>var</span><span class='Delimiter'>; 
</span><a name="LN2589"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>te_list</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../include/parser/parse_relation.h.html#LN120"><span class='Ref_to_Proto'>expandRTE</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2582"><span class='Ref_to_Parameter'>rte</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2583"><span class='Ref_to_Parameter'>rtindex</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2583"><span class='Ref_to_Parameter'>sublevels_up</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2583"><span class='Ref_to_Parameter'>location</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, 
</span>              <span class='Operator'>&</span><a href="parse_relation.c.html#LN2585"><span class='Ref_To_Local'>names</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="parse_relation.c.html#LN2586"><span class='Ref_To_Local'>vars</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Require read access to the table.  This is normally redundant with the 
     * markVarForSelectPriv calls below, but not if the table has zero 
     * columns. 
     */ 
</span>    <a href="parse_relation.c.html#LN2582"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1027"><span class='Ref_to_Member'>requiredPerms</span></a> <span class='Operator'>|= </span><a href="../../include/nodes/parsenodes.h.html#LN72"><span class='Ref_to_Const'>ACL_SELECT</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN179"><span class='Ref_to_Macro'>forboth</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2587"><span class='Ref_To_Local'>name</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2585"><span class='Ref_To_Local'>names</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2588"><span class='Ref_To_Local'>var</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2586"><span class='Ref_To_Local'>vars</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2603"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>label</span> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2587"><span class='Ref_To_Local'>name</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span><a name="LN2604"></a>        <a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>varnode</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2588"><span class='Ref_To_Local'>var</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2605"></a>        <a href="../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>te</span><span class='Delimiter'>; 
</span> 
        <a href="parse_relation.c.html#LN2605"><span class='Ref_To_Local'>te</span></a> <span class='Operator'>= </span><a href="../../include/nodes/makefuncs.h.html#LN40"><span class='Ref_to_Proto'>makeTargetEntry</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/primnodes.h.html#LN131"><span class='Ref_to_Struct'>Expr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_relation.c.html#LN2604"><span class='Ref_To_Local'>varnode</span></a><span class='Delimiter'>, 
</span>                             <span class='Parentheses'>(</span><a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><a href="parse_relation.c.html#LN2582"><span class='Ref_to_Parameter'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN183"><span class='Ref_to_Member'>p_next_resno</span></a><span class='Operator'>++</span><span class='Delimiter'>, 
</span>                             <a href="parse_relation.c.html#LN2603"><span class='Ref_To_Local'>label</span></a><span class='Delimiter'>, 
</span>                             <span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_relation.c.html#LN2589"><span class='Ref_To_Local'>te_list</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2589"><span class='Ref_To_Local'>te_list</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2605"><span class='Ref_To_Local'>te</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Require read access to each column */ 
</span>        <a href="../../include/parser/parse_relation.h.html#LN60"><span class='Ref_to_Proto'>markVarForSelectPriv</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2582"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2604"><span class='Ref_To_Local'>varnode</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2582"><span class='Ref_to_Parameter'>rte</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2587"><span class='Ref_To_Local'>name</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="parse_relation.c.html#LN2588"><span class='Ref_To_Local'>var</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* lists not the same length? */ 
</span> 
    <span class='Control'>return</span> <a href="parse_relation.c.html#LN2589"><span class='Ref_To_Local'>te_list</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end expandRelAttrs &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * get_rte_attribute_name 
 *      Get an attribute name from a RangeTblEntry 
 * 
 * This is unlike get_attname() because we use aliases if available. 
 * In particular, it will work on an RTE for a subselect or join, whereas 
 * get_attname() only works on real relations. 
 * 
 * "*" is returned if the given attnum is InvalidAttrNumber --- this case 
 * occurs when a Var represents a whole tuple of a relation. 
 */ 
</span><span class='Keyword'>char </span><span class='Operator'>* 
</span><a name="LN2634"></a><span class='Declare_Function'>get_rte_attribute_name</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rte</span><span class='Delimiter'>, </span><a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Declare_Parameter'>attnum</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2634"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>== </span><a href="../../include/access/attnum.h.html#LN22"><span class='Ref_to_Const'>InvalidAttrNumber</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='String'>"*"</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If there is a user-written column alias, use it. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2634"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1022"><span class='Ref_to_Member'>alias</span></a> <span class='Operator'>&& 
</span>        <a href="parse_relation.c.html#LN2634"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="parse_relation.c.html#LN2634"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>&LT;= </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2634"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1022"><span class='Ref_to_Member'>alias</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN223"><span class='Ref_to_Proto'>list_nth</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2634"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1022"><span class='Ref_to_Member'>alias</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2634"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If the RTE is a relation, go to the system catalogs not the 
     * eref-&GT;colnames list.  This is a little slower but it will give the 
     * right answer if the column has been renamed since the eref list was 
     * built (which can easily happen for rules). 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2634"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN922"><span class='Ref_to_EnumConst'>RTE_RELATION</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="../../include/utils/lsyscache.h.html#LN86"><span class='Ref_to_Proto'>get_relid_attribute_name</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2634"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN947"><span class='Ref_to_Member'>relid</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2634"><span class='Ref_to_Parameter'>attnum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Otherwise use the column name from eref.  There should always be one. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2634"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="parse_relation.c.html#LN2634"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>&LT;= </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2634"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN223"><span class='Ref_to_Proto'>list_nth</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2634"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2634"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* else caller gave us a bogus attnum */ 
</span>    <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"invalid attnum %d for rangetable entry %s"</span><span class='Delimiter'>, 
</span>         <a href="parse_relation.c.html#LN2634"><span class='Ref_to_Parameter'>attnum</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2634"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span><span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end get_rte_attribute_name &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * get_rte_attribute_type 
 *      Get attribute type/typmod/collation information from a RangeTblEntry 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN2672"></a><span class='Declare_Function'>get_rte_attribute_type</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rte</span><span class='Delimiter'>, </span><a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Declare_Parameter'>attnum</span><span class='Delimiter'>, 
</span><a name="LN2673"></a>                       <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>vartype</span><span class='Delimiter'>, </span><a href="../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>vartypmod</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>varcollid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN922"><span class='Ref_to_EnumConst'>RTE_RELATION</span></a><span class='Operator'>: 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Plain relation RTE --- get the attribute's type info */ 
</span><a name="LN2680"></a>                <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tp</span><span class='Delimiter'>; 
</span><a name="LN2681"></a>                <a href="../../include/catalog/pg_attribute.h.html#LN186"><span class='Ref_to_Typedef'>Form_pg_attribute</span></a> <span class='Declare_Local'>att_tup</span><span class='Delimiter'>; 
</span> 
                <a href="parse_relation.c.html#LN2680"><span class='Ref_To_Local'>tp</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN157"><span class='Ref_to_Macro'>SearchSysCache2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN40"><span class='Ref_to_EnumConst'>ATTNUM</span></a><span class='Delimiter'>, 
</span>                                     <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN947"><span class='Ref_to_Member'>relid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                     <a href="../../include/postgres.h.html#LN456"><span class='Ref_to_Macro'>Int16GetDatum</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>attnum</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2680"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>))</span>      <span class='Comment_Single_Line'>/* shouldn't happen */ 
</span>                    <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for attribute %d of relation %u"</span><span class='Delimiter'>, 
</span>                         <a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>attnum</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN947"><span class='Ref_to_Member'>relid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="parse_relation.c.html#LN2681"><span class='Ref_To_Local'>att_tup</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_attribute.h.html#LN186"><span class='Ref_to_Typedef'>Form_pg_attribute</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2680"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* 
                 * If dropped column, pretend it ain't there.  See notes in 
                 * scanRTEForColumn. 
                 */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2681"><span class='Ref_To_Local'>att_tup</span></a><span class='Operator'>-&GT;</span>attisdropped<span class='Parentheses'>) 
</span>                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_COLUMN<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                    <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"column \"%s\" of relation \"%s\" does not exist"</span><span class='Delimiter'>, 
</span>                           <a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2681"><span class='Ref_To_Local'>att_tup</span></a><span class='Operator'>-&GT;</span>attname<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                           <a href="../../include/utils/lsyscache.h.html#LN124"><span class='Ref_to_Proto'>get_rel_name</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN947"><span class='Ref_to_Member'>relid</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>                <span class='Operator'>*</span><a href="parse_relation.c.html#LN2673"><span class='Ref_to_Parameter'>vartype</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN2681"><span class='Ref_To_Local'>att_tup</span></a><span class='Operator'>-&GT;</span>atttypid<span class='Delimiter'>; 
</span>                <span class='Operator'>*</span><a href="parse_relation.c.html#LN2673"><span class='Ref_to_Parameter'>vartypmod</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN2681"><span class='Ref_To_Local'>att_tup</span></a><span class='Operator'>-&GT;</span>atttypmod<span class='Delimiter'>; 
</span>                <span class='Operator'>*</span><a href="parse_relation.c.html#LN2673"><span class='Ref_to_Parameter'>varcollid</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN2681"><span class='Ref_To_Local'>att_tup</span></a><span class='Operator'>-&GT;</span>attcollation<span class='Delimiter'>; 
</span>                <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2680"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN923"><span class='Ref_to_EnumConst'>RTE_SUBQUERY</span></a><span class='Operator'>: 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Subselect RTE --- get type info from subselect's tlist */ 
</span><a name="LN2710"></a>                <a href="../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>te</span> <span class='Operator'>= </span><a href="../../include/parser/parsetree.h.html#LN69"><span class='Ref_to_Proto'>get_tle_by_resno</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN954"><span class='Ref_to_Member'>subquery</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN137"><span class='Ref_to_Member'>targetList</span></a><span class='Delimiter'>, 
</span>                                                   <a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>attnum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2710"><span class='Ref_To_Local'>te</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span><a href="parse_relation.c.html#LN2710"><span class='Ref_To_Local'>te</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1373"><span class='Ref_to_Member'>resjunk</span></a><span class='Parentheses'>) 
</span>                    <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"subquery %s does not have attribute %d"</span><span class='Delimiter'>, 
</span>                         <a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>attnum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Operator'>*</span><a href="parse_relation.c.html#LN2673"><span class='Ref_to_Parameter'>vartype</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodeFuncs.h.html#LN31"><span class='Ref_to_Proto'>exprType</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_relation.c.html#LN2710"><span class='Ref_To_Local'>te</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1366"><span class='Ref_to_Member'>expr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Operator'>*</span><a href="parse_relation.c.html#LN2673"><span class='Ref_to_Parameter'>vartypmod</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodeFuncs.h.html#LN32"><span class='Ref_to_Proto'>exprTypmod</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_relation.c.html#LN2710"><span class='Ref_To_Local'>te</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1366"><span class='Ref_to_Member'>expr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Operator'>*</span><a href="parse_relation.c.html#LN2673"><span class='Ref_to_Parameter'>varcollid</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodeFuncs.h.html#LN38"><span class='Ref_to_Proto'>exprCollation</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_relation.c.html#LN2710"><span class='Ref_To_Local'>te</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1366"><span class='Ref_to_Member'>expr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN925"><span class='Ref_to_EnumConst'>RTE_FUNCTION</span></a><span class='Operator'>: 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Function RTE */ 
</span><a name="LN2724"></a>                <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span><a name="LN2725"></a>                <span class='Keyword'>int</span>         <span class='Declare_Local'>atts_done</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* Identify which function covers the requested column */ 
</span>                <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2724"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN985"><span class='Ref_to_Member'>functions</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span><a name="LN2730"></a>                    <a href="../../include/nodes/parsenodes.h.html#LN1051"><span class='Ref_to_Struct'>RangeTblFunction</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rtfunc</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN1051"><span class='Ref_to_Struct'>RangeTblFunction</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2724"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>&GT; </span><a href="parse_relation.c.html#LN2725"><span class='Ref_To_Local'>atts_done</span></a> <span class='Operator'>&& 
</span>                        <a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>&LT;= </span><a href="parse_relation.c.html#LN2725"><span class='Ref_To_Local'>atts_done</span></a> <span class='Operator'>+ </span><a href="parse_relation.c.html#LN2730"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1056"><span class='Ref_to_Member'>funccolcount</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span><a name="LN2735"></a>                        <a href="../../include/funcapi.h.html#LN149"><span class='Ref_to_Enum'>TypeFuncClass</span></a> <span class='Declare_Local'>functypclass</span><span class='Delimiter'>; 
</span><a name="LN2736"></a>                        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>funcrettype</span><span class='Delimiter'>; 
</span><a name="LN2737"></a>                        <a href="../../include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a>   <span class='Declare_Local'>tupdesc</span><span class='Delimiter'>; 
</span> 
                        <a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>-= </span><a href="parse_relation.c.html#LN2725"><span class='Ref_To_Local'>atts_done</span></a><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* now relative to this func */ 
</span>                        <a href="parse_relation.c.html#LN2735"><span class='Ref_To_Local'>functypclass</span></a> <span class='Operator'>= </span><a href="../../include/funcapi.h.html#LN160"><span class='Ref_to_Proto'>get_expr_result_type</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2730"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1055"><span class='Ref_to_Member'>funcexpr</span></a><span class='Delimiter'>, 
</span>                                                            <span class='Operator'>&</span><a href="parse_relation.c.html#LN2736"><span class='Ref_To_Local'>funcrettype</span></a><span class='Delimiter'>, 
</span>                                                            <span class='Operator'>&</span><a href="parse_relation.c.html#LN2737"><span class='Ref_To_Local'>tupdesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2735"><span class='Ref_To_Local'>functypclass</span></a> <span class='Operator'>== </span><a href="../../include/funcapi.h.html#LN152"><span class='Ref_to_EnumConst'>TYPEFUNC_COMPOSITE</span></a><span class='Parentheses'>) 
</span>                        <span class='Delimiter'>{ 
</span>                            <span class='Comment_Multi_Line'>/* Composite data type, e.g. a table's row type */ 
</span><a name="LN2747"></a>                            <a href="../../include/catalog/pg_attribute.h.html#LN186"><span class='Ref_to_Typedef'>Form_pg_attribute</span></a> <span class='Declare_Local'>att_tup</span><span class='Delimiter'>; 
</span> 
                            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2737"><span class='Ref_To_Local'>tupdesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>&LT;= </span><a href="parse_relation.c.html#LN2737"><span class='Ref_To_Local'>tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                            <a href="parse_relation.c.html#LN2747"><span class='Ref_To_Local'>att_tup</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN2737"><span class='Ref_To_Local'>tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN73"><span class='Ref_to_Member'>attrs</span></a><span class='Delimiter'>[</span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span> 
                            <span class='Comment_Multi_Line'>/* 
                             * If dropped column, pretend it ain't there.  See 
                             * notes in scanRTEForColumn. 
                             */ 
</span>                            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2747"><span class='Ref_To_Local'>att_tup</span></a><span class='Operator'>-&GT;</span>attisdropped<span class='Parentheses'>) 
</span>                                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_COLUMN<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"column \"%s\" of relation \"%s\" does not exist"</span><span class='Delimiter'>, 
</span>                                                <a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2747"><span class='Ref_To_Local'>att_tup</span></a><span class='Operator'>-&GT;</span>attname<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                                <a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                            <span class='Operator'>*</span><a href="parse_relation.c.html#LN2673"><span class='Ref_to_Parameter'>vartype</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN2747"><span class='Ref_To_Local'>att_tup</span></a><span class='Operator'>-&GT;</span>atttypid<span class='Delimiter'>; 
</span>                            <span class='Operator'>*</span><a href="parse_relation.c.html#LN2673"><span class='Ref_to_Parameter'>vartypmod</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN2747"><span class='Ref_To_Local'>att_tup</span></a><span class='Operator'>-&GT;</span>atttypmod<span class='Delimiter'>; 
</span>                            <span class='Operator'>*</span><a href="parse_relation.c.html#LN2673"><span class='Ref_to_Parameter'>varcollid</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN2747"><span class='Ref_To_Local'>att_tup</span></a><span class='Operator'>-&GT;</span>attcollation<span class='Delimiter'>; 
</span>                        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if functypclass==TYPEFUN... &raquo; </span> 
                        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2735"><span class='Ref_To_Local'>functypclass</span></a> <span class='Operator'>== </span><a href="../../include/funcapi.h.html#LN151"><span class='Ref_to_EnumConst'>TYPEFUNC_SCALAR</span></a><span class='Parentheses'>) 
</span>                        <span class='Delimiter'>{ 
</span>                            <span class='Comment_Multi_Line'>/* Base data type, i.e. scalar */ 
</span>                            <span class='Operator'>*</span><a href="parse_relation.c.html#LN2673"><span class='Ref_to_Parameter'>vartype</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN2736"><span class='Ref_To_Local'>funcrettype</span></a><span class='Delimiter'>; 
</span>                            <span class='Operator'>*</span><a href="parse_relation.c.html#LN2673"><span class='Ref_to_Parameter'>vartypmod</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                            <span class='Operator'>*</span><a href="parse_relation.c.html#LN2673"><span class='Ref_to_Parameter'>varcollid</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodeFuncs.h.html#LN38"><span class='Ref_to_Proto'>exprCollation</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2730"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1055"><span class='Ref_to_Member'>funcexpr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                        <span class='Delimiter'>} 
</span>                        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2735"><span class='Ref_To_Local'>functypclass</span></a> <span class='Operator'>== </span><a href="../../include/funcapi.h.html#LN153"><span class='Ref_to_EnumConst'>TYPEFUNC_RECORD</span></a><span class='Parentheses'>) 
</span>                        <span class='Delimiter'>{ 
</span>                            <span class='Operator'>*</span><a href="parse_relation.c.html#LN2673"><span class='Ref_to_Parameter'>vartype</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN225"><span class='Ref_to_Proto'>list_nth_oid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2730"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1059"><span class='Ref_to_Member'>funccoltypes</span></a><span class='Delimiter'>, 
</span>                                                    <a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                            <span class='Operator'>*</span><a href="parse_relation.c.html#LN2673"><span class='Ref_to_Parameter'>vartypmod</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN224"><span class='Ref_to_Proto'>list_nth_int</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2730"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1060"><span class='Ref_to_Member'>funccoltypmods</span></a><span class='Delimiter'>, 
</span>                                                      <a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                            <span class='Operator'>*</span><a href="parse_relation.c.html#LN2673"><span class='Ref_to_Parameter'>varcollid</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN225"><span class='Ref_to_Proto'>list_nth_oid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2730"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1061"><span class='Ref_to_Member'>funccolcollations</span></a><span class='Delimiter'>, 
</span>                                                      <a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                        <span class='Delimiter'>} 
</span>                        <span class='Control'>else</span> 
                        <span class='Delimiter'>{ 
</span>                            <span class='Comment_Multi_Line'>/* 
                             * addRangeTableEntryForFunction should've caught 
                             * this 
                             */ 
</span>                            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"function in FROM has unsupported return type"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                        <span class='Delimiter'>} 
</span>                        <span class='Control'>return</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if attnum&GT;atts_done&&att... &raquo; </span> 
                    <a href="parse_relation.c.html#LN2725"><span class='Ref_To_Local'>atts_done</span></a> <span class='Operator'>+= </span><a href="parse_relation.c.html#LN2730"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1056"><span class='Ref_to_Member'>funccolcount</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span> 
                <span class='Comment_Multi_Line'>/* If we get here, must be looking for the ordinality column */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN986"><span class='Ref_to_Member'>funcordinality</span></a> <span class='Operator'>&& </span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>== </span><a href="parse_relation.c.html#LN2725"><span class='Ref_To_Local'>atts_done</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Operator'>*</span><a href="parse_relation.c.html#LN2673"><span class='Ref_to_Parameter'>vartype</span></a> <span class='Operator'>= </span><a href="../../interfaces/ecpg/ecpglib/pg_type.h.html#LN21"><span class='Ref_to_Const'>INT8OID</span></a><span class='Delimiter'>; 
</span>                    <span class='Operator'>*</span><a href="parse_relation.c.html#LN2673"><span class='Ref_to_Parameter'>vartypmod</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                    <span class='Operator'>*</span><a href="parse_relation.c.html#LN2673"><span class='Ref_to_Parameter'>varcollid</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>return</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span> 
                <span class='Comment_Multi_Line'>/* this probably can't happen ... */ 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_COLUMN<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"column %d of relation \"%s\" does not exist"</span><span class='Delimiter'>, 
</span>                                <a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>attnum</span></a><span class='Delimiter'>, 
</span>                                <a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN924"><span class='Ref_to_EnumConst'>RTE_JOIN</span></a><span class='Operator'>: 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* 
                 * Join RTE --- get type info from join RTE's alias variable 
                 */ 
</span><a name="LN2818"></a>                <a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>aliasvar</span><span class='Delimiter'>; 
</span> 
                <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>&LT;= </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN975"><span class='Ref_to_Member'>joinaliasvars</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <a href="parse_relation.c.html#LN2818"><span class='Ref_To_Local'>aliasvar</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN223"><span class='Ref_to_Proto'>list_nth</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN975"><span class='Ref_to_Member'>joinaliasvars</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2818"><span class='Ref_To_Local'>aliasvar</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Operator'>*</span><a href="parse_relation.c.html#LN2673"><span class='Ref_to_Parameter'>vartype</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodeFuncs.h.html#LN31"><span class='Ref_to_Proto'>exprType</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2818"><span class='Ref_To_Local'>aliasvar</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Operator'>*</span><a href="parse_relation.c.html#LN2673"><span class='Ref_to_Parameter'>vartypmod</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodeFuncs.h.html#LN32"><span class='Ref_to_Proto'>exprTypmod</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2818"><span class='Ref_To_Local'>aliasvar</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Operator'>*</span><a href="parse_relation.c.html#LN2673"><span class='Ref_to_Parameter'>varcollid</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodeFuncs.h.html#LN38"><span class='Ref_to_Proto'>exprCollation</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2818"><span class='Ref_To_Local'>aliasvar</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN926"><span class='Ref_to_EnumConst'>RTE_TABLEFUNC</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN927"><span class='Ref_to_EnumConst'>RTE_VALUES</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN928"><span class='Ref_to_EnumConst'>RTE_CTE</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN929"><span class='Ref_to_EnumConst'>RTE_NAMEDTUPLESTORE</span></a><span class='Operator'>: 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* 
                 * tablefunc, VALUES or CTE RTE --- get type info from lists 
                 * in the RTE 
                 */ 
</span>                <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>&LT;= </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1012"><span class='Ref_to_Member'>coltypes</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <span class='Operator'>*</span><a href="parse_relation.c.html#LN2673"><span class='Ref_to_Parameter'>vartype</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN225"><span class='Ref_to_Proto'>list_nth_oid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1012"><span class='Ref_to_Member'>coltypes</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Operator'>*</span><a href="parse_relation.c.html#LN2673"><span class='Ref_to_Parameter'>vartypmod</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN224"><span class='Ref_to_Proto'>list_nth_int</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1013"><span class='Ref_to_Member'>coltypmods</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Operator'>*</span><a href="parse_relation.c.html#LN2673"><span class='Ref_to_Parameter'>varcollid</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN225"><span class='Ref_to_Proto'>list_nth_oid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1014"><span class='Ref_to_Member'>colcollations</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized RTE kind: %d"</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="parse_relation.c.html#LN2672"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch rte-&GT;rtekind &raquo; </span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end get_rte_attribute_type &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * get_rte_attribute_is_dropped 
 *      Check whether attempted attribute ref is to a dropped column 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN2853"></a><span class='Declare_Function'>get_rte_attribute_is_dropped</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rte</span><span class='Delimiter'>, </span><a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Declare_Parameter'>attnum</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2855"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2853"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN922"><span class='Ref_to_EnumConst'>RTE_RELATION</span></a><span class='Operator'>: 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* 
                 * Plain relation RTE --- get the attribute's catalog entry 
                 */ 
</span><a name="LN2864"></a>                <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tp</span><span class='Delimiter'>; 
</span><a name="LN2865"></a>                <a href="../../include/catalog/pg_attribute.h.html#LN186"><span class='Ref_to_Typedef'>Form_pg_attribute</span></a> <span class='Declare_Local'>att_tup</span><span class='Delimiter'>; 
</span> 
                <a href="parse_relation.c.html#LN2864"><span class='Ref_To_Local'>tp</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN157"><span class='Ref_to_Macro'>SearchSysCache2</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN40"><span class='Ref_to_EnumConst'>ATTNUM</span></a><span class='Delimiter'>, 
</span>                                     <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2853"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN947"><span class='Ref_to_Member'>relid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                     <a href="../../include/postgres.h.html#LN456"><span class='Ref_to_Macro'>Int16GetDatum</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2853"><span class='Ref_to_Parameter'>attnum</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2864"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>))</span>      <span class='Comment_Single_Line'>/* shouldn't happen */ 
</span>                    <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for attribute %d of relation %u"</span><span class='Delimiter'>, 
</span>                         <a href="parse_relation.c.html#LN2853"><span class='Ref_to_Parameter'>attnum</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2853"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN947"><span class='Ref_to_Member'>relid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="parse_relation.c.html#LN2865"><span class='Ref_To_Local'>att_tup</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_attribute.h.html#LN186"><span class='Ref_to_Typedef'>Form_pg_attribute</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2864"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="parse_relation.c.html#LN2855"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN2865"><span class='Ref_To_Local'>att_tup</span></a><span class='Operator'>-&GT;</span>attisdropped<span class='Delimiter'>; 
</span>                <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2864"><span class='Ref_To_Local'>tp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN923"><span class='Ref_to_EnumConst'>RTE_SUBQUERY</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN926"><span class='Ref_to_EnumConst'>RTE_TABLEFUNC</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN927"><span class='Ref_to_EnumConst'>RTE_VALUES</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN928"><span class='Ref_to_EnumConst'>RTE_CTE</span></a><span class='Operator'>: 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Subselect, Table Functions, Values, CTE RTEs never have dropped 
             * columns 
             */ 
</span>            <a href="parse_relation.c.html#LN2855"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN929"><span class='Ref_to_EnumConst'>RTE_NAMEDTUPLESTORE</span></a><span class='Operator'>: 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2853"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1016"><span class='Ref_to_Member'>enrname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* 
                 * We checked when we loaded coltypes for the tuplestore that 
                 * InvalidOid was only used for dropped columns, so it is safe 
                 * to count on that here. 
                 */ 
</span>                <a href="parse_relation.c.html#LN2855"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= 
</span>                    <span class='Parentheses'>((</span><a href="../../include/nodes/pg_list.h.html#LN225"><span class='Ref_to_Proto'>list_nth_oid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2853"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1012"><span class='Ref_to_Member'>coltypes</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2853"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN924"><span class='Ref_to_EnumConst'>RTE_JOIN</span></a><span class='Operator'>: 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* 
                 * A join RTE would not have dropped columns when constructed, 
                 * but one in a stored rule might contain columns that were 
                 * dropped from the underlying tables, if said columns are 
                 * nowhere explicitly referenced in the rule.  This will be 
                 * signaled to us by a null pointer in the joinaliasvars list. 
                 */ 
</span><a name="LN2911"></a>                <a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>aliasvar</span><span class='Delimiter'>; 
</span> 
                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2853"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>                    <a href="parse_relation.c.html#LN2853"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>&GT; </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2853"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN975"><span class='Ref_to_Member'>joinaliasvars</span></a><span class='Parentheses'>))</span> 
                    <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"invalid varattno %d"</span><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2853"><span class='Ref_to_Parameter'>attnum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="parse_relation.c.html#LN2911"><span class='Ref_To_Local'>aliasvar</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN223"><span class='Ref_to_Proto'>list_nth</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2853"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN975"><span class='Ref_to_Member'>joinaliasvars</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2853"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <a href="parse_relation.c.html#LN2855"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2911"><span class='Ref_To_Local'>aliasvar</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN925"><span class='Ref_to_EnumConst'>RTE_FUNCTION</span></a><span class='Operator'>: 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Function RTE */ 
</span><a name="LN2924"></a>                <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span><a name="LN2925"></a>                <span class='Keyword'>int</span>         <span class='Declare_Local'>atts_done</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* 
                 * Dropped attributes are only possible with functions that 
                 * return named composite types.  In such a case we have to 
                 * look up the result type to see if it currently has this 
                 * column dropped.  So first, loop over the funcs until we 
                 * find the one that covers the requested column. 
                 */ 
</span>                <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2924"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2853"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN985"><span class='Ref_to_Member'>functions</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span><a name="LN2936"></a>                    <a href="../../include/nodes/parsenodes.h.html#LN1051"><span class='Ref_to_Struct'>RangeTblFunction</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rtfunc</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN1051"><span class='Ref_to_Struct'>RangeTblFunction</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2924"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2853"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>&GT; </span><a href="parse_relation.c.html#LN2925"><span class='Ref_To_Local'>atts_done</span></a> <span class='Operator'>&& 
</span>                        <a href="parse_relation.c.html#LN2853"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>&LT;= </span><a href="parse_relation.c.html#LN2925"><span class='Ref_To_Local'>atts_done</span></a> <span class='Operator'>+ </span><a href="parse_relation.c.html#LN2936"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1056"><span class='Ref_to_Member'>funccolcount</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span><a name="LN2941"></a>                        <a href="../../include/funcapi.h.html#LN149"><span class='Ref_to_Enum'>TypeFuncClass</span></a> <span class='Declare_Local'>functypclass</span><span class='Delimiter'>; 
</span><a name="LN2942"></a>                        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>funcrettype</span><span class='Delimiter'>; 
</span><a name="LN2943"></a>                        <a href="../../include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a>   <span class='Declare_Local'>tupdesc</span><span class='Delimiter'>; 
</span> 
                        <a href="parse_relation.c.html#LN2941"><span class='Ref_To_Local'>functypclass</span></a> <span class='Operator'>= </span><a href="../../include/funcapi.h.html#LN160"><span class='Ref_to_Proto'>get_expr_result_type</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2936"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1055"><span class='Ref_to_Member'>funcexpr</span></a><span class='Delimiter'>, 
</span>                                                            <span class='Operator'>&</span><a href="parse_relation.c.html#LN2942"><span class='Ref_To_Local'>funcrettype</span></a><span class='Delimiter'>, 
</span>                                                            <span class='Operator'>&</span><a href="parse_relation.c.html#LN2943"><span class='Ref_To_Local'>tupdesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2941"><span class='Ref_To_Local'>functypclass</span></a> <span class='Operator'>== </span><a href="../../include/funcapi.h.html#LN152"><span class='Ref_to_EnumConst'>TYPEFUNC_COMPOSITE</span></a><span class='Parentheses'>) 
</span>                        <span class='Delimiter'>{ 
</span>                            <span class='Comment_Multi_Line'>/* Composite data type, e.g. a table's row type */ 
</span><a name="LN2951"></a>                            <a href="../../include/catalog/pg_attribute.h.html#LN186"><span class='Ref_to_Typedef'>Form_pg_attribute</span></a> <span class='Declare_Local'>att_tup</span><span class='Delimiter'>; 
</span> 
                            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2943"><span class='Ref_To_Local'>tupdesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2853"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>- </span><a href="parse_relation.c.html#LN2925"><span class='Ref_To_Local'>atts_done</span></a> <span class='Operator'>&LT;= </span><a href="parse_relation.c.html#LN2943"><span class='Ref_To_Local'>tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                            <a href="parse_relation.c.html#LN2951"><span class='Ref_To_Local'>att_tup</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN2943"><span class='Ref_To_Local'>tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN73"><span class='Ref_to_Member'>attrs</span></a><span class='Delimiter'>[</span><a href="parse_relation.c.html#LN2853"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>- </span><a href="parse_relation.c.html#LN2925"><span class='Ref_To_Local'>atts_done</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span>                            <span class='Control'>return</span> <a href="parse_relation.c.html#LN2951"><span class='Ref_To_Local'>att_tup</span></a><span class='Operator'>-&GT;</span>attisdropped<span class='Delimiter'>; 
</span>                        <span class='Delimiter'>} 
</span>                        <span class='Comment_Multi_Line'>/* Otherwise, it can't have any dropped columns */ 
</span>                        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if attnum&GT;atts_done&&att... &raquo; </span> 
                    <a href="parse_relation.c.html#LN2925"><span class='Ref_To_Local'>atts_done</span></a> <span class='Operator'>+= </span><a href="parse_relation.c.html#LN2936"><span class='Ref_To_Local'>rtfunc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1056"><span class='Ref_to_Member'>funccolcount</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span> 
                <span class='Comment_Multi_Line'>/* If we get here, must be looking for the ordinality column */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2853"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN986"><span class='Ref_to_Member'>funcordinality</span></a> <span class='Operator'>&& </span><a href="parse_relation.c.html#LN2853"><span class='Ref_to_Parameter'>attnum</span></a> <span class='Operator'>== </span><a href="parse_relation.c.html#LN2925"><span class='Ref_To_Local'>atts_done</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>                    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* this probably can't happen ... */ 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_COLUMN<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"column %d of relation \"%s\" does not exist"</span><span class='Delimiter'>, 
</span>                                <a href="parse_relation.c.html#LN2853"><span class='Ref_to_Parameter'>attnum</span></a><span class='Delimiter'>, 
</span>                                <a href="parse_relation.c.html#LN2853"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <a href="parse_relation.c.html#LN2855"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; </span><span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized RTE kind: %d"</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="parse_relation.c.html#LN2853"><span class='Ref_to_Parameter'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_relation.c.html#LN2855"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch rte-&GT;rtekind &raquo; </span> 
 
    <span class='Control'>return</span> <a href="parse_relation.c.html#LN2855"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end get_rte_attribute_is_dropped &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Given a targetlist and a resno, return the matching TargetEntry 
 * 
 * Returns NULL if resno is not present in list. 
 * 
 * Note: we need to search, rather than just indexing with list_nth(), 
 * because not all tlists are sorted by resno. 
 */ 
</span><a href="../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>* 
</span><a name="LN2994"></a><span class='Declare_Function'>get_tle_by_resno</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tlist</span><span class='Delimiter'>, </span><a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Declare_Parameter'>resno</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2996"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2996"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN2994"><span class='Ref_to_Parameter'>tlist</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3000"></a>        <a href="../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>tle</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN2996"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3000"><span class='Ref_To_Local'>tle</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1367"><span class='Ref_to_Member'>resno</span></a> <span class='Operator'>== </span><a href="parse_relation.c.html#LN2994"><span class='Ref_to_Parameter'>resno</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <a href="parse_relation.c.html#LN3000"><span class='Ref_To_Local'>tle</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Given a Query and rangetable index, return relation's RowMarkClause if any 
 * 
 * Returns NULL if relation is not selected FOR UPDATE/SHARE 
 */ 
</span><a href="../../include/nodes/parsenodes.h.html#LN1278"><span class='Ref_to_Struct'>RowMarkClause</span></a> <span class='Operator'>* 
</span><a name="LN3014"></a><span class='Declare_Function'>get_parse_rowmark</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qry</span><span class='Delimiter'>, </span><a href="../../include/c.h.html#LN364"><span class='Ref_to_Typedef'>Index</span></a> <span class='Declare_Parameter'>rtindex</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3016"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3016"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3014"><span class='Ref_to_Parameter'>qry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN160"><span class='Ref_to_Member'>rowMarks</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3020"></a>        <a href="../../include/nodes/parsenodes.h.html#LN1278"><span class='Ref_to_Struct'>RowMarkClause</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rc</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN1278"><span class='Ref_to_Struct'>RowMarkClause</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3016"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3020"><span class='Ref_To_Local'>rc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1281"><span class='Ref_to_Member'>rti</span></a> <span class='Operator'>== </span><a href="parse_relation.c.html#LN3014"><span class='Ref_to_Parameter'>rtindex</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <a href="parse_relation.c.html#LN3020"><span class='Ref_To_Local'>rc</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 *  given relation and att name, return attnum of variable 
 * 
 *  Returns InvalidAttrNumber if the attr doesn't exist (or is dropped). 
 * 
 *  This should only be used if the relation is already 
 *  heap_open()'ed.  Use the cache version get_attnum() 
 *  for access to non-opened relations. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN3038"></a><span class='Declare_Function'>attnameAttNum</span><span class='Parentheses'>(</span><a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a> <span class='Declare_Parameter'>rd</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>attname</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>sysColOK</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3040"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3040"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="parse_relation.c.html#LN3040"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="parse_relation.c.html#LN3038"><span class='Ref_to_Parameter'>rd</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relnatts<span class='Delimiter'>; </span><a href="parse_relation.c.html#LN3040"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3044"></a>        <a href="../../include/catalog/pg_attribute.h.html#LN186"><span class='Ref_to_Typedef'>Form_pg_attribute</span></a> <span class='Declare_Local'>att</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN3038"><span class='Ref_to_Parameter'>rd</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN114"><span class='Ref_to_Member'>rd_att</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN73"><span class='Ref_to_Member'>attrs</span></a><span class='Delimiter'>[</span><a href="parse_relation.c.html#LN3040"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/utils/builtins.h.html#LN41"><span class='Ref_to_Proto'>namestrcmp</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3044"><span class='Ref_To_Local'>att</span></a><span class='Operator'>-&GT;</span>attname<span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3038"><span class='Ref_to_Parameter'>attname</span></a><span class='Parentheses'>)</span> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>&& !</span><a href="parse_relation.c.html#LN3044"><span class='Ref_To_Local'>att</span></a><span class='Operator'>-&GT;</span>attisdropped<span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <a href="parse_relation.c.html#LN3040"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3038"><span class='Ref_to_Parameter'>sysColOK</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="parse_relation.c.html#LN3040"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN56"><span class='Ref_to_Proto'>specialAttNum</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3038"><span class='Ref_to_Parameter'>attname</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><a href="../../include/access/attnum.h.html#LN22"><span class='Ref_to_Const'>InvalidAttrNumber</span></a><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3040"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>!= </span><a href="../../include/access/sysattr.h.html#LN21"><span class='Ref_to_Const'>ObjectIdAttributeNumber</span></a> <span class='Operator'>|| </span><a href="parse_relation.c.html#LN3038"><span class='Ref_to_Parameter'>rd</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relhasoids<span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <a href="parse_relation.c.html#LN3040"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* on failure */ 
</span>    <span class='Control'>return</span> <a href="../../include/access/attnum.h.html#LN22"><span class='Ref_to_Const'>InvalidAttrNumber</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end attnameAttNum &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* specialAttNum() 
 * 
 * Check attribute name to see if it is "special", e.g. "oid". 
 * - thomas 2000-02-07 
 * 
 * Note: this only discovers whether the name could be a system attribute. 
 * Caller needs to verify that it really is an attribute of the rel, 
 * at least in the case of "oid", which is now optional. 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN3073"></a><span class='Declare_Function'>specialAttNum</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>attname</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3075"></a>    <a href="../../include/catalog/pg_attribute.h.html#LN186"><span class='Ref_to_Typedef'>Form_pg_attribute</span></a> <span class='Declare_Local'>sysatt</span><span class='Delimiter'>; 
</span> 
    <a href="parse_relation.c.html#LN3075"><span class='Ref_To_Local'>sysatt</span></a> <span class='Operator'>= </span><a href="../../include/catalog/heap.h.html#LN125"><span class='Ref_to_Proto'>SystemAttributeByName</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3073"><span class='Ref_to_Parameter'>attname</span></a><span class='Delimiter'>, 
</span>                                   <span class='Boolean'>true </span><span class='Comment_Multi_Line'>/* "oid" will be accepted */ </span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3075"><span class='Ref_To_Local'>sysatt</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="parse_relation.c.html#LN3075"><span class='Ref_To_Local'>sysatt</span></a><span class='Operator'>-&GT;</span>attnum<span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="../../include/access/attnum.h.html#LN22"><span class='Ref_to_Const'>InvalidAttrNumber</span></a><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * given attribute id, return name of that attribute 
 * 
 *  This should only be used if the relation is already 
 *  heap_open()'ed.  Use the cache version get_atttype() 
 *  for access to non-opened relations. 
 */ 
</span><a href="../../include/c.h.html#LN496"><span class='Ref_to_Typedef'>Name</span></a> 
<a name="LN3093"></a><span class='Declare_Function'>attnumAttName</span><span class='Parentheses'>(</span><a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a> <span class='Declare_Parameter'>rd</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>attid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3093"><span class='Ref_to_Parameter'>attid</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3097"></a>        <a href="../../include/catalog/pg_attribute.h.html#LN186"><span class='Ref_to_Typedef'>Form_pg_attribute</span></a> <span class='Declare_Local'>sysatt</span><span class='Delimiter'>; 
</span> 
        <a href="parse_relation.c.html#LN3097"><span class='Ref_To_Local'>sysatt</span></a> <span class='Operator'>= </span><a href="../../include/catalog/heap.h.html#LN122"><span class='Ref_to_Proto'>SystemAttributeDefinition</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3093"><span class='Ref_to_Parameter'>attid</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3093"><span class='Ref_to_Parameter'>rd</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relhasoids<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>&</span><a href="parse_relation.c.html#LN3097"><span class='Ref_To_Local'>sysatt</span></a><span class='Operator'>-&GT;</span>attname<span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3093"><span class='Ref_to_Parameter'>attid</span></a> <span class='Operator'>&GT; </span><a href="parse_relation.c.html#LN3093"><span class='Ref_to_Parameter'>rd</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN114"><span class='Ref_to_Member'>rd_att</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Parentheses'>) 
</span>        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"invalid attribute number %d"</span><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3093"><span class='Ref_to_Parameter'>attid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Operator'>&</span><a href="parse_relation.c.html#LN3093"><span class='Ref_to_Parameter'>rd</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN114"><span class='Ref_to_Member'>rd_att</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN73"><span class='Ref_to_Member'>attrs</span></a><span class='Delimiter'>[</span><a href="parse_relation.c.html#LN3093"><span class='Ref_to_Parameter'>attid</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span>attname<span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * given attribute id, return type of that attribute 
 * 
 *  This should only be used if the relation is already 
 *  heap_open()'ed.  Use the cache version get_atttype() 
 *  for access to non-opened relations. 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN3115"></a><span class='Declare_Function'>attnumTypeId</span><span class='Parentheses'>(</span><a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a> <span class='Declare_Parameter'>rd</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>attid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3115"><span class='Ref_to_Parameter'>attid</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3119"></a>        <a href="../../include/catalog/pg_attribute.h.html#LN186"><span class='Ref_to_Typedef'>Form_pg_attribute</span></a> <span class='Declare_Local'>sysatt</span><span class='Delimiter'>; 
</span> 
        <a href="parse_relation.c.html#LN3119"><span class='Ref_To_Local'>sysatt</span></a> <span class='Operator'>= </span><a href="../../include/catalog/heap.h.html#LN122"><span class='Ref_to_Proto'>SystemAttributeDefinition</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3115"><span class='Ref_to_Parameter'>attid</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3115"><span class='Ref_to_Parameter'>rd</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relhasoids<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="parse_relation.c.html#LN3119"><span class='Ref_To_Local'>sysatt</span></a><span class='Operator'>-&GT;</span>atttypid<span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3115"><span class='Ref_to_Parameter'>attid</span></a> <span class='Operator'>&GT; </span><a href="parse_relation.c.html#LN3115"><span class='Ref_to_Parameter'>rd</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN114"><span class='Ref_to_Member'>rd_att</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Parentheses'>) 
</span>        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"invalid attribute number %d"</span><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3115"><span class='Ref_to_Parameter'>attid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="parse_relation.c.html#LN3115"><span class='Ref_to_Parameter'>rd</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN114"><span class='Ref_to_Member'>rd_att</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN73"><span class='Ref_to_Member'>attrs</span></a><span class='Delimiter'>[</span><a href="parse_relation.c.html#LN3115"><span class='Ref_to_Parameter'>attid</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span>atttypid<span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * given attribute id, return collation of that attribute 
 * 
 *  This should only be used if the relation is already heap_open()'ed. 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN3135"></a><span class='Declare_Function'>attnumCollationId</span><span class='Parentheses'>(</span><a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a> <span class='Declare_Parameter'>rd</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>attid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3135"><span class='Ref_to_Parameter'>attid</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* All system attributes are of noncollatable types. */ 
</span>        <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3135"><span class='Ref_to_Parameter'>attid</span></a> <span class='Operator'>&GT; </span><a href="parse_relation.c.html#LN3135"><span class='Ref_to_Parameter'>rd</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN114"><span class='Ref_to_Member'>rd_att</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Parentheses'>) 
</span>        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"invalid attribute number %d"</span><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3135"><span class='Ref_to_Parameter'>attid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="parse_relation.c.html#LN3135"><span class='Ref_to_Parameter'>rd</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN114"><span class='Ref_to_Member'>rd_att</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN73"><span class='Ref_to_Member'>attrs</span></a><span class='Delimiter'>[</span><a href="parse_relation.c.html#LN3135"><span class='Ref_to_Parameter'>attid</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span>attcollation<span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Generate a suitable error about a missing RTE. 
 * 
 * Since this is a very common type of error, we work rather hard to 
 * produce a helpful message. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN3154"></a><span class='Declare_Function'>errorMissingRTE</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN62"><span class='Ref_to_Struct'>RangeVar</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>relation</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3156"></a>    <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span><span class='Delimiter'>; 
</span><a name="LN3157"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>sublevels_up</span><span class='Delimiter'>; 
</span><a name="LN3158"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>badAlias</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Check to see if there are any potential matches in the query's 
     * rangetable.  (Note: cases involving a bad schema name in the RangeVar 
     * will throw error immediately here.  That seems OK.) 
     */ 
</span>    <a href="parse_relation.c.html#LN3156"><span class='Ref_To_Local'>rte</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN309"><span class='Ref_to_Func'>searchRangeTableForRel</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3154"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3154"><span class='Ref_to_Parameter'>relation</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If we found a match that has an alias and the alias is visible in the 
     * namespace, then the problem is probably use of the relation's real name 
     * instead of its alias, ie "SELECT foo.* FROM foo f". This mistake is 
     * common enough to justify a specific hint. 
     * 
     * If we found a match that doesn't meet those criteria, assume the 
     * problem is illegal use of a relation outside its scope, as in the 
     * MySQL-ism "SELECT ... FROM a, b LEFT JOIN c ON (a.x = c.y)". 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3156"><span class='Ref_To_Local'>rte</span></a> <span class='Operator'>&& </span><a href="parse_relation.c.html#LN3156"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1022"><span class='Ref_to_Member'>alias</span></a> <span class='Operator'>&& 
</span>        strcmp<span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3156"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3154"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span> <span class='Operator'>&& 
</span>        <a href="../../include/parser/parse_relation.h.html#LN36"><span class='Ref_to_Proto'>refnameRangeTblEntry</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3154"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3156"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a><span class='Delimiter'>, 
</span>                             <a href="parse_relation.c.html#LN3154"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN72"><span class='Ref_to_Member'>location</span></a><span class='Delimiter'>, 
</span>                             <span class='Operator'>&</span><a href="parse_relation.c.html#LN3157"><span class='Ref_To_Local'>sublevels_up</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="parse_relation.c.html#LN3156"><span class='Ref_To_Local'>rte</span></a><span class='Parentheses'>)</span> 
        <a href="parse_relation.c.html#LN3158"><span class='Ref_To_Local'>badAlias</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN3156"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3156"><span class='Ref_To_Local'>rte</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span><a href="../../bin/scripts/vacuumdb.c.html#LN25"><span class='Ref_to_Const'>ERRCODE_UNDEFINED_TABLE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>            <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"invalid reference to FROM-clause entry for table \"%s\""</span><span class='Delimiter'>, 
</span>                   <a href="parse_relation.c.html#LN3154"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3158"><span class='Ref_To_Local'>badAlias</span></a> <span class='Operator'>? 
</span>            <a href="../utils/error/elog.c.html#LN985"><span class='Ref_to_Func'>errhint</span></a><span class='Parentheses'>(</span><span class='String'>"Perhaps you meant to reference the table alias \"%s\"."</span><span class='Delimiter'>, 
</span>                    <a href="parse_relation.c.html#LN3158"><span class='Ref_To_Local'>badAlias</span></a><span class='Parentheses'>) </span><span class='Operator'>: 
</span>                  <a href="../utils/error/elog.c.html#LN985"><span class='Ref_to_Func'>errhint</span></a><span class='Parentheses'>(</span><span class='String'>"There is an entry for table \"%s\", but it cannot be referenced from this part of the query."</span><span class='Delimiter'>, 
</span>                          <a href="parse_relation.c.html#LN3156"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, 
</span>                 <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3154"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3154"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN72"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span><a href="../../bin/scripts/vacuumdb.c.html#LN25"><span class='Ref_to_Const'>ERRCODE_UNDEFINED_TABLE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"missing FROM-clause entry for table \"%s\""</span><span class='Delimiter'>, 
</span>                        <a href="parse_relation.c.html#LN3154"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3154"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3154"><span class='Ref_to_Parameter'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN72"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end errorMissingRTE &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Generate a suitable error about a missing column. 
 * 
 * Since this is a very common type of error, we work rather hard to 
 * produce a helpful message. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN3210"></a><span class='Declare_Function'>errorMissingColumn</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, 
</span><a name="LN3211"></a>                   <span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>relname</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>colname</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>location</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3213"></a>    <a href="../../include/parser/parse_relation.h.html#LN26"><span class='Ref_to_Typedef'>FuzzyAttrMatchState</span></a> <span class='Operator'>*</span><span class='Declare_Local'>state</span><span class='Delimiter'>; 
</span><a name="LN3214"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>closestfirst</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Search the entire rtable looking for possible matches.  If we find one, 
     * emit a hint about it. 
     * 
     * TODO: improve this code (and also errorMissingRTE) to mention using 
     * LATERAL if appropriate. 
     */ 
</span>    <a href="parse_relation.c.html#LN3213"><span class='Ref_To_Local'>state</span></a> <span class='Operator'>= </span><a href="parse_relation.c.html#LN829"><span class='Ref_to_Func'>searchRangeTableForCol</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3210"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3211"><span class='Ref_to_Parameter'>relname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3211"><span class='Ref_to_Parameter'>colname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3211"><span class='Ref_to_Parameter'>location</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Extract closest col string for best match, if any. 
     * 
     * Infer an exact match referenced despite not being visible from the fact 
     * that an attribute number was not present in state passed back -- this 
     * is what is reported when !closestfirst.  There might also be an exact 
     * match that was qualified with an incorrect alias, in which case 
     * closestfirst will be set (so hint is the same as generic fuzzy case). 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3213"><span class='Ref_To_Local'>state</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN29"><span class='Ref_to_Member'>rfirst</span></a> <span class='Operator'>&& </span><a href="../../include/access/attnum.h.html#LN33"><span class='Ref_to_Macro'>AttributeNumberIsValid</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3213"><span class='Ref_To_Local'>state</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN30"><span class='Ref_to_Member'>first</span></a><span class='Parentheses'>))</span> 
        <a href="parse_relation.c.html#LN3214"><span class='Ref_To_Local'>closestfirst</span></a> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN223"><span class='Ref_to_Proto'>list_nth</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3213"><span class='Ref_To_Local'>state</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN29"><span class='Ref_to_Member'>rfirst</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Delimiter'>, 
</span>                                       <a href="parse_relation.c.html#LN3213"><span class='Ref_To_Local'>state</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN30"><span class='Ref_to_Member'>first</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_relation.c.html#LN3213"><span class='Ref_To_Local'>state</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN31"><span class='Ref_to_Member'>rsecond</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Handle case where there is zero or one column suggestions to hint, 
         * including exact matches referenced but not visible. 
         */ 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_COLUMN<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="parse_relation.c.html#LN3211"><span class='Ref_to_Parameter'>relname</span></a> <span class='Operator'>? 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"column %s.%s does not exist"</span><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3211"><span class='Ref_to_Parameter'>relname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3211"><span class='Ref_to_Parameter'>colname</span></a><span class='Parentheses'>) </span><span class='Operator'>: 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"column \"%s\" does not exist"</span><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3211"><span class='Ref_to_Parameter'>colname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="parse_relation.c.html#LN3213"><span class='Ref_To_Local'>state</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN29"><span class='Ref_to_Member'>rfirst</span></a> <span class='Operator'>? </span><a href="parse_relation.c.html#LN3214"><span class='Ref_To_Local'>closestfirst</span></a> <span class='Operator'>? 
</span>              <a href="../utils/error/elog.c.html#LN985"><span class='Ref_to_Func'>errhint</span></a><span class='Parentheses'>(</span><span class='String'>"Perhaps you meant to reference the column \"%s.%s\"."</span><span class='Delimiter'>, 
</span>                      <a href="parse_relation.c.html#LN3213"><span class='Ref_To_Local'>state</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN29"><span class='Ref_to_Member'>rfirst</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3214"><span class='Ref_To_Local'>closestfirst</span></a><span class='Parentheses'>) </span><span class='Operator'>: 
</span>                 <a href="../utils/error/elog.c.html#LN985"><span class='Ref_to_Func'>errhint</span></a><span class='Parentheses'>(</span><span class='String'>"There is a column named \"%s\" in table \"%s\", but it cannot be referenced from this part of the query."</span><span class='Delimiter'>, 
</span>                         <a href="parse_relation.c.html#LN3211"><span class='Ref_to_Parameter'>colname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3213"><span class='Ref_To_Local'>state</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN29"><span class='Ref_to_Member'>rfirst</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a><span class='Parentheses'>) </span><span class='Operator'>: </span><span class='Number'>0</span><span class='Delimiter'>, 
</span>                 <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3210"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3211"><span class='Ref_to_Parameter'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Handle case where there are two equally useful column hints */ 
</span><a name="LN3259"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>closestsecond</span><span class='Delimiter'>; 
</span> 
        <a href="parse_relation.c.html#LN3259"><span class='Ref_To_Local'>closestsecond</span></a> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN223"><span class='Ref_to_Proto'>list_nth</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3213"><span class='Ref_To_Local'>state</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN31"><span class='Ref_to_Member'>rsecond</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN42"><span class='Ref_to_Member'>colnames</span></a><span class='Delimiter'>, 
</span>                                        <a href="parse_relation.c.html#LN3213"><span class='Ref_To_Local'>state</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN32"><span class='Ref_to_Member'>second</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_COLUMN<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="parse_relation.c.html#LN3211"><span class='Ref_to_Parameter'>relname</span></a> <span class='Operator'>? 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"column %s.%s does not exist"</span><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3211"><span class='Ref_to_Parameter'>relname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3211"><span class='Ref_to_Parameter'>colname</span></a><span class='Parentheses'>) </span><span class='Operator'>: 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"column \"%s\" does not exist"</span><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3211"><span class='Ref_to_Parameter'>colname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN985"><span class='Ref_to_Func'>errhint</span></a><span class='Parentheses'>(</span><span class='String'>"Perhaps you meant to reference the column \"%s.%s\" or the column \"%s.%s\"."</span><span class='Delimiter'>, 
</span>                         <a href="parse_relation.c.html#LN3213"><span class='Ref_To_Local'>state</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN29"><span class='Ref_to_Member'>rfirst</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3214"><span class='Ref_To_Local'>closestfirst</span></a><span class='Delimiter'>, 
</span>                         <a href="parse_relation.c.html#LN3213"><span class='Ref_To_Local'>state</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_relation.h.html#LN31"><span class='Ref_to_Member'>rsecond</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1023"><span class='Ref_to_Member'>eref</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN41"><span class='Ref_to_Member'>aliasname</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3259"><span class='Ref_To_Local'>closestsecond</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3210"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3211"><span class='Ref_to_Parameter'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end errorMissingColumn &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * Examine a fully-parsed query, and return TRUE iff any relation underlying 
 * the query is a temporary relation (table, view, or materialized view). 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN3282"></a><span class='Declare_Function'>isQueryUsingTempRelation</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>query</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="parse_relation.c.html#LN57"><span class='Ref_to_Proto'>isQueryUsingTempRelation_walker</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_relation.c.html#LN3282"><span class='Ref_to_Parameter'>query</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static bool 
</span><a name="LN3288"></a><span class='Declare_Function'>isQueryUsingTempRelation_walker</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, </span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3288"><span class='Ref_to_Parameter'>node</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3288"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN3295"></a>        <a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>query</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_relation.c.html#LN3288"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span><a name="LN3296"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>rtable</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3296"><span class='Ref_To_Local'>rtable</span></a><span class='Delimiter'>, </span><a href="parse_relation.c.html#LN3295"><span class='Ref_To_Local'>query</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN134"><span class='Ref_to_Member'>rtable</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN3300"></a>            <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3296"><span class='Ref_To_Local'>rtable</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3300"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN922"><span class='Ref_to_EnumConst'>RTE_RELATION</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN3304"></a>                <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>rel</span> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN91"><span class='Ref_to_Proto'>heap_open</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3300"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN947"><span class='Ref_to_Member'>relid</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN35"><span class='Ref_to_Const'>AccessShareLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN3305"></a>                <span class='Keyword'>char</span>        <span class='Declare_Local'>relpersistence</span> <span class='Operator'>= </span><a href="parse_relation.c.html#LN3304"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relpersistence<span class='Delimiter'>; 
</span> 
                <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3304"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN35"><span class='Ref_to_Const'>AccessShareLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3305"><span class='Ref_To_Local'>relpersistence</span></a> <span class='Operator'>== </span><a href="../../include/catalog/pg_class.h.html#LN171"><span class='Ref_to_Const'>RELPERSISTENCE_TEMP</span></a><span class='Parentheses'>) 
</span>                    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>return</span> <a href="../../include/nodes/nodeFuncs.h.html#LN57"><span class='Ref_to_Proto'>query_tree_walker</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3295"><span class='Ref_To_Local'>query</span></a><span class='Delimiter'>, 
</span>                                 <a href="parse_relation.c.html#LN57"><span class='Ref_to_Proto'>isQueryUsingTempRelation_walker</span></a><span class='Delimiter'>, 
</span>                                 <a href="parse_relation.c.html#LN3288"><span class='Ref_to_Parameter'>context</span></a><span class='Delimiter'>, 
</span>                                 <a href="../../include/nodes/nodeFuncs.h.html#LN22"><span class='Ref_to_Const'>QTW_IGNORE_JOINALIASES</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if IsA(node,Query) &raquo; </span> 
 
    <span class='Control'>return</span> <a href="../../include/nodes/nodeFuncs.h.html#LN52"><span class='Ref_to_Proto'>expression_tree_walker</span></a><span class='Parentheses'>(</span><a href="parse_relation.c.html#LN3288"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, 
</span>                                  <a href="parse_relation.c.html#LN57"><span class='Ref_to_Proto'>isQueryUsingTempRelation_walker</span></a><span class='Delimiter'>, 
</span>                                  <a href="parse_relation.c.html#LN3288"><span class='Ref_to_Parameter'>context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end isQueryUsingTempRelation_walker &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>