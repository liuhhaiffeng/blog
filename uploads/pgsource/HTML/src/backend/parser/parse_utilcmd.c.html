<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\backend\parser\parse_utilcmd.c</title>
<LINK REL=StyleSheet HREF="../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\backend\parser\parse_utilcmd.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:45 2017
</td></tr>
<tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * parse_utilcmd.c 
 *    Perform parse analysis work for various utility commands 
 * 
 * Formerly we did this work during parse_analyze() in analyze.c.  However 
 * that is fairly unsafe in the presence of querytree caching, since any 
 * database state that we depend on in making the transformations might be 
 * obsolete by the time the utility command is executed; and utility commands 
 * have no infrastructure for holding locks or rechecking plan validity. 
 * Hence these functions are now called at the start of execution of their 
 * respective utility commands. 
 * 
 * NOTE: in general we must avoid scribbling on the passed-in raw parse 
 * tree, since it might be in a plan cache.  The simplest solution is 
 * a quick copyObject() call before manipulating the query tree. 
 * 
 * 
 * Portions Copyright (c) 1996-2017, PostgreSQL Global Development Group 
 * Portions Copyright (c) 1994, Regents of the University of California 
 * 
 *  src/backend/parser/parse_utilcmd.c 
 * 
 *------------------------------------------------------------------------- 
 */ 
</span> 
<span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>"access/amapi.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/htup_details.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/reloptions.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/dependency.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/heap.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/index.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/namespace.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_am.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_collation.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_constraint.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_constraint_fn.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_opclass.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_operator.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_type.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"commands/comment.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"commands/defrem.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"commands/sequence.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"commands/tablecmds.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"commands/tablespace.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"miscadmin.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"nodes/makefuncs.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"nodes/nodeFuncs.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/planner.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/analyze.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parse_clause.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parse_coerce.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parse_collate.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parse_expr.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parse_relation.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parse_target.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parse_type.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parse_utilcmd.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parser.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"rewrite/rewriteManip.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/acl.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/builtins.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/lsyscache.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/rel.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/ruleutils.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/syscache.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/typcache.h"</span> 
 
 
<span class='Comment_Multi_Line'>/* State shared by transformCreateStmt and its subroutines */ 
</span><span class='Control'>typedef</span> <span class='Control'>struct</span> 
<span class='Delimiter'>{ 
</span><a name="LN74"></a>    <a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Member'>pstate</span><span class='Delimiter'>;</span>         <span class='Comment_Single_Line'>/* overall parser state */ 
</span><a name="LN75"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Member'>stmtType</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* "CREATE [FOREIGN] TABLE" or "ALTER TABLE" */ 
</span><a name="LN76"></a>    <a href="../../include/nodes/primnodes.h.html#LN62"><span class='Ref_to_Struct'>RangeVar</span></a>   <span class='Operator'>*</span><span class='Declare_Member'>relation</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* relation to create */ 
</span><a name="LN77"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Member'>rel</span><span class='Delimiter'>;</span>            <span class='Comment_Single_Line'>/* opened/locked rel, if ALTER */ 
</span><a name="LN78"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Member'>inhRelations</span><span class='Delimiter'>;</span>   <span class='Comment_Single_Line'>/* relations to inherit from */ 
</span><a name="LN79"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Member'>isforeign</span><span class='Delimiter'>;</span>      <span class='Comment_Single_Line'>/* true if CREATE/ALTER FOREIGN TABLE */ 
</span><a name="LN80"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Member'>isalter</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* true if altering existing table */ 
</span><a name="LN81"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Member'>hasoids</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* does relation have an OID column? */ 
</span><a name="LN82"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Member'>columns</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* ColumnDef items */ 
</span><a name="LN83"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Member'>ckconstraints</span><span class='Delimiter'>;</span>  <span class='Comment_Single_Line'>/* CHECK constraints */ 
</span><a name="LN84"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Member'>fkconstraints</span><span class='Delimiter'>;</span>  <span class='Comment_Single_Line'>/* FOREIGN KEY constraints */ 
</span><a name="LN85"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Member'>ixconstraints</span><span class='Delimiter'>;</span>  <span class='Comment_Single_Line'>/* index-creating constraints */ 
</span><a name="LN86"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Member'>inh_indexes</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* cloned indexes from INCLUDING INDEXES */ 
</span><a name="LN87"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Member'>blist</span><span class='Delimiter'>;</span>          <span class='Comment_Multi_Line'>/* "before list" of things to do before 
                                 * creating the table */ 
</span><a name="LN89"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Member'>alist</span><span class='Delimiter'>;</span>          <span class='Comment_Multi_Line'>/* "after list" of things to do after creating 
                                 * the table */ 
</span><a name="LN91"></a>    <a href="../../include/nodes/parsenodes.h.html#LN2667"><span class='Ref_to_Struct'>IndexStmt</span></a>  <span class='Operator'>*</span><span class='Declare_Member'>pkey</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* PRIMARY KEY index, if any */ 
</span><a name="LN92"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Member'>ispartitioned</span><span class='Delimiter'>;</span>  <span class='Comment_Single_Line'>/* true if table is partitioned */ 
</span><a name="LN93"></a>    <a href="../../include/nodes/parsenodes.h.html#LN795"><span class='Ref_to_Struct'>PartitionBoundSpec</span></a> <span class='Operator'>*</span><span class='Declare_Member'>partbound</span><span class='Delimiter'>;</span>      <span class='Comment_Single_Line'>/* transformed FOR VALUES */ 
</span><a name="LN94"></a><span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end {anonCreateStmtContext} &raquo; </span> <span class='Declare_Typedef'>CreateStmtContext</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* State shared by transformCreateSchemaStmt and its subroutines */ 
</span><span class='Control'>typedef</span> <span class='Control'>struct</span> 
<span class='Delimiter'>{ 
</span><a name="LN99"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Member'>stmtType</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* "CREATE SCHEMA" or "ALTER SCHEMA" */ 
</span><a name="LN100"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Member'>schemaname</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* name of schema */ 
</span><a name="LN101"></a>    <a href="../../include/nodes/parsenodes.h.html#LN324"><span class='Ref_to_Struct'>RoleSpec</span></a>   <span class='Operator'>*</span><span class='Declare_Member'>authrole</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* owner of schema */ 
</span><a name="LN102"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Member'>sequences</span><span class='Delimiter'>;</span>      <span class='Comment_Single_Line'>/* CREATE SEQUENCE items */ 
</span><a name="LN103"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Member'>tables</span><span class='Delimiter'>;</span>         <span class='Comment_Single_Line'>/* CREATE TABLE items */ 
</span><a name="LN104"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Member'>views</span><span class='Delimiter'>;</span>          <span class='Comment_Single_Line'>/* CREATE VIEW items */ 
</span><a name="LN105"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Member'>indexes</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* CREATE INDEX items */ 
</span><a name="LN106"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Member'>triggers</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* CREATE TRIGGER items */ 
</span><a name="LN107"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Member'>grants</span><span class='Delimiter'>;</span>         <span class='Comment_Single_Line'>/* GRANT items */ 
</span><a name="LN108"></a><span class='Delimiter'>} </span><span class='Declare_Typedef'>CreateSchemaStmtContext</span><span class='Delimiter'>; 
</span> 
 
<a name="LN111"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>transformColumnDefinition</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cxt</span><span class='Delimiter'>, 
</span><a name="LN112"></a>                          <a href="../../include/nodes/parsenodes.h.html#LN636"><span class='Ref_to_Struct'>ColumnDef</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>column</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN113"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>transformTableConstraint</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cxt</span><span class='Delimiter'>, 
</span><a name="LN114"></a>                         <a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>constraint</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN115"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>transformTableLikeClause</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cxt</span><span class='Delimiter'>, 
</span><a name="LN116"></a>                         <a href="../../include/nodes/parsenodes.h.html#LN660"><span class='Ref_to_Struct'>TableLikeClause</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>table_like_clause</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN117"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>transformOfType</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cxt</span><span class='Delimiter'>, 
</span><a name="LN118"></a>                <a href="../../include/nodes/parsenodes.h.html#LN205"><span class='Ref_to_Struct'>TypeName</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>ofTypename</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN119"></a><span class='Keyword'>static </span><a href="../../include/nodes/parsenodes.h.html#LN2667"><span class='Ref_to_Struct'>IndexStmt</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>generateClonedIndexStmt</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cxt</span><span class='Delimiter'>, 
</span><a name="LN120"></a>                        <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a> <span class='Declare_Parameter'>source_idx</span><span class='Delimiter'>, 
</span><a name="LN121"></a>                        <span class='Keyword'>const </span><a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>attmap</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>attmap_length</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN122"></a><span class='Keyword'>static </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>get_collation</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>collation</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>actual_datatype</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN123"></a><span class='Keyword'>static </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>get_opclass</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>opclass</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>actual_datatype</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN124"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>transformIndexConstraints</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cxt</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN125"></a><span class='Keyword'>static </span><a href="../../include/nodes/parsenodes.h.html#LN2667"><span class='Ref_to_Struct'>IndexStmt</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>transformIndexConstraint</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>constraint</span><span class='Delimiter'>, 
</span><a name="LN126"></a>                         <a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cxt</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN127"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>transformFKConstraints</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cxt</span><span class='Delimiter'>, 
</span><a name="LN128"></a>                       <span class='Keyword'>bool </span><span class='Declare_Parameter'>skipValidation</span><span class='Delimiter'>, 
</span><a name="LN129"></a>                       <span class='Keyword'>bool </span><span class='Declare_Parameter'>isAddConstraint</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN130"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>transformCheckConstraints</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cxt</span><span class='Delimiter'>, 
</span><a name="LN131"></a>                          <span class='Keyword'>bool </span><span class='Declare_Parameter'>skipValidation</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN132"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>transformConstraintAttrs</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cxt</span><span class='Delimiter'>, 
</span><a name="LN133"></a>                         <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>constraintList</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN134"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>transformColumnType</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cxt</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN636"><span class='Ref_to_Struct'>ColumnDef</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>column</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN135"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>setSchemaName</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>context_schema</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>**</span><span class='Declare_Parameter'>stmt_schema_name</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN136"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>transformPartitionCmd</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cxt</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN829"><span class='Ref_to_Struct'>PartitionCmd</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cmd</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN137"></a><span class='Keyword'>static </span><a href="../../include/nodes/primnodes.h.html#LN188"><span class='Ref_to_Struct'>Const</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>transformPartitionBoundValue</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN284"><span class='Ref_to_Struct'>A_Const</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>con</span><span class='Delimiter'>, 
</span><a name="LN138"></a>                          <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>colName</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>colType</span><span class='Delimiter'>, </span><a href="../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Declare_Parameter'>colTypmod</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * transformCreateStmt - 
 *    parse analysis for CREATE TABLE 
 * 
 * Returns a List of utility commands to be done in sequence.  One of these 
 * will be the transformed CreateStmt, but there may be additional actions 
 * to be done before and after the actual DefineRelation() call. 
 * 
 * SQL allows constraints to be scattered all over, so thumb through 
 * the columns and collect all constraints into one place. 
 * If there are any implied indices (e.g. UNIQUE or PRIMARY KEY) 
 * then expand those into multiple IndexStmt blocks. 
 *    - thomas 1997-12-02 
 */ 
</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>* 
</span><a name="LN156"></a><span class='Declare_Function'>transformCreateStmt</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN1972"><span class='Ref_to_Struct'>CreateStmt</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>stmt</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>queryString</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN158"></a>    <a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Local'>pstate</span><span class='Delimiter'>; 
</span><a name="LN159"></a>    <a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Declare_Local'>cxt</span><span class='Delimiter'>; 
</span><a name="LN160"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN161"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>save_alist</span><span class='Delimiter'>; 
</span><a name="LN162"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>elements</span><span class='Delimiter'>; 
</span><a name="LN163"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>namespaceid</span><span class='Delimiter'>; 
</span><a name="LN164"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>existing_relid</span><span class='Delimiter'>; 
</span><a name="LN165"></a>    <a href="../../include/parser/parse_node.h.html#LN249"><span class='Ref_to_Struct'>ParseCallbackState</span></a> <span class='Declare_Local'>pcbstate</span><span class='Delimiter'>; 
</span><a name="LN166"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>like_found</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We must not scribble on the passed-in CreateStmt, so copy it.  (This is 
     * overkill, but easy.) 
     */ 
</span>    <a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN618"><span class='Ref_to_Macro'>copyObject</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Set up pstate */ 
</span>    <a href="parse_utilcmd.c.html#LN158"><span class='Ref_To_Local'>pstate</span></a> <span class='Operator'>= </span><a href="parse_node.c.html#LN42"><span class='Ref_to_Func'>make_parsestate</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN158"><span class='Ref_To_Local'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN167"><span class='Ref_to_Member'>p_sourcetext</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>queryString</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Look up the creation namespace.  This also checks permissions on the 
     * target namespace, locks it against concurrent drops, checks for a 
     * preexisting relation in that namespace with the same name, and updates 
     * stmt-&GT;relation-&GT;relpersistence if the selected namespace is temporary. 
     */ 
</span>    <a href="parse_node.c.html#LN143"><span class='Ref_to_Func'>setup_parser_errposition_callback</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN165"><span class='Ref_To_Local'>pcbstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN158"><span class='Ref_To_Local'>pstate</span></a><span class='Delimiter'>, 
</span>                                      <a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1975"><span class='Ref_to_Member'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN72"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN163"><span class='Ref_To_Local'>namespaceid</span></a> <span class='Operator'>= 
</span>        <a href="../../include/catalog/namespace.h.html#LN60"><span class='Ref_to_Proto'>RangeVarGetAndCheckCreationNamespace</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1975"><span class='Ref_to_Member'>relation</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN33"><span class='Ref_to_Const'>NoLock</span></a><span class='Delimiter'>, 
</span>                                             <span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN164"><span class='Ref_To_Local'>existing_relid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_node.c.html#LN159"><span class='Ref_to_Func'>cancel_parser_errposition_callback</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN165"><span class='Ref_To_Local'>pcbstate</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If the relation already exists and the user specified "IF NOT EXISTS", 
     * bail out with a NOTICE. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1986"><span class='Ref_to_Member'>if_not_exists</span></a> <span class='Operator'>&& </span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN164"><span class='Ref_To_Local'>existing_relid</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN36"><span class='Ref_to_Const'>NOTICE</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DUPLICATE_TABLE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"relation \"%s\" already exists, skipping"</span><span class='Delimiter'>, 
</span>                        <a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1975"><span class='Ref_to_Member'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If the target relation name isn't schema-qualified, make it so.  This 
     * prevents some corner cases in which added-on rewritten commands might 
     * think they should apply to other relations that have the same name and 
     * are earlier in the search path.  But a local temp table is effectively 
     * specified to be in pg_temp, so no need for anything extra in that case. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1975"><span class='Ref_to_Member'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL 
</span>        <span class='Operator'>&& </span><a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1975"><span class='Ref_to_Member'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN70"><span class='Ref_to_Member'>relpersistence</span></a> <span class='Operator'>!= </span><a href="../../include/catalog/pg_class.h.html#LN171"><span class='Ref_to_Const'>RELPERSISTENCE_TEMP</span></a><span class='Parentheses'>) 
</span>        <a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1975"><span class='Ref_to_Member'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN175"><span class='Ref_to_Proto'>get_namespace_name</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN163"><span class='Ref_To_Local'>namespaceid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Set up CreateStmtContext */ 
</span>    <a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN158"><span class='Ref_To_Local'>pstate</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN2216"><span class='Ref_to_Struct'>CreateForeignTableStmt</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN75"><span class='Ref_to_Member'>stmtType</span></a> <span class='Operator'>= </span><span class='String'>"CREATE FOREIGN TABLE"</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN79"><span class='Ref_to_Member'>isforeign</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN75"><span class='Ref_to_Member'>stmtType</span></a> <span class='Operator'>= </span><span class='String'>"CREATE TABLE"</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN79"><span class='Ref_to_Member'>isforeign</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN76"><span class='Ref_to_Member'>relation</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1975"><span class='Ref_to_Member'>relation</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN77"><span class='Ref_to_Member'>rel</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN78"><span class='Ref_to_Member'>inhRelations</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1977"><span class='Ref_to_Member'>inhRelations</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN80"><span class='Ref_to_Member'>isalter</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN82"><span class='Ref_to_Member'>columns</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN83"><span class='Ref_to_Member'>ckconstraints</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN84"><span class='Ref_to_Member'>fkconstraints</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN85"><span class='Ref_to_Member'>ixconstraints</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN86"><span class='Ref_to_Member'>inh_indexes</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN87"><span class='Ref_to_Member'>blist</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN91"><span class='Ref_to_Member'>pkey</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN92"><span class='Ref_to_Member'>ispartitioned</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1980"><span class='Ref_to_Member'>partspec</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Notice that we allow OIDs here only for plain tables, even though 
     * foreign tables also support them.  This is necessary because the 
     * default_with_oids GUC must apply only to plain tables and not any other 
     * relkind; doing otherwise would break existing pg_dump files.  We could 
     * allow explicit "WITH OIDS" while not allowing default_with_oids to 
     * affect other relkinds, but it would complicate interpretOidsOption(), 
     * and right now there's no WITH OIDS option in CREATE FOREIGN TABLE 
     * anyway. 
     */ 
</span>    <a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN81"><span class='Ref_to_Member'>hasoids</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_clause.h.html#LN21"><span class='Ref_to_Proto'>interpretOidsOption</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1983"><span class='Ref_to_Member'>options</span></a><span class='Delimiter'>, </span><span class='Operator'>!</span><a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN79"><span class='Ref_to_Member'>isforeign</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1981"><span class='Ref_to_Member'>ofTypename</span></a> <span class='Operator'>|| !</span><a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1977"><span class='Ref_to_Member'>inhRelations</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>   <span class='Comment_Single_Line'>/* grammar enforces */ 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1981"><span class='Ref_to_Member'>ofTypename</span></a><span class='Parentheses'>) 
</span>        <a href="parse_utilcmd.c.html#LN117"><span class='Ref_to_Proto'>transformOfType</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1981"><span class='Ref_to_Member'>ofTypename</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1980"><span class='Ref_to_Member'>partspec</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1977"><span class='Ref_to_Member'>inhRelations</span></a> <span class='Operator'>&& !</span><a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1979"><span class='Ref_to_Member'>partbound</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>            <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot create partitioned table as inheritance child"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Run through each primary element in the table creation clause. Separate 
     * column defs from constraints, and do preliminary analysis. 
     */ 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN162"><span class='Ref_To_Local'>elements</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1976"><span class='Ref_to_Member'>tableElts</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN272"></a>        <a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>element</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN162"><span class='Ref_To_Local'>elements</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN513"><span class='Ref_to_Macro'>nodeTag</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN272"><span class='Ref_To_Local'>element</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>case</span> <a href="../../include/nodes/nodes.h.html#LN440"><span class='Ref_to_EnumConst'>T_ColumnDef</span></a><span class='Operator'>: 
</span>                <a href="parse_utilcmd.c.html#LN111"><span class='Ref_to_Proto'>transformColumnDefinition</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN636"><span class='Ref_to_Struct'>ColumnDef</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN272"><span class='Ref_To_Local'>element</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/nodes.h.html#LN442"><span class='Ref_to_EnumConst'>T_Constraint</span></a><span class='Operator'>: 
</span>                <a href="parse_utilcmd.c.html#LN113"><span class='Ref_to_Proto'>transformTableConstraint</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN272"><span class='Ref_To_Local'>element</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/nodes.h.html#LN454"><span class='Ref_to_EnumConst'>T_TableLikeClause</span></a><span class='Operator'>: 
</span>                <a href="parse_utilcmd.c.html#LN166"><span class='Ref_To_Local'>like_found</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN115"><span class='Ref_to_Proto'>transformTableLikeClause</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN660"><span class='Ref_to_Struct'>TableLikeClause</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN272"><span class='Ref_To_Local'>element</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>default</span><span class='Operator'>: 
</span>                <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized node type: %d"</span><span class='Delimiter'>, 
</span>                     <span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="../../include/nodes/nodes.h.html#LN513"><span class='Ref_to_Macro'>nodeTag</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN272"><span class='Ref_To_Local'>element</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch nodeTag(element) &raquo; </span> 
    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If we had any LIKE tables, they may require creation of an OID column 
     * even though the command's own WITH clause didn't ask for one (or, 
     * perhaps, even specifically rejected having one).  Insert a WITH option 
     * to ensure that happens.  We prepend to the list because the first oid 
     * option will be honored, and we want to override anything already there. 
     * (But note that DefineRelation will override this again to add an OID 
     * column if one appears in an inheritance parent table.) 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN166"><span class='Ref_To_Local'>like_found</span></a> <span class='Operator'>&& </span><a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN81"><span class='Ref_to_Member'>hasoids</span></a><span class='Parentheses'>) 
</span>        <a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1983"><span class='Ref_to_Member'>options</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN215"><span class='Ref_to_Proto'>lcons</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/makefuncs.h.html#LN82"><span class='Ref_to_Proto'>makeDefElem</span></a><span class='Parentheses'>(</span><span class='String'>"oids"</span><span class='Delimiter'>, 
</span>                                          <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../nodes/value.c.html#LN21"><span class='Ref_to_Func'>makeInteger</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                              <a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1983"><span class='Ref_to_Member'>options</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * transformIndexConstraints wants cxt.alist to contain only index 
     * statements, so transfer anything we already have into save_alist. 
     */ 
</span>    <a href="parse_utilcmd.c.html#LN161"><span class='Ref_To_Local'>save_alist</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1982"><span class='Ref_to_Member'>constraints</span></a> <span class='Operator'>== </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Postprocess constraints that give rise to index definitions. 
     */ 
</span>    <a href="parse_utilcmd.c.html#LN124"><span class='Ref_to_Proto'>transformIndexConstraints</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Postprocess foreign-key constraints. 
     */ 
</span>    <a href="parse_utilcmd.c.html#LN127"><span class='Ref_to_Proto'>transformFKConstraints</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Postprocess check constraints. 
     */ 
</span>    <a href="parse_utilcmd.c.html#LN130"><span class='Ref_to_Proto'>transformCheckConstraints</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Output results. 
     */ 
</span>    <a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1976"><span class='Ref_to_Member'>tableElts</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN82"><span class='Ref_to_Member'>columns</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1982"><span class='Ref_to_Member'>constraints</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN83"><span class='Ref_to_Member'>ckconstraints</span></a><span class='Delimiter'>; 
</span> 
    <a href="parse_utilcmd.c.html#LN160"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN87"><span class='Ref_to_Member'>blist</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN156"><span class='Ref_to_Parameter'>stmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN160"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN219"><span class='Ref_to_Proto'>list_concat</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN160"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN159"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN160"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN219"><span class='Ref_to_Proto'>list_concat</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN160"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN161"><span class='Ref_To_Local'>save_alist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="parse_utilcmd.c.html#LN160"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end transformCreateStmt &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * generateSerialExtraStmts 
 *      Generate CREATE SEQUENCE and ALTER SEQUENCE ... OWNED BY statements 
 *      to create the sequence for a serial or identity column. 
 * 
 * This includes determining the name the sequence will have.  The caller 
 * can ask to get back the name components by passing non-null pointers 
 * for snamespace_p and sname_p. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN357"></a><span class='Declare_Function'>generateSerialExtraStmts</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cxt</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN636"><span class='Ref_to_Struct'>ColumnDef</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>column</span><span class='Delimiter'>, 
</span><a name="LN358"></a>                         <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>seqtypid</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>seqoptions</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>for_identity</span><span class='Delimiter'>, 
</span><a name="LN359"></a>                         <span class='Keyword'>char </span><span class='Operator'>**</span><span class='Declare_Parameter'>snamespace_p</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>**</span><span class='Declare_Parameter'>sname_p</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN361"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>option</span><span class='Delimiter'>; 
</span><a name="LN362"></a>    <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>nameEl</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN363"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>snamespaceid</span><span class='Delimiter'>; 
</span><a name="LN364"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>snamespace</span><span class='Delimiter'>; 
</span><a name="LN365"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>sname</span><span class='Delimiter'>; 
</span><a name="LN366"></a>    <a href="../../include/nodes/parsenodes.h.html#LN2438"><span class='Ref_to_Struct'>CreateSeqStmt</span></a> <span class='Operator'>*</span><span class='Declare_Local'>seqstmt</span><span class='Delimiter'>; 
</span><a name="LN367"></a>    <a href="../../include/nodes/parsenodes.h.html#LN2448"><span class='Ref_to_Struct'>AlterSeqStmt</span></a> <span class='Operator'>*</span><span class='Declare_Local'>altseqstmt</span><span class='Delimiter'>; 
</span><a name="LN368"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>attnamelist</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Determine namespace and name to use for the sequence. 
     * 
     * First, check if a sequence name was passed in as an option.  This is 
     * used by pg_dump.  Else, generate a name. 
     * 
     * Although we use ChooseRelationName, it's not guaranteed that the 
     * selected sequence name won't conflict; given sufficiently long field 
     * names, two different serial columns in the same table could be assigned 
     * the same sequence name, and we'd not notice since we aren't creating 
     * the sequence quite yet.  In practice this seems quite unlikely to be a 
     * problem, especially since few people would need two serial columns in 
     * one table. 
     */ 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN361"><span class='Ref_To_Local'>option</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN358"><span class='Ref_to_Parameter'>seqoptions</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN386"></a>        <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>defel</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN108"><span class='Ref_to_Macro'>lfirst_node</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN361"><span class='Ref_To_Local'>option</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN386"><span class='Ref_To_Local'>defel</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"sequence_name"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN362"><span class='Ref_To_Local'>nameEl</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"conflicting or redundant options"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN362"><span class='Ref_To_Local'>nameEl</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN386"><span class='Ref_To_Local'>defel</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN362"><span class='Ref_To_Local'>nameEl</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN400"></a>        <a href="../../include/nodes/primnodes.h.html#LN62"><span class='Ref_to_Struct'>RangeVar</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>rv</span> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN119"><span class='Ref_to_Proto'>makeRangeVarFromNameList</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN575"><span class='Ref_to_Macro'>castNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN362"><span class='Ref_To_Local'>nameEl</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN720"><span class='Ref_to_Member'>arg</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <a href="parse_utilcmd.c.html#LN364"><span class='Ref_To_Local'>snamespace</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN400"><span class='Ref_To_Local'>rv</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_utilcmd.c.html#LN364"><span class='Ref_To_Local'>snamespace</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Given unqualified SEQUENCE NAME, select namespace */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN357"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN77"><span class='Ref_to_Member'>rel</span></a><span class='Parentheses'>) 
</span>                <a href="parse_utilcmd.c.html#LN363"><span class='Ref_To_Local'>snamespaceid</span></a> <span class='Operator'>= </span><a href="../../include/utils/rel.h.html#LN443"><span class='Ref_to_Macro'>RelationGetNamespace</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN357"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN77"><span class='Ref_to_Member'>rel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="parse_utilcmd.c.html#LN363"><span class='Ref_To_Local'>snamespaceid</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN59"><span class='Ref_to_Proto'>RangeVarGetCreationNamespace</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN357"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN76"><span class='Ref_to_Member'>relation</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN364"><span class='Ref_To_Local'>snamespace</span></a> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN175"><span class='Ref_to_Proto'>get_namespace_name</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN363"><span class='Ref_To_Local'>snamespaceid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="parse_utilcmd.c.html#LN365"><span class='Ref_To_Local'>sname</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN400"><span class='Ref_To_Local'>rv</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* Remove the SEQUENCE NAME item from seqoptions */ 
</span>        <a href="parse_utilcmd.c.html#LN358"><span class='Ref_to_Parameter'>seqoptions</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN234"><span class='Ref_to_Proto'>list_delete_ptr</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN358"><span class='Ref_to_Parameter'>seqoptions</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN362"><span class='Ref_To_Local'>nameEl</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN357"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN77"><span class='Ref_to_Member'>rel</span></a><span class='Parentheses'>) 
</span>            <a href="parse_utilcmd.c.html#LN363"><span class='Ref_To_Local'>snamespaceid</span></a> <span class='Operator'>= </span><a href="../../include/utils/rel.h.html#LN443"><span class='Ref_to_Macro'>RelationGetNamespace</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN357"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN77"><span class='Ref_to_Member'>rel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="parse_utilcmd.c.html#LN363"><span class='Ref_To_Local'>snamespaceid</span></a> <span class='Operator'>= </span><a href="../../include/catalog/namespace.h.html#LN59"><span class='Ref_to_Proto'>RangeVarGetCreationNamespace</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN357"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN76"><span class='Ref_to_Member'>relation</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../include/catalog/namespace.h.html#LN63"><span class='Ref_to_Proto'>RangeVarAdjustRelationPersistence</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN357"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN76"><span class='Ref_to_Member'>relation</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN363"><span class='Ref_To_Local'>snamespaceid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="parse_utilcmd.c.html#LN364"><span class='Ref_To_Local'>snamespace</span></a> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN175"><span class='Ref_to_Proto'>get_namespace_name</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN363"><span class='Ref_To_Local'>snamespaceid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN365"><span class='Ref_To_Local'>sname</span></a> <span class='Operator'>= </span><a href="../../include/commands/defrem.h.html#LN38"><span class='Ref_to_Proto'>ChooseRelationName</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN357"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN76"><span class='Ref_to_Member'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Delimiter'>, 
</span>                                   <a href="parse_utilcmd.c.html#LN357"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN639"><span class='Ref_to_Member'>colname</span></a><span class='Delimiter'>, 
</span>                                   <span class='String'>"seq"</span><span class='Delimiter'>, 
</span>                                   <a href="parse_utilcmd.c.html#LN363"><span class='Ref_To_Local'>snamespaceid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN24"><span class='Ref_to_Const'>DEBUG1</span></a><span class='Delimiter'>, 
</span>            <span class='Parentheses'>(</span><a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"%s will create implicit sequence \"%s\" for serial column \"%s.%s\""</span><span class='Delimiter'>, 
</span>                    <a href="parse_utilcmd.c.html#LN357"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN75"><span class='Ref_to_Member'>stmtType</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN365"><span class='Ref_To_Local'>sname</span></a><span class='Delimiter'>, 
</span>                    <a href="parse_utilcmd.c.html#LN357"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN76"><span class='Ref_to_Member'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN357"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN639"><span class='Ref_to_Member'>colname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Build a CREATE SEQUENCE command to create the sequence object, and add 
     * it to the list of things to be done before this CREATE/ALTER TABLE. 
     */ 
</span>    <a href="parse_utilcmd.c.html#LN366"><span class='Ref_To_Local'>seqstmt</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2438"><span class='Ref_to_Struct'>CreateSeqStmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN366"><span class='Ref_To_Local'>seqstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2444"><span class='Ref_to_Member'>for_identity</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN358"><span class='Ref_to_Parameter'>for_identity</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN366"><span class='Ref_To_Local'>seqstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2441"><span class='Ref_to_Member'>sequence</span></a> <span class='Operator'>= </span><a href="../../include/nodes/makefuncs.h.html#LN68"><span class='Ref_to_Proto'>makeRangeVar</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN364"><span class='Ref_To_Local'>snamespace</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN365"><span class='Ref_To_Local'>sname</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN366"><span class='Ref_To_Local'>seqstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2442"><span class='Ref_to_Member'>options</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN358"><span class='Ref_to_Parameter'>seqoptions</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If a sequence data type was specified, add it to the options.  Prepend 
     * to the list rather than append; in case a user supplied their own AS 
     * clause, the "redundant options" error will point to their occurrence, 
     * not our synthetic one. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN358"><span class='Ref_to_Parameter'>seqtypid</span></a><span class='Parentheses'>) 
</span>        <a href="parse_utilcmd.c.html#LN366"><span class='Ref_To_Local'>seqstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2442"><span class='Ref_to_Member'>options</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN215"><span class='Ref_to_Proto'>lcons</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/makefuncs.h.html#LN82"><span class='Ref_to_Proto'>makeDefElem</span></a><span class='Parentheses'>(</span><span class='String'>"as"</span><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/makefuncs.h.html#LN72"><span class='Ref_to_Proto'>makeTypeNameFromOid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN358"><span class='Ref_to_Parameter'>seqtypid</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                             <span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                 <a href="parse_utilcmd.c.html#LN366"><span class='Ref_To_Local'>seqstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2442"><span class='Ref_to_Member'>options</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If this is ALTER ADD COLUMN, make sure the sequence will be owned by 
     * the table's owner.  The current user might be someone else (perhaps a 
     * superuser, or someone who's only a member of the owning role), but the 
     * SEQUENCE OWNED BY mechanisms will bleat unless table and sequence have 
     * exactly the same owning role. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN357"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN77"><span class='Ref_to_Member'>rel</span></a><span class='Parentheses'>) 
</span>        <a href="parse_utilcmd.c.html#LN366"><span class='Ref_To_Local'>seqstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2443"><span class='Ref_to_Member'>ownerId</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN357"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN77"><span class='Ref_to_Member'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relowner<span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="parse_utilcmd.c.html#LN366"><span class='Ref_To_Local'>seqstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2443"><span class='Ref_to_Member'>ownerId</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span> 
    <a href="parse_utilcmd.c.html#LN357"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN87"><span class='Ref_to_Member'>blist</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN357"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN87"><span class='Ref_to_Member'>blist</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN366"><span class='Ref_To_Local'>seqstmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Build an ALTER SEQUENCE ... OWNED BY command to mark the sequence as 
     * owned by this column, and add it to the list of things to be done after 
     * this CREATE/ALTER TABLE. 
     */ 
</span>    <a href="parse_utilcmd.c.html#LN367"><span class='Ref_To_Local'>altseqstmt</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2448"><span class='Ref_to_Struct'>AlterSeqStmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN367"><span class='Ref_To_Local'>altseqstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2451"><span class='Ref_to_Member'>sequence</span></a> <span class='Operator'>= </span><a href="../../include/nodes/makefuncs.h.html#LN68"><span class='Ref_to_Proto'>makeRangeVar</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN364"><span class='Ref_To_Local'>snamespace</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN365"><span class='Ref_To_Local'>sname</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN368"><span class='Ref_To_Local'>attnamelist</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN140"><span class='Ref_to_Macro'>list_make3</span></a><span class='Parentheses'>(</span><a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN364"><span class='Ref_To_Local'>snamespace</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN357"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN76"><span class='Ref_to_Member'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN357"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN639"><span class='Ref_to_Member'>colname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN367"><span class='Ref_To_Local'>altseqstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2452"><span class='Ref_to_Member'>options</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN138"><span class='Ref_to_Macro'>list_make1</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/makefuncs.h.html#LN82"><span class='Ref_to_Proto'>makeDefElem</span></a><span class='Parentheses'>(</span><span class='String'>"owned_by"</span><span class='Delimiter'>, 
</span>                                                 <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN368"><span class='Ref_To_Local'>attnamelist</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN367"><span class='Ref_To_Local'>altseqstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2453"><span class='Ref_to_Member'>for_identity</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN358"><span class='Ref_to_Parameter'>for_identity</span></a><span class='Delimiter'>; 
</span> 
    <a href="parse_utilcmd.c.html#LN357"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN357"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN367"><span class='Ref_To_Local'>altseqstmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN359"><span class='Ref_to_Parameter'>snamespace_p</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="parse_utilcmd.c.html#LN359"><span class='Ref_to_Parameter'>snamespace_p</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN364"><span class='Ref_To_Local'>snamespace</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN359"><span class='Ref_to_Parameter'>sname_p</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="parse_utilcmd.c.html#LN359"><span class='Ref_to_Parameter'>sname_p</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN365"><span class='Ref_To_Local'>sname</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end generateSerialExtraStmts &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * transformColumnDefinition - 
 *      transform a single ColumnDef within CREATE TABLE 
 *      Also used in ALTER TABLE ADD COLUMN 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN500"></a><span class='Declare_Function'>transformColumnDefinition</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cxt</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN636"><span class='Ref_to_Struct'>ColumnDef</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>column</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN502"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>is_serial</span><span class='Delimiter'>; 
</span><a name="LN503"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>saw_nullable</span><span class='Delimiter'>; 
</span><a name="LN504"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>saw_default</span><span class='Delimiter'>; 
</span><a name="LN505"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>saw_identity</span><span class='Delimiter'>; 
</span><a name="LN506"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>clist</span><span class='Delimiter'>; 
</span> 
    <a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN82"><span class='Ref_to_Member'>columns</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN82"><span class='Ref_to_Member'>columns</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Check for SERIAL pseudo-types */ 
</span>    <a href="parse_utilcmd.c.html#LN502"><span class='Ref_To_Local'>is_serial</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN640"><span class='Ref_to_Member'>typeName</span></a> 
        <span class='Operator'>&& </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN640"><span class='Ref_to_Member'>typeName</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN208"><span class='Ref_to_Member'>names</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>1</span> 
        <span class='Operator'>&& !</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN640"><span class='Ref_to_Member'>typeName</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN211"><span class='Ref_to_Member'>pct_type</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span><a name="LN516"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>typname</span> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN640"><span class='Ref_to_Member'>typeName</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN208"><span class='Ref_to_Member'>names</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN516"><span class='Ref_To_Local'>typname</span></a><span class='Delimiter'>, </span><span class='String'>"smallserial"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>            strcmp<span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN516"><span class='Ref_To_Local'>typname</span></a><span class='Delimiter'>, </span><span class='String'>"serial2"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="parse_utilcmd.c.html#LN502"><span class='Ref_To_Local'>is_serial</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN640"><span class='Ref_to_Member'>typeName</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN208"><span class='Ref_to_Member'>names</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN640"><span class='Ref_to_Member'>typeName</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN209"><span class='Ref_to_Member'>typeOid</span></a> <span class='Operator'>= </span><a href="../../interfaces/ecpg/ecpglib/pg_type.h.html#LN22"><span class='Ref_to_Const'>INT2OID</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN516"><span class='Ref_To_Local'>typname</span></a><span class='Delimiter'>, </span><span class='String'>"serial"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>                 strcmp<span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN516"><span class='Ref_To_Local'>typname</span></a><span class='Delimiter'>, </span><span class='String'>"serial4"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="parse_utilcmd.c.html#LN502"><span class='Ref_To_Local'>is_serial</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN640"><span class='Ref_to_Member'>typeName</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN208"><span class='Ref_to_Member'>names</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN640"><span class='Ref_to_Member'>typeName</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN209"><span class='Ref_to_Member'>typeOid</span></a> <span class='Operator'>= </span><a href="../../interfaces/ecpg/ecpglib/pg_type.h.html#LN24"><span class='Ref_to_Const'>INT4OID</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN516"><span class='Ref_To_Local'>typname</span></a><span class='Delimiter'>, </span><span class='String'>"bigserial"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>                 strcmp<span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN516"><span class='Ref_To_Local'>typname</span></a><span class='Delimiter'>, </span><span class='String'>"serial8"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="parse_utilcmd.c.html#LN502"><span class='Ref_To_Local'>is_serial</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN640"><span class='Ref_to_Member'>typeName</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN208"><span class='Ref_to_Member'>names</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN640"><span class='Ref_to_Member'>typeName</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN209"><span class='Ref_to_Member'>typeOid</span></a> <span class='Operator'>= </span><a href="../../interfaces/ecpg/ecpglib/pg_type.h.html#LN21"><span class='Ref_to_Const'>INT8OID</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * We have to reject "serial[]" explicitly, because once we've set 
         * typeid, LookupTypeName won't notice arrayBounds.  We don't need any 
         * special coding for serial(typmod) though. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN502"><span class='Ref_To_Local'>is_serial</span></a> <span class='Operator'>&& </span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN640"><span class='Ref_to_Member'>typeName</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN214"><span class='Ref_to_Member'>arrayBounds</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"array of serial is not implemented"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, 
</span>                                        <a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN640"><span class='Ref_to_Member'>typeName</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN215"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if column-&GT;typeName&&lis... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Do necessary work on the column type declaration */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN640"><span class='Ref_to_Member'>typeName</span></a><span class='Parentheses'>) 
</span>        <a href="parse_utilcmd.c.html#LN134"><span class='Ref_to_Proto'>transformColumnType</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Special actions for SERIAL pseudo-types */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN502"><span class='Ref_To_Local'>is_serial</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN560"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>snamespace</span><span class='Delimiter'>; 
</span><a name="LN561"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>sname</span><span class='Delimiter'>; 
</span><a name="LN562"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>qstring</span><span class='Delimiter'>; 
</span><a name="LN563"></a>        <a href="../../include/nodes/parsenodes.h.html#LN284"><span class='Ref_to_Struct'>A_Const</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>snamenode</span><span class='Delimiter'>; 
</span><a name="LN564"></a>        <a href="../../include/nodes/parsenodes.h.html#LN294"><span class='Ref_to_Struct'>TypeCast</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>castnode</span><span class='Delimiter'>; 
</span><a name="LN565"></a>        <a href="../../include/nodes/parsenodes.h.html#LN346"><span class='Ref_to_Struct'>FuncCall</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>funccallnode</span><span class='Delimiter'>; 
</span><a name="LN566"></a>        <a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a> <span class='Operator'>*</span><span class='Declare_Local'>constraint</span><span class='Delimiter'>; 
</span> 
        <a href="parse_utilcmd.c.html#LN356"><span class='Ref_to_Func'>generateSerialExtraStmts</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Delimiter'>, 
</span>                                 <a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN640"><span class='Ref_to_Member'>typeName</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN209"><span class='Ref_to_Member'>typeOid</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, 
</span>                                 <span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN560"><span class='Ref_To_Local'>snamespace</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN561"><span class='Ref_To_Local'>sname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Create appropriate constraints for SERIAL.  We do this in full, 
         * rather than shortcutting, so that we will detect any conflicting 
         * constraints the user wrote (like a different DEFAULT). 
         * 
         * Create an expression tree representing the function call 
         * nextval('sequencename').  We cannot reduce the raw tree to cooked 
         * form until after the sequence is created, but there's no need to do 
         * so. 
         */ 
</span>        <a href="parse_utilcmd.c.html#LN562"><span class='Ref_To_Local'>qstring</span></a> <span class='Operator'>= </span><a href="../../include/utils/builtins.h.html#LN78"><span class='Ref_to_Proto'>quote_qualified_identifier</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN560"><span class='Ref_To_Local'>snamespace</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN561"><span class='Ref_To_Local'>sname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN563"><span class='Ref_To_Local'>snamenode</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN284"><span class='Ref_to_Struct'>A_Const</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN563"><span class='Ref_To_Local'>snamenode</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN287"><span class='Ref_to_Member'>val</span></a><span class='Operator'>.</span><a href="../../include/nodes/value.h.html#LN43"><span class='Ref_to_Member'>type</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN283"><span class='Ref_to_EnumConst'>T_String</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN563"><span class='Ref_To_Local'>snamenode</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN287"><span class='Ref_to_Member'>val</span></a><span class='Operator'>.</span><a href="../../include/nodes/value.h.html#LN48"><span class='Ref_to_Member'>val</span></a><span class='Operator'>.</span>str <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN562"><span class='Ref_To_Local'>qstring</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN563"><span class='Ref_To_Local'>snamenode</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN288"><span class='Ref_to_Member'>location</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN564"><span class='Ref_To_Local'>castnode</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN294"><span class='Ref_to_Struct'>TypeCast</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN564"><span class='Ref_To_Local'>castnode</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN298"><span class='Ref_to_Member'>typeName</span></a> <span class='Operator'>= </span><a href="../../include/parser/parser.h.html#LN38"><span class='Ref_to_Proto'>SystemTypeName</span></a><span class='Parentheses'>(</span><span class='String'>"regclass"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN564"><span class='Ref_To_Local'>castnode</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN297"><span class='Ref_to_Member'>arg</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN563"><span class='Ref_To_Local'>snamenode</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN564"><span class='Ref_To_Local'>castnode</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN299"><span class='Ref_to_Member'>location</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN565"><span class='Ref_To_Local'>funccallnode</span></a> <span class='Operator'>= </span><a href="../../include/nodes/makefuncs.h.html#LN80"><span class='Ref_to_Proto'>makeFuncCall</span></a><span class='Parentheses'>(</span><a href="../../include/parser/parser.h.html#LN37"><span class='Ref_to_Proto'>SystemFuncName</span></a><span class='Parentheses'>(</span><span class='String'>"nextval"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                    <a href="../../include/nodes/pg_list.h.html#LN138"><span class='Ref_to_Macro'>list_make1</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN564"><span class='Ref_To_Local'>castnode</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                    <span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN566"><span class='Ref_To_Local'>constraint</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN566"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2053"><span class='Ref_to_Member'>contype</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN2025"><span class='Ref_to_EnumConst'>CONSTR_DEFAULT</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN566"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN566"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2063"><span class='Ref_to_Member'>raw_expr</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN565"><span class='Ref_To_Local'>funccallnode</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN566"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2064"><span class='Ref_to_Member'>cooked_expr</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN652"><span class='Ref_to_Member'>constraints</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN652"><span class='Ref_to_Member'>constraints</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN566"><span class='Ref_To_Local'>constraint</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="parse_utilcmd.c.html#LN566"><span class='Ref_To_Local'>constraint</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN566"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2053"><span class='Ref_to_Member'>contype</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN2024"><span class='Ref_to_EnumConst'>CONSTR_NOTNULL</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN566"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN652"><span class='Ref_to_Member'>constraints</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN652"><span class='Ref_to_Member'>constraints</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN566"><span class='Ref_To_Local'>constraint</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if is_serial &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Process column constraints, if any... */ 
</span>    <a href="parse_utilcmd.c.html#LN132"><span class='Ref_to_Proto'>transformConstraintAttrs</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN652"><span class='Ref_to_Member'>constraints</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="parse_utilcmd.c.html#LN503"><span class='Ref_To_Local'>saw_nullable</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN504"><span class='Ref_To_Local'>saw_default</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN505"><span class='Ref_To_Local'>saw_identity</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN506"><span class='Ref_To_Local'>clist</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN652"><span class='Ref_to_Member'>constraints</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN616"></a>        <a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a> <span class='Operator'>*</span><span class='Declare_Local'>constraint</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN108"><span class='Ref_to_Macro'>lfirst_node</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN506"><span class='Ref_To_Local'>clist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN616"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2053"><span class='Ref_to_Member'>contype</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2022"><span class='Ref_to_EnumConst'>CONSTR_NULL</span></a><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN503"><span class='Ref_To_Local'>saw_nullable</span></a> <span class='Operator'>&& </span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN643"><span class='Ref_to_Member'>is_not_null</span></a><span class='Parentheses'>) 
</span>                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"conflicting NULL/NOT NULL declarations for column \"%s\" of table \"%s\""</span><span class='Delimiter'>, 
</span>                                    <a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN639"><span class='Ref_to_Member'>colname</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN76"><span class='Ref_to_Member'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, 
</span>                                                <a href="parse_utilcmd.c.html#LN616"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN643"><span class='Ref_to_Member'>is_not_null</span></a> <span class='Operator'>= </span><span class='Boolean'>FALSE</span><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN503"><span class='Ref_To_Local'>saw_nullable</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2024"><span class='Ref_to_EnumConst'>CONSTR_NOTNULL</span></a><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN503"><span class='Ref_To_Local'>saw_nullable</span></a> <span class='Operator'>&& !</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN643"><span class='Ref_to_Member'>is_not_null</span></a><span class='Parentheses'>) 
</span>                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"conflicting NULL/NOT NULL declarations for column \"%s\" of table \"%s\""</span><span class='Delimiter'>, 
</span>                                    <a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN639"><span class='Ref_to_Member'>colname</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN76"><span class='Ref_to_Member'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, 
</span>                                                <a href="parse_utilcmd.c.html#LN616"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN643"><span class='Ref_to_Member'>is_not_null</span></a> <span class='Operator'>= </span><span class='Boolean'>TRUE</span><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN503"><span class='Ref_To_Local'>saw_nullable</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2025"><span class='Ref_to_EnumConst'>CONSTR_DEFAULT</span></a><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN504"><span class='Ref_To_Local'>saw_default</span></a><span class='Parentheses'>) 
</span>                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"multiple default values specified for column \"%s\" of table \"%s\""</span><span class='Delimiter'>, 
</span>                                    <a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN639"><span class='Ref_to_Member'>colname</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN76"><span class='Ref_to_Member'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, 
</span>                                                <a href="parse_utilcmd.c.html#LN616"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN647"><span class='Ref_to_Member'>raw_default</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN616"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2063"><span class='Ref_to_Member'>raw_expr</span></a><span class='Delimiter'>; 
</span>                <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN616"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2064"><span class='Ref_to_Member'>cooked_expr</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN504"><span class='Ref_To_Local'>saw_default</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2026"><span class='Ref_to_EnumConst'>CONSTR_IDENTITY</span></a><span class='Operator'>: 
</span>                <span class='Delimiter'>{ 
</span><a name="LN659"></a>                    <a href="../../include/parser/parse_type.h.html#LN19"><span class='Ref_to_Typedef'>Type</span></a>        <span class='Declare_Local'>ctype</span><span class='Delimiter'>; 
</span><a name="LN660"></a>                    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>typeOid</span><span class='Delimiter'>; 
</span> 
                    <a href="parse_utilcmd.c.html#LN659"><span class='Ref_To_Local'>ctype</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_type.h.html#LN25"><span class='Ref_to_Proto'>typenameType</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN640"><span class='Ref_to_Member'>typeName</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <a href="parse_utilcmd.c.html#LN660"><span class='Ref_To_Local'>typeOid</span></a> <span class='Operator'>= </span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN659"><span class='Ref_To_Local'>ctype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN659"><span class='Ref_To_Local'>ctype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN505"><span class='Ref_To_Local'>saw_identity</span></a><span class='Parentheses'>) 
</span>                        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"multiple identity specifications for column \"%s\" of table \"%s\""</span><span class='Delimiter'>, 
</span>                                    <a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN639"><span class='Ref_to_Member'>colname</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN76"><span class='Ref_to_Member'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                 <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, 
</span>                                                    <a href="parse_utilcmd.c.html#LN616"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
                    <a href="parse_utilcmd.c.html#LN356"><span class='Ref_to_Func'>generateSerialExtraStmts</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Delimiter'>, 
</span>                                          <a href="parse_utilcmd.c.html#LN660"><span class='Ref_To_Local'>typeOid</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN616"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2074"><span class='Ref_to_Member'>options</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, 
</span>                                             <span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                    <a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN649"><span class='Ref_to_Member'>identity</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN616"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2065"><span class='Ref_to_Member'>generated_when</span></a><span class='Delimiter'>; 
</span>                    <a href="parse_utilcmd.c.html#LN505"><span class='Ref_To_Local'>saw_identity</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                    <a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN643"><span class='Ref_to_Member'>is_not_null</span></a> <span class='Operator'>= </span><span class='Boolean'>TRUE</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2027"><span class='Ref_to_EnumConst'>CONSTR_CHECK</span></a><span class='Operator'>: 
</span>                <a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN83"><span class='Ref_to_Member'>ckconstraints</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN83"><span class='Ref_to_Member'>ckconstraints</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN616"><span class='Ref_To_Local'>constraint</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2028"><span class='Ref_to_EnumConst'>CONSTR_PRIMARY</span></a><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN79"><span class='Ref_to_Member'>isforeign</span></a><span class='Parentheses'>) 
</span>                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"primary key constraints are not supported on foreign tables"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, 
</span>                                                <a href="parse_utilcmd.c.html#LN616"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN92"><span class='Ref_to_Member'>ispartitioned</span></a><span class='Parentheses'>) 
</span>                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"primary key constraints are not supported on partitioned tables"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, 
</span>                                                <a href="parse_utilcmd.c.html#LN616"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <span class='Comment_Multi_Line'>/* FALL THRU */ 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2029"><span class='Ref_to_EnumConst'>CONSTR_UNIQUE</span></a><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN79"><span class='Ref_to_Member'>isforeign</span></a><span class='Parentheses'>) 
</span>                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"unique constraints are not supported on foreign tables"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, 
</span>                                                <a href="parse_utilcmd.c.html#LN616"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN92"><span class='Ref_to_Member'>ispartitioned</span></a><span class='Parentheses'>) 
</span>                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"unique constraints are not supported on partitioned tables"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, 
</span>                                                <a href="parse_utilcmd.c.html#LN616"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN616"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2068"><span class='Ref_to_Member'>keys</span></a> <span class='Operator'>== </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>                    <a href="parse_utilcmd.c.html#LN616"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2068"><span class='Ref_to_Member'>keys</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN138"><span class='Ref_to_Macro'>list_make1</span></a><span class='Parentheses'>(</span><a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN639"><span class='Ref_to_Member'>colname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN85"><span class='Ref_to_Member'>ixconstraints</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN85"><span class='Ref_to_Member'>ixconstraints</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN616"><span class='Ref_To_Local'>constraint</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2030"><span class='Ref_to_EnumConst'>CONSTR_EXCLUSION</span></a><span class='Operator'>: 
</span>                <span class='Comment_Multi_Line'>/* grammar does not allow EXCLUDE as a column constraint */ 
</span>                <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"column exclusion constraints are not supported"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2031"><span class='Ref_to_EnumConst'>CONSTR_FOREIGN</span></a><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN79"><span class='Ref_to_Member'>isforeign</span></a><span class='Parentheses'>) 
</span>                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"foreign key constraints are not supported on foreign tables"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, 
</span>                                                <a href="parse_utilcmd.c.html#LN616"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN92"><span class='Ref_to_Member'>ispartitioned</span></a><span class='Parentheses'>) 
</span>                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"foreign key constraints are not supported on partitioned tables"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, 
</span>                                                <a href="parse_utilcmd.c.html#LN616"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* 
                 * Fill in the current attribute's name and throw it into the 
                 * list of FK constraints to be processed later. 
                 */ 
</span>                <a href="parse_utilcmd.c.html#LN616"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2083"><span class='Ref_to_Member'>fk_attrs</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN138"><span class='Ref_to_Macro'>list_make1</span></a><span class='Parentheses'>(</span><a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN639"><span class='Ref_to_Member'>colname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN84"><span class='Ref_to_Member'>fkconstraints</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN84"><span class='Ref_to_Member'>fkconstraints</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN616"><span class='Ref_To_Local'>constraint</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2032"><span class='Ref_to_EnumConst'>CONSTR_ATTR_DEFERRABLE</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2033"><span class='Ref_to_EnumConst'>CONSTR_ATTR_NOT_DEFERRABLE</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2034"><span class='Ref_to_EnumConst'>CONSTR_ATTR_DEFERRED</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2035"><span class='Ref_to_EnumConst'>CONSTR_ATTR_IMMEDIATE</span></a><span class='Operator'>: 
</span>                <span class='Comment_Multi_Line'>/* transformConstraintAttrs took care of these */ 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>default</span><span class='Operator'>: 
</span>                <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized constraint type: %d"</span><span class='Delimiter'>, 
</span>                     <a href="parse_utilcmd.c.html#LN616"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2053"><span class='Ref_to_Member'>contype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch constraint-&GT;contype &raquo; </span> 
 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN504"><span class='Ref_To_Local'>saw_default</span></a> <span class='Operator'>&& </span><a href="parse_utilcmd.c.html#LN505"><span class='Ref_To_Local'>saw_identity</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"both default and identity specified for column \"%s\" of table \"%s\""</span><span class='Delimiter'>, 
</span>                            <a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN639"><span class='Ref_to_Member'>colname</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN76"><span class='Ref_to_Member'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, 
</span>                                        <a href="parse_utilcmd.c.html#LN616"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If needed, generate ALTER FOREIGN TABLE ALTER COLUMN statement to add 
     * per-column foreign data wrapper options to this column after creation. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN653"><span class='Ref_to_Member'>fdwoptions</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN776"></a>        <a href="../../include/nodes/parsenodes.h.html#LN1662"><span class='Ref_to_Struct'>AlterTableStmt</span></a> <span class='Operator'>*</span><span class='Declare_Local'>stmt</span><span class='Delimiter'>; 
</span><a name="LN777"></a>        <a href="../../include/nodes/parsenodes.h.html#LN1749"><span class='Ref_to_Struct'>AlterTableCmd</span></a> <span class='Operator'>*</span><span class='Declare_Local'>cmd</span><span class='Delimiter'>; 
</span> 
        <a href="parse_utilcmd.c.html#LN777"><span class='Ref_To_Local'>cmd</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN1749"><span class='Ref_to_Struct'>AlterTableCmd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN777"><span class='Ref_To_Local'>cmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1752"><span class='Ref_to_Member'>subtype</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN1700"><span class='Ref_to_EnumConst'>AT_AlterColumnGenericOptions</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN777"><span class='Ref_To_Local'>cmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1753"><span class='Ref_to_Member'>name</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN639"><span class='Ref_to_Member'>colname</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN777"><span class='Ref_To_Local'>cmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1756"><span class='Ref_to_Member'>def</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN653"><span class='Ref_to_Member'>fdwoptions</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN777"><span class='Ref_To_Local'>cmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1758"><span class='Ref_to_Member'>behavior</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN1654"><span class='Ref_to_EnumConst'>DROP_RESTRICT</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN777"><span class='Ref_To_Local'>cmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1759"><span class='Ref_to_Member'>missing_ok</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
        <a href="parse_utilcmd.c.html#LN776"><span class='Ref_To_Local'>stmt</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN1662"><span class='Ref_to_Struct'>AlterTableStmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN776"><span class='Ref_To_Local'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1665"><span class='Ref_to_Member'>relation</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN76"><span class='Ref_to_Member'>relation</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN776"><span class='Ref_To_Local'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1666"><span class='Ref_to_Member'>cmds</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN776"><span class='Ref_To_Local'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1667"><span class='Ref_to_Member'>relkind</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN1603"><span class='Ref_to_EnumConst'>OBJECT_FOREIGN_TABLE</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN776"><span class='Ref_To_Local'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1666"><span class='Ref_to_Member'>cmds</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN776"><span class='Ref_To_Local'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1666"><span class='Ref_to_Member'>cmds</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN777"><span class='Ref_To_Local'>cmd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN500"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN776"><span class='Ref_To_Local'>stmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if column-&GT;fdwoptions!=N... &raquo; </span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end transformColumnDefinition &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * transformTableConstraint 
 *      transform a Constraint node within CREATE TABLE or ALTER TABLE 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN801"></a><span class='Declare_Function'>transformTableConstraint</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cxt</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>constraint</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2053"><span class='Ref_to_Member'>contype</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2028"><span class='Ref_to_EnumConst'>CONSTR_PRIMARY</span></a><span class='Operator'>: 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN79"><span class='Ref_to_Member'>isforeign</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"primary key constraints are not supported on foreign tables"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, 
</span>                                            <a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN92"><span class='Ref_to_Member'>ispartitioned</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"primary key constraints are not supported on partitioned tables"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, 
</span>                                            <a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN85"><span class='Ref_to_Member'>ixconstraints</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN85"><span class='Ref_to_Member'>ixconstraints</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>constraint</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2029"><span class='Ref_to_EnumConst'>CONSTR_UNIQUE</span></a><span class='Operator'>: 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN79"><span class='Ref_to_Member'>isforeign</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"unique constraints are not supported on foreign tables"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, 
</span>                                            <a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN92"><span class='Ref_to_Member'>ispartitioned</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"unique constraints are not supported on partitioned tables"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, 
</span>                                            <a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN85"><span class='Ref_to_Member'>ixconstraints</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN85"><span class='Ref_to_Member'>ixconstraints</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>constraint</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2030"><span class='Ref_to_EnumConst'>CONSTR_EXCLUSION</span></a><span class='Operator'>: 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN79"><span class='Ref_to_Member'>isforeign</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"exclusion constraints are not supported on foreign tables"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, 
</span>                                            <a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN92"><span class='Ref_to_Member'>ispartitioned</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"exclusion constraints are not supported on partitioned tables"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, 
</span>                                            <a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN85"><span class='Ref_to_Member'>ixconstraints</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN85"><span class='Ref_to_Member'>ixconstraints</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>constraint</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2027"><span class='Ref_to_EnumConst'>CONSTR_CHECK</span></a><span class='Operator'>: 
</span>            <a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN83"><span class='Ref_to_Member'>ckconstraints</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN83"><span class='Ref_to_Member'>ckconstraints</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>constraint</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2031"><span class='Ref_to_EnumConst'>CONSTR_FOREIGN</span></a><span class='Operator'>: 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN79"><span class='Ref_to_Member'>isforeign</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"foreign key constraints are not supported on foreign tables"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, 
</span>                                            <a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN92"><span class='Ref_to_Member'>ispartitioned</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"foreign key constraints are not supported on partitioned tables"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, 
</span>                                            <a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN84"><span class='Ref_to_Member'>fkconstraints</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN84"><span class='Ref_to_Member'>fkconstraints</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>constraint</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2022"><span class='Ref_to_EnumConst'>CONSTR_NULL</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2024"><span class='Ref_to_EnumConst'>CONSTR_NOTNULL</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2025"><span class='Ref_to_EnumConst'>CONSTR_DEFAULT</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2032"><span class='Ref_to_EnumConst'>CONSTR_ATTR_DEFERRABLE</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2033"><span class='Ref_to_EnumConst'>CONSTR_ATTR_NOT_DEFERRABLE</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2034"><span class='Ref_to_EnumConst'>CONSTR_ATTR_DEFERRED</span></a><span class='Operator'>: 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2035"><span class='Ref_to_EnumConst'>CONSTR_ATTR_IMMEDIATE</span></a><span class='Operator'>: 
</span>            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"invalid context for constraint type %d"</span><span class='Delimiter'>, 
</span>                 <a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2053"><span class='Ref_to_Member'>contype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized constraint type: %d"</span><span class='Delimiter'>, 
</span>                 <a href="parse_utilcmd.c.html#LN801"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2053"><span class='Ref_to_Member'>contype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch constraint-&GT;contype &raquo; </span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end transformTableConstraint &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * transformTableLikeClause 
 * 
 * Change the LIKE &LT;srctable&GT; portion of a CREATE TABLE statement into 
 * column definitions which recreate the user defined column portions of 
 * &LT;srctable&GT;. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN899"></a><span class='Declare_Function'>transformTableLikeClause</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cxt</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN660"><span class='Ref_to_Struct'>TableLikeClause</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>table_like_clause</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN901"></a>    <a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a>  <span class='Declare_Local'>parent_attno</span><span class='Delimiter'>; 
</span><a name="LN902"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>relation</span><span class='Delimiter'>; 
</span><a name="LN903"></a>    <a href="../../include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a>   <span class='Declare_Local'>tupleDesc</span><span class='Delimiter'>; 
</span><a name="LN904"></a>    <a href="../../include/access/tupdesc.h.html#LN36"><span class='Ref_to_Typedef'>TupleConstr</span></a> <span class='Operator'>*</span><span class='Declare_Local'>constr</span><span class='Delimiter'>; 
</span><a name="LN905"></a>    <a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Local'>attmap</span><span class='Delimiter'>; 
</span><a name="LN906"></a>    <a href="../../include/utils/acl.h.html#LN169"><span class='Ref_to_Typedef'>AclResult</span></a>   <span class='Declare_Local'>aclresult</span><span class='Delimiter'>; 
</span><a name="LN907"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>comment</span><span class='Delimiter'>; 
</span><a name="LN908"></a>    <a href="../../include/parser/parse_node.h.html#LN249"><span class='Ref_to_Struct'>ParseCallbackState</span></a> <span class='Declare_Local'>pcbstate</span><span class='Delimiter'>; 
</span> 
    <a href="parse_node.c.html#LN143"><span class='Ref_to_Func'>setup_parser_errposition_callback</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN908"><span class='Ref_To_Local'>pcbstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, 
</span>                                      <a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>table_like_clause</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN663"><span class='Ref_to_Member'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN72"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* we could support LIKE in many cases, but worry about it another day */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN79"><span class='Ref_to_Member'>isforeign</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>               <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"LIKE is not supported for creating foreign tables"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="parse_utilcmd.c.html#LN902"><span class='Ref_To_Local'>relation</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN86"><span class='Ref_to_Proto'>relation_openrv</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>table_like_clause</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN663"><span class='Ref_to_Member'>relation</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN35"><span class='Ref_to_Const'>AccessShareLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN902"><span class='Ref_To_Local'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relkind <span class='Operator'>!= </span><a href="../../include/catalog/pg_class.h.html#LN159"><span class='Ref_to_Const'>RELKIND_RELATION</span></a> <span class='Operator'>&& 
</span>        <a href="parse_utilcmd.c.html#LN902"><span class='Ref_To_Local'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relkind <span class='Operator'>!= </span><a href="../../include/catalog/pg_class.h.html#LN163"><span class='Ref_to_Const'>RELKIND_VIEW</span></a> <span class='Operator'>&& 
</span>        <a href="parse_utilcmd.c.html#LN902"><span class='Ref_To_Local'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relkind <span class='Operator'>!= </span><a href="../../include/catalog/pg_class.h.html#LN164"><span class='Ref_to_Const'>RELKIND_MATVIEW</span></a> <span class='Operator'>&& 
</span>        <a href="parse_utilcmd.c.html#LN902"><span class='Ref_To_Local'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relkind <span class='Operator'>!= </span><a href="../../include/catalog/pg_class.h.html#LN165"><span class='Ref_to_Const'>RELKIND_COMPOSITE_TYPE</span></a> <span class='Operator'>&& 
</span>        <a href="parse_utilcmd.c.html#LN902"><span class='Ref_To_Local'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relkind <span class='Operator'>!= </span><a href="../../include/catalog/pg_class.h.html#LN166"><span class='Ref_to_Const'>RELKIND_FOREIGN_TABLE</span></a> <span class='Operator'>&& 
</span>        <a href="parse_utilcmd.c.html#LN902"><span class='Ref_To_Local'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relkind <span class='Operator'>!= </span><a href="../../include/catalog/pg_class.h.html#LN167"><span class='Ref_to_Const'>RELKIND_PARTITIONED_TABLE</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_WRONG_OBJECT_TYPE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"\"%s\" is not a table, view, materialized view, composite type, or foreign table"</span><span class='Delimiter'>, 
</span>                        <a href="../../include/utils/rel.h.html#LN436"><span class='Ref_to_Macro'>RelationGetRelationName</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN902"><span class='Ref_To_Local'>relation</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <a href="parse_node.c.html#LN159"><span class='Ref_to_Func'>cancel_parser_errposition_callback</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN908"><span class='Ref_To_Local'>pcbstate</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Check for privileges 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN902"><span class='Ref_To_Local'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relkind <span class='Operator'>== </span><a href="../../include/catalog/pg_class.h.html#LN165"><span class='Ref_to_Const'>RELKIND_COMPOSITE_TYPE</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="parse_utilcmd.c.html#LN906"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>= </span><a href="../../include/utils/acl.h.html#LN293"><span class='Ref_to_Proto'>pg_type_aclcheck</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN902"><span class='Ref_To_Local'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>reltype<span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, 
</span>                                     <a href="../../include/nodes/parsenodes.h.html#LN79"><span class='Ref_to_Const'>ACL_USAGE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN906"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>!= </span><a href="../../include/utils/acl.h.html#LN171"><span class='Ref_to_EnumConst'>ACLCHECK_OK</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/acl.h.html#LN295"><span class='Ref_to_Proto'>aclcheck_error</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN906"><span class='Ref_To_Local'>aclresult</span></a><span class='Delimiter'>, </span><a href="../../include/utils/acl.h.html#LN186"><span class='Ref_to_EnumConst'>ACL_KIND_TYPE</span></a><span class='Delimiter'>, 
</span>                           <a href="../../include/utils/rel.h.html#LN436"><span class='Ref_to_Macro'>RelationGetRelationName</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN902"><span class='Ref_To_Local'>relation</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="parse_utilcmd.c.html#LN906"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>= </span><a href="../../include/utils/acl.h.html#LN283"><span class='Ref_to_Proto'>pg_class_aclcheck</span></a><span class='Parentheses'>(</span><a href="../../include/utils/rel.h.html#LN416"><span class='Ref_to_Macro'>RelationGetRelid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN902"><span class='Ref_To_Local'>relation</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../utils/init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, 
</span>                                      <a href="../../include/nodes/parsenodes.h.html#LN72"><span class='Ref_to_Const'>ACL_SELECT</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN906"><span class='Ref_To_Local'>aclresult</span></a> <span class='Operator'>!= </span><a href="../../include/utils/acl.h.html#LN171"><span class='Ref_to_EnumConst'>ACLCHECK_OK</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/acl.h.html#LN295"><span class='Ref_to_Proto'>aclcheck_error</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN906"><span class='Ref_To_Local'>aclresult</span></a><span class='Delimiter'>, </span><a href="../../include/utils/acl.h.html#LN181"><span class='Ref_to_EnumConst'>ACL_KIND_CLASS</span></a><span class='Delimiter'>, 
</span>                           <a href="../../include/utils/rel.h.html#LN436"><span class='Ref_to_Macro'>RelationGetRelationName</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN902"><span class='Ref_To_Local'>relation</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="parse_utilcmd.c.html#LN903"><span class='Ref_To_Local'>tupleDesc</span></a> <span class='Operator'>= </span><a href="../../include/utils/rel.h.html#LN428"><span class='Ref_to_Macro'>RelationGetDescr</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN902"><span class='Ref_To_Local'>relation</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN904"><span class='Ref_To_Local'>constr</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN903"><span class='Ref_To_Local'>tupleDesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN75"><span class='Ref_to_Member'>constr</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Initialize column number map for map_variable_attnos().  We need this 
     * since dropped columns in the source table aren't copied, so the new 
     * table can have different column numbers. 
     */ 
</span>    <a href="parse_utilcmd.c.html#LN905"><span class='Ref_To_Local'>attmap</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="parse_utilcmd.c.html#LN903"><span class='Ref_To_Local'>tupleDesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Insert the copied attributes into the cxt for the new table definition. 
     */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN901"><span class='Ref_To_Local'>parent_attno</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; </span><a href="parse_utilcmd.c.html#LN901"><span class='Ref_To_Local'>parent_attno</span></a> <span class='Operator'>&LT;= </span><a href="parse_utilcmd.c.html#LN903"><span class='Ref_To_Local'>tupleDesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Delimiter'>; 
</span>         <a href="parse_utilcmd.c.html#LN901"><span class='Ref_To_Local'>parent_attno</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN970"></a>        <a href="../../include/catalog/pg_attribute.h.html#LN186"><span class='Ref_to_Typedef'>Form_pg_attribute</span></a> <span class='Declare_Local'>attribute</span> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN903"><span class='Ref_To_Local'>tupleDesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN73"><span class='Ref_to_Member'>attrs</span></a><span class='Delimiter'>[</span><a href="parse_utilcmd.c.html#LN901"><span class='Ref_To_Local'>parent_attno</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span><a name="LN971"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>attributeName</span> <span class='Operator'>= </span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN970"><span class='Ref_To_Local'>attribute</span></a><span class='Operator'>-&GT;</span>attname<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN972"></a>        <a href="../../include/nodes/parsenodes.h.html#LN636"><span class='Ref_to_Struct'>ColumnDef</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>def</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Ignore dropped columns in the parent.  attmap entry is left zero. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN970"><span class='Ref_To_Local'>attribute</span></a><span class='Operator'>-&GT;</span>attisdropped<span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Create a new column, which is marked as NOT inherited. 
         * 
         * For constraints, ONLY the NOT NULL constraint is inherited by the 
         * new column definition per SQL99. 
         */ 
</span>        <a href="parse_utilcmd.c.html#LN972"><span class='Ref_To_Local'>def</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN636"><span class='Ref_to_Struct'>ColumnDef</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN972"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN639"><span class='Ref_to_Member'>colname</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN971"><span class='Ref_To_Local'>attributeName</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN972"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN640"><span class='Ref_to_Member'>typeName</span></a> <span class='Operator'>= </span><a href="../../include/nodes/makefuncs.h.html#LN72"><span class='Ref_to_Proto'>makeTypeNameFromOid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN970"><span class='Ref_To_Local'>attribute</span></a><span class='Operator'>-&GT;</span>atttypid<span class='Delimiter'>, 
</span>                                            <a href="parse_utilcmd.c.html#LN970"><span class='Ref_To_Local'>attribute</span></a><span class='Operator'>-&GT;</span>atttypmod<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN972"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN641"><span class='Ref_to_Member'>inhcount</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN972"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN642"><span class='Ref_to_Member'>is_local</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN972"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN643"><span class='Ref_to_Member'>is_not_null</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN970"><span class='Ref_To_Local'>attribute</span></a><span class='Operator'>-&GT;</span>attnotnull<span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN972"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN644"><span class='Ref_to_Member'>is_from_type</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN972"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN645"><span class='Ref_to_Member'>is_from_parent</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN972"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN646"><span class='Ref_to_Member'>storage</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN972"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN647"><span class='Ref_to_Member'>raw_default</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN972"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN648"><span class='Ref_to_Member'>cooked_default</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN972"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN650"><span class='Ref_to_Member'>collClause</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN972"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN651"><span class='Ref_to_Member'>collOid</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN970"><span class='Ref_To_Local'>attribute</span></a><span class='Operator'>-&GT;</span>attcollation<span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN972"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN652"><span class='Ref_to_Member'>constraints</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN972"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN654"><span class='Ref_to_Member'>location</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Add to column list 
         */ 
</span>        <a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN82"><span class='Ref_to_Member'>columns</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN82"><span class='Ref_to_Member'>columns</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN972"><span class='Ref_To_Local'>def</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="parse_utilcmd.c.html#LN905"><span class='Ref_To_Local'>attmap</span></a><span class='Delimiter'>[</span><a href="parse_utilcmd.c.html#LN901"><span class='Ref_To_Local'>parent_attno</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN82"><span class='Ref_to_Member'>columns</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Copy default, if present and the default has been requested 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN970"><span class='Ref_To_Local'>attribute</span></a><span class='Operator'>-&GT;</span>atthasdef <span class='Operator'>&& 
</span>            <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>table_like_clause</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN664"><span class='Ref_to_Member'>options</span></a> <span class='Operator'>& </span><a href="../../include/nodes/parsenodes.h.html#LN669"><span class='Ref_to_EnumConst'>CREATE_TABLE_LIKE_DEFAULTS</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN1016"></a>            <a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>this_default</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN1017"></a>            <a href="../../include/access/tupdesc.h.html#LN21"><span class='Ref_to_Typedef'>AttrDefault</span></a> <span class='Operator'>*</span><span class='Declare_Local'>attrdef</span><span class='Delimiter'>; 
</span><a name="LN1018"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Find default in constraint structure */ 
</span>            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN904"><span class='Ref_To_Local'>constr</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN1017"><span class='Ref_To_Local'>attrdef</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN904"><span class='Ref_To_Local'>constr</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN38"><span class='Ref_to_Member'>defval</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1018"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="parse_utilcmd.c.html#LN1018"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="parse_utilcmd.c.html#LN904"><span class='Ref_To_Local'>constr</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN40"><span class='Ref_to_Member'>num_defval</span></a><span class='Delimiter'>; </span><a href="parse_utilcmd.c.html#LN1018"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1017"><span class='Ref_To_Local'>attrdef</span></a><span class='Delimiter'>[</span><a href="parse_utilcmd.c.html#LN1018"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../include/access/tupdesc.h.html#LN23"><span class='Ref_to_Member'>adnum</span></a> <span class='Operator'>== </span><a href="parse_utilcmd.c.html#LN901"><span class='Ref_To_Local'>parent_attno</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <a href="parse_utilcmd.c.html#LN1016"><span class='Ref_To_Local'>this_default</span></a> <span class='Operator'>= </span><a href="../nodes/read.c.html#LN36"><span class='Ref_to_Func'>stringToNode</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1017"><span class='Ref_To_Local'>attrdef</span></a><span class='Delimiter'>[</span><a href="parse_utilcmd.c.html#LN1018"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../include/access/tupdesc.h.html#LN24"><span class='Ref_to_Member'>adbin</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span>            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1016"><span class='Ref_To_Local'>this_default</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * If default expr could contain any vars, we'd need to fix 'em, 
             * but it can't; so default is ready to apply to child. 
             */ 
</span> 
            <a href="parse_utilcmd.c.html#LN972"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN648"><span class='Ref_to_Member'>cooked_default</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1016"><span class='Ref_To_Local'>this_default</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if attribute-&GT;atthasdef&... &raquo; </span> 
 
        <span class='Comment_Multi_Line'>/* 
         * Copy identity if requested 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN970"><span class='Ref_To_Local'>attribute</span></a><span class='Operator'>-&GT;</span>attidentity <span class='Operator'>&& 
</span>            <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>table_like_clause</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN664"><span class='Ref_to_Member'>options</span></a> <span class='Operator'>& </span><a href="../../include/nodes/parsenodes.h.html#LN671"><span class='Ref_to_EnumConst'>CREATE_TABLE_LIKE_IDENTITY</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN1047"></a>            <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>seq_relid</span><span class='Delimiter'>; 
</span><a name="LN1048"></a>            <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>seq_options</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * find sequence owned by old column; extract sequence parameters; 
             * build new create sequence command 
             */ 
</span>            <a href="parse_utilcmd.c.html#LN1047"><span class='Ref_To_Local'>seq_relid</span></a> <span class='Operator'>= </span><a href="../../include/catalog/dependency.h.html#LN242"><span class='Ref_to_Proto'>getOwnedSequence</span></a><span class='Parentheses'>(</span><a href="../../include/utils/rel.h.html#LN416"><span class='Ref_to_Macro'>RelationGetRelid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN902"><span class='Ref_To_Local'>relation</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN970"><span class='Ref_To_Local'>attribute</span></a><span class='Operator'>-&GT;</span>attnum<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN1048"><span class='Ref_To_Local'>seq_options</span></a> <span class='Operator'>= </span><a href="../../include/commands/sequence.h.html#LN55"><span class='Ref_to_Proto'>sequence_options</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1047"><span class='Ref_To_Local'>seq_relid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN356"><span class='Ref_to_Func'>generateSerialExtraStmts</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>cxt</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN972"><span class='Ref_To_Local'>def</span></a><span class='Delimiter'>, 
</span>                                     <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1048"><span class='Ref_To_Local'>seq_options</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, 
</span>                                     <span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN972"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN649"><span class='Ref_to_Member'>identity</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN970"><span class='Ref_To_Local'>attribute</span></a><span class='Operator'>-&GT;</span>attidentity<span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* Likewise, copy storage if requested */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>table_like_clause</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN664"><span class='Ref_to_Member'>options</span></a> <span class='Operator'>& </span><a href="../../include/nodes/parsenodes.h.html#LN673"><span class='Ref_to_EnumConst'>CREATE_TABLE_LIKE_STORAGE</span></a><span class='Parentheses'>) 
</span>            <a href="parse_utilcmd.c.html#LN972"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN646"><span class='Ref_to_Member'>storage</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN970"><span class='Ref_To_Local'>attribute</span></a><span class='Operator'>-&GT;</span>attstorage<span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="parse_utilcmd.c.html#LN972"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN646"><span class='Ref_to_Member'>storage</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Likewise, copy comment if requested */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>table_like_clause</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN664"><span class='Ref_to_Member'>options</span></a> <span class='Operator'>& </span><a href="../../include/nodes/parsenodes.h.html#LN674"><span class='Ref_to_EnumConst'>CREATE_TABLE_LIKE_COMMENTS</span></a><span class='Parentheses'>)</span> <span class='Operator'>&& 
</span>            <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN907"><span class='Ref_To_Local'>comment</span></a> <span class='Operator'>= </span><a href="../../include/commands/comment.h.html#LN42"><span class='Ref_to_Proto'>GetComment</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN970"><span class='Ref_To_Local'>attribute</span></a><span class='Operator'>-&GT;</span>attrelid<span class='Delimiter'>, 
</span>                                  <a href="../../include/catalog/pg_class.h.html#LN28"><span class='Ref_to_Const'>RelationRelationId</span></a><span class='Delimiter'>, 
</span>                                  <a href="parse_utilcmd.c.html#LN970"><span class='Ref_To_Local'>attribute</span></a><span class='Operator'>-&GT;</span>attnum<span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span><a name="LN1074"></a>            <a href="../../include/nodes/parsenodes.h.html#LN2572"><span class='Ref_to_Struct'>CommentStmt</span></a> <span class='Operator'>*</span><span class='Declare_Local'>stmt</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2572"><span class='Ref_to_Struct'>CommentStmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="parse_utilcmd.c.html#LN1074"><span class='Ref_To_Local'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2575"><span class='Ref_to_Member'>objtype</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN1591"><span class='Ref_to_EnumConst'>OBJECT_COLUMN</span></a><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN1074"><span class='Ref_To_Local'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2576"><span class='Ref_to_Member'>object</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN140"><span class='Ref_to_Macro'>list_make3</span></a><span class='Parentheses'>(</span><a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN76"><span class='Ref_to_Member'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                          <a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN76"><span class='Ref_to_Member'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                               <a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN972"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN639"><span class='Ref_to_Member'>colname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN1074"><span class='Ref_To_Local'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2577"><span class='Ref_to_Member'>comment</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN907"><span class='Ref_To_Local'>comment</span></a><span class='Delimiter'>; 
</span> 
            <a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1074"><span class='Ref_To_Local'>stmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for parent_attno=1;parent... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* We use oids if at least one LIKE'ed table has oids. */ 
</span>    <a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN81"><span class='Ref_to_Member'>hasoids</span></a> <span class='Operator'>|= </span><a href="parse_utilcmd.c.html#LN902"><span class='Ref_To_Local'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relhasoids<span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Copy CHECK constraints if requested, being careful to adjust attribute 
     * numbers so they match the child. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>table_like_clause</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN664"><span class='Ref_to_Member'>options</span></a> <span class='Operator'>& </span><a href="../../include/nodes/parsenodes.h.html#LN670"><span class='Ref_to_EnumConst'>CREATE_TABLE_LIKE_CONSTRAINTS</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>        <a href="parse_utilcmd.c.html#LN903"><span class='Ref_To_Local'>tupleDesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN75"><span class='Ref_to_Member'>constr</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1096"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>ccnum</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1096"><span class='Ref_To_Local'>ccnum</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="parse_utilcmd.c.html#LN1096"><span class='Ref_To_Local'>ccnum</span></a> <span class='Operator'>&LT; </span><a href="parse_utilcmd.c.html#LN903"><span class='Ref_To_Local'>tupleDesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN75"><span class='Ref_to_Member'>constr</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN41"><span class='Ref_to_Member'>num_check</span></a><span class='Delimiter'>; </span><a href="parse_utilcmd.c.html#LN1096"><span class='Ref_To_Local'>ccnum</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN1100"></a>            <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>ccname</span> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN903"><span class='Ref_To_Local'>tupleDesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN75"><span class='Ref_to_Member'>constr</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN39"><span class='Ref_to_Member'>check</span></a><span class='Delimiter'>[</span><a href="parse_utilcmd.c.html#LN1096"><span class='Ref_To_Local'>ccnum</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../include/access/tupdesc.h.html#LN29"><span class='Ref_to_Member'>ccname</span></a><span class='Delimiter'>; 
</span><a name="LN1101"></a>            <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>ccbin</span> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN903"><span class='Ref_To_Local'>tupleDesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN75"><span class='Ref_to_Member'>constr</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN39"><span class='Ref_to_Member'>check</span></a><span class='Delimiter'>[</span><a href="parse_utilcmd.c.html#LN1096"><span class='Ref_To_Local'>ccnum</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../include/access/tupdesc.h.html#LN30"><span class='Ref_to_Member'>ccbin</span></a><span class='Delimiter'>; 
</span><a name="LN1102"></a>            <a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a> <span class='Operator'>*</span><span class='Declare_Local'>n</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1103"></a>            <a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>ccbin_node</span><span class='Delimiter'>; 
</span><a name="LN1104"></a>            <span class='Keyword'>bool</span>        <span class='Declare_Local'>found_whole_row</span><span class='Delimiter'>; 
</span> 
            <a href="parse_utilcmd.c.html#LN1103"><span class='Ref_To_Local'>ccbin_node</span></a> <span class='Operator'>= </span><a href="../../include/rewrite/rewriteManip.h.html#LN71"><span class='Ref_to_Proto'>map_variable_attnos</span></a><span class='Parentheses'>(</span><a href="../nodes/read.c.html#LN36"><span class='Ref_to_Func'>stringToNode</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1101"><span class='Ref_To_Local'>ccbin</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                             <span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, 
</span>                                             <a href="parse_utilcmd.c.html#LN905"><span class='Ref_To_Local'>attmap</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN903"><span class='Ref_To_Local'>tupleDesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Delimiter'>, 
</span>                                             <span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN1104"><span class='Ref_To_Local'>found_whole_row</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * We reject whole-row variables because the whole point of LIKE 
             * is that the new table's rowtype might later diverge from the 
             * parent's.  So, while translation might be possible right now, 
             * it wouldn't be possible to guarantee it would work in future. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1104"><span class='Ref_To_Local'>found_whole_row</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot convert whole-row table reference"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN871"><span class='Ref_to_Func'>errdetail</span></a><span class='Parentheses'>(</span><span class='String'>"Constraint \"%s\" contains a whole-row reference to table \"%s\"."</span><span class='Delimiter'>, 
</span>                                   <a href="parse_utilcmd.c.html#LN1100"><span class='Ref_To_Local'>ccname</span></a><span class='Delimiter'>, 
</span>                                   <a href="../../include/utils/rel.h.html#LN436"><span class='Ref_to_Macro'>RelationGetRelationName</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN902"><span class='Ref_To_Local'>relation</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
            <a href="parse_utilcmd.c.html#LN1102"><span class='Ref_To_Local'>n</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2053"><span class='Ref_to_Member'>contype</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN2027"><span class='Ref_to_EnumConst'>CONSTR_CHECK</span></a><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN1102"><span class='Ref_To_Local'>n</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN1102"><span class='Ref_To_Local'>n</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2056"><span class='Ref_to_Member'>conname</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1100"><span class='Ref_To_Local'>ccname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN1102"><span class='Ref_To_Local'>n</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2063"><span class='Ref_to_Member'>raw_expr</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN1102"><span class='Ref_To_Local'>n</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2064"><span class='Ref_to_Member'>cooked_expr</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN598"><span class='Ref_to_Proto'>nodeToString</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1103"><span class='Ref_To_Local'>ccbin_node</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN83"><span class='Ref_to_Member'>ckconstraints</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN83"><span class='Ref_to_Member'>ckconstraints</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1102"><span class='Ref_To_Local'>n</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Copy comment on constraint */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>table_like_clause</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN664"><span class='Ref_to_Member'>options</span></a> <span class='Operator'>& </span><a href="../../include/nodes/parsenodes.h.html#LN674"><span class='Ref_to_EnumConst'>CREATE_TABLE_LIKE_COMMENTS</span></a><span class='Parentheses'>)</span> <span class='Operator'>&& 
</span>                <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN907"><span class='Ref_To_Local'>comment</span></a> <span class='Operator'>= </span><a href="../../include/commands/comment.h.html#LN42"><span class='Ref_to_Proto'>GetComment</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/pg_constraint_fn.h.html#LN70"><span class='Ref_to_Proto'>get_relation_constraint_oid</span></a><span class='Parentheses'>(</span><a href="../../include/utils/rel.h.html#LN416"><span class='Ref_to_Macro'>RelationGetRelid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN902"><span class='Ref_To_Local'>relation</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                                          <a href="parse_utilcmd.c.html#LN1102"><span class='Ref_To_Local'>n</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2056"><span class='Ref_to_Member'>conname</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                      <a href="../../include/catalog/pg_constraint.h.html#LN28"><span class='Ref_to_Const'>ConstraintRelationId</span></a><span class='Delimiter'>, 
</span>                                      <span class='Number'>0</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
            <span class='Delimiter'>{ 
</span><a name="LN1139"></a>                <a href="../../include/nodes/parsenodes.h.html#LN2572"><span class='Ref_to_Struct'>CommentStmt</span></a> <span class='Operator'>*</span><span class='Declare_Local'>stmt</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2572"><span class='Ref_to_Struct'>CommentStmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <a href="parse_utilcmd.c.html#LN1139"><span class='Ref_To_Local'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2575"><span class='Ref_to_Member'>objtype</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN1621"><span class='Ref_to_EnumConst'>OBJECT_TABCONSTRAINT</span></a><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN1139"><span class='Ref_To_Local'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2576"><span class='Ref_to_Member'>object</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN140"><span class='Ref_to_Macro'>list_make3</span></a><span class='Parentheses'>(</span><a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN76"><span class='Ref_to_Member'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                          <a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN76"><span class='Ref_to_Member'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                                   <a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1102"><span class='Ref_To_Local'>n</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2056"><span class='Ref_to_Member'>conname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN1139"><span class='Ref_To_Local'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2577"><span class='Ref_to_Member'>comment</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN907"><span class='Ref_To_Local'>comment</span></a><span class='Delimiter'>; 
</span> 
                <a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1139"><span class='Ref_To_Local'>stmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for ccnum=0;ccnum&LT;tupleDe... &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if (table_like_clause-&GT;o... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* 
     * Likewise, copy indexes if requested 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>table_like_clause</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN664"><span class='Ref_to_Member'>options</span></a> <span class='Operator'>& </span><a href="../../include/nodes/parsenodes.h.html#LN672"><span class='Ref_to_EnumConst'>CREATE_TABLE_LIKE_INDEXES</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>        <a href="parse_utilcmd.c.html#LN902"><span class='Ref_To_Local'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relhasindex<span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1158"></a>        <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>parent_indexes</span><span class='Delimiter'>; 
</span><a name="LN1159"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
        <a href="parse_utilcmd.c.html#LN1158"><span class='Ref_To_Local'>parent_indexes</span></a> <span class='Operator'>= </span><a href="../../include/utils/relcache.h.html#LN40"><span class='Ref_to_Proto'>RelationGetIndexList</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN902"><span class='Ref_To_Local'>relation</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1159"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1158"><span class='Ref_To_Local'>parent_indexes</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN1165"></a>            <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>parent_index_oid</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN107"><span class='Ref_to_Macro'>lfirst_oid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1159"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1166"></a>            <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>parent_index</span><span class='Delimiter'>; 
</span><a name="LN1167"></a>            <a href="../../include/nodes/parsenodes.h.html#LN2667"><span class='Ref_to_Struct'>IndexStmt</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>index_stmt</span><span class='Delimiter'>; 
</span> 
            <a href="parse_utilcmd.c.html#LN1166"><span class='Ref_To_Local'>parent_index</span></a> <span class='Operator'>= </span><a href="../../include/access/genam.h.html#LN129"><span class='Ref_to_Proto'>index_open</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1165"><span class='Ref_To_Local'>parent_index_oid</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN35"><span class='Ref_to_Const'>AccessShareLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Build CREATE INDEX statement to recreate the parent_index */ 
</span>            <a href="parse_utilcmd.c.html#LN1167"><span class='Ref_To_Local'>index_stmt</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN119"><span class='Ref_to_Proto'>generateClonedIndexStmt</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>cxt</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1166"><span class='Ref_To_Local'>parent_index</span></a><span class='Delimiter'>, 
</span>                                                 <a href="parse_utilcmd.c.html#LN905"><span class='Ref_To_Local'>attmap</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN903"><span class='Ref_To_Local'>tupleDesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Copy comment on index, if requested */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>table_like_clause</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN664"><span class='Ref_to_Member'>options</span></a> <span class='Operator'>& </span><a href="../../include/nodes/parsenodes.h.html#LN674"><span class='Ref_to_EnumConst'>CREATE_TABLE_LIKE_COMMENTS</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="parse_utilcmd.c.html#LN907"><span class='Ref_To_Local'>comment</span></a> <span class='Operator'>= </span><a href="../../include/commands/comment.h.html#LN42"><span class='Ref_to_Proto'>GetComment</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1165"><span class='Ref_To_Local'>parent_index_oid</span></a><span class='Delimiter'>, </span><a href="../../include/catalog/pg_class.h.html#LN28"><span class='Ref_to_Const'>RelationRelationId</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* 
                 * We make use of IndexStmt's idxcomment option, so as not to 
                 * need to know now what name the index will have. 
                 */ 
</span>                <a href="parse_utilcmd.c.html#LN1167"><span class='Ref_To_Local'>index_stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2678"><span class='Ref_to_Member'>idxcomment</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN907"><span class='Ref_To_Local'>comment</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Comment_Multi_Line'>/* Save it in the inh_indexes list for the time being */ 
</span>            <a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN86"><span class='Ref_to_Member'>inh_indexes</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN899"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN86"><span class='Ref_to_Member'>inh_indexes</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1167"><span class='Ref_To_Local'>index_stmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="../../include/access/genam.h.html#LN130"><span class='Ref_to_Proto'>index_close</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1166"><span class='Ref_To_Local'>parent_index</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN35"><span class='Ref_to_Const'>AccessShareLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if (table_like_clause-&GT;o... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* 
     * Close the parent rel, but keep our AccessShareLock on it until xact 
     * commit.  That will prevent someone else from deleting or ALTERing the 
     * parent before the child is committed. 
     */ 
</span>    <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN902"><span class='Ref_To_Local'>relation</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN33"><span class='Ref_to_Const'>NoLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end transformTableLikeClause &raquo; </span> 
 
<span class='Keyword'>static void 
</span><a name="LN1203"></a><span class='Declare_Function'>transformOfType</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cxt</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN205"><span class='Ref_to_Struct'>TypeName</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>ofTypename</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1205"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tuple</span><span class='Delimiter'>; 
</span><a name="LN1206"></a>    <a href="../../include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a>   <span class='Declare_Local'>tupdesc</span><span class='Delimiter'>; 
</span><a name="LN1207"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN1208"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>ofTypeId</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/c.h.html#LN676"><span class='Ref_to_Macro'>AssertArg</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1203"><span class='Ref_to_Parameter'>ofTypename</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="parse_utilcmd.c.html#LN1205"><span class='Ref_To_Local'>tuple</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_type.h.html#LN25"><span class='Ref_to_Proto'>typenameType</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1203"><span class='Ref_to_Parameter'>ofTypename</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/commands/tablecmds.h.html#LN73"><span class='Ref_to_Proto'>check_of_type</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1205"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1208"><span class='Ref_To_Local'>ofTypeId</span></a> <span class='Operator'>= </span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1205"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1203"><span class='Ref_to_Parameter'>ofTypename</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN209"><span class='Ref_to_Member'>typeOid</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1208"><span class='Ref_To_Local'>ofTypeId</span></a><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* cached for later */ 
</span> 
    <a href="parse_utilcmd.c.html#LN1206"><span class='Ref_To_Local'>tupdesc</span></a> <span class='Operator'>= </span><a href="../../include/utils/typcache.h.html#LN151"><span class='Ref_to_Proto'>lookup_rowtype_tupdesc</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1208"><span class='Ref_To_Local'>ofTypeId</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1207"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="parse_utilcmd.c.html#LN1207"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="parse_utilcmd.c.html#LN1206"><span class='Ref_To_Local'>tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Delimiter'>; </span><a href="parse_utilcmd.c.html#LN1207"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1220"></a>        <a href="../../include/catalog/pg_attribute.h.html#LN186"><span class='Ref_to_Typedef'>Form_pg_attribute</span></a> <span class='Declare_Local'>attr</span> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1206"><span class='Ref_To_Local'>tupdesc</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN73"><span class='Ref_to_Member'>attrs</span></a><span class='Delimiter'>[</span><a href="parse_utilcmd.c.html#LN1207"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span><a name="LN1221"></a>        <a href="../../include/nodes/parsenodes.h.html#LN636"><span class='Ref_to_Struct'>ColumnDef</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>n</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1220"><span class='Ref_To_Local'>attr</span></a><span class='Operator'>-&GT;</span>attisdropped<span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
        <a href="parse_utilcmd.c.html#LN1221"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN636"><span class='Ref_to_Struct'>ColumnDef</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1221"><span class='Ref_To_Local'>n</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN639"><span class='Ref_to_Member'>colname</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1220"><span class='Ref_To_Local'>attr</span></a><span class='Operator'>-&GT;</span>attname<span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1221"><span class='Ref_To_Local'>n</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN640"><span class='Ref_to_Member'>typeName</span></a> <span class='Operator'>= </span><a href="../../include/nodes/makefuncs.h.html#LN72"><span class='Ref_to_Proto'>makeTypeNameFromOid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1220"><span class='Ref_To_Local'>attr</span></a><span class='Operator'>-&GT;</span>atttypid<span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1220"><span class='Ref_To_Local'>attr</span></a><span class='Operator'>-&GT;</span>atttypmod<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1221"><span class='Ref_To_Local'>n</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN641"><span class='Ref_to_Member'>inhcount</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1221"><span class='Ref_To_Local'>n</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN642"><span class='Ref_to_Member'>is_local</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1221"><span class='Ref_To_Local'>n</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN643"><span class='Ref_to_Member'>is_not_null</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1221"><span class='Ref_To_Local'>n</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN644"><span class='Ref_to_Member'>is_from_type</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1221"><span class='Ref_To_Local'>n</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN645"><span class='Ref_to_Member'>is_from_parent</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1221"><span class='Ref_To_Local'>n</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN646"><span class='Ref_to_Member'>storage</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1221"><span class='Ref_To_Local'>n</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN647"><span class='Ref_to_Member'>raw_default</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1221"><span class='Ref_To_Local'>n</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN648"><span class='Ref_to_Member'>cooked_default</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1221"><span class='Ref_To_Local'>n</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN650"><span class='Ref_to_Member'>collClause</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1221"><span class='Ref_To_Local'>n</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN651"><span class='Ref_to_Member'>collOid</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1220"><span class='Ref_To_Local'>attr</span></a><span class='Operator'>-&GT;</span>attcollation<span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1221"><span class='Ref_To_Local'>n</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN652"><span class='Ref_to_Member'>constraints</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1221"><span class='Ref_To_Local'>n</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN654"><span class='Ref_to_Member'>location</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1203"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN82"><span class='Ref_to_Member'>columns</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1203"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN82"><span class='Ref_to_Member'>columns</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1221"><span class='Ref_To_Local'>n</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=0;i&LT;tupdesc-&GT;natts;... &raquo; </span> 
    <a href="../../include/access/tupdesc.h.html#LN98"><span class='Ref_to_Proto'>DecrTupleDescRefCount</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1206"><span class='Ref_To_Local'>tupdesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1205"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end transformOfType &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Generate an IndexStmt node using information from an already existing index 
 * "source_idx".  Attribute numbers should be adjusted according to attmap. 
 */ 
</span><span class='Keyword'>static </span><a href="../../include/nodes/parsenodes.h.html#LN2667"><span class='Ref_to_Struct'>IndexStmt</span></a> <span class='Operator'>* 
</span><a name="LN1253"></a><span class='Declare_Function'>generateClonedIndexStmt</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cxt</span><span class='Delimiter'>, </span><a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a> <span class='Declare_Parameter'>source_idx</span><span class='Delimiter'>, 
</span><a name="LN1254"></a>                        <span class='Keyword'>const </span><a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>attmap</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>attmap_length</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1256"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>source_relid</span> <span class='Operator'>= </span><a href="../../include/utils/rel.h.html#LN416"><span class='Ref_to_Macro'>RelationGetRelid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1253"><span class='Ref_to_Parameter'>source_idx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1257"></a>    <a href="../../include/catalog/pg_attribute.h.html#LN186"><span class='Ref_to_Typedef'>Form_pg_attribute</span></a> <span class='Operator'>*</span><span class='Declare_Local'>attrs</span> <span class='Operator'>= </span><a href="../../include/utils/rel.h.html#LN428"><span class='Ref_to_Macro'>RelationGetDescr</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1253"><span class='Ref_to_Parameter'>source_idx</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>attrs<span class='Delimiter'>; 
</span><a name="LN1258"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>ht_idxrel</span><span class='Delimiter'>; 
</span><a name="LN1259"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>ht_idx</span><span class='Delimiter'>; 
</span><a name="LN1260"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>ht_am</span><span class='Delimiter'>; 
</span><a name="LN1261"></a>    <a href="../../include/catalog/pg_class.h.html#LN94"><span class='Ref_to_Typedef'>Form_pg_class</span></a> <span class='Declare_Local'>idxrelrec</span><span class='Delimiter'>; 
</span><a name="LN1262"></a>    <a href="../../include/catalog/pg_index.h.html#LN66"><span class='Ref_to_Typedef'>Form_pg_index</span></a> <span class='Declare_Local'>idxrec</span><span class='Delimiter'>; 
</span><a name="LN1263"></a>    <a href="../../include/catalog/pg_am.h.html#LN45"><span class='Ref_to_Typedef'>Form_pg_am</span></a>  <span class='Declare_Local'>amrec</span><span class='Delimiter'>; 
</span><a name="LN1264"></a>    <a href="../../include/c.h.html#LN477"><span class='Ref_to_Typedef'>oidvector</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>indcollation</span><span class='Delimiter'>; 
</span><a name="LN1265"></a>    <a href="../../include/c.h.html#LN477"><span class='Ref_to_Typedef'>oidvector</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>indclass</span><span class='Delimiter'>; 
</span><a name="LN1266"></a>    <a href="../../include/nodes/parsenodes.h.html#LN2667"><span class='Ref_to_Struct'>IndexStmt</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>index</span><span class='Delimiter'>; 
</span><a name="LN1267"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>indexprs</span><span class='Delimiter'>; 
</span><a name="LN1268"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>indexpr_item</span><span class='Delimiter'>; 
</span><a name="LN1269"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>indrelid</span><span class='Delimiter'>; 
</span><a name="LN1270"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>keyno</span><span class='Delimiter'>; 
</span><a name="LN1271"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>keycoltype</span><span class='Delimiter'>; 
</span><a name="LN1272"></a>    <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>datum</span><span class='Delimiter'>; 
</span><a name="LN1273"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>isnull</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Fetch pg_class tuple of source index.  We can't use the copy in the 
     * relcache entry because it doesn't include optional fields. 
     */ 
</span>    <a href="parse_utilcmd.c.html#LN1258"><span class='Ref_To_Local'>ht_idxrel</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN83"><span class='Ref_to_EnumConst'>RELOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1256"><span class='Ref_To_Local'>source_relid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1258"><span class='Ref_To_Local'>ht_idxrel</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for relation %u"</span><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1256"><span class='Ref_To_Local'>source_relid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1261"><span class='Ref_To_Local'>idxrelrec</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_class.h.html#LN94"><span class='Ref_to_Typedef'>Form_pg_class</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1258"><span class='Ref_To_Local'>ht_idxrel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Fetch pg_index tuple for source index from relcache entry */ 
</span>    <a href="parse_utilcmd.c.html#LN1259"><span class='Ref_To_Local'>ht_idx</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1253"><span class='Ref_to_Parameter'>source_idx</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN160"><span class='Ref_to_Member'>rd_indextuple</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1262"><span class='Ref_To_Local'>idxrec</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_index.h.html#LN66"><span class='Ref_to_Typedef'>Form_pg_index</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1259"><span class='Ref_To_Local'>ht_idx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1269"><span class='Ref_To_Local'>indrelid</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1262"><span class='Ref_To_Local'>idxrec</span></a><span class='Operator'>-&GT;</span>indrelid<span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Fetch the pg_am tuple of the index' access method */ 
</span>    <a href="parse_utilcmd.c.html#LN1260"><span class='Ref_To_Local'>ht_am</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN35"><span class='Ref_to_EnumConst'>AMOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1261"><span class='Ref_To_Local'>idxrelrec</span></a><span class='Operator'>-&GT;</span>relam<span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1260"><span class='Ref_To_Local'>ht_am</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for access method %u"</span><span class='Delimiter'>, 
</span>             <a href="parse_utilcmd.c.html#LN1261"><span class='Ref_To_Local'>idxrelrec</span></a><span class='Operator'>-&GT;</span>relam<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1263"><span class='Ref_To_Local'>amrec</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_am.h.html#LN45"><span class='Ref_to_Typedef'>Form_pg_am</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1260"><span class='Ref_To_Local'>ht_am</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Extract indcollation from the pg_index tuple */ 
</span>    <a href="parse_utilcmd.c.html#LN1272"><span class='Ref_To_Local'>datum</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN133"><span class='Ref_to_Proto'>SysCacheGetAttr</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN65"><span class='Ref_to_EnumConst'>INDEXRELID</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1259"><span class='Ref_To_Local'>ht_idx</span></a><span class='Delimiter'>, 
</span>                            <a href="../../include/catalog/pg_index.h.html#LN87"><span class='Ref_to_Const'>Anum_pg_index_indcollation</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN1273"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_utilcmd.c.html#LN1273"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1264"><span class='Ref_To_Local'>indcollation</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/c.h.html#LN477"><span class='Ref_to_Typedef'>oidvector</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1272"><span class='Ref_To_Local'>datum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Extract indclass from the pg_index tuple */ 
</span>    <a href="parse_utilcmd.c.html#LN1272"><span class='Ref_To_Local'>datum</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN133"><span class='Ref_to_Proto'>SysCacheGetAttr</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN65"><span class='Ref_to_EnumConst'>INDEXRELID</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1259"><span class='Ref_To_Local'>ht_idx</span></a><span class='Delimiter'>, 
</span>                            <a href="../../include/catalog/pg_index.h.html#LN88"><span class='Ref_to_Const'>Anum_pg_index_indclass</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN1273"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_utilcmd.c.html#LN1273"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1265"><span class='Ref_To_Local'>indclass</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/c.h.html#LN477"><span class='Ref_to_Typedef'>oidvector</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1272"><span class='Ref_To_Local'>datum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Begin building the IndexStmt */ 
</span>    <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2667"><span class='Ref_to_Struct'>IndexStmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2671"><span class='Ref_to_Member'>relation</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1253"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN76"><span class='Ref_to_Member'>relation</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2672"><span class='Ref_to_Member'>accessMethod</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1263"><span class='Ref_To_Local'>amrec</span></a><span class='Operator'>-&GT;</span>amname<span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1261"><span class='Ref_To_Local'>idxrelrec</span></a><span class='Operator'>-&GT;</span>reltablespace<span class='Parentheses'>))</span> 
        <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2673"><span class='Ref_to_Member'>tableSpace</span></a> <span class='Operator'>= </span><a href="../../include/commands/tablespace.h.html#LN56"><span class='Ref_to_Proto'>get_tablespace_name</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1261"><span class='Ref_To_Local'>idxrelrec</span></a><span class='Operator'>-&GT;</span>reltablespace<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2673"><span class='Ref_to_Member'>tableSpace</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2677"><span class='Ref_to_Member'>excludeOpNames</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2678"><span class='Ref_to_Member'>idxcomment</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2679"><span class='Ref_to_Member'>indexOid</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2680"><span class='Ref_to_Member'>oldNode</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2681"><span class='Ref_to_Member'>unique</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1262"><span class='Ref_To_Local'>idxrec</span></a><span class='Operator'>-&GT;</span>indisunique<span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2682"><span class='Ref_to_Member'>primary</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1262"><span class='Ref_To_Local'>idxrec</span></a><span class='Operator'>-&GT;</span>indisprimary<span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2686"><span class='Ref_to_Member'>transformed</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>;</span>  <span class='Comment_Single_Line'>/* don't need transformIndexStmt */ 
</span>    <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2687"><span class='Ref_to_Member'>concurrent</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2688"><span class='Ref_to_Member'>if_not_exists</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We don't try to preserve the name of the source index; instead, just 
     * let DefineIndex() choose a reasonable name.  (If we tried to preserve 
     * the name, we'd get duplicate-relation-name failures unless the source 
     * table was in a different schema.) 
     */ 
</span>    <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2670"><span class='Ref_to_Member'>idxname</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If the index is marked PRIMARY or has an exclusion condition, it's 
     * certainly from a constraint; else, if it's not marked UNIQUE, it 
     * certainly isn't.  If it is or might be from a constraint, we have to 
     * fetch the pg_constraint record. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2682"><span class='Ref_to_Member'>primary</span></a> <span class='Operator'>|| </span><a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2681"><span class='Ref_to_Member'>unique</span></a> <span class='Operator'>|| </span><a href="parse_utilcmd.c.html#LN1262"><span class='Ref_To_Local'>idxrec</span></a><span class='Operator'>-&GT;</span>indisexclusion<span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1342"></a>        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>constraintId</span> <span class='Operator'>= </span><a href="../../include/catalog/dependency.h.html#LN246"><span class='Ref_to_Proto'>get_index_constraint</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1256"><span class='Ref_To_Local'>source_relid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1342"><span class='Ref_To_Local'>constraintId</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN1346"></a>            <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>ht_constr</span><span class='Delimiter'>; 
</span><a name="LN1347"></a>            <a href="../../include/catalog/pg_constraint.h.html#LN146"><span class='Ref_to_Typedef'>Form_pg_constraint</span></a> <span class='Declare_Local'>conrec</span><span class='Delimiter'>; 
</span> 
            <a href="parse_utilcmd.c.html#LN1346"><span class='Ref_To_Local'>ht_constr</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN52"><span class='Ref_to_EnumConst'>CONSTROID</span></a><span class='Delimiter'>, 
</span>                                        <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1342"><span class='Ref_To_Local'>constraintId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1346"><span class='Ref_To_Local'>ht_constr</span></a><span class='Parentheses'>))</span> 
                <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for constraint %u"</span><span class='Delimiter'>, 
</span>                     <a href="parse_utilcmd.c.html#LN1342"><span class='Ref_To_Local'>constraintId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN1347"><span class='Ref_To_Local'>conrec</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_constraint.h.html#LN146"><span class='Ref_to_Typedef'>Form_pg_constraint</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1346"><span class='Ref_To_Local'>ht_constr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2683"><span class='Ref_to_Member'>isconstraint</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2684"><span class='Ref_to_Member'>deferrable</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1347"><span class='Ref_To_Local'>conrec</span></a><span class='Operator'>-&GT;</span>condeferrable<span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2685"><span class='Ref_to_Member'>initdeferred</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1347"><span class='Ref_To_Local'>conrec</span></a><span class='Operator'>-&GT;</span>condeferred<span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* If it's an exclusion constraint, we need the operator names */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1262"><span class='Ref_To_Local'>idxrec</span></a><span class='Operator'>-&GT;</span>indisexclusion<span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN1363"></a>                <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>elems</span><span class='Delimiter'>; 
</span><a name="LN1364"></a>                <span class='Keyword'>int</span>         <span class='Declare_Local'>nElems</span><span class='Delimiter'>; 
</span><a name="LN1365"></a>                <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
                <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1347"><span class='Ref_To_Local'>conrec</span></a><span class='Operator'>-&GT;</span>contype <span class='Operator'>== </span><a href="../../include/catalog/pg_constraint.h.html#LN192"><span class='Ref_to_Const'>CONSTRAINT_EXCLUSION</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Comment_Multi_Line'>/* Extract operator OIDs from the pg_constraint tuple */ 
</span>                <a href="parse_utilcmd.c.html#LN1272"><span class='Ref_To_Local'>datum</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN133"><span class='Ref_to_Proto'>SysCacheGetAttr</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN52"><span class='Ref_to_EnumConst'>CONSTROID</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1346"><span class='Ref_To_Local'>ht_constr</span></a><span class='Delimiter'>, 
</span>                                        <a href="../../include/catalog/pg_constraint.h.html#LN174"><span class='Ref_to_Const'>Anum_pg_constraint_conexclop</span></a><span class='Delimiter'>, 
</span>                                        <span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN1273"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1273"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>) 
</span>                    <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"null conexclop for constraint %u"</span><span class='Delimiter'>, 
</span>                         <a href="parse_utilcmd.c.html#LN1342"><span class='Ref_To_Local'>constraintId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <a href="../../include/utils/array.h.html#LN382"><span class='Ref_to_Proto'>deconstruct_array</span></a><span class='Parentheses'>(</span><a href="../../include/utils/array.h.html#LN241"><span class='Ref_to_Macro'>DatumGetArrayTypeP</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1272"><span class='Ref_To_Local'>datum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                  <a href="../../interfaces/ecpg/ecpglib/pg_type.h.html#LN27"><span class='Ref_to_Const'>OIDOID</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='String'>'i'</span><span class='Delimiter'>, 
</span>                                  <span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN1363"><span class='Ref_To_Local'>elems</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN1364"><span class='Ref_To_Local'>nElems</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1365"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="parse_utilcmd.c.html#LN1365"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="parse_utilcmd.c.html#LN1364"><span class='Ref_To_Local'>nElems</span></a><span class='Delimiter'>; </span><a href="parse_utilcmd.c.html#LN1365"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span><a name="LN1382"></a>                    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>operid</span> <span class='Operator'>= </span><a href="../../include/postgres.h.html#LN505"><span class='Ref_to_Macro'>DatumGetObjectId</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1363"><span class='Ref_To_Local'>elems</span></a><span class='Delimiter'>[</span><a href="parse_utilcmd.c.html#LN1365"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1383"></a>                    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>opertup</span><span class='Delimiter'>; 
</span><a name="LN1384"></a>                    <a href="../../include/catalog/pg_operator.h.html#LN56"><span class='Ref_to_Typedef'>Form_pg_operator</span></a> <span class='Declare_Local'>operform</span><span class='Delimiter'>; 
</span><a name="LN1385"></a>                    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>oprname</span><span class='Delimiter'>; 
</span><a name="LN1386"></a>                    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>nspname</span><span class='Delimiter'>; 
</span><a name="LN1387"></a>                    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>namelist</span><span class='Delimiter'>; 
</span> 
                    <a href="parse_utilcmd.c.html#LN1383"><span class='Ref_To_Local'>opertup</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN71"><span class='Ref_to_EnumConst'>OPEROID</span></a><span class='Delimiter'>, 
</span>                                              <a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1382"><span class='Ref_To_Local'>operid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1383"><span class='Ref_To_Local'>opertup</span></a><span class='Parentheses'>))</span> 
                        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for operator %u"</span><span class='Delimiter'>, 
</span>                             <a href="parse_utilcmd.c.html#LN1382"><span class='Ref_To_Local'>operid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <a href="parse_utilcmd.c.html#LN1384"><span class='Ref_To_Local'>operform</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_operator.h.html#LN56"><span class='Ref_to_Typedef'>Form_pg_operator</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1383"><span class='Ref_To_Local'>opertup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <a href="parse_utilcmd.c.html#LN1385"><span class='Ref_To_Local'>oprname</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1384"><span class='Ref_To_Local'>operform</span></a><span class='Operator'>-&GT;</span>oprname<span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* For simplicity we always schema-qualify the op name */ 
</span>                    <a href="parse_utilcmd.c.html#LN1386"><span class='Ref_To_Local'>nspname</span></a> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN175"><span class='Ref_to_Proto'>get_namespace_name</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1384"><span class='Ref_To_Local'>operform</span></a><span class='Operator'>-&GT;</span>oprnamespace<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <a href="parse_utilcmd.c.html#LN1387"><span class='Ref_To_Local'>namelist</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN139"><span class='Ref_to_Macro'>list_make2</span></a><span class='Parentheses'>(</span><a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1386"><span class='Ref_To_Local'>nspname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                          <a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1385"><span class='Ref_To_Local'>oprname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                    <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2677"><span class='Ref_to_Member'>excludeOpNames</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2677"><span class='Ref_to_Member'>excludeOpNames</span></a><span class='Delimiter'>, 
</span>                                                    <a href="parse_utilcmd.c.html#LN1387"><span class='Ref_To_Local'>namelist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1383"><span class='Ref_To_Local'>opertup</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=0;i&LT;nElems;i++ &raquo; </span> 
            <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if idxrec-&GT;indisexclusio... &raquo; </span> 
 
            <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1346"><span class='Ref_To_Local'>ht_constr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if OidIsValid(constraint... &raquo; </span> 
        <span class='Control'>else</span> 
            <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2683"><span class='Ref_to_Member'>isconstraint</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if index-&GT;primary||index... &raquo; </span> 
    <span class='Control'>else</span> 
        <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2683"><span class='Ref_to_Member'>isconstraint</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Get the index expressions, if any */ 
</span>    <a href="parse_utilcmd.c.html#LN1272"><span class='Ref_To_Local'>datum</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN133"><span class='Ref_to_Proto'>SysCacheGetAttr</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN65"><span class='Ref_to_EnumConst'>INDEXRELID</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1259"><span class='Ref_To_Local'>ht_idx</span></a><span class='Delimiter'>, 
</span>                            <a href="../../include/catalog/pg_index.h.html#LN90"><span class='Ref_to_Const'>Anum_pg_index_indexprs</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN1273"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_utilcmd.c.html#LN1273"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1419"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>exprsString</span><span class='Delimiter'>; 
</span> 
        <a href="parse_utilcmd.c.html#LN1419"><span class='Ref_To_Local'>exprsString</span></a> <span class='Operator'>= </span><a href="../../include/utils/builtins.h.html#LN91"><span class='Ref_to_Macro'>TextDatumGetCString</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1272"><span class='Ref_To_Local'>datum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1267"><span class='Ref_To_Local'>indexprs</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../nodes/read.c.html#LN36"><span class='Ref_to_Func'>stringToNode</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1419"><span class='Ref_To_Local'>exprsString</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
        <a href="parse_utilcmd.c.html#LN1267"><span class='Ref_To_Local'>indexprs</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Build the list of IndexElem */ 
</span>    <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2674"><span class='Ref_to_Member'>indexParams</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
    <a href="parse_utilcmd.c.html#LN1268"><span class='Ref_To_Local'>indexpr_item</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN75"><span class='Ref_to_Func'>list_head</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1267"><span class='Ref_To_Local'>indexprs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1270"><span class='Ref_To_Local'>keyno</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="parse_utilcmd.c.html#LN1270"><span class='Ref_To_Local'>keyno</span></a> <span class='Operator'>&LT; </span><a href="parse_utilcmd.c.html#LN1262"><span class='Ref_To_Local'>idxrec</span></a><span class='Operator'>-&GT;</span>indnatts<span class='Delimiter'>; </span><a href="parse_utilcmd.c.html#LN1270"><span class='Ref_To_Local'>keyno</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1433"></a>        <a href="../../include/nodes/parsenodes.h.html#LN685"><span class='Ref_to_Struct'>IndexElem</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>iparam</span><span class='Delimiter'>; 
</span><a name="LN1434"></a>        <a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a>  <span class='Declare_Local'>attnum</span> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1262"><span class='Ref_To_Local'>idxrec</span></a><span class='Operator'>-&GT;</span>indkey<span class='Operator'>.</span>values<span class='Delimiter'>[</span><a href="parse_utilcmd.c.html#LN1270"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>]; 
</span><a name="LN1435"></a>        <a href="../../include/c.h.html#LN254"><span class='Ref_to_Typedef'>int16</span></a>       <span class='Declare_Local'>opt</span> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1253"><span class='Ref_to_Parameter'>source_idx</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN185"><span class='Ref_to_Member'>rd_indoption</span></a><span class='Delimiter'>[</span><a href="parse_utilcmd.c.html#LN1270"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>]; 
</span> 
        <a href="parse_utilcmd.c.html#LN1433"><span class='Ref_To_Local'>iparam</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN685"><span class='Ref_to_Struct'>IndexElem</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/access/attnum.h.html#LN33"><span class='Ref_to_Macro'>AttributeNumberIsValid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1434"><span class='Ref_To_Local'>attnum</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Simple index column */ 
</span><a name="LN1442"></a>            <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>attname</span><span class='Delimiter'>; 
</span> 
            <a href="parse_utilcmd.c.html#LN1442"><span class='Ref_To_Local'>attname</span></a> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN86"><span class='Ref_to_Proto'>get_relid_attribute_name</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1269"><span class='Ref_To_Local'>indrelid</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1434"><span class='Ref_To_Local'>attnum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN1271"><span class='Ref_To_Local'>keycoltype</span></a> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN89"><span class='Ref_to_Proto'>get_atttype</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1269"><span class='Ref_To_Local'>indrelid</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1434"><span class='Ref_To_Local'>attnum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="parse_utilcmd.c.html#LN1433"><span class='Ref_To_Local'>iparam</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN688"><span class='Ref_to_Member'>name</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1442"><span class='Ref_To_Local'>attname</span></a><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN1433"><span class='Ref_To_Local'>iparam</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN689"><span class='Ref_to_Member'>expr</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Expressional index */ 
</span><a name="LN1453"></a>            <a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>indexkey</span><span class='Delimiter'>; 
</span><a name="LN1454"></a>            <span class='Keyword'>bool</span>        <span class='Declare_Local'>found_whole_row</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1268"><span class='Ref_To_Local'>indexpr_item</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"too few entries in indexprs list"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN1453"><span class='Ref_To_Local'>indexkey</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1268"><span class='Ref_To_Local'>indexpr_item</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN1268"><span class='Ref_To_Local'>indexpr_item</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN104"><span class='Ref_to_Macro'>lnext</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1268"><span class='Ref_To_Local'>indexpr_item</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Adjust Vars to match new table's column numbering */ 
</span>            <a href="parse_utilcmd.c.html#LN1453"><span class='Ref_To_Local'>indexkey</span></a> <span class='Operator'>= </span><a href="../../include/rewrite/rewriteManip.h.html#LN71"><span class='Ref_to_Proto'>map_variable_attnos</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1453"><span class='Ref_To_Local'>indexkey</span></a><span class='Delimiter'>, 
</span>                                           <span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, 
</span>                                           <a href="parse_utilcmd.c.html#LN1254"><span class='Ref_to_Parameter'>attmap</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1254"><span class='Ref_to_Parameter'>attmap_length</span></a><span class='Delimiter'>, 
</span>                                           <span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN1454"><span class='Ref_To_Local'>found_whole_row</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* As in transformTableLikeClause, reject whole-row variables */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1454"><span class='Ref_To_Local'>found_whole_row</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot convert whole-row table reference"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN871"><span class='Ref_to_Func'>errdetail</span></a><span class='Parentheses'>(</span><span class='String'>"Index \"%s\" contains a whole-row table reference."</span><span class='Delimiter'>, 
</span>                                   <a href="../../include/utils/rel.h.html#LN436"><span class='Ref_to_Macro'>RelationGetRelationName</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1253"><span class='Ref_to_Parameter'>source_idx</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
            <a href="parse_utilcmd.c.html#LN1433"><span class='Ref_To_Local'>iparam</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN688"><span class='Ref_to_Member'>name</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN1433"><span class='Ref_To_Local'>iparam</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN689"><span class='Ref_to_Member'>expr</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1453"><span class='Ref_To_Local'>indexkey</span></a><span class='Delimiter'>; 
</span> 
            <a href="parse_utilcmd.c.html#LN1271"><span class='Ref_To_Local'>keycoltype</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodeFuncs.h.html#LN31"><span class='Ref_to_Proto'>exprType</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1453"><span class='Ref_To_Local'>indexkey</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
        <span class='Comment_Multi_Line'>/* Copy the original index column name */ 
</span>        <a href="parse_utilcmd.c.html#LN1433"><span class='Ref_To_Local'>iparam</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN690"><span class='Ref_to_Member'>indexcolname</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1257"><span class='Ref_To_Local'>attrs</span></a><span class='Delimiter'>[</span><a href="parse_utilcmd.c.html#LN1270"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>]</span><span class='Operator'>-&GT;</span>attname<span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Add the collation name, if non-default */ 
</span>        <a href="parse_utilcmd.c.html#LN1433"><span class='Ref_To_Local'>iparam</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN691"><span class='Ref_to_Member'>collation</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN122"><span class='Ref_to_Proto'>get_collation</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1264"><span class='Ref_To_Local'>indcollation</span></a><span class='Operator'>-&GT;</span><a href="../../include/c.h.html#LN485"><span class='Ref_to_Member'>values</span></a><span class='Delimiter'>[</span><a href="parse_utilcmd.c.html#LN1270"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>], </span><a href="parse_utilcmd.c.html#LN1271"><span class='Ref_To_Local'>keycoltype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Add the operator class name, if non-default */ 
</span>        <a href="parse_utilcmd.c.html#LN1433"><span class='Ref_To_Local'>iparam</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN692"><span class='Ref_to_Member'>opclass</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN123"><span class='Ref_to_Proto'>get_opclass</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1265"><span class='Ref_To_Local'>indclass</span></a><span class='Operator'>-&GT;</span><a href="../../include/c.h.html#LN485"><span class='Ref_to_Member'>values</span></a><span class='Delimiter'>[</span><a href="parse_utilcmd.c.html#LN1270"><span class='Ref_To_Local'>keyno</span></a><span class='Delimiter'>], </span><a href="parse_utilcmd.c.html#LN1271"><span class='Ref_To_Local'>keycoltype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="parse_utilcmd.c.html#LN1433"><span class='Ref_To_Local'>iparam</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN693"><span class='Ref_to_Member'>ordering</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN49"><span class='Ref_to_EnumConst'>SORTBY_DEFAULT</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1433"><span class='Ref_To_Local'>iparam</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN694"><span class='Ref_to_Member'>nulls_ordering</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN57"><span class='Ref_to_EnumConst'>SORTBY_NULLS_DEFAULT</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Adjust options if necessary */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1253"><span class='Ref_to_Parameter'>source_idx</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN180"><span class='Ref_to_Member'>rd_amroutine</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/amapi.h.html#LN170"><span class='Ref_to_Member'>amcanorder</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * If it supports sort ordering, copy DESC and NULLS opts. Don't 
             * set non-default settings unnecessarily, though, so as to 
             * improve the chance of recognizing equivalence to constraint 
             * indexes. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1435"><span class='Ref_To_Local'>opt</span></a> <span class='Operator'>& </span><a href="../../include/catalog/pg_index.h.html#LN98"><span class='Ref_to_Const'>INDOPTION_DESC</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="parse_utilcmd.c.html#LN1433"><span class='Ref_To_Local'>iparam</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN693"><span class='Ref_to_Member'>ordering</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN51"><span class='Ref_to_EnumConst'>SORTBY_DESC</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="parse_utilcmd.c.html#LN1435"><span class='Ref_To_Local'>opt</span></a> <span class='Operator'>& </span><a href="../../include/catalog/pg_index.h.html#LN99"><span class='Ref_to_Const'>INDOPTION_NULLS_FIRST</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                    <a href="parse_utilcmd.c.html#LN1433"><span class='Ref_To_Local'>iparam</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN694"><span class='Ref_to_Member'>nulls_ordering</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN59"><span class='Ref_to_EnumConst'>SORTBY_NULLS_LAST</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1435"><span class='Ref_To_Local'>opt</span></a> <span class='Operator'>& </span><a href="../../include/catalog/pg_index.h.html#LN99"><span class='Ref_to_Const'>INDOPTION_NULLS_FIRST</span></a><span class='Parentheses'>) 
</span>                    <a href="parse_utilcmd.c.html#LN1433"><span class='Ref_To_Local'>iparam</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN694"><span class='Ref_to_Member'>nulls_ordering</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN58"><span class='Ref_to_EnumConst'>SORTBY_NULLS_FIRST</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if source_idx-&GT;rd_amrout... &raquo; </span> 
 
        <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2674"><span class='Ref_to_Member'>indexParams</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2674"><span class='Ref_to_Member'>indexParams</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1433"><span class='Ref_To_Local'>iparam</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for keyno=0;keyno&LT;idxrec-... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Copy reloptions if any */ 
</span>    <a href="parse_utilcmd.c.html#LN1272"><span class='Ref_To_Local'>datum</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN133"><span class='Ref_to_Proto'>SysCacheGetAttr</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN83"><span class='Ref_to_EnumConst'>RELOID</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1258"><span class='Ref_To_Local'>ht_idxrel</span></a><span class='Delimiter'>, 
</span>                            <a href="../../include/catalog/pg_class.h.html#LN133"><span class='Ref_to_Const'>Anum_pg_class_reloptions</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN1273"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_utilcmd.c.html#LN1273"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>) 
</span>        <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2675"><span class='Ref_to_Member'>options</span></a> <span class='Operator'>= </span><a href="../../include/access/reloptions.h.html#LN260"><span class='Ref_to_Proto'>untransformRelOptions</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1272"><span class='Ref_To_Local'>datum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* If it's a partial index, decompile and append the predicate */ 
</span>    <a href="parse_utilcmd.c.html#LN1272"><span class='Ref_To_Local'>datum</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN133"><span class='Ref_to_Proto'>SysCacheGetAttr</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN65"><span class='Ref_to_EnumConst'>INDEXRELID</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1259"><span class='Ref_To_Local'>ht_idx</span></a><span class='Delimiter'>, 
</span>                            <a href="../../include/catalog/pg_index.h.html#LN91"><span class='Ref_to_Const'>Anum_pg_index_indpred</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN1273"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_utilcmd.c.html#LN1273"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1529"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>pred_str</span><span class='Delimiter'>; 
</span><a name="LN1530"></a>        <a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>pred_tree</span><span class='Delimiter'>; 
</span><a name="LN1531"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>found_whole_row</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Convert text string to node tree */ 
</span>        <a href="parse_utilcmd.c.html#LN1529"><span class='Ref_To_Local'>pred_str</span></a> <span class='Operator'>= </span><a href="../../include/utils/builtins.h.html#LN91"><span class='Ref_to_Macro'>TextDatumGetCString</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1272"><span class='Ref_To_Local'>datum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1530"><span class='Ref_To_Local'>pred_tree</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../nodes/read.c.html#LN36"><span class='Ref_to_Func'>stringToNode</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1529"><span class='Ref_To_Local'>pred_str</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Adjust Vars to match new table's column numbering */ 
</span>        <a href="parse_utilcmd.c.html#LN1530"><span class='Ref_To_Local'>pred_tree</span></a> <span class='Operator'>= </span><a href="../../include/rewrite/rewriteManip.h.html#LN71"><span class='Ref_to_Proto'>map_variable_attnos</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1530"><span class='Ref_To_Local'>pred_tree</span></a><span class='Delimiter'>, 
</span>                                        <span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, 
</span>                                        <a href="parse_utilcmd.c.html#LN1254"><span class='Ref_to_Parameter'>attmap</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1254"><span class='Ref_to_Parameter'>attmap_length</span></a><span class='Delimiter'>, 
</span>                                        <span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN1531"><span class='Ref_To_Local'>found_whole_row</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* As in transformTableLikeClause, reject whole-row variables */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1531"><span class='Ref_To_Local'>found_whole_row</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot convert whole-row table reference"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>              <a href="../utils/error/elog.c.html#LN871"><span class='Ref_to_Func'>errdetail</span></a><span class='Parentheses'>(</span><span class='String'>"Index \"%s\" contains a whole-row table reference."</span><span class='Delimiter'>, 
</span>                        <a href="../../include/utils/rel.h.html#LN436"><span class='Ref_to_Macro'>RelationGetRelationName</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1253"><span class='Ref_to_Parameter'>source_idx</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
        <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2676"><span class='Ref_to_Member'>whereClause</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1530"><span class='Ref_To_Local'>pred_tree</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if !isnull &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Clean up */ 
</span>    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1258"><span class='Ref_To_Local'>ht_idxrel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1260"><span class='Ref_To_Local'>ht_am</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="parse_utilcmd.c.html#LN1266"><span class='Ref_To_Local'>index</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end generateClonedIndexStmt &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * get_collation        - fetch qualified name of a collation 
 * 
 * If collation is InvalidOid or is the default for the given actual_datatype, 
 * then the return value is NIL. 
 */ 
</span><span class='Keyword'>static </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>* 
</span><a name="LN1568"></a><span class='Declare_Function'>get_collation</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>collation</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>actual_datatype</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1570"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1571"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>ht_coll</span><span class='Delimiter'>; 
</span><a name="LN1572"></a>    <a href="../../include/catalog/pg_collation.h.html#LN51"><span class='Ref_to_Typedef'>Form_pg_collation</span></a> <span class='Declare_Local'>coll_rec</span><span class='Delimiter'>; 
</span><a name="LN1573"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>nsp_name</span><span class='Delimiter'>; 
</span><a name="LN1574"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>coll_name</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1568"><span class='Ref_to_Parameter'>collation</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>;</span>             <span class='Comment_Single_Line'>/* easy case */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1568"><span class='Ref_to_Parameter'>collation</span></a> <span class='Operator'>== </span><a href="../../include/utils/lsyscache.h.html#LN166"><span class='Ref_to_Proto'>get_typcollation</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1568"><span class='Ref_to_Parameter'>actual_datatype</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>;</span>             <span class='Comment_Single_Line'>/* just let it default */ 
</span> 
    <a href="parse_utilcmd.c.html#LN1571"><span class='Ref_To_Local'>ht_coll</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN49"><span class='Ref_to_EnumConst'>COLLOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1568"><span class='Ref_to_Parameter'>collation</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1571"><span class='Ref_To_Local'>ht_coll</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for collation %u"</span><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1568"><span class='Ref_to_Parameter'>collation</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1572"><span class='Ref_To_Local'>coll_rec</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_collation.h.html#LN51"><span class='Ref_to_Typedef'>Form_pg_collation</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1571"><span class='Ref_To_Local'>ht_coll</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* For simplicity, we always schema-qualify the name */ 
</span>    <a href="parse_utilcmd.c.html#LN1573"><span class='Ref_To_Local'>nsp_name</span></a> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN175"><span class='Ref_to_Proto'>get_namespace_name</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1572"><span class='Ref_To_Local'>coll_rec</span></a><span class='Operator'>-&GT;</span>collnamespace<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1574"><span class='Ref_To_Local'>coll_name</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1572"><span class='Ref_To_Local'>coll_rec</span></a><span class='Operator'>-&GT;</span>collname<span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1570"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN139"><span class='Ref_to_Macro'>list_make2</span></a><span class='Parentheses'>(</span><a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1573"><span class='Ref_To_Local'>nsp_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1574"><span class='Ref_To_Local'>coll_name</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1571"><span class='Ref_To_Local'>ht_coll</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="parse_utilcmd.c.html#LN1570"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end get_collation &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * get_opclass          - fetch qualified name of an index operator class 
 * 
 * If the opclass is the default for the given actual_datatype, then 
 * the return value is NIL. 
 */ 
</span><span class='Keyword'>static </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>* 
</span><a name="LN1602"></a><span class='Declare_Function'>get_opclass</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>opclass</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>actual_datatype</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1604"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>result</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN1605"></a>    <a href="../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>ht_opc</span><span class='Delimiter'>; 
</span><a name="LN1606"></a>    <a href="../../include/catalog/pg_opclass.h.html#LN67"><span class='Ref_to_Typedef'>Form_pg_opclass</span></a> <span class='Declare_Local'>opc_rec</span><span class='Delimiter'>; 
</span> 
    <a href="parse_utilcmd.c.html#LN1605"><span class='Ref_To_Local'>ht_opc</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN155"><span class='Ref_to_Macro'>SearchSysCache1</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN47"><span class='Ref_to_EnumConst'>CLAOID</span></a><span class='Delimiter'>, </span><a href="../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1602"><span class='Ref_to_Parameter'>opclass</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/access/htup.h.html#LN76"><span class='Ref_to_Macro'>HeapTupleIsValid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1605"><span class='Ref_To_Local'>ht_opc</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cache lookup failed for opclass %u"</span><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1602"><span class='Ref_to_Parameter'>opclass</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1606"><span class='Ref_To_Local'>opc_rec</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_opclass.h.html#LN67"><span class='Ref_to_Typedef'>Form_pg_opclass</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1605"><span class='Ref_To_Local'>ht_opc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/commands/defrem.h.html#LN44"><span class='Ref_to_Proto'>GetDefaultOpClass</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1602"><span class='Ref_to_Parameter'>actual_datatype</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1606"><span class='Ref_To_Local'>opc_rec</span></a><span class='Operator'>-&GT;</span>opcmethod<span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="parse_utilcmd.c.html#LN1602"><span class='Ref_to_Parameter'>opclass</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* For simplicity, we always schema-qualify the name */ 
</span><a name="LN1616"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>nsp_name</span> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN175"><span class='Ref_to_Proto'>get_namespace_name</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1606"><span class='Ref_To_Local'>opc_rec</span></a><span class='Operator'>-&GT;</span>opcnamespace<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1617"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>opc_name</span> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1606"><span class='Ref_To_Local'>opc_rec</span></a><span class='Operator'>-&GT;</span>opcname<span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <a href="parse_utilcmd.c.html#LN1604"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN139"><span class='Ref_to_Macro'>list_make2</span></a><span class='Parentheses'>(</span><a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1616"><span class='Ref_To_Local'>nsp_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1617"><span class='Ref_To_Local'>opc_name</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1605"><span class='Ref_To_Local'>ht_opc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="parse_utilcmd.c.html#LN1604"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end get_opclass &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * transformIndexConstraints 
 *      Handle UNIQUE, PRIMARY KEY, EXCLUDE constraints, which create indexes. 
 *      We also merge in any index definitions arising from 
 *      LIKE ... INCLUDING INDEXES. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN1634"></a><span class='Declare_Function'>transformIndexConstraints</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cxt</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1636"></a>    <a href="../../include/nodes/parsenodes.h.html#LN2667"><span class='Ref_to_Struct'>IndexStmt</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>index</span><span class='Delimiter'>; 
</span><a name="LN1637"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>indexlist</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN1638"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Run through the constraints that need to generate an index. For PRIMARY 
     * KEY, mark each column as NOT NULL and create an index. For UNIQUE or 
     * EXCLUDE, create an index as for PRIMARY KEY, but do not insist on NOT 
     * NULL. 
     */ 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1638"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1634"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN85"><span class='Ref_to_Member'>ixconstraints</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1648"></a>        <a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a> <span class='Operator'>*</span><span class='Declare_Local'>constraint</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN108"><span class='Ref_to_Macro'>lfirst_node</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1638"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1648"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2053"><span class='Ref_to_Member'>contype</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN2028"><span class='Ref_to_EnumConst'>CONSTR_PRIMARY</span></a> <span class='Operator'>|| 
</span>               <a href="parse_utilcmd.c.html#LN1648"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2053"><span class='Ref_to_Member'>contype</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN2029"><span class='Ref_to_EnumConst'>CONSTR_UNIQUE</span></a> <span class='Operator'>|| 
</span>               <a href="parse_utilcmd.c.html#LN1648"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2053"><span class='Ref_to_Member'>contype</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN2030"><span class='Ref_to_EnumConst'>CONSTR_EXCLUSION</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="parse_utilcmd.c.html#LN1636"><span class='Ref_To_Local'>index</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN125"><span class='Ref_to_Proto'>transformIndexConstraint</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1648"><span class='Ref_To_Local'>constraint</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1634"><span class='Ref_to_Parameter'>cxt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="parse_utilcmd.c.html#LN1637"><span class='Ref_To_Local'>indexlist</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1637"><span class='Ref_To_Local'>indexlist</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1636"><span class='Ref_To_Local'>index</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Add in any indexes defined by LIKE ... INCLUDING INDEXES */ 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1638"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1634"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN86"><span class='Ref_to_Member'>inh_indexes</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="parse_utilcmd.c.html#LN1636"><span class='Ref_To_Local'>index</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2667"><span class='Ref_to_Struct'>IndexStmt</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1638"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1636"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2682"><span class='Ref_to_Member'>primary</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1634"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN91"><span class='Ref_to_Member'>pkey</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_TABLE_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"multiple primary keys for table \"%s\" are not allowed"</span><span class='Delimiter'>, 
</span>                                <a href="parse_utilcmd.c.html#LN1634"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN76"><span class='Ref_to_Member'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN1634"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN91"><span class='Ref_to_Member'>pkey</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1636"><span class='Ref_To_Local'>index</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="parse_utilcmd.c.html#LN1637"><span class='Ref_To_Local'>indexlist</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1637"><span class='Ref_To_Local'>indexlist</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1636"><span class='Ref_To_Local'>index</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Scan the index list and remove any redundant index specifications. This 
     * can happen if, for instance, the user writes UNIQUE PRIMARY KEY. A 
     * strict reading of SQL would suggest raising an error instead, but that 
     * strikes me as too anal-retentive. - tgl 2001-02-14 
     * 
     * XXX in ALTER TABLE case, it'd be nice to look for duplicate 
     * pre-existing indexes, too. 
     */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1634"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a> <span class='Operator'>== </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1634"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN91"><span class='Ref_to_Member'>pkey</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Make sure we keep the PKEY index in preference to others... */ 
</span>        <a href="parse_utilcmd.c.html#LN1634"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN138"><span class='Ref_to_Macro'>list_make1</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1634"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN91"><span class='Ref_to_Member'>pkey</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1638"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1637"><span class='Ref_To_Local'>indexlist</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1695"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>keep</span> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span><a name="LN1696"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>k</span><span class='Delimiter'>; 
</span> 
        <a href="parse_utilcmd.c.html#LN1636"><span class='Ref_To_Local'>index</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1638"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* if it's pkey, it's already in cxt-&GT;alist */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1636"><span class='Ref_To_Local'>index</span></a> <span class='Operator'>== </span><a href="parse_utilcmd.c.html#LN1634"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN91"><span class='Ref_to_Member'>pkey</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1696"><span class='Ref_To_Local'>k</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1634"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN1706"></a>            <a href="../../include/nodes/parsenodes.h.html#LN2667"><span class='Ref_to_Struct'>IndexStmt</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>priorindex</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1696"><span class='Ref_To_Local'>k</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN626"><span class='Ref_to_Proto'>equal</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1636"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2674"><span class='Ref_to_Member'>indexParams</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1706"><span class='Ref_To_Local'>priorindex</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2674"><span class='Ref_to_Member'>indexParams</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>                <a href="../../include/nodes/nodes.h.html#LN626"><span class='Ref_to_Proto'>equal</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1636"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2676"><span class='Ref_to_Member'>whereClause</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1706"><span class='Ref_To_Local'>priorindex</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2676"><span class='Ref_to_Member'>whereClause</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>                <a href="../../include/nodes/nodes.h.html#LN626"><span class='Ref_to_Proto'>equal</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1636"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2677"><span class='Ref_to_Member'>excludeOpNames</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1706"><span class='Ref_To_Local'>priorindex</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2677"><span class='Ref_to_Member'>excludeOpNames</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>                strcmp<span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1636"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2672"><span class='Ref_to_Member'>accessMethod</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1706"><span class='Ref_To_Local'>priorindex</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2672"><span class='Ref_to_Member'>accessMethod</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>&& 
</span>                <a href="parse_utilcmd.c.html#LN1636"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2684"><span class='Ref_to_Member'>deferrable</span></a> <span class='Operator'>== </span><a href="parse_utilcmd.c.html#LN1706"><span class='Ref_To_Local'>priorindex</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2684"><span class='Ref_to_Member'>deferrable</span></a> <span class='Operator'>&& 
</span>                <a href="parse_utilcmd.c.html#LN1636"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2685"><span class='Ref_to_Member'>initdeferred</span></a> <span class='Operator'>== </span><a href="parse_utilcmd.c.html#LN1706"><span class='Ref_To_Local'>priorindex</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2685"><span class='Ref_to_Member'>initdeferred</span></a><span class='Parentheses'>)</span> 
            <span class='Delimiter'>{ 
</span>                <a href="parse_utilcmd.c.html#LN1706"><span class='Ref_To_Local'>priorindex</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2681"><span class='Ref_to_Member'>unique</span></a> <span class='Operator'>|= </span><a href="parse_utilcmd.c.html#LN1636"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2681"><span class='Ref_to_Member'>unique</span></a><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* 
                 * If the prior index is as yet unnamed, and this one is 
                 * named, then transfer the name to the prior index. This 
                 * ensures that if we have named and unnamed constraints, 
                 * we'll use (at least one of) the names for the index. 
                 */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1706"><span class='Ref_To_Local'>priorindex</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2670"><span class='Ref_to_Member'>idxname</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                    <a href="parse_utilcmd.c.html#LN1706"><span class='Ref_To_Local'>priorindex</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2670"><span class='Ref_to_Member'>idxname</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1636"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2670"><span class='Ref_to_Member'>idxname</span></a><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN1695"><span class='Ref_To_Local'>keep</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if equal(index-&GT;indexPar... &raquo; </span> 
        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1695"><span class='Ref_To_Local'>keep</span></a><span class='Parentheses'>) 
</span>            <a href="parse_utilcmd.c.html#LN1634"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1634"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1636"><span class='Ref_To_Local'>index</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end transformIndexConstraints &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * transformIndexConstraint 
 *      Transform one UNIQUE, PRIMARY KEY, or EXCLUDE constraint for 
 *      transformIndexConstraints. 
 */ 
</span><span class='Keyword'>static </span><a href="../../include/nodes/parsenodes.h.html#LN2667"><span class='Ref_to_Struct'>IndexStmt</span></a> <span class='Operator'>* 
</span><a name="LN1741"></a><span class='Declare_Function'>transformIndexConstraint</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>constraint</span><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cxt</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1743"></a>    <a href="../../include/nodes/parsenodes.h.html#LN2667"><span class='Ref_to_Struct'>IndexStmt</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>index</span><span class='Delimiter'>; 
</span><a name="LN1744"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span> 
    <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2667"><span class='Ref_to_Struct'>IndexStmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2681"><span class='Ref_to_Member'>unique</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2053"><span class='Ref_to_Member'>contype</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/parsenodes.h.html#LN2030"><span class='Ref_to_EnumConst'>CONSTR_EXCLUSION</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2682"><span class='Ref_to_Member'>primary</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2053"><span class='Ref_to_Member'>contype</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN2028"><span class='Ref_to_EnumConst'>CONSTR_PRIMARY</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2682"><span class='Ref_to_Member'>primary</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN91"><span class='Ref_to_Member'>pkey</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_TABLE_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"multiple primary keys for table \"%s\" are not allowed"</span><span class='Delimiter'>, 
</span>                    <a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN76"><span class='Ref_to_Member'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN91"><span class='Ref_to_Member'>pkey</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * In ALTER TABLE case, a primary index might already exist, but 
         * DefineIndex will check for it. 
         */ 
</span>    <span class='Delimiter'>} 
</span>    <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2683"><span class='Ref_to_Member'>isconstraint</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2684"><span class='Ref_to_Member'>deferrable</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2057"><span class='Ref_to_Member'>deferrable</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2685"><span class='Ref_to_Member'>initdeferred</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2058"><span class='Ref_to_Member'>initdeferred</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2056"><span class='Ref_to_Member'>conname</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2670"><span class='Ref_to_Member'>idxname</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2056"><span class='Ref_to_Member'>conname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2670"><span class='Ref_to_Member'>idxname</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>  <span class='Comment_Single_Line'>/* DefineIndex will choose name */ 
</span> 
    <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2671"><span class='Ref_to_Member'>relation</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN76"><span class='Ref_to_Member'>relation</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2672"><span class='Ref_to_Member'>accessMethod</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2078"><span class='Ref_to_Member'>access_method</span></a> <span class='Operator'>? </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2078"><span class='Ref_to_Member'>access_method</span></a> <span class='Operator'>: </span><a href="../../include/catalog/index.h.html#LN20"><span class='Ref_to_Const'>DEFAULT_INDEX_TYPE</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2675"><span class='Ref_to_Member'>options</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2074"><span class='Ref_to_Member'>options</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2673"><span class='Ref_to_Member'>tableSpace</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2076"><span class='Ref_to_Member'>indexspace</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2676"><span class='Ref_to_Member'>whereClause</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2079"><span class='Ref_to_Member'>where_clause</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2674"><span class='Ref_to_Member'>indexParams</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2677"><span class='Ref_to_Member'>excludeOpNames</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2678"><span class='Ref_to_Member'>idxcomment</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2679"><span class='Ref_to_Member'>indexOid</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2680"><span class='Ref_to_Member'>oldNode</span></a> <span class='Operator'>= </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2686"><span class='Ref_to_Member'>transformed</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2687"><span class='Ref_to_Member'>concurrent</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2688"><span class='Ref_to_Member'>if_not_exists</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If it's ALTER TABLE ADD CONSTRAINT USING INDEX, look up the index and 
     * verify it's usable, then extract the implied column name list.  (We 
     * will not actually need the column name list at runtime, but we need it 
     * now to check for duplicate column entries below.) 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2075"><span class='Ref_to_Member'>indexname</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1796"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>index_name</span> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2075"><span class='Ref_to_Member'>indexname</span></a><span class='Delimiter'>; 
</span><a name="LN1797"></a>        <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>heap_rel</span> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN77"><span class='Ref_to_Member'>rel</span></a><span class='Delimiter'>; 
</span><a name="LN1798"></a>        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>index_oid</span><span class='Delimiter'>; 
</span><a name="LN1799"></a>        <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>index_rel</span><span class='Delimiter'>; 
</span><a name="LN1800"></a>        <a href="../../include/catalog/pg_index.h.html#LN66"><span class='Ref_to_Typedef'>Form_pg_index</span></a> <span class='Declare_Local'>index_form</span><span class='Delimiter'>; 
</span><a name="LN1801"></a>        <a href="../../include/c.h.html#LN477"><span class='Ref_to_Typedef'>oidvector</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>indclass</span><span class='Delimiter'>; 
</span><a name="LN1802"></a>        <a href="../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>indclassDatum</span><span class='Delimiter'>; 
</span><a name="LN1803"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>isnull</span><span class='Delimiter'>; 
</span><a name="LN1804"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Grammar should not allow this with explicit column list */ 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2068"><span class='Ref_to_Member'>keys</span></a> <span class='Operator'>== </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Grammar should only allow PRIMARY and UNIQUE constraints */ 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2053"><span class='Ref_to_Member'>contype</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN2028"><span class='Ref_to_EnumConst'>CONSTR_PRIMARY</span></a> <span class='Operator'>|| 
</span>               <a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2053"><span class='Ref_to_Member'>contype</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN2029"><span class='Ref_to_EnumConst'>CONSTR_UNIQUE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Must be ALTER, not CREATE, but grammar doesn't enforce that */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN80"><span class='Ref_to_Member'>isalter</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot use an existing index in CREATE TABLE"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Look for the index in the same schema as the table */ 
</span>        <a href="parse_utilcmd.c.html#LN1798"><span class='Ref_To_Local'>index_oid</span></a> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN123"><span class='Ref_to_Proto'>get_relname_relid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1796"><span class='Ref_To_Local'>index_name</span></a><span class='Delimiter'>, </span><a href="../../include/utils/rel.h.html#LN443"><span class='Ref_to_Macro'>RelationGetNamespace</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1797"><span class='Ref_To_Local'>heap_rel</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1798"><span class='Ref_To_Local'>index_oid</span></a><span class='Parentheses'>))</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_OBJECT<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"index \"%s\" does not exist"</span><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1796"><span class='Ref_To_Local'>index_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Open the index (this will throw an error if it is not an index) */ 
</span>        <a href="parse_utilcmd.c.html#LN1799"><span class='Ref_To_Local'>index_rel</span></a> <span class='Operator'>= </span><a href="../../include/access/genam.h.html#LN129"><span class='Ref_to_Proto'>index_open</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1798"><span class='Ref_To_Local'>index_oid</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN35"><span class='Ref_to_Const'>AccessShareLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1800"><span class='Ref_To_Local'>index_form</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1799"><span class='Ref_To_Local'>index_rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN158"><span class='Ref_to_Member'>rd_index</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Check that it does not have an associated constraint already */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/dependency.h.html#LN246"><span class='Ref_to_Proto'>get_index_constraint</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1798"><span class='Ref_To_Local'>index_oid</span></a><span class='Parentheses'>)))</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_OBJECT_NOT_IN_PREREQUISITE_STATE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>               <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"index \"%s\" is already associated with a constraint"</span><span class='Delimiter'>, 
</span>                      <a href="parse_utilcmd.c.html#LN1796"><span class='Ref_To_Local'>index_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Perform validity checks on the index */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1800"><span class='Ref_To_Local'>index_form</span></a><span class='Operator'>-&GT;</span>indrelid <span class='Operator'>!= </span><a href="../../include/utils/rel.h.html#LN416"><span class='Ref_to_Macro'>RelationGetRelid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1797"><span class='Ref_To_Local'>heap_rel</span></a><span class='Parentheses'>))</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_OBJECT_NOT_IN_PREREQUISITE_STATE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"index \"%s\" does not belong to table \"%s\""</span><span class='Delimiter'>, 
</span>                            <a href="parse_utilcmd.c.html#LN1796"><span class='Ref_To_Local'>index_name</span></a><span class='Delimiter'>, </span><a href="../../include/utils/rel.h.html#LN436"><span class='Ref_to_Macro'>RelationGetRelationName</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1797"><span class='Ref_To_Local'>heap_rel</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, 
</span>                     <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/catalog/pg_index.h.html#LN106"><span class='Ref_to_Macro'>IndexIsValid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1800"><span class='Ref_To_Local'>index_form</span></a><span class='Parentheses'>))</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_OBJECT_NOT_IN_PREREQUISITE_STATE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"index \"%s\" is not valid"</span><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1796"><span class='Ref_To_Local'>index_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_utilcmd.c.html#LN1800"><span class='Ref_To_Local'>index_form</span></a><span class='Operator'>-&GT;</span>indisunique<span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_WRONG_OBJECT_TYPE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"\"%s\" is not a unique index"</span><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1796"><span class='Ref_To_Local'>index_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN871"><span class='Ref_to_Func'>errdetail</span></a><span class='Parentheses'>(</span><span class='String'>"Cannot create a primary key or unique constraint using such an index."</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/utils/relcache.h.html#LN45"><span class='Ref_to_Proto'>RelationGetIndexExpressions</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1799"><span class='Ref_To_Local'>index_rel</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_WRONG_OBJECT_TYPE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"index \"%s\" contains expressions"</span><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1796"><span class='Ref_To_Local'>index_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN871"><span class='Ref_to_Func'>errdetail</span></a><span class='Parentheses'>(</span><span class='String'>"Cannot create a primary key or unique constraint using such an index."</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/utils/relcache.h.html#LN46"><span class='Ref_to_Proto'>RelationGetIndexPredicate</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1799"><span class='Ref_To_Local'>index_rel</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_WRONG_OBJECT_TYPE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"\"%s\" is a partial index"</span><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1796"><span class='Ref_To_Local'>index_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN871"><span class='Ref_to_Func'>errdetail</span></a><span class='Parentheses'>(</span><span class='String'>"Cannot create a primary key or unique constraint using such an index."</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * It's probably unsafe to change a deferred index to non-deferred. (A 
         * non-constraint index couldn't be deferred anyway, so this case 
         * should never occur; no need to sweat, but let's check it.) 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_utilcmd.c.html#LN1800"><span class='Ref_To_Local'>index_form</span></a><span class='Operator'>-&GT;</span>indimmediate <span class='Operator'>&& !</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2057"><span class='Ref_to_Member'>deferrable</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_WRONG_OBJECT_TYPE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"\"%s\" is a deferrable index"</span><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1796"><span class='Ref_To_Local'>index_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN871"><span class='Ref_to_Func'>errdetail</span></a><span class='Parentheses'>(</span><span class='String'>"Cannot create a non-deferrable constraint using a deferrable index."</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Insist on it being a btree.  That's the only kind that supports 
         * uniqueness at the moment anyway; but we must have an index that 
         * exactly matches what you'd get from plain ADD CONSTRAINT syntax, 
         * else dump and reload will produce a different index (breaking 
         * pg_upgrade in particular). 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1799"><span class='Ref_To_Local'>index_rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relam <span class='Operator'>!= </span><a href="../../include/commands/defrem.h.html#LN150"><span class='Ref_to_Proto'>get_index_am_oid</span></a><span class='Parentheses'>(</span><a href="../../include/catalog/index.h.html#LN20"><span class='Ref_to_Const'>DEFAULT_INDEX_TYPE</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>))</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_WRONG_OBJECT_TYPE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"index \"%s\" is not a btree"</span><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1796"><span class='Ref_To_Local'>index_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Must get indclass the hard way */ 
</span>        <a href="parse_utilcmd.c.html#LN1802"><span class='Ref_To_Local'>indclassDatum</span></a> <span class='Operator'>= </span><a href="../../include/utils/syscache.h.html#LN133"><span class='Ref_to_Proto'>SysCacheGetAttr</span></a><span class='Parentheses'>(</span><a href="../../include/utils/syscache.h.html#LN65"><span class='Ref_to_EnumConst'>INDEXRELID</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1799"><span class='Ref_To_Local'>index_rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN160"><span class='Ref_to_Member'>rd_indextuple</span></a><span class='Delimiter'>, 
</span>                                        <a href="../../include/catalog/pg_index.h.html#LN88"><span class='Ref_to_Const'>Anum_pg_index_indclass</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN1803"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_utilcmd.c.html#LN1803"><span class='Ref_To_Local'>isnull</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1801"><span class='Ref_To_Local'>indclass</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/c.h.html#LN477"><span class='Ref_to_Typedef'>oidvector</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/postgres.h.html#LN554"><span class='Ref_to_Macro'>DatumGetPointer</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1802"><span class='Ref_To_Local'>indclassDatum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1804"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="parse_utilcmd.c.html#LN1804"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="parse_utilcmd.c.html#LN1800"><span class='Ref_To_Local'>index_form</span></a><span class='Operator'>-&GT;</span>indnatts<span class='Delimiter'>; </span><a href="parse_utilcmd.c.html#LN1804"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN1909"></a>            <a href="../../include/c.h.html#LN254"><span class='Ref_to_Typedef'>int16</span></a>       <span class='Declare_Local'>attnum</span> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1800"><span class='Ref_To_Local'>index_form</span></a><span class='Operator'>-&GT;</span>indkey<span class='Operator'>.</span>values<span class='Delimiter'>[</span><a href="parse_utilcmd.c.html#LN1804"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span><a name="LN1910"></a>            <a href="../../include/catalog/pg_attribute.h.html#LN186"><span class='Ref_to_Typedef'>Form_pg_attribute</span></a> <span class='Declare_Local'>attform</span><span class='Delimiter'>; 
</span><a name="LN1911"></a>            <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>attname</span><span class='Delimiter'>; 
</span><a name="LN1912"></a>            <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>defopclass</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * We shouldn't see attnum == 0 here, since we already rejected 
             * expression indexes.  If we do, SystemAttributeDefinition will 
             * throw an error. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1909"><span class='Ref_To_Local'>attnum</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1909"><span class='Ref_To_Local'>attnum</span></a> <span class='Operator'>&LT;= </span><a href="parse_utilcmd.c.html#LN1797"><span class='Ref_To_Local'>heap_rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN114"><span class='Ref_to_Member'>rd_att</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN1910"><span class='Ref_To_Local'>attform</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1797"><span class='Ref_To_Local'>heap_rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN114"><span class='Ref_to_Member'>rd_att</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN73"><span class='Ref_to_Member'>attrs</span></a><span class='Delimiter'>[</span><a href="parse_utilcmd.c.html#LN1909"><span class='Ref_To_Local'>attnum</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
                <a href="parse_utilcmd.c.html#LN1910"><span class='Ref_To_Local'>attform</span></a> <span class='Operator'>= </span><a href="../../include/catalog/heap.h.html#LN122"><span class='Ref_to_Proto'>SystemAttributeDefinition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1909"><span class='Ref_To_Local'>attnum</span></a><span class='Delimiter'>, 
</span>                                               <a href="parse_utilcmd.c.html#LN1797"><span class='Ref_To_Local'>heap_rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relhasoids<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN1911"><span class='Ref_To_Local'>attname</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1910"><span class='Ref_To_Local'>attform</span></a><span class='Operator'>-&GT;</span>attname<span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Insist on default opclass and sort options.  While the index 
             * would still work as a constraint with non-default settings, it 
             * might not provide exactly the same uniqueness semantics as 
             * you'd get from a normally-created constraint; and there's also 
             * the dump/reload problem mentioned above. 
             */ 
</span>            <a href="parse_utilcmd.c.html#LN1912"><span class='Ref_To_Local'>defopclass</span></a> <span class='Operator'>= </span><a href="../../include/commands/defrem.h.html#LN44"><span class='Ref_to_Proto'>GetDefaultOpClass</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1910"><span class='Ref_To_Local'>attform</span></a><span class='Operator'>-&GT;</span>atttypid<span class='Delimiter'>, 
</span>                                           <a href="parse_utilcmd.c.html#LN1799"><span class='Ref_To_Local'>index_rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relam<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1801"><span class='Ref_To_Local'>indclass</span></a><span class='Operator'>-&GT;</span><a href="../../include/c.h.html#LN485"><span class='Ref_to_Member'>values</span></a><span class='Delimiter'>[</span><a href="parse_utilcmd.c.html#LN1804"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>!= </span><a href="parse_utilcmd.c.html#LN1912"><span class='Ref_To_Local'>defopclass</span></a> <span class='Operator'>|| 
</span>                <a href="parse_utilcmd.c.html#LN1799"><span class='Ref_To_Local'>index_rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN185"><span class='Ref_to_Member'>rd_indoption</span></a><span class='Delimiter'>[</span><a href="parse_utilcmd.c.html#LN1804"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_WRONG_OBJECT_TYPE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"index \"%s\" does not have default sorting behavior"</span><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1796"><span class='Ref_To_Local'>index_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN871"><span class='Ref_to_Func'>errdetail</span></a><span class='Parentheses'>(</span><span class='String'>"Cannot create a primary key or unique constraint using such an index."</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
            <a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2068"><span class='Ref_to_Member'>keys</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2068"><span class='Ref_to_Member'>keys</span></a><span class='Delimiter'>, </span><a href="../nodes/value.c.html#LN51"><span class='Ref_to_Func'>makeString</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1911"><span class='Ref_To_Local'>attname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=0;i&LT;index_form-&GT;ind... &raquo; </span> 
 
        <span class='Comment_Multi_Line'>/* Close the index relation but keep the lock */ 
</span>        <a href="../../include/access/heapam.h.html#LN89"><span class='Ref_to_Proto'>relation_close</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1799"><span class='Ref_To_Local'>index_rel</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN33"><span class='Ref_to_Const'>NoLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2679"><span class='Ref_to_Member'>indexOid</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN1798"><span class='Ref_To_Local'>index_oid</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if constraint-&GT;indexname... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* 
     * If it's an EXCLUDE constraint, the grammar returns a list of pairs of 
     * IndexElems and operator names.  We have to break that apart into 
     * separate lists. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2053"><span class='Ref_to_Member'>contype</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN2030"><span class='Ref_to_EnumConst'>CONSTR_EXCLUSION</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1744"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2071"><span class='Ref_to_Member'>exclusions</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN1964"></a>            <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>pair</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1744"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1965"></a>            <a href="../../include/nodes/parsenodes.h.html#LN685"><span class='Ref_to_Struct'>IndexElem</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>elem</span><span class='Delimiter'>; 
</span><a name="LN1966"></a>            <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>opname</span><span class='Delimiter'>; 
</span> 
            <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1964"><span class='Ref_To_Local'>pair</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN1965"><span class='Ref_To_Local'>elem</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN113"><span class='Ref_to_Macro'>linitial_node</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN685"><span class='Ref_to_Struct'>IndexElem</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1964"><span class='Ref_To_Local'>pair</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN1966"><span class='Ref_To_Local'>opname</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN118"><span class='Ref_to_Macro'>lsecond_node</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1964"><span class='Ref_To_Local'>pair</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2674"><span class='Ref_to_Member'>indexParams</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2674"><span class='Ref_to_Member'>indexParams</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1965"><span class='Ref_To_Local'>elem</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2677"><span class='Ref_to_Member'>excludeOpNames</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2677"><span class='Ref_to_Member'>excludeOpNames</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1966"><span class='Ref_To_Local'>opname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>return</span> <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * For UNIQUE and PRIMARY KEY, we just have a list of column names. 
     * 
     * Make sure referenced keys exist.  If we are making a PRIMARY KEY index, 
     * also make sure they are NOT NULL, if possible. (Although we could leave 
     * it to DefineIndex to mark the columns NOT NULL, it's more efficient to 
     * get it right the first time.) 
     */ 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1744"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2068"><span class='Ref_to_Member'>keys</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1989"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>key</span> <span class='Operator'>= </span><a href="../../include/nodes/value.h.html#LN53"><span class='Ref_to_Macro'>strVal</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1744"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span><a name="LN1990"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>found</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN1991"></a>        <a href="../../include/nodes/parsenodes.h.html#LN636"><span class='Ref_to_Struct'>ColumnDef</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>column</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN1992"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>columns</span><span class='Delimiter'>; 
</span><a name="LN1993"></a>        <a href="../../include/nodes/parsenodes.h.html#LN685"><span class='Ref_to_Struct'>IndexElem</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>iparam</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1992"><span class='Ref_To_Local'>columns</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN82"><span class='Ref_to_Member'>columns</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="parse_utilcmd.c.html#LN1991"><span class='Ref_To_Local'>column</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN108"><span class='Ref_to_Macro'>lfirst_node</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN636"><span class='Ref_to_Struct'>ColumnDef</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1992"><span class='Ref_To_Local'>columns</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1991"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN639"><span class='Ref_to_Member'>colname</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1989"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Delimiter'>{ 
</span>                <a href="parse_utilcmd.c.html#LN1990"><span class='Ref_To_Local'>found</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1990"><span class='Ref_To_Local'>found</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* found column in the new table; force it to be NOT NULL */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2053"><span class='Ref_to_Member'>contype</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN2028"><span class='Ref_to_EnumConst'>CONSTR_PRIMARY</span></a><span class='Parentheses'>) 
</span>                <a href="parse_utilcmd.c.html#LN1991"><span class='Ref_To_Local'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN643"><span class='Ref_to_Member'>is_not_null</span></a> <span class='Operator'>= </span><span class='Boolean'>TRUE</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/catalog/heap.h.html#LN125"><span class='Ref_to_Proto'>SystemAttributeByName</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1989"><span class='Ref_To_Local'>key</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN81"><span class='Ref_to_Member'>hasoids</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * column will be a system column in the new table, so accept it. 
             * System columns can't ever be null, so no need to worry about 
             * PRIMARY/NOT NULL constraint. 
             */ 
</span>            <a href="parse_utilcmd.c.html#LN1990"><span class='Ref_To_Local'>found</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN78"><span class='Ref_to_Member'>inhRelations</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* try inherited tables */ 
</span><a name="LN2022"></a>            <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>inher</span><span class='Delimiter'>; 
</span> 
            <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2022"><span class='Ref_To_Local'>inher</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN78"><span class='Ref_to_Member'>inhRelations</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN2026"></a>                <a href="../../include/nodes/primnodes.h.html#LN62"><span class='Ref_to_Struct'>RangeVar</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>inh</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN108"><span class='Ref_to_Macro'>lfirst_node</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN62"><span class='Ref_to_Struct'>RangeVar</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2022"><span class='Ref_To_Local'>inher</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2027"></a>                <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>rel</span><span class='Delimiter'>; 
</span><a name="LN2028"></a>                <span class='Keyword'>int</span>         <span class='Declare_Local'>count</span><span class='Delimiter'>; 
</span> 
                <a href="parse_utilcmd.c.html#LN2027"><span class='Ref_To_Local'>rel</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN92"><span class='Ref_to_Proto'>heap_openrv</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2026"><span class='Ref_To_Local'>inh</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN35"><span class='Ref_to_Const'>AccessShareLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Comment_Multi_Line'>/* check user requested inheritance from valid relkind */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2027"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relkind <span class='Operator'>!= </span><a href="../../include/catalog/pg_class.h.html#LN159"><span class='Ref_to_Const'>RELKIND_RELATION</span></a> <span class='Operator'>&& 
</span>                    <a href="parse_utilcmd.c.html#LN2027"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relkind <span class='Operator'>!= </span><a href="../../include/catalog/pg_class.h.html#LN166"><span class='Ref_to_Const'>RELKIND_FOREIGN_TABLE</span></a> <span class='Operator'>&& 
</span>                    <a href="parse_utilcmd.c.html#LN2027"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relkind <span class='Operator'>!= </span><a href="../../include/catalog/pg_class.h.html#LN167"><span class='Ref_to_Const'>RELKIND_PARTITIONED_TABLE</span></a><span class='Parentheses'>) 
</span>                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_WRONG_OBJECT_TYPE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"inherited relation \"%s\" is not a table or foreign table"</span><span class='Delimiter'>, 
</span>                                    <a href="parse_utilcmd.c.html#LN2026"><span class='Ref_To_Local'>inh</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN67"><span class='Ref_to_Member'>relname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2028"><span class='Ref_To_Local'>count</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="parse_utilcmd.c.html#LN2028"><span class='Ref_To_Local'>count</span></a> <span class='Operator'>&LT; </span><a href="parse_utilcmd.c.html#LN2027"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN114"><span class='Ref_to_Member'>rd_att</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN72"><span class='Ref_to_Member'>natts</span></a><span class='Delimiter'>; </span><a href="parse_utilcmd.c.html#LN2028"><span class='Ref_To_Local'>count</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span><a name="LN2041"></a>                    <a href="../../include/catalog/pg_attribute.h.html#LN186"><span class='Ref_to_Typedef'>Form_pg_attribute</span></a> <span class='Declare_Local'>inhattr</span> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN2027"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN114"><span class='Ref_to_Member'>rd_att</span></a><span class='Operator'>-&GT;</span><a href="../../include/access/tupdesc.h.html#LN73"><span class='Ref_to_Member'>attrs</span></a><span class='Delimiter'>[</span><a href="parse_utilcmd.c.html#LN2028"><span class='Ref_To_Local'>count</span></a><span class='Delimiter'>]; 
</span><a name="LN2042"></a>                    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>inhname</span> <span class='Operator'>= </span><a href="../../include/c.h.html#LN498"><span class='Ref_to_Macro'>NameStr</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2041"><span class='Ref_To_Local'>inhattr</span></a><span class='Operator'>-&GT;</span>attname<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2041"><span class='Ref_To_Local'>inhattr</span></a><span class='Operator'>-&GT;</span>attisdropped<span class='Parentheses'>) 
</span>                        <span class='Control'>continue</span><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1989"><span class='Ref_To_Local'>key</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2042"><span class='Ref_To_Local'>inhname</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                    <span class='Delimiter'>{ 
</span>                        <a href="parse_utilcmd.c.html#LN1990"><span class='Ref_To_Local'>found</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
                        <span class='Comment_Multi_Line'>/* 
                         * We currently have no easy way to force an inherited 
                         * column to be NOT NULL at creation, if its parent 
                         * wasn't so already. We leave it to DefineIndex to 
                         * fix things up in this case. 
                         */ 
</span>                        <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for count=0;count&LT;rel-&GT;rd... &raquo; </span> 
                <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2027"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN33"><span class='Ref_to_Const'>NoLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1990"><span class='Ref_To_Local'>found</span></a><span class='Parentheses'>) 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if cxt-&GT;inhRelations &raquo; </span> 
 
        <span class='Comment_Multi_Line'>/* 
         * In the ALTER TABLE case, don't complain about index keys not 
         * created in the command; they may well exist already. DefineIndex 
         * will complain about them if not, and will also take care of marking 
         * them NOT NULL. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_utilcmd.c.html#LN1990"><span class='Ref_To_Local'>found</span></a> <span class='Operator'>&& !</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN80"><span class='Ref_to_Member'>isalter</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNDEFINED_COLUMN<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"column \"%s\" named in key does not exist"</span><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1989"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Check for PRIMARY KEY(foo, foo) */ 
</span>        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1992"><span class='Ref_To_Local'>columns</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2674"><span class='Ref_to_Member'>indexParams</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="parse_utilcmd.c.html#LN1993"><span class='Ref_To_Local'>iparam</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN685"><span class='Ref_to_Struct'>IndexElem</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1992"><span class='Ref_To_Local'>columns</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1993"><span class='Ref_To_Local'>iparam</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN688"><span class='Ref_to_Member'>name</span></a> <span class='Operator'>&& </span>strcmp<span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1989"><span class='Ref_To_Local'>key</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1993"><span class='Ref_To_Local'>iparam</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN688"><span class='Ref_to_Member'>name</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2682"><span class='Ref_to_Member'>primary</span></a><span class='Parentheses'>) 
</span>                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DUPLICATE_COLUMN<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"column \"%s\" appears twice in primary key constraint"</span><span class='Delimiter'>, 
</span>                                    <a href="parse_utilcmd.c.html#LN1989"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <span class='Control'>else</span> 
                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DUPLICATE_COLUMN<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                    <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"column \"%s\" appears twice in unique constraint"</span><span class='Delimiter'>, 
</span>                           <a href="parse_utilcmd.c.html#LN1989"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1741"><span class='Ref_to_Parameter'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* OK, add it to the index definition */ 
</span>        <a href="parse_utilcmd.c.html#LN1993"><span class='Ref_To_Local'>iparam</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN685"><span class='Ref_to_Struct'>IndexElem</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1993"><span class='Ref_To_Local'>iparam</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN688"><span class='Ref_to_Member'>name</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1989"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1993"><span class='Ref_To_Local'>iparam</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN689"><span class='Ref_to_Member'>expr</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1993"><span class='Ref_To_Local'>iparam</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN690"><span class='Ref_to_Member'>indexcolname</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1993"><span class='Ref_To_Local'>iparam</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN691"><span class='Ref_to_Member'>collation</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1993"><span class='Ref_To_Local'>iparam</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN692"><span class='Ref_to_Member'>opclass</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1993"><span class='Ref_To_Local'>iparam</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN693"><span class='Ref_to_Member'>ordering</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN49"><span class='Ref_to_EnumConst'>SORTBY_DEFAULT</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1993"><span class='Ref_To_Local'>iparam</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN694"><span class='Ref_to_Member'>nulls_ordering</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN57"><span class='Ref_to_EnumConst'>SORTBY_NULLS_DEFAULT</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2674"><span class='Ref_to_Member'>indexParams</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2674"><span class='Ref_to_Member'>indexParams</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN1993"><span class='Ref_To_Local'>iparam</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="parse_utilcmd.c.html#LN1743"><span class='Ref_To_Local'>index</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end transformIndexConstraint &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * transformCheckConstraints 
 *      handle CHECK constraints 
 * 
 * Right now, there's nothing to do here when called from ALTER TABLE, 
 * but the other constraint-transformation functions are called in both 
 * the CREATE TABLE and ALTER TABLE paths, so do the same here, and just 
 * don't do anything if we're not authorized to skip validation. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN2123"></a><span class='Declare_Function'>transformCheckConstraints</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cxt</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>skipValidation</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2125"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>ckclist</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2123"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN83"><span class='Ref_to_Member'>ckconstraints</span></a> <span class='Operator'>== </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If creating a new table, we can safely skip validation of check 
     * constraints, and nonetheless mark them valid.  (This will override any 
     * user-supplied NOT VALID flag.) 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2123"><span class='Ref_to_Parameter'>skipValidation</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2125"><span class='Ref_To_Local'>ckclist</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2123"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN83"><span class='Ref_to_Member'>ckconstraints</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN2139"></a>            <a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a> <span class='Operator'>*</span><span class='Declare_Local'>constraint</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2125"><span class='Ref_To_Local'>ckclist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="parse_utilcmd.c.html#LN2139"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2092"><span class='Ref_to_Member'>skip_validation</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN2139"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2093"><span class='Ref_to_Member'>initially_valid</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end transformCheckConstraints &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * transformFKConstraints 
 *      handle FOREIGN KEY constraints 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN2152"></a><span class='Declare_Function'>transformFKConstraints</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cxt</span><span class='Delimiter'>, 
</span><a name="LN2153"></a>                       <span class='Keyword'>bool </span><span class='Declare_Parameter'>skipValidation</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>isAddConstraint</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2155"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>fkclist</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2152"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN84"><span class='Ref_to_Member'>fkconstraints</span></a> <span class='Operator'>== </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If CREATE TABLE or adding a column with NULL default, we can safely 
     * skip validation of FK constraints, and nonetheless mark them valid. 
     * (This will override any user-supplied NOT VALID flag.) 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2153"><span class='Ref_to_Parameter'>skipValidation</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2155"><span class='Ref_To_Local'>fkclist</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2152"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN84"><span class='Ref_to_Member'>fkconstraints</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN2169"></a>            <a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a> <span class='Operator'>*</span><span class='Declare_Local'>constraint</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2155"><span class='Ref_To_Local'>fkclist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="parse_utilcmd.c.html#LN2169"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2092"><span class='Ref_to_Member'>skip_validation</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN2169"><span class='Ref_To_Local'>constraint</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2093"><span class='Ref_to_Member'>initially_valid</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * For CREATE TABLE or ALTER TABLE ADD COLUMN, gin up an ALTER TABLE ADD 
     * CONSTRAINT command to execute after the basic command is complete. (If 
     * called from ADD CONSTRAINT, that routine will add the FK constraints to 
     * its own subcommand list.) 
     * 
     * Note: the ADD CONSTRAINT command must also execute after any index 
     * creation commands.  Thus, this should run after 
     * transformIndexConstraints, so that the CREATE INDEX commands are 
     * already in cxt-&GT;alist. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_utilcmd.c.html#LN2153"><span class='Ref_to_Parameter'>isAddConstraint</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2189"></a>        <a href="../../include/nodes/parsenodes.h.html#LN1662"><span class='Ref_to_Struct'>AlterTableStmt</span></a> <span class='Operator'>*</span><span class='Declare_Local'>alterstmt</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN1662"><span class='Ref_to_Struct'>AlterTableStmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="parse_utilcmd.c.html#LN2189"><span class='Ref_To_Local'>alterstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1665"><span class='Ref_to_Member'>relation</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN2152"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN76"><span class='Ref_to_Member'>relation</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN2189"><span class='Ref_To_Local'>alterstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1666"><span class='Ref_to_Member'>cmds</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN2189"><span class='Ref_To_Local'>alterstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1667"><span class='Ref_to_Member'>relkind</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN1622"><span class='Ref_to_EnumConst'>OBJECT_TABLE</span></a><span class='Delimiter'>; 
</span> 
        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2155"><span class='Ref_To_Local'>fkclist</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2152"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN84"><span class='Ref_to_Member'>fkconstraints</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN2197"></a>            <a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a> <span class='Operator'>*</span><span class='Declare_Local'>constraint</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2155"><span class='Ref_To_Local'>fkclist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2198"></a>            <a href="../../include/nodes/parsenodes.h.html#LN1749"><span class='Ref_to_Struct'>AlterTableCmd</span></a> <span class='Operator'>*</span><span class='Declare_Local'>altercmd</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN1749"><span class='Ref_to_Struct'>AlterTableCmd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="parse_utilcmd.c.html#LN2198"><span class='Ref_To_Local'>altercmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1752"><span class='Ref_to_Member'>subtype</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN1693"><span class='Ref_to_EnumConst'>AT_ProcessedConstraint</span></a><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN2198"><span class='Ref_To_Local'>altercmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1753"><span class='Ref_to_Member'>name</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN2198"><span class='Ref_To_Local'>altercmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1756"><span class='Ref_to_Member'>def</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN2197"><span class='Ref_To_Local'>constraint</span></a><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN2189"><span class='Ref_To_Local'>alterstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1666"><span class='Ref_to_Member'>cmds</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2189"><span class='Ref_To_Local'>alterstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1666"><span class='Ref_to_Member'>cmds</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2198"><span class='Ref_To_Local'>altercmd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="parse_utilcmd.c.html#LN2152"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2152"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2189"><span class='Ref_To_Local'>alterstmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if !isAddConstraint &raquo; </span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end transformFKConstraints &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * transformIndexStmt - parse analysis for CREATE INDEX and ALTER TABLE 
 * 
 * Note: this is a no-op for an index not using either index expressions or 
 * a predicate expression.  There are several code paths that create indexes 
 * without bothering to call this, because they know they don't have any 
 * such expressions to deal with. 
 * 
 * To avoid race conditions, it's important that this function rely only on 
 * the passed-in relid (and not on stmt-&GT;relation) to determine the target 
 * relation. 
 */ 
</span><a href="../../include/nodes/parsenodes.h.html#LN2667"><span class='Ref_to_Struct'>IndexStmt</span></a> <span class='Operator'>* 
</span><a name="LN2223"></a><span class='Declare_Function'>transformIndexStmt</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>relid</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN2667"><span class='Ref_to_Struct'>IndexStmt</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>stmt</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>queryString</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2225"></a>    <a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Local'>pstate</span><span class='Delimiter'>; 
</span><a name="LN2226"></a>    <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span><span class='Delimiter'>; 
</span><a name="LN2227"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span><a name="LN2228"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>rel</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Nothing to do if statement already transformed. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2223"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2686"><span class='Ref_to_Member'>transformed</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="parse_utilcmd.c.html#LN2223"><span class='Ref_to_Parameter'>stmt</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We must not scribble on the passed-in IndexStmt, so copy it.  (This is 
     * overkill, but easy.) 
     */ 
</span>    <a href="parse_utilcmd.c.html#LN2223"><span class='Ref_to_Parameter'>stmt</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN618"><span class='Ref_to_Macro'>copyObject</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2223"><span class='Ref_to_Parameter'>stmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Set up pstate */ 
</span>    <a href="parse_utilcmd.c.html#LN2225"><span class='Ref_To_Local'>pstate</span></a> <span class='Operator'>= </span><a href="parse_node.c.html#LN42"><span class='Ref_to_Func'>make_parsestate</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN2225"><span class='Ref_To_Local'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN167"><span class='Ref_to_Member'>p_sourcetext</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN2223"><span class='Ref_to_Parameter'>queryString</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Put the parent table into the rtable so that the expressions can refer 
     * to its fields without qualification.  Caller is responsible for locking 
     * relation, but we still need to open it. 
     */ 
</span>    <a href="parse_utilcmd.c.html#LN2228"><span class='Ref_To_Local'>rel</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN84"><span class='Ref_to_Proto'>relation_open</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2223"><span class='Ref_to_Parameter'>relid</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN33"><span class='Ref_to_Const'>NoLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN2226"><span class='Ref_To_Local'>rte</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_relation.h.html#LN69"><span class='Ref_to_Proto'>addRangeTableEntryForRelation</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2225"><span class='Ref_To_Local'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2228"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* no to join list, yes to namespaces */ 
</span>    <a href="../../include/parser/parse_relation.h.html#LN114"><span class='Ref_to_Proto'>addRTEtoQuery</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2225"><span class='Ref_To_Local'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2226"><span class='Ref_To_Local'>rte</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* take care of the where clause */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2223"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2676"><span class='Ref_to_Member'>whereClause</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="parse_utilcmd.c.html#LN2223"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2676"><span class='Ref_to_Member'>whereClause</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_clause.h.html#LN23"><span class='Ref_to_Proto'>transformWhereClause</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2225"><span class='Ref_To_Local'>pstate</span></a><span class='Delimiter'>, 
</span>                                                 <a href="parse_utilcmd.c.html#LN2223"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2676"><span class='Ref_to_Member'>whereClause</span></a><span class='Delimiter'>, 
</span>                                                 <a href="../../include/parser/parse_node.h.html#LN64"><span class='Ref_to_EnumConst'>EXPR_KIND_INDEX_PREDICATE</span></a><span class='Delimiter'>, 
</span>                                                 <span class='String'>"WHERE"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* we have to fix its collations too */ 
</span>        <a href="../../include/parser/parse_collate.h.html#LN22"><span class='Ref_to_Proto'>assign_expr_collations</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2225"><span class='Ref_To_Local'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2223"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2676"><span class='Ref_to_Member'>whereClause</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* take care of any index expressions */ 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2227"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2223"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2674"><span class='Ref_to_Member'>indexParams</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2269"></a>        <a href="../../include/nodes/parsenodes.h.html#LN685"><span class='Ref_to_Struct'>IndexElem</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>ielem</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN685"><span class='Ref_to_Struct'>IndexElem</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2227"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2269"><span class='Ref_To_Local'>ielem</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN689"><span class='Ref_to_Member'>expr</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Extract preliminary index col name before transforming expr */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2269"><span class='Ref_To_Local'>ielem</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN690"><span class='Ref_to_Member'>indexcolname</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                <a href="parse_utilcmd.c.html#LN2269"><span class='Ref_To_Local'>ielem</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN690"><span class='Ref_to_Member'>indexcolname</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_target.h.html#LN43"><span class='Ref_to_Proto'>FigureIndexColname</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2269"><span class='Ref_To_Local'>ielem</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN689"><span class='Ref_to_Member'>expr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Now do parse transformation of the expression */ 
</span>            <a href="parse_utilcmd.c.html#LN2269"><span class='Ref_To_Local'>ielem</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN689"><span class='Ref_to_Member'>expr</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_expr.h.html#LN21"><span class='Ref_to_Proto'>transformExpr</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2225"><span class='Ref_To_Local'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2269"><span class='Ref_To_Local'>ielem</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN689"><span class='Ref_to_Member'>expr</span></a><span class='Delimiter'>, 
</span>                                        <a href="../../include/parser/parse_node.h.html#LN63"><span class='Ref_to_EnumConst'>EXPR_KIND_INDEX_EXPRESSION</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* We have to fix its collations too */ 
</span>            <a href="../../include/parser/parse_collate.h.html#LN22"><span class='Ref_to_Proto'>assign_expr_collations</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2225"><span class='Ref_To_Local'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2269"><span class='Ref_To_Local'>ielem</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN689"><span class='Ref_to_Member'>expr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * transformExpr() should have already rejected subqueries, 
             * aggregates, window functions, and SRFs, based on the EXPR_KIND_ 
             * for an index expression. 
             * 
             * DefineIndex() will make more checks. 
             */ 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if ielem-&GT;expr &raquo; </span> 
    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Check that only the base rel is mentioned.  (This should be dead code 
     * now that add_missing_from is history.) 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2225"><span class='Ref_To_Local'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_COLUMN_REFERENCE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"index expressions and predicates can refer only to the table being indexed"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="parse_node.c.html#LN75"><span class='Ref_to_Func'>free_parsestate</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2225"><span class='Ref_To_Local'>pstate</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Close relation */ 
</span>    <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2228"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN33"><span class='Ref_to_Const'>NoLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Mark statement as successfully transformed */ 
</span>    <a href="parse_utilcmd.c.html#LN2223"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2686"><span class='Ref_to_Member'>transformed</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="parse_utilcmd.c.html#LN2223"><span class='Ref_to_Parameter'>stmt</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end transformIndexStmt &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * transformRuleStmt - 
 *    transform a CREATE RULE Statement. The action is a list of parse 
 *    trees which is transformed into a list of query trees, and we also 
 *    transform the WHERE clause if any. 
 * 
 * actions and whereClause are output parameters that receive the 
 * transformed results. 
 * 
 * Note that we must not scribble on the passed-in RuleStmt, so we do 
 * copyObject() on the actions and WHERE clause. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN2328"></a><span class='Declare_Function'>transformRuleStmt</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2841"><span class='Ref_to_Struct'>RuleStmt</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>stmt</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>queryString</span><span class='Delimiter'>, 
</span><a name="LN2329"></a>                  <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>actions</span><span class='Delimiter'>, </span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>whereClause</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2331"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>rel</span><span class='Delimiter'>; 
</span><a name="LN2332"></a>    <a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Local'>pstate</span><span class='Delimiter'>; 
</span><a name="LN2333"></a>    <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>oldrte</span><span class='Delimiter'>; 
</span><a name="LN2334"></a>    <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>newrte</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * To avoid deadlock, make sure the first thing we do is grab 
     * AccessExclusiveLock on the target relation.  This will be needed by 
     * DefineQueryRewrite(), and we don't want to grab a lesser lock 
     * beforehand. 
     */ 
</span>    <a href="parse_utilcmd.c.html#LN2331"><span class='Ref_To_Local'>rel</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN92"><span class='Ref_to_Proto'>heap_openrv</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2328"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2844"><span class='Ref_to_Member'>relation</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN45"><span class='Ref_to_Const'>AccessExclusiveLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2331"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relkind <span class='Operator'>== </span><a href="../../include/catalog/pg_class.h.html#LN164"><span class='Ref_to_Const'>RELKIND_MATVIEW</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"rules on materialized views are not supported"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Set up pstate */ 
</span>    <a href="parse_utilcmd.c.html#LN2332"><span class='Ref_To_Local'>pstate</span></a> <span class='Operator'>= </span><a href="parse_node.c.html#LN42"><span class='Ref_to_Func'>make_parsestate</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN2332"><span class='Ref_To_Local'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN167"><span class='Ref_to_Member'>p_sourcetext</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN2328"><span class='Ref_to_Parameter'>queryString</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * NOTE: 'OLD' must always have a varno equal to 1 and 'NEW' equal to 2. 
     * Set up their RTEs in the main pstate for use in parsing the rule 
     * qualification. 
     */ 
</span>    <a href="parse_utilcmd.c.html#LN2333"><span class='Ref_To_Local'>oldrte</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_relation.h.html#LN69"><span class='Ref_to_Proto'>addRangeTableEntryForRelation</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2332"><span class='Ref_To_Local'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2331"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>, 
</span>                                           <a href="../../include/nodes/makefuncs.h.html#LN63"><span class='Ref_to_Proto'>makeAlias</span></a><span class='Parentheses'>(</span><span class='String'>"old"</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                           <span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN2334"><span class='Ref_To_Local'>newrte</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_relation.h.html#LN69"><span class='Ref_to_Proto'>addRangeTableEntryForRelation</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2332"><span class='Ref_To_Local'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2331"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>, 
</span>                                           <a href="../../include/nodes/makefuncs.h.html#LN63"><span class='Ref_to_Proto'>makeAlias</span></a><span class='Parentheses'>(</span><span class='String'>"new"</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                           <span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* Must override addRangeTableEntry's default access-check flags */ 
</span>    <a href="parse_utilcmd.c.html#LN2333"><span class='Ref_To_Local'>oldrte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1027"><span class='Ref_to_Member'>requiredPerms</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN2334"><span class='Ref_To_Local'>newrte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1027"><span class='Ref_to_Member'>requiredPerms</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * They must be in the namespace too for lookup purposes, but only add the 
     * one(s) that are relevant for the current kind of rule.  In an UPDATE 
     * rule, quals must refer to OLD.field or NEW.field to be unambiguous, but 
     * there's no need to be so picky for INSERT & DELETE.  We do not add them 
     * to the joinlist. 
     */ 
</span>    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2328"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2847"><span class='Ref_to_Member'>event</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/nodes.h.html#LN650"><span class='Ref_to_EnumConst'>CMD_SELECT</span></a><span class='Operator'>: 
</span>            <a href="../../include/parser/parse_relation.h.html#LN114"><span class='Ref_to_Proto'>addRTEtoQuery</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2332"><span class='Ref_To_Local'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2333"><span class='Ref_To_Local'>oldrte</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/nodes.h.html#LN651"><span class='Ref_to_EnumConst'>CMD_UPDATE</span></a><span class='Operator'>: 
</span>            <a href="../../include/parser/parse_relation.h.html#LN114"><span class='Ref_to_Proto'>addRTEtoQuery</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2332"><span class='Ref_To_Local'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2333"><span class='Ref_To_Local'>oldrte</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../include/parser/parse_relation.h.html#LN114"><span class='Ref_to_Proto'>addRTEtoQuery</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2332"><span class='Ref_To_Local'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2334"><span class='Ref_To_Local'>newrte</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/nodes.h.html#LN652"><span class='Ref_to_EnumConst'>CMD_INSERT</span></a><span class='Operator'>: 
</span>            <a href="../../include/parser/parse_relation.h.html#LN114"><span class='Ref_to_Proto'>addRTEtoQuery</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2332"><span class='Ref_To_Local'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2334"><span class='Ref_To_Local'>newrte</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../include/nodes/nodes.h.html#LN653"><span class='Ref_to_EnumConst'>CMD_DELETE</span></a><span class='Operator'>: 
</span>            <a href="../../include/parser/parse_relation.h.html#LN114"><span class='Ref_to_Proto'>addRTEtoQuery</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2332"><span class='Ref_To_Local'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2333"><span class='Ref_To_Local'>oldrte</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized event type: %d"</span><span class='Delimiter'>, 
</span>                 <span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN2328"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2847"><span class='Ref_to_Member'>event</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch stmt-&GT;event &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* take care of the where clause */ 
</span>    <span class='Operator'>*</span><a href="parse_utilcmd.c.html#LN2329"><span class='Ref_to_Parameter'>whereClause</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_clause.h.html#LN23"><span class='Ref_to_Proto'>transformWhereClause</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2332"><span class='Ref_To_Local'>pstate</span></a><span class='Delimiter'>, 
</span>                                      <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/nodes.h.html#LN618"><span class='Ref_to_Macro'>copyObject</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2328"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2846"><span class='Ref_to_Member'>whereClause</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                        <a href="../../include/parser/parse_node.h.html#LN40"><span class='Ref_to_EnumConst'>EXPR_KIND_WHERE</span></a><span class='Delimiter'>, 
</span>                                        <span class='String'>"WHERE"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* we have to fix its collations too */ 
</span>    <a href="../../include/parser/parse_collate.h.html#LN22"><span class='Ref_to_Proto'>assign_expr_collations</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2332"><span class='Ref_To_Local'>pstate</span></a><span class='Delimiter'>, </span><span class='Operator'>*</span><a href="parse_utilcmd.c.html#LN2329"><span class='Ref_to_Parameter'>whereClause</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* this is probably dead code without add_missing_from: */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2332"><span class='Ref_To_Local'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>2</span><span class='Parentheses'>)</span>     <span class='Comment_Single_Line'>/* naughty, naughty... */ 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"rule WHERE condition cannot contain references to other relations"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * 'instead nothing' rules with a qualification need a query rangetable so 
     * the rewrite handler can add the negated rule qualification to the 
     * original query. We create a query with the new command type CMD_NOTHING 
     * here that is treated specially by the rewrite system. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2328"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2849"><span class='Ref_to_Member'>actions</span></a> <span class='Operator'>== </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2418"></a>        <a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>nothing_qry</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="parse_utilcmd.c.html#LN2418"><span class='Ref_To_Local'>nothing_qry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN109"><span class='Ref_to_Member'>commandType</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN656"><span class='Ref_to_EnumConst'>CMD_NOTHING</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN2418"><span class='Ref_To_Local'>nothing_qry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN134"><span class='Ref_to_Member'>rtable</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN2332"><span class='Ref_To_Local'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN2418"><span class='Ref_To_Local'>nothing_qry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN135"><span class='Ref_to_Member'>jointree</span></a> <span class='Operator'>= </span><a href="../../include/nodes/makefuncs.h.html#LN47"><span class='Ref_to_Proto'>makeFromExpr</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* no join wanted */ 
</span> 
        <span class='Operator'>*</span><a href="parse_utilcmd.c.html#LN2329"><span class='Ref_to_Parameter'>actions</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN138"><span class='Ref_to_Macro'>list_make1</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2418"><span class='Ref_To_Local'>nothing_qry</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span><a name="LN2428"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span><a name="LN2429"></a>        <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>newactions</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * transform each statement, like parse_sub_analyze() 
         */ 
</span>        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2428"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2328"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2849"><span class='Ref_to_Member'>actions</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN2436"></a>            <a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>action</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2428"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2437"></a>            <a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Local'>sub_pstate</span> <span class='Operator'>= </span><a href="parse_node.c.html#LN42"><span class='Ref_to_Func'>make_parsestate</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2438"></a>            <a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>sub_qry</span><span class='Delimiter'>, 
</span><a name="LN2439"></a>                       <span class='Operator'>*</span><span class='Declare_Local'>top_subqry</span><span class='Delimiter'>; 
</span><a name="LN2440"></a>            <span class='Keyword'>bool</span>        <span class='Declare_Local'>has_old</span><span class='Delimiter'>, 
</span><a name="LN2441"></a>                        <span class='Declare_Local'>has_new</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Since outer ParseState isn't parent of inner, have to pass down 
             * the query text by hand. 
             */ 
</span>            <a href="parse_utilcmd.c.html#LN2437"><span class='Ref_To_Local'>sub_pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN167"><span class='Ref_to_Member'>p_sourcetext</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN2328"><span class='Ref_to_Parameter'>queryString</span></a><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Set up OLD/NEW in the rtable for this statement.  The entries 
             * are added only to relnamespace, not varnamespace, because we 
             * don't want them to be referred to by unqualified field names 
             * nor "*" in the rule actions.  We decide later whether to put 
             * them in the joinlist. 
             */ 
</span>            <a href="parse_utilcmd.c.html#LN2333"><span class='Ref_To_Local'>oldrte</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_relation.h.html#LN69"><span class='Ref_to_Proto'>addRangeTableEntryForRelation</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2437"><span class='Ref_To_Local'>sub_pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2331"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>, 
</span>                                                   <a href="../../include/nodes/makefuncs.h.html#LN63"><span class='Ref_to_Proto'>makeAlias</span></a><span class='Parentheses'>(</span><span class='String'>"old"</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                                   <span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN2334"><span class='Ref_To_Local'>newrte</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_relation.h.html#LN69"><span class='Ref_to_Proto'>addRangeTableEntryForRelation</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2437"><span class='Ref_To_Local'>sub_pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2331"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>, 
</span>                                                   <a href="../../include/nodes/makefuncs.h.html#LN63"><span class='Ref_to_Proto'>makeAlias</span></a><span class='Parentheses'>(</span><span class='String'>"new"</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                                   <span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN2333"><span class='Ref_To_Local'>oldrte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1027"><span class='Ref_to_Member'>requiredPerms</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN2334"><span class='Ref_To_Local'>newrte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1027"><span class='Ref_to_Member'>requiredPerms</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <a href="../../include/parser/parse_relation.h.html#LN114"><span class='Ref_to_Proto'>addRTEtoQuery</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2437"><span class='Ref_To_Local'>sub_pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2333"><span class='Ref_To_Local'>oldrte</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../include/parser/parse_relation.h.html#LN114"><span class='Ref_to_Proto'>addRTEtoQuery</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2437"><span class='Ref_To_Local'>sub_pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2334"><span class='Ref_To_Local'>newrte</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Transform the rule action statement */ 
</span>            <a href="parse_utilcmd.c.html#LN2439"><span class='Ref_To_Local'>top_subqry</span></a> <span class='Operator'>= </span><a href="../../include/parser/analyze.h.html#LN35"><span class='Ref_to_Proto'>transformStmt</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2437"><span class='Ref_To_Local'>sub_pstate</span></a><span class='Delimiter'>, 
</span>                                       <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/nodes.h.html#LN618"><span class='Ref_to_Macro'>copyObject</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2436"><span class='Ref_To_Local'>action</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * We cannot support utility-statement actions (eg NOTIFY) with 
             * nonempty rule WHERE conditions, because there's no way to make 
             * the utility action execute conditionally. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2439"><span class='Ref_To_Local'>top_subqry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN109"><span class='Ref_to_Member'>commandType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/nodes.h.html#LN654"><span class='Ref_to_EnumConst'>CMD_UTILITY</span></a> <span class='Operator'>&& 
</span>                <span class='Operator'>*</span><a href="parse_utilcmd.c.html#LN2329"><span class='Ref_to_Parameter'>whereClause</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"rules with WHERE conditions can only have SELECT, INSERT, UPDATE, or DELETE actions"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * If the action is INSERT...SELECT, OLD/NEW have been pushed down 
             * into the SELECT, and that's what we need to look at. (Ugly 
             * kluge ... try to fix this when we redesign querytrees.) 
             */ 
</span>            <a href="parse_utilcmd.c.html#LN2438"><span class='Ref_To_Local'>sub_qry</span></a> <span class='Operator'>= </span><a href="../../include/rewrite/rewriteManip.h.html#LN52"><span class='Ref_to_Proto'>getInsertSelectQuery</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2439"><span class='Ref_To_Local'>top_subqry</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * If the sub_qry is a setop, we cannot attach any qualifications 
             * to it, because the planner won't notice them.  This could 
             * perhaps be relaxed someday, but for now, we may as well reject 
             * such a rule immediately. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2438"><span class='Ref_To_Local'>sub_qry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN162"><span class='Ref_to_Member'>setOperations</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& *</span><a href="parse_utilcmd.c.html#LN2329"><span class='Ref_to_Parameter'>whereClause</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"conditional UNION/INTERSECT/EXCEPT statements are not implemented"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Validate action's use of OLD/NEW, qual too 
             */ 
</span>            <a href="parse_utilcmd.c.html#LN2440"><span class='Ref_To_Local'>has_old</span></a> <span class='Operator'>= 
</span>                <a href="../../include/rewrite/rewriteManip.h.html#LN49"><span class='Ref_to_Proto'>rangeTableEntry_used</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN2438"><span class='Ref_To_Local'>sub_qry</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN159"><span class='Ref_to_Const'>PRS2_OLD_VARNO</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span> <span class='Operator'>|| 
</span>                <a href="../../include/rewrite/rewriteManip.h.html#LN49"><span class='Ref_to_Proto'>rangeTableEntry_used</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="parse_utilcmd.c.html#LN2329"><span class='Ref_to_Parameter'>whereClause</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN159"><span class='Ref_to_Const'>PRS2_OLD_VARNO</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN2441"><span class='Ref_To_Local'>has_new</span></a> <span class='Operator'>= 
</span>                <a href="../../include/rewrite/rewriteManip.h.html#LN49"><span class='Ref_to_Proto'>rangeTableEntry_used</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN2438"><span class='Ref_To_Local'>sub_qry</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN160"><span class='Ref_to_Const'>PRS2_NEW_VARNO</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span> <span class='Operator'>|| 
</span>                <a href="../../include/rewrite/rewriteManip.h.html#LN49"><span class='Ref_to_Proto'>rangeTableEntry_used</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="parse_utilcmd.c.html#LN2329"><span class='Ref_to_Parameter'>whereClause</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN160"><span class='Ref_to_Const'>PRS2_NEW_VARNO</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2328"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2847"><span class='Ref_to_Member'>event</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>case</span> <a href="../../include/nodes/nodes.h.html#LN650"><span class='Ref_to_EnumConst'>CMD_SELECT</span></a><span class='Operator'>: 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2440"><span class='Ref_To_Local'>has_old</span></a><span class='Parentheses'>) 
</span>                        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"ON SELECT rule cannot use OLD"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2441"><span class='Ref_To_Local'>has_new</span></a><span class='Parentheses'>) 
</span>                        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"ON SELECT rule cannot use NEW"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Control'>case</span> <a href="../../include/nodes/nodes.h.html#LN651"><span class='Ref_to_EnumConst'>CMD_UPDATE</span></a><span class='Operator'>: 
</span>                    <span class='Comment_Multi_Line'>/* both are OK */ 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Control'>case</span> <a href="../../include/nodes/nodes.h.html#LN652"><span class='Ref_to_EnumConst'>CMD_INSERT</span></a><span class='Operator'>: 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2440"><span class='Ref_To_Local'>has_old</span></a><span class='Parentheses'>) 
</span>                        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"ON INSERT rule cannot use OLD"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Control'>case</span> <a href="../../include/nodes/nodes.h.html#LN653"><span class='Ref_to_EnumConst'>CMD_DELETE</span></a><span class='Operator'>: 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2441"><span class='Ref_To_Local'>has_new</span></a><span class='Parentheses'>) 
</span>                        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"ON DELETE rule cannot use NEW"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Control'>default</span><span class='Operator'>: 
</span>                    <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized event type: %d"</span><span class='Delimiter'>, 
</span>                         <span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN2328"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2847"><span class='Ref_to_Member'>event</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch stmt-&GT;event &raquo; </span> 
 
            <span class='Comment_Multi_Line'>/* 
             * OLD/NEW are not allowed in WITH queries, because they would 
             * amount to outer references for the WITH, which we disallow. 
             * However, they were already in the outer rangetable when we 
             * analyzed the query, so we have to check. 
             * 
             * Note that in the INSERT...SELECT case, we need to examine the 
             * CTE lists of both top_subqry and sub_qry. 
             * 
             * Note that we aren't digging into the body of the query looking 
             * for WITHs in nested sub-SELECTs.  A WITH down there can 
             * legitimately refer to OLD/NEW, because it'd be an 
             * indirect-correlated outer reference. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/rewrite/rewriteManip.h.html#LN49"><span class='Ref_to_Proto'>rangeTableEntry_used</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN2439"><span class='Ref_To_Local'>top_subqry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN132"><span class='Ref_to_Member'>cteList</span></a><span class='Delimiter'>, 
</span>                                     <a href="../../include/nodes/primnodes.h.html#LN159"><span class='Ref_to_Const'>PRS2_OLD_VARNO</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span> <span class='Operator'>|| 
</span>                <a href="../../include/rewrite/rewriteManip.h.html#LN49"><span class='Ref_to_Proto'>rangeTableEntry_used</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN2438"><span class='Ref_To_Local'>sub_qry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN132"><span class='Ref_to_Member'>cteList</span></a><span class='Delimiter'>, 
</span>                                     <a href="../../include/nodes/primnodes.h.html#LN159"><span class='Ref_to_Const'>PRS2_OLD_VARNO</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>))</span> 
                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot refer to OLD within WITH query"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/rewrite/rewriteManip.h.html#LN49"><span class='Ref_to_Proto'>rangeTableEntry_used</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN2439"><span class='Ref_To_Local'>top_subqry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN132"><span class='Ref_to_Member'>cteList</span></a><span class='Delimiter'>, 
</span>                                     <a href="../../include/nodes/primnodes.h.html#LN160"><span class='Ref_to_Const'>PRS2_NEW_VARNO</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span> <span class='Operator'>|| 
</span>                <a href="../../include/rewrite/rewriteManip.h.html#LN49"><span class='Ref_to_Proto'>rangeTableEntry_used</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN2438"><span class='Ref_To_Local'>sub_qry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN132"><span class='Ref_to_Member'>cteList</span></a><span class='Delimiter'>, 
</span>                                     <a href="../../include/nodes/primnodes.h.html#LN160"><span class='Ref_to_Const'>PRS2_NEW_VARNO</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>))</span> 
                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot refer to NEW within WITH query"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * For efficiency's sake, add OLD to the rule action's jointree 
             * only if it was actually referenced in the statement or qual. 
             * 
             * For INSERT, NEW is not really a relation (only a reference to 
             * the to-be-inserted tuple) and should never be added to the 
             * jointree. 
             * 
             * For UPDATE, we treat NEW as being another kind of reference to 
             * OLD, because it represents references to *transformed* tuples 
             * of the existing relation.  It would be wrong to enter NEW 
             * separately in the jointree, since that would cause a double 
             * join of the updated relation.  It's also wrong to fail to make 
             * a jointree entry if only NEW and not OLD is mentioned. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2440"><span class='Ref_To_Local'>has_old</span></a> <span class='Operator'>|| </span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2441"><span class='Ref_To_Local'>has_new</span></a> <span class='Operator'>&& </span><a href="parse_utilcmd.c.html#LN2328"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2847"><span class='Ref_to_Member'>event</span></a> <span class='Operator'>== </span><a href="../../include/nodes/nodes.h.html#LN651"><span class='Ref_to_EnumConst'>CMD_UPDATE</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* 
                 * If sub_qry is a setop, manipulating its jointree will do no 
                 * good at all, because the jointree is dummy. (This should be 
                 * a can't-happen case because of prior tests.) 
                 */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2438"><span class='Ref_To_Local'>sub_qry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN162"><span class='Ref_to_Member'>setOperations</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"conditional UNION/INTERSECT/EXCEPT statements are not implemented"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <span class='Comment_Multi_Line'>/* hack so we can use addRTEtoQuery() */ 
</span>                <a href="parse_utilcmd.c.html#LN2437"><span class='Ref_To_Local'>sub_pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN168"><span class='Ref_to_Member'>p_rtable</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN2438"><span class='Ref_To_Local'>sub_qry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN134"><span class='Ref_to_Member'>rtable</span></a><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN2437"><span class='Ref_To_Local'>sub_pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN170"><span class='Ref_to_Member'>p_joinlist</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN2438"><span class='Ref_To_Local'>sub_qry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN135"><span class='Ref_to_Member'>jointree</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1469"><span class='Ref_to_Member'>fromlist</span></a><span class='Delimiter'>; 
</span>                <a href="../../include/parser/parse_relation.h.html#LN114"><span class='Ref_to_Proto'>addRTEtoQuery</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2437"><span class='Ref_To_Local'>sub_pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2333"><span class='Ref_To_Local'>oldrte</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN2438"><span class='Ref_To_Local'>sub_qry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN135"><span class='Ref_to_Member'>jointree</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1469"><span class='Ref_to_Member'>fromlist</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN2437"><span class='Ref_To_Local'>sub_pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN170"><span class='Ref_to_Member'>p_joinlist</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <a href="parse_utilcmd.c.html#LN2429"><span class='Ref_To_Local'>newactions</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2429"><span class='Ref_To_Local'>newactions</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2439"><span class='Ref_To_Local'>top_subqry</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="parse_node.c.html#LN75"><span class='Ref_to_Func'>free_parsestate</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2437"><span class='Ref_To_Local'>sub_pstate</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Operator'>*</span><a href="parse_utilcmd.c.html#LN2329"><span class='Ref_to_Parameter'>actions</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN2429"><span class='Ref_To_Local'>newactions</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <a href="parse_node.c.html#LN75"><span class='Ref_to_Func'>free_parsestate</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2332"><span class='Ref_To_Local'>pstate</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Close relation, but keep the exclusive lock */ 
</span>    <a href="../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2331"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN33"><span class='Ref_to_Const'>NoLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end transformRuleStmt &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * transformAlterTableStmt - 
 *      parse analysis for ALTER TABLE 
 * 
 * Returns a List of utility commands to be done in sequence.  One of these 
 * will be the transformed AlterTableStmt, but there may be additional actions 
 * to be done before and after the actual AlterTable() call. 
 * 
 * To avoid race conditions, it's important that this function rely only on 
 * the passed-in relid (and not on stmt-&GT;relation) to determine the target 
 * relation. 
 */ 
</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>* 
</span><a name="LN2633"></a><span class='Declare_Function'>transformAlterTableStmt</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>relid</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN1662"><span class='Ref_to_Struct'>AlterTableStmt</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>stmt</span><span class='Delimiter'>, 
</span><a name="LN2634"></a>                        <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>queryString</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2636"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>rel</span><span class='Delimiter'>; 
</span><a name="LN2637"></a>    <a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Local'>pstate</span><span class='Delimiter'>; 
</span><a name="LN2638"></a>    <a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Declare_Local'>cxt</span><span class='Delimiter'>; 
</span><a name="LN2639"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN2640"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>save_alist</span><span class='Delimiter'>; 
</span><a name="LN2641"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lcmd</span><span class='Delimiter'>, 
</span><a name="LN2642"></a>               <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span><a name="LN2643"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>newcmds</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN2644"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>skipValidation</span> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span><a name="LN2645"></a>    <a href="../../include/nodes/parsenodes.h.html#LN1749"><span class='Ref_to_Struct'>AlterTableCmd</span></a> <span class='Operator'>*</span><span class='Declare_Local'>newcmd</span><span class='Delimiter'>; 
</span><a name="LN2646"></a>    <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We must not scribble on the passed-in AlterTableStmt, so copy it. (This 
     * is overkill, but easy.) 
     */ 
</span>    <a href="parse_utilcmd.c.html#LN2633"><span class='Ref_to_Parameter'>stmt</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN618"><span class='Ref_to_Macro'>copyObject</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2633"><span class='Ref_to_Parameter'>stmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Caller is responsible for locking the relation */ 
</span>    <a href="parse_utilcmd.c.html#LN2636"><span class='Ref_To_Local'>rel</span></a> <span class='Operator'>= </span><a href="../../include/access/heapam.h.html#LN84"><span class='Ref_to_Proto'>relation_open</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2633"><span class='Ref_to_Parameter'>relid</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN33"><span class='Ref_to_Const'>NoLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Set up pstate */ 
</span>    <a href="parse_utilcmd.c.html#LN2637"><span class='Ref_To_Local'>pstate</span></a> <span class='Operator'>= </span><a href="parse_node.c.html#LN42"><span class='Ref_to_Func'>make_parsestate</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN2637"><span class='Ref_To_Local'>pstate</span></a><span class='Operator'>-&GT;</span><a href="../../include/parser/parse_node.h.html#LN167"><span class='Ref_to_Member'>p_sourcetext</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN2634"><span class='Ref_to_Parameter'>queryString</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN2646"><span class='Ref_To_Local'>rte</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_relation.h.html#LN69"><span class='Ref_to_Proto'>addRangeTableEntryForRelation</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2637"><span class='Ref_To_Local'>pstate</span></a><span class='Delimiter'>, 
</span>                                        <a href="parse_utilcmd.c.html#LN2636"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>, 
</span>                                        <span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                                        <span class='Boolean'>false</span><span class='Delimiter'>, 
</span>                                        <span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/parser/parse_relation.h.html#LN114"><span class='Ref_to_Proto'>addRTEtoQuery</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2637"><span class='Ref_To_Local'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2646"><span class='Ref_To_Local'>rte</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Set up CreateStmtContext */ 
</span>    <a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN2637"><span class='Ref_To_Local'>pstate</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2633"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1667"><span class='Ref_to_Member'>relkind</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN1603"><span class='Ref_to_EnumConst'>OBJECT_FOREIGN_TABLE</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN75"><span class='Ref_to_Member'>stmtType</span></a> <span class='Operator'>= </span><span class='String'>"ALTER FOREIGN TABLE"</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN79"><span class='Ref_to_Member'>isforeign</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN75"><span class='Ref_to_Member'>stmtType</span></a> <span class='Operator'>= </span><span class='String'>"ALTER TABLE"</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN79"><span class='Ref_to_Member'>isforeign</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN76"><span class='Ref_to_Member'>relation</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN2633"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1665"><span class='Ref_to_Member'>relation</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN77"><span class='Ref_to_Member'>rel</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN2636"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN78"><span class='Ref_to_Member'>inhRelations</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN80"><span class='Ref_to_Member'>isalter</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN81"><span class='Ref_to_Member'>hasoids</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* need not be right */ 
</span>    <a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN82"><span class='Ref_to_Member'>columns</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN83"><span class='Ref_to_Member'>ckconstraints</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN84"><span class='Ref_to_Member'>fkconstraints</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN85"><span class='Ref_to_Member'>ixconstraints</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN86"><span class='Ref_to_Member'>inh_indexes</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN87"><span class='Ref_to_Member'>blist</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN91"><span class='Ref_to_Member'>pkey</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN92"><span class='Ref_to_Member'>ispartitioned</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2636"><span class='Ref_To_Local'>rel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relkind <span class='Operator'>== </span><a href="../../include/catalog/pg_class.h.html#LN167"><span class='Ref_to_Const'>RELKIND_PARTITIONED_TABLE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN93"><span class='Ref_to_Member'>partbound</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * The only subtypes that currently require parse transformation handling 
     * are ADD COLUMN, ADD CONSTRAINT and SET DATA TYPE.  These largely re-use 
     * code from CREATE TABLE. 
     */ 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2641"><span class='Ref_To_Local'>lcmd</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2633"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1666"><span class='Ref_to_Member'>cmds</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2702"></a>        <a href="../../include/nodes/parsenodes.h.html#LN1749"><span class='Ref_to_Struct'>AlterTableCmd</span></a> <span class='Operator'>*</span><span class='Declare_Local'>cmd</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN1749"><span class='Ref_to_Struct'>AlterTableCmd</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2641"><span class='Ref_To_Local'>lcmd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2702"><span class='Ref_To_Local'>cmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1752"><span class='Ref_to_Member'>subtype</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN1673"><span class='Ref_to_EnumConst'>AT_AddColumn</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN1675"><span class='Ref_to_EnumConst'>AT_AddColumnToView</span></a><span class='Operator'>: 
</span>                <span class='Delimiter'>{ 
</span><a name="LN2709"></a>                    <a href="../../include/nodes/parsenodes.h.html#LN636"><span class='Ref_to_Struct'>ColumnDef</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>def</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN575"><span class='Ref_to_Macro'>castNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN636"><span class='Ref_to_Struct'>ColumnDef</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2702"><span class='Ref_To_Local'>cmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1756"><span class='Ref_to_Member'>def</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                    <a href="parse_utilcmd.c.html#LN111"><span class='Ref_to_Proto'>transformColumnDefinition</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2709"><span class='Ref_To_Local'>def</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * If the column has a non-null default, we can't skip 
                     * validation of foreign keys. 
                     */ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2709"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN647"><span class='Ref_to_Member'>raw_default</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                        <a href="parse_utilcmd.c.html#LN2644"><span class='Ref_To_Local'>skipValidation</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * All constraints are processed in other ways. Remove the 
                     * original list 
                     */ 
</span>                    <a href="parse_utilcmd.c.html#LN2709"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN652"><span class='Ref_to_Member'>constraints</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
                    <a href="parse_utilcmd.c.html#LN2643"><span class='Ref_To_Local'>newcmds</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2643"><span class='Ref_To_Local'>newcmds</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2702"><span class='Ref_To_Local'>cmd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN1687"><span class='Ref_to_EnumConst'>AT_AddConstraint</span></a><span class='Operator'>: 
</span> 
                <span class='Comment_Multi_Line'>/* 
                 * The original AddConstraint cmd node doesn't go to newcmds 
                 */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2702"><span class='Ref_To_Local'>cmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1756"><span class='Ref_to_Member'>def</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a><span class='Parentheses'>))</span> 
                <span class='Delimiter'>{ 
</span>                    <a href="parse_utilcmd.c.html#LN113"><span class='Ref_to_Proto'>transformTableConstraint</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN2702"><span class='Ref_To_Local'>cmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1756"><span class='Ref_to_Member'>def</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(((</span><a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN2702"><span class='Ref_To_Local'>cmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1756"><span class='Ref_to_Member'>def</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>contype <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN2031"><span class='Ref_to_EnumConst'>CONSTR_FOREIGN</span></a><span class='Parentheses'>)</span> 
                        <a href="parse_utilcmd.c.html#LN2644"><span class='Ref_To_Local'>skipValidation</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                    <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized node type: %d"</span><span class='Delimiter'>, 
</span>                         <span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="../../include/nodes/nodes.h.html#LN513"><span class='Ref_to_Macro'>nodeTag</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2702"><span class='Ref_To_Local'>cmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1756"><span class='Ref_to_Member'>def</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN1693"><span class='Ref_to_EnumConst'>AT_ProcessedConstraint</span></a><span class='Operator'>: 
</span> 
                <span class='Comment_Multi_Line'>/* 
                 * Already-transformed ADD CONSTRAINT, so just make it look 
                 * like the standard case. 
                 */ 
</span>                <a href="parse_utilcmd.c.html#LN2702"><span class='Ref_To_Local'>cmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1752"><span class='Ref_to_Member'>subtype</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN1687"><span class='Ref_to_EnumConst'>AT_AddConstraint</span></a><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN2643"><span class='Ref_To_Local'>newcmds</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2643"><span class='Ref_To_Local'>newcmds</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2702"><span class='Ref_To_Local'>cmd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN1699"><span class='Ref_to_EnumConst'>AT_AlterColumnType</span></a><span class='Operator'>: 
</span>                <span class='Delimiter'>{ 
</span><a name="LN2758"></a>                    <a href="../../include/nodes/parsenodes.h.html#LN636"><span class='Ref_to_Struct'>ColumnDef</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>def</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN636"><span class='Ref_to_Struct'>ColumnDef</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN2702"><span class='Ref_To_Local'>cmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1756"><span class='Ref_to_Member'>def</span></a><span class='Delimiter'>; 
</span><a name="LN2759"></a>                    <a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a>  <span class='Declare_Local'>attnum</span><span class='Delimiter'>; 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * For ALTER COLUMN TYPE, transform the USING clause if 
                     * one was specified. 
                     */ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2758"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN647"><span class='Ref_to_Member'>raw_default</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <a href="parse_utilcmd.c.html#LN2758"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN648"><span class='Ref_to_Member'>cooked_default</span></a> <span class='Operator'>= 
</span>                            <a href="../../include/parser/parse_expr.h.html#LN21"><span class='Ref_to_Proto'>transformExpr</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2637"><span class='Ref_To_Local'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2758"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN647"><span class='Ref_to_Member'>raw_default</span></a><span class='Delimiter'>, 
</span>                                          <a href="../../include/parser/parse_node.h.html#LN65"><span class='Ref_to_EnumConst'>EXPR_KIND_ALTER_COL_TRANSFORM</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * For identity column, create ALTER SEQUENCE command to 
                     * change the data type of the sequence. 
                     */ 
</span>                    <a href="parse_utilcmd.c.html#LN2759"><span class='Ref_To_Local'>attnum</span></a> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN87"><span class='Ref_to_Proto'>get_attnum</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2633"><span class='Ref_to_Parameter'>relid</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2702"><span class='Ref_To_Local'>cmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1753"><span class='Ref_to_Member'>name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * if attribute not found, something will error about it 
                     * later 
                     */ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2759"><span class='Ref_To_Local'>attnum</span></a> <span class='Operator'>!= </span><a href="../../include/access/attnum.h.html#LN22"><span class='Ref_to_Const'>InvalidAttrNumber</span></a> <span class='Operator'>&& </span><a href="../../include/utils/lsyscache.h.html#LN88"><span class='Ref_to_Proto'>get_attidentity</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2633"><span class='Ref_to_Parameter'>relid</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2759"><span class='Ref_To_Local'>attnum</span></a><span class='Parentheses'>))</span> 
                    <span class='Delimiter'>{ 
</span><a name="LN2784"></a>                        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>seq_relid</span> <span class='Operator'>= </span><a href="../../include/catalog/dependency.h.html#LN242"><span class='Ref_to_Proto'>getOwnedSequence</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2633"><span class='Ref_to_Parameter'>relid</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2759"><span class='Ref_To_Local'>attnum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2785"></a>                        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>typeOid</span> <span class='Operator'>= </span><a href="../../include/parser/parse_type.h.html#LN27"><span class='Ref_to_Proto'>typenameTypeId</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2637"><span class='Ref_To_Local'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2758"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN640"><span class='Ref_to_Member'>typeName</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2786"></a>                        <a href="../../include/nodes/parsenodes.h.html#LN2448"><span class='Ref_to_Struct'>AlterSeqStmt</span></a> <span class='Operator'>*</span><span class='Declare_Local'>altseqstmt</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2448"><span class='Ref_to_Struct'>AlterSeqStmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                        <a href="parse_utilcmd.c.html#LN2786"><span class='Ref_To_Local'>altseqstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2451"><span class='Ref_to_Member'>sequence</span></a> <span class='Operator'>= </span><a href="../../include/nodes/makefuncs.h.html#LN68"><span class='Ref_to_Proto'>makeRangeVar</span></a><span class='Parentheses'>(</span><a href="../../include/utils/lsyscache.h.html#LN175"><span class='Ref_to_Proto'>get_namespace_name</span></a><span class='Parentheses'>(</span><a href="../../include/utils/lsyscache.h.html#LN125"><span class='Ref_to_Proto'>get_rel_namespace</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2784"><span class='Ref_To_Local'>seq_relid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, 
</span>                                                     <a href="../../include/utils/lsyscache.h.html#LN124"><span class='Ref_to_Proto'>get_rel_name</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2784"><span class='Ref_To_Local'>seq_relid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                                            <span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                        <a href="parse_utilcmd.c.html#LN2786"><span class='Ref_To_Local'>altseqstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2452"><span class='Ref_to_Member'>options</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN138"><span class='Ref_to_Macro'>list_make1</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/makefuncs.h.html#LN82"><span class='Ref_to_Proto'>makeDefElem</span></a><span class='Parentheses'>(</span><span class='String'>"as"</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/makefuncs.h.html#LN72"><span class='Ref_to_Proto'>makeTypeNameFromOid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2785"><span class='Ref_To_Local'>typeOid</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                        <a href="parse_utilcmd.c.html#LN2786"><span class='Ref_To_Local'>altseqstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2453"><span class='Ref_to_Member'>for_identity</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                        <a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN87"><span class='Ref_to_Member'>blist</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN87"><span class='Ref_to_Member'>blist</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2786"><span class='Ref_To_Local'>altseqstmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span> 
                    <a href="parse_utilcmd.c.html#LN2643"><span class='Ref_To_Local'>newcmds</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2643"><span class='Ref_To_Local'>newcmds</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2702"><span class='Ref_To_Local'>cmd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN1737"><span class='Ref_to_EnumConst'>AT_AddIdentity</span></a><span class='Operator'>: 
</span>                <span class='Delimiter'>{ 
</span><a name="LN2802"></a>                    <a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a> <span class='Operator'>*</span><span class='Declare_Local'>def</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN575"><span class='Ref_to_Macro'>castNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2702"><span class='Ref_To_Local'>cmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1756"><span class='Ref_to_Member'>def</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2803"></a>                    <a href="../../include/nodes/parsenodes.h.html#LN636"><span class='Ref_to_Struct'>ColumnDef</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>newdef</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN636"><span class='Ref_to_Struct'>ColumnDef</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2804"></a>                    <a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a>  <span class='Declare_Local'>attnum</span><span class='Delimiter'>; 
</span> 
                    <a href="parse_utilcmd.c.html#LN2803"><span class='Ref_To_Local'>newdef</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN639"><span class='Ref_to_Member'>colname</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN2702"><span class='Ref_To_Local'>cmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1753"><span class='Ref_to_Member'>name</span></a><span class='Delimiter'>; 
</span>                    <a href="parse_utilcmd.c.html#LN2803"><span class='Ref_To_Local'>newdef</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN649"><span class='Ref_to_Member'>identity</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN2802"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2065"><span class='Ref_to_Member'>generated_when</span></a><span class='Delimiter'>; 
</span>                    <a href="parse_utilcmd.c.html#LN2702"><span class='Ref_To_Local'>cmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1756"><span class='Ref_to_Member'>def</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN2803"><span class='Ref_To_Local'>newdef</span></a><span class='Delimiter'>; 
</span> 
                    <a href="parse_utilcmd.c.html#LN2804"><span class='Ref_To_Local'>attnum</span></a> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN87"><span class='Ref_to_Proto'>get_attnum</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2633"><span class='Ref_to_Parameter'>relid</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2702"><span class='Ref_To_Local'>cmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1753"><span class='Ref_to_Member'>name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * if attribute not found, something will error about it 
                     * later 
                     */ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2804"><span class='Ref_To_Local'>attnum</span></a> <span class='Operator'>!= </span><a href="../../include/access/attnum.h.html#LN22"><span class='Ref_to_Const'>InvalidAttrNumber</span></a><span class='Parentheses'>) 
</span>                        <a href="parse_utilcmd.c.html#LN356"><span class='Ref_to_Func'>generateSerialExtraStmts</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2803"><span class='Ref_To_Local'>newdef</span></a><span class='Delimiter'>, 
</span>                                                 <a href="../../include/utils/lsyscache.h.html#LN89"><span class='Ref_to_Proto'>get_atttype</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2633"><span class='Ref_to_Parameter'>relid</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2804"><span class='Ref_To_Local'>attnum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                                 <a href="parse_utilcmd.c.html#LN2802"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2074"><span class='Ref_to_Member'>options</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, 
</span>                                                 <span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                    <a href="parse_utilcmd.c.html#LN2643"><span class='Ref_To_Local'>newcmds</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2643"><span class='Ref_To_Local'>newcmds</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2702"><span class='Ref_To_Local'>cmd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN1738"><span class='Ref_to_EnumConst'>AT_SetIdentity</span></a><span class='Operator'>: 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Comment_Multi_Line'>/* 
                     * Create an ALTER SEQUENCE statement for the internal 
                     * sequence of the identity column. 
                     */ 
</span><a name="LN2832"></a>                    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lc</span><span class='Delimiter'>; 
</span><a name="LN2833"></a>                    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>newseqopts</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN2834"></a>                    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>newdef</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span><a name="LN2835"></a>                    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>seqlist</span><span class='Delimiter'>; 
</span><a name="LN2836"></a>                    <a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a>  <span class='Declare_Local'>attnum</span><span class='Delimiter'>; 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * Split options into those handled by ALTER SEQUENCE and 
                     * those for ALTER TABLE proper. 
                     */ 
</span>                    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2832"><span class='Ref_To_Local'>lc</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/nodes.h.html#LN575"><span class='Ref_to_Macro'>castNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2702"><span class='Ref_To_Local'>cmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1756"><span class='Ref_to_Member'>def</span></a><span class='Parentheses'>))</span> 
                    <span class='Delimiter'>{ 
</span><a name="LN2844"></a>                        <a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>def</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN108"><span class='Ref_to_Macro'>lfirst_node</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN715"><span class='Ref_to_Struct'>DefElem</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2832"><span class='Ref_To_Local'>lc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2844"><span class='Ref_To_Local'>def</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN719"><span class='Ref_to_Member'>defname</span></a><span class='Delimiter'>, </span><span class='String'>"generated"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                            <a href="parse_utilcmd.c.html#LN2834"><span class='Ref_To_Local'>newdef</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2834"><span class='Ref_To_Local'>newdef</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2844"><span class='Ref_To_Local'>def</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                        <span class='Control'>else</span> 
                            <a href="parse_utilcmd.c.html#LN2833"><span class='Ref_To_Local'>newseqopts</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2833"><span class='Ref_To_Local'>newseqopts</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2844"><span class='Ref_To_Local'>def</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span> 
                    <a href="parse_utilcmd.c.html#LN2836"><span class='Ref_To_Local'>attnum</span></a> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN87"><span class='Ref_to_Proto'>get_attnum</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2633"><span class='Ref_to_Parameter'>relid</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2702"><span class='Ref_To_Local'>cmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1753"><span class='Ref_to_Member'>name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2836"><span class='Ref_To_Local'>attnum</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <a href="parse_utilcmd.c.html#LN2835"><span class='Ref_To_Local'>seqlist</span></a> <span class='Operator'>= </span><a href="../../include/catalog/dependency.h.html#LN241"><span class='Ref_to_Proto'>getOwnedSequences</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2633"><span class='Ref_to_Parameter'>relid</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2836"><span class='Ref_To_Local'>attnum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2835"><span class='Ref_To_Local'>seqlist</span></a><span class='Parentheses'>) 
</span>                        <span class='Delimiter'>{ 
</span><a name="LN2859"></a>                            <a href="../../include/nodes/parsenodes.h.html#LN2448"><span class='Ref_to_Struct'>AlterSeqStmt</span></a> <span class='Operator'>*</span><span class='Declare_Local'>seqstmt</span><span class='Delimiter'>; 
</span><a name="LN2860"></a>                            <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>seq_relid</span><span class='Delimiter'>; 
</span> 
                            <a href="parse_utilcmd.c.html#LN2859"><span class='Ref_To_Local'>seqstmt</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2448"><span class='Ref_to_Struct'>AlterSeqStmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                            <a href="parse_utilcmd.c.html#LN2860"><span class='Ref_To_Local'>seq_relid</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN112"><span class='Ref_to_Macro'>linitial_oid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2835"><span class='Ref_To_Local'>seqlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                            <a href="parse_utilcmd.c.html#LN2859"><span class='Ref_To_Local'>seqstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2451"><span class='Ref_to_Member'>sequence</span></a> <span class='Operator'>= </span><a href="../../include/nodes/makefuncs.h.html#LN68"><span class='Ref_to_Proto'>makeRangeVar</span></a><span class='Parentheses'>(</span><a href="../../include/utils/lsyscache.h.html#LN175"><span class='Ref_to_Proto'>get_namespace_name</span></a><span class='Parentheses'>(</span><a href="../../include/utils/lsyscache.h.html#LN125"><span class='Ref_to_Proto'>get_rel_namespace</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2860"><span class='Ref_To_Local'>seq_relid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, 
</span>                                                <a href="../../include/utils/lsyscache.h.html#LN124"><span class='Ref_to_Proto'>get_rel_name</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2860"><span class='Ref_To_Local'>seq_relid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                            <a href="parse_utilcmd.c.html#LN2859"><span class='Ref_To_Local'>seqstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2452"><span class='Ref_to_Member'>options</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN2833"><span class='Ref_To_Local'>newseqopts</span></a><span class='Delimiter'>; 
</span>                            <a href="parse_utilcmd.c.html#LN2859"><span class='Ref_To_Local'>seqstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2453"><span class='Ref_to_Member'>for_identity</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                            <a href="parse_utilcmd.c.html#LN2859"><span class='Ref_To_Local'>seqstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2454"><span class='Ref_to_Member'>missing_ok</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
                            <a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2859"><span class='Ref_To_Local'>seqstmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                        <span class='Delimiter'>} 
</span>                    <span class='Delimiter'>} 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * If column was not found or was not an identity column, 
                     * we just let the ALTER TABLE command error out later. 
                     */ 
</span> 
                    <a href="parse_utilcmd.c.html#LN2702"><span class='Ref_To_Local'>cmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1756"><span class='Ref_to_Member'>def</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN2834"><span class='Ref_To_Local'>newdef</span></a><span class='Delimiter'>; 
</span>                    <a href="parse_utilcmd.c.html#LN2643"><span class='Ref_To_Local'>newcmds</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2643"><span class='Ref_To_Local'>newcmds</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2702"><span class='Ref_To_Local'>cmd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN1735"><span class='Ref_to_EnumConst'>AT_AttachPartition</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN1736"><span class='Ref_to_EnumConst'>AT_DetachPartition</span></a><span class='Operator'>: 
</span>                <span class='Delimiter'>{ 
</span><a name="LN2887"></a>                    <a href="../../include/nodes/parsenodes.h.html#LN829"><span class='Ref_to_Struct'>PartitionCmd</span></a> <span class='Operator'>*</span><span class='Declare_Local'>partcmd</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN829"><span class='Ref_to_Struct'>PartitionCmd</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN2702"><span class='Ref_To_Local'>cmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1756"><span class='Ref_to_Member'>def</span></a><span class='Delimiter'>; 
</span> 
                    <a href="parse_utilcmd.c.html#LN136"><span class='Ref_to_Proto'>transformPartitionCmd</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2887"><span class='Ref_To_Local'>partcmd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* assign transformed value of the partition bound */ 
</span>                    <a href="parse_utilcmd.c.html#LN2887"><span class='Ref_To_Local'>partcmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN833"><span class='Ref_to_Member'>bound</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN93"><span class='Ref_to_Member'>partbound</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span> 
                <a href="parse_utilcmd.c.html#LN2643"><span class='Ref_To_Local'>newcmds</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2643"><span class='Ref_To_Local'>newcmds</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2702"><span class='Ref_To_Local'>cmd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>default</span><span class='Operator'>: 
</span>                <a href="parse_utilcmd.c.html#LN2643"><span class='Ref_To_Local'>newcmds</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2643"><span class='Ref_To_Local'>newcmds</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2702"><span class='Ref_To_Local'>cmd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch cmd-&GT;subtype &raquo; </span> 
    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * transformIndexConstraints wants cxt.alist to contain only index 
     * statements, so transfer anything we already have into save_alist 
     * immediately. 
     */ 
</span>    <a href="parse_utilcmd.c.html#LN2640"><span class='Ref_To_Local'>save_alist</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Postprocess constraints */ 
</span>    <a href="parse_utilcmd.c.html#LN124"><span class='Ref_to_Proto'>transformIndexConstraints</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN127"><span class='Ref_to_Proto'>transformFKConstraints</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2644"><span class='Ref_To_Local'>skipValidation</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN130"><span class='Ref_to_Proto'>transformCheckConstraints</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Push any index-creation commands into the ALTER, so that they can be 
     * scheduled nicely by tablecmds.c.  Note that tablecmds.c assumes that 
     * the IndexStmt attached to an AT_AddIndex or AT_AddIndexConstraint 
     * subcommand has already been through transformIndexStmt. 
     */ 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2642"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2924"></a>        <a href="../../include/nodes/parsenodes.h.html#LN2667"><span class='Ref_to_Struct'>IndexStmt</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>idxstmt</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN108"><span class='Ref_to_Macro'>lfirst_node</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2667"><span class='Ref_to_Struct'>IndexStmt</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2642"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="parse_utilcmd.c.html#LN2924"><span class='Ref_To_Local'>idxstmt</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_utilcmd.h.html#LN22"><span class='Ref_to_Proto'>transformIndexStmt</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2633"><span class='Ref_to_Parameter'>relid</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2924"><span class='Ref_To_Local'>idxstmt</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2634"><span class='Ref_to_Parameter'>queryString</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN2645"><span class='Ref_To_Local'>newcmd</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN1749"><span class='Ref_to_Struct'>AlterTableCmd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN2645"><span class='Ref_To_Local'>newcmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1752"><span class='Ref_to_Member'>subtype</span></a> <span class='Operator'>= </span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2924"><span class='Ref_To_Local'>idxstmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2679"><span class='Ref_to_Member'>indexOid</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="../../include/nodes/parsenodes.h.html#LN1695"><span class='Ref_to_EnumConst'>AT_AddIndexConstraint</span></a> <span class='Operator'>: </span><a href="../../include/nodes/parsenodes.h.html#LN1685"><span class='Ref_to_EnumConst'>AT_AddIndex</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN2645"><span class='Ref_To_Local'>newcmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1756"><span class='Ref_to_Member'>def</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN2924"><span class='Ref_To_Local'>idxstmt</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN2643"><span class='Ref_To_Local'>newcmds</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2643"><span class='Ref_To_Local'>newcmds</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2645"><span class='Ref_To_Local'>newcmd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Append any CHECK or FK constraints to the commands list */ 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2642"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN83"><span class='Ref_to_Member'>ckconstraints</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="parse_utilcmd.c.html#LN2645"><span class='Ref_To_Local'>newcmd</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN1749"><span class='Ref_to_Struct'>AlterTableCmd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN2645"><span class='Ref_To_Local'>newcmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1752"><span class='Ref_to_Member'>subtype</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN1687"><span class='Ref_to_EnumConst'>AT_AddConstraint</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN2645"><span class='Ref_To_Local'>newcmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1756"><span class='Ref_to_Member'>def</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2642"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN2643"><span class='Ref_To_Local'>newcmds</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2643"><span class='Ref_To_Local'>newcmds</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2645"><span class='Ref_To_Local'>newcmd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2642"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN84"><span class='Ref_to_Member'>fkconstraints</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="parse_utilcmd.c.html#LN2645"><span class='Ref_To_Local'>newcmd</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN1749"><span class='Ref_to_Struct'>AlterTableCmd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN2645"><span class='Ref_To_Local'>newcmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1752"><span class='Ref_to_Member'>subtype</span></a> <span class='Operator'>= </span><a href="../../include/nodes/parsenodes.h.html#LN1687"><span class='Ref_to_EnumConst'>AT_AddConstraint</span></a><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN2645"><span class='Ref_To_Local'>newcmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1756"><span class='Ref_to_Member'>def</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2642"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN2643"><span class='Ref_To_Local'>newcmds</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2643"><span class='Ref_To_Local'>newcmds</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2645"><span class='Ref_To_Local'>newcmd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Close rel */ 
</span>    <a href="../../include/access/heapam.h.html#LN89"><span class='Ref_to_Proto'>relation_close</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2636"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>, </span><a href="../../include/storage/lockdefs.h.html#LN33"><span class='Ref_to_Const'>NoLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Output results. 
     */ 
</span>    <a href="parse_utilcmd.c.html#LN2633"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1666"><span class='Ref_to_Member'>cmds</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN2643"><span class='Ref_To_Local'>newcmds</span></a><span class='Delimiter'>; 
</span> 
    <a href="parse_utilcmd.c.html#LN2639"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN87"><span class='Ref_to_Member'>blist</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2633"><span class='Ref_to_Parameter'>stmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN2639"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN219"><span class='Ref_to_Proto'>list_concat</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2639"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2638"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN89"><span class='Ref_to_Member'>alist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN2639"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN219"><span class='Ref_to_Proto'>list_concat</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2639"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2640"><span class='Ref_To_Local'>save_alist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="parse_utilcmd.c.html#LN2639"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end transformAlterTableStmt &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * Preprocess a list of column constraint clauses 
 * to attach constraint attributes to their primary constraint nodes 
 * and detect inconsistent/misplaced constraint attributes. 
 * 
 * NOTE: currently, attributes are only supported for FOREIGN KEY, UNIQUE, 
 * EXCLUSION, and PRIMARY KEY constraints, but someday they ought to be 
 * supported for other constraint types. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN2976"></a><span class='Declare_Function'>transformConstraintAttrs</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cxt</span><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>constraintList</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2978"></a>    <a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a> <span class='Operator'>*</span><span class='Declare_Local'>lastprimarycon</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN2979"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>saw_deferrability</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN2980"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>saw_initially</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN2981"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>clist</span><span class='Delimiter'>; 
</span> 
<a name="LN2983"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>SUPPORTS_ATTRS</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>node</span><span class='Parentheses'>)</span>                <span class='Operator'>\ 
</span>    <span class='Parentheses'>((</span><a href="../replication/repl_gram.y.html#LN52"><span class='Ref_to_Global_Var'>node</span></a><span class='Parentheses'>)</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&&</span>                      <span class='Operator'>\ 
</span>     <span class='Parentheses'>((</span><a href="../replication/repl_gram.y.html#LN52"><span class='Ref_to_Global_Var'>node</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>contype <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN2028"><span class='Ref_to_EnumConst'>CONSTR_PRIMARY</span></a> <span class='Operator'>||</span>  <span class='Operator'>\ 
</span>      <span class='Parentheses'>(</span><a href="../replication/repl_gram.y.html#LN52"><span class='Ref_to_Global_Var'>node</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>contype <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN2029"><span class='Ref_to_EnumConst'>CONSTR_UNIQUE</span></a> <span class='Operator'>||</span>   <span class='Operator'>\ 
</span>      <span class='Parentheses'>(</span><a href="../replication/repl_gram.y.html#LN52"><span class='Ref_to_Global_Var'>node</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>contype <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN2030"><span class='Ref_to_EnumConst'>CONSTR_EXCLUSION</span></a> <span class='Operator'>|| \ 
</span>      <span class='Parentheses'>(</span><a href="../replication/repl_gram.y.html#LN52"><span class='Ref_to_Global_Var'>node</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>contype <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN2031"><span class='Ref_to_EnumConst'>CONSTR_FOREIGN</span></a><span class='Parentheses'>))</span> 
 
    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2981"><span class='Ref_To_Local'>clist</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2976"><span class='Ref_to_Parameter'>constraintList</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2992"></a>        <a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a> <span class='Operator'>*</span><span class='Declare_Local'>con</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2981"><span class='Ref_To_Local'>clist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2992"><span class='Ref_To_Local'>con</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN2050"><span class='Ref_to_Struct'>Constraint</span></a><span class='Parentheses'>))</span> 
            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized node type: %d"</span><span class='Delimiter'>, 
</span>                 <span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="../../include/nodes/nodes.h.html#LN513"><span class='Ref_to_Macro'>nodeTag</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2992"><span class='Ref_To_Local'>con</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2992"><span class='Ref_To_Local'>con</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2053"><span class='Ref_to_Member'>contype</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2032"><span class='Ref_to_EnumConst'>CONSTR_ATTR_DEFERRABLE</span></a><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_utilcmd.c.html#LN2983"><span class='Ref_to_Macro'>SUPPORTS_ATTRS</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2978"><span class='Ref_To_Local'>lastprimarycon</span></a><span class='Parentheses'>))</span> 
                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"misplaced DEFERRABLE clause"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2976"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2992"><span class='Ref_To_Local'>con</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2979"><span class='Ref_To_Local'>saw_deferrability</span></a><span class='Parentheses'>) 
</span>                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"multiple DEFERRABLE/NOT DEFERRABLE clauses not allowed"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2976"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2992"><span class='Ref_To_Local'>con</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN2979"><span class='Ref_To_Local'>saw_deferrability</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN2978"><span class='Ref_To_Local'>lastprimarycon</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2057"><span class='Ref_to_Member'>deferrable</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2033"><span class='Ref_to_EnumConst'>CONSTR_ATTR_NOT_DEFERRABLE</span></a><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_utilcmd.c.html#LN2983"><span class='Ref_to_Macro'>SUPPORTS_ATTRS</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2978"><span class='Ref_To_Local'>lastprimarycon</span></a><span class='Parentheses'>))</span> 
                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"misplaced NOT DEFERRABLE clause"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2976"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2992"><span class='Ref_To_Local'>con</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2979"><span class='Ref_To_Local'>saw_deferrability</span></a><span class='Parentheses'>) 
</span>                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"multiple DEFERRABLE/NOT DEFERRABLE clauses not allowed"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2976"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2992"><span class='Ref_To_Local'>con</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN2979"><span class='Ref_To_Local'>saw_deferrability</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN2978"><span class='Ref_To_Local'>lastprimarycon</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2057"><span class='Ref_to_Member'>deferrable</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2980"><span class='Ref_To_Local'>saw_initially</span></a> <span class='Operator'>&& 
</span>                    <a href="parse_utilcmd.c.html#LN2978"><span class='Ref_To_Local'>lastprimarycon</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2058"><span class='Ref_to_Member'>initdeferred</span></a><span class='Parentheses'>) 
</span>                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"constraint declared INITIALLY DEFERRED must be DEFERRABLE"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2976"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2992"><span class='Ref_To_Local'>con</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2034"><span class='Ref_to_EnumConst'>CONSTR_ATTR_DEFERRED</span></a><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_utilcmd.c.html#LN2983"><span class='Ref_to_Macro'>SUPPORTS_ATTRS</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2978"><span class='Ref_To_Local'>lastprimarycon</span></a><span class='Parentheses'>))</span> 
                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"misplaced INITIALLY DEFERRED clause"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2976"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2992"><span class='Ref_To_Local'>con</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2980"><span class='Ref_To_Local'>saw_initially</span></a><span class='Parentheses'>) 
</span>                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"multiple INITIALLY IMMEDIATE/DEFERRED clauses not allowed"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2976"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2992"><span class='Ref_To_Local'>con</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN2980"><span class='Ref_To_Local'>saw_initially</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN2978"><span class='Ref_To_Local'>lastprimarycon</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2058"><span class='Ref_to_Member'>initdeferred</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* 
                 * If only INITIALLY DEFERRED appears, assume DEFERRABLE 
                 */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_utilcmd.c.html#LN2979"><span class='Ref_To_Local'>saw_deferrability</span></a><span class='Parentheses'>) 
</span>                    <a href="parse_utilcmd.c.html#LN2978"><span class='Ref_To_Local'>lastprimarycon</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2057"><span class='Ref_to_Member'>deferrable</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_utilcmd.c.html#LN2978"><span class='Ref_To_Local'>lastprimarycon</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2057"><span class='Ref_to_Member'>deferrable</span></a><span class='Parentheses'>) 
</span>                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"constraint declared INITIALLY DEFERRED must be DEFERRABLE"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2976"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2992"><span class='Ref_To_Local'>con</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/parsenodes.h.html#LN2035"><span class='Ref_to_EnumConst'>CONSTR_ATTR_IMMEDIATE</span></a><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="parse_utilcmd.c.html#LN2983"><span class='Ref_to_Macro'>SUPPORTS_ATTRS</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2978"><span class='Ref_To_Local'>lastprimarycon</span></a><span class='Parentheses'>))</span> 
                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"misplaced INITIALLY IMMEDIATE clause"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2976"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2992"><span class='Ref_To_Local'>con</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2980"><span class='Ref_To_Local'>saw_initially</span></a><span class='Parentheses'>) 
</span>                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SYNTAX_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"multiple INITIALLY IMMEDIATE/DEFERRED clauses not allowed"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN2976"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN2992"><span class='Ref_To_Local'>con</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2059"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN2980"><span class='Ref_To_Local'>saw_initially</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN2978"><span class='Ref_To_Local'>lastprimarycon</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2058"><span class='Ref_to_Member'>initdeferred</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>default</span><span class='Operator'>: 
</span>                <span class='Comment_Multi_Line'>/* Otherwise it's not an attribute */ 
</span>                <a href="parse_utilcmd.c.html#LN2978"><span class='Ref_To_Local'>lastprimarycon</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN2992"><span class='Ref_To_Local'>con</span></a><span class='Delimiter'>; 
</span>                <span class='Comment_Multi_Line'>/* reset flags for new primary node */ 
</span>                <a href="parse_utilcmd.c.html#LN2979"><span class='Ref_To_Local'>saw_deferrability</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN2980"><span class='Ref_To_Local'>saw_initially</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch con-&GT;contype &raquo; </span> 
    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end transformConstraintAttrs &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Special handling of type definition for a column 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN3091"></a><span class='Declare_Function'>transformColumnType</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cxt</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN636"><span class='Ref_to_Struct'>ColumnDef</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>column</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* 
     * All we really need to do here is verify that the type is valid, 
     * including any collation spec that might be present. 
     */ 
</span><a name="LN3097"></a>    <a href="../../include/parser/parse_type.h.html#LN19"><span class='Ref_to_Typedef'>Type</span></a>        <span class='Declare_Local'>ctype</span> <span class='Operator'>= </span><a href="../../include/parser/parse_type.h.html#LN25"><span class='Ref_to_Proto'>typenameType</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3091"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3091"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN640"><span class='Ref_to_Member'>typeName</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3091"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN650"><span class='Ref_to_Member'>collClause</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3101"></a>        <a href="../../include/catalog/pg_type.h.html#LN232"><span class='Ref_to_Typedef'>Form_pg_type</span></a> <span class='Declare_Local'>typtup</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/catalog/pg_type.h.html#LN232"><span class='Ref_to_Typedef'>Form_pg_type</span></a><span class='Parentheses'>) </span><a href="../../include/access/htup_details.h.html#LN655"><span class='Ref_to_Macro'>GETSTRUCT</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3097"><span class='Ref_To_Local'>ctype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="../../include/parser/parse_type.h.html#LN34"><span class='Ref_to_Proto'>LookupCollation</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3091"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, 
</span>                        <a href="parse_utilcmd.c.html#LN3091"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN650"><span class='Ref_to_Member'>collClause</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN309"><span class='Ref_to_Member'>collname</span></a><span class='Delimiter'>, 
</span>                        <a href="parse_utilcmd.c.html#LN3091"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN650"><span class='Ref_to_Member'>collClause</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN310"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* Complain if COLLATE is applied to an uncollatable type */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3101"><span class='Ref_To_Local'>typtup</span></a><span class='Operator'>-&GT;</span>typcollation<span class='Parentheses'>))</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATATYPE_MISMATCH<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"collations are not supported by type %s"</span><span class='Delimiter'>, 
</span>                            <a href="../utils/adt/format_type.c.html#LN92"><span class='Ref_to_Func'>format_type_be</span></a><span class='Parentheses'>(</span><a href="../../include/access/htup_details.h.html#LN694"><span class='Ref_to_Macro'>HeapTupleGetOid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3097"><span class='Ref_To_Local'>ctype</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>, 
</span>                     <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3091"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, 
</span>                                        <a href="parse_utilcmd.c.html#LN3091"><span class='Ref_to_Parameter'>column</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN650"><span class='Ref_to_Member'>collClause</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN310"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../include/utils/syscache.h.html#LN119"><span class='Ref_to_Proto'>ReleaseSysCache</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3097"><span class='Ref_To_Local'>ctype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end transformColumnType &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * transformCreateSchemaStmt - 
 *    analyzes the CREATE SCHEMA statement 
 * 
 * Split the schema element list into individual commands and place 
 * them in the result list in an order such that there are no forward 
 * references (e.g. GRANT to a table created later in the list). Note 
 * that the logic we use for determining forward references is 
 * presently quite incomplete. 
 * 
 * SQL also allows constraints to make forward references, so thumb through 
 * the table columns and move forward references to a posterior alter-table 
 * command. 
 * 
 * The result is a list of parse nodes that still need to be analyzed --- 
 * but we can't analyze the later commands until we've executed the earlier 
 * ones, because of possible inter-object references. 
 * 
 * Note: this breaks the rules a little bit by modifying schema-name fields 
 * within passed-in structs.  However, the transformation would be the same 
 * if done over, so it should be all right to scribble on the input to this 
 * extent. 
 */ 
</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>* 
</span><a name="LN3144"></a><span class='Declare_Function'>transformCreateSchemaStmt</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN1643"><span class='Ref_to_Struct'>CreateSchemaStmt</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>stmt</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3146"></a>    <a href="parse_utilcmd.c.html#LN97"><span class='Ref_to_Typedef'>CreateSchemaStmtContext</span></a> <span class='Declare_Local'>cxt</span><span class='Delimiter'>; 
</span><a name="LN3147"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN3148"></a>    <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>elements</span><span class='Delimiter'>; 
</span> 
    <a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN99"><span class='Ref_to_Member'>stmtType</span></a> <span class='Operator'>= </span><span class='String'>"CREATE SCHEMA"</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN100"><span class='Ref_to_Member'>schemaname</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN3144"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1646"><span class='Ref_to_Member'>schemaname</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN101"><span class='Ref_to_Member'>authrole</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN324"><span class='Ref_to_Struct'>RoleSpec</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN3144"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1647"><span class='Ref_to_Member'>authrole</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN102"><span class='Ref_to_Member'>sequences</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN103"><span class='Ref_to_Member'>tables</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN104"><span class='Ref_to_Member'>views</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN105"><span class='Ref_to_Member'>indexes</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN106"><span class='Ref_to_Member'>triggers</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN107"><span class='Ref_to_Member'>grants</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Run through each schema element in the schema element list. Separate 
     * statements by type, and do preliminary analysis. 
     */ 
</span>    <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3148"><span class='Ref_To_Local'>elements</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3144"><span class='Ref_to_Parameter'>stmt</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1648"><span class='Ref_to_Member'>schemaElts</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3166"></a>        <a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>element</span> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3148"><span class='Ref_To_Local'>elements</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN513"><span class='Ref_to_Macro'>nodeTag</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3166"><span class='Ref_To_Local'>element</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>case</span> <a href="../../include/nodes/nodes.h.html#LN343"><span class='Ref_to_EnumConst'>T_CreateSeqStmt</span></a><span class='Operator'>: 
</span>                <span class='Delimiter'>{ 
</span><a name="LN3172"></a>                    <a href="../../include/nodes/parsenodes.h.html#LN2438"><span class='Ref_to_Struct'>CreateSeqStmt</span></a> <span class='Operator'>*</span><span class='Declare_Local'>elp</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2438"><span class='Ref_to_Struct'>CreateSeqStmt</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN3166"><span class='Ref_To_Local'>element</span></a><span class='Delimiter'>; 
</span> 
                    <a href="parse_utilcmd.c.html#LN135"><span class='Ref_to_Proto'>setSchemaName</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN100"><span class='Ref_to_Member'>schemaname</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN3172"><span class='Ref_To_Local'>elp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2441"><span class='Ref_to_Member'>sequence</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN102"><span class='Ref_to_Member'>sequences</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN102"><span class='Ref_to_Member'>sequences</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3166"><span class='Ref_To_Local'>element</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/nodes.h.html#LN319"><span class='Ref_to_EnumConst'>T_CreateStmt</span></a><span class='Operator'>: 
</span>                <span class='Delimiter'>{ 
</span><a name="LN3181"></a>                    <a href="../../include/nodes/parsenodes.h.html#LN1972"><span class='Ref_to_Struct'>CreateStmt</span></a> <span class='Operator'>*</span><span class='Declare_Local'>elp</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN1972"><span class='Ref_to_Struct'>CreateStmt</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN3166"><span class='Ref_To_Local'>element</span></a><span class='Delimiter'>; 
</span> 
                    <a href="parse_utilcmd.c.html#LN135"><span class='Ref_to_Proto'>setSchemaName</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN100"><span class='Ref_to_Member'>schemaname</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN3181"><span class='Ref_To_Local'>elp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1975"><span class='Ref_to_Member'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * XXX todo: deal with constraints 
                     */ 
</span>                    <a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN103"><span class='Ref_to_Member'>tables</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN103"><span class='Ref_to_Member'>tables</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3166"><span class='Ref_To_Local'>element</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/nodes.h.html#LN335"><span class='Ref_to_EnumConst'>T_ViewStmt</span></a><span class='Operator'>: 
</span>                <span class='Delimiter'>{ 
</span><a name="LN3194"></a>                    <a href="../../include/nodes/parsenodes.h.html#LN2969"><span class='Ref_to_Struct'>ViewStmt</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>elp</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2969"><span class='Ref_to_Struct'>ViewStmt</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN3166"><span class='Ref_To_Local'>element</span></a><span class='Delimiter'>; 
</span> 
                    <a href="parse_utilcmd.c.html#LN135"><span class='Ref_to_Proto'>setSchemaName</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN100"><span class='Ref_to_Member'>schemaname</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN3194"><span class='Ref_To_Local'>elp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2972"><span class='Ref_to_Member'>view</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * XXX todo: deal with references between views 
                     */ 
</span>                    <a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN104"><span class='Ref_to_Member'>views</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN104"><span class='Ref_to_Member'>views</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3166"><span class='Ref_To_Local'>element</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/nodes.h.html#LN325"><span class='Ref_to_EnumConst'>T_IndexStmt</span></a><span class='Operator'>: 
</span>                <span class='Delimiter'>{ 
</span><a name="LN3207"></a>                    <a href="../../include/nodes/parsenodes.h.html#LN2667"><span class='Ref_to_Struct'>IndexStmt</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>elp</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2667"><span class='Ref_to_Struct'>IndexStmt</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN3166"><span class='Ref_To_Local'>element</span></a><span class='Delimiter'>; 
</span> 
                    <a href="parse_utilcmd.c.html#LN135"><span class='Ref_to_Proto'>setSchemaName</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN100"><span class='Ref_to_Member'>schemaname</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN3207"><span class='Ref_To_Local'>elp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2671"><span class='Ref_to_Member'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN105"><span class='Ref_to_Member'>indexes</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN105"><span class='Ref_to_Member'>indexes</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3166"><span class='Ref_To_Local'>element</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/nodes.h.html#LN348"><span class='Ref_to_EnumConst'>T_CreateTrigStmt</span></a><span class='Operator'>: 
</span>                <span class='Delimiter'>{ 
</span><a name="LN3216"></a>                    <a href="../../include/nodes/parsenodes.h.html#LN2322"><span class='Ref_to_Struct'>CreateTrigStmt</span></a> <span class='Operator'>*</span><span class='Declare_Local'>elp</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN2322"><span class='Ref_to_Struct'>CreateTrigStmt</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN3166"><span class='Ref_To_Local'>element</span></a><span class='Delimiter'>; 
</span> 
                    <a href="parse_utilcmd.c.html#LN135"><span class='Ref_to_Proto'>setSchemaName</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN100"><span class='Ref_to_Member'>schemaname</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN3216"><span class='Ref_To_Local'>elp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN2326"><span class='Ref_to_Member'>relation</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN66"><span class='Ref_to_Member'>schemaname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN106"><span class='Ref_to_Member'>triggers</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN106"><span class='Ref_to_Member'>triggers</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3166"><span class='Ref_To_Local'>element</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../include/nodes/nodes.h.html#LN313"><span class='Ref_to_EnumConst'>T_GrantStmt</span></a><span class='Operator'>: 
</span>                <a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN107"><span class='Ref_to_Member'>grants</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN107"><span class='Ref_to_Member'>grants</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3166"><span class='Ref_To_Local'>element</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>default</span><span class='Operator'>: 
</span>                <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unrecognized node type: %d"</span><span class='Delimiter'>, 
</span>                     <span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="../../include/nodes/nodes.h.html#LN513"><span class='Ref_to_Macro'>nodeTag</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3166"><span class='Ref_To_Local'>element</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch nodeTag(element) &raquo; </span> 
    <span class='Delimiter'>} 
</span> 
    <a href="parse_utilcmd.c.html#LN3147"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN3147"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN219"><span class='Ref_to_Proto'>list_concat</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3147"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN102"><span class='Ref_to_Member'>sequences</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN3147"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN219"><span class='Ref_to_Proto'>list_concat</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3147"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN103"><span class='Ref_to_Member'>tables</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN3147"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN219"><span class='Ref_to_Proto'>list_concat</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3147"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN104"><span class='Ref_to_Member'>views</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN3147"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN219"><span class='Ref_to_Proto'>list_concat</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3147"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN105"><span class='Ref_to_Member'>indexes</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN3147"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN219"><span class='Ref_to_Proto'>list_concat</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3147"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN106"><span class='Ref_to_Member'>triggers</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="parse_utilcmd.c.html#LN3147"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN219"><span class='Ref_to_Proto'>list_concat</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3147"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3146"><span class='Ref_To_Local'>cxt</span></a><span class='Operator'>.</span><a href="parse_utilcmd.c.html#LN107"><span class='Ref_to_Member'>grants</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="parse_utilcmd.c.html#LN3147"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end transformCreateSchemaStmt &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * setSchemaName 
 *      Set or check schema name in an element of a CREATE SCHEMA command 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN3249"></a><span class='Declare_Function'>setSchemaName</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>context_schema</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>**</span><span class='Declare_Parameter'>stmt_schema_name</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="parse_utilcmd.c.html#LN3249"><span class='Ref_to_Parameter'>stmt_schema_name</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="parse_utilcmd.c.html#LN3249"><span class='Ref_to_Parameter'>stmt_schema_name</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN3249"><span class='Ref_to_Parameter'>context_schema</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3249"><span class='Ref_to_Parameter'>context_schema</span></a><span class='Delimiter'>, </span><span class='Operator'>*</span><a href="parse_utilcmd.c.html#LN3249"><span class='Ref_to_Parameter'>stmt_schema_name</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_SCHEMA_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"CREATE specifies a schema (%s) "</span> 
                        <span class='String'>"different from the one being created (%s)"</span><span class='Delimiter'>, 
</span>                        <span class='Operator'>*</span><a href="parse_utilcmd.c.html#LN3249"><span class='Ref_to_Parameter'>stmt_schema_name</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3249"><span class='Ref_to_Parameter'>context_schema</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * transformPartitionCmd 
 *      Analyze the ATTACH/DETACH PARTITION command 
 * 
 * In case of the ATTACH PARTITION command, cxt-&GT;partbound is set to the 
 * transformed value of cmd-&GT;bound. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN3269"></a><span class='Declare_Function'>transformPartitionCmd</span><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN72"><span class='Ref_to_Typedef'>CreateStmtContext</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cxt</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN829"><span class='Ref_to_Struct'>PartitionCmd</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cmd</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3271"></a>    <a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>parentRel</span> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN3269"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN77"><span class='Ref_to_Member'>rel</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* the table must be partitioned */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3271"><span class='Ref_To_Local'>parentRel</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN113"><span class='Ref_to_Member'>rd_rel</span></a><span class='Operator'>-&GT;</span>relkind <span class='Operator'>!= </span><a href="../../include/catalog/pg_class.h.html#LN167"><span class='Ref_to_Const'>RELKIND_PARTITIONED_TABLE</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"\"%s\" is not partitioned"</span><span class='Delimiter'>, 
</span>                        <a href="../../include/utils/rel.h.html#LN436"><span class='Ref_to_Macro'>RelationGetRelationName</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3271"><span class='Ref_To_Local'>parentRel</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* transform the partition bound, if any */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../include/utils/rel.h.html#LN584"><span class='Ref_to_Macro'>RelationGetPartitionKey</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3271"><span class='Ref_To_Local'>parentRel</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3269"><span class='Ref_to_Parameter'>cmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN833"><span class='Ref_to_Member'>bound</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <a href="parse_utilcmd.c.html#LN3269"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN93"><span class='Ref_to_Member'>partbound</span></a> <span class='Operator'>= </span><a href="../../include/parser/parse_utilcmd.h.html#LN27"><span class='Ref_to_Proto'>transformPartitionBound</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3269"><span class='Ref_to_Parameter'>cxt</span></a><span class='Operator'>-&GT;</span><a href="parse_utilcmd.c.html#LN74"><span class='Ref_to_Member'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3271"><span class='Ref_To_Local'>parentRel</span></a><span class='Delimiter'>, 
</span>                                                 <a href="parse_utilcmd.c.html#LN3269"><span class='Ref_to_Parameter'>cmd</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN833"><span class='Ref_to_Member'>bound</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * transformPartitionBound 
 * 
 * Transform a partition bound specification 
 */ 
</span><a href="../../include/nodes/parsenodes.h.html#LN795"><span class='Ref_to_Struct'>PartitionBoundSpec</span></a> <span class='Operator'>* 
</span><a name="LN3293"></a><span class='Declare_Function'>transformPartitionBound</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><a href="../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a> <span class='Declare_Parameter'>parent</span><span class='Delimiter'>, 
</span><a name="LN3294"></a>                        <a href="../../include/nodes/parsenodes.h.html#LN795"><span class='Ref_to_Struct'>PartitionBoundSpec</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>spec</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3296"></a>    <a href="../../include/nodes/parsenodes.h.html#LN795"><span class='Ref_to_Struct'>PartitionBoundSpec</span></a> <span class='Operator'>*</span><span class='Declare_Local'>result_spec</span><span class='Delimiter'>; 
</span><a name="LN3297"></a>    <a href="../../include/utils/rel.h.html#LN76"><span class='Ref_to_Typedef'>PartitionKey</span></a> <span class='Declare_Local'>key</span> <span class='Operator'>= </span><a href="../../include/utils/rel.h.html#LN584"><span class='Ref_to_Macro'>RelationGetPartitionKey</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3293"><span class='Ref_to_Parameter'>parent</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN3298"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>strategy</span> <span class='Operator'>= </span><a href="../../include/utils/rel.h.html#LN589"><span class='Ref_to_Func'>get_partition_strategy</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3297"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN3299"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>partnatts</span> <span class='Operator'>= </span><a href="../../include/utils/rel.h.html#LN595"><span class='Ref_to_Func'>get_partition_natts</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3297"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN3300"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>partexprs</span> <span class='Operator'>= </span><a href="../../include/utils/rel.h.html#LN601"><span class='Ref_to_Func'>get_partition_exprs</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3297"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Avoid scribbling on input */ 
</span>    <a href="parse_utilcmd.c.html#LN3296"><span class='Ref_To_Local'>result_spec</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN618"><span class='Ref_to_Macro'>copyObject</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3294"><span class='Ref_to_Parameter'>spec</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3298"><span class='Ref_To_Local'>strategy</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN786"><span class='Ref_to_Const'>PARTITION_STRATEGY_LIST</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3307"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>cell</span><span class='Delimiter'>; 
</span><a name="LN3308"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>colname</span><span class='Delimiter'>; 
</span><a name="LN3309"></a>        <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>coltype</span><span class='Delimiter'>; 
</span><a name="LN3310"></a>        <a href="../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>coltypmod</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3294"><span class='Ref_to_Parameter'>spec</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN799"><span class='Ref_to_Member'>strategy</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/parsenodes.h.html#LN786"><span class='Ref_to_Const'>PARTITION_STRATEGY_LIST</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_TABLE_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                  <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"invalid bound specification for a list partition"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                   <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3293"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/nodeFuncs.h.html#LN43"><span class='Ref_to_Proto'>exprLocation</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN3294"><span class='Ref_to_Parameter'>spec</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Get the only column's name in case we need to output an error */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3297"><span class='Ref_To_Local'>key</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN55"><span class='Ref_to_Member'>partattrs</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="parse_utilcmd.c.html#LN3308"><span class='Ref_To_Local'>colname</span></a> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN86"><span class='Ref_to_Proto'>get_relid_attribute_name</span></a><span class='Parentheses'>(</span><a href="../../include/utils/rel.h.html#LN416"><span class='Ref_to_Macro'>RelationGetRelid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3293"><span class='Ref_to_Parameter'>parent</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                               <a href="parse_utilcmd.c.html#LN3297"><span class='Ref_To_Local'>key</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN55"><span class='Ref_to_Member'>partattrs</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="parse_utilcmd.c.html#LN3308"><span class='Ref_To_Local'>colname</span></a> <span class='Operator'>= </span><a href="../../include/utils/ruleutils.h.html#LN26"><span class='Ref_to_Proto'>deparse_expression</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>)</span> <a href="../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3300"><span class='Ref_To_Local'>partexprs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../../include/utils/ruleutils.h.html#LN28"><span class='Ref_to_Proto'>deparse_context_for</span></a><span class='Parentheses'>(</span><a href="../../include/utils/rel.h.html#LN436"><span class='Ref_to_Macro'>RelationGetRelationName</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3293"><span class='Ref_to_Parameter'>parent</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                             <a href="../../include/utils/rel.h.html#LN416"><span class='Ref_to_Macro'>RelationGetRelid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3293"><span class='Ref_to_Parameter'>parent</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, 
</span>                                         <span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* Need its type data too */ 
</span>        <a href="parse_utilcmd.c.html#LN3309"><span class='Ref_To_Local'>coltype</span></a> <span class='Operator'>= </span><a href="../../include/utils/rel.h.html#LN616"><span class='Ref_to_Func'>get_partition_col_typid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3297"><span class='Ref_To_Local'>key</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN3310"><span class='Ref_To_Local'>coltypmod</span></a> <span class='Operator'>= </span><a href="../../include/utils/rel.h.html#LN622"><span class='Ref_to_Func'>get_partition_col_typmod</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3297"><span class='Ref_To_Local'>key</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="parse_utilcmd.c.html#LN3296"><span class='Ref_To_Local'>result_spec</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN802"><span class='Ref_to_Member'>listdatums</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3307"><span class='Ref_To_Local'>cell</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3294"><span class='Ref_to_Parameter'>spec</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN802"><span class='Ref_to_Member'>listdatums</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN3334"></a>            <a href="../../include/nodes/parsenodes.h.html#LN284"><span class='Ref_to_Struct'>A_Const</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>con</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN575"><span class='Ref_to_Macro'>castNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN284"><span class='Ref_to_Struct'>A_Const</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3307"><span class='Ref_To_Local'>cell</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span><a name="LN3335"></a>            <a href="../../include/nodes/primnodes.h.html#LN188"><span class='Ref_to_Struct'>Const</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>value</span><span class='Delimiter'>; 
</span><a name="LN3336"></a>            <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>cell2</span><span class='Delimiter'>; 
</span><a name="LN3337"></a>            <span class='Keyword'>bool</span>        <span class='Declare_Local'>duplicate</span><span class='Delimiter'>; 
</span> 
            <span class='Keyword'>value </span><span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN137"><span class='Ref_to_Proto'>transformPartitionBoundValue</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3293"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3334"><span class='Ref_To_Local'>con</span></a><span class='Delimiter'>, 
</span>                                                 <a href="parse_utilcmd.c.html#LN3308"><span class='Ref_To_Local'>colname</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3309"><span class='Ref_To_Local'>coltype</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3310"><span class='Ref_To_Local'>coltypmod</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Don't add to the result if the value is a duplicate */ 
</span>            <a href="parse_utilcmd.c.html#LN3337"><span class='Ref_To_Local'>duplicate</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3336"><span class='Ref_To_Local'>cell2</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3296"><span class='Ref_To_Local'>result_spec</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN802"><span class='Ref_to_Member'>listdatums</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN3346"></a>                <a href="../../include/nodes/primnodes.h.html#LN188"><span class='Ref_to_Struct'>Const</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>value2</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN575"><span class='Ref_to_Macro'>castNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN188"><span class='Ref_to_Struct'>Const</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3336"><span class='Ref_To_Local'>cell2</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN626"><span class='Ref_to_Proto'>equal</span></a><span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3346"><span class='Ref_To_Local'>value2</span></a><span class='Parentheses'>))</span> 
                <span class='Delimiter'>{ 
</span>                    <a href="parse_utilcmd.c.html#LN3337"><span class='Ref_To_Local'>duplicate</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3337"><span class='Ref_To_Local'>duplicate</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
            <a href="parse_utilcmd.c.html#LN3296"><span class='Ref_To_Local'>result_spec</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN802"><span class='Ref_to_Member'>listdatums</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3296"><span class='Ref_To_Local'>result_spec</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN802"><span class='Ref_to_Member'>listdatums</span></a><span class='Delimiter'>, 
</span>                                              <span class='Keyword'>value</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if strategy==PARTITION_S... &raquo; </span> 
    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3298"><span class='Ref_To_Local'>strategy</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN787"><span class='Ref_to_Const'>PARTITION_STRATEGY_RANGE</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3363"></a>        <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>cell1</span><span class='Delimiter'>, 
</span><a name="LN3364"></a>                   <span class='Operator'>*</span><span class='Declare_Local'>cell2</span><span class='Delimiter'>; 
</span><a name="LN3365"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>, 
</span><a name="LN3366"></a>                    <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span><a name="LN3367"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>seen_unbounded</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3294"><span class='Ref_to_Parameter'>spec</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN799"><span class='Ref_to_Member'>strategy</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/parsenodes.h.html#LN787"><span class='Ref_to_Const'>PARTITION_STRATEGY_RANGE</span></a><span class='Parentheses'>) 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_TABLE_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"invalid bound specification for a range partition"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                   <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3293"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/nodeFuncs.h.html#LN43"><span class='Ref_to_Proto'>exprLocation</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN3294"><span class='Ref_to_Parameter'>spec</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3294"><span class='Ref_to_Parameter'>spec</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN805"><span class='Ref_to_Member'>lowerdatums</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="parse_utilcmd.c.html#LN3299"><span class='Ref_To_Local'>partnatts</span></a><span class='Parentheses'>)</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_TABLE_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"FROM must specify exactly one value per partitioning column"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3294"><span class='Ref_to_Parameter'>spec</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN806"><span class='Ref_to_Member'>upperdatums</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="parse_utilcmd.c.html#LN3299"><span class='Ref_To_Local'>partnatts</span></a><span class='Parentheses'>)</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_TABLE_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"TO must specify exactly one value per partitioning column"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Check that no finite value follows an UNBOUNDED item in either of 
         * lower and upper bound lists. 
         */ 
</span>        <a href="parse_utilcmd.c.html#LN3367"><span class='Ref_To_Local'>seen_unbounded</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3363"><span class='Ref_To_Local'>cell1</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3294"><span class='Ref_to_Parameter'>spec</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN805"><span class='Ref_to_Member'>lowerdatums</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN3391"></a>            <a href="../../include/nodes/parsenodes.h.html#LN816"><span class='Ref_to_Struct'>PartitionRangeDatum</span></a> <span class='Operator'>*</span><span class='Declare_Local'>ldatum</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN575"><span class='Ref_to_Macro'>castNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN816"><span class='Ref_to_Struct'>PartitionRangeDatum</span></a><span class='Delimiter'>, 
</span>                                                   <a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3363"><span class='Ref_To_Local'>cell1</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3391"><span class='Ref_To_Local'>ldatum</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN820"><span class='Ref_to_Member'>infinite</span></a><span class='Parentheses'>) 
</span>                <a href="parse_utilcmd.c.html#LN3367"><span class='Ref_To_Local'>seen_unbounded</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3367"><span class='Ref_To_Local'>seen_unbounded</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATATYPE_MISMATCH<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                       <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot specify finite value after UNBOUNDED"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3293"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/nodeFuncs.h.html#LN43"><span class='Ref_to_Proto'>exprLocation</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN3391"><span class='Ref_To_Local'>ldatum</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="parse_utilcmd.c.html#LN3367"><span class='Ref_To_Local'>seen_unbounded</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3363"><span class='Ref_To_Local'>cell1</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3294"><span class='Ref_to_Parameter'>spec</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN806"><span class='Ref_to_Member'>upperdatums</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN3405"></a>            <a href="../../include/nodes/parsenodes.h.html#LN816"><span class='Ref_to_Struct'>PartitionRangeDatum</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rdatum</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN575"><span class='Ref_to_Macro'>castNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN816"><span class='Ref_to_Struct'>PartitionRangeDatum</span></a><span class='Delimiter'>, 
</span>                                                   <a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3363"><span class='Ref_To_Local'>cell1</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3405"><span class='Ref_To_Local'>rdatum</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN820"><span class='Ref_to_Member'>infinite</span></a><span class='Parentheses'>) 
</span>                <a href="parse_utilcmd.c.html#LN3367"><span class='Ref_To_Local'>seen_unbounded</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3367"><span class='Ref_To_Local'>seen_unbounded</span></a><span class='Parentheses'>) 
</span>                <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATATYPE_MISMATCH<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                       <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot specify finite value after UNBOUNDED"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3293"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/nodeFuncs.h.html#LN43"><span class='Ref_to_Proto'>exprLocation</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN3405"><span class='Ref_To_Local'>rdatum</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* Transform all the constants */ 
</span>        <a href="parse_utilcmd.c.html#LN3365"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN3366"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="parse_utilcmd.c.html#LN3296"><span class='Ref_To_Local'>result_spec</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN805"><span class='Ref_to_Member'>lowerdatums</span></a> <span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN3296"><span class='Ref_To_Local'>result_spec</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN806"><span class='Ref_to_Member'>upperdatums</span></a> <span class='Operator'>= </span><a href="../../include/nodes/pg_list.h.html#LN68"><span class='Ref_to_Const'>NIL</span></a><span class='Delimiter'>; 
</span>        <a href="../../include/nodes/pg_list.h.html#LN179"><span class='Ref_to_Macro'>forboth</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3363"><span class='Ref_To_Local'>cell1</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3294"><span class='Ref_to_Parameter'>spec</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN805"><span class='Ref_to_Member'>lowerdatums</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3364"><span class='Ref_To_Local'>cell2</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3294"><span class='Ref_to_Parameter'>spec</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN806"><span class='Ref_to_Member'>upperdatums</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN3422"></a>            <a href="../../include/nodes/parsenodes.h.html#LN816"><span class='Ref_to_Struct'>PartitionRangeDatum</span></a> <span class='Operator'>*</span><span class='Declare_Local'>ldatum</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN816"><span class='Ref_to_Struct'>PartitionRangeDatum</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3363"><span class='Ref_To_Local'>cell1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN3423"></a>            <a href="../../include/nodes/parsenodes.h.html#LN816"><span class='Ref_to_Struct'>PartitionRangeDatum</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rdatum</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN816"><span class='Ref_to_Struct'>PartitionRangeDatum</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3364"><span class='Ref_To_Local'>cell2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN3424"></a>            <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>colname</span><span class='Delimiter'>; 
</span><a name="LN3425"></a>            <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>coltype</span><span class='Delimiter'>; 
</span><a name="LN3426"></a>            <a href="../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>coltypmod</span><span class='Delimiter'>; 
</span><a name="LN3427"></a>            <a href="../../include/nodes/parsenodes.h.html#LN284"><span class='Ref_to_Struct'>A_Const</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>con</span><span class='Delimiter'>; 
</span><a name="LN3428"></a>            <a href="../../include/nodes/primnodes.h.html#LN188"><span class='Ref_to_Struct'>Const</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>value</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Get the column's name in case we need to output an error */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3297"><span class='Ref_To_Local'>key</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN55"><span class='Ref_to_Member'>partattrs</span></a><span class='Delimiter'>[</span><a href="parse_utilcmd.c.html#LN3365"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                <a href="parse_utilcmd.c.html#LN3424"><span class='Ref_To_Local'>colname</span></a> <span class='Operator'>= </span><a href="../../include/utils/lsyscache.h.html#LN86"><span class='Ref_to_Proto'>get_relid_attribute_name</span></a><span class='Parentheses'>(</span><a href="../../include/utils/rel.h.html#LN416"><span class='Ref_to_Macro'>RelationGetRelid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3293"><span class='Ref_to_Parameter'>parent</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                                   <a href="parse_utilcmd.c.html#LN3297"><span class='Ref_To_Local'>key</span></a><span class='Operator'>-&GT;</span><a href="../../include/utils/rel.h.html#LN55"><span class='Ref_to_Member'>partattrs</span></a><span class='Delimiter'>[</span><a href="parse_utilcmd.c.html#LN3365"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <a href="parse_utilcmd.c.html#LN3424"><span class='Ref_To_Local'>colname</span></a> <span class='Operator'>= </span><a href="../../include/utils/ruleutils.h.html#LN26"><span class='Ref_to_Proto'>deparse_expression</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>)</span> <a href="../../include/nodes/pg_list.h.html#LN223"><span class='Ref_to_Proto'>list_nth</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3300"><span class='Ref_To_Local'>partexprs</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3366"><span class='Ref_To_Local'>j</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../../include/utils/ruleutils.h.html#LN28"><span class='Ref_to_Proto'>deparse_context_for</span></a><span class='Parentheses'>(</span><a href="../../include/utils/rel.h.html#LN436"><span class='Ref_to_Macro'>RelationGetRelationName</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3293"><span class='Ref_to_Parameter'>parent</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                             <a href="../../include/utils/rel.h.html#LN416"><span class='Ref_to_Macro'>RelationGetRelid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3293"><span class='Ref_to_Parameter'>parent</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, 
</span>                                             <span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Operator'>++</span><a href="parse_utilcmd.c.html#LN3366"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Comment_Multi_Line'>/* Need its type data too */ 
</span>            <a href="parse_utilcmd.c.html#LN3425"><span class='Ref_To_Local'>coltype</span></a> <span class='Operator'>= </span><a href="../../include/utils/rel.h.html#LN616"><span class='Ref_to_Func'>get_partition_col_typid</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3297"><span class='Ref_To_Local'>key</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3365"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN3426"><span class='Ref_To_Local'>coltypmod</span></a> <span class='Operator'>= </span><a href="../../include/utils/rel.h.html#LN622"><span class='Ref_to_Func'>get_partition_col_typmod</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3297"><span class='Ref_To_Local'>key</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3365"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3422"><span class='Ref_To_Local'>ldatum</span></a><span class='Operator'>-&GT;</span><span class='Keyword'>value</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="parse_utilcmd.c.html#LN3427"><span class='Ref_To_Local'>con</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN575"><span class='Ref_to_Macro'>castNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN284"><span class='Ref_to_Struct'>A_Const</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3422"><span class='Ref_To_Local'>ldatum</span></a><span class='Operator'>-&GT;</span><span class='Keyword'>value</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Keyword'>value </span><span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN137"><span class='Ref_to_Proto'>transformPartitionBoundValue</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3293"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3427"><span class='Ref_To_Local'>con</span></a><span class='Delimiter'>, 
</span>                                                     <a href="parse_utilcmd.c.html#LN3424"><span class='Ref_To_Local'>colname</span></a><span class='Delimiter'>, 
</span>                                                     <a href="parse_utilcmd.c.html#LN3425"><span class='Ref_To_Local'>coltype</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3426"><span class='Ref_To_Local'>coltypmod</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN196"><span class='Ref_to_Member'>constisnull</span></a><span class='Parentheses'>) 
</span>                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot specify NULL in range bound"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN3422"><span class='Ref_To_Local'>ldatum</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN618"><span class='Ref_to_Macro'>copyObject</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3422"><span class='Ref_To_Local'>ldatum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* don't scribble on input */ 
</span>                <a href="parse_utilcmd.c.html#LN3422"><span class='Ref_To_Local'>ldatum</span></a><span class='Operator'>-&GT;</span><span class='Keyword'>value </span><span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Keyword'>value</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3423"><span class='Ref_To_Local'>rdatum</span></a><span class='Operator'>-&GT;</span><span class='Keyword'>value</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="parse_utilcmd.c.html#LN3427"><span class='Ref_To_Local'>con</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN575"><span class='Ref_to_Macro'>castNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN284"><span class='Ref_to_Struct'>A_Const</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3423"><span class='Ref_To_Local'>rdatum</span></a><span class='Operator'>-&GT;</span><span class='Keyword'>value</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Keyword'>value </span><span class='Operator'>= </span><a href="parse_utilcmd.c.html#LN137"><span class='Ref_to_Proto'>transformPartitionBoundValue</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3293"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3427"><span class='Ref_To_Local'>con</span></a><span class='Delimiter'>, 
</span>                                                     <a href="parse_utilcmd.c.html#LN3424"><span class='Ref_To_Local'>colname</span></a><span class='Delimiter'>, 
</span>                                                     <a href="parse_utilcmd.c.html#LN3425"><span class='Ref_To_Local'>coltype</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3426"><span class='Ref_To_Local'>coltypmod</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN196"><span class='Ref_to_Member'>constisnull</span></a><span class='Parentheses'>) 
</span>                    <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_OBJECT_DEFINITION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                             <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot specify NULL in range bound"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <a href="parse_utilcmd.c.html#LN3423"><span class='Ref_To_Local'>rdatum</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN618"><span class='Ref_to_Macro'>copyObject</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3423"><span class='Ref_To_Local'>rdatum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* don't scribble on input */ 
</span>                <a href="parse_utilcmd.c.html#LN3423"><span class='Ref_To_Local'>rdatum</span></a><span class='Operator'>-&GT;</span><span class='Keyword'>value </span><span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Keyword'>value</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <a href="parse_utilcmd.c.html#LN3296"><span class='Ref_To_Local'>result_spec</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN805"><span class='Ref_to_Member'>lowerdatums</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3296"><span class='Ref_To_Local'>result_spec</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN805"><span class='Ref_to_Member'>lowerdatums</span></a><span class='Delimiter'>, 
</span>                                               <a href="parse_utilcmd.c.html#LN3422"><span class='Ref_To_Local'>ldatum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse_utilcmd.c.html#LN3296"><span class='Ref_To_Local'>result_spec</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN806"><span class='Ref_to_Member'>upperdatums</span></a> <span class='Operator'>= </span><a href="../nodes/list.c.html#LN126"><span class='Ref_to_Func'>lappend</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3296"><span class='Ref_To_Local'>result_spec</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN806"><span class='Ref_to_Member'>upperdatums</span></a><span class='Delimiter'>, 
</span>                                               <a href="parse_utilcmd.c.html#LN3423"><span class='Ref_To_Local'>rdatum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Operator'>++</span><a href="parse_utilcmd.c.html#LN3365"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if strategy==PARTITION_S... &raquo; </span> 
    <span class='Control'>else</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unexpected partition strategy: %d"</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="parse_utilcmd.c.html#LN3298"><span class='Ref_To_Local'>strategy</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="parse_utilcmd.c.html#LN3296"><span class='Ref_To_Local'>result_spec</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end transformPartitionBound &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Transform one constant in a partition bound spec 
 */ 
</span><span class='Keyword'>static </span><a href="../../include/nodes/primnodes.h.html#LN188"><span class='Ref_to_Struct'>Const</span></a> <span class='Operator'>* 
</span><a name="LN3492"></a><span class='Declare_Function'>transformPartitionBoundValue</span><span class='Parentheses'>(</span><a href="../../include/parser/parse_node.h.html#LN164"><span class='Ref_to_Struct'>ParseState</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN284"><span class='Ref_to_Struct'>A_Const</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>con</span><span class='Delimiter'>, 
</span><a name="LN3493"></a>                           <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>colName</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>colType</span><span class='Delimiter'>, </span><a href="../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Declare_Parameter'>colTypmod</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3495"></a>    <a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>value</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Make it into a Const */ 
</span>    <span class='Keyword'>value </span><span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/parser/parse_node.h.html#LN275"><span class='Ref_to_Proto'>make_const</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3492"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="parse_utilcmd.c.html#LN3492"><span class='Ref_to_Parameter'>con</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN287"><span class='Ref_to_Member'>val</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3492"><span class='Ref_to_Parameter'>con</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN288"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Coerce to correct type */ 
</span>    <span class='Keyword'>value </span><span class='Operator'>= </span><a href="../../include/parser/parse_coerce.h.html#LN37"><span class='Ref_to_Proto'>coerce_to_target_type</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3492"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, 
</span>                                  <span class='Keyword'>value</span><span class='Delimiter'>, </span><a href="../../include/nodes/nodeFuncs.h.html#LN31"><span class='Ref_to_Proto'>exprType</span></a><span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                  <a href="parse_utilcmd.c.html#LN3493"><span class='Ref_to_Parameter'>colType</span></a><span class='Delimiter'>, 
</span>                                  <a href="parse_utilcmd.c.html#LN3493"><span class='Ref_to_Parameter'>colTypmod</span></a><span class='Delimiter'>, 
</span>                                  <a href="../../include/nodes/primnodes.h.html#LN421"><span class='Ref_to_EnumConst'>COERCION_ASSIGNMENT</span></a><span class='Delimiter'>, 
</span>                                  <a href="../../include/nodes/primnodes.h.html#LN438"><span class='Ref_to_EnumConst'>COERCE_IMPLICIT_CAST</span></a><span class='Delimiter'>, 
</span>                                  <span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>value </span><span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATATYPE_MISMATCH<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>        <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"specified value cannot be cast to type %s for column \"%s\""</span><span class='Delimiter'>, 
</span>               <a href="../utils/adt/format_type.c.html#LN92"><span class='Ref_to_Func'>format_type_be</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3493"><span class='Ref_to_Parameter'>colType</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3493"><span class='Ref_to_Parameter'>colName</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3492"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3492"><span class='Ref_to_Parameter'>con</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN288"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Simplify the expression, in case we had a coercion */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN188"><span class='Ref_to_Struct'>Const</span></a><span class='Parentheses'>))</span> 
        <span class='Keyword'>value </span><span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/optimizer/planner.h.html#LN53"><span class='Ref_to_Proto'>expression_planner</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/primnodes.h.html#LN131"><span class='Ref_to_Struct'>Expr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Keyword'>value</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Fail if we don't have a constant (i.e., non-immutable coercion) */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN188"><span class='Ref_to_Struct'>Const</span></a><span class='Parentheses'>))</span> 
        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATATYPE_MISMATCH<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>        <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"specified value cannot be cast to type %s for column \"%s\""</span><span class='Delimiter'>, 
</span>               <a href="../utils/adt/format_type.c.html#LN92"><span class='Ref_to_Func'>format_type_be</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3493"><span class='Ref_to_Parameter'>colType</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3493"><span class='Ref_to_Parameter'>colName</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN871"><span class='Ref_to_Func'>errdetail</span></a><span class='Parentheses'>(</span><span class='String'>"The cast requires a non-immutable conversion."</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN985"><span class='Ref_to_Func'>errhint</span></a><span class='Parentheses'>(</span><span class='String'>"Try putting the literal value in single quotes."</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../../pl/plpgsql/src/pl_gram.y.html#LN55"><span class='Ref_to_Macro'>parser_errposition</span></a><span class='Parentheses'>(</span><a href="parse_utilcmd.c.html#LN3492"><span class='Ref_to_Parameter'>pstate</span></a><span class='Delimiter'>, </span><a href="parse_utilcmd.c.html#LN3492"><span class='Ref_to_Parameter'>con</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN288"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN188"><span class='Ref_to_Struct'>Const</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Keyword'>value</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end transformPartitionBoundValue &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>