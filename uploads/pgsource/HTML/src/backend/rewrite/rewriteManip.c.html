<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\backend\rewrite\rewriteManip.c</title>
<LINK REL=StyleSheet HREF="../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\backend\rewrite\rewriteManip.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:47 2017
</td></tr>
<tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * rewriteManip.c 
 * 
 * Portions Copyright (c) 1996-2017, PostgreSQL Global Development Group 
 * Portions Copyright (c) 1994, Regents of the University of California 
 * 
 * 
 * IDENTIFICATION 
 *    src/backend/rewrite/rewriteManip.c 
 * 
 *------------------------------------------------------------------------- 
 */ 
</span><span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_type.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"nodes/makefuncs.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"nodes/nodeFuncs.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"nodes/plannodes.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"optimizer/clauses.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parse_coerce.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parse_relation.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/parsetree.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"rewrite/rewriteManip.h"</span> 
 
 
<span class='Control'>typedef</span> <span class='Control'>struct</span> 
<span class='Delimiter'>{ 
</span><a name="LN28"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>sublevels_up</span><span class='Delimiter'>; 
</span><a name="LN29"></a>} <span class='Declare_Typedef'>contain_aggs_of_level_context</span><span class='Delimiter'>; 
</span> 
<span class='Control'>typedef</span> <span class='Control'>struct</span> 
<span class='Delimiter'>{ 
</span><a name="LN33"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>agg_location</span><span class='Delimiter'>; 
</span><a name="LN34"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>sublevels_up</span><span class='Delimiter'>; 
</span><a name="LN35"></a>} <span class='Declare_Typedef'>locate_agg_of_level_context</span><span class='Delimiter'>; 
</span> 
<span class='Control'>typedef</span> <span class='Control'>struct</span> 
<span class='Delimiter'>{ 
</span><a name="LN39"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>win_location</span><span class='Delimiter'>; 
</span><a name="LN40"></a>} <span class='Declare_Typedef'>locate_windowfunc_context</span><span class='Delimiter'>; 
</span> 
<a name="LN42"></a><span class='Keyword'>static bool </span><span class='Declare_Prototype'>contain_aggs_of_level_walker</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, 
</span><a name="LN43"></a>                             <a href="rewriteManip.c.html#LN26"><span class='Ref_to_Typedef'>contain_aggs_of_level_context</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN44"></a><span class='Keyword'>static bool </span><span class='Declare_Prototype'>locate_agg_of_level_walker</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, 
</span><a name="LN45"></a>                           <a href="rewriteManip.c.html#LN31"><span class='Ref_to_Typedef'>locate_agg_of_level_context</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN46"></a><span class='Keyword'>static bool </span><span class='Declare_Prototype'>contain_windowfuncs_walker</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, </span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN47"></a><span class='Keyword'>static bool </span><span class='Declare_Prototype'>locate_windowfunc_walker</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, 
</span><a name="LN48"></a>                         <a href="rewriteManip.c.html#LN37"><span class='Ref_to_Typedef'>locate_windowfunc_context</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN49"></a><span class='Keyword'>static bool </span><span class='Declare_Prototype'>checkExprHasSubLink_walker</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, </span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN50"></a><span class='Keyword'>static </span><a href="../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a> <span class='Declare_Prototype'>offset_relid_set</span><span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a> <span class='Declare_Parameter'>relids</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>offset</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN51"></a><span class='Keyword'>static </span><a href="../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a> <span class='Declare_Prototype'>adjust_relid_set</span><span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a> <span class='Declare_Parameter'>relids</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>oldrelid</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>newrelid</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * contain_aggs_of_level - 
 *  Check if an expression contains an aggregate function call of a 
 *  specified query level. 
 * 
 * The objective of this routine is to detect whether there are aggregates 
 * belonging to the given query level.  Aggregates belonging to subqueries 
 * or outer queries do NOT cause a true result.  We must recurse into 
 * subqueries to detect outer-reference aggregates that logically belong to 
 * the specified query level. 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN66"></a><span class='Declare_Function'>contain_aggs_of_level</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>levelsup</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN68"></a>    <a href="rewriteManip.c.html#LN26"><span class='Ref_to_Typedef'>contain_aggs_of_level_context</span></a> <span class='Declare_Local'>context</span><span class='Delimiter'>; 
</span> 
    <a href="rewriteManip.c.html#LN68"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN28"><span class='Ref_to_Member'>sublevels_up</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN66"><span class='Ref_to_Parameter'>levelsup</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Must be prepared to start with a Query or a bare expression tree; if 
     * it's a Query, we don't want to increment sublevels_up. 
     */ 
</span>    <span class='Control'>return</span> <a href="../../include/nodes/nodeFuncs.h.html#LN67"><span class='Ref_to_Proto'>query_or_expression_tree_walker</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN66"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, 
</span>                                           <a href="rewriteManip.c.html#LN42"><span class='Ref_to_Proto'>contain_aggs_of_level_walker</span></a><span class='Delimiter'>, 
</span>                                           <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="rewriteManip.c.html#LN68"><span class='Ref_To_Local'>context</span></a><span class='Delimiter'>, 
</span>                                           <span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static bool 
</span><a name="LN83"></a><span class='Declare_Function'>contain_aggs_of_level_walker</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, 
</span><a name="LN84"></a>                             <a href="rewriteManip.c.html#LN26"><span class='Ref_to_Typedef'>contain_aggs_of_level_context</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN83"><span class='Ref_to_Parameter'>node</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN83"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN290"><span class='Ref_to_Struct'>Aggref</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(((</span><a href="../../include/nodes/primnodes.h.html#LN290"><span class='Ref_to_Struct'>Aggref</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN83"><span class='Ref_to_Parameter'>node</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>agglevelsup <span class='Operator'>== </span><a href="rewriteManip.c.html#LN84"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN28"><span class='Ref_to_Member'>sublevels_up</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* abort the tree traversal and return true */ 
</span>        <span class='Comment_Multi_Line'>/* else fall through to examine argument */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN83"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN337"><span class='Ref_to_Struct'>GroupingFunc</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(((</span><a href="../../include/nodes/primnodes.h.html#LN337"><span class='Ref_to_Struct'>GroupingFunc</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN83"><span class='Ref_to_Parameter'>node</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>agglevelsup <span class='Operator'>== </span><a href="rewriteManip.c.html#LN84"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN28"><span class='Ref_to_Member'>sublevels_up</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* else fall through to examine argument */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN83"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Recurse into subselects */ 
</span><a name="LN103"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
        <a href="rewriteManip.c.html#LN84"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN28"><span class='Ref_to_Member'>sublevels_up</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN103"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodeFuncs.h.html#LN57"><span class='Ref_to_Proto'>query_tree_walker</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN83"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, 
</span>                                   <a href="rewriteManip.c.html#LN42"><span class='Ref_to_Proto'>contain_aggs_of_level_walker</span></a><span class='Delimiter'>, 
</span>                                   <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN84"><span class='Ref_to_Parameter'>context</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN84"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN28"><span class='Ref_to_Member'>sublevels_up</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="rewriteManip.c.html#LN103"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="../../include/nodes/nodeFuncs.h.html#LN52"><span class='Ref_to_Proto'>expression_tree_walker</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN83"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN42"><span class='Ref_to_Proto'>contain_aggs_of_level_walker</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN84"><span class='Ref_to_Parameter'>context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end contain_aggs_of_level_walker &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * locate_agg_of_level - 
 *    Find the parse location of any aggregate of the specified query level. 
 * 
 * Returns -1 if no such agg is in the querytree, or if they all have 
 * unknown parse location.  (The former case is probably caller error, 
 * but we don't bother to distinguish it from the latter case.) 
 * 
 * Note: it might seem appropriate to merge this functionality into 
 * contain_aggs_of_level, but that would complicate that function's API. 
 * Currently, the only uses of this function are for error reporting, 
 * and so shaving cycles probably isn't very important. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN130"></a><span class='Declare_Function'>locate_agg_of_level</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>levelsup</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN132"></a>    <a href="rewriteManip.c.html#LN31"><span class='Ref_to_Typedef'>locate_agg_of_level_context</span></a> <span class='Declare_Local'>context</span><span class='Delimiter'>; 
</span> 
    <a href="rewriteManip.c.html#LN132"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN33"><span class='Ref_to_Member'>agg_location</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>;</span>  <span class='Comment_Single_Line'>/* in case we find nothing */ 
</span>    <a href="rewriteManip.c.html#LN132"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN34"><span class='Ref_to_Member'>sublevels_up</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN130"><span class='Ref_to_Parameter'>levelsup</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Must be prepared to start with a Query or a bare expression tree; if 
     * it's a Query, we don't want to increment sublevels_up. 
     */ 
</span>    <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="../../include/nodes/nodeFuncs.h.html#LN67"><span class='Ref_to_Proto'>query_or_expression_tree_walker</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN130"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, 
</span>                                           <a href="rewriteManip.c.html#LN44"><span class='Ref_to_Proto'>locate_agg_of_level_walker</span></a><span class='Delimiter'>, 
</span>                                           <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="rewriteManip.c.html#LN132"><span class='Ref_To_Local'>context</span></a><span class='Delimiter'>, 
</span>                                           <span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="rewriteManip.c.html#LN132"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN33"><span class='Ref_to_Member'>agg_location</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static bool 
</span><a name="LN150"></a><span class='Declare_Function'>locate_agg_of_level_walker</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, 
</span><a name="LN151"></a>                           <a href="rewriteManip.c.html#LN31"><span class='Ref_to_Typedef'>locate_agg_of_level_context</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN150"><span class='Ref_to_Parameter'>node</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN150"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN290"><span class='Ref_to_Struct'>Aggref</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(((</span><a href="../../include/nodes/primnodes.h.html#LN290"><span class='Ref_to_Struct'>Aggref</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN150"><span class='Ref_to_Parameter'>node</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>agglevelsup <span class='Operator'>== </span><a href="rewriteManip.c.html#LN151"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN34"><span class='Ref_to_Member'>sublevels_up</span></a> <span class='Operator'>&& 
</span>            <span class='Parentheses'>((</span><a href="../../include/nodes/primnodes.h.html#LN290"><span class='Ref_to_Struct'>Aggref</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN150"><span class='Ref_to_Parameter'>node</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>location <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="rewriteManip.c.html#LN151"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN33"><span class='Ref_to_Member'>agg_location</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="../../include/nodes/primnodes.h.html#LN290"><span class='Ref_to_Struct'>Aggref</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN150"><span class='Ref_to_Parameter'>node</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>location<span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* abort the tree traversal and return true */ 
</span>        <span class='Delimiter'>} 
</span>        <span class='Comment_Multi_Line'>/* else fall through to examine argument */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN150"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN337"><span class='Ref_to_Struct'>GroupingFunc</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(((</span><a href="../../include/nodes/primnodes.h.html#LN337"><span class='Ref_to_Struct'>GroupingFunc</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN150"><span class='Ref_to_Parameter'>node</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>agglevelsup <span class='Operator'>== </span><a href="rewriteManip.c.html#LN151"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN34"><span class='Ref_to_Member'>sublevels_up</span></a> <span class='Operator'>&& 
</span>            <span class='Parentheses'>((</span><a href="../../include/nodes/primnodes.h.html#LN337"><span class='Ref_to_Struct'>GroupingFunc</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN150"><span class='Ref_to_Parameter'>node</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>location <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="rewriteManip.c.html#LN151"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN33"><span class='Ref_to_Member'>agg_location</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="../../include/nodes/primnodes.h.html#LN337"><span class='Ref_to_Struct'>GroupingFunc</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN150"><span class='Ref_to_Parameter'>node</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>location<span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* abort the tree traversal and return true */ 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN150"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Recurse into subselects */ 
</span><a name="LN177"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
        <a href="rewriteManip.c.html#LN151"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN34"><span class='Ref_to_Member'>sublevels_up</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN177"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodeFuncs.h.html#LN57"><span class='Ref_to_Proto'>query_tree_walker</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN150"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, 
</span>                                   <a href="rewriteManip.c.html#LN44"><span class='Ref_to_Proto'>locate_agg_of_level_walker</span></a><span class='Delimiter'>, 
</span>                                   <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN151"><span class='Ref_to_Parameter'>context</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN151"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN34"><span class='Ref_to_Member'>sublevels_up</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="rewriteManip.c.html#LN177"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="../../include/nodes/nodeFuncs.h.html#LN52"><span class='Ref_to_Proto'>expression_tree_walker</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN150"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN44"><span class='Ref_to_Proto'>locate_agg_of_level_walker</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN151"><span class='Ref_to_Parameter'>context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end locate_agg_of_level_walker &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * contain_windowfuncs - 
 *  Check if an expression contains a window function call of the 
 *  current query level. 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN196"></a><span class='Declare_Function'>contain_windowfuncs</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* 
     * Must be prepared to start with a Query or a bare expression tree; if 
     * it's a Query, we don't want to increment sublevels_up. 
     */ 
</span>    <span class='Control'>return</span> <a href="../../include/nodes/nodeFuncs.h.html#LN67"><span class='Ref_to_Proto'>query_or_expression_tree_walker</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN196"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, 
</span>                                           <a href="rewriteManip.c.html#LN46"><span class='Ref_to_Proto'>contain_windowfuncs_walker</span></a><span class='Delimiter'>, 
</span>                                           <span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                                           <span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static bool 
</span><a name="LN209"></a><span class='Declare_Function'>contain_windowfuncs_walker</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, </span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN209"><span class='Ref_to_Parameter'>node</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN209"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN351"><span class='Ref_to_Struct'>WindowFunc</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>;</span>            <span class='Comment_Single_Line'>/* abort the tree traversal and return true */ 
</span>    <span class='Comment_Multi_Line'>/* Mustn't recurse into subselects */ 
</span>    <span class='Control'>return</span> <a href="../../include/nodes/nodeFuncs.h.html#LN52"><span class='Ref_to_Proto'>expression_tree_walker</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN209"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN46"><span class='Ref_to_Proto'>contain_windowfuncs_walker</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN209"><span class='Ref_to_Parameter'>context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * locate_windowfunc - 
 *    Find the parse location of any windowfunc of the current query level. 
 * 
 * Returns -1 if no such windowfunc is in the querytree, or if they all have 
 * unknown parse location.  (The former case is probably caller error, 
 * but we don't bother to distinguish it from the latter case.) 
 * 
 * Note: it might seem appropriate to merge this functionality into 
 * contain_windowfuncs, but that would complicate that function's API. 
 * Currently, the only uses of this function are for error reporting, 
 * and so shaving cycles probably isn't very important. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN234"></a><span class='Declare_Function'>locate_windowfunc</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN236"></a>    <a href="rewriteManip.c.html#LN37"><span class='Ref_to_Typedef'>locate_windowfunc_context</span></a> <span class='Declare_Local'>context</span><span class='Delimiter'>; 
</span> 
    <a href="rewriteManip.c.html#LN236"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN39"><span class='Ref_to_Member'>win_location</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>;</span>  <span class='Comment_Single_Line'>/* in case we find nothing */ 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Must be prepared to start with a Query or a bare expression tree; if 
     * it's a Query, we don't want to increment sublevels_up. 
     */ 
</span>    <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="../../include/nodes/nodeFuncs.h.html#LN67"><span class='Ref_to_Proto'>query_or_expression_tree_walker</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN234"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, 
</span>                                           <a href="rewriteManip.c.html#LN47"><span class='Ref_to_Proto'>locate_windowfunc_walker</span></a><span class='Delimiter'>, 
</span>                                           <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="rewriteManip.c.html#LN236"><span class='Ref_To_Local'>context</span></a><span class='Delimiter'>, 
</span>                                           <span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="rewriteManip.c.html#LN236"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN39"><span class='Ref_to_Member'>win_location</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static bool 
</span><a name="LN253"></a><span class='Declare_Function'>locate_windowfunc_walker</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN37"><span class='Ref_to_Typedef'>locate_windowfunc_context</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN253"><span class='Ref_to_Parameter'>node</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN253"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN351"><span class='Ref_to_Struct'>WindowFunc</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(((</span><a href="../../include/nodes/primnodes.h.html#LN351"><span class='Ref_to_Struct'>WindowFunc</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN253"><span class='Ref_to_Parameter'>node</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>location <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="rewriteManip.c.html#LN253"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN39"><span class='Ref_to_Member'>win_location</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="../../include/nodes/primnodes.h.html#LN351"><span class='Ref_to_Struct'>WindowFunc</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN253"><span class='Ref_to_Parameter'>node</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>location<span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* abort the tree traversal and return true */ 
</span>        <span class='Delimiter'>} 
</span>        <span class='Comment_Multi_Line'>/* else fall through to examine argument */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* Mustn't recurse into subselects */ 
</span>    <span class='Control'>return</span> <a href="../../include/nodes/nodeFuncs.h.html#LN52"><span class='Ref_to_Proto'>expression_tree_walker</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN253"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN47"><span class='Ref_to_Proto'>locate_windowfunc_walker</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN253"><span class='Ref_to_Parameter'>context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * checkExprHasSubLink - 
 *  Check if an expression contains a SubLink. 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN276"></a><span class='Declare_Function'>checkExprHasSubLink</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* 
     * If a Query is passed, examine it --- but we should not recurse into 
     * sub-Queries that are in its rangetable or CTE list. 
     */ 
</span>    <span class='Control'>return</span> <a href="../../include/nodes/nodeFuncs.h.html#LN67"><span class='Ref_to_Proto'>query_or_expression_tree_walker</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN276"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, 
</span>                                           <a href="rewriteManip.c.html#LN49"><span class='Ref_to_Proto'>checkExprHasSubLink_walker</span></a><span class='Delimiter'>, 
</span>                                           <span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                                           <a href="../../include/nodes/nodeFuncs.h.html#LN21"><span class='Ref_to_Const'>QTW_IGNORE_RC_SUBQUERIES</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static bool 
</span><a name="LN289"></a><span class='Declare_Function'>checkExprHasSubLink_walker</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, </span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN289"><span class='Ref_to_Parameter'>node</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN289"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN629"><span class='Ref_to_Struct'>SubLink</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>;</span>            <span class='Comment_Single_Line'>/* abort the tree traversal and return true */ 
</span>    <span class='Control'>return</span> <a href="../../include/nodes/nodeFuncs.h.html#LN52"><span class='Ref_to_Proto'>expression_tree_walker</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN289"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN49"><span class='Ref_to_Proto'>checkExprHasSubLink_walker</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN289"><span class='Ref_to_Parameter'>context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Check for MULTIEXPR Param within expression tree 
 * 
 * We intentionally don't descend into SubLinks: only Params at the current 
 * query level are of interest. 
 */ 
</span><span class='Keyword'>static bool 
</span><a name="LN305"></a><span class='Declare_Function'>contains_multiexpr_param</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, </span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN305"><span class='Ref_to_Parameter'>node</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN305"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN240"><span class='Ref_to_Struct'>Param</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(((</span><a href="../../include/nodes/primnodes.h.html#LN240"><span class='Ref_to_Struct'>Param</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN305"><span class='Ref_to_Parameter'>node</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>paramkind <span class='Operator'>== </span><a href="../../include/nodes/primnodes.h.html#LN237"><span class='Ref_to_EnumConst'>PARAM_MULTIEXPR</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* abort the tree traversal and return true */ 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="../../include/nodes/nodeFuncs.h.html#LN52"><span class='Ref_to_Proto'>expression_tree_walker</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN305"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN304"><span class='Ref_to_Func'>contains_multiexpr_param</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN305"><span class='Ref_to_Parameter'>context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * OffsetVarNodes - adjust Vars when appending one query's RT to another 
 * 
 * Find all Var nodes in the given tree with varlevelsup == sublevels_up, 
 * and increment their varno fields (rangetable indexes) by 'offset'. 
 * The varnoold fields are adjusted similarly.  Also, adjust other nodes 
 * that contain rangetable indexes, such as RangeTblRef and JoinExpr. 
 * 
 * NOTE: although this has the form of a walker, we cheat and modify the 
 * nodes in-place.  The given expression tree should have been copied 
 * earlier to ensure that no unwanted side-effects occur! 
 */ 
</span> 
<span class='Control'>typedef</span> <span class='Control'>struct</span> 
<span class='Delimiter'>{ 
</span><a name="LN334"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>offset</span><span class='Delimiter'>; 
</span><a name="LN335"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>sublevels_up</span><span class='Delimiter'>; 
</span><a name="LN336"></a>} <span class='Declare_Typedef'>OffsetVarNodes_context</span><span class='Delimiter'>; 
</span> 
<span class='Keyword'>static bool 
</span><a name="LN339"></a><span class='Declare_Function'>OffsetVarNodes_walker</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN332"><span class='Ref_to_Typedef'>OffsetVarNodes_context</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>node</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN345"></a>        <a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>var</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN345"><span class='Ref_To_Local'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN172"><span class='Ref_to_Member'>varlevelsup</span></a> <span class='Operator'>== </span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN335"><span class='Ref_to_Member'>sublevels_up</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="rewriteManip.c.html#LN345"><span class='Ref_To_Local'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN165"><span class='Ref_to_Member'>varno</span></a> <span class='Operator'>+= </span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN334"><span class='Ref_to_Member'>offset</span></a><span class='Delimiter'>; 
</span>            <a href="rewriteManip.c.html#LN345"><span class='Ref_To_Local'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN175"><span class='Ref_to_Member'>varnoold</span></a> <span class='Operator'>+= </span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN334"><span class='Ref_to_Member'>offset</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN1272"><span class='Ref_to_Struct'>CurrentOfExpr</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN356"></a>        <a href="../../include/nodes/primnodes.h.html#LN1272"><span class='Ref_to_Struct'>CurrentOfExpr</span></a> <span class='Operator'>*</span><span class='Declare_Local'>cexpr</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN1272"><span class='Ref_to_Struct'>CurrentOfExpr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN335"><span class='Ref_to_Member'>sublevels_up</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="rewriteManip.c.html#LN356"><span class='Ref_To_Local'>cexpr</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1275"><span class='Ref_to_Member'>cvarno</span></a> <span class='Operator'>+= </span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN334"><span class='Ref_to_Member'>offset</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN1415"><span class='Ref_to_Struct'>RangeTblRef</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN364"></a>        <a href="../../include/nodes/primnodes.h.html#LN1415"><span class='Ref_to_Struct'>RangeTblRef</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rtr</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN1415"><span class='Ref_to_Struct'>RangeTblRef</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN335"><span class='Ref_to_Member'>sublevels_up</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="rewriteManip.c.html#LN364"><span class='Ref_To_Local'>rtr</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1418"><span class='Ref_to_Member'>rtindex</span></a> <span class='Operator'>+= </span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN334"><span class='Ref_to_Member'>offset</span></a><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* the subquery itself is visited separately */ 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN1444"><span class='Ref_to_Struct'>JoinExpr</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN373"></a>        <a href="../../include/nodes/primnodes.h.html#LN1444"><span class='Ref_to_Struct'>JoinExpr</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>j</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN1444"><span class='Ref_to_Struct'>JoinExpr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN373"><span class='Ref_To_Local'>j</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1454"><span class='Ref_to_Member'>rtindex</span></a> <span class='Operator'>&& </span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN335"><span class='Ref_to_Member'>sublevels_up</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="rewriteManip.c.html#LN373"><span class='Ref_To_Local'>j</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1454"><span class='Ref_to_Member'>rtindex</span></a> <span class='Operator'>+= </span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN334"><span class='Ref_to_Member'>offset</span></a><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* fall through to examine children */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/relation.h.html#LN1846"><span class='Ref_to_Struct'>PlaceHolderVar</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN381"></a>        <a href="../../include/nodes/relation.h.html#LN1846"><span class='Ref_to_Struct'>PlaceHolderVar</span></a> <span class='Operator'>*</span><span class='Declare_Local'>phv</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN1846"><span class='Ref_to_Struct'>PlaceHolderVar</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN381"><span class='Ref_To_Local'>phv</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN1852"><span class='Ref_to_Member'>phlevelsup</span></a> <span class='Operator'>== </span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN335"><span class='Ref_to_Member'>sublevels_up</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="rewriteManip.c.html#LN381"><span class='Ref_To_Local'>phv</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN1850"><span class='Ref_to_Member'>phrels</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN50"><span class='Ref_to_Proto'>offset_relid_set</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN381"><span class='Ref_To_Local'>phv</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN1850"><span class='Ref_to_Member'>phrels</span></a><span class='Delimiter'>, 
</span>                                           <a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN334"><span class='Ref_to_Member'>offset</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Comment_Multi_Line'>/* fall through to examine children */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/relation.h.html#LN1964"><span class='Ref_to_Struct'>AppendRelInfo</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN392"></a>        <a href="../../include/nodes/relation.h.html#LN1964"><span class='Ref_to_Struct'>AppendRelInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>appinfo</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN1964"><span class='Ref_to_Struct'>AppendRelInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN335"><span class='Ref_to_Member'>sublevels_up</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="rewriteManip.c.html#LN392"><span class='Ref_To_Local'>appinfo</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN1974"><span class='Ref_to_Member'>parent_relid</span></a> <span class='Operator'>+= </span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN334"><span class='Ref_to_Member'>offset</span></a><span class='Delimiter'>; 
</span>            <a href="rewriteManip.c.html#LN392"><span class='Ref_To_Local'>appinfo</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN1975"><span class='Ref_to_Member'>child_relid</span></a> <span class='Operator'>+= </span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN334"><span class='Ref_to_Member'>offset</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Comment_Multi_Line'>/* fall through to examine children */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* Shouldn't need to handle other planner auxiliary nodes here */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/plannodes.h.html#LN1002"><span class='Ref_to_Struct'>PlanRowMark</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/relation.h.html#LN1913"><span class='Ref_to_Struct'>SpecialJoinInfo</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/relation.h.html#LN2057"><span class='Ref_to_Struct'>PlaceHolderInfo</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/relation.h.html#LN2074"><span class='Ref_to_Struct'>MinMaxAggInfo</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Recurse into subselects */ 
</span><a name="LN410"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
        <a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN335"><span class='Ref_to_Member'>sublevels_up</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN410"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodeFuncs.h.html#LN57"><span class='Ref_to_Proto'>query_tree_walker</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN338"><span class='Ref_to_Func'>OffsetVarNodes_walker</span></a><span class='Delimiter'>, 
</span>                                   <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>context</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN335"><span class='Ref_to_Member'>sublevels_up</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="rewriteManip.c.html#LN410"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="../../include/nodes/nodeFuncs.h.html#LN52"><span class='Ref_to_Proto'>expression_tree_walker</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN338"><span class='Ref_to_Func'>OffsetVarNodes_walker</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN339"><span class='Ref_to_Parameter'>context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end OffsetVarNodes_walker &raquo; </span> 
 
<span class='Keyword'>void 
</span><a name="LN423"></a><span class='Declare_Function'>OffsetVarNodes</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>offset</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>sublevels_up</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN425"></a>    <a href="rewriteManip.c.html#LN332"><span class='Ref_to_Typedef'>OffsetVarNodes_context</span></a> <span class='Declare_Local'>context</span><span class='Delimiter'>; 
</span> 
    <a href="rewriteManip.c.html#LN425"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN334"><span class='Ref_to_Member'>offset</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN423"><span class='Ref_to_Parameter'>offset</span></a><span class='Delimiter'>; 
</span>    <a href="rewriteManip.c.html#LN425"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN335"><span class='Ref_to_Member'>sublevels_up</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN423"><span class='Ref_to_Parameter'>sublevels_up</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Must be prepared to start with a Query or a bare expression tree; if 
     * it's a Query, go straight to query_tree_walker to make sure that 
     * sublevels_up doesn't get incremented prematurely. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN423"><span class='Ref_to_Parameter'>node</span></a> <span class='Operator'>&& </span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN423"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN437"></a>        <a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>qry</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN423"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If we are starting at a Query, and sublevels_up is zero, then we 
         * must also fix rangetable indexes in the Query itself --- namely 
         * resultRelation, exclRelIndex and rowMarks entries.  sublevels_up 
         * cannot be zero when recursing into a subquery, so there's no need 
         * to have the same logic inside OffsetVarNodes_walker. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN423"><span class='Ref_to_Parameter'>sublevels_up</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN448"></a>            <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN437"><span class='Ref_To_Local'>qry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN119"><span class='Ref_to_Member'>resultRelation</span></a><span class='Parentheses'>) 
</span>                <a href="rewriteManip.c.html#LN437"><span class='Ref_To_Local'>qry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN119"><span class='Ref_to_Member'>resultRelation</span></a> <span class='Operator'>+= </span><a href="rewriteManip.c.html#LN423"><span class='Ref_to_Parameter'>offset</span></a><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN437"><span class='Ref_To_Local'>qry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN141"><span class='Ref_to_Member'>onConflict</span></a> <span class='Operator'>&& </span><a href="rewriteManip.c.html#LN437"><span class='Ref_To_Local'>qry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN141"><span class='Ref_to_Member'>onConflict</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1496"><span class='Ref_to_Member'>exclRelIndex</span></a><span class='Parentheses'>) 
</span>                <a href="rewriteManip.c.html#LN437"><span class='Ref_To_Local'>qry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN141"><span class='Ref_to_Member'>onConflict</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1496"><span class='Ref_to_Member'>exclRelIndex</span></a> <span class='Operator'>+= </span><a href="rewriteManip.c.html#LN423"><span class='Ref_to_Parameter'>offset</span></a><span class='Delimiter'>; 
</span> 
            <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN448"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN437"><span class='Ref_To_Local'>qry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN160"><span class='Ref_to_Member'>rowMarks</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN458"></a>                <a href="../../include/nodes/parsenodes.h.html#LN1278"><span class='Ref_to_Struct'>RowMarkClause</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rc</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN1278"><span class='Ref_to_Struct'>RowMarkClause</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN448"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <a href="rewriteManip.c.html#LN458"><span class='Ref_To_Local'>rc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1281"><span class='Ref_to_Member'>rti</span></a> <span class='Operator'>+= </span><a href="rewriteManip.c.html#LN423"><span class='Ref_to_Parameter'>offset</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>        <a href="../../include/nodes/nodeFuncs.h.html#LN57"><span class='Ref_to_Proto'>query_tree_walker</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN437"><span class='Ref_To_Local'>qry</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN338"><span class='Ref_to_Func'>OffsetVarNodes_walker</span></a><span class='Delimiter'>, 
</span>                          <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="rewriteManip.c.html#LN425"><span class='Ref_To_Local'>context</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if node&&IsA(node,Query) &raquo; </span> 
    <span class='Control'>else</span> 
        <a href="rewriteManip.c.html#LN338"><span class='Ref_to_Func'>OffsetVarNodes_walker</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN423"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="rewriteManip.c.html#LN425"><span class='Ref_To_Local'>context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end OffsetVarNodes &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a> 
<a name="LN471"></a><span class='Declare_Function'>offset_relid_set</span><span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a> <span class='Declare_Parameter'>relids</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>offset</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN473"></a>    <a href="../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a>      <span class='Declare_Local'>result</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN474"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>rtindex</span><span class='Delimiter'>; 
</span> 
    <a href="rewriteManip.c.html#LN474"><span class='Ref_To_Local'>rtindex</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>((</span><a href="rewriteManip.c.html#LN474"><span class='Ref_To_Local'>rtindex</span></a> <span class='Operator'>= </span><a href="../../include/nodes/bitmapset.h.html#LN98"><span class='Ref_to_Proto'>bms_next_member</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN471"><span class='Ref_to_Parameter'>relids</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN474"><span class='Ref_To_Local'>rtindex</span></a><span class='Parentheses'>))</span> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="rewriteManip.c.html#LN473"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/nodes/bitmapset.h.html#LN89"><span class='Ref_to_Proto'>bms_add_member</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN473"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN474"><span class='Ref_To_Local'>rtindex</span></a> <span class='Operator'>+ </span><a href="rewriteManip.c.html#LN471"><span class='Ref_to_Parameter'>offset</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="rewriteManip.c.html#LN473"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * ChangeVarNodes - adjust Var nodes for a specific change of RT index 
 * 
 * Find all Var nodes in the given tree belonging to a specific relation 
 * (identified by sublevels_up and rt_index), and change their varno fields 
 * to 'new_index'.  The varnoold fields are changed too.  Also, adjust other 
 * nodes that contain rangetable indexes, such as RangeTblRef and JoinExpr. 
 * 
 * NOTE: although this has the form of a walker, we cheat and modify the 
 * nodes in-place.  The given expression tree should have been copied 
 * earlier to ensure that no unwanted side-effects occur! 
 */ 
</span> 
<span class='Control'>typedef</span> <span class='Control'>struct</span> 
<span class='Delimiter'>{ 
</span><a name="LN497"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>rt_index</span><span class='Delimiter'>; 
</span><a name="LN498"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>new_index</span><span class='Delimiter'>; 
</span><a name="LN499"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>sublevels_up</span><span class='Delimiter'>; 
</span><a name="LN500"></a>} <span class='Declare_Typedef'>ChangeVarNodes_context</span><span class='Delimiter'>; 
</span> 
<span class='Keyword'>static bool 
</span><a name="LN503"></a><span class='Declare_Function'>ChangeVarNodes_walker</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN495"><span class='Ref_to_Typedef'>ChangeVarNodes_context</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>node</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN509"></a>        <a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>var</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN509"><span class='Ref_To_Local'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN172"><span class='Ref_to_Member'>varlevelsup</span></a> <span class='Operator'>== </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN499"><span class='Ref_to_Member'>sublevels_up</span></a> <span class='Operator'>&& 
</span>            <a href="rewriteManip.c.html#LN509"><span class='Ref_To_Local'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN165"><span class='Ref_to_Member'>varno</span></a> <span class='Operator'>== </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN497"><span class='Ref_to_Member'>rt_index</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="rewriteManip.c.html#LN509"><span class='Ref_To_Local'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN165"><span class='Ref_to_Member'>varno</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN498"><span class='Ref_to_Member'>new_index</span></a><span class='Delimiter'>; 
</span>            <a href="rewriteManip.c.html#LN509"><span class='Ref_To_Local'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN175"><span class='Ref_to_Member'>varnoold</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN498"><span class='Ref_to_Member'>new_index</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN1272"><span class='Ref_to_Struct'>CurrentOfExpr</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN521"></a>        <a href="../../include/nodes/primnodes.h.html#LN1272"><span class='Ref_to_Struct'>CurrentOfExpr</span></a> <span class='Operator'>*</span><span class='Declare_Local'>cexpr</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN1272"><span class='Ref_to_Struct'>CurrentOfExpr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN499"><span class='Ref_to_Member'>sublevels_up</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>&& 
</span>            <a href="rewriteManip.c.html#LN521"><span class='Ref_To_Local'>cexpr</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1275"><span class='Ref_to_Member'>cvarno</span></a> <span class='Operator'>== </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN497"><span class='Ref_to_Member'>rt_index</span></a><span class='Parentheses'>) 
</span>            <a href="rewriteManip.c.html#LN521"><span class='Ref_To_Local'>cexpr</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1275"><span class='Ref_to_Member'>cvarno</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN498"><span class='Ref_to_Member'>new_index</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN1415"><span class='Ref_to_Struct'>RangeTblRef</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN530"></a>        <a href="../../include/nodes/primnodes.h.html#LN1415"><span class='Ref_to_Struct'>RangeTblRef</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rtr</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN1415"><span class='Ref_to_Struct'>RangeTblRef</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN499"><span class='Ref_to_Member'>sublevels_up</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>&& 
</span>            <a href="rewriteManip.c.html#LN530"><span class='Ref_To_Local'>rtr</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1418"><span class='Ref_to_Member'>rtindex</span></a> <span class='Operator'>== </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN497"><span class='Ref_to_Member'>rt_index</span></a><span class='Parentheses'>) 
</span>            <a href="rewriteManip.c.html#LN530"><span class='Ref_To_Local'>rtr</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1418"><span class='Ref_to_Member'>rtindex</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN498"><span class='Ref_to_Member'>new_index</span></a><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* the subquery itself is visited separately */ 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN1444"><span class='Ref_to_Struct'>JoinExpr</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN540"></a>        <a href="../../include/nodes/primnodes.h.html#LN1444"><span class='Ref_to_Struct'>JoinExpr</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>j</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN1444"><span class='Ref_to_Struct'>JoinExpr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN499"><span class='Ref_to_Member'>sublevels_up</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>&& 
</span>            <a href="rewriteManip.c.html#LN540"><span class='Ref_To_Local'>j</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1454"><span class='Ref_to_Member'>rtindex</span></a> <span class='Operator'>== </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN497"><span class='Ref_to_Member'>rt_index</span></a><span class='Parentheses'>) 
</span>            <a href="rewriteManip.c.html#LN540"><span class='Ref_To_Local'>j</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1454"><span class='Ref_to_Member'>rtindex</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN498"><span class='Ref_to_Member'>new_index</span></a><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* fall through to examine children */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/relation.h.html#LN1846"><span class='Ref_to_Struct'>PlaceHolderVar</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN549"></a>        <a href="../../include/nodes/relation.h.html#LN1846"><span class='Ref_to_Struct'>PlaceHolderVar</span></a> <span class='Operator'>*</span><span class='Declare_Local'>phv</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN1846"><span class='Ref_to_Struct'>PlaceHolderVar</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN549"><span class='Ref_To_Local'>phv</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN1852"><span class='Ref_to_Member'>phlevelsup</span></a> <span class='Operator'>== </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN499"><span class='Ref_to_Member'>sublevels_up</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="rewriteManip.c.html#LN549"><span class='Ref_To_Local'>phv</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN1850"><span class='Ref_to_Member'>phrels</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN51"><span class='Ref_to_Proto'>adjust_relid_set</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN549"><span class='Ref_To_Local'>phv</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN1850"><span class='Ref_to_Member'>phrels</span></a><span class='Delimiter'>, 
</span>                                           <a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN497"><span class='Ref_to_Member'>rt_index</span></a><span class='Delimiter'>, 
</span>                                           <a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN498"><span class='Ref_to_Member'>new_index</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Comment_Multi_Line'>/* fall through to examine children */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/plannodes.h.html#LN1002"><span class='Ref_to_Struct'>PlanRowMark</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN561"></a>        <a href="../../include/nodes/plannodes.h.html#LN1002"><span class='Ref_to_Struct'>PlanRowMark</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rowmark</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/plannodes.h.html#LN1002"><span class='Ref_to_Struct'>PlanRowMark</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN499"><span class='Ref_to_Member'>sublevels_up</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN561"><span class='Ref_To_Local'>rowmark</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/plannodes.h.html#LN1005"><span class='Ref_to_Member'>rti</span></a> <span class='Operator'>== </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN497"><span class='Ref_to_Member'>rt_index</span></a><span class='Parentheses'>) 
</span>                <a href="rewriteManip.c.html#LN561"><span class='Ref_To_Local'>rowmark</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/plannodes.h.html#LN1005"><span class='Ref_to_Member'>rti</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN498"><span class='Ref_to_Member'>new_index</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN561"><span class='Ref_To_Local'>rowmark</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/plannodes.h.html#LN1006"><span class='Ref_to_Member'>prti</span></a> <span class='Operator'>== </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN497"><span class='Ref_to_Member'>rt_index</span></a><span class='Parentheses'>) 
</span>                <a href="rewriteManip.c.html#LN561"><span class='Ref_To_Local'>rowmark</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/plannodes.h.html#LN1006"><span class='Ref_to_Member'>prti</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN498"><span class='Ref_to_Member'>new_index</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/relation.h.html#LN1964"><span class='Ref_to_Struct'>AppendRelInfo</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN574"></a>        <a href="../../include/nodes/relation.h.html#LN1964"><span class='Ref_to_Struct'>AppendRelInfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>appinfo</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN1964"><span class='Ref_to_Struct'>AppendRelInfo</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN499"><span class='Ref_to_Member'>sublevels_up</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN574"><span class='Ref_To_Local'>appinfo</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN1974"><span class='Ref_to_Member'>parent_relid</span></a> <span class='Operator'>== </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN497"><span class='Ref_to_Member'>rt_index</span></a><span class='Parentheses'>) 
</span>                <a href="rewriteManip.c.html#LN574"><span class='Ref_To_Local'>appinfo</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN1974"><span class='Ref_to_Member'>parent_relid</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN498"><span class='Ref_to_Member'>new_index</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN574"><span class='Ref_To_Local'>appinfo</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN1975"><span class='Ref_to_Member'>child_relid</span></a> <span class='Operator'>== </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN497"><span class='Ref_to_Member'>rt_index</span></a><span class='Parentheses'>) 
</span>                <a href="rewriteManip.c.html#LN574"><span class='Ref_To_Local'>appinfo</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN1975"><span class='Ref_to_Member'>child_relid</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN498"><span class='Ref_to_Member'>new_index</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Comment_Multi_Line'>/* fall through to examine children */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* Shouldn't need to handle other planner auxiliary nodes here */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/relation.h.html#LN1913"><span class='Ref_to_Struct'>SpecialJoinInfo</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/relation.h.html#LN2057"><span class='Ref_to_Struct'>PlaceHolderInfo</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/relation.h.html#LN2074"><span class='Ref_to_Struct'>MinMaxAggInfo</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Recurse into subselects */ 
</span><a name="LN593"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
        <a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN499"><span class='Ref_to_Member'>sublevels_up</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN593"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodeFuncs.h.html#LN57"><span class='Ref_to_Proto'>query_tree_walker</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN502"><span class='Ref_to_Func'>ChangeVarNodes_walker</span></a><span class='Delimiter'>, 
</span>                                   <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN499"><span class='Ref_to_Member'>sublevels_up</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="rewriteManip.c.html#LN593"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="../../include/nodes/nodeFuncs.h.html#LN52"><span class='Ref_to_Proto'>expression_tree_walker</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN502"><span class='Ref_to_Func'>ChangeVarNodes_walker</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN503"><span class='Ref_to_Parameter'>context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end ChangeVarNodes_walker &raquo; </span> 
 
<span class='Keyword'>void 
</span><a name="LN606"></a><span class='Declare_Function'>ChangeVarNodes</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>rt_index</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>new_index</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>sublevels_up</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN608"></a>    <a href="rewriteManip.c.html#LN495"><span class='Ref_to_Typedef'>ChangeVarNodes_context</span></a> <span class='Declare_Local'>context</span><span class='Delimiter'>; 
</span> 
    <a href="rewriteManip.c.html#LN608"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN497"><span class='Ref_to_Member'>rt_index</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN606"><span class='Ref_to_Parameter'>rt_index</span></a><span class='Delimiter'>; 
</span>    <a href="rewriteManip.c.html#LN608"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN498"><span class='Ref_to_Member'>new_index</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN606"><span class='Ref_to_Parameter'>new_index</span></a><span class='Delimiter'>; 
</span>    <a href="rewriteManip.c.html#LN608"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN499"><span class='Ref_to_Member'>sublevels_up</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN606"><span class='Ref_to_Parameter'>sublevels_up</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Must be prepared to start with a Query or a bare expression tree; if 
     * it's a Query, go straight to query_tree_walker to make sure that 
     * sublevels_up doesn't get incremented prematurely. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN606"><span class='Ref_to_Parameter'>node</span></a> <span class='Operator'>&& </span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN606"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN621"></a>        <a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>qry</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN606"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If we are starting at a Query, and sublevels_up is zero, then we 
         * must also fix rangetable indexes in the Query itself --- namely 
         * resultRelation and rowMarks entries.  sublevels_up cannot be zero 
         * when recursing into a subquery, so there's no need to have the same 
         * logic inside ChangeVarNodes_walker. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN606"><span class='Ref_to_Parameter'>sublevels_up</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN632"></a>            <a href="../../include/nodes/pg_list.h.html#LN52"><span class='Ref_to_Struct'>ListCell</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN621"><span class='Ref_To_Local'>qry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN119"><span class='Ref_to_Member'>resultRelation</span></a> <span class='Operator'>== </span><a href="rewriteManip.c.html#LN606"><span class='Ref_to_Parameter'>rt_index</span></a><span class='Parentheses'>) 
</span>                <a href="rewriteManip.c.html#LN621"><span class='Ref_To_Local'>qry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN119"><span class='Ref_to_Member'>resultRelation</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN606"><span class='Ref_to_Parameter'>new_index</span></a><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* this is unlikely to ever be used, but ... */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN621"><span class='Ref_To_Local'>qry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN141"><span class='Ref_to_Member'>onConflict</span></a> <span class='Operator'>&& </span><a href="rewriteManip.c.html#LN621"><span class='Ref_To_Local'>qry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN141"><span class='Ref_to_Member'>onConflict</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1496"><span class='Ref_to_Member'>exclRelIndex</span></a> <span class='Operator'>== </span><a href="rewriteManip.c.html#LN606"><span class='Ref_to_Parameter'>rt_index</span></a><span class='Parentheses'>) 
</span>                <a href="rewriteManip.c.html#LN621"><span class='Ref_To_Local'>qry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN141"><span class='Ref_to_Member'>onConflict</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1496"><span class='Ref_to_Member'>exclRelIndex</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN606"><span class='Ref_to_Parameter'>new_index</span></a><span class='Delimiter'>; 
</span> 
            <a href="../../include/nodes/pg_list.h.html#LN160"><span class='Ref_to_Macro'>foreach</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN632"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN621"><span class='Ref_To_Local'>qry</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN160"><span class='Ref_to_Member'>rowMarks</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN643"></a>                <a href="../../include/nodes/parsenodes.h.html#LN1278"><span class='Ref_to_Struct'>RowMarkClause</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rc</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN1278"><span class='Ref_to_Struct'>RowMarkClause</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN105"><span class='Ref_to_Macro'>lfirst</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN632"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN643"><span class='Ref_To_Local'>rc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1281"><span class='Ref_to_Member'>rti</span></a> <span class='Operator'>== </span><a href="rewriteManip.c.html#LN606"><span class='Ref_to_Parameter'>rt_index</span></a><span class='Parentheses'>) 
</span>                    <a href="rewriteManip.c.html#LN643"><span class='Ref_To_Local'>rc</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1281"><span class='Ref_to_Member'>rti</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN606"><span class='Ref_to_Parameter'>new_index</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>        <a href="../../include/nodes/nodeFuncs.h.html#LN57"><span class='Ref_to_Proto'>query_tree_walker</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN621"><span class='Ref_To_Local'>qry</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN502"><span class='Ref_to_Func'>ChangeVarNodes_walker</span></a><span class='Delimiter'>, 
</span>                          <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="rewriteManip.c.html#LN608"><span class='Ref_To_Local'>context</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if node&&IsA(node,Query) &raquo; </span> 
    <span class='Control'>else</span> 
        <a href="rewriteManip.c.html#LN502"><span class='Ref_to_Func'>ChangeVarNodes_walker</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN606"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="rewriteManip.c.html#LN608"><span class='Ref_To_Local'>context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end ChangeVarNodes &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Substitute newrelid for oldrelid in a Relid set 
 */ 
</span><span class='Keyword'>static </span><a href="../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a> 
<a name="LN660"></a><span class='Declare_Function'>adjust_relid_set</span><span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN27"><span class='Ref_to_Typedef'>Relids</span></a> <span class='Declare_Parameter'>relids</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>oldrelid</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>newrelid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/bitmapset.h.html#LN75"><span class='Ref_to_Proto'>bms_is_member</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN660"><span class='Ref_to_Parameter'>oldrelid</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN660"><span class='Ref_to_Parameter'>relids</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Ensure we have a modifiable copy */ 
</span>        <a href="rewriteManip.c.html#LN660"><span class='Ref_to_Parameter'>relids</span></a> <span class='Operator'>= </span><a href="../../include/nodes/bitmapset.h.html#LN65"><span class='Ref_to_Proto'>bms_copy</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN660"><span class='Ref_to_Parameter'>relids</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* Remove old, add new */ 
</span>        <a href="rewriteManip.c.html#LN660"><span class='Ref_to_Parameter'>relids</span></a> <span class='Operator'>= </span><a href="../../include/nodes/bitmapset.h.html#LN90"><span class='Ref_to_Proto'>bms_del_member</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN660"><span class='Ref_to_Parameter'>relids</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN660"><span class='Ref_to_Parameter'>oldrelid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN660"><span class='Ref_to_Parameter'>relids</span></a> <span class='Operator'>= </span><a href="../../include/nodes/bitmapset.h.html#LN89"><span class='Ref_to_Proto'>bms_add_member</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN660"><span class='Ref_to_Parameter'>relids</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN660"><span class='Ref_to_Parameter'>newrelid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="rewriteManip.c.html#LN660"><span class='Ref_to_Parameter'>relids</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * IncrementVarSublevelsUp - adjust Var nodes when pushing them down in tree 
 * 
 * Find all Var nodes in the given tree having varlevelsup &GT;= min_sublevels_up, 
 * and add delta_sublevels_up to their varlevelsup value.  This is needed when 
 * an expression that's correct for some nesting level is inserted into a 
 * subquery.  Ordinarily the initial call has min_sublevels_up == 0 so that 
 * all Vars are affected.  The point of min_sublevels_up is that we can 
 * increment it when we recurse into a sublink, so that local variables in 
 * that sublink are not affected, only outer references to vars that belong 
 * to the expression's original query level or parents thereof. 
 * 
 * Likewise for other nodes containing levelsup fields, such as Aggref. 
 * 
 * NOTE: although this has the form of a walker, we cheat and modify the 
 * Var nodes in-place.  The given expression tree should have been copied 
 * earlier to ensure that no unwanted side-effects occur! 
 */ 
</span> 
<span class='Control'>typedef</span> <span class='Control'>struct</span> 
<span class='Delimiter'>{ 
</span><a name="LN694"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>delta_sublevels_up</span><span class='Delimiter'>; 
</span><a name="LN695"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>min_sublevels_up</span><span class='Delimiter'>; 
</span><a name="LN696"></a>} <span class='Declare_Typedef'>IncrementVarSublevelsUp_context</span><span class='Delimiter'>; 
</span> 
<span class='Keyword'>static bool 
</span><a name="LN699"></a><span class='Declare_Function'>IncrementVarSublevelsUp_walker</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, 
</span><a name="LN700"></a>                               <a href="rewriteManip.c.html#LN692"><span class='Ref_to_Typedef'>IncrementVarSublevelsUp_context</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN699"><span class='Ref_to_Parameter'>node</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN699"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN706"></a>        <a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>var</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN699"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN706"><span class='Ref_To_Local'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN172"><span class='Ref_to_Member'>varlevelsup</span></a> <span class='Operator'>&GT;= </span><a href="rewriteManip.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN695"><span class='Ref_to_Member'>min_sublevels_up</span></a><span class='Parentheses'>) 
</span>            <a href="rewriteManip.c.html#LN706"><span class='Ref_To_Local'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN172"><span class='Ref_to_Member'>varlevelsup</span></a> <span class='Operator'>+= </span><a href="rewriteManip.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN694"><span class='Ref_to_Member'>delta_sublevels_up</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* done here */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN699"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN1272"><span class='Ref_to_Struct'>CurrentOfExpr</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* this should not happen */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN695"><span class='Ref_to_Member'>min_sublevels_up</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"cannot push down CurrentOfExpr"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN699"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN290"><span class='Ref_to_Struct'>Aggref</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN721"></a>        <a href="../../include/nodes/primnodes.h.html#LN290"><span class='Ref_to_Struct'>Aggref</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>agg</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN290"><span class='Ref_to_Struct'>Aggref</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN699"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN721"><span class='Ref_To_Local'>agg</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN308"><span class='Ref_to_Member'>agglevelsup</span></a> <span class='Operator'>&GT;= </span><a href="rewriteManip.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN695"><span class='Ref_to_Member'>min_sublevels_up</span></a><span class='Parentheses'>) 
</span>            <a href="rewriteManip.c.html#LN721"><span class='Ref_To_Local'>agg</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN308"><span class='Ref_to_Member'>agglevelsup</span></a> <span class='Operator'>+= </span><a href="rewriteManip.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN694"><span class='Ref_to_Member'>delta_sublevels_up</span></a><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* fall through to recurse into argument */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN699"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN337"><span class='Ref_to_Struct'>GroupingFunc</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN729"></a>        <a href="../../include/nodes/primnodes.h.html#LN337"><span class='Ref_to_Struct'>GroupingFunc</span></a> <span class='Operator'>*</span><span class='Declare_Local'>grp</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN337"><span class='Ref_to_Struct'>GroupingFunc</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN699"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN729"><span class='Ref_To_Local'>grp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN344"><span class='Ref_to_Member'>agglevelsup</span></a> <span class='Operator'>&GT;= </span><a href="rewriteManip.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN695"><span class='Ref_to_Member'>min_sublevels_up</span></a><span class='Parentheses'>) 
</span>            <a href="rewriteManip.c.html#LN729"><span class='Ref_To_Local'>grp</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN344"><span class='Ref_to_Member'>agglevelsup</span></a> <span class='Operator'>+= </span><a href="rewriteManip.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN694"><span class='Ref_to_Member'>delta_sublevels_up</span></a><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* fall through to recurse into argument */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN699"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/relation.h.html#LN1846"><span class='Ref_to_Struct'>PlaceHolderVar</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN737"></a>        <a href="../../include/nodes/relation.h.html#LN1846"><span class='Ref_to_Struct'>PlaceHolderVar</span></a> <span class='Operator'>*</span><span class='Declare_Local'>phv</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/relation.h.html#LN1846"><span class='Ref_to_Struct'>PlaceHolderVar</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN699"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN737"><span class='Ref_To_Local'>phv</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN1852"><span class='Ref_to_Member'>phlevelsup</span></a> <span class='Operator'>&GT;= </span><a href="rewriteManip.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN695"><span class='Ref_to_Member'>min_sublevels_up</span></a><span class='Parentheses'>) 
</span>            <a href="rewriteManip.c.html#LN737"><span class='Ref_To_Local'>phv</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/relation.h.html#LN1852"><span class='Ref_to_Member'>phlevelsup</span></a> <span class='Operator'>+= </span><a href="rewriteManip.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN694"><span class='Ref_to_Member'>delta_sublevels_up</span></a><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* fall through to recurse into argument */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN699"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN745"></a>        <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rte</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN699"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN745"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN936"><span class='Ref_to_Member'>rtekind</span></a> <span class='Operator'>== </span><a href="../../include/nodes/parsenodes.h.html#LN928"><span class='Ref_to_EnumConst'>RTE_CTE</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN745"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1002"><span class='Ref_to_Member'>ctelevelsup</span></a> <span class='Operator'>&GT;= </span><a href="rewriteManip.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN695"><span class='Ref_to_Member'>min_sublevels_up</span></a><span class='Parentheses'>) 
</span>                <a href="rewriteManip.c.html#LN745"><span class='Ref_To_Local'>rte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN1002"><span class='Ref_to_Member'>ctelevelsup</span></a> <span class='Operator'>+= </span><a href="rewriteManip.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN694"><span class='Ref_to_Member'>delta_sublevels_up</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* allow range_table_walker to continue */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN699"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Recurse into subselects */ 
</span><a name="LN757"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
        <a href="rewriteManip.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN695"><span class='Ref_to_Member'>min_sublevels_up</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN757"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodeFuncs.h.html#LN57"><span class='Ref_to_Proto'>query_tree_walker</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN699"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, 
</span>                                   <a href="rewriteManip.c.html#LN698"><span class='Ref_to_Func'>IncrementVarSublevelsUp_walker</span></a><span class='Delimiter'>, 
</span>                                   <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Delimiter'>, 
</span>                                   <a href="../../include/nodes/nodeFuncs.h.html#LN24"><span class='Ref_to_Const'>QTW_EXAMINE_RTES</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN695"><span class='Ref_to_Member'>min_sublevels_up</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="rewriteManip.c.html#LN757"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="../../include/nodes/nodeFuncs.h.html#LN52"><span class='Ref_to_Proto'>expression_tree_walker</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN699"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN698"><span class='Ref_to_Func'>IncrementVarSublevelsUp_walker</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end IncrementVarSublevelsUp_walker &raquo; </span> 
 
<span class='Keyword'>void 
</span><a name="LN772"></a><span class='Declare_Function'>IncrementVarSublevelsUp</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>delta_sublevels_up</span><span class='Delimiter'>, 
</span><a name="LN773"></a>                        <span class='Keyword'>int </span><span class='Declare_Parameter'>min_sublevels_up</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN775"></a>    <a href="rewriteManip.c.html#LN692"><span class='Ref_to_Typedef'>IncrementVarSublevelsUp_context</span></a> <span class='Declare_Local'>context</span><span class='Delimiter'>; 
</span> 
    <a href="rewriteManip.c.html#LN775"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN694"><span class='Ref_to_Member'>delta_sublevels_up</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN772"><span class='Ref_to_Parameter'>delta_sublevels_up</span></a><span class='Delimiter'>; 
</span>    <a href="rewriteManip.c.html#LN775"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN695"><span class='Ref_to_Member'>min_sublevels_up</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN773"><span class='Ref_to_Parameter'>min_sublevels_up</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Must be prepared to start with a Query or a bare expression tree; if 
     * it's a Query, we don't want to increment sublevels_up. 
     */ 
</span>    <a href="../../include/nodes/nodeFuncs.h.html#LN67"><span class='Ref_to_Proto'>query_or_expression_tree_walker</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN772"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, 
</span>                                    <a href="rewriteManip.c.html#LN698"><span class='Ref_to_Func'>IncrementVarSublevelsUp_walker</span></a><span class='Delimiter'>, 
</span>                                    <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="rewriteManip.c.html#LN775"><span class='Ref_To_Local'>context</span></a><span class='Delimiter'>, 
</span>                                    <a href="../../include/nodes/nodeFuncs.h.html#LN24"><span class='Ref_to_Const'>QTW_EXAMINE_RTES</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * IncrementVarSublevelsUp_rtable - 
 *  Same as IncrementVarSublevelsUp, but to be invoked on a range table. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN795"></a><span class='Declare_Function'>IncrementVarSublevelsUp_rtable</span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>rtable</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>delta_sublevels_up</span><span class='Delimiter'>, 
</span><a name="LN796"></a>                               <span class='Keyword'>int </span><span class='Declare_Parameter'>min_sublevels_up</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN798"></a>    <a href="rewriteManip.c.html#LN692"><span class='Ref_to_Typedef'>IncrementVarSublevelsUp_context</span></a> <span class='Declare_Local'>context</span><span class='Delimiter'>; 
</span> 
    <a href="rewriteManip.c.html#LN798"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN694"><span class='Ref_to_Member'>delta_sublevels_up</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN795"><span class='Ref_to_Parameter'>delta_sublevels_up</span></a><span class='Delimiter'>; 
</span>    <a href="rewriteManip.c.html#LN798"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN695"><span class='Ref_to_Member'>min_sublevels_up</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN796"><span class='Ref_to_Parameter'>min_sublevels_up</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../include/nodes/nodeFuncs.h.html#LN62"><span class='Ref_to_Proto'>range_table_walker</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN795"><span class='Ref_to_Parameter'>rtable</span></a><span class='Delimiter'>, 
</span>                       <a href="rewriteManip.c.html#LN698"><span class='Ref_to_Func'>IncrementVarSublevelsUp_walker</span></a><span class='Delimiter'>, 
</span>                       <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="rewriteManip.c.html#LN798"><span class='Ref_To_Local'>context</span></a><span class='Delimiter'>, 
</span>                       <a href="../../include/nodes/nodeFuncs.h.html#LN24"><span class='Ref_to_Const'>QTW_EXAMINE_RTES</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * rangeTableEntry_used - detect whether an RTE is referenced somewhere 
 *  in var nodes or join or setOp trees of a query or expression. 
 */ 
</span> 
<span class='Control'>typedef</span> <span class='Control'>struct</span> 
<span class='Delimiter'>{ 
</span><a name="LN817"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>rt_index</span><span class='Delimiter'>; 
</span><a name="LN818"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>sublevels_up</span><span class='Delimiter'>; 
</span><a name="LN819"></a>} <span class='Declare_Typedef'>rangeTableEntry_used_context</span><span class='Delimiter'>; 
</span> 
<span class='Keyword'>static bool 
</span><a name="LN822"></a><span class='Declare_Function'>rangeTableEntry_used_walker</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, 
</span><a name="LN823"></a>                            <a href="rewriteManip.c.html#LN815"><span class='Ref_to_Typedef'>rangeTableEntry_used_context</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN822"><span class='Ref_to_Parameter'>node</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN822"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN829"></a>        <a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>var</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN822"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN829"><span class='Ref_To_Local'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN172"><span class='Ref_to_Member'>varlevelsup</span></a> <span class='Operator'>== </span><a href="rewriteManip.c.html#LN823"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN818"><span class='Ref_to_Member'>sublevels_up</span></a> <span class='Operator'>&& 
</span>            <a href="rewriteManip.c.html#LN829"><span class='Ref_To_Local'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN165"><span class='Ref_to_Member'>varno</span></a> <span class='Operator'>== </span><a href="rewriteManip.c.html#LN823"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN817"><span class='Ref_to_Member'>rt_index</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN822"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN1272"><span class='Ref_to_Struct'>CurrentOfExpr</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN838"></a>        <a href="../../include/nodes/primnodes.h.html#LN1272"><span class='Ref_to_Struct'>CurrentOfExpr</span></a> <span class='Operator'>*</span><span class='Declare_Local'>cexpr</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN1272"><span class='Ref_to_Struct'>CurrentOfExpr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN822"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN823"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN818"><span class='Ref_to_Member'>sublevels_up</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>&& 
</span>            <a href="rewriteManip.c.html#LN838"><span class='Ref_To_Local'>cexpr</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1275"><span class='Ref_to_Member'>cvarno</span></a> <span class='Operator'>== </span><a href="rewriteManip.c.html#LN823"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN817"><span class='Ref_to_Member'>rt_index</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN822"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN1415"><span class='Ref_to_Struct'>RangeTblRef</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN847"></a>        <a href="../../include/nodes/primnodes.h.html#LN1415"><span class='Ref_to_Struct'>RangeTblRef</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rtr</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN1415"><span class='Ref_to_Struct'>RangeTblRef</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN822"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN847"><span class='Ref_To_Local'>rtr</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1418"><span class='Ref_to_Member'>rtindex</span></a> <span class='Operator'>== </span><a href="rewriteManip.c.html#LN823"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN817"><span class='Ref_to_Member'>rt_index</span></a> <span class='Operator'>&& 
</span>            <a href="rewriteManip.c.html#LN823"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN818"><span class='Ref_to_Member'>sublevels_up</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* the subquery itself is visited separately */ 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN822"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN1444"><span class='Ref_to_Struct'>JoinExpr</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN857"></a>        <a href="../../include/nodes/primnodes.h.html#LN1444"><span class='Ref_to_Struct'>JoinExpr</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>j</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN1444"><span class='Ref_to_Struct'>JoinExpr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN822"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN857"><span class='Ref_To_Local'>j</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1454"><span class='Ref_to_Member'>rtindex</span></a> <span class='Operator'>== </span><a href="rewriteManip.c.html#LN823"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN817"><span class='Ref_to_Member'>rt_index</span></a> <span class='Operator'>&& 
</span>            <a href="rewriteManip.c.html#LN823"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN818"><span class='Ref_to_Member'>sublevels_up</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* fall through to examine children */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* Shouldn't need to handle planner auxiliary nodes here */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN822"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/relation.h.html#LN1846"><span class='Ref_to_Struct'>PlaceHolderVar</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN822"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/plannodes.h.html#LN1002"><span class='Ref_to_Struct'>PlanRowMark</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN822"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/relation.h.html#LN1913"><span class='Ref_to_Struct'>SpecialJoinInfo</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN822"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/relation.h.html#LN1964"><span class='Ref_to_Struct'>AppendRelInfo</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN822"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/relation.h.html#LN2057"><span class='Ref_to_Struct'>PlaceHolderInfo</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN822"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/relation.h.html#LN2074"><span class='Ref_to_Struct'>MinMaxAggInfo</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN822"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Recurse into subselects */ 
</span><a name="LN875"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
        <a href="rewriteManip.c.html#LN823"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN818"><span class='Ref_to_Member'>sublevels_up</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN875"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodeFuncs.h.html#LN57"><span class='Ref_to_Proto'>query_tree_walker</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN822"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN821"><span class='Ref_to_Func'>rangeTableEntry_used_walker</span></a><span class='Delimiter'>, 
</span>                                   <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN823"><span class='Ref_to_Parameter'>context</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN823"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN818"><span class='Ref_to_Member'>sublevels_up</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="rewriteManip.c.html#LN875"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="../../include/nodes/nodeFuncs.h.html#LN52"><span class='Ref_to_Proto'>expression_tree_walker</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN822"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN821"><span class='Ref_to_Func'>rangeTableEntry_used_walker</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN823"><span class='Ref_to_Parameter'>context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end rangeTableEntry_used_walker &raquo; </span> 
 
<span class='Keyword'>bool 
</span><a name="LN888"></a><span class='Declare_Function'>rangeTableEntry_used</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>rt_index</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>sublevels_up</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN890"></a>    <a href="rewriteManip.c.html#LN815"><span class='Ref_to_Typedef'>rangeTableEntry_used_context</span></a> <span class='Declare_Local'>context</span><span class='Delimiter'>; 
</span> 
    <a href="rewriteManip.c.html#LN890"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN817"><span class='Ref_to_Member'>rt_index</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN888"><span class='Ref_to_Parameter'>rt_index</span></a><span class='Delimiter'>; 
</span>    <a href="rewriteManip.c.html#LN890"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN818"><span class='Ref_to_Member'>sublevels_up</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN888"><span class='Ref_to_Parameter'>sublevels_up</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Must be prepared to start with a Query or a bare expression tree; if 
     * it's a Query, we don't want to increment sublevels_up. 
     */ 
</span>    <span class='Control'>return</span> <a href="../../include/nodes/nodeFuncs.h.html#LN67"><span class='Ref_to_Proto'>query_or_expression_tree_walker</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN888"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, 
</span>                                           <a href="rewriteManip.c.html#LN821"><span class='Ref_to_Func'>rangeTableEntry_used_walker</span></a><span class='Delimiter'>, 
</span>                                           <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="rewriteManip.c.html#LN890"><span class='Ref_To_Local'>context</span></a><span class='Delimiter'>, 
</span>                                           <span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * If the given Query is an INSERT ... SELECT construct, extract and 
 * return the sub-Query node that represents the SELECT part.  Otherwise 
 * return the given Query. 
 * 
 * If subquery_ptr is not NULL, then *subquery_ptr is set to the location 
 * of the link to the SELECT subquery inside parsetree, or NULL if not an 
 * INSERT ... SELECT. 
 * 
 * This is a hack needed because transformations on INSERT ... SELECTs that 
 * appear in rule actions should be applied to the source SELECT, not to the 
 * INSERT part.  Perhaps this can be cleaned up with redesigned querytrees. 
 */ 
</span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a> <span class='Operator'>* 
</span><a name="LN920"></a><span class='Declare_Function'>getInsertSelectQuery</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>parsetree</span><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a> <span class='Operator'>***</span><span class='Declare_Parameter'>subquery_ptr</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN922"></a>    <a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>selectquery</span><span class='Delimiter'>; 
</span><a name="LN923"></a>    <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>selectrte</span><span class='Delimiter'>; 
</span><a name="LN924"></a>    <a href="../../include/nodes/primnodes.h.html#LN1415"><span class='Ref_to_Struct'>RangeTblRef</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rtr</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN920"><span class='Ref_to_Parameter'>subquery_ptr</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="rewriteManip.c.html#LN920"><span class='Ref_to_Parameter'>subquery_ptr</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN920"><span class='Ref_to_Parameter'>parsetree</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="rewriteManip.c.html#LN920"><span class='Ref_to_Parameter'>parsetree</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN920"><span class='Ref_to_Parameter'>parsetree</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN109"><span class='Ref_to_Member'>commandType</span></a> <span class='Operator'>!= </span><a href="../../include/nodes/nodes.h.html#LN652"><span class='Ref_to_EnumConst'>CMD_INSERT</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="rewriteManip.c.html#LN920"><span class='Ref_to_Parameter'>parsetree</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Currently, this is ONLY applied to rule-action queries, and so we 
     * expect to find the OLD and NEW placeholder entries in the given query. 
     * If they're not there, it must be an INSERT/SELECT in which they've been 
     * pushed down to the SELECT. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN920"><span class='Ref_to_Parameter'>parsetree</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN134"><span class='Ref_to_Member'>rtable</span></a><span class='Parentheses'>)</span> <span class='Operator'>&GT;= </span><span class='Number'>2</span> <span class='Operator'>&& 
</span>        strcmp<span class='Parentheses'>(</span><a href="../../include/parser/parsetree.h.html#LN30"><span class='Ref_to_Macro'>rt_fetch</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN159"><span class='Ref_to_Const'>PRS2_OLD_VARNO</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN920"><span class='Ref_to_Parameter'>parsetree</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN134"><span class='Ref_to_Member'>rtable</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>eref<span class='Operator'>-&GT;</span>aliasname<span class='Delimiter'>, 
</span>               <span class='String'>"old"</span><span class='Parentheses'>)</span> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>&& 
</span>        strcmp<span class='Parentheses'>(</span><a href="../../include/parser/parsetree.h.html#LN30"><span class='Ref_to_Macro'>rt_fetch</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN160"><span class='Ref_to_Const'>PRS2_NEW_VARNO</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN920"><span class='Ref_to_Parameter'>parsetree</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN134"><span class='Ref_to_Member'>rtable</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>eref<span class='Operator'>-&GT;</span>aliasname<span class='Delimiter'>, 
</span>               <span class='String'>"new"</span><span class='Parentheses'>)</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="rewriteManip.c.html#LN920"><span class='Ref_to_Parameter'>parsetree</span></a><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN920"><span class='Ref_to_Parameter'>parsetree</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN135"><span class='Ref_to_Member'>jointree</span></a> <span class='Operator'>&& </span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN920"><span class='Ref_to_Parameter'>parsetree</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN135"><span class='Ref_to_Member'>jointree</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN1466"><span class='Ref_to_Struct'>FromExpr</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN920"><span class='Ref_to_Parameter'>parsetree</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN135"><span class='Ref_to_Member'>jointree</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1469"><span class='Ref_to_Member'>fromlist</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"expected to find SELECT subquery"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="rewriteManip.c.html#LN924"><span class='Ref_To_Local'>rtr</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN1415"><span class='Ref_to_Struct'>RangeTblRef</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN920"><span class='Ref_to_Parameter'>parsetree</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN135"><span class='Ref_to_Member'>jointree</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1469"><span class='Ref_to_Member'>fromlist</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN924"><span class='Ref_To_Local'>rtr</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN1415"><span class='Ref_to_Struct'>RangeTblRef</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="rewriteManip.c.html#LN923"><span class='Ref_To_Local'>selectrte</span></a> <span class='Operator'>= </span><a href="../../include/parser/parsetree.h.html#LN30"><span class='Ref_to_Macro'>rt_fetch</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN924"><span class='Ref_To_Local'>rtr</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1418"><span class='Ref_to_Member'>rtindex</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN920"><span class='Ref_to_Parameter'>parsetree</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN134"><span class='Ref_to_Member'>rtable</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="rewriteManip.c.html#LN922"><span class='Ref_To_Local'>selectquery</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN923"><span class='Ref_To_Local'>selectrte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN954"><span class='Ref_to_Member'>subquery</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN922"><span class='Ref_To_Local'>selectquery</span></a> <span class='Operator'>&& </span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN922"><span class='Ref_To_Local'>selectquery</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>          <a href="rewriteManip.c.html#LN922"><span class='Ref_To_Local'>selectquery</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN109"><span class='Ref_to_Member'>commandType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/nodes.h.html#LN650"><span class='Ref_to_EnumConst'>CMD_SELECT</span></a><span class='Parentheses'>))</span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"expected to find SELECT subquery"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN922"><span class='Ref_To_Local'>selectquery</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN134"><span class='Ref_to_Member'>rtable</span></a><span class='Parentheses'>)</span> <span class='Operator'>&GT;= </span><span class='Number'>2</span> <span class='Operator'>&& 
</span>        strcmp<span class='Parentheses'>(</span><a href="../../include/parser/parsetree.h.html#LN30"><span class='Ref_to_Macro'>rt_fetch</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN159"><span class='Ref_to_Const'>PRS2_OLD_VARNO</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN922"><span class='Ref_To_Local'>selectquery</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN134"><span class='Ref_to_Member'>rtable</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>eref<span class='Operator'>-&GT;</span>aliasname<span class='Delimiter'>, 
</span>               <span class='String'>"old"</span><span class='Parentheses'>)</span> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>&& 
</span>        strcmp<span class='Parentheses'>(</span><a href="../../include/parser/parsetree.h.html#LN30"><span class='Ref_to_Macro'>rt_fetch</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN160"><span class='Ref_to_Const'>PRS2_NEW_VARNO</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN922"><span class='Ref_To_Local'>selectquery</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN134"><span class='Ref_to_Member'>rtable</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>eref<span class='Operator'>-&GT;</span>aliasname<span class='Delimiter'>, 
</span>               <span class='String'>"new"</span><span class='Parentheses'>)</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN920"><span class='Ref_to_Parameter'>subquery_ptr</span></a><span class='Parentheses'>) 
</span>            <span class='Operator'>*</span><a href="rewriteManip.c.html#LN920"><span class='Ref_to_Parameter'>subquery_ptr</span></a> <span class='Operator'>= &</span><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN923"><span class='Ref_To_Local'>selectrte</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN954"><span class='Ref_to_Member'>subquery</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="rewriteManip.c.html#LN922"><span class='Ref_To_Local'>selectquery</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"could not find rule placeholders"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* not reached */ 
</span><span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end getInsertSelectQuery &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * Add the given qualifier condition to the query's WHERE clause 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN975"></a><span class='Declare_Function'>AddQual</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>parsetree</span><span class='Delimiter'>, </span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qual</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN977"></a>    <a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>copy</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN975"><span class='Ref_to_Parameter'>qual</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN975"><span class='Ref_to_Parameter'>parsetree</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN109"><span class='Ref_to_Member'>commandType</span></a> <span class='Operator'>== </span><a href="../../include/nodes/nodes.h.html#LN654"><span class='Ref_to_EnumConst'>CMD_UTILITY</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * There's noplace to put the qual on a utility statement. 
         * 
         * If it's a NOTIFY, silently ignore the qual; this means that the 
         * NOTIFY will execute, whether or not there are any qualifying rows. 
         * While clearly wrong, this is much more useful than refusing to 
         * execute the rule at all, and extra NOTIFY events are harmless for 
         * typical uses of NOTIFY. 
         * 
         * If it isn't a NOTIFY, error out, since unconditional execution of 
         * other utility stmts is unlikely to be wanted.  (This case is not 
         * currently allowed anyway, but keep the test for safety.) 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN975"><span class='Ref_to_Parameter'>parsetree</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN117"><span class='Ref_to_Member'>utilityStmt</span></a> <span class='Operator'>&& </span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN975"><span class='Ref_to_Parameter'>parsetree</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN117"><span class='Ref_to_Member'>utilityStmt</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN2857"><span class='Ref_to_Struct'>NotifyStmt</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>              <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"conditional utility statements are not implemented"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if parsetree-&GT;commandTyp... &raquo; </span> 
 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN975"><span class='Ref_to_Parameter'>parsetree</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN162"><span class='Ref_to_Member'>setOperations</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * There's noplace to put the qual on a setop statement, either. (This 
         * could be fixed, but right now the planner simply ignores any qual 
         * condition on a setop query.) 
         */ 
</span>        <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"conditional UNION/INTERSECT/EXCEPT statements are not implemented"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* INTERSECT want's the original, but we need to copy - Jan */ 
</span>    <a href="rewriteManip.c.html#LN977"><span class='Ref_To_Local'>copy</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN618"><span class='Ref_to_Macro'>copyObject</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN975"><span class='Ref_to_Parameter'>qual</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="rewriteManip.c.html#LN975"><span class='Ref_to_Parameter'>parsetree</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN135"><span class='Ref_to_Member'>jointree</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1470"><span class='Ref_to_Member'>quals</span></a> <span class='Operator'>= </span><a href="../../include/optimizer/clauses.h.html#LN44"><span class='Ref_to_Proto'>make_and_qual</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN975"><span class='Ref_to_Parameter'>parsetree</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN135"><span class='Ref_to_Member'>jointree</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1470"><span class='Ref_to_Member'>quals</span></a><span class='Delimiter'>, 
</span>                                               <a href="rewriteManip.c.html#LN977"><span class='Ref_To_Local'>copy</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We had better not have stuck an aggregate into the WHERE clause. 
     */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/rewrite/rewriteManip.h.html#LN57"><span class='Ref_to_Proto'>contain_aggs_of_level</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN977"><span class='Ref_To_Local'>copy</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Make sure query is marked correctly if added qual has sublinks. Need 
     * not search qual when query is already marked. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="rewriteManip.c.html#LN975"><span class='Ref_to_Parameter'>parsetree</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN125"><span class='Ref_to_Member'>hasSubLinks</span></a><span class='Parentheses'>) 
</span>        <a href="rewriteManip.c.html#LN975"><span class='Ref_to_Parameter'>parsetree</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN125"><span class='Ref_to_Member'>hasSubLinks</span></a> <span class='Operator'>= </span><a href="../../include/rewrite/rewriteManip.h.html#LN61"><span class='Ref_to_Proto'>checkExprHasSubLink</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN977"><span class='Ref_To_Local'>copy</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end AddQual &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * Invert the given clause and add it to the WHERE qualifications of the 
 * given querytree.  Inversion means "x IS NOT TRUE", not just "NOT x", 
 * else we will do the wrong thing when x evaluates to NULL. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN1043"></a><span class='Declare_Function'>AddInvertedQual</span><span class='Parentheses'>(</span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>parsetree</span><span class='Delimiter'>, </span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>qual</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1045"></a>    <a href="../../include/nodes/primnodes.h.html#LN1198"><span class='Ref_to_Struct'>BooleanTest</span></a> <span class='Operator'>*</span><span class='Declare_Local'>invqual</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1043"><span class='Ref_to_Parameter'>qual</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Need not copy input qual, because AddQual will... */ 
</span>    <a href="rewriteManip.c.html#LN1045"><span class='Ref_To_Local'>invqual</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN1198"><span class='Ref_to_Struct'>BooleanTest</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="rewriteManip.c.html#LN1045"><span class='Ref_To_Local'>invqual</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1201"><span class='Ref_to_Member'>arg</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN131"><span class='Ref_to_Struct'>Expr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN1043"><span class='Ref_to_Parameter'>qual</span></a><span class='Delimiter'>; 
</span>    <a href="rewriteManip.c.html#LN1045"><span class='Ref_To_Local'>invqual</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1202"><span class='Ref_to_Member'>booltesttype</span></a> <span class='Operator'>= </span><a href="../../include/nodes/primnodes.h.html#LN1195"><span class='Ref_to_EnumConst'>IS_NOT_TRUE</span></a><span class='Delimiter'>; 
</span>    <a href="rewriteManip.c.html#LN1045"><span class='Ref_To_Local'>invqual</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1203"><span class='Ref_to_Member'>location</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/rewrite/rewriteManip.h.html#LN54"><span class='Ref_to_Proto'>AddQual</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1043"><span class='Ref_to_Parameter'>parsetree</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN1045"><span class='Ref_To_Local'>invqual</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * replace_rte_variables() finds all Vars in an expression tree 
 * that reference a particular RTE, and replaces them with substitute 
 * expressions obtained from a caller-supplied callback function. 
 * 
 * When invoking replace_rte_variables on a portion of a Query, pass the 
 * address of the containing Query's hasSubLinks field as outer_hasSubLinks. 
 * Otherwise, pass NULL, but inserting a SubLink into a non-Query expression 
 * will then cause an error. 
 * 
 * Note: the business with inserted_sublink is needed to update hasSubLinks 
 * in subqueries when the replacement adds a subquery inside a subquery. 
 * Messy, isn't it?  We do not need to do similar pushups for hasAggs, 
 * because it isn't possible for this transformation to insert a level-zero 
 * aggregate reference into a subquery --- it could only insert outer aggs. 
 * Likewise for hasWindowFuncs. 
 * 
 * Note: usually, we'd not expose the mutator function or context struct 
 * for a function like this.  We do so because callbacks often find it 
 * convenient to recurse directly to the mutator on sub-expressions of 
 * what they will return. 
 */ 
</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>* 
</span><a name="LN1083"></a><span class='Declare_Function'>replace_rte_variables</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>target_varno</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>sublevels_up</span><span class='Delimiter'>, 
</span><a name="LN1084"></a>                      <a href="../../include/rewrite/rewriteManip.h.html#LN21"><span class='Ref_to_Typedef'>replace_rte_variables_callback</span></a> <span class='Declare_Parameter'>callback</span><span class='Delimiter'>, 
</span><a name="LN1085"></a>                      <span class='Keyword'>void </span><span class='Operator'>*</span><span class='Declare_Parameter'>callback_arg</span><span class='Delimiter'>, 
</span><a name="LN1086"></a>                      <span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>outer_hasSubLinks</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1088"></a>    <a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1089"></a>    <a href="../../include/rewrite/rewriteManip.h.html#LN24"><span class='Ref_to_Struct'>replace_rte_variables_context</span></a> <span class='Declare_Local'>context</span><span class='Delimiter'>; 
</span> 
    <a href="rewriteManip.c.html#LN1089"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="../../include/rewrite/rewriteManip.h.html#LN26"><span class='Ref_to_Member'>callback</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN1084"><span class='Ref_to_Parameter'>callback</span></a><span class='Delimiter'>; 
</span>    <a href="rewriteManip.c.html#LN1089"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="../../include/rewrite/rewriteManip.h.html#LN27"><span class='Ref_to_Member'>callback_arg</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN1085"><span class='Ref_to_Parameter'>callback_arg</span></a><span class='Delimiter'>; 
</span>    <a href="rewriteManip.c.html#LN1089"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="../../include/rewrite/rewriteManip.h.html#LN28"><span class='Ref_to_Member'>target_varno</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN1083"><span class='Ref_to_Parameter'>target_varno</span></a><span class='Delimiter'>; 
</span>    <a href="rewriteManip.c.html#LN1089"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="../../include/rewrite/rewriteManip.h.html#LN29"><span class='Ref_to_Member'>sublevels_up</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN1083"><span class='Ref_to_Parameter'>sublevels_up</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We try to initialize inserted_sublink to true if there is no need to 
     * detect new sublinks because the query already has some. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1083"><span class='Ref_to_Parameter'>node</span></a> <span class='Operator'>&& </span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1083"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a><span class='Parentheses'>))</span> 
        <a href="rewriteManip.c.html#LN1089"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="../../include/rewrite/rewriteManip.h.html#LN30"><span class='Ref_to_Member'>inserted_sublink</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN1083"><span class='Ref_to_Parameter'>node</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>hasSubLinks<span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1086"><span class='Ref_to_Parameter'>outer_hasSubLinks</span></a><span class='Parentheses'>) 
</span>        <a href="rewriteManip.c.html#LN1089"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="../../include/rewrite/rewriteManip.h.html#LN30"><span class='Ref_to_Member'>inserted_sublink</span></a> <span class='Operator'>= *</span><a href="rewriteManip.c.html#LN1086"><span class='Ref_to_Parameter'>outer_hasSubLinks</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="rewriteManip.c.html#LN1089"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="../../include/rewrite/rewriteManip.h.html#LN30"><span class='Ref_to_Member'>inserted_sublink</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Must be prepared to start with a Query or a bare expression tree; if 
     * it's a Query, we don't want to increment sublevels_up. 
     */ 
</span>    <a href="rewriteManip.c.html#LN1088"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodeFuncs.h.html#LN69"><span class='Ref_to_Proto'>query_or_expression_tree_mutator</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1083"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, 
</span>                                              <a href="../../include/rewrite/rewriteManip.h.html#LN68"><span class='Ref_to_Proto'>replace_rte_variables_mutator</span></a><span class='Delimiter'>, 
</span>                                              <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="rewriteManip.c.html#LN1089"><span class='Ref_To_Local'>context</span></a><span class='Delimiter'>, 
</span>                                              <span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1089"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="../../include/rewrite/rewriteManip.h.html#LN30"><span class='Ref_to_Member'>inserted_sublink</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1088"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>&& </span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1088"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a><span class='Parentheses'>))</span> 
            <span class='Parentheses'>((</span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN1088"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>hasSubLinks <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1086"><span class='Ref_to_Parameter'>outer_hasSubLinks</span></a><span class='Parentheses'>) 
</span>            <span class='Operator'>*</span><a href="rewriteManip.c.html#LN1086"><span class='Ref_to_Parameter'>outer_hasSubLinks</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"replace_rte_variables inserted a SubLink, but has noplace to record it"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="rewriteManip.c.html#LN1088"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end replace_rte_variables &raquo; </span> 
 
<a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>* 
</span><a name="LN1130"></a><span class='Declare_Function'>replace_rte_variables_mutator</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, 
</span><a name="LN1131"></a>                              <a href="../../include/rewrite/rewriteManip.h.html#LN24"><span class='Ref_to_Struct'>replace_rte_variables_context</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1130"><span class='Ref_to_Parameter'>node</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1130"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1137"></a>        <a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>var</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN1130"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1137"><span class='Ref_To_Local'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN165"><span class='Ref_to_Member'>varno</span></a> <span class='Operator'>== </span><a href="rewriteManip.c.html#LN1131"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../../include/rewrite/rewriteManip.h.html#LN28"><span class='Ref_to_Member'>target_varno</span></a> <span class='Operator'>&& 
</span>            <a href="rewriteManip.c.html#LN1137"><span class='Ref_To_Local'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN172"><span class='Ref_to_Member'>varlevelsup</span></a> <span class='Operator'>== </span><a href="rewriteManip.c.html#LN1131"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../../include/rewrite/rewriteManip.h.html#LN29"><span class='Ref_to_Member'>sublevels_up</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Found a matching variable, make the substitution */ 
</span><a name="LN1143"></a>            <a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>newnode</span><span class='Delimiter'>; 
</span> 
            <a href="rewriteManip.c.html#LN1143"><span class='Ref_To_Local'>newnode</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="rewriteManip.c.html#LN1131"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../../include/rewrite/rewriteManip.h.html#LN26"><span class='Ref_to_Member'>callback</span></a><span class='Parentheses'>) (</span><a href="rewriteManip.c.html#LN1137"><span class='Ref_To_Local'>var</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN1131"><span class='Ref_to_Parameter'>context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* Detect if we are adding a sublink to query */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="rewriteManip.c.html#LN1131"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../../include/rewrite/rewriteManip.h.html#LN30"><span class='Ref_to_Member'>inserted_sublink</span></a><span class='Parentheses'>) 
</span>                <a href="rewriteManip.c.html#LN1131"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../../include/rewrite/rewriteManip.h.html#LN30"><span class='Ref_to_Member'>inserted_sublink</span></a> <span class='Operator'>= </span><a href="../../include/rewrite/rewriteManip.h.html#LN61"><span class='Ref_to_Proto'>checkExprHasSubLink</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1143"><span class='Ref_To_Local'>newnode</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <a href="rewriteManip.c.html#LN1143"><span class='Ref_To_Local'>newnode</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Comment_Multi_Line'>/* otherwise fall through to copy the var normally */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1130"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN1272"><span class='Ref_to_Struct'>CurrentOfExpr</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1155"></a>        <a href="../../include/nodes/primnodes.h.html#LN1272"><span class='Ref_to_Struct'>CurrentOfExpr</span></a> <span class='Operator'>*</span><span class='Declare_Local'>cexpr</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN1272"><span class='Ref_to_Struct'>CurrentOfExpr</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN1130"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1155"><span class='Ref_To_Local'>cexpr</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1275"><span class='Ref_to_Member'>cvarno</span></a> <span class='Operator'>== </span><a href="rewriteManip.c.html#LN1131"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../../include/rewrite/rewriteManip.h.html#LN28"><span class='Ref_to_Member'>target_varno</span></a> <span class='Operator'>&& 
</span>            <a href="rewriteManip.c.html#LN1131"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../../include/rewrite/rewriteManip.h.html#LN29"><span class='Ref_to_Member'>sublevels_up</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * We get here if a WHERE CURRENT OF expression turns out to apply 
             * to a view.  Someday we might be able to translate the 
             * expression to apply to an underlying table of the view, but 
             * right now it's not implemented. 
             */ 
</span>            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                   <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"WHERE CURRENT OF on a view is not implemented"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Comment_Multi_Line'>/* otherwise fall through to copy the expr normally */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1130"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Recurse into RTE subquery or not-yet-planned sublink subquery */ 
</span><a name="LN1175"></a>        <a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>newnode</span><span class='Delimiter'>; 
</span><a name="LN1176"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>save_inserted_sublink</span><span class='Delimiter'>; 
</span> 
        <a href="rewriteManip.c.html#LN1131"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../../include/rewrite/rewriteManip.h.html#LN29"><span class='Ref_to_Member'>sublevels_up</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN1176"><span class='Ref_To_Local'>save_inserted_sublink</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN1131"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../../include/rewrite/rewriteManip.h.html#LN30"><span class='Ref_to_Member'>inserted_sublink</span></a><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN1131"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../../include/rewrite/rewriteManip.h.html#LN30"><span class='Ref_to_Member'>inserted_sublink</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN1130"><span class='Ref_to_Parameter'>node</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>hasSubLinks<span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN1175"><span class='Ref_To_Local'>newnode</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodeFuncs.h.html#LN59"><span class='Ref_to_Proto'>query_tree_mutator</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN1130"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, 
</span>                                     <a href="../../include/rewrite/rewriteManip.h.html#LN68"><span class='Ref_to_Proto'>replace_rte_variables_mutator</span></a><span class='Delimiter'>, 
</span>                                     <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN1131"><span class='Ref_to_Parameter'>context</span></a><span class='Delimiter'>, 
</span>                                     <span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN1175"><span class='Ref_To_Local'>newnode</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/parsenodes.h.html#LN125"><span class='Ref_to_Member'>hasSubLinks</span></a> <span class='Operator'>|= </span><a href="rewriteManip.c.html#LN1131"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../../include/rewrite/rewriteManip.h.html#LN30"><span class='Ref_to_Member'>inserted_sublink</span></a><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN1131"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../../include/rewrite/rewriteManip.h.html#LN30"><span class='Ref_to_Member'>inserted_sublink</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN1176"><span class='Ref_To_Local'>save_inserted_sublink</span></a><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN1131"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../../include/rewrite/rewriteManip.h.html#LN29"><span class='Ref_to_Member'>sublevels_up</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN1175"><span class='Ref_To_Local'>newnode</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="../../include/nodes/nodeFuncs.h.html#LN54"><span class='Ref_to_Proto'>expression_tree_mutator</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1130"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/rewrite/rewriteManip.h.html#LN68"><span class='Ref_to_Proto'>replace_rte_variables_mutator</span></a><span class='Delimiter'>, 
</span>                                   <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN1131"><span class='Ref_to_Parameter'>context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end replace_rte_variables_mutator &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * map_variable_attnos() finds all user-column Vars in an expression tree 
 * that reference a particular RTE, and adjusts their varattnos according 
 * to the given mapping array (varattno n is replaced by attno_map[n-1]). 
 * Vars for system columns are not modified. 
 * 
 * A zero in the mapping array represents a dropped column, which should not 
 * appear in the expression. 
 * 
 * If the expression tree contains a whole-row Var for the target RTE, 
 * the Var is not changed but *found_whole_row is returned as TRUE. 
 * For most callers this is an error condition, but we leave it to the caller 
 * to report the error so that useful context can be provided.  (In some 
 * usages it would be appropriate to modify the Var's vartype and insert a 
 * ConvertRowtypeExpr node to map back to the original vartype.  We might 
 * someday extend this function's API to support that.  For now, the only 
 * concession to that future need is that this function is a tree mutator 
 * not just a walker.) 
 * 
 * This could be built using replace_rte_variables and a callback function, 
 * but since we don't ever need to insert sublinks, replace_rte_variables is 
 * overly complicated. 
 */ 
</span> 
<span class='Control'>typedef</span> <span class='Control'>struct</span> 
<span class='Delimiter'>{ 
</span><a name="LN1221"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>target_varno</span><span class='Delimiter'>;</span>   <span class='Comment_Single_Line'>/* RTE index to search for */ 
</span><a name="LN1222"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>sublevels_up</span><span class='Delimiter'>;</span>   <span class='Comment_Single_Line'>/* (current) nesting depth */ 
</span><a name="LN1223"></a>    <span class='Keyword'>const </span><a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Member'>attno_map</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* map array for user attnos */ 
</span><a name="LN1224"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>map_length</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* number of entries in attno_map[] */ 
</span><a name="LN1225"></a>    <span class='Keyword'>bool</span>       <span class='Operator'>*</span><span class='Declare_Member'>found_whole_row</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* output flag */ 
</span><a name="LN1226"></a><span class='Delimiter'>} </span><span class='Declare_Typedef'>map_variable_attnos_context</span><span class='Delimiter'>; 
</span> 
<span class='Keyword'>static </span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>* 
</span><a name="LN1229"></a><span class='Declare_Function'>map_variable_attnos_mutator</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, 
</span><a name="LN1230"></a>                            <a href="rewriteManip.c.html#LN1219"><span class='Ref_to_Typedef'>map_variable_attnos_context</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1229"><span class='Ref_to_Parameter'>node</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1229"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1236"></a>        <a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>var</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN1229"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1236"><span class='Ref_To_Local'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN165"><span class='Ref_to_Member'>varno</span></a> <span class='Operator'>== </span><a href="rewriteManip.c.html#LN1230"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN1221"><span class='Ref_to_Member'>target_varno</span></a> <span class='Operator'>&& 
</span>            <a href="rewriteManip.c.html#LN1236"><span class='Ref_To_Local'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN172"><span class='Ref_to_Member'>varlevelsup</span></a> <span class='Operator'>== </span><a href="rewriteManip.c.html#LN1230"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN1222"><span class='Ref_to_Member'>sublevels_up</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Found a matching variable, make the substitution */ 
</span><a name="LN1242"></a>            <a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>newvar</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span><a name="LN1243"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>attno</span> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN1236"><span class='Ref_To_Local'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN167"><span class='Ref_to_Member'>varattno</span></a><span class='Delimiter'>; 
</span> 
            <span class='Operator'>*</span><a href="rewriteManip.c.html#LN1242"><span class='Ref_To_Local'>newvar</span></a> <span class='Operator'>= *</span><a href="rewriteManip.c.html#LN1236"><span class='Ref_To_Local'>var</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1243"><span class='Ref_To_Local'>attno</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* user-defined column, replace attno */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1243"><span class='Ref_To_Local'>attno</span></a> <span class='Operator'>&GT; </span><a href="rewriteManip.c.html#LN1230"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN1224"><span class='Ref_to_Member'>map_length</span></a> <span class='Operator'>|| 
</span>                    <a href="rewriteManip.c.html#LN1230"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN1223"><span class='Ref_to_Member'>attno_map</span></a><span class='Delimiter'>[</span><a href="rewriteManip.c.html#LN1243"><span class='Ref_To_Local'>attno</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                    <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unexpected varattno %d in expression to be mapped"</span><span class='Delimiter'>, 
</span>                         <a href="rewriteManip.c.html#LN1243"><span class='Ref_To_Local'>attno</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="rewriteManip.c.html#LN1242"><span class='Ref_To_Local'>newvar</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN167"><span class='Ref_to_Member'>varattno</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN1242"><span class='Ref_To_Local'>newvar</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN176"><span class='Ref_to_Member'>varoattno</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN1230"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN1223"><span class='Ref_to_Member'>attno_map</span></a><span class='Delimiter'>[</span><a href="rewriteManip.c.html#LN1243"><span class='Ref_To_Local'>attno</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1243"><span class='Ref_To_Local'>attno</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* whole-row variable, warn caller */ 
</span>                <span class='Operator'>*</span><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1230"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN1225"><span class='Ref_to_Member'>found_whole_row</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN1242"><span class='Ref_To_Local'>newvar</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if var-&GT;varno==context-&GT;... &raquo; </span> 
        <span class='Comment_Multi_Line'>/* otherwise fall through to copy the var normally */ 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if IsA(node,Var) &raquo; </span> 
    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1229"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Recurse into RTE subquery or not-yet-planned sublink subquery */ 
</span><a name="LN1267"></a>        <a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>newnode</span><span class='Delimiter'>; 
</span> 
        <a href="rewriteManip.c.html#LN1230"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN1222"><span class='Ref_to_Member'>sublevels_up</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN1267"><span class='Ref_To_Local'>newnode</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodeFuncs.h.html#LN59"><span class='Ref_to_Proto'>query_tree_mutator</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/parsenodes.h.html#LN105"><span class='Ref_to_Struct'>Query</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN1229"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, 
</span>                                     <a href="rewriteManip.c.html#LN1228"><span class='Ref_to_Func'>map_variable_attnos_mutator</span></a><span class='Delimiter'>, 
</span>                                     <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN1230"><span class='Ref_to_Parameter'>context</span></a><span class='Delimiter'>, 
</span>                                     <span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN1230"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN1222"><span class='Ref_to_Member'>sublevels_up</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN1267"><span class='Ref_To_Local'>newnode</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="../../include/nodes/nodeFuncs.h.html#LN54"><span class='Ref_to_Proto'>expression_tree_mutator</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1229"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN1228"><span class='Ref_to_Func'>map_variable_attnos_mutator</span></a><span class='Delimiter'>, 
</span>                                   <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN1230"><span class='Ref_to_Parameter'>context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end map_variable_attnos_mutator &raquo; </span> 
 
<a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>* 
</span><a name="LN1282"></a><span class='Declare_Function'>map_variable_attnos</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, 
</span><a name="LN1283"></a>                    <span class='Keyword'>int </span><span class='Declare_Parameter'>target_varno</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>sublevels_up</span><span class='Delimiter'>, 
</span><a name="LN1284"></a>                    <span class='Keyword'>const </span><a href="../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>attno_map</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>map_length</span><span class='Delimiter'>, 
</span><a name="LN1285"></a>                    <span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>found_whole_row</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1287"></a>    <a href="rewriteManip.c.html#LN1219"><span class='Ref_to_Typedef'>map_variable_attnos_context</span></a> <span class='Declare_Local'>context</span><span class='Delimiter'>; 
</span> 
    <a href="rewriteManip.c.html#LN1287"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN1221"><span class='Ref_to_Member'>target_varno</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN1283"><span class='Ref_to_Parameter'>target_varno</span></a><span class='Delimiter'>; 
</span>    <a href="rewriteManip.c.html#LN1287"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN1222"><span class='Ref_to_Member'>sublevels_up</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN1283"><span class='Ref_to_Parameter'>sublevels_up</span></a><span class='Delimiter'>; 
</span>    <a href="rewriteManip.c.html#LN1287"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN1223"><span class='Ref_to_Member'>attno_map</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN1284"><span class='Ref_to_Parameter'>attno_map</span></a><span class='Delimiter'>; 
</span>    <a href="rewriteManip.c.html#LN1287"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN1224"><span class='Ref_to_Member'>map_length</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN1284"><span class='Ref_to_Parameter'>map_length</span></a><span class='Delimiter'>; 
</span>    <a href="rewriteManip.c.html#LN1287"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN1225"><span class='Ref_to_Member'>found_whole_row</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN1285"><span class='Ref_to_Parameter'>found_whole_row</span></a><span class='Delimiter'>; 
</span> 
    <span class='Operator'>*</span><a href="rewriteManip.c.html#LN1285"><span class='Ref_to_Parameter'>found_whole_row</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Must be prepared to start with a Query or a bare expression tree; if 
     * it's a Query, we don't want to increment sublevels_up. 
     */ 
</span>    <span class='Control'>return</span> <a href="../../include/nodes/nodeFuncs.h.html#LN69"><span class='Ref_to_Proto'>query_or_expression_tree_mutator</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1282"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, 
</span>                                            <a href="rewriteManip.c.html#LN1228"><span class='Ref_to_Func'>map_variable_attnos_mutator</span></a><span class='Delimiter'>, 
</span>                                            <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="rewriteManip.c.html#LN1287"><span class='Ref_To_Local'>context</span></a><span class='Delimiter'>, 
</span>                                            <span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end map_variable_attnos &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * ReplaceVarsFromTargetList - replace Vars with items from a targetlist 
 * 
 * Vars matching target_varno and sublevels_up are replaced by the 
 * entry with matching resno from targetlist, if there is one. 
 * 
 * If there is no matching resno for such a Var, the action depends on the 
 * nomatch_option: 
 *  REPLACEVARS_REPORT_ERROR: throw an error 
 *  REPLACEVARS_CHANGE_VARNO: change Var's varno to nomatch_varno 
 *  REPLACEVARS_SUBSTITUTE_NULL: replace Var with a NULL Const of same type 
 * 
 * The caller must also provide target_rte, the RTE describing the target 
 * relation.  This is needed to handle whole-row Vars referencing the target. 
 * We expand such Vars into RowExpr constructs. 
 * 
 * outer_hasSubLinks works the same as for replace_rte_variables(). 
 */ 
</span> 
<span class='Control'>typedef</span> <span class='Control'>struct</span> 
<span class='Delimiter'>{ 
</span><a name="LN1329"></a>    <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Member'>target_rte</span><span class='Delimiter'>; 
</span><a name="LN1330"></a>    <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Member'>targetlist</span><span class='Delimiter'>; 
</span><a name="LN1331"></a>    <a href="../../include/rewrite/rewriteManip.h.html#LN33"><span class='Ref_to_Enum'>ReplaceVarsNoMatchOption</span></a> <span class='Declare_Member'>nomatch_option</span><span class='Delimiter'>; 
</span><a name="LN1332"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>nomatch_varno</span><span class='Delimiter'>; 
</span><a name="LN1333"></a>} <span class='Declare_Typedef'>ReplaceVarsFromTargetList_context</span><span class='Delimiter'>; 
</span> 
<span class='Keyword'>static </span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>* 
</span><a name="LN1336"></a><span class='Declare_Function'>ReplaceVarsFromTargetList_callback</span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>var</span><span class='Delimiter'>, 
</span><a name="LN1337"></a>                                   <a href="../../include/rewrite/rewriteManip.h.html#LN24"><span class='Ref_to_Struct'>replace_rte_variables_context</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1339"></a>    <a href="rewriteManip.c.html#LN1327"><span class='Ref_to_Typedef'>ReplaceVarsFromTargetList_context</span></a> <span class='Operator'>*</span><span class='Declare_Local'>rcon</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1327"><span class='Ref_to_Typedef'>ReplaceVarsFromTargetList_context</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN1337"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../../include/rewrite/rewriteManip.h.html#LN27"><span class='Ref_to_Member'>callback_arg</span></a><span class='Delimiter'>; 
</span><a name="LN1340"></a>    <a href="../../include/nodes/primnodes.h.html#LN1363"><span class='Ref_to_Struct'>TargetEntry</span></a> <span class='Operator'>*</span><span class='Declare_Local'>tle</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1336"><span class='Ref_to_Parameter'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN167"><span class='Ref_to_Member'>varattno</span></a> <span class='Operator'>== </span><a href="../../include/access/attnum.h.html#LN22"><span class='Ref_to_Const'>InvalidAttrNumber</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Must expand whole-tuple reference into RowExpr */ 
</span><a name="LN1345"></a>        <a href="../../include/nodes/primnodes.h.html#LN981"><span class='Ref_to_Struct'>RowExpr</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>rowexpr</span><span class='Delimiter'>; 
</span><a name="LN1346"></a>        <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>colnames</span><span class='Delimiter'>; 
</span><a name="LN1347"></a>        <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>fields</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If generating an expansion for a var of a named rowtype (ie, this 
         * is a plain relation RTE), then we must include dummy items for 
         * dropped columns.  If the var is RECORD (ie, this is a JOIN), then 
         * omit dropped columns.  Either way, attach column names to the 
         * RowExpr for use of ruleutils.c. 
         */ 
</span>        <a href="../../include/parser/parse_relation.h.html#LN120"><span class='Ref_to_Proto'>expandRTE</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1339"><span class='Ref_To_Local'>rcon</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN1329"><span class='Ref_to_Member'>target_rte</span></a><span class='Delimiter'>, 
</span>                  <a href="rewriteManip.c.html#LN1336"><span class='Ref_to_Parameter'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN165"><span class='Ref_to_Member'>varno</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN1336"><span class='Ref_to_Parameter'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN172"><span class='Ref_to_Member'>varlevelsup</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN1336"><span class='Ref_to_Parameter'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN177"><span class='Ref_to_Member'>location</span></a><span class='Delimiter'>, 
</span>                  <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1336"><span class='Ref_to_Parameter'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN169"><span class='Ref_to_Member'>vartype</span></a> <span class='Operator'>!= </span><a href="../../include/catalog/pg_type.h.html#LN679"><span class='Ref_to_Const'>RECORDOID</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                  <span class='Operator'>&</span><a href="rewriteManip.c.html#LN1346"><span class='Ref_To_Local'>colnames</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="rewriteManip.c.html#LN1347"><span class='Ref_To_Local'>fields</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* Adjust the generated per-field Vars... */ 
</span>        <a href="rewriteManip.c.html#LN1347"><span class='Ref_To_Local'>fields</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/rewrite/rewriteManip.h.html#LN68"><span class='Ref_to_Proto'>replace_rte_variables_mutator</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN1347"><span class='Ref_To_Local'>fields</span></a><span class='Delimiter'>, 
</span>                                                        <a href="rewriteManip.c.html#LN1337"><span class='Ref_to_Parameter'>context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN1345"><span class='Ref_To_Local'>rowexpr</span></a> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN556"><span class='Ref_to_Macro'>makeNode</span></a><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN981"><span class='Ref_to_Struct'>RowExpr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN1345"><span class='Ref_To_Local'>rowexpr</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN984"><span class='Ref_to_Member'>args</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN1347"><span class='Ref_To_Local'>fields</span></a><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN1345"><span class='Ref_To_Local'>rowexpr</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN985"><span class='Ref_to_Member'>row_typeid</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN1336"><span class='Ref_to_Parameter'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN169"><span class='Ref_to_Member'>vartype</span></a><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN1345"><span class='Ref_To_Local'>rowexpr</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN996"><span class='Ref_to_Member'>row_format</span></a> <span class='Operator'>= </span><a href="../../include/nodes/primnodes.h.html#LN438"><span class='Ref_to_EnumConst'>COERCE_IMPLICIT_CAST</span></a><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN1345"><span class='Ref_To_Local'>rowexpr</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN997"><span class='Ref_to_Member'>colnames</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN1346"><span class='Ref_To_Local'>colnames</span></a><span class='Delimiter'>; 
</span>        <a href="rewriteManip.c.html#LN1345"><span class='Ref_To_Local'>rowexpr</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN998"><span class='Ref_to_Member'>location</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN1336"><span class='Ref_to_Parameter'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN177"><span class='Ref_to_Member'>location</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN1345"><span class='Ref_To_Local'>rowexpr</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if var-&GT;varattno==Invali... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Normal case referencing one targetlist element */ 
</span>    <a href="rewriteManip.c.html#LN1340"><span class='Ref_To_Local'>tle</span></a> <span class='Operator'>= </span><a href="../../include/parser/parsetree.h.html#LN69"><span class='Ref_to_Proto'>get_tle_by_resno</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1339"><span class='Ref_To_Local'>rcon</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN1330"><span class='Ref_to_Member'>targetlist</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN1336"><span class='Ref_to_Parameter'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN167"><span class='Ref_to_Member'>varattno</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1340"><span class='Ref_To_Local'>tle</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span><a href="rewriteManip.c.html#LN1340"><span class='Ref_To_Local'>tle</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1373"><span class='Ref_to_Member'>resjunk</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Failed to find column in targetlist */ 
</span>        <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1339"><span class='Ref_To_Local'>rcon</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN1331"><span class='Ref_to_Member'>nomatch_option</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>case</span> <a href="../../include/rewrite/rewriteManip.h.html#LN35"><span class='Ref_to_EnumConst'>REPLACEVARS_REPORT_ERROR</span></a><span class='Operator'>: 
</span>                <span class='Comment_Multi_Line'>/* fall through, throw error below */ 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../include/rewrite/rewriteManip.h.html#LN36"><span class='Ref_to_EnumConst'>REPLACEVARS_CHANGE_VARNO</span></a><span class='Operator'>: 
</span>                <a href="rewriteManip.c.html#LN1336"><span class='Ref_to_Parameter'>var</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/nodes/primnodes.h.html#LN162"><span class='Ref_to_Struct'>Var</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/nodes.h.html#LN618"><span class='Ref_to_Macro'>copyObject</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1336"><span class='Ref_to_Parameter'>var</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="rewriteManip.c.html#LN1336"><span class='Ref_to_Parameter'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN165"><span class='Ref_to_Member'>varno</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN1339"><span class='Ref_To_Local'>rcon</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN1332"><span class='Ref_to_Member'>nomatch_varno</span></a><span class='Delimiter'>; 
</span>                <a href="rewriteManip.c.html#LN1336"><span class='Ref_to_Parameter'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN175"><span class='Ref_to_Member'>varnoold</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN1339"><span class='Ref_To_Local'>rcon</span></a><span class='Operator'>-&GT;</span><a href="rewriteManip.c.html#LN1332"><span class='Ref_to_Member'>nomatch_varno</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN1336"><span class='Ref_to_Parameter'>var</span></a><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../include/rewrite/rewriteManip.h.html#LN37"><span class='Ref_to_EnumConst'>REPLACEVARS_SUBSTITUTE_NULL</span></a><span class='Operator'>: 
</span> 
                <span class='Comment_Multi_Line'>/* 
                 * If Var is of domain type, we should add a CoerceToDomain 
                 * node, in case there is a NOT NULL domain constraint. 
                 */ 
</span>                <span class='Control'>return</span> <a href="../../include/parser/parse_coerce.h.html#LN48"><span class='Ref_to_Proto'>coerce_to_domain</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/nodes/makefuncs.h.html#LN57"><span class='Ref_to_Proto'>makeNullConst</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1336"><span class='Ref_to_Parameter'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN169"><span class='Ref_to_Member'>vartype</span></a><span class='Delimiter'>, 
</span>                                                               <a href="rewriteManip.c.html#LN1336"><span class='Ref_to_Parameter'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN170"><span class='Ref_to_Member'>vartypmod</span></a><span class='Delimiter'>, 
</span>                                                             <a href="rewriteManip.c.html#LN1336"><span class='Ref_to_Parameter'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN171"><span class='Ref_to_Member'>varcollid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                        <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, 
</span>                                        <a href="rewriteManip.c.html#LN1336"><span class='Ref_to_Parameter'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN169"><span class='Ref_to_Member'>vartype</span></a><span class='Delimiter'>, 
</span>                                        <a href="../../include/nodes/primnodes.h.html#LN438"><span class='Ref_to_EnumConst'>COERCE_IMPLICIT_CAST</span></a><span class='Delimiter'>, 
</span>                                        <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, 
</span>                                        <span class='Boolean'>false</span><span class='Delimiter'>, 
</span>                                        <span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch rcon-&GT;nomatch_option &raquo; </span> 
        <a href="../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"could not find replacement targetlist entry for attno %d"</span><span class='Delimiter'>, 
</span>             <a href="rewriteManip.c.html#LN1336"><span class='Ref_to_Parameter'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN167"><span class='Ref_to_Member'>varattno</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>            <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if tle==NULL||tle-&GT;resju... &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Make a copy of the tlist item to return */ 
</span><a name="LN1414"></a>        <a href="../../include/nodes/primnodes.h.html#LN131"><span class='Ref_to_Struct'>Expr</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>newnode</span> <span class='Operator'>= </span><a href="../../include/nodes/nodes.h.html#LN618"><span class='Ref_to_Macro'>copyObject</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1340"><span class='Ref_To_Local'>tle</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN1366"><span class='Ref_to_Member'>expr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Must adjust varlevelsup if tlist item is from higher query */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1336"><span class='Ref_to_Parameter'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN172"><span class='Ref_to_Member'>varlevelsup</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="../../include/rewrite/rewriteManip.h.html#LN44"><span class='Ref_to_Proto'>IncrementVarSublevelsUp</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN1414"><span class='Ref_To_Local'>newnode</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN1336"><span class='Ref_to_Parameter'>var</span></a><span class='Operator'>-&GT;</span><a href="../../include/nodes/primnodes.h.html#LN172"><span class='Ref_to_Member'>varlevelsup</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Check to see if the tlist item contains a PARAM_MULTIEXPR Param, 
         * and throw error if so.  This case could only happen when expanding 
         * an ON UPDATE rule's NEW variable and the referenced tlist item in 
         * the original UPDATE command is part of a multiple assignment. There 
         * seems no practical way to handle such cases without multiple 
         * evaluation of the multiple assignment's sub-select, which would 
         * create semantic oddities that users of rules would probably prefer 
         * not to cope with.  So treat it as an unimplemented feature. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN304"><span class='Ref_to_Func'>contains_multiexpr_param</span></a><span class='Parentheses'>((</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN1414"><span class='Ref_To_Local'>newnode</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>))</span> 
            <a href="../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"NEW variables in ON UPDATE rules cannot reference columns that are part of a multiple assignment in the subject UPDATE command"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="rewriteManip.c.html#LN1414"><span class='Ref_To_Local'>newnode</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end ReplaceVarsFromTargetList_callback &raquo; </span> 
 
<a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>* 
</span><a name="LN1440"></a><span class='Declare_Function'>ReplaceVarsFromTargetList</span><span class='Parentheses'>(</span><a href="../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>node</span><span class='Delimiter'>, 
</span><a name="LN1441"></a>                          <span class='Keyword'>int </span><span class='Declare_Parameter'>target_varno</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>sublevels_up</span><span class='Delimiter'>, 
</span><a name="LN1442"></a>                          <a href="../../include/nodes/parsenodes.h.html#LN932"><span class='Ref_to_Struct'>RangeTblEntry</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>target_rte</span><span class='Delimiter'>, 
</span><a name="LN1443"></a>                          <a href="../../include/nodes/pg_list.h.html#LN44"><span class='Ref_to_Struct'>List</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>targetlist</span><span class='Delimiter'>, 
</span><a name="LN1444"></a>                          <a href="../../include/rewrite/rewriteManip.h.html#LN33"><span class='Ref_to_Enum'>ReplaceVarsNoMatchOption</span></a> <span class='Declare_Parameter'>nomatch_option</span><span class='Delimiter'>, 
</span><a name="LN1445"></a>                          <span class='Keyword'>int </span><span class='Declare_Parameter'>nomatch_varno</span><span class='Delimiter'>, 
</span><a name="LN1446"></a>                          <span class='Keyword'>bool </span><span class='Operator'>*</span><span class='Declare_Parameter'>outer_hasSubLinks</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1448"></a>    <a href="rewriteManip.c.html#LN1327"><span class='Ref_to_Typedef'>ReplaceVarsFromTargetList_context</span></a> <span class='Declare_Local'>context</span><span class='Delimiter'>; 
</span> 
    <a href="rewriteManip.c.html#LN1448"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN1329"><span class='Ref_to_Member'>target_rte</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN1442"><span class='Ref_to_Parameter'>target_rte</span></a><span class='Delimiter'>; 
</span>    <a href="rewriteManip.c.html#LN1448"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN1330"><span class='Ref_to_Member'>targetlist</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN1443"><span class='Ref_to_Parameter'>targetlist</span></a><span class='Delimiter'>; 
</span>    <a href="rewriteManip.c.html#LN1448"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN1331"><span class='Ref_to_Member'>nomatch_option</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN1444"><span class='Ref_to_Parameter'>nomatch_option</span></a><span class='Delimiter'>; 
</span>    <a href="rewriteManip.c.html#LN1448"><span class='Ref_To_Local'>context</span></a><span class='Operator'>.</span><a href="rewriteManip.c.html#LN1332"><span class='Ref_to_Member'>nomatch_varno</span></a> <span class='Operator'>= </span><a href="rewriteManip.c.html#LN1445"><span class='Ref_to_Parameter'>nomatch_varno</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="../../include/rewrite/rewriteManip.h.html#LN63"><span class='Ref_to_Proto'>replace_rte_variables</span></a><span class='Parentheses'>(</span><a href="rewriteManip.c.html#LN1440"><span class='Ref_to_Parameter'>node</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN1441"><span class='Ref_to_Parameter'>target_varno</span></a><span class='Delimiter'>, </span><a href="rewriteManip.c.html#LN1441"><span class='Ref_to_Parameter'>sublevels_up</span></a><span class='Delimiter'>, 
</span>                                 <a href="rewriteManip.c.html#LN1335"><span class='Ref_to_Func'>ReplaceVarsFromTargetList_callback</span></a><span class='Delimiter'>, 
</span>                                 <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="rewriteManip.c.html#LN1448"><span class='Ref_To_Local'>context</span></a><span class='Delimiter'>, 
</span>                                 <a href="rewriteManip.c.html#LN1446"><span class='Ref_to_Parameter'>outer_hasSubLinks</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end ReplaceVarsFromTargetList &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>