<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\backend\utils\adt\cash.c</title>
<LINK REL=StyleSheet HREF="../../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\backend\utils\adt\cash.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:50 2017
</td></tr>
<tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
</span><span class='Comment_Multi_Line'>/* 
 * cash.c 
 * Written by D'Arcy J.M. Cain 
 * darcy@druid.net 
 * http://www.druid.net/darcy/ 
 * 
 * Functions to allow input and output of money normally but store 
 * and handle it as 64 bit ints 
 * 
 * A slightly modified version of this file and a discussion of the 
 * workings can be found in the book "Software Solutions in C" by 
 * Dale Schumacher, Academic Press, ISBN: 0-12-632360-7 except that 
 * this version handles 64 bit numbers and so can hold values up to 
 * $92,233,720,368,547,758.07. 
 * 
 * src/backend/utils/adt/cash.c 
 */ 
</span> 
<span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>&LT;limits.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;ctype.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;math.h&GT;</span> 
 
<span class='Keyword'>#include </span><span class='String'>"libpq/pqformat.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/builtins.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/cash.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/int8.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/numeric.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/pg_locale.h"</span> 
 
 
<span class='Comment_Multi_Line'>/************************************************************************* 
 * Private routines 
 ************************************************************************/ 
</span> 
<span class='Keyword'>static const char </span><span class='Operator'>* 
</span><a name="LN37"></a><span class='Declare_Function'>num_word</span><span class='Parentheses'>(</span><a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a> <span class='Declare_Parameter'>value</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN39"></a>    <span class='Keyword'>static char </span><span class='Declare_Local'>buf</span><span class='Delimiter'>[</span><span class='Number'>128</span><span class='Delimiter'>]; 
</span><a name="LN40"></a>    <span class='Keyword'>static const char </span><span class='Operator'>*</span><span class='Declare_Local'>small</span><span class='Delimiter'>[] </span><span class='Operator'>= </span><span class='Delimiter'>{ 
</span>        <span class='String'>"zero"</span><span class='Delimiter'>, </span><span class='String'>"one"</span><span class='Delimiter'>, </span><span class='String'>"two"</span><span class='Delimiter'>, </span><span class='String'>"three"</span><span class='Delimiter'>, </span><span class='String'>"four"</span><span class='Delimiter'>, </span><span class='String'>"five"</span><span class='Delimiter'>, </span><span class='String'>"six"</span><span class='Delimiter'>, </span><span class='String'>"seven"</span><span class='Delimiter'>, 
</span>        <span class='String'>"eight"</span><span class='Delimiter'>, </span><span class='String'>"nine"</span><span class='Delimiter'>, </span><span class='String'>"ten"</span><span class='Delimiter'>, </span><span class='String'>"eleven"</span><span class='Delimiter'>, </span><span class='String'>"twelve"</span><span class='Delimiter'>, </span><span class='String'>"thirteen"</span><span class='Delimiter'>, </span><span class='String'>"fourteen"</span><span class='Delimiter'>, 
</span>        <span class='String'>"fifteen"</span><span class='Delimiter'>, </span><span class='String'>"sixteen"</span><span class='Delimiter'>, </span><span class='String'>"seventeen"</span><span class='Delimiter'>, </span><span class='String'>"eighteen"</span><span class='Delimiter'>, </span><span class='String'>"nineteen"</span><span class='Delimiter'>, </span><span class='String'>"twenty"</span><span class='Delimiter'>, 
</span>        <span class='String'>"thirty"</span><span class='Delimiter'>, </span><span class='String'>"forty"</span><span class='Delimiter'>, </span><span class='String'>"fifty"</span><span class='Delimiter'>, </span><span class='String'>"sixty"</span><span class='Delimiter'>, </span><span class='String'>"seventy"</span><span class='Delimiter'>, </span><span class='String'>"eighty"</span><span class='Delimiter'>, </span><span class='String'>"ninety"</span> 
    <span class='Delimiter'>}; 
</span><a name="LN46"></a>    <span class='Keyword'>const char </span><span class='Operator'>**</span><span class='Declare_Local'>big</span> <span class='Operator'>= </span><a href="cash.c.html#LN40"><span class='Ref_To_Local'>small</span></a> <span class='Operator'>+ </span><span class='Number'>18</span><span class='Delimiter'>; 
</span><a name="LN47"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>tu</span> <span class='Operator'>= </span><span class='Keyword'>value </span><span class='Operator'>% </span><span class='Number'>100</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* deal with the simple cases first */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>value </span><span class='Operator'>&LT;= </span><span class='Number'>20</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="cash.c.html#LN40"><span class='Ref_To_Local'>small</span></a><span class='Delimiter'>[</span><span class='Keyword'>value</span><span class='Delimiter'>]; 
</span> 
    <span class='Comment_Multi_Line'>/* is it an even multiple of 100? */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="cash.c.html#LN47"><span class='Ref_To_Local'>tu</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="../../../include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN39"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>"%s hundred"</span><span class='Delimiter'>, </span><a href="cash.c.html#LN40"><span class='Ref_To_Local'>small</span></a><span class='Delimiter'>[</span><span class='Keyword'>value </span><span class='Operator'>/ </span><span class='Number'>100</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="cash.c.html#LN39"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* more than 99? */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>value </span><span class='Operator'>&GT; </span><span class='Number'>99</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* is it an even multiple of 10 other than 10? */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>value </span><span class='Operator'>% </span><span class='Number'>10</span> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="cash.c.html#LN47"><span class='Ref_To_Local'>tu</span></a> <span class='Operator'>&GT; </span><span class='Number'>10</span><span class='Parentheses'>) 
</span>            <a href="../../../include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN39"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>"%s hundred %s"</span><span class='Delimiter'>, 
</span>                    <a href="cash.c.html#LN40"><span class='Ref_To_Local'>small</span></a><span class='Delimiter'>[</span><span class='Keyword'>value </span><span class='Operator'>/ </span><span class='Number'>100</span><span class='Delimiter'>], </span><a href="cash.c.html#LN46"><span class='Ref_To_Local'>big</span></a><span class='Delimiter'>[</span><a href="cash.c.html#LN47"><span class='Ref_To_Local'>tu</span></a> <span class='Operator'>/ </span><span class='Number'>10</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN47"><span class='Ref_To_Local'>tu</span></a> <span class='Operator'>&LT; </span><span class='Number'>20</span><span class='Parentheses'>) 
</span>            <a href="../../../include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN39"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>"%s hundred and %s"</span><span class='Delimiter'>, 
</span>                    <a href="cash.c.html#LN40"><span class='Ref_To_Local'>small</span></a><span class='Delimiter'>[</span><span class='Keyword'>value </span><span class='Operator'>/ </span><span class='Number'>100</span><span class='Delimiter'>], </span><a href="cash.c.html#LN40"><span class='Ref_To_Local'>small</span></a><span class='Delimiter'>[</span><a href="cash.c.html#LN47"><span class='Ref_To_Local'>tu</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="../../../include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN39"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>"%s hundred %s %s"</span><span class='Delimiter'>, 
</span>                    <a href="cash.c.html#LN40"><span class='Ref_To_Local'>small</span></a><span class='Delimiter'>[</span><span class='Keyword'>value </span><span class='Operator'>/ </span><span class='Number'>100</span><span class='Delimiter'>], </span><a href="cash.c.html#LN46"><span class='Ref_To_Local'>big</span></a><span class='Delimiter'>[</span><a href="cash.c.html#LN47"><span class='Ref_To_Local'>tu</span></a> <span class='Operator'>/ </span><span class='Number'>10</span><span class='Delimiter'>], </span><a href="cash.c.html#LN40"><span class='Ref_To_Local'>small</span></a><span class='Delimiter'>[</span><a href="cash.c.html#LN47"><span class='Ref_To_Local'>tu</span></a> <span class='Operator'>% </span><span class='Number'>10</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* is it an even multiple of 10 other than 10? */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>value </span><span class='Operator'>% </span><span class='Number'>10</span> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="cash.c.html#LN47"><span class='Ref_To_Local'>tu</span></a> <span class='Operator'>&GT; </span><span class='Number'>10</span><span class='Parentheses'>) 
</span>            <a href="../../../include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN39"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>"%s"</span><span class='Delimiter'>, </span><a href="cash.c.html#LN46"><span class='Ref_To_Local'>big</span></a><span class='Delimiter'>[</span><a href="cash.c.html#LN47"><span class='Ref_To_Local'>tu</span></a> <span class='Operator'>/ </span><span class='Number'>10</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN47"><span class='Ref_To_Local'>tu</span></a> <span class='Operator'>&LT; </span><span class='Number'>20</span><span class='Parentheses'>) 
</span>            <a href="../../../include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN39"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>"%s"</span><span class='Delimiter'>, </span><a href="cash.c.html#LN40"><span class='Ref_To_Local'>small</span></a><span class='Delimiter'>[</span><a href="cash.c.html#LN47"><span class='Ref_To_Local'>tu</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="../../../include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN39"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>"%s %s"</span><span class='Delimiter'>, </span><a href="cash.c.html#LN46"><span class='Ref_To_Local'>big</span></a><span class='Delimiter'>[</span><a href="cash.c.html#LN47"><span class='Ref_To_Local'>tu</span></a> <span class='Operator'>/ </span><span class='Number'>10</span><span class='Delimiter'>], </span><a href="cash.c.html#LN40"><span class='Ref_To_Local'>small</span></a><span class='Delimiter'>[</span><a href="cash.c.html#LN47"><span class='Ref_To_Local'>tu</span></a> <span class='Operator'>% </span><span class='Number'>10</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="cash.c.html#LN39"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end num_word &raquo; </span>   <span class='Comment_Single_Line'>/* num_word() */ 
</span> 
<span class='Comment_Multi_Line'>/* cash_in() 
 * Convert a string to a cash data type. 
 * Format is [$]###[,]###[.##] 
 * Examples: 123.45 $123.45 $123,456.78 
 * 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN95"></a><span class='Declare_Function'>cash_in</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN97"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>str</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN241"><span class='Ref_to_Macro'>PG_GETARG_CSTRING</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN98"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN99"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>value</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN100"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>dec</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN101"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>sgn</span> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span><a name="LN102"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>seen_dot</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN103"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>s</span> <span class='Operator'>= </span><a href="cash.c.html#LN97"><span class='Ref_To_Local'>str</span></a><span class='Delimiter'>; 
</span><a name="LN104"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>fpoint</span><span class='Delimiter'>; 
</span><a name="LN105"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>dsymbol</span><span class='Delimiter'>; 
</span><a name="LN106"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>ssymbol</span><span class='Delimiter'>, 
</span><a name="LN107"></a>               <span class='Operator'>*</span><span class='Declare_Local'>psymbol</span><span class='Delimiter'>, 
</span><a name="LN108"></a>               <span class='Operator'>*</span><span class='Declare_Local'>nsymbol</span><span class='Delimiter'>, 
</span><a name="LN109"></a>               <span class='Operator'>*</span><span class='Declare_Local'>csymbol</span><span class='Delimiter'>; 
</span><a name="LN110"></a>    <span class='Control'>struct</span> lconv <span class='Operator'>*</span><span class='Declare_Local'>lconvert</span> <span class='Operator'>= </span><a href="../../../include/utils/pg_locale.h.html#LN57"><span class='Ref_to_Proto'>PGLC_localeconv</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * frac_digits will be CHAR_MAX in some locales, notably C.  However, just 
     * testing for == CHAR_MAX is risky, because of compilers like gcc that 
     * "helpfully" let you alter the platform-standard definition of whether 
     * char is signed or not.  If we are so unfortunate as to get compiled 
     * with a nonstandard -fsigned-char or -funsigned-char switch, then our 
     * idea of CHAR_MAX will not agree with libc's. The safest course is not 
     * to test for CHAR_MAX at all, but to impose a range check for plausible 
     * frac_digits values. 
     */ 
</span>    <a href="cash.c.html#LN104"><span class='Ref_To_Local'>fpoint</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN110"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>frac_digits<span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN104"><span class='Ref_To_Local'>fpoint</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="cash.c.html#LN104"><span class='Ref_To_Local'>fpoint</span></a> <span class='Operator'>&GT; </span><span class='Number'>10</span><span class='Parentheses'>) 
</span>        <a href="cash.c.html#LN104"><span class='Ref_To_Local'>fpoint</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>;</span>             <span class='Comment_Single_Line'>/* best guess in this case, I think */ 
</span> 
    <span class='Comment_Multi_Line'>/* we restrict dsymbol to be a single byte, but not the other symbols */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="cash.c.html#LN110"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>mon_decimal_point <span class='Operator'>!= </span><span class='String'>'\0'</span> <span class='Operator'>&& 
</span>        <a href="cash.c.html#LN110"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>mon_decimal_point<span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>        <a href="cash.c.html#LN105"><span class='Ref_To_Local'>dsymbol</span></a> <span class='Operator'>= *</span><a href="cash.c.html#LN110"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>mon_decimal_point<span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="cash.c.html#LN105"><span class='Ref_To_Local'>dsymbol</span></a> <span class='Operator'>= </span><span class='String'>'.'</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="cash.c.html#LN110"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>mon_thousands_sep <span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>        <a href="cash.c.html#LN106"><span class='Ref_To_Local'>ssymbol</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN110"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>mon_thousands_sep<span class='Delimiter'>; 
</span>    <span class='Control'>else</span>    <span class='Comment_Single_Line'>/* ssymbol should not equal dsymbol */ 
</span>        <a href="cash.c.html#LN106"><span class='Ref_To_Local'>ssymbol</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="cash.c.html#LN105"><span class='Ref_To_Local'>dsymbol</span></a> <span class='Operator'>!= </span><span class='String'>','</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='String'>","</span> <span class='Operator'>: </span><span class='String'>"."</span><span class='Delimiter'>; 
</span>    <a href="cash.c.html#LN109"><span class='Ref_To_Local'>csymbol</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="cash.c.html#LN110"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>currency_symbol <span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="cash.c.html#LN110"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>currency_symbol <span class='Operator'>: </span><span class='String'>"$"</span><span class='Delimiter'>; 
</span>    <a href="cash.c.html#LN107"><span class='Ref_To_Local'>psymbol</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="cash.c.html#LN110"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>positive_sign <span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="cash.c.html#LN110"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>positive_sign <span class='Operator'>: </span><span class='String'>"+"</span><span class='Delimiter'>; 
</span>    <a href="cash.c.html#LN108"><span class='Ref_To_Local'>nsymbol</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="cash.c.html#LN110"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>negative_sign <span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="cash.c.html#LN110"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>negative_sign <span class='Operator'>: </span><span class='String'>"-"</span><span class='Delimiter'>; 
</span> 
<span class='Directive'>#ifdef</span> CASHDEBUG 
    <a href="../../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span><span class='String'>"cashin- precision '%d'; decimal '%c'; thousands '%s'; currency '%s'; positive '%s'; negative '%s'\n"</span><span class='Delimiter'>, 
</span>           <a href="cash.c.html#LN104"><span class='Ref_To_Local'>fpoint</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN105"><span class='Ref_To_Local'>dsymbol</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN106"><span class='Ref_To_Local'>ssymbol</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN109"><span class='Ref_To_Local'>csymbol</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN107"><span class='Ref_To_Local'>psymbol</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN108"><span class='Ref_To_Local'>nsymbol</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
 
    <span class='Comment_Multi_Line'>/* we need to add all sorts of checking here.  For now just */ 
</span>    <span class='Comment_Multi_Line'>/* strip all leading whitespace and any leading currency symbol */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span>isspace<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>))</span> 
        <a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>strncmp<span class='Parentheses'>(</span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN109"><span class='Ref_To_Local'>csymbol</span></a><span class='Delimiter'>, </span>strlen<span class='Parentheses'>(</span><a href="cash.c.html#LN109"><span class='Ref_To_Local'>csymbol</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>+= </span>strlen<span class='Parentheses'>(</span><a href="cash.c.html#LN109"><span class='Ref_To_Local'>csymbol</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span>isspace<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>))</span> 
        <a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span> 
<span class='Directive'>#ifdef</span> CASHDEBUG 
    <a href="../../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span><span class='String'>"cashin- string is '%s'\n"</span><span class='Delimiter'>, </span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
 
    <span class='Comment_Multi_Line'>/* a leading minus or paren signifies a negative number */ 
</span>    <span class='Comment_Multi_Line'>/* again, better heuristics needed */ 
</span>    <span class='Comment_Multi_Line'>/* XXX - doesn't properly check for balanced parens - djmc */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>strncmp<span class='Parentheses'>(</span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN108"><span class='Ref_To_Local'>nsymbol</span></a><span class='Delimiter'>, </span>strlen<span class='Parentheses'>(</span><a href="cash.c.html#LN108"><span class='Ref_To_Local'>nsymbol</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="cash.c.html#LN101"><span class='Ref_To_Local'>sgn</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>+= </span>strlen<span class='Parentheses'>(</span><a href="cash.c.html#LN108"><span class='Ref_To_Local'>nsymbol</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>== </span><span class='String'>'('</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="cash.c.html#LN101"><span class='Ref_To_Local'>sgn</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strncmp<span class='Parentheses'>(</span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN107"><span class='Ref_To_Local'>psymbol</span></a><span class='Delimiter'>, </span>strlen<span class='Parentheses'>(</span><a href="cash.c.html#LN107"><span class='Ref_To_Local'>psymbol</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>+= </span>strlen<span class='Parentheses'>(</span><a href="cash.c.html#LN107"><span class='Ref_To_Local'>psymbol</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Directive'>#ifdef</span> CASHDEBUG 
    <a href="../../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span><span class='String'>"cashin- string is '%s'\n"</span><span class='Delimiter'>, </span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
 
    <span class='Comment_Multi_Line'>/* allow whitespace and currency symbol after the sign, too */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span>isspace<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>))</span> 
        <a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>strncmp<span class='Parentheses'>(</span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN109"><span class='Ref_To_Local'>csymbol</span></a><span class='Delimiter'>, </span>strlen<span class='Parentheses'>(</span><a href="cash.c.html#LN109"><span class='Ref_To_Local'>csymbol</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>+= </span>strlen<span class='Parentheses'>(</span><a href="cash.c.html#LN109"><span class='Ref_To_Local'>csymbol</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span>isspace<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>))</span> 
        <a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span> 
<span class='Directive'>#ifdef</span> CASHDEBUG 
    <a href="../../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span><span class='String'>"cashin- string is '%s'\n"</span><span class='Delimiter'>, </span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
 
    <span class='Comment_Multi_Line'>/* 
     * We accumulate the absolute amount in "value" and then apply the sign at 
     * the end.  (The sign can appear before or after the digits, so it would 
     * be more complicated to do otherwise.)  Because of the larger range of 
     * negative signed integers, we build "value" in the negative and then 
     * flip the sign at the end, catching most-negative-number overflow if 
     * necessary. 
     */ 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>; </span><span class='Operator'>*</span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Delimiter'>; </span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* we look for digits as long as we have found less */ 
</span>        <span class='Comment_Multi_Line'>/* than the required number of decimal places */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>isdigit<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>)</span> <span class='Operator'>&& </span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="cash.c.html#LN102"><span class='Ref_To_Local'>seen_dot</span></a> <span class='Operator'>|| </span><a href="cash.c.html#LN100"><span class='Ref_To_Local'>dec</span></a> <span class='Operator'>&LT; </span><a href="cash.c.html#LN104"><span class='Ref_To_Local'>fpoint</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN205"></a>            <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>newvalue</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>value </span><span class='Operator'>* </span><span class='Number'>10</span><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>- </span><span class='String'>'0'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN205"><span class='Ref_To_Local'>newvalue</span></a> <span class='Operator'>/ </span><span class='Number'>10</span> <span class='Operator'>!= </span><span class='Keyword'>value</span><span class='Parentheses'>) 
</span>                <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_NUMERIC_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"value \"%s\" is out of range for type %s"</span><span class='Delimiter'>, 
</span>                                <a href="cash.c.html#LN97"><span class='Ref_To_Local'>str</span></a><span class='Delimiter'>, </span><span class='String'>"money"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
            <span class='Keyword'>value </span><span class='Operator'>= </span><a href="cash.c.html#LN205"><span class='Ref_To_Local'>newvalue</span></a><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN102"><span class='Ref_To_Local'>seen_dot</span></a><span class='Parentheses'>) 
</span>                <a href="cash.c.html#LN100"><span class='Ref_To_Local'>dec</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Comment_Multi_Line'>/* decimal point? then start counting fractions... */ 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>== </span><a href="cash.c.html#LN105"><span class='Ref_To_Local'>dsymbol</span></a> <span class='Operator'>&& !</span><a href="cash.c.html#LN102"><span class='Ref_To_Local'>seen_dot</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="cash.c.html#LN102"><span class='Ref_To_Local'>seen_dot</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Comment_Multi_Line'>/* ignore if "thousands" separator, else we're done */ 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strncmp<span class='Parentheses'>(</span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN106"><span class='Ref_To_Local'>ssymbol</span></a><span class='Delimiter'>, </span>strlen<span class='Parentheses'>(</span><a href="cash.c.html#LN106"><span class='Ref_To_Local'>ssymbol</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>+= </span>strlen<span class='Parentheses'>(</span><a href="cash.c.html#LN106"><span class='Ref_To_Local'>ssymbol</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for ;*s;s++ &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* round off if there's another digit */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>isdigit<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>)</span> <span class='Operator'>&& *</span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>&GT;= </span><span class='String'>'5'</span><span class='Parentheses'>)</span> 
        <span class='Keyword'>value</span><span class='Operator'>--</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* remember we build the value in the negative */ 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>value </span><span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_NUMERIC_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"value \"%s\" is out of range for type %s"</span><span class='Delimiter'>, 
</span>                        <a href="cash.c.html#LN97"><span class='Ref_To_Local'>str</span></a><span class='Delimiter'>, </span><span class='String'>"money"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* adjust for less than required decimal places */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>; </span><a href="cash.c.html#LN100"><span class='Ref_To_Local'>dec</span></a> <span class='Operator'>&LT; </span><a href="cash.c.html#LN104"><span class='Ref_To_Local'>fpoint</span></a><span class='Delimiter'>; </span><a href="cash.c.html#LN100"><span class='Ref_To_Local'>dec</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN243"></a>        <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>newvalue</span> <span class='Operator'>= </span><span class='Keyword'>value </span><span class='Operator'>* </span><span class='Number'>10</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN243"><span class='Ref_To_Local'>newvalue</span></a> <span class='Operator'>/ </span><span class='Number'>10</span> <span class='Operator'>!= </span><span class='Keyword'>value</span><span class='Parentheses'>) 
</span>            <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_NUMERIC_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"value \"%s\" is out of range for type %s"</span><span class='Delimiter'>, 
</span>                            <a href="cash.c.html#LN97"><span class='Ref_To_Local'>str</span></a><span class='Delimiter'>, </span><span class='String'>"money"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Keyword'>value </span><span class='Operator'>= </span><a href="cash.c.html#LN243"><span class='Ref_To_Local'>newvalue</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * should only be trailing digits followed by whitespace, right paren, 
     * trailing sign, and/or trailing currency symbol 
     */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span>isdigit<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>))</span> 
        <a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>isspace<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>)</span> <span class='Operator'>|| *</span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>== </span><span class='String'>')'</span><span class='Parentheses'>)</span> 
            <a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strncmp<span class='Parentheses'>(</span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN108"><span class='Ref_To_Local'>nsymbol</span></a><span class='Delimiter'>, </span>strlen<span class='Parentheses'>(</span><a href="cash.c.html#LN108"><span class='Ref_To_Local'>nsymbol</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="cash.c.html#LN101"><span class='Ref_To_Local'>sgn</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>+= </span>strlen<span class='Parentheses'>(</span><a href="cash.c.html#LN108"><span class='Ref_To_Local'>nsymbol</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strncmp<span class='Parentheses'>(</span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN107"><span class='Ref_To_Local'>psymbol</span></a><span class='Delimiter'>, </span>strlen<span class='Parentheses'>(</span><a href="cash.c.html#LN107"><span class='Ref_To_Local'>psymbol</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>+= </span>strlen<span class='Parentheses'>(</span><a href="cash.c.html#LN107"><span class='Ref_To_Local'>psymbol</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strncmp<span class='Parentheses'>(</span><a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN109"><span class='Ref_To_Local'>csymbol</span></a><span class='Delimiter'>, </span>strlen<span class='Parentheses'>(</span><a href="cash.c.html#LN109"><span class='Ref_To_Local'>csymbol</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="cash.c.html#LN103"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>+= </span>strlen<span class='Parentheses'>(</span><a href="cash.c.html#LN109"><span class='Ref_To_Local'>csymbol</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_TEXT_REPRESENTATION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"invalid input syntax for type %s: \"%s\""</span><span class='Delimiter'>, 
</span>                            <span class='String'>"money"</span><span class='Delimiter'>, </span><a href="cash.c.html#LN97"><span class='Ref_To_Local'>str</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If the value is supposed to be positive, flip the sign, but check for 
     * the most negative number. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN101"><span class='Ref_To_Local'>sgn</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="cash.c.html#LN98"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= -</span><span class='Keyword'>value</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN98"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_NUMERIC_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"value \"%s\" is out of range for type %s"</span><span class='Delimiter'>, 
</span>                            <a href="cash.c.html#LN97"><span class='Ref_To_Local'>str</span></a><span class='Delimiter'>, </span><span class='String'>"money"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
        <a href="cash.c.html#LN98"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Keyword'>value</span><span class='Delimiter'>; 
</span> 
<span class='Directive'>#ifdef</span> CASHDEBUG 
    <a href="../../../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a><span class='Parentheses'>(</span><span class='String'>"cashin- result is "</span> <a href="../../../include/c.h.html#LN314"><span class='Ref_to_Const'>INT64_FORMAT</span></a> <span class='String'>"\n"</span><span class='Delimiter'>, </span><a href="cash.c.html#LN98"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
 
    <a href="../../../include/utils/cash.h.html#LN22"><span class='Ref_to_Macro'>PG_RETURN_CASH</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN98"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end cash_in &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* cash_out() 
 * Function to convert cash to a dollars and cents representation, using 
 * the lc_monetary locale's formatting. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN310"></a><span class='Declare_Function'>cash_out</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN312"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>value</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN313"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN314"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>buf</span><span class='Delimiter'>[</span><span class='Number'>128</span><span class='Delimiter'>]; 
</span><a name="LN315"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>bufptr</span><span class='Delimiter'>; 
</span><a name="LN316"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>digit_pos</span><span class='Delimiter'>; 
</span><a name="LN317"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>points</span><span class='Delimiter'>, 
</span><a name="LN318"></a>                <span class='Declare_Local'>mon_group</span><span class='Delimiter'>; 
</span><a name="LN319"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>dsymbol</span><span class='Delimiter'>; 
</span><a name="LN320"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>ssymbol</span><span class='Delimiter'>, 
</span><a name="LN321"></a>               <span class='Operator'>*</span><span class='Declare_Local'>csymbol</span><span class='Delimiter'>, 
</span><a name="LN322"></a>               <span class='Operator'>*</span><span class='Declare_Local'>signsymbol</span><span class='Delimiter'>; 
</span><a name="LN323"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>sign_posn</span><span class='Delimiter'>, 
</span><a name="LN324"></a>                <span class='Declare_Local'>cs_precedes</span><span class='Delimiter'>, 
</span><a name="LN325"></a>                <span class='Declare_Local'>sep_by_space</span><span class='Delimiter'>; 
</span><a name="LN326"></a>    <span class='Control'>struct</span> lconv <span class='Operator'>*</span><span class='Declare_Local'>lconvert</span> <span class='Operator'>= </span><a href="../../../include/utils/pg_locale.h.html#LN57"><span class='Ref_to_Proto'>PGLC_localeconv</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* see comments about frac_digits in cash_in() */ 
</span>    <a href="cash.c.html#LN317"><span class='Ref_To_Local'>points</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN326"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>frac_digits<span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN317"><span class='Ref_To_Local'>points</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="cash.c.html#LN317"><span class='Ref_To_Local'>points</span></a> <span class='Operator'>&GT; </span><span class='Number'>10</span><span class='Parentheses'>) 
</span>        <a href="cash.c.html#LN317"><span class='Ref_To_Local'>points</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>;</span>             <span class='Comment_Single_Line'>/* best guess in this case, I think */ 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * As with frac_digits, must apply a range check to mon_grouping to avoid 
     * being fooled by variant CHAR_MAX values. 
     */ 
</span>    <a href="cash.c.html#LN318"><span class='Ref_To_Local'>mon_group</span></a> <span class='Operator'>= *</span><a href="cash.c.html#LN326"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>mon_grouping<span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN318"><span class='Ref_To_Local'>mon_group</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="cash.c.html#LN318"><span class='Ref_To_Local'>mon_group</span></a> <span class='Operator'>&GT; </span><span class='Number'>6</span><span class='Parentheses'>) 
</span>        <a href="cash.c.html#LN318"><span class='Ref_To_Local'>mon_group</span></a> <span class='Operator'>= </span><span class='Number'>3</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* we restrict dsymbol to be a single byte, but not the other symbols */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="cash.c.html#LN326"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>mon_decimal_point <span class='Operator'>!= </span><span class='String'>'\0'</span> <span class='Operator'>&& 
</span>        <a href="cash.c.html#LN326"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>mon_decimal_point<span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>        <a href="cash.c.html#LN319"><span class='Ref_To_Local'>dsymbol</span></a> <span class='Operator'>= *</span><a href="cash.c.html#LN326"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>mon_decimal_point<span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="cash.c.html#LN319"><span class='Ref_To_Local'>dsymbol</span></a> <span class='Operator'>= </span><span class='String'>'.'</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="cash.c.html#LN326"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>mon_thousands_sep <span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>        <a href="cash.c.html#LN320"><span class='Ref_To_Local'>ssymbol</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN326"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>mon_thousands_sep<span class='Delimiter'>; 
</span>    <span class='Control'>else</span>    <span class='Comment_Single_Line'>/* ssymbol should not equal dsymbol */ 
</span>        <a href="cash.c.html#LN320"><span class='Ref_To_Local'>ssymbol</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="cash.c.html#LN319"><span class='Ref_To_Local'>dsymbol</span></a> <span class='Operator'>!= </span><span class='String'>','</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='String'>","</span> <span class='Operator'>: </span><span class='String'>"."</span><span class='Delimiter'>; 
</span>    <a href="cash.c.html#LN321"><span class='Ref_To_Local'>csymbol</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="cash.c.html#LN326"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>currency_symbol <span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="cash.c.html#LN326"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>currency_symbol <span class='Operator'>: </span><span class='String'>"$"</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>value </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* make the amount positive for digit-reconstruction loop */ 
</span>        <span class='Keyword'>value </span><span class='Operator'>= -</span><span class='Keyword'>value</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* set up formatting data */ 
</span>        <a href="cash.c.html#LN322"><span class='Ref_To_Local'>signsymbol</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="cash.c.html#LN326"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>negative_sign <span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="cash.c.html#LN326"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>negative_sign <span class='Operator'>: </span><span class='String'>"-"</span><span class='Delimiter'>; 
</span>        <a href="cash.c.html#LN323"><span class='Ref_To_Local'>sign_posn</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN326"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>n_sign_posn<span class='Delimiter'>; 
</span>        <a href="cash.c.html#LN324"><span class='Ref_To_Local'>cs_precedes</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN326"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>n_cs_precedes<span class='Delimiter'>; 
</span>        <a href="cash.c.html#LN325"><span class='Ref_To_Local'>sep_by_space</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN326"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>n_sep_by_space<span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="cash.c.html#LN322"><span class='Ref_To_Local'>signsymbol</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN326"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>positive_sign<span class='Delimiter'>; 
</span>        <a href="cash.c.html#LN323"><span class='Ref_To_Local'>sign_posn</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN326"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>p_sign_posn<span class='Delimiter'>; 
</span>        <a href="cash.c.html#LN324"><span class='Ref_To_Local'>cs_precedes</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN326"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>p_cs_precedes<span class='Delimiter'>; 
</span>        <a href="cash.c.html#LN325"><span class='Ref_To_Local'>sep_by_space</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN326"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>p_sep_by_space<span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* we build the digits+decimal-point+sep string right-to-left in buf[] */ 
</span>    <a href="cash.c.html#LN315"><span class='Ref_To_Local'>bufptr</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN314"><span class='Ref_To_Local'>buf</span></a> <span class='Operator'>+ </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="cash.c.html#LN314"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="cash.c.html#LN315"><span class='Ref_To_Local'>bufptr</span></a> <span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Generate digits till there are no non-zero digits left and we emitted 
     * at least one to the left of the decimal point.  digit_pos is the 
     * current digit position, with zero as the digit just left of the decimal 
     * point, increasing to the right. 
     */ 
</span>    <a href="cash.c.html#LN316"><span class='Ref_To_Local'>digit_pos</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN317"><span class='Ref_To_Local'>points</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>do</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN317"><span class='Ref_To_Local'>points</span></a> <span class='Operator'>&& </span><a href="cash.c.html#LN316"><span class='Ref_To_Local'>digit_pos</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* insert decimal point, but not if value cannot be fractional */ 
</span>            <span class='Operator'>*</span><span class='Parentheses'>(</span><span class='Operator'>--</span><a href="cash.c.html#LN315"><span class='Ref_To_Local'>bufptr</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="cash.c.html#LN319"><span class='Ref_To_Local'>dsymbol</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN316"><span class='Ref_To_Local'>digit_pos</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="cash.c.html#LN316"><span class='Ref_To_Local'>digit_pos</span></a> <span class='Operator'>% </span><a href="cash.c.html#LN318"><span class='Ref_To_Local'>mon_group</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* insert thousands sep, but only to left of radix point */ 
</span>            <a href="cash.c.html#LN315"><span class='Ref_To_Local'>bufptr</span></a> <span class='Operator'>-= </span>strlen<span class='Parentheses'>(</span><a href="cash.c.html#LN320"><span class='Ref_To_Local'>ssymbol</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            memcpy<span class='Parentheses'>(</span><a href="cash.c.html#LN315"><span class='Ref_To_Local'>bufptr</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN320"><span class='Ref_To_Local'>ssymbol</span></a><span class='Delimiter'>, </span>strlen<span class='Parentheses'>(</span><a href="cash.c.html#LN320"><span class='Ref_To_Local'>ssymbol</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Operator'>*</span><span class='Parentheses'>(</span><span class='Operator'>--</span><a href="cash.c.html#LN315"><span class='Ref_To_Local'>bufptr</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><span class='Parentheses'>((</span><a href="../../../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a><span class='Parentheses'>) </span><span class='Keyword'>value </span><span class='Operator'>% </span><span class='Number'>10</span><span class='Parentheses'>)</span> <span class='Operator'>+ </span><span class='String'>'0'</span><span class='Delimiter'>; 
</span>        <span class='Keyword'>value </span><span class='Operator'>= </span><span class='Parentheses'>((</span><a href="../../../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a><span class='Parentheses'>) </span><span class='Keyword'>value</span><span class='Parentheses'>)</span> <span class='Operator'>/ </span><span class='Number'>10</span><span class='Delimiter'>; 
</span>        <a href="cash.c.html#LN316"><span class='Ref_To_Local'>digit_pos</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} </span><span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Keyword'>value </span><span class='Operator'>|| </span><a href="cash.c.html#LN316"><span class='Ref_To_Local'>digit_pos</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/*---------- 
     * Now, attach currency symbol and sign symbol in the correct order. 
     * 
     * The POSIX spec defines these values controlling this code: 
     * 
     * p/n_sign_posn: 
     *  0   Parentheses enclose the quantity and the currency_symbol. 
     *  1   The sign string precedes the quantity and the currency_symbol. 
     *  2   The sign string succeeds the quantity and the currency_symbol. 
     *  3   The sign string precedes the currency_symbol. 
     *  4   The sign string succeeds the currency_symbol. 
     * 
     * p/n_cs_precedes: 0 means currency symbol after value, else before it. 
     * 
     * p/n_sep_by_space: 
     *  0   No &LT;space&GT; separates the currency symbol and value. 
     *  1   If the currency symbol and sign string are adjacent, a &LT;space&GT; 
     *      separates them from the value; otherwise, a &LT;space&GT; separates 
     *      the currency symbol from the value. 
     *  2   If the currency symbol and sign string are adjacent, a &LT;space&GT; 
     *      separates them; otherwise, a &LT;space&GT; separates the sign string 
     *      from the value. 
     *---------- 
     */ 
</span>    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN323"><span class='Ref_To_Local'>sign_posn</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <span class='Number'>0</span><span class='Operator'>: 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN324"><span class='Ref_To_Local'>cs_precedes</span></a><span class='Parentheses'>) 
</span>                <a href="cash.c.html#LN313"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../common/psprintf.c.html#LN44"><span class='Ref_to_Func'>psprintf</span></a><span class='Parentheses'>(</span><span class='String'>"(%s%s%s)"</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN321"><span class='Ref_To_Local'>csymbol</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><a href="cash.c.html#LN325"><span class='Ref_To_Local'>sep_by_space</span></a> <span class='Operator'>== </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='String'>" "</span> <span class='Operator'>: </span><span class='String'>""</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN315"><span class='Ref_To_Local'>bufptr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="cash.c.html#LN313"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../common/psprintf.c.html#LN44"><span class='Ref_to_Func'>psprintf</span></a><span class='Parentheses'>(</span><span class='String'>"(%s%s%s)"</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN315"><span class='Ref_To_Local'>bufptr</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><a href="cash.c.html#LN325"><span class='Ref_To_Local'>sep_by_space</span></a> <span class='Operator'>== </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='String'>" "</span> <span class='Operator'>: </span><span class='String'>""</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN321"><span class='Ref_To_Local'>csymbol</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <span class='Number'>1</span><span class='Operator'>: 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN324"><span class='Ref_To_Local'>cs_precedes</span></a><span class='Parentheses'>) 
</span>                <a href="cash.c.html#LN313"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../common/psprintf.c.html#LN44"><span class='Ref_to_Func'>psprintf</span></a><span class='Parentheses'>(</span><span class='String'>"%s%s%s%s%s"</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN322"><span class='Ref_To_Local'>signsymbol</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><a href="cash.c.html#LN325"><span class='Ref_To_Local'>sep_by_space</span></a> <span class='Operator'>== </span><span class='Number'>2</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='String'>" "</span> <span class='Operator'>: </span><span class='String'>""</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN321"><span class='Ref_To_Local'>csymbol</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><a href="cash.c.html#LN325"><span class='Ref_To_Local'>sep_by_space</span></a> <span class='Operator'>== </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='String'>" "</span> <span class='Operator'>: </span><span class='String'>""</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN315"><span class='Ref_To_Local'>bufptr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="cash.c.html#LN313"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../common/psprintf.c.html#LN44"><span class='Ref_to_Func'>psprintf</span></a><span class='Parentheses'>(</span><span class='String'>"%s%s%s%s%s"</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN322"><span class='Ref_To_Local'>signsymbol</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><a href="cash.c.html#LN325"><span class='Ref_To_Local'>sep_by_space</span></a> <span class='Operator'>== </span><span class='Number'>2</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='String'>" "</span> <span class='Operator'>: </span><span class='String'>""</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN315"><span class='Ref_To_Local'>bufptr</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><a href="cash.c.html#LN325"><span class='Ref_To_Local'>sep_by_space</span></a> <span class='Operator'>== </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='String'>" "</span> <span class='Operator'>: </span><span class='String'>""</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN321"><span class='Ref_To_Local'>csymbol</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <span class='Number'>2</span><span class='Operator'>: 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN324"><span class='Ref_To_Local'>cs_precedes</span></a><span class='Parentheses'>) 
</span>                <a href="cash.c.html#LN313"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../common/psprintf.c.html#LN44"><span class='Ref_to_Func'>psprintf</span></a><span class='Parentheses'>(</span><span class='String'>"%s%s%s%s%s"</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN321"><span class='Ref_To_Local'>csymbol</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><a href="cash.c.html#LN325"><span class='Ref_To_Local'>sep_by_space</span></a> <span class='Operator'>== </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='String'>" "</span> <span class='Operator'>: </span><span class='String'>""</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN315"><span class='Ref_To_Local'>bufptr</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><a href="cash.c.html#LN325"><span class='Ref_To_Local'>sep_by_space</span></a> <span class='Operator'>== </span><span class='Number'>2</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='String'>" "</span> <span class='Operator'>: </span><span class='String'>""</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN322"><span class='Ref_To_Local'>signsymbol</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="cash.c.html#LN313"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../common/psprintf.c.html#LN44"><span class='Ref_to_Func'>psprintf</span></a><span class='Parentheses'>(</span><span class='String'>"%s%s%s%s%s"</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN315"><span class='Ref_To_Local'>bufptr</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><a href="cash.c.html#LN325"><span class='Ref_To_Local'>sep_by_space</span></a> <span class='Operator'>== </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='String'>" "</span> <span class='Operator'>: </span><span class='String'>""</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN321"><span class='Ref_To_Local'>csymbol</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><a href="cash.c.html#LN325"><span class='Ref_To_Local'>sep_by_space</span></a> <span class='Operator'>== </span><span class='Number'>2</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='String'>" "</span> <span class='Operator'>: </span><span class='String'>""</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN322"><span class='Ref_To_Local'>signsymbol</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <span class='Number'>3</span><span class='Operator'>: 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN324"><span class='Ref_To_Local'>cs_precedes</span></a><span class='Parentheses'>) 
</span>                <a href="cash.c.html#LN313"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../common/psprintf.c.html#LN44"><span class='Ref_to_Func'>psprintf</span></a><span class='Parentheses'>(</span><span class='String'>"%s%s%s%s%s"</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN322"><span class='Ref_To_Local'>signsymbol</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><a href="cash.c.html#LN325"><span class='Ref_To_Local'>sep_by_space</span></a> <span class='Operator'>== </span><span class='Number'>2</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='String'>" "</span> <span class='Operator'>: </span><span class='String'>""</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN321"><span class='Ref_To_Local'>csymbol</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><a href="cash.c.html#LN325"><span class='Ref_To_Local'>sep_by_space</span></a> <span class='Operator'>== </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='String'>" "</span> <span class='Operator'>: </span><span class='String'>""</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN315"><span class='Ref_To_Local'>bufptr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="cash.c.html#LN313"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../common/psprintf.c.html#LN44"><span class='Ref_to_Func'>psprintf</span></a><span class='Parentheses'>(</span><span class='String'>"%s%s%s%s%s"</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN315"><span class='Ref_To_Local'>bufptr</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><a href="cash.c.html#LN325"><span class='Ref_To_Local'>sep_by_space</span></a> <span class='Operator'>== </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='String'>" "</span> <span class='Operator'>: </span><span class='String'>""</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN322"><span class='Ref_To_Local'>signsymbol</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><a href="cash.c.html#LN325"><span class='Ref_To_Local'>sep_by_space</span></a> <span class='Operator'>== </span><span class='Number'>2</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='String'>" "</span> <span class='Operator'>: </span><span class='String'>""</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN321"><span class='Ref_To_Local'>csymbol</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <span class='Number'>4</span><span class='Operator'>: 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN324"><span class='Ref_To_Local'>cs_precedes</span></a><span class='Parentheses'>) 
</span>                <a href="cash.c.html#LN313"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../common/psprintf.c.html#LN44"><span class='Ref_to_Func'>psprintf</span></a><span class='Parentheses'>(</span><span class='String'>"%s%s%s%s%s"</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN321"><span class='Ref_To_Local'>csymbol</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><a href="cash.c.html#LN325"><span class='Ref_To_Local'>sep_by_space</span></a> <span class='Operator'>== </span><span class='Number'>2</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='String'>" "</span> <span class='Operator'>: </span><span class='String'>""</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN322"><span class='Ref_To_Local'>signsymbol</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><a href="cash.c.html#LN325"><span class='Ref_To_Local'>sep_by_space</span></a> <span class='Operator'>== </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='String'>" "</span> <span class='Operator'>: </span><span class='String'>""</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN315"><span class='Ref_To_Local'>bufptr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="cash.c.html#LN313"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../common/psprintf.c.html#LN44"><span class='Ref_to_Func'>psprintf</span></a><span class='Parentheses'>(</span><span class='String'>"%s%s%s%s%s"</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN315"><span class='Ref_To_Local'>bufptr</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><a href="cash.c.html#LN325"><span class='Ref_To_Local'>sep_by_space</span></a> <span class='Operator'>== </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='String'>" "</span> <span class='Operator'>: </span><span class='String'>""</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN321"><span class='Ref_To_Local'>csymbol</span></a><span class='Delimiter'>, 
</span>                                  <span class='Parentheses'>(</span><a href="cash.c.html#LN325"><span class='Ref_To_Local'>sep_by_space</span></a> <span class='Operator'>== </span><span class='Number'>2</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='String'>" "</span> <span class='Operator'>: </span><span class='String'>""</span><span class='Delimiter'>, 
</span>                                  <a href="cash.c.html#LN322"><span class='Ref_To_Local'>signsymbol</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch sign_posn &raquo; </span> 
 
    <a href="../../../include/fmgr.h.html#LN321"><span class='Ref_to_Macro'>PG_RETURN_CSTRING</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN313"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end cash_out &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 *      cash_recv           - converts external binary format to cash 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN513"></a><span class='Declare_Function'>cash_recv</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN515"></a>    <a href="../../../include/lib/stringinfo.h.html#LN42"><span class='Ref_to_Typedef'>StringInfo</span></a>  <span class='Declare_Local'>buf</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/lib/stringinfo.h.html#LN42"><span class='Ref_to_Typedef'>StringInfo</span></a><span class='Parentheses'>) </span><a href="../../../include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/cash.h.html#LN22"><span class='Ref_to_Macro'>PG_RETURN_CASH</span></a><span class='Parentheses'>((</span><a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a><span class='Parentheses'>) </span><a href="../../../include/libpq/pqformat.h.html#LN39"><span class='Ref_to_Proto'>pq_getmsgint64</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN515"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 *      cash_send           - converts cash to binary format 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN524"></a><span class='Declare_Function'>cash_send</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN526"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>arg1</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN527"></a>    <a href="../../../include/lib/stringinfo.h.html#LN34"><span class='Ref_to_Struct'>StringInfoData</span></a> <span class='Declare_Local'>buf</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/libpq/pqformat.h.html#LN31"><span class='Ref_to_Proto'>pq_begintypsend</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="cash.c.html#LN527"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/libpq/pqformat.h.html#LN26"><span class='Ref_to_Proto'>pq_sendint64</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="cash.c.html#LN527"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN526"><span class='Ref_To_Local'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN328"><span class='Ref_to_Macro'>PG_RETURN_BYTEA_P</span></a><span class='Parentheses'>(</span><a href="../../../include/libpq/pqformat.h.html#LN32"><span class='Ref_to_Proto'>pq_endtypsend</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="cash.c.html#LN527"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Comparison functions 
 */ 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN539"></a><span class='Declare_Function'>cash_eq</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN541"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c1</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN542"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c2</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN541"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>== </span><a href="cash.c.html#LN542"><span class='Ref_To_Local'>c2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN548"></a><span class='Declare_Function'>cash_ne</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN550"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c1</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN551"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c2</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN550"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>!= </span><a href="cash.c.html#LN551"><span class='Ref_To_Local'>c2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN557"></a><span class='Declare_Function'>cash_lt</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN559"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c1</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN560"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c2</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN559"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>&LT; </span><a href="cash.c.html#LN560"><span class='Ref_To_Local'>c2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN566"></a><span class='Declare_Function'>cash_le</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN568"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c1</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN569"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c2</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN568"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>&LT;= </span><a href="cash.c.html#LN569"><span class='Ref_To_Local'>c2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN575"></a><span class='Declare_Function'>cash_gt</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN577"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c1</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN578"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c2</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN577"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>&GT; </span><a href="cash.c.html#LN578"><span class='Ref_To_Local'>c2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN584"></a><span class='Declare_Function'>cash_ge</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN586"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c1</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN587"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c2</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN586"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>&GT;= </span><a href="cash.c.html#LN587"><span class='Ref_To_Local'>c2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN593"></a><span class='Declare_Function'>cash_cmp</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN595"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c1</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN596"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c2</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN595"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>&GT; </span><a href="cash.c.html#LN596"><span class='Ref_To_Local'>c2</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN595"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>== </span><a href="cash.c.html#LN596"><span class='Ref_To_Local'>c2</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* cash_pl() 
 * Add two cash values. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN611"></a><span class='Declare_Function'>cash_pl</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN613"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c1</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN614"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c2</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN615"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="cash.c.html#LN615"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN613"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>+ </span><a href="cash.c.html#LN614"><span class='Ref_To_Local'>c2</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/cash.h.html#LN22"><span class='Ref_to_Macro'>PG_RETURN_CASH</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN615"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* cash_mi() 
 * Subtract two cash values. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN627"></a><span class='Declare_Function'>cash_mi</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN629"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c1</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN630"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c2</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN631"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="cash.c.html#LN631"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN629"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>- </span><a href="cash.c.html#LN630"><span class='Ref_To_Local'>c2</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/cash.h.html#LN22"><span class='Ref_to_Macro'>PG_RETURN_CASH</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN631"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* cash_div_cash() 
 * Divide cash by cash, returning float8. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN643"></a><span class='Declare_Function'>cash_div_cash</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN645"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>dividend</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN646"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>divisor</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN647"></a>    <a href="../../../include/c.h.html#LN380"><span class='Ref_to_Typedef'>float8</span></a>      <span class='Declare_Local'>quotient</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN646"><span class='Ref_To_Local'>divisor</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DIVISION_BY_ZERO<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"division by zero"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="cash.c.html#LN647"><span class='Ref_To_Local'>quotient</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN380"><span class='Ref_to_Typedef'>float8</span></a><span class='Parentheses'>) </span><a href="cash.c.html#LN645"><span class='Ref_To_Local'>dividend</span></a> <span class='Operator'>/ </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN380"><span class='Ref_to_Typedef'>float8</span></a><span class='Parentheses'>) </span><a href="cash.c.html#LN646"><span class='Ref_To_Local'>divisor</span></a><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN325"><span class='Ref_to_Macro'>PG_RETURN_FLOAT8</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN647"><span class='Ref_To_Local'>quotient</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* cash_mul_flt8() 
 * Multiply cash by float8. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN663"></a><span class='Declare_Function'>cash_mul_flt8</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN665"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN666"></a>    <a href="../../../include/c.h.html#LN380"><span class='Ref_to_Typedef'>float8</span></a>      <span class='Declare_Local'>f</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN245"><span class='Ref_to_Macro'>PG_GETARG_FLOAT8</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN667"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="cash.c.html#LN667"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../port/rint.c.html#LN20"><span class='Ref_to_Func'>rint</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN665"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>* </span><a href="cash.c.html#LN666"><span class='Ref_To_Local'>f</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/cash.h.html#LN22"><span class='Ref_to_Macro'>PG_RETURN_CASH</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN667"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* flt8_mul_cash() 
 * Multiply float8 by cash. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN678"></a><span class='Declare_Function'>flt8_mul_cash</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN680"></a>    <a href="../../../include/c.h.html#LN380"><span class='Ref_to_Typedef'>float8</span></a>      <span class='Declare_Local'>f</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN245"><span class='Ref_to_Macro'>PG_GETARG_FLOAT8</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN681"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN682"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="cash.c.html#LN682"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../port/rint.c.html#LN20"><span class='Ref_to_Func'>rint</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN680"><span class='Ref_To_Local'>f</span></a> <span class='Operator'>* </span><a href="cash.c.html#LN681"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/cash.h.html#LN22"><span class='Ref_to_Macro'>PG_RETURN_CASH</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN682"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* cash_div_flt8() 
 * Divide cash by float8. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN693"></a><span class='Declare_Function'>cash_div_flt8</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN695"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN696"></a>    <a href="../../../include/c.h.html#LN380"><span class='Ref_to_Typedef'>float8</span></a>      <span class='Declare_Local'>f</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN245"><span class='Ref_to_Macro'>PG_GETARG_FLOAT8</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN697"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN696"><span class='Ref_To_Local'>f</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DIVISION_BY_ZERO<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"division by zero"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="cash.c.html#LN697"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../port/rint.c.html#LN20"><span class='Ref_to_Func'>rint</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN695"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>/ </span><a href="cash.c.html#LN696"><span class='Ref_To_Local'>f</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/cash.h.html#LN22"><span class='Ref_to_Macro'>PG_RETURN_CASH</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN697"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* cash_mul_flt4() 
 * Multiply cash by float4. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN713"></a><span class='Declare_Function'>cash_mul_flt4</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN715"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN716"></a>    <a href="../../../include/c.h.html#LN379"><span class='Ref_to_Typedef'>float4</span></a>      <span class='Declare_Local'>f</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN244"><span class='Ref_to_Macro'>PG_GETARG_FLOAT4</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN717"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="cash.c.html#LN717"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../port/rint.c.html#LN20"><span class='Ref_to_Func'>rint</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN715"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>* </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN380"><span class='Ref_to_Typedef'>float8</span></a><span class='Parentheses'>) </span><a href="cash.c.html#LN716"><span class='Ref_To_Local'>f</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/cash.h.html#LN22"><span class='Ref_to_Macro'>PG_RETURN_CASH</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN717"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* flt4_mul_cash() 
 * Multiply float4 by cash. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN728"></a><span class='Declare_Function'>flt4_mul_cash</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN730"></a>    <a href="../../../include/c.h.html#LN379"><span class='Ref_to_Typedef'>float4</span></a>      <span class='Declare_Local'>f</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN244"><span class='Ref_to_Macro'>PG_GETARG_FLOAT4</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN731"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN732"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="cash.c.html#LN732"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../port/rint.c.html#LN20"><span class='Ref_to_Func'>rint</span></a><span class='Parentheses'>((</span><a href="../../../include/c.h.html#LN380"><span class='Ref_to_Typedef'>float8</span></a><span class='Parentheses'>) </span><a href="cash.c.html#LN730"><span class='Ref_To_Local'>f</span></a> <span class='Operator'>* </span><a href="cash.c.html#LN731"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/cash.h.html#LN22"><span class='Ref_to_Macro'>PG_RETURN_CASH</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN732"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* cash_div_flt4() 
 * Divide cash by float4. 
 * 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN744"></a><span class='Declare_Function'>cash_div_flt4</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN746"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN747"></a>    <a href="../../../include/c.h.html#LN379"><span class='Ref_to_Typedef'>float4</span></a>      <span class='Declare_Local'>f</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN244"><span class='Ref_to_Macro'>PG_GETARG_FLOAT4</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN748"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN747"><span class='Ref_To_Local'>f</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DIVISION_BY_ZERO<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"division by zero"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="cash.c.html#LN748"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../port/rint.c.html#LN20"><span class='Ref_to_Func'>rint</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN746"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>/ </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN380"><span class='Ref_to_Typedef'>float8</span></a><span class='Parentheses'>) </span><a href="cash.c.html#LN747"><span class='Ref_To_Local'>f</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/cash.h.html#LN22"><span class='Ref_to_Macro'>PG_RETURN_CASH</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN748"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* cash_mul_int8() 
 * Multiply cash by int8. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN764"></a><span class='Declare_Function'>cash_mul_int8</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN766"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN767"></a>    <a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>i</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN246"><span class='Ref_to_Macro'>PG_GETARG_INT64</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN768"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="cash.c.html#LN768"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN766"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>* </span><a href="cash.c.html#LN767"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/cash.h.html#LN22"><span class='Ref_to_Macro'>PG_RETURN_CASH</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN768"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* int8_mul_cash() 
 * Multiply int8 by cash. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN779"></a><span class='Declare_Function'>int8_mul_cash</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN781"></a>    <a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>i</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN246"><span class='Ref_to_Macro'>PG_GETARG_INT64</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN782"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN783"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="cash.c.html#LN783"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN781"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>* </span><a href="cash.c.html#LN782"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/cash.h.html#LN22"><span class='Ref_to_Macro'>PG_RETURN_CASH</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN783"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* cash_div_int8() 
 * Divide cash by 8-byte integer. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN793"></a><span class='Declare_Function'>cash_div_int8</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN795"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN796"></a>    <a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>i</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN246"><span class='Ref_to_Macro'>PG_GETARG_INT64</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN797"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN796"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DIVISION_BY_ZERO<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"division by zero"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="cash.c.html#LN797"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN795"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>/ </span><a href="cash.c.html#LN796"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/cash.h.html#LN22"><span class='Ref_to_Macro'>PG_RETURN_CASH</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN797"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* cash_mul_int4() 
 * Multiply cash by int4. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN814"></a><span class='Declare_Function'>cash_mul_int4</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN816"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN817"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>i</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN818"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="cash.c.html#LN818"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN816"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>* </span><a href="cash.c.html#LN817"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/cash.h.html#LN22"><span class='Ref_to_Macro'>PG_RETURN_CASH</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN818"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* int4_mul_cash() 
 * Multiply int4 by cash. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN829"></a><span class='Declare_Function'>int4_mul_cash</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN831"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>i</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN832"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN833"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="cash.c.html#LN833"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN831"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>* </span><a href="cash.c.html#LN832"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/cash.h.html#LN22"><span class='Ref_to_Macro'>PG_RETURN_CASH</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN833"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* cash_div_int4() 
 * Divide cash by 4-byte integer. 
 * 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN845"></a><span class='Declare_Function'>cash_div_int4</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN847"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN848"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>i</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN849"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN848"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DIVISION_BY_ZERO<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"division by zero"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="cash.c.html#LN849"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN847"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>/ </span><a href="cash.c.html#LN848"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/cash.h.html#LN22"><span class='Ref_to_Macro'>PG_RETURN_CASH</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN849"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* cash_mul_int2() 
 * Multiply cash by int2. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN866"></a><span class='Declare_Function'>cash_mul_int2</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN868"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN869"></a>    <a href="../../../include/c.h.html#LN254"><span class='Ref_to_Typedef'>int16</span></a>       <span class='Declare_Local'>s</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN235"><span class='Ref_to_Macro'>PG_GETARG_INT16</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN870"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="cash.c.html#LN870"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN868"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>* </span><a href="cash.c.html#LN869"><span class='Ref_To_Local'>s</span></a><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/cash.h.html#LN22"><span class='Ref_to_Macro'>PG_RETURN_CASH</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN870"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* int2_mul_cash() 
 * Multiply int2 by cash. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN880"></a><span class='Declare_Function'>int2_mul_cash</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN882"></a>    <a href="../../../include/c.h.html#LN254"><span class='Ref_to_Typedef'>int16</span></a>       <span class='Declare_Local'>s</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN235"><span class='Ref_to_Macro'>PG_GETARG_INT16</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN883"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN884"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="cash.c.html#LN884"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN882"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>* </span><a href="cash.c.html#LN883"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/cash.h.html#LN22"><span class='Ref_to_Macro'>PG_RETURN_CASH</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN884"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* cash_div_int2() 
 * Divide cash by int2. 
 * 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN895"></a><span class='Declare_Function'>cash_div_int2</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN897"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN898"></a>    <a href="../../../include/c.h.html#LN254"><span class='Ref_to_Typedef'>int16</span></a>       <span class='Declare_Local'>s</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN235"><span class='Ref_to_Macro'>PG_GETARG_INT16</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN899"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN898"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DIVISION_BY_ZERO<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"division by zero"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="cash.c.html#LN899"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN897"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>/ </span><a href="cash.c.html#LN898"><span class='Ref_To_Local'>s</span></a><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/cash.h.html#LN22"><span class='Ref_to_Macro'>PG_RETURN_CASH</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN899"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* cashlarger() 
 * Return larger of two cash values. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN914"></a><span class='Declare_Function'>cashlarger</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN916"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c1</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN917"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c2</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN918"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="cash.c.html#LN918"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="cash.c.html#LN916"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>&GT; </span><a href="cash.c.html#LN917"><span class='Ref_To_Local'>c2</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="cash.c.html#LN916"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>: </span><a href="cash.c.html#LN917"><span class='Ref_To_Local'>c2</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/cash.h.html#LN22"><span class='Ref_to_Macro'>PG_RETURN_CASH</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN918"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* cashsmaller() 
 * Return smaller of two cash values. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN929"></a><span class='Declare_Function'>cashsmaller</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN931"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c1</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN932"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>c2</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN933"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="cash.c.html#LN933"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="cash.c.html#LN931"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>&LT; </span><a href="cash.c.html#LN932"><span class='Ref_To_Local'>c2</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="cash.c.html#LN931"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>: </span><a href="cash.c.html#LN932"><span class='Ref_To_Local'>c2</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/cash.h.html#LN22"><span class='Ref_to_Macro'>PG_RETURN_CASH</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN933"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* cash_words() 
 * This converts an int4 as well but to a representation using words 
 * Obviously way North American centric - sorry 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN945"></a><span class='Declare_Function'>cash_words</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN947"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>value</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN948"></a>    <a href="../../../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a>      <span class='Declare_Local'>val</span><span class='Delimiter'>; 
</span><a name="LN949"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>buf</span><span class='Delimiter'>[</span><span class='Number'>256</span><span class='Delimiter'>]; 
</span><a name="LN950"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>p</span> <span class='Operator'>= </span><a href="cash.c.html#LN949"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>; 
</span><a name="LN951"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>m0</span><span class='Delimiter'>; 
</span><a name="LN952"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>m1</span><span class='Delimiter'>; 
</span><a name="LN953"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>m2</span><span class='Delimiter'>; 
</span><a name="LN954"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>m3</span><span class='Delimiter'>; 
</span><a name="LN955"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>m4</span><span class='Delimiter'>; 
</span><a name="LN956"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>m5</span><span class='Delimiter'>; 
</span><a name="LN957"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>m6</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* work with positive numbers */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>value </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Keyword'>value </span><span class='Operator'>= -</span><span class='Keyword'>value</span><span class='Delimiter'>; 
</span>        <a href="../../../../contrib/cube/cubeparse.y.html#LN150"><span class='Ref_to_Proto'>strcpy</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN949"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>"minus "</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="cash.c.html#LN950"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>+= </span><span class='Number'>6</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
        <a href="cash.c.html#LN949"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Now treat as unsigned, to avoid trouble at INT_MIN */ 
</span>    <a href="cash.c.html#LN948"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a><span class='Parentheses'>) </span><span class='Keyword'>value</span><span class='Delimiter'>; 
</span> 
    <a href="cash.c.html#LN951"><span class='Ref_To_Local'>m0</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN948"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>% </span><a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>100</span><span class='Parentheses'>)</span><span class='Delimiter'>; </span><span class='Comment_Single_Line'>/* cents */ 
</span>    <a href="cash.c.html#LN952"><span class='Ref_To_Local'>m1</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="cash.c.html#LN948"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>/ </span><a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>100</span><span class='Parentheses'>))</span> <span class='Operator'>% </span><span class='Number'>1000</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* hundreds */ 
</span>    <a href="cash.c.html#LN953"><span class='Ref_To_Local'>m2</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="cash.c.html#LN948"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>/ </span><a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>100000</span><span class='Parentheses'>))</span> <span class='Operator'>% </span><span class='Number'>1000</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* thousands */ 
</span>    <a href="cash.c.html#LN954"><span class='Ref_To_Local'>m3</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="cash.c.html#LN948"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>/ </span><a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>100000000</span><span class='Parentheses'>))</span> <span class='Operator'>% </span><span class='Number'>1000</span><span class='Delimiter'>;</span>  <span class='Comment_Single_Line'>/* millions */ 
</span>    <a href="cash.c.html#LN955"><span class='Ref_To_Local'>m4</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="cash.c.html#LN948"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>/ </span><a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>100000000000</span><span class='Parentheses'>))</span> <span class='Operator'>% </span><span class='Number'>1000</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* billions */ 
</span>    <a href="cash.c.html#LN956"><span class='Ref_To_Local'>m5</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="cash.c.html#LN948"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>/ </span><a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>100000000000000</span><span class='Parentheses'>))</span> <span class='Operator'>% </span><span class='Number'>1000</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* trillions */ 
</span>    <a href="cash.c.html#LN957"><span class='Ref_To_Local'>m6</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="cash.c.html#LN948"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>/ </span><a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>100000000000000000</span><span class='Parentheses'>))</span> <span class='Operator'>% </span><span class='Number'>1000</span><span class='Delimiter'>; </span><span class='Comment_Single_Line'>/* quadrillions */ 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN957"><span class='Ref_To_Local'>m6</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        strcat<span class='Parentheses'>(</span><a href="cash.c.html#LN949"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN36"><span class='Ref_to_Func'>num_word</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN957"><span class='Ref_To_Local'>m6</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        strcat<span class='Parentheses'>(</span><a href="cash.c.html#LN949"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>" quadrillion "</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN956"><span class='Ref_To_Local'>m5</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        strcat<span class='Parentheses'>(</span><a href="cash.c.html#LN949"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN36"><span class='Ref_to_Func'>num_word</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN956"><span class='Ref_To_Local'>m5</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        strcat<span class='Parentheses'>(</span><a href="cash.c.html#LN949"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>" trillion "</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN955"><span class='Ref_To_Local'>m4</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        strcat<span class='Parentheses'>(</span><a href="cash.c.html#LN949"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN36"><span class='Ref_to_Func'>num_word</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN955"><span class='Ref_To_Local'>m4</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        strcat<span class='Parentheses'>(</span><a href="cash.c.html#LN949"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>" billion "</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN954"><span class='Ref_To_Local'>m3</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        strcat<span class='Parentheses'>(</span><a href="cash.c.html#LN949"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN36"><span class='Ref_to_Func'>num_word</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN954"><span class='Ref_To_Local'>m3</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        strcat<span class='Parentheses'>(</span><a href="cash.c.html#LN949"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>" million "</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN953"><span class='Ref_To_Local'>m2</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        strcat<span class='Parentheses'>(</span><a href="cash.c.html#LN949"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN36"><span class='Ref_to_Func'>num_word</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN953"><span class='Ref_To_Local'>m2</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        strcat<span class='Parentheses'>(</span><a href="cash.c.html#LN949"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>" thousand "</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN952"><span class='Ref_To_Local'>m1</span></a><span class='Parentheses'>) 
</span>        strcat<span class='Parentheses'>(</span><a href="cash.c.html#LN949"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN36"><span class='Ref_to_Func'>num_word</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN952"><span class='Ref_To_Local'>m1</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!*</span><a href="cash.c.html#LN950"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) 
</span>        strcat<span class='Parentheses'>(</span><a href="cash.c.html#LN949"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>"zero"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    strcat<span class='Parentheses'>(</span><a href="cash.c.html#LN949"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="cash.c.html#LN948"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>/ </span><span class='Number'>100</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>1</span> <span class='Operator'>? </span><span class='String'>" dollar and "</span> <span class='Operator'>: </span><span class='String'>" dollars and "</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    strcat<span class='Parentheses'>(</span><a href="cash.c.html#LN949"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN36"><span class='Ref_to_Func'>num_word</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN951"><span class='Ref_To_Local'>m0</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    strcat<span class='Parentheses'>(</span><a href="cash.c.html#LN949"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN951"><span class='Ref_To_Local'>m0</span></a> <span class='Operator'>== </span><span class='Number'>1</span> <span class='Operator'>? </span><span class='String'>" cent"</span> <span class='Operator'>: </span><span class='String'>" cents"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* capitalize output */ 
</span>    <a href="cash.c.html#LN949"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../port/pgstrcasecmp.c.html#LN103"><span class='Ref_to_Func'>pg_toupper</span></a><span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="cash.c.html#LN949"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* return as text datum */ 
</span>    <a href="../../../include/fmgr.h.html#LN329"><span class='Ref_to_Macro'>PG_RETURN_TEXT_P</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/builtins.h.html#LN85"><span class='Ref_to_Proto'>cstring_to_text</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN949"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end cash_words &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* cash_numeric() 
 * Convert cash to numeric. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1032"></a><span class='Declare_Function'>cash_numeric</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1034"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>money</span> <span class='Operator'>= </span><a href="../../../include/utils/cash.h.html#LN21"><span class='Ref_to_Macro'>PG_GETARG_CASH</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1035"></a>    <a href="../../../include/utils/numeric.h.html#LN42"><span class='Ref_to_Typedef'>Numeric</span></a>     <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1036"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>fpoint</span><span class='Delimiter'>; 
</span><a name="LN1037"></a>    <a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>scale</span><span class='Delimiter'>; 
</span><a name="LN1038"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN1039"></a>    <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>amount</span><span class='Delimiter'>; 
</span><a name="LN1040"></a>    <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>numeric_scale</span><span class='Delimiter'>; 
</span><a name="LN1041"></a>    <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>quotient</span><span class='Delimiter'>; 
</span><a name="LN1042"></a>    <span class='Control'>struct</span> lconv <span class='Operator'>*</span><span class='Declare_Local'>lconvert</span> <span class='Operator'>= </span><a href="../../../include/utils/pg_locale.h.html#LN57"><span class='Ref_to_Proto'>PGLC_localeconv</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* see comments about frac_digits in cash_in() */ 
</span>    <a href="cash.c.html#LN1036"><span class='Ref_To_Local'>fpoint</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN1042"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>frac_digits<span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN1036"><span class='Ref_To_Local'>fpoint</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="cash.c.html#LN1036"><span class='Ref_To_Local'>fpoint</span></a> <span class='Operator'>&GT; </span><span class='Number'>10</span><span class='Parentheses'>) 
</span>        <a href="cash.c.html#LN1036"><span class='Ref_To_Local'>fpoint</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* compute required scale factor */ 
</span>    <a href="cash.c.html#LN1037"><span class='Ref_To_Local'>scale</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN1038"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cash.c.html#LN1038"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cash.c.html#LN1036"><span class='Ref_To_Local'>fpoint</span></a><span class='Delimiter'>; </span><a href="cash.c.html#LN1038"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <a href="cash.c.html#LN1037"><span class='Ref_To_Local'>scale</span></a> <span class='Operator'>*= </span><span class='Number'>10</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* form the result as money / scale */ 
</span>    <a href="cash.c.html#LN1039"><span class='Ref_To_Local'>amount</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN583"><span class='Ref_to_Macro'>DirectFunctionCall1</span></a><span class='Parentheses'>(</span><a href="numeric.c.html#LN2966"><span class='Ref_to_Func'>int8_numeric</span></a><span class='Delimiter'>, </span><a href="../../../include/postgres.h.html#LN624"><span class='Ref_to_Macro'>Int64GetDatum</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN1034"><span class='Ref_To_Local'>money</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="cash.c.html#LN1040"><span class='Ref_To_Local'>numeric_scale</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN583"><span class='Ref_to_Macro'>DirectFunctionCall1</span></a><span class='Parentheses'>(</span><a href="numeric.c.html#LN2966"><span class='Ref_to_Func'>int8_numeric</span></a><span class='Delimiter'>, </span><a href="../../../include/postgres.h.html#LN624"><span class='Ref_to_Macro'>Int64GetDatum</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN1037"><span class='Ref_To_Local'>scale</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="cash.c.html#LN1041"><span class='Ref_To_Local'>quotient</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN585"><span class='Ref_to_Macro'>DirectFunctionCall2</span></a><span class='Parentheses'>(</span><a href="numeric.c.html#LN2364"><span class='Ref_to_Func'>numeric_div</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN1039"><span class='Ref_To_Local'>amount</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN1040"><span class='Ref_To_Local'>numeric_scale</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* forcibly round to exactly the intended number of digits */ 
</span>    <a href="cash.c.html#LN1035"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/utils/numeric.h.html#LN48"><span class='Ref_to_Macro'>DatumGetNumeric</span></a><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN585"><span class='Ref_to_Macro'>DirectFunctionCall2</span></a><span class='Parentheses'>(</span><a href="numeric.c.html#LN1209"><span class='Ref_to_Func'>numeric_round</span></a><span class='Delimiter'>, 
</span>                                                 <a href="cash.c.html#LN1041"><span class='Ref_To_Local'>quotient</span></a><span class='Delimiter'>, 
</span>                                                 <a href="../../../include/postgres.h.html#LN484"><span class='Ref_to_Macro'>Int32GetDatum</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN1036"><span class='Ref_To_Local'>fpoint</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/numeric.h.html#LN53"><span class='Ref_to_Macro'>PG_RETURN_NUMERIC</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN1035"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end cash_numeric &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* numeric_cash() 
 * Convert numeric to cash. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1071"></a><span class='Declare_Function'>numeric_cash</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1073"></a>    <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>amount</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1074"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1075"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>fpoint</span><span class='Delimiter'>; 
</span><a name="LN1076"></a>    <a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>scale</span><span class='Delimiter'>; 
</span><a name="LN1077"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN1078"></a>    <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>numeric_scale</span><span class='Delimiter'>; 
</span><a name="LN1079"></a>    <span class='Control'>struct</span> lconv <span class='Operator'>*</span><span class='Declare_Local'>lconvert</span> <span class='Operator'>= </span><a href="../../../include/utils/pg_locale.h.html#LN57"><span class='Ref_to_Proto'>PGLC_localeconv</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* see comments about frac_digits in cash_in() */ 
</span>    <a href="cash.c.html#LN1075"><span class='Ref_To_Local'>fpoint</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN1079"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>frac_digits<span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN1075"><span class='Ref_To_Local'>fpoint</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="cash.c.html#LN1075"><span class='Ref_To_Local'>fpoint</span></a> <span class='Operator'>&GT; </span><span class='Number'>10</span><span class='Parentheses'>) 
</span>        <a href="cash.c.html#LN1075"><span class='Ref_To_Local'>fpoint</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* compute required scale factor */ 
</span>    <a href="cash.c.html#LN1076"><span class='Ref_To_Local'>scale</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN1077"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cash.c.html#LN1077"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cash.c.html#LN1075"><span class='Ref_To_Local'>fpoint</span></a><span class='Delimiter'>; </span><a href="cash.c.html#LN1077"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <a href="cash.c.html#LN1076"><span class='Ref_To_Local'>scale</span></a> <span class='Operator'>*= </span><span class='Number'>10</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* multiply the input amount by scale factor */ 
</span>    <a href="cash.c.html#LN1078"><span class='Ref_To_Local'>numeric_scale</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN583"><span class='Ref_to_Macro'>DirectFunctionCall1</span></a><span class='Parentheses'>(</span><a href="numeric.c.html#LN2966"><span class='Ref_to_Func'>int8_numeric</span></a><span class='Delimiter'>, </span><a href="../../../include/postgres.h.html#LN624"><span class='Ref_to_Macro'>Int64GetDatum</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN1076"><span class='Ref_To_Local'>scale</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="cash.c.html#LN1073"><span class='Ref_To_Local'>amount</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN585"><span class='Ref_to_Macro'>DirectFunctionCall2</span></a><span class='Parentheses'>(</span><a href="numeric.c.html#LN2322"><span class='Ref_to_Func'>numeric_mul</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN1073"><span class='Ref_To_Local'>amount</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN1078"><span class='Ref_To_Local'>numeric_scale</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* note that numeric_int8 will round to nearest integer for us */ 
</span>    <a href="cash.c.html#LN1074"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN610"><span class='Ref_to_Macro'>DatumGetInt64</span></a><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN583"><span class='Ref_to_Macro'>DirectFunctionCall1</span></a><span class='Parentheses'>(</span><a href="numeric.c.html#LN2985"><span class='Ref_to_Func'>numeric_int8</span></a><span class='Delimiter'>, </span><a href="cash.c.html#LN1073"><span class='Ref_To_Local'>amount</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/cash.h.html#LN22"><span class='Ref_to_Macro'>PG_RETURN_CASH</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN1074"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end numeric_cash &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* int4_cash() 
 * Convert int4 (int) to cash 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1105"></a><span class='Declare_Function'>int4_cash</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1107"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>amount</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1108"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1109"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>fpoint</span><span class='Delimiter'>; 
</span><a name="LN1110"></a>    <a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>scale</span><span class='Delimiter'>; 
</span><a name="LN1111"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN1112"></a>    <span class='Control'>struct</span> lconv <span class='Operator'>*</span><span class='Declare_Local'>lconvert</span> <span class='Operator'>= </span><a href="../../../include/utils/pg_locale.h.html#LN57"><span class='Ref_to_Proto'>PGLC_localeconv</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* see comments about frac_digits in cash_in() */ 
</span>    <a href="cash.c.html#LN1109"><span class='Ref_To_Local'>fpoint</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN1112"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>frac_digits<span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN1109"><span class='Ref_To_Local'>fpoint</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="cash.c.html#LN1109"><span class='Ref_To_Local'>fpoint</span></a> <span class='Operator'>&GT; </span><span class='Number'>10</span><span class='Parentheses'>) 
</span>        <a href="cash.c.html#LN1109"><span class='Ref_To_Local'>fpoint</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* compute required scale factor */ 
</span>    <a href="cash.c.html#LN1110"><span class='Ref_To_Local'>scale</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN1111"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cash.c.html#LN1111"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cash.c.html#LN1109"><span class='Ref_To_Local'>fpoint</span></a><span class='Delimiter'>; </span><a href="cash.c.html#LN1111"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <a href="cash.c.html#LN1110"><span class='Ref_To_Local'>scale</span></a> <span class='Operator'>*= </span><span class='Number'>10</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* compute amount * scale, checking for overflow */ 
</span>    <a href="cash.c.html#LN1108"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN610"><span class='Ref_to_Macro'>DatumGetInt64</span></a><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN585"><span class='Ref_to_Macro'>DirectFunctionCall2</span></a><span class='Parentheses'>(</span><a href="int8.c.html#LN553"><span class='Ref_to_Func'>int8mul</span></a><span class='Delimiter'>, </span><a href="../../../include/postgres.h.html#LN624"><span class='Ref_to_Macro'>Int64GetDatum</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN1107"><span class='Ref_To_Local'>amount</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                               <a href="../../../include/postgres.h.html#LN624"><span class='Ref_to_Macro'>Int64GetDatum</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN1110"><span class='Ref_To_Local'>scale</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/cash.h.html#LN22"><span class='Ref_to_Macro'>PG_RETURN_CASH</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN1108"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end int4_cash &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* int8_cash() 
 * Convert int8 (bigint) to cash 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1135"></a><span class='Declare_Function'>int8_cash</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1137"></a>    <a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>amount</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN246"><span class='Ref_to_Macro'>PG_GETARG_INT64</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1138"></a>    <a href="../../../include/utils/cash.h.html#LN16"><span class='Ref_to_Typedef'>Cash</span></a>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1139"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>fpoint</span><span class='Delimiter'>; 
</span><a name="LN1140"></a>    <a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>scale</span><span class='Delimiter'>; 
</span><a name="LN1141"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN1142"></a>    <span class='Control'>struct</span> lconv <span class='Operator'>*</span><span class='Declare_Local'>lconvert</span> <span class='Operator'>= </span><a href="../../../include/utils/pg_locale.h.html#LN57"><span class='Ref_to_Proto'>PGLC_localeconv</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* see comments about frac_digits in cash_in() */ 
</span>    <a href="cash.c.html#LN1139"><span class='Ref_To_Local'>fpoint</span></a> <span class='Operator'>= </span><a href="cash.c.html#LN1142"><span class='Ref_To_Local'>lconvert</span></a><span class='Operator'>-&GT;</span>frac_digits<span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN1139"><span class='Ref_To_Local'>fpoint</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="cash.c.html#LN1139"><span class='Ref_To_Local'>fpoint</span></a> <span class='Operator'>&GT; </span><span class='Number'>10</span><span class='Parentheses'>) 
</span>        <a href="cash.c.html#LN1139"><span class='Ref_To_Local'>fpoint</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* compute required scale factor */ 
</span>    <a href="cash.c.html#LN1140"><span class='Ref_To_Local'>scale</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="cash.c.html#LN1141"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="cash.c.html#LN1141"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="cash.c.html#LN1139"><span class='Ref_To_Local'>fpoint</span></a><span class='Delimiter'>; </span><a href="cash.c.html#LN1141"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <a href="cash.c.html#LN1140"><span class='Ref_To_Local'>scale</span></a> <span class='Operator'>*= </span><span class='Number'>10</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* compute amount * scale, checking for overflow */ 
</span>    <a href="cash.c.html#LN1138"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN610"><span class='Ref_to_Macro'>DatumGetInt64</span></a><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN585"><span class='Ref_to_Macro'>DirectFunctionCall2</span></a><span class='Parentheses'>(</span><a href="int8.c.html#LN553"><span class='Ref_to_Func'>int8mul</span></a><span class='Delimiter'>, </span><a href="../../../include/postgres.h.html#LN624"><span class='Ref_to_Macro'>Int64GetDatum</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN1137"><span class='Ref_To_Local'>amount</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                               <a href="../../../include/postgres.h.html#LN624"><span class='Ref_to_Macro'>Int64GetDatum</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN1140"><span class='Ref_To_Local'>scale</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/cash.h.html#LN22"><span class='Ref_to_Macro'>PG_RETURN_CASH</span></a><span class='Parentheses'>(</span><a href="cash.c.html#LN1138"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end int8_cash &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>