<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\backend\utils\adt\date.c</title>
<LINK REL=StyleSheet HREF="../../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\backend\utils\adt\date.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:50 2017
</td></tr>
<tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * date.c 
 *    implements DATE and TIME data types specified in SQL standard 
 * 
 * Portions Copyright (c) 1996-2017, PostgreSQL Global Development Group 
 * Portions Copyright (c) 1994-5, Regents of the University of California 
 * 
 * 
 * IDENTIFICATION 
 *    src/backend/utils/adt/date.c 
 * 
 *------------------------------------------------------------------------- 
 */ 
</span> 
<span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>&LT;ctype.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;limits.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;float.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;time.h&GT;</span> 
 
<span class='Keyword'>#include </span><span class='String'>"access/hash.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/xact.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"libpq/pqformat.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"miscadmin.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/scansup.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/array.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/builtins.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/date.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/datetime.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/nabstime.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/sortsupport.h"</span> 
 
<span class='Comment_Multi_Line'>/* 
 * gcc's -ffast-math switch breaks routines that expect exact results from 
 * expressions like timeval / SECS_PER_HOUR, where timeval is double. 
 */ 
</span><span class='Directive'>#ifdef</span> __FAST_MATH__ 
#error <span class='Operator'>-</span>ffast<span class='Operator'>-</span>math is known to <span class='Control'>break</span> <span class='Keyword'>this </span>code 
<span class='Directive'>#endif</span> 
 
 
<a name="LN43"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>time2tm</span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a> <span class='Declare_Parameter'>time</span><span class='Delimiter'>, </span><span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>tm</span><span class='Delimiter'>, </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>fsec</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN44"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>timetz2tm</span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>time</span><span class='Delimiter'>, </span><span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>tm</span><span class='Delimiter'>, </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>fsec</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>tzp</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN45"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>tm2time</span><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>tm</span><span class='Delimiter'>, </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a> <span class='Declare_Parameter'>fsec</span><span class='Delimiter'>, </span><a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>result</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN46"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>tm2timetz</span><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>tm</span><span class='Delimiter'>, </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a> <span class='Declare_Parameter'>fsec</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>tz</span><span class='Delimiter'>, </span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>result</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN47"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>AdjustTimeForTypmod</span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>time</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Declare_Parameter'>typmod</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* common code for timetypmodin and timetztypmodin */ 
</span><span class='Keyword'>static </span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> 
<a name="LN52"></a><span class='Declare_Function'>anytime_typmodin</span><span class='Parentheses'>(</span><span class='Keyword'>bool </span><span class='Declare_Parameter'>istz</span><span class='Delimiter'>, </span><a href="../../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>ta</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN54"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>tl</span><span class='Delimiter'>; 
</span><a name="LN55"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>n</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN54"><span class='Ref_To_Local'>tl</span></a> <span class='Operator'>= </span><a href="arrayutils.c.html#LN198"><span class='Ref_to_Func'>ArrayGetIntegerTypmods</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN52"><span class='Ref_to_Parameter'>ta</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN55"><span class='Ref_To_Local'>n</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * we're not too tense about good error message here because grammar 
     * shouldn't allow wrong number of modifiers for TIME 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN55"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>!= </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"invalid type modifier"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="../../../include/utils/date.h.html#LN69"><span class='Ref_to_Proto'>anytime_typmod_check</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN52"><span class='Ref_to_Parameter'>istz</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN54"><span class='Ref_To_Local'>tl</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* exported so parse_expr.c can use it */ 
</span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> 
<a name="LN73"></a><span class='Declare_Function'>anytime_typmod_check</span><span class='Parentheses'>(</span><span class='Keyword'>bool </span><span class='Declare_Parameter'>istz</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Declare_Parameter'>typmod</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN73"><span class='Ref_to_Parameter'>typmod</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"TIME(%d)%s precision must not be negative"</span><span class='Delimiter'>, 
</span>                        <a href="date.c.html#LN73"><span class='Ref_to_Parameter'>typmod</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="date.c.html#LN73"><span class='Ref_to_Parameter'>istz</span></a> <span class='Operator'>? </span><span class='String'>" WITH TIME ZONE"</span> <span class='Operator'>: </span><span class='String'>""</span><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN73"><span class='Ref_to_Parameter'>typmod</span></a> <span class='Operator'>&GT; </span><a href="../../../include/utils/date.h.html#LN49"><span class='Ref_to_Const'>MAX_TIME_PRECISION</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN39"><span class='Ref_to_Const'>WARNING</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"TIME(%d)%s precision reduced to maximum allowed, %d"</span><span class='Delimiter'>, 
</span>                        <a href="date.c.html#LN73"><span class='Ref_to_Parameter'>typmod</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="date.c.html#LN73"><span class='Ref_to_Parameter'>istz</span></a> <span class='Operator'>? </span><span class='String'>" WITH TIME ZONE"</span> <span class='Operator'>: </span><span class='String'>""</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                        <a href="../../../include/utils/date.h.html#LN49"><span class='Ref_to_Const'>MAX_TIME_PRECISION</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <a href="date.c.html#LN73"><span class='Ref_to_Parameter'>typmod</span></a> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN49"><span class='Ref_to_Const'>MAX_TIME_PRECISION</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="date.c.html#LN73"><span class='Ref_to_Parameter'>typmod</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end anytime_typmod_check &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* common code for timetypmodout and timetztypmodout */ 
</span><span class='Keyword'>static char </span><span class='Operator'>* 
</span><a name="LN95"></a><span class='Declare_Function'>anytime_typmodout</span><span class='Parentheses'>(</span><span class='Keyword'>bool </span><span class='Declare_Parameter'>istz</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Declare_Parameter'>typmod</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN97"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>tz</span> <span class='Operator'>= </span><a href="date.c.html#LN95"><span class='Ref_to_Parameter'>istz</span></a> <span class='Operator'>? </span><span class='String'>" with time zone"</span> <span class='Operator'>: </span><span class='String'>" without time zone"</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN95"><span class='Ref_to_Parameter'>typmod</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="../../../common/psprintf.c.html#LN44"><span class='Ref_to_Func'>psprintf</span></a><span class='Parentheses'>(</span><span class='String'>"(%d)%s"</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="date.c.html#LN95"><span class='Ref_to_Parameter'>typmod</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN97"><span class='Ref_To_Local'>tz</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <a href="../../../common/psprintf.c.html#LN44"><span class='Ref_to_Func'>psprintf</span></a><span class='Parentheses'>(</span><span class='String'>"%s"</span><span class='Delimiter'>, </span><a href="date.c.html#LN97"><span class='Ref_To_Local'>tz</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/***************************************************************************** 
 *   Date ADT 
 *****************************************************************************/ 
</span> 
 
<span class='Comment_Multi_Line'>/* date_in() 
 * Given date text string, convert to internal date format. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN115"></a><span class='Declare_Function'>date_in</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN117"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>str</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN241"><span class='Ref_to_Macro'>PG_GETARG_CSTRING</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN118"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>date</span><span class='Delimiter'>; 
</span><a name="LN119"></a>    <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a>      <span class='Declare_Local'>fsec</span><span class='Delimiter'>; 
</span><a name="LN120"></a>    <span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Declare_Local'>tt</span><span class='Delimiter'>, 
</span><a name="LN121"></a>               <span class='Operator'>*</span><span class='Declare_Local'>tm</span> <span class='Operator'>= &</span><a href="date.c.html#LN120"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span><a name="LN122"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>tzp</span><span class='Delimiter'>; 
</span><a name="LN123"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>dtype</span><span class='Delimiter'>; 
</span><a name="LN124"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>nf</span><span class='Delimiter'>; 
</span><a name="LN125"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>dterr</span><span class='Delimiter'>; 
</span><a name="LN126"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>field</span><span class='Delimiter'>[</span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN197"><span class='Ref_to_Const'>MAXDATEFIELDS</span></a><span class='Delimiter'>]; 
</span><a name="LN127"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>ftype</span><span class='Delimiter'>[</span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN197"><span class='Ref_to_Const'>MAXDATEFIELDS</span></a><span class='Delimiter'>]; 
</span><a name="LN128"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>workbuf</span><span class='Delimiter'>[</span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN195"><span class='Ref_to_Const'>MAXDATELEN</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span> 
    <a href="date.c.html#LN125"><span class='Ref_To_Local'>dterr</span></a> <span class='Operator'>= </span><a href="../../../include/utils/datetime.h.html#LN293"><span class='Ref_to_Proto'>ParseDateTime</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN117"><span class='Ref_To_Local'>str</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN128"><span class='Ref_To_Local'>workbuf</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="date.c.html#LN128"><span class='Ref_To_Local'>workbuf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                          <a href="date.c.html#LN126"><span class='Ref_To_Local'>field</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN127"><span class='Ref_To_Local'>ftype</span></a><span class='Delimiter'>, </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN197"><span class='Ref_to_Const'>MAXDATEFIELDS</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN124"><span class='Ref_To_Local'>nf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN125"><span class='Ref_To_Local'>dterr</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="date.c.html#LN125"><span class='Ref_To_Local'>dterr</span></a> <span class='Operator'>= </span><a href="../../../include/utils/datetime.h.html#LN296"><span class='Ref_to_Proto'>DecodeDateTime</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN126"><span class='Ref_To_Local'>field</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN127"><span class='Ref_To_Local'>ftype</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN124"><span class='Ref_To_Local'>nf</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN123"><span class='Ref_To_Local'>dtype</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN121"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN119"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN122"><span class='Ref_To_Local'>tzp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN125"><span class='Ref_To_Local'>dterr</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="datetime.c.html#LN3763"><span class='Ref_to_Func'>DateTimeParseError</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN125"><span class='Ref_To_Local'>dterr</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN117"><span class='Ref_To_Local'>str</span></a><span class='Delimiter'>, </span><span class='String'>"date"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="date.c.html#LN123"><span class='Ref_To_Local'>dtype</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN139"><span class='Ref_to_Const'>DTK_DATE</span></a><span class='Operator'>: 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN146"><span class='Ref_to_Const'>DTK_CURRENT</span></a><span class='Operator'>: 
</span>            <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>              <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"date/time value \"current\" is no longer supported"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
            <a href="../../../include/utils/datetime.h.html#LN288"><span class='Ref_to_Proto'>GetCurrentDateTime</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN121"><span class='Ref_To_Local'>tm</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN149"><span class='Ref_to_Const'>DTK_EPOCH</span></a><span class='Operator'>: 
</span>            <a href="../../../include/utils/timestamp.h.html#LN92"><span class='Ref_to_Proto'>GetEpochTime</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN121"><span class='Ref_To_Local'>tm</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN148"><span class='Ref_to_Const'>DTK_LATE</span></a><span class='Operator'>: 
</span>            <a href="../../../include/utils/date.h.html#LN39"><span class='Ref_to_Macro'>DATE_NOEND</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN118"><span class='Ref_To_Local'>date</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../../include/utils/date.h.html#LN63"><span class='Ref_to_Macro'>PG_RETURN_DATEADT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN118"><span class='Ref_To_Local'>date</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN147"><span class='Ref_to_Const'>DTK_EARLY</span></a><span class='Operator'>: 
</span>            <a href="../../../include/utils/date.h.html#LN37"><span class='Ref_to_Macro'>DATE_NOBEGIN</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN118"><span class='Ref_To_Local'>date</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../../include/utils/date.h.html#LN63"><span class='Ref_to_Macro'>PG_RETURN_DATEADT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN118"><span class='Ref_To_Local'>date</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="datetime.c.html#LN3763"><span class='Ref_to_Func'>DateTimeParseError</span></a><span class='Parentheses'>(</span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN25"><span class='Ref_to_Const'>DTERR_BAD_FORMAT</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN117"><span class='Ref_To_Local'>str</span></a><span class='Delimiter'>, </span><span class='String'>"date"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch dtype &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Prevent overflow in Julian-day routines */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/datatype/timestamp.h.html#LN154"><span class='Ref_to_Macro'>IS_VALID_JULIAN</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN121"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN31"><span class='Ref_to_Member'>tm_year</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN121"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN30"><span class='Ref_to_Member'>tm_mon</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN121"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN29"><span class='Ref_to_Member'>tm_mday</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"date out of range: \"%s\""</span><span class='Delimiter'>, </span><a href="date.c.html#LN117"><span class='Ref_To_Local'>str</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN118"><span class='Ref_To_Local'>date</span></a> <span class='Operator'>= </span><a href="datetime.c.html#LN290"><span class='Ref_to_Func'>date2j</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN121"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN31"><span class='Ref_to_Member'>tm_year</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN121"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN30"><span class='Ref_to_Member'>tm_mon</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN121"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN29"><span class='Ref_to_Member'>tm_mday</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="../../../include/datatype/timestamp.h.html#LN162"><span class='Ref_to_Const'>POSTGRES_EPOCH_JDATE</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Now check for just-out-of-range dates */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/datatype/timestamp.h.html#LN189"><span class='Ref_to_Macro'>IS_VALID_DATE</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN118"><span class='Ref_To_Local'>date</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"date out of range: \"%s\""</span><span class='Delimiter'>, </span><a href="date.c.html#LN117"><span class='Ref_To_Local'>str</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN63"><span class='Ref_to_Macro'>PG_RETURN_DATEADT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN118"><span class='Ref_To_Local'>date</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end date_in &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* date_out() 
 * Given internal format date, convert to text string. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN188"></a><span class='Declare_Function'>date_out</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN190"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>date</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN191"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN192"></a>    <span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Declare_Local'>tt</span><span class='Delimiter'>, 
</span><a name="LN193"></a>               <span class='Operator'>*</span><span class='Declare_Local'>tm</span> <span class='Operator'>= &</span><a href="date.c.html#LN192"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span><a name="LN194"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>buf</span><span class='Delimiter'>[</span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN195"><span class='Ref_to_Const'>MAXDATELEN</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN41"><span class='Ref_to_Macro'>DATE_NOT_FINITE</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN190"><span class='Ref_To_Local'>date</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/utils/date.h.html#LN71"><span class='Ref_to_Proto'>EncodeSpecialDate</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN190"><span class='Ref_To_Local'>date</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN194"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../../include/utils/datetime.h.html#LN290"><span class='Ref_to_Proto'>j2date</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN190"><span class='Ref_To_Local'>date</span></a> <span class='Operator'>+ </span><a href="../../../include/datatype/timestamp.h.html#LN162"><span class='Ref_to_Const'>POSTGRES_EPOCH_JDATE</span></a><span class='Delimiter'>, 
</span>               <span class='Operator'>&</span><span class='Parentheses'>(</span><a href="date.c.html#LN193"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN31"><span class='Ref_to_Member'>tm_year</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Operator'>&</span><span class='Parentheses'>(</span><a href="date.c.html#LN193"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN30"><span class='Ref_to_Member'>tm_mon</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Operator'>&</span><span class='Parentheses'>(</span><a href="date.c.html#LN193"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN29"><span class='Ref_to_Member'>tm_mday</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../../include/utils/datetime.h.html#LN316"><span class='Ref_to_Proto'>EncodeDateOnly</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN193"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><a href="../init/globals.c.html#LN106"><span class='Ref_to_Global_Var'>DateStyle</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN194"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="date.c.html#LN191"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN194"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN321"><span class='Ref_to_Macro'>PG_RETURN_CSTRING</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN191"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end date_out &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 *      date_recv           - converts external binary format to date 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN213"></a><span class='Declare_Function'>date_recv</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN215"></a>    <a href="../../../include/lib/stringinfo.h.html#LN42"><span class='Ref_to_Typedef'>StringInfo</span></a>  <span class='Declare_Local'>buf</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/lib/stringinfo.h.html#LN42"><span class='Ref_to_Typedef'>StringInfo</span></a><span class='Parentheses'>) </span><a href="../../../include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN216"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN216"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a><span class='Parentheses'>) </span><a href="../../../include/libpq/pqformat.h.html#LN38"><span class='Ref_to_Proto'>pq_getmsgint</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN215"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Limit to the same range that date_in() accepts. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN41"><span class='Ref_to_Macro'>DATE_NOT_FINITE</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN216"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span> 
         <span class='Comment_Multi_Line'>/* ok */ </span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/datatype/timestamp.h.html#LN189"><span class='Ref_to_Macro'>IS_VALID_DATE</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN216"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"date out of range"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN63"><span class='Ref_to_Macro'>PG_RETURN_DATEADT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN216"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 *      date_send           - converts date to binary format 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN235"></a><span class='Declare_Function'>date_send</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN237"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>date</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN238"></a>    <a href="../../../include/lib/stringinfo.h.html#LN34"><span class='Ref_to_Struct'>StringInfoData</span></a> <span class='Declare_Local'>buf</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/libpq/pqformat.h.html#LN31"><span class='Ref_to_Proto'>pq_begintypsend</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="date.c.html#LN238"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/libpq/pqformat.h.html#LN25"><span class='Ref_to_Proto'>pq_sendint</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="date.c.html#LN238"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN237"><span class='Ref_To_Local'>date</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="date.c.html#LN237"><span class='Ref_To_Local'>date</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN328"><span class='Ref_to_Macro'>PG_RETURN_BYTEA_P</span></a><span class='Parentheses'>(</span><a href="../../../include/libpq/pqformat.h.html#LN32"><span class='Ref_to_Proto'>pq_endtypsend</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="date.c.html#LN238"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 *      make_date           - date constructor 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN249"></a><span class='Declare_Function'>make_date</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN251"></a>    <span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Declare_Local'>tm</span><span class='Delimiter'>; 
</span><a name="LN252"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>date</span><span class='Delimiter'>; 
</span><a name="LN253"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>dterr</span><span class='Delimiter'>; 
</span><a name="LN254"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>bc</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN251"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>.</span><a href="../../../include/pgtime.h.html#LN31"><span class='Ref_to_Member'>tm_year</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN251"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>.</span><a href="../../../include/pgtime.h.html#LN30"><span class='Ref_to_Member'>tm_mon</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN251"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>.</span><a href="../../../include/pgtime.h.html#LN29"><span class='Ref_to_Member'>tm_mday</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Handle negative years as BC */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN251"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>.</span><a href="../../../include/pgtime.h.html#LN31"><span class='Ref_to_Member'>tm_year</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="date.c.html#LN254"><span class='Ref_To_Local'>bc</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <a href="date.c.html#LN251"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>.</span><a href="../../../include/pgtime.h.html#LN31"><span class='Ref_to_Member'>tm_year</span></a> <span class='Operator'>= -</span><a href="date.c.html#LN251"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>.</span><a href="../../../include/pgtime.h.html#LN31"><span class='Ref_to_Member'>tm_year</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="date.c.html#LN253"><span class='Ref_To_Local'>dterr</span></a> <span class='Operator'>= </span><a href="../../../include/utils/datetime.h.html#LN322"><span class='Ref_to_Proto'>ValidateDate</span></a><span class='Parentheses'>(</span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN186"><span class='Ref_to_Const'>DTK_DATE_M</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><a href="date.c.html#LN254"><span class='Ref_To_Local'>bc</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN251"><span class='Ref_To_Local'>tm</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN253"><span class='Ref_To_Local'>dterr</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_FIELD_OVERFLOW<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"date field value out of range: %d-%02d-%02d"</span><span class='Delimiter'>, 
</span>                        <a href="date.c.html#LN251"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>.</span><a href="../../../include/pgtime.h.html#LN31"><span class='Ref_to_Member'>tm_year</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN251"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>.</span><a href="../../../include/pgtime.h.html#LN30"><span class='Ref_to_Member'>tm_mon</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN251"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>.</span><a href="../../../include/pgtime.h.html#LN29"><span class='Ref_to_Member'>tm_mday</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Prevent overflow in Julian-day routines */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/datatype/timestamp.h.html#LN154"><span class='Ref_to_Macro'>IS_VALID_JULIAN</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN251"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>.</span><a href="../../../include/pgtime.h.html#LN31"><span class='Ref_to_Member'>tm_year</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN251"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>.</span><a href="../../../include/pgtime.h.html#LN30"><span class='Ref_to_Member'>tm_mon</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN251"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>.</span><a href="../../../include/pgtime.h.html#LN29"><span class='Ref_to_Member'>tm_mday</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"date out of range: %d-%02d-%02d"</span><span class='Delimiter'>, 
</span>                        <a href="date.c.html#LN251"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>.</span><a href="../../../include/pgtime.h.html#LN31"><span class='Ref_to_Member'>tm_year</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN251"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>.</span><a href="../../../include/pgtime.h.html#LN30"><span class='Ref_to_Member'>tm_mon</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN251"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>.</span><a href="../../../include/pgtime.h.html#LN29"><span class='Ref_to_Member'>tm_mday</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN252"><span class='Ref_To_Local'>date</span></a> <span class='Operator'>= </span><a href="datetime.c.html#LN290"><span class='Ref_to_Func'>date2j</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN251"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>.</span><a href="../../../include/pgtime.h.html#LN31"><span class='Ref_to_Member'>tm_year</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN251"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>.</span><a href="../../../include/pgtime.h.html#LN30"><span class='Ref_to_Member'>tm_mon</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN251"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>.</span><a href="../../../include/pgtime.h.html#LN29"><span class='Ref_to_Member'>tm_mday</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="../../../include/datatype/timestamp.h.html#LN162"><span class='Ref_to_Const'>POSTGRES_EPOCH_JDATE</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Now check for just-out-of-range dates */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/datatype/timestamp.h.html#LN189"><span class='Ref_to_Macro'>IS_VALID_DATE</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN252"><span class='Ref_To_Local'>date</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"date out of range: %d-%02d-%02d"</span><span class='Delimiter'>, 
</span>                        <a href="date.c.html#LN251"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>.</span><a href="../../../include/pgtime.h.html#LN31"><span class='Ref_to_Member'>tm_year</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN251"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>.</span><a href="../../../include/pgtime.h.html#LN30"><span class='Ref_to_Member'>tm_mon</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN251"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>.</span><a href="../../../include/pgtime.h.html#LN29"><span class='Ref_to_Member'>tm_mday</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN63"><span class='Ref_to_Macro'>PG_RETURN_DATEADT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN252"><span class='Ref_To_Local'>date</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_date &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Convert reserved date values to string. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN298"></a><span class='Declare_Function'>EncodeSpecialDate</span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a> <span class='Declare_Parameter'>dt</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>str</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN38"><span class='Ref_to_Macro'>DATE_IS_NOBEGIN</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN298"><span class='Ref_to_Parameter'>dt</span></a><span class='Parentheses'>))</span> 
        <a href="../../../../contrib/cube/cubeparse.y.html#LN150"><span class='Ref_to_Proto'>strcpy</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN298"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>, </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN36"><span class='Ref_to_Const'>EARLY</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN40"><span class='Ref_to_Macro'>DATE_IS_NOEND</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN298"><span class='Ref_to_Parameter'>dt</span></a><span class='Parentheses'>))</span> 
        <a href="../../../../contrib/cube/cubeparse.y.html#LN150"><span class='Ref_to_Proto'>strcpy</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN298"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>, </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN37"><span class='Ref_to_Const'>LATE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span>    <span class='Comment_Single_Line'>/* shouldn't happen */ 
</span>        <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"invalid argument for EncodeSpecialDate"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * GetSQLCurrentDate -- implements CURRENT_DATE 
 */ 
</span><a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a> 
<a name="LN313"></a><span class='Declare_Function'>GetSQLCurrentDate</span><span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN315"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>ts</span><span class='Delimiter'>; 
</span><a name="LN316"></a>    <span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Declare_Local'>tt</span><span class='Delimiter'>, 
</span><a name="LN317"></a>               <span class='Operator'>*</span><span class='Declare_Local'>tm</span> <span class='Operator'>= &</span><a href="date.c.html#LN316"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span><a name="LN318"></a>    <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a>      <span class='Declare_Local'>fsec</span><span class='Delimiter'>; 
</span><a name="LN319"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>tz</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN315"><span class='Ref_To_Local'>ts</span></a> <span class='Operator'>= </span><a href="../../../include/access/xact.h.html#LN340"><span class='Ref_to_Proto'>GetCurrentTransactionStartTimestamp</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN84"><span class='Ref_to_Proto'>timestamp2tm</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN315"><span class='Ref_To_Local'>ts</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN319"><span class='Ref_To_Local'>tz</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN317"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN318"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"timestamp out of range"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="datetime.c.html#LN290"><span class='Ref_to_Func'>date2j</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN317"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN31"><span class='Ref_to_Member'>tm_year</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN317"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN30"><span class='Ref_to_Member'>tm_mon</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN317"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN29"><span class='Ref_to_Member'>tm_mday</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="../../../include/datatype/timestamp.h.html#LN162"><span class='Ref_to_Const'>POSTGRES_EPOCH_JDATE</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * GetSQLCurrentTime -- implements CURRENT_TIME, CURRENT_TIME(n) 
 */ 
</span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a> <span class='Operator'>* 
</span><a name="LN335"></a><span class='Declare_Function'>GetSQLCurrentTime</span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Declare_Parameter'>typmod</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN337"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN338"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>ts</span><span class='Delimiter'>; 
</span><a name="LN339"></a>    <span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Declare_Local'>tt</span><span class='Delimiter'>, 
</span><a name="LN340"></a>               <span class='Operator'>*</span><span class='Declare_Local'>tm</span> <span class='Operator'>= &</span><a href="date.c.html#LN339"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span><a name="LN341"></a>    <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a>      <span class='Declare_Local'>fsec</span><span class='Delimiter'>; 
</span><a name="LN342"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>tz</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN338"><span class='Ref_To_Local'>ts</span></a> <span class='Operator'>= </span><a href="../../../include/access/xact.h.html#LN340"><span class='Ref_to_Proto'>GetCurrentTransactionStartTimestamp</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN84"><span class='Ref_to_Proto'>timestamp2tm</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN338"><span class='Ref_To_Local'>ts</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN342"><span class='Ref_To_Local'>tz</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN340"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN341"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"timestamp out of range"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN337"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN46"><span class='Ref_to_Proto'>tm2timetz</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN340"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN341"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN342"><span class='Ref_To_Local'>tz</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN337"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN47"><span class='Ref_to_Proto'>AdjustTimeForTypmod</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><span class='Parentheses'>(</span><a href="date.c.html#LN337"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="date.c.html#LN335"><span class='Ref_to_Parameter'>typmod</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="date.c.html#LN337"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end GetSQLCurrentTime &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * GetSQLLocalTime -- implements LOCALTIME, LOCALTIME(n) 
 */ 
</span><a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a> 
<a name="LN361"></a><span class='Declare_Function'>GetSQLLocalTime</span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Declare_Parameter'>typmod</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN363"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN364"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>ts</span><span class='Delimiter'>; 
</span><a name="LN365"></a>    <span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Declare_Local'>tt</span><span class='Delimiter'>, 
</span><a name="LN366"></a>               <span class='Operator'>*</span><span class='Declare_Local'>tm</span> <span class='Operator'>= &</span><a href="date.c.html#LN365"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span><a name="LN367"></a>    <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a>      <span class='Declare_Local'>fsec</span><span class='Delimiter'>; 
</span><a name="LN368"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>tz</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN364"><span class='Ref_To_Local'>ts</span></a> <span class='Operator'>= </span><a href="../../../include/access/xact.h.html#LN340"><span class='Ref_to_Proto'>GetCurrentTransactionStartTimestamp</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN84"><span class='Ref_to_Proto'>timestamp2tm</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN364"><span class='Ref_To_Local'>ts</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN368"><span class='Ref_To_Local'>tz</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN366"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN367"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"timestamp out of range"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN45"><span class='Ref_to_Proto'>tm2time</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN366"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN367"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN363"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN47"><span class='Ref_to_Proto'>AdjustTimeForTypmod</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="date.c.html#LN363"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN361"><span class='Ref_to_Parameter'>typmod</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="date.c.html#LN363"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end GetSQLLocalTime &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * Comparison functions for dates 
 */ 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN388"></a><span class='Declare_Function'>date_eq</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN390"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN391"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN390"><span class='Ref_To_Local'>dateVal1</span></a> <span class='Operator'>== </span><a href="date.c.html#LN391"><span class='Ref_To_Local'>dateVal2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN397"></a><span class='Declare_Function'>date_ne</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN399"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN400"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN399"><span class='Ref_To_Local'>dateVal1</span></a> <span class='Operator'>!= </span><a href="date.c.html#LN400"><span class='Ref_To_Local'>dateVal2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN406"></a><span class='Declare_Function'>date_lt</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN408"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN409"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN408"><span class='Ref_To_Local'>dateVal1</span></a> <span class='Operator'>&LT; </span><a href="date.c.html#LN409"><span class='Ref_To_Local'>dateVal2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN415"></a><span class='Declare_Function'>date_le</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN417"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN418"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN417"><span class='Ref_To_Local'>dateVal1</span></a> <span class='Operator'>&LT;= </span><a href="date.c.html#LN418"><span class='Ref_To_Local'>dateVal2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN424"></a><span class='Declare_Function'>date_gt</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN426"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN427"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN426"><span class='Ref_To_Local'>dateVal1</span></a> <span class='Operator'>&GT; </span><a href="date.c.html#LN427"><span class='Ref_To_Local'>dateVal2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN433"></a><span class='Declare_Function'>date_ge</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN435"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN436"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN435"><span class='Ref_To_Local'>dateVal1</span></a> <span class='Operator'>&GT;= </span><a href="date.c.html#LN436"><span class='Ref_To_Local'>dateVal2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN442"></a><span class='Declare_Function'>date_cmp</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN444"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN445"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN444"><span class='Ref_To_Local'>dateVal1</span></a> <span class='Operator'>&LT; </span><a href="date.c.html#LN445"><span class='Ref_To_Local'>dateVal2</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN444"><span class='Ref_To_Local'>dateVal1</span></a> <span class='Operator'>&GT; </span><a href="date.c.html#LN445"><span class='Ref_To_Local'>dateVal2</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN455"></a><span class='Declare_Function'>date_fastcmp</span><span class='Parentheses'>(</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Declare_Parameter'>x</span><span class='Delimiter'>, </span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Declare_Parameter'>y</span><span class='Delimiter'>, </span><a href="../../../include/utils/sortsupport.h.html#LN57"><span class='Ref_to_Typedef'>SortSupport</span></a> <span class='Declare_Parameter'>ssup</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN457"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>a</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN51"><span class='Ref_to_Macro'>DatumGetDateADT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN455"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN458"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>b</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN51"><span class='Ref_to_Macro'>DatumGetDateADT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN455"><span class='Ref_to_Parameter'>y</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN457"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&LT; </span><a href="date.c.html#LN458"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN457"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&GT; </span><a href="date.c.html#LN458"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN468"></a><span class='Declare_Function'>date_sortsupport</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN470"></a>    <a href="../../../include/utils/sortsupport.h.html#LN57"><span class='Ref_to_Typedef'>SortSupport</span></a> <span class='Declare_Local'>ssup</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/sortsupport.h.html#LN57"><span class='Ref_to_Typedef'>SortSupport</span></a><span class='Parentheses'>) </span><a href="../../../include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN470"><span class='Ref_To_Local'>ssup</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/sortsupport.h.html#LN106"><span class='Ref_to_Member'>comparator</span></a> <span class='Operator'>= </span><a href="date.c.html#LN454"><span class='Ref_to_Func'>date_fastcmp</span></a><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN308"><span class='Ref_to_Macro'>PG_RETURN_VOID</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN477"></a><span class='Declare_Function'>date_finite</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN479"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>date</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/utils/date.h.html#LN41"><span class='Ref_to_Macro'>DATE_NOT_FINITE</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN479"><span class='Ref_To_Local'>date</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN485"></a><span class='Declare_Function'>date_larger</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN487"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN488"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN63"><span class='Ref_to_Macro'>PG_RETURN_DATEADT</span></a><span class='Parentheses'>((</span><a href="date.c.html#LN487"><span class='Ref_To_Local'>dateVal1</span></a> <span class='Operator'>&GT; </span><a href="date.c.html#LN488"><span class='Ref_To_Local'>dateVal2</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="date.c.html#LN487"><span class='Ref_To_Local'>dateVal1</span></a> <span class='Operator'>: </span><a href="date.c.html#LN488"><span class='Ref_To_Local'>dateVal2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN494"></a><span class='Declare_Function'>date_smaller</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN496"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN497"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN63"><span class='Ref_to_Macro'>PG_RETURN_DATEADT</span></a><span class='Parentheses'>((</span><a href="date.c.html#LN496"><span class='Ref_To_Local'>dateVal1</span></a> <span class='Operator'>&LT; </span><a href="date.c.html#LN497"><span class='Ref_To_Local'>dateVal2</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="date.c.html#LN496"><span class='Ref_To_Local'>dateVal1</span></a> <span class='Operator'>: </span><a href="date.c.html#LN497"><span class='Ref_To_Local'>dateVal2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* Compute difference between two dates in days. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN505"></a><span class='Declare_Function'>date_mi</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN507"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN508"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN41"><span class='Ref_to_Macro'>DATE_NOT_FINITE</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN507"><span class='Ref_To_Local'>dateVal1</span></a><span class='Parentheses'>) </span><span class='Operator'>|| </span><a href="../../../include/utils/date.h.html#LN41"><span class='Ref_to_Macro'>DATE_NOT_FINITE</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN508"><span class='Ref_To_Local'>dateVal2</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot subtract infinite dates"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>((</span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a><span class='Parentheses'>) (</span><a href="date.c.html#LN507"><span class='Ref_To_Local'>dateVal1</span></a> <span class='Operator'>- </span><a href="date.c.html#LN508"><span class='Ref_To_Local'>dateVal2</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* Add a number of days to a date, giving a new date. 
 * Must handle both positive and negative numbers of days. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN522"></a><span class='Declare_Function'>date_pli</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN524"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN525"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>days</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN526"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN41"><span class='Ref_to_Macro'>DATE_NOT_FINITE</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN524"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/utils/date.h.html#LN63"><span class='Ref_to_Macro'>PG_RETURN_DATEADT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN524"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* can't change infinity */ 
</span> 
    <a href="date.c.html#LN526"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN524"><span class='Ref_To_Local'>dateVal</span></a> <span class='Operator'>+ </span><a href="date.c.html#LN525"><span class='Ref_To_Local'>days</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Check for integer overflow and out-of-allowed-range */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="date.c.html#LN525"><span class='Ref_To_Local'>days</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span> <span class='Operator'>? </span><span class='Parentheses'>(</span><a href="date.c.html#LN526"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>&LT; </span><a href="date.c.html#LN524"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>) </span><span class='Operator'>: </span><span class='Parentheses'>(</span><a href="date.c.html#LN526"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>&GT; </span><a href="date.c.html#LN524"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>))</span> <span class='Operator'>|| 
</span>        <span class='Operator'>!</span><a href="../../../include/datatype/timestamp.h.html#LN189"><span class='Ref_to_Macro'>IS_VALID_DATE</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN526"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"date out of range"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN63"><span class='Ref_to_Macro'>PG_RETURN_DATEADT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN526"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end date_pli &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* Subtract a number of days from a date, giving a new date. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN546"></a><span class='Declare_Function'>date_mii</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN548"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN549"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>days</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN550"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN41"><span class='Ref_to_Macro'>DATE_NOT_FINITE</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN548"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/utils/date.h.html#LN63"><span class='Ref_to_Macro'>PG_RETURN_DATEADT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN548"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* can't change infinity */ 
</span> 
    <a href="date.c.html#LN550"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN548"><span class='Ref_To_Local'>dateVal</span></a> <span class='Operator'>- </span><a href="date.c.html#LN549"><span class='Ref_To_Local'>days</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Check for integer overflow and out-of-allowed-range */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="date.c.html#LN549"><span class='Ref_To_Local'>days</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span> <span class='Operator'>? </span><span class='Parentheses'>(</span><a href="date.c.html#LN550"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>&GT; </span><a href="date.c.html#LN548"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>) </span><span class='Operator'>: </span><span class='Parentheses'>(</span><a href="date.c.html#LN550"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>&LT; </span><a href="date.c.html#LN548"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>))</span> <span class='Operator'>|| 
</span>        <span class='Operator'>!</span><a href="../../../include/datatype/timestamp.h.html#LN189"><span class='Ref_to_Macro'>IS_VALID_DATE</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN550"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"date out of range"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN63"><span class='Ref_to_Macro'>PG_RETURN_DATEADT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN550"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end date_mii &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Internal routines for promoting date to timestamp and timestamp with 
 * time zone 
 */ 
</span> 
<span class='Keyword'>static </span><a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a> 
<a name="LN573"></a><span class='Declare_Function'>date2timestamp</span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a> <span class='Declare_Parameter'>dateVal</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN575"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN38"><span class='Ref_to_Macro'>DATE_IS_NOBEGIN</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN573"><span class='Ref_to_Parameter'>dateVal</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/datatype/timestamp.h.html#LN111"><span class='Ref_to_Macro'>TIMESTAMP_NOBEGIN</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN575"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN40"><span class='Ref_to_Macro'>DATE_IS_NOEND</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN573"><span class='Ref_to_Parameter'>dateVal</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/datatype/timestamp.h.html#LN116"><span class='Ref_to_Macro'>TIMESTAMP_NOEND</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN575"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Date's range is wider than timestamp's, so check for boundaries. 
         * Since dates have the same minimum values as timestamps, only upper 
         * boundary need be checked for overflow. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN573"><span class='Ref_to_Parameter'>dateVal</span></a> <span class='Operator'>&GT;= </span><span class='Parentheses'>(</span><a href="../../../include/datatype/timestamp.h.html#LN180"><span class='Ref_to_Const'>TIMESTAMP_END_JULIAN</span></a> <span class='Operator'>- </span><a href="../../../include/datatype/timestamp.h.html#LN162"><span class='Ref_to_Const'>POSTGRES_EPOCH_JDATE</span></a><span class='Parentheses'>))</span> 
            <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"date out of range for timestamp"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* date is days since 2000, timestamp is microseconds since same... */ 
</span>        <a href="date.c.html#LN575"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN573"><span class='Ref_to_Parameter'>dateVal</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="date.c.html#LN575"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end date2timestamp &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> 
<a name="LN601"></a><span class='Declare_Function'>date2timestamptz</span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a> <span class='Declare_Parameter'>dateVal</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN603"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN604"></a>    <span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Declare_Local'>tt</span><span class='Delimiter'>, 
</span><a name="LN605"></a>               <span class='Operator'>*</span><span class='Declare_Local'>tm</span> <span class='Operator'>= &</span><a href="date.c.html#LN604"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span><a name="LN606"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>tz</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN38"><span class='Ref_to_Macro'>DATE_IS_NOBEGIN</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN601"><span class='Ref_to_Parameter'>dateVal</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/datatype/timestamp.h.html#LN111"><span class='Ref_to_Macro'>TIMESTAMP_NOBEGIN</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN603"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN40"><span class='Ref_to_Macro'>DATE_IS_NOEND</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN601"><span class='Ref_to_Parameter'>dateVal</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/datatype/timestamp.h.html#LN116"><span class='Ref_to_Macro'>TIMESTAMP_NOEND</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN603"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Date's range is wider than timestamp's, so check for boundaries. 
         * Since dates have the same minimum values as timestamps, only upper 
         * boundary need be checked for overflow. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN601"><span class='Ref_to_Parameter'>dateVal</span></a> <span class='Operator'>&GT;= </span><span class='Parentheses'>(</span><a href="../../../include/datatype/timestamp.h.html#LN180"><span class='Ref_to_Const'>TIMESTAMP_END_JULIAN</span></a> <span class='Operator'>- </span><a href="../../../include/datatype/timestamp.h.html#LN162"><span class='Ref_to_Const'>POSTGRES_EPOCH_JDATE</span></a><span class='Parentheses'>))</span> 
            <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"date out of range for timestamp"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <a href="../../../include/utils/datetime.h.html#LN290"><span class='Ref_to_Proto'>j2date</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN601"><span class='Ref_to_Parameter'>dateVal</span></a> <span class='Operator'>+ </span><a href="../../../include/datatype/timestamp.h.html#LN162"><span class='Ref_to_Const'>POSTGRES_EPOCH_JDATE</span></a><span class='Delimiter'>, 
</span>               <span class='Operator'>&</span><span class='Parentheses'>(</span><a href="date.c.html#LN605"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN31"><span class='Ref_to_Member'>tm_year</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Operator'>&</span><span class='Parentheses'>(</span><a href="date.c.html#LN605"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN30"><span class='Ref_to_Member'>tm_mon</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Operator'>&</span><span class='Parentheses'>(</span><a href="date.c.html#LN605"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN29"><span class='Ref_to_Member'>tm_mday</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="date.c.html#LN605"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN28"><span class='Ref_to_Member'>tm_hour</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="date.c.html#LN605"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN27"><span class='Ref_to_Member'>tm_min</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="date.c.html#LN605"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN26"><span class='Ref_to_Member'>tm_sec</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="date.c.html#LN606"><span class='Ref_To_Local'>tz</span></a> <span class='Operator'>= </span><a href="../../../include/utils/datetime.h.html#LN311"><span class='Ref_to_Proto'>DetermineTimeZoneOffset</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN605"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><a href="../../../timezone/pgtz.c.html#LN27"><span class='Ref_to_Global_Var'>session_timezone</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="date.c.html#LN603"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN601"><span class='Ref_to_Parameter'>dateVal</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a> <span class='Operator'>+ </span><a href="date.c.html#LN606"><span class='Ref_To_Local'>tz</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN93"><span class='Ref_to_Const'>USECS_PER_SEC</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Since it is possible to go beyond allowed timestamptz range because 
         * of time zone, check for allowed timestamp range after adding tz. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/datatype/timestamp.h.html#LN194"><span class='Ref_to_Macro'>IS_VALID_TIMESTAMP</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN603"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span> 
            <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"date out of range for timestamp"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <span class='Control'>return</span> <a href="date.c.html#LN603"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end date2timestamptz &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * date2timestamp_no_overflow 
 * 
 * This is chartered to produce a double value that is numerically 
 * equivalent to the corresponding Timestamp value, if the date is in the 
 * valid range of Timestamps, but in any case not throw an overflow error. 
 * We can do this since the numerical range of double is greater than 
 * that of non-erroneous timestamps.  The results are currently only 
 * used for statistical estimation purposes. 
 */ 
</span><span class='Keyword'>double 
</span><a name="LN657"></a><span class='Declare_Function'>date2timestamp_no_overflow</span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a> <span class='Declare_Parameter'>dateVal</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN659"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN38"><span class='Ref_to_Macro'>DATE_IS_NOBEGIN</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN657"><span class='Ref_to_Parameter'>dateVal</span></a><span class='Parentheses'>))</span> 
        <a href="date.c.html#LN659"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= -</span>DBL_MAX<span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN40"><span class='Ref_to_Macro'>DATE_IS_NOEND</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN657"><span class='Ref_to_Parameter'>dateVal</span></a><span class='Parentheses'>))</span> 
        <a href="date.c.html#LN659"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span>DBL_MAX<span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* date is days since 2000, timestamp is microseconds since same... */ 
</span>        <a href="date.c.html#LN659"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN657"><span class='Ref_to_Parameter'>dateVal</span></a> <span class='Operator'>* </span><span class='Parentheses'>(</span><span class='Keyword'>double</span><span class='Parentheses'>) </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="date.c.html#LN659"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * Crosstype comparison functions for dates 
 */ 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN680"></a><span class='Declare_Function'>date_eq_timestamp</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN682"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN683"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt2</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN34"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN684"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt1</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN684"><span class='Ref_To_Local'>dt1</span></a> <span class='Operator'>= </span><a href="date.c.html#LN572"><span class='Ref_to_Func'>date2timestamp</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN682"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN94"><span class='Ref_to_Proto'>timestamp_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN684"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN683"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN692"></a><span class='Declare_Function'>date_ne_timestamp</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN694"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN695"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt2</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN34"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN696"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt1</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN696"><span class='Ref_To_Local'>dt1</span></a> <span class='Operator'>= </span><a href="date.c.html#LN572"><span class='Ref_to_Func'>date2timestamp</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN694"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN94"><span class='Ref_to_Proto'>timestamp_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN696"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN695"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN704"></a><span class='Declare_Function'>date_lt_timestamp</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN706"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN707"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt2</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN34"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN708"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt1</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN708"><span class='Ref_To_Local'>dt1</span></a> <span class='Operator'>= </span><a href="date.c.html#LN572"><span class='Ref_to_Func'>date2timestamp</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN706"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN94"><span class='Ref_to_Proto'>timestamp_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN708"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN707"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN716"></a><span class='Declare_Function'>date_gt_timestamp</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN718"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN719"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt2</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN34"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN720"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt1</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN720"><span class='Ref_To_Local'>dt1</span></a> <span class='Operator'>= </span><a href="date.c.html#LN572"><span class='Ref_to_Func'>date2timestamp</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN718"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN94"><span class='Ref_to_Proto'>timestamp_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN720"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN719"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN728"></a><span class='Declare_Function'>date_le_timestamp</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN730"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN731"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt2</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN34"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN732"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt1</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN732"><span class='Ref_To_Local'>dt1</span></a> <span class='Operator'>= </span><a href="date.c.html#LN572"><span class='Ref_to_Func'>date2timestamp</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN730"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN94"><span class='Ref_to_Proto'>timestamp_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN732"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN731"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN740"></a><span class='Declare_Function'>date_ge_timestamp</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN742"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN743"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt2</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN34"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN744"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt1</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN744"><span class='Ref_To_Local'>dt1</span></a> <span class='Operator'>= </span><a href="date.c.html#LN572"><span class='Ref_to_Func'>date2timestamp</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN742"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN94"><span class='Ref_to_Proto'>timestamp_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN744"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN743"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN752"></a><span class='Declare_Function'>date_cmp_timestamp</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN754"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN755"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt2</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN34"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMP</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN756"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt1</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN756"><span class='Ref_To_Local'>dt1</span></a> <span class='Operator'>= </span><a href="date.c.html#LN572"><span class='Ref_to_Func'>date2timestamp</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN754"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN94"><span class='Ref_to_Proto'>timestamp_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN756"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN755"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN764"></a><span class='Declare_Function'>date_eq_timestamptz</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN766"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN767"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt2</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN35"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMPTZ</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN768"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt1</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN768"><span class='Ref_To_Local'>dt1</span></a> <span class='Operator'>= </span><a href="date.c.html#LN600"><span class='Ref_to_Func'>date2timestamptz</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN766"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN97"><span class='Ref_to_Macro'>timestamptz_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN768"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN767"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN776"></a><span class='Declare_Function'>date_ne_timestamptz</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN778"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN779"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt2</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN35"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMPTZ</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN780"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt1</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN780"><span class='Ref_To_Local'>dt1</span></a> <span class='Operator'>= </span><a href="date.c.html#LN600"><span class='Ref_to_Func'>date2timestamptz</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN778"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN97"><span class='Ref_to_Macro'>timestamptz_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN780"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN779"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN788"></a><span class='Declare_Function'>date_lt_timestamptz</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN790"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN791"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt2</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN35"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMPTZ</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN792"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt1</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN792"><span class='Ref_To_Local'>dt1</span></a> <span class='Operator'>= </span><a href="date.c.html#LN600"><span class='Ref_to_Func'>date2timestamptz</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN790"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN97"><span class='Ref_to_Macro'>timestamptz_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN792"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN791"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN800"></a><span class='Declare_Function'>date_gt_timestamptz</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN802"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN803"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt2</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN35"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMPTZ</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN804"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt1</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN804"><span class='Ref_To_Local'>dt1</span></a> <span class='Operator'>= </span><a href="date.c.html#LN600"><span class='Ref_to_Func'>date2timestamptz</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN802"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN97"><span class='Ref_to_Macro'>timestamptz_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN804"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN803"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN812"></a><span class='Declare_Function'>date_le_timestamptz</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN814"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN815"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt2</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN35"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMPTZ</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN816"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt1</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN816"><span class='Ref_To_Local'>dt1</span></a> <span class='Operator'>= </span><a href="date.c.html#LN600"><span class='Ref_to_Func'>date2timestamptz</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN814"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN97"><span class='Ref_to_Macro'>timestamptz_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN816"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN815"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN824"></a><span class='Declare_Function'>date_ge_timestamptz</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN826"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN827"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt2</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN35"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMPTZ</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN828"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt1</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN828"><span class='Ref_To_Local'>dt1</span></a> <span class='Operator'>= </span><a href="date.c.html#LN600"><span class='Ref_to_Func'>date2timestamptz</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN826"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN97"><span class='Ref_to_Macro'>timestamptz_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN828"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN827"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN836"></a><span class='Declare_Function'>date_cmp_timestamptz</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN838"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN839"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt2</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN35"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMPTZ</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN840"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt1</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN840"><span class='Ref_To_Local'>dt1</span></a> <span class='Operator'>= </span><a href="date.c.html#LN600"><span class='Ref_to_Func'>date2timestamptz</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN838"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN97"><span class='Ref_to_Macro'>timestamptz_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN840"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN839"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN848"></a><span class='Declare_Function'>timestamp_eq_date</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN850"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt1</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN34"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN851"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN852"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt2</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN852"><span class='Ref_To_Local'>dt2</span></a> <span class='Operator'>= </span><a href="date.c.html#LN572"><span class='Ref_to_Func'>date2timestamp</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN851"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN94"><span class='Ref_to_Proto'>timestamp_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN850"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN852"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN860"></a><span class='Declare_Function'>timestamp_ne_date</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN862"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt1</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN34"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN863"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN864"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt2</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN864"><span class='Ref_To_Local'>dt2</span></a> <span class='Operator'>= </span><a href="date.c.html#LN572"><span class='Ref_to_Func'>date2timestamp</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN863"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN94"><span class='Ref_to_Proto'>timestamp_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN862"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN864"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN872"></a><span class='Declare_Function'>timestamp_lt_date</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN874"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt1</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN34"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN875"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN876"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt2</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN876"><span class='Ref_To_Local'>dt2</span></a> <span class='Operator'>= </span><a href="date.c.html#LN572"><span class='Ref_to_Func'>date2timestamp</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN875"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN94"><span class='Ref_to_Proto'>timestamp_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN874"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN876"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN884"></a><span class='Declare_Function'>timestamp_gt_date</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN886"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt1</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN34"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN887"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN888"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt2</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN888"><span class='Ref_To_Local'>dt2</span></a> <span class='Operator'>= </span><a href="date.c.html#LN572"><span class='Ref_to_Func'>date2timestamp</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN887"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN94"><span class='Ref_to_Proto'>timestamp_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN886"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN888"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN896"></a><span class='Declare_Function'>timestamp_le_date</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN898"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt1</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN34"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN899"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN900"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt2</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN900"><span class='Ref_To_Local'>dt2</span></a> <span class='Operator'>= </span><a href="date.c.html#LN572"><span class='Ref_to_Func'>date2timestamp</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN899"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN94"><span class='Ref_to_Proto'>timestamp_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN898"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN900"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN908"></a><span class='Declare_Function'>timestamp_ge_date</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN910"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt1</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN34"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN911"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN912"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt2</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN912"><span class='Ref_To_Local'>dt2</span></a> <span class='Operator'>= </span><a href="date.c.html#LN572"><span class='Ref_to_Func'>date2timestamp</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN911"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN94"><span class='Ref_to_Proto'>timestamp_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN910"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN912"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN920"></a><span class='Declare_Function'>timestamp_cmp_date</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN922"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt1</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN34"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN923"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN924"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dt2</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN924"><span class='Ref_To_Local'>dt2</span></a> <span class='Operator'>= </span><a href="date.c.html#LN572"><span class='Ref_to_Func'>date2timestamp</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN923"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN94"><span class='Ref_to_Proto'>timestamp_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN922"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN924"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN932"></a><span class='Declare_Function'>timestamptz_eq_date</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN934"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt1</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN35"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMPTZ</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN935"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN936"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt2</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN936"><span class='Ref_To_Local'>dt2</span></a> <span class='Operator'>= </span><a href="date.c.html#LN600"><span class='Ref_to_Func'>date2timestamptz</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN935"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN97"><span class='Ref_to_Macro'>timestamptz_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN934"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN936"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN944"></a><span class='Declare_Function'>timestamptz_ne_date</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN946"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt1</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN35"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMPTZ</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN947"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN948"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt2</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN948"><span class='Ref_To_Local'>dt2</span></a> <span class='Operator'>= </span><a href="date.c.html#LN600"><span class='Ref_to_Func'>date2timestamptz</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN947"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN97"><span class='Ref_to_Macro'>timestamptz_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN946"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN948"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN956"></a><span class='Declare_Function'>timestamptz_lt_date</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN958"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt1</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN35"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMPTZ</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN959"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN960"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt2</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN960"><span class='Ref_To_Local'>dt2</span></a> <span class='Operator'>= </span><a href="date.c.html#LN600"><span class='Ref_to_Func'>date2timestamptz</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN959"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN97"><span class='Ref_to_Macro'>timestamptz_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN958"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN960"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN968"></a><span class='Declare_Function'>timestamptz_gt_date</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN970"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt1</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN35"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMPTZ</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN971"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN972"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt2</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN972"><span class='Ref_To_Local'>dt2</span></a> <span class='Operator'>= </span><a href="date.c.html#LN600"><span class='Ref_to_Func'>date2timestamptz</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN971"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN97"><span class='Ref_to_Macro'>timestamptz_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN970"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN972"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN980"></a><span class='Declare_Function'>timestamptz_le_date</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN982"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt1</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN35"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMPTZ</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN983"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN984"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt2</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN984"><span class='Ref_To_Local'>dt2</span></a> <span class='Operator'>= </span><a href="date.c.html#LN600"><span class='Ref_to_Func'>date2timestamptz</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN983"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN97"><span class='Ref_to_Macro'>timestamptz_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN982"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN984"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN992"></a><span class='Declare_Function'>timestamptz_ge_date</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN994"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt1</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN35"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMPTZ</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN995"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN996"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt2</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN996"><span class='Ref_To_Local'>dt2</span></a> <span class='Operator'>= </span><a href="date.c.html#LN600"><span class='Ref_to_Func'>date2timestamptz</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN995"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN97"><span class='Ref_to_Macro'>timestamptz_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN994"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN996"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1004"></a><span class='Declare_Function'>timestamptz_cmp_date</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1006"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt1</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN35"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMPTZ</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1007"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1008"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>dt2</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN1008"><span class='Ref_To_Local'>dt2</span></a> <span class='Operator'>= </span><a href="date.c.html#LN600"><span class='Ref_to_Func'>date2timestamptz</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1007"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN97"><span class='Ref_to_Macro'>timestamptz_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1006"><span class='Ref_To_Local'>dt1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1008"><span class='Ref_To_Local'>dt2</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* Add an interval to a date, giving a new date. 
 * Must handle both positive and negative intervals. 
 * 
 * We implement this by promoting the date to timestamp (without time zone) 
 * and then using the timestamp plus interval function. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1023"></a><span class='Declare_Function'>date_pl_interval</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1025"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1026"></a>    <a href="../../../include/datatype/timestamp.h.html#LN42"><span class='Ref_to_Typedef'>Interval</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>span</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN36"><span class='Ref_to_Macro'>PG_GETARG_INTERVAL_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1027"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dateStamp</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN1027"><span class='Ref_To_Local'>dateStamp</span></a> <span class='Operator'>= </span><a href="date.c.html#LN572"><span class='Ref_to_Func'>date2timestamp</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1025"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="../../../include/fmgr.h.html#LN585"><span class='Ref_to_Macro'>DirectFunctionCall2</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN2774"><span class='Ref_to_Func'>timestamp_pl_interval</span></a><span class='Delimiter'>, 
</span>                               <a href="../../../include/utils/timestamp.h.html#LN30"><span class='Ref_to_Macro'>TimestampGetDatum</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1027"><span class='Ref_To_Local'>dateStamp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                               <a href="../../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1026"><span class='Ref_To_Local'>span</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* Subtract an interval from a date, giving a new date. 
 * Must handle both positive and negative intervals. 
 * 
 * We implement this by promoting the date to timestamp (without time zone) 
 * and then using the timestamp minus interval function. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1043"></a><span class='Declare_Function'>date_mi_interval</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1045"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1046"></a>    <a href="../../../include/datatype/timestamp.h.html#LN42"><span class='Ref_to_Typedef'>Interval</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>span</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN36"><span class='Ref_to_Macro'>PG_GETARG_INTERVAL_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1047"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>dateStamp</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN1047"><span class='Ref_To_Local'>dateStamp</span></a> <span class='Operator'>= </span><a href="date.c.html#LN572"><span class='Ref_to_Func'>date2timestamp</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1045"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="../../../include/fmgr.h.html#LN585"><span class='Ref_to_Macro'>DirectFunctionCall2</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN2853"><span class='Ref_to_Func'>timestamp_mi_interval</span></a><span class='Delimiter'>, 
</span>                               <a href="../../../include/utils/timestamp.h.html#LN30"><span class='Ref_to_Macro'>TimestampGetDatum</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1047"><span class='Ref_To_Local'>dateStamp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                               <a href="../../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1046"><span class='Ref_To_Local'>span</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* date_timestamp() 
 * Convert date to timestamp data type. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1060"></a><span class='Declare_Function'>date_timestamp</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1062"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1063"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN1063"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN572"><span class='Ref_to_Func'>date2timestamp</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1062"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/timestamp.h.html#LN38"><span class='Ref_to_Macro'>PG_RETURN_TIMESTAMP</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1063"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* timestamp_date() 
 * Convert timestamp to date data type. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1074"></a><span class='Declare_Function'>timestamp_date</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1076"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>timestamp</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN34"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1077"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1078"></a>    <span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Declare_Local'>tt</span><span class='Delimiter'>, 
</span><a name="LN1079"></a>               <span class='Operator'>*</span><span class='Declare_Local'>tm</span> <span class='Operator'>= &</span><a href="date.c.html#LN1078"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span><a name="LN1080"></a>    <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a>      <span class='Declare_Local'>fsec</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/datatype/timestamp.h.html#LN114"><span class='Ref_to_Macro'>TIMESTAMP_IS_NOBEGIN</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1076"><span class='Ref_To_Local'>timestamp</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/utils/date.h.html#LN37"><span class='Ref_to_Macro'>DATE_NOBEGIN</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1077"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/datatype/timestamp.h.html#LN119"><span class='Ref_to_Macro'>TIMESTAMP_IS_NOEND</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1076"><span class='Ref_To_Local'>timestamp</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/utils/date.h.html#LN39"><span class='Ref_to_Macro'>DATE_NOEND</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1077"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN84"><span class='Ref_to_Proto'>timestamp2tm</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1076"><span class='Ref_To_Local'>timestamp</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="date.c.html#LN1079"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN1080"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"timestamp out of range"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <a href="date.c.html#LN1077"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="datetime.c.html#LN290"><span class='Ref_to_Func'>date2j</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1079"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN31"><span class='Ref_to_Member'>tm_year</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1079"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN30"><span class='Ref_to_Member'>tm_mon</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1079"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN29"><span class='Ref_to_Member'>tm_mday</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="../../../include/datatype/timestamp.h.html#LN162"><span class='Ref_to_Const'>POSTGRES_EPOCH_JDATE</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../../include/utils/date.h.html#LN63"><span class='Ref_to_Macro'>PG_RETURN_DATEADT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1077"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end timestamp_date &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* date_timestamptz() 
 * Convert date to timestamp with time zone data type. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1104"></a><span class='Declare_Function'>date_timestamptz</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1106"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>dateVal</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1107"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN1107"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN600"><span class='Ref_to_Func'>date2timestamptz</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1106"><span class='Ref_To_Local'>dateVal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/timestamp.h.html#LN38"><span class='Ref_to_Macro'>PG_RETURN_TIMESTAMP</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1107"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* timestamptz_date() 
 * Convert timestamp with time zone to date data type. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1119"></a><span class='Declare_Function'>timestamptz_date</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1121"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>timestamp</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN34"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1122"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1123"></a>    <span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Declare_Local'>tt</span><span class='Delimiter'>, 
</span><a name="LN1124"></a>               <span class='Operator'>*</span><span class='Declare_Local'>tm</span> <span class='Operator'>= &</span><a href="date.c.html#LN1123"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span><a name="LN1125"></a>    <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a>      <span class='Declare_Local'>fsec</span><span class='Delimiter'>; 
</span><a name="LN1126"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>tz</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/datatype/timestamp.h.html#LN114"><span class='Ref_to_Macro'>TIMESTAMP_IS_NOBEGIN</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1121"><span class='Ref_To_Local'>timestamp</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/utils/date.h.html#LN37"><span class='Ref_to_Macro'>DATE_NOBEGIN</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1122"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/datatype/timestamp.h.html#LN119"><span class='Ref_to_Macro'>TIMESTAMP_IS_NOEND</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1121"><span class='Ref_To_Local'>timestamp</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/utils/date.h.html#LN39"><span class='Ref_to_Macro'>DATE_NOEND</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1122"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN84"><span class='Ref_to_Proto'>timestamp2tm</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1121"><span class='Ref_To_Local'>timestamp</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN1126"><span class='Ref_To_Local'>tz</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1124"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN1125"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"timestamp out of range"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <a href="date.c.html#LN1122"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="datetime.c.html#LN290"><span class='Ref_to_Func'>date2j</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1124"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN31"><span class='Ref_to_Member'>tm_year</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1124"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN30"><span class='Ref_to_Member'>tm_mon</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1124"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN29"><span class='Ref_to_Member'>tm_mday</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="../../../include/datatype/timestamp.h.html#LN162"><span class='Ref_to_Const'>POSTGRES_EPOCH_JDATE</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../../include/utils/date.h.html#LN63"><span class='Ref_to_Macro'>PG_RETURN_DATEADT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1122"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end timestamptz_date &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* abstime_date() 
 * Convert abstime to date data type. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1150"></a><span class='Declare_Function'>abstime_date</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1152"></a>    <a href="../../../interfaces/ecpg/pgtypeslib/dt_common.c.html#LN16"><span class='Ref_to_Typedef'>AbsoluteTime</span></a> <span class='Declare_Local'>abstime</span> <span class='Operator'>= </span><a href="../../../include/utils/nabstime.h.html#LN57"><span class='Ref_to_Macro'>PG_GETARG_ABSOLUTETIME</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1153"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1154"></a>    <span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Declare_Local'>tt</span><span class='Delimiter'>, 
</span><a name="LN1155"></a>               <span class='Operator'>*</span><span class='Declare_Local'>tm</span> <span class='Operator'>= &</span><a href="date.c.html#LN1154"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span><a name="LN1156"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>tz</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1152"><span class='Ref_To_Local'>abstime</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../../include/utils/nabstime.h.html#LN75"><span class='Ref_to_Const'>INVALID_ABSTIME</span></a><span class='Operator'>: 
</span>            <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                   <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot convert reserved abstime value to date"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <a href="date.c.html#LN1153"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>;</span>         <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/utils/nabstime.h.html#LN77"><span class='Ref_to_Const'>NOSTART_ABSTIME</span></a><span class='Operator'>: 
</span>            <a href="../../../include/utils/date.h.html#LN37"><span class='Ref_to_Macro'>DATE_NOBEGIN</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1153"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/utils/nabstime.h.html#LN76"><span class='Ref_to_Const'>NOEND_ABSTIME</span></a><span class='Operator'>: 
</span>            <a href="../../../include/utils/date.h.html#LN39"><span class='Ref_to_Macro'>DATE_NOEND</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1153"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="nabstime.c.html#LN97"><span class='Ref_to_Func'>abstime2tm</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1152"><span class='Ref_To_Local'>abstime</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN1156"><span class='Ref_To_Local'>tz</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1155"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* Prevent overflow in Julian-day routines */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/datatype/timestamp.h.html#LN154"><span class='Ref_to_Macro'>IS_VALID_JULIAN</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1155"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN31"><span class='Ref_to_Member'>tm_year</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1155"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN30"><span class='Ref_to_Member'>tm_mon</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1155"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN29"><span class='Ref_to_Member'>tm_mday</span></a><span class='Parentheses'>))</span> 
                <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"abstime out of range for date"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <a href="date.c.html#LN1153"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="datetime.c.html#LN290"><span class='Ref_to_Func'>date2j</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1155"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN31"><span class='Ref_to_Member'>tm_year</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1155"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN30"><span class='Ref_to_Member'>tm_mon</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1155"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN29"><span class='Ref_to_Member'>tm_mday</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="../../../include/datatype/timestamp.h.html#LN162"><span class='Ref_to_Const'>POSTGRES_EPOCH_JDATE</span></a><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* Now check for just-out-of-range dates */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/datatype/timestamp.h.html#LN189"><span class='Ref_to_Macro'>IS_VALID_DATE</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1153"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span> 
                <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"abstime out of range for date"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch abstime &raquo; </span> 
 
    <a href="../../../include/utils/date.h.html#LN63"><span class='Ref_to_Macro'>PG_RETURN_DATEADT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1153"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end abstime_date &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/***************************************************************************** 
 *   Time ADT 
 *****************************************************************************/ 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1200"></a><span class='Declare_Function'>time_in</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1202"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>str</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN241"><span class='Ref_to_Macro'>PG_GETARG_CSTRING</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Directive'>#ifdef</span> NOT_USED 
<a name="LN1205"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>typelem</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
<a name="LN1207"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>typmod</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1208"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1209"></a>    <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a>      <span class='Declare_Local'>fsec</span><span class='Delimiter'>; 
</span><a name="LN1210"></a>    <span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Declare_Local'>tt</span><span class='Delimiter'>, 
</span><a name="LN1211"></a>               <span class='Operator'>*</span><span class='Declare_Local'>tm</span> <span class='Operator'>= &</span><a href="date.c.html#LN1210"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span><a name="LN1212"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>tz</span><span class='Delimiter'>; 
</span><a name="LN1213"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>nf</span><span class='Delimiter'>; 
</span><a name="LN1214"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>dterr</span><span class='Delimiter'>; 
</span><a name="LN1215"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>workbuf</span><span class='Delimiter'>[</span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN195"><span class='Ref_to_Const'>MAXDATELEN</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span><a name="LN1216"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>field</span><span class='Delimiter'>[</span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN197"><span class='Ref_to_Const'>MAXDATEFIELDS</span></a><span class='Delimiter'>]; 
</span><a name="LN1217"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>dtype</span><span class='Delimiter'>; 
</span><a name="LN1218"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>ftype</span><span class='Delimiter'>[</span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN197"><span class='Ref_to_Const'>MAXDATEFIELDS</span></a><span class='Delimiter'>]; 
</span> 
    <a href="date.c.html#LN1214"><span class='Ref_To_Local'>dterr</span></a> <span class='Operator'>= </span><a href="../../../include/utils/datetime.h.html#LN293"><span class='Ref_to_Proto'>ParseDateTime</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1202"><span class='Ref_To_Local'>str</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1215"><span class='Ref_To_Local'>workbuf</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="date.c.html#LN1215"><span class='Ref_To_Local'>workbuf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                          <a href="date.c.html#LN1216"><span class='Ref_To_Local'>field</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1218"><span class='Ref_To_Local'>ftype</span></a><span class='Delimiter'>, </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN197"><span class='Ref_to_Const'>MAXDATEFIELDS</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN1213"><span class='Ref_To_Local'>nf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1214"><span class='Ref_To_Local'>dterr</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="date.c.html#LN1214"><span class='Ref_To_Local'>dterr</span></a> <span class='Operator'>= </span><a href="../../../include/utils/datetime.h.html#LN300"><span class='Ref_to_Proto'>DecodeTimeOnly</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1216"><span class='Ref_To_Local'>field</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1218"><span class='Ref_To_Local'>ftype</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1213"><span class='Ref_To_Local'>nf</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN1217"><span class='Ref_To_Local'>dtype</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1211"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN1209"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN1212"><span class='Ref_To_Local'>tz</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1214"><span class='Ref_To_Local'>dterr</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="datetime.c.html#LN3763"><span class='Ref_to_Func'>DateTimeParseError</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1214"><span class='Ref_To_Local'>dterr</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1202"><span class='Ref_To_Local'>str</span></a><span class='Delimiter'>, </span><span class='String'>"time"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN45"><span class='Ref_to_Proto'>tm2time</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1211"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1209"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN1208"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN47"><span class='Ref_to_Proto'>AdjustTimeForTypmod</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="date.c.html#LN1208"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1207"><span class='Ref_To_Local'>typmod</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN64"><span class='Ref_to_Macro'>PG_RETURN_TIMEADT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1208"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end time_in &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* tm2time() 
 * Convert a tm structure to a time data type. 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN1237"></a><span class='Declare_Function'>tm2time</span><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>tm</span><span class='Delimiter'>, </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a> <span class='Declare_Parameter'>fsec</span><span class='Delimiter'>, </span><a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>result</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Operator'>*</span><a href="date.c.html#LN1237"><span class='Ref_to_Parameter'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>((((</span><a href="date.c.html#LN1237"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN28"><span class='Ref_to_Member'>tm_hour</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN88"><span class='Ref_to_Const'>MINS_PER_HOUR</span></a> <span class='Operator'>+ </span><a href="date.c.html#LN1237"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN27"><span class='Ref_to_Member'>tm_min</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN87"><span class='Ref_to_Const'>SECS_PER_MINUTE</span></a><span class='Parentheses'>)</span> <span class='Operator'>+ </span><a href="date.c.html#LN1237"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN26"><span class='Ref_to_Member'>tm_sec</span></a><span class='Parentheses'>)</span> 
               <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN93"><span class='Ref_to_Const'>USECS_PER_SEC</span></a><span class='Parentheses'>)</span> <span class='Operator'>+ </span><a href="date.c.html#LN1237"><span class='Ref_to_Parameter'>fsec</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* time2tm() 
 * Convert time data type to POSIX time structure. 
 * 
 * For dates within the range of pg_time_t, convert to the local time zone. 
 * If out of this range, leave as UTC (in practice that could only happen 
 * if pg_time_t is just 32 bits) - thomas 97/05/27 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN1252"></a><span class='Declare_Function'>time2tm</span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a> <span class='Declare_Parameter'>time</span><span class='Delimiter'>, </span><span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>tm</span><span class='Delimiter'>, </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>fsec</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="date.c.html#LN1252"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN28"><span class='Ref_to_Member'>tm_hour</span></a> <span class='Operator'>= </span><a href="date.c.html#LN1252"><span class='Ref_to_Parameter'>time</span></a> <span class='Operator'>/ </span><a href="../../../include/datatype/timestamp.h.html#LN91"><span class='Ref_to_Const'>USECS_PER_HOUR</span></a><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN1252"><span class='Ref_to_Parameter'>time</span></a> <span class='Operator'>-= </span><a href="date.c.html#LN1252"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN28"><span class='Ref_to_Member'>tm_hour</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN91"><span class='Ref_to_Const'>USECS_PER_HOUR</span></a><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN1252"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN27"><span class='Ref_to_Member'>tm_min</span></a> <span class='Operator'>= </span><a href="date.c.html#LN1252"><span class='Ref_to_Parameter'>time</span></a> <span class='Operator'>/ </span><a href="../../../include/datatype/timestamp.h.html#LN92"><span class='Ref_to_Const'>USECS_PER_MINUTE</span></a><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN1252"><span class='Ref_to_Parameter'>time</span></a> <span class='Operator'>-= </span><a href="date.c.html#LN1252"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN27"><span class='Ref_to_Member'>tm_min</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN92"><span class='Ref_to_Const'>USECS_PER_MINUTE</span></a><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN1252"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN26"><span class='Ref_to_Member'>tm_sec</span></a> <span class='Operator'>= </span><a href="date.c.html#LN1252"><span class='Ref_to_Parameter'>time</span></a> <span class='Operator'>/ </span><a href="../../../include/datatype/timestamp.h.html#LN93"><span class='Ref_to_Const'>USECS_PER_SEC</span></a><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN1252"><span class='Ref_to_Parameter'>time</span></a> <span class='Operator'>-= </span><a href="date.c.html#LN1252"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN26"><span class='Ref_to_Member'>tm_sec</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN93"><span class='Ref_to_Const'>USECS_PER_SEC</span></a><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="date.c.html#LN1252"><span class='Ref_to_Parameter'>fsec</span></a> <span class='Operator'>= </span><a href="date.c.html#LN1252"><span class='Ref_to_Parameter'>time</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1265"></a><span class='Declare_Function'>time_out</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1267"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1268"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1269"></a>    <span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Declare_Local'>tt</span><span class='Delimiter'>, 
</span><a name="LN1270"></a>               <span class='Operator'>*</span><span class='Declare_Local'>tm</span> <span class='Operator'>= &</span><a href="date.c.html#LN1269"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span><a name="LN1271"></a>    <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a>      <span class='Declare_Local'>fsec</span><span class='Delimiter'>; 
</span><a name="LN1272"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>buf</span><span class='Delimiter'>[</span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN195"><span class='Ref_to_Const'>MAXDATELEN</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span> 
    <a href="date.c.html#LN43"><span class='Ref_to_Proto'>time2tm</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1267"><span class='Ref_To_Local'>time</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1270"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN1271"><span class='Ref_To_Local'>fsec</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/datetime.h.html#LN317"><span class='Ref_to_Proto'>EncodeTimeOnly</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1270"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1271"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="../init/globals.c.html#LN106"><span class='Ref_to_Global_Var'>DateStyle</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1272"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN1268"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1272"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN321"><span class='Ref_to_Macro'>PG_RETURN_CSTRING</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1268"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 *      time_recv           - converts external binary format to time 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1285"></a><span class='Declare_Function'>time_recv</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1287"></a>    <a href="../../../include/lib/stringinfo.h.html#LN42"><span class='Ref_to_Typedef'>StringInfo</span></a>  <span class='Declare_Local'>buf</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/lib/stringinfo.h.html#LN42"><span class='Ref_to_Typedef'>StringInfo</span></a><span class='Parentheses'>) </span><a href="../../../include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Directive'>#ifdef</span> NOT_USED 
<a name="LN1290"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>typelem</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
<a name="LN1292"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>typmod</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1293"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN1293"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/libpq/pqformat.h.html#LN39"><span class='Ref_to_Proto'>pq_getmsgint64</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1287"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1293"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>&LT; </span><a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>) </span><span class='Operator'>|| </span><a href="date.c.html#LN1293"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>&GT; </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Parentheses'>)</span> 
        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"time out of range"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN47"><span class='Ref_to_Proto'>AdjustTimeForTypmod</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="date.c.html#LN1293"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1292"><span class='Ref_To_Local'>typmod</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN64"><span class='Ref_to_Macro'>PG_RETURN_TIMEADT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1293"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end time_recv &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 *      time_send           - converts time to binary format 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1311"></a><span class='Declare_Function'>time_send</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1313"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1314"></a>    <a href="../../../include/lib/stringinfo.h.html#LN34"><span class='Ref_to_Struct'>StringInfoData</span></a> <span class='Declare_Local'>buf</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/libpq/pqformat.h.html#LN31"><span class='Ref_to_Proto'>pq_begintypsend</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="date.c.html#LN1314"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/libpq/pqformat.h.html#LN26"><span class='Ref_to_Proto'>pq_sendint64</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="date.c.html#LN1314"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1313"><span class='Ref_To_Local'>time</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN328"><span class='Ref_to_Macro'>PG_RETURN_BYTEA_P</span></a><span class='Parentheses'>(</span><a href="../../../include/libpq/pqformat.h.html#LN32"><span class='Ref_to_Proto'>pq_endtypsend</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="date.c.html#LN1314"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1322"></a><span class='Declare_Function'>timetypmodin</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1324"></a>    <a href="../../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>ta</span> <span class='Operator'>= </span><a href="../../../include/utils/array.h.html#LN243"><span class='Ref_to_Macro'>PG_GETARG_ARRAYTYPE_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN51"><span class='Ref_to_Func'>anytime_typmodin</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Delimiter'>, </span><a href="date.c.html#LN1324"><span class='Ref_To_Local'>ta</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1330"></a><span class='Declare_Function'>timetypmodout</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1332"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>typmod</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN321"><span class='Ref_to_Macro'>PG_RETURN_CSTRING</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN94"><span class='Ref_to_Func'>anytime_typmodout</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Delimiter'>, </span><a href="date.c.html#LN1332"><span class='Ref_To_Local'>typmod</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 *      make_time           - time constructor 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1341"></a><span class='Declare_Function'>make_time</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1343"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>tm_hour</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1344"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>tm_min</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1345"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>sec</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN245"><span class='Ref_to_Macro'>PG_GETARG_FLOAT8</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1346"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* This should match the checks in DecodeTimeOnly */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1343"><span class='Ref_To_Local'>tm_hour</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="date.c.html#LN1344"><span class='Ref_To_Local'>tm_min</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="date.c.html#LN1344"><span class='Ref_To_Local'>tm_min</span></a> <span class='Operator'>&GT; </span><a href="../../../include/datatype/timestamp.h.html#LN88"><span class='Ref_to_Const'>MINS_PER_HOUR</span></a> <span class='Operator'>- </span><span class='Number'>1</span> <span class='Operator'>|| 
</span>        <a href="date.c.html#LN1345"><span class='Ref_To_Local'>sec</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="date.c.html#LN1345"><span class='Ref_To_Local'>sec</span></a> <span class='Operator'>&GT; </span><a href="../../../include/datatype/timestamp.h.html#LN87"><span class='Ref_to_Const'>SECS_PER_MINUTE</span></a> <span class='Operator'>|| 
</span>        <a href="date.c.html#LN1343"><span class='Ref_To_Local'>tm_hour</span></a> <span class='Operator'>&GT; </span><a href="../../../include/datatype/timestamp.h.html#LN77"><span class='Ref_to_Const'>HOURS_PER_DAY</span></a> <span class='Operator'>|| 
</span>    <span class='Comment_Multi_Line'>/* test for &GT; 24:00:00 */ 
</span>        <span class='Parentheses'>(</span><a href="date.c.html#LN1343"><span class='Ref_To_Local'>tm_hour</span></a> <span class='Operator'>== </span><a href="../../../include/datatype/timestamp.h.html#LN77"><span class='Ref_to_Const'>HOURS_PER_DAY</span></a> <span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="date.c.html#LN1344"><span class='Ref_To_Local'>tm_min</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="date.c.html#LN1345"><span class='Ref_To_Local'>sec</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)))</span> 
        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_FIELD_OVERFLOW<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"time field value out of range: %d:%02d:%02g"</span><span class='Delimiter'>, 
</span>                        <a href="date.c.html#LN1343"><span class='Ref_To_Local'>tm_hour</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1344"><span class='Ref_To_Local'>tm_min</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1345"><span class='Ref_To_Local'>sec</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* This should match tm2time */ 
</span>    <a href="date.c.html#LN1346"><span class='Ref_To_Local'>time</span></a> <span class='Operator'>= </span><span class='Parentheses'>(((</span><a href="date.c.html#LN1343"><span class='Ref_To_Local'>tm_hour</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN88"><span class='Ref_to_Const'>MINS_PER_HOUR</span></a> <span class='Operator'>+ </span><a href="date.c.html#LN1344"><span class='Ref_To_Local'>tm_min</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN87"><span class='Ref_to_Const'>SECS_PER_MINUTE</span></a><span class='Parentheses'>)</span> 
            <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN93"><span class='Ref_to_Const'>USECS_PER_SEC</span></a><span class='Parentheses'>)</span> <span class='Operator'>+ </span><a href="../../../port/rint.c.html#LN20"><span class='Ref_to_Func'>rint</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1345"><span class='Ref_To_Local'>sec</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN93"><span class='Ref_to_Const'>USECS_PER_SEC</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN64"><span class='Ref_to_Macro'>PG_RETURN_TIMEADT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1346"><span class='Ref_To_Local'>time</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_time &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* time_transform() 
 * Flatten calls to time_scale() and timetz_scale() that solely represent 
 * increases in allowed precision. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1372"></a><span class='Declare_Function'>time_transform</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="../../../include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/datetime.h.html#LN332"><span class='Ref_to_Proto'>TemporalTransform</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN49"><span class='Ref_to_Const'>MAX_TIME_PRECISION</span></a><span class='Delimiter'>, 
</span>                                        <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* time_scale() 
 * Adjust time type for specified scale factor. 
 * Used by PostgreSQL type system to stuff columns. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1383"></a><span class='Declare_Function'>time_scale</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1385"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1386"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>typmod</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1387"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN1387"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN1385"><span class='Ref_To_Local'>time</span></a><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN47"><span class='Ref_to_Proto'>AdjustTimeForTypmod</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="date.c.html#LN1387"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1386"><span class='Ref_To_Local'>typmod</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN64"><span class='Ref_to_Macro'>PG_RETURN_TIMEADT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1387"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* AdjustTimeForTypmod() 
 * Force the precision of the time value to a specified value. 
 * Uses *exactly* the same code as in AdjustTimestampForTypemod() 
 * but we make a separate copy because those types do not 
 * have a fundamental tie together but rather a coincidence of 
 * implementation. - thomas 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN1403"></a><span class='Declare_Function'>AdjustTimeForTypmod</span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>time</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Declare_Parameter'>typmod</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1405"></a>    <span class='Keyword'>static const </span><a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a> <span class='Declare_Local'>TimeScales</span><span class='Delimiter'>[</span><a href="../../../include/utils/date.h.html#LN49"><span class='Ref_to_Const'>MAX_TIME_PRECISION</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Delimiter'>{ 
</span>        <a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>1000000</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>        <a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>100000</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>        <a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>10000</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>        <a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>1000</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>        <a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>100</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>        <a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>10</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>        <a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>}; 
</span> 
<a name="LN1415"></a>    <span class='Keyword'>static const </span><a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a> <span class='Declare_Local'>TimeOffsets</span><span class='Delimiter'>[</span><a href="../../../include/utils/date.h.html#LN49"><span class='Ref_to_Const'>MAX_TIME_PRECISION</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Delimiter'>{ 
</span>        <a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>500000</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>        <a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>50000</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>        <a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>5000</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>        <a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>500</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>        <a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>50</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>        <a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>5</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>        <a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>}; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1403"><span class='Ref_to_Parameter'>typmod</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="date.c.html#LN1403"><span class='Ref_to_Parameter'>typmod</span></a> <span class='Operator'>&LT;= </span><a href="../../../include/utils/date.h.html#LN49"><span class='Ref_to_Const'>MAX_TIME_PRECISION</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="date.c.html#LN1403"><span class='Ref_to_Parameter'>time</span></a> <span class='Operator'>&GT;= </span><a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>))</span> 
            <span class='Operator'>*</span><a href="date.c.html#LN1403"><span class='Ref_to_Parameter'>time</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><span class='Operator'>*</span><a href="date.c.html#LN1403"><span class='Ref_to_Parameter'>time</span></a> <span class='Operator'>+ </span><a href="date.c.html#LN1415"><span class='Ref_To_Local'>TimeOffsets</span></a><span class='Delimiter'>[</span><a href="date.c.html#LN1403"><span class='Ref_to_Parameter'>typmod</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) </span><span class='Operator'>/ </span><a href="date.c.html#LN1405"><span class='Ref_To_Local'>TimeScales</span></a><span class='Delimiter'>[</span><a href="date.c.html#LN1403"><span class='Ref_to_Parameter'>typmod</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span> <span class='Operator'>* 
</span>                <a href="date.c.html#LN1405"><span class='Ref_To_Local'>TimeScales</span></a><span class='Delimiter'>[</span><a href="date.c.html#LN1403"><span class='Ref_to_Parameter'>typmod</span></a><span class='Delimiter'>]; 
</span>        <span class='Control'>else</span> 
            <span class='Operator'>*</span><a href="date.c.html#LN1403"><span class='Ref_to_Parameter'>time</span></a> <span class='Operator'>= -</span><span class='Parentheses'>((((</span><span class='Operator'>-*</span><a href="date.c.html#LN1403"><span class='Ref_to_Parameter'>time</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="date.c.html#LN1415"><span class='Ref_To_Local'>TimeOffsets</span></a><span class='Delimiter'>[</span><a href="date.c.html#LN1403"><span class='Ref_to_Parameter'>typmod</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span> <span class='Operator'>/ </span><a href="date.c.html#LN1405"><span class='Ref_To_Local'>TimeScales</span></a><span class='Delimiter'>[</span><a href="date.c.html#LN1403"><span class='Ref_to_Parameter'>typmod</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span> <span class='Operator'>* 
</span>                      <a href="date.c.html#LN1405"><span class='Ref_To_Local'>TimeScales</span></a><span class='Delimiter'>[</span><a href="date.c.html#LN1403"><span class='Ref_to_Parameter'>typmod</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end AdjustTimeForTypmod &raquo; </span> 
 
 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1438"></a><span class='Declare_Function'>time_eq</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1440"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1441"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1440"><span class='Ref_To_Local'>time1</span></a> <span class='Operator'>== </span><a href="date.c.html#LN1441"><span class='Ref_To_Local'>time2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1447"></a><span class='Declare_Function'>time_ne</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1449"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1450"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1449"><span class='Ref_To_Local'>time1</span></a> <span class='Operator'>!= </span><a href="date.c.html#LN1450"><span class='Ref_To_Local'>time2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1456"></a><span class='Declare_Function'>time_lt</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1458"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1459"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1458"><span class='Ref_To_Local'>time1</span></a> <span class='Operator'>&LT; </span><a href="date.c.html#LN1459"><span class='Ref_To_Local'>time2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1465"></a><span class='Declare_Function'>time_le</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1467"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1468"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1467"><span class='Ref_To_Local'>time1</span></a> <span class='Operator'>&LT;= </span><a href="date.c.html#LN1468"><span class='Ref_To_Local'>time2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1474"></a><span class='Declare_Function'>time_gt</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1476"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1477"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1476"><span class='Ref_To_Local'>time1</span></a> <span class='Operator'>&GT; </span><a href="date.c.html#LN1477"><span class='Ref_To_Local'>time2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1483"></a><span class='Declare_Function'>time_ge</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1485"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1486"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1485"><span class='Ref_To_Local'>time1</span></a> <span class='Operator'>&GT;= </span><a href="date.c.html#LN1486"><span class='Ref_To_Local'>time2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1492"></a><span class='Declare_Function'>time_cmp</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1494"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1495"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1494"><span class='Ref_To_Local'>time1</span></a> <span class='Operator'>&LT; </span><a href="date.c.html#LN1495"><span class='Ref_To_Local'>time2</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1494"><span class='Ref_To_Local'>time1</span></a> <span class='Operator'>&GT; </span><a href="date.c.html#LN1495"><span class='Ref_To_Local'>time2</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1505"></a><span class='Declare_Function'>time_hash</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="../../access/hash/hashfunc.c.html#LN60"><span class='Ref_to_Func'>hashint8</span></a><span class='Parentheses'>(</span>fcinfo<span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1511"></a><span class='Declare_Function'>time_larger</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1513"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1514"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN64"><span class='Ref_to_Macro'>PG_RETURN_TIMEADT</span></a><span class='Parentheses'>((</span><a href="date.c.html#LN1513"><span class='Ref_To_Local'>time1</span></a> <span class='Operator'>&GT; </span><a href="date.c.html#LN1514"><span class='Ref_To_Local'>time2</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="date.c.html#LN1513"><span class='Ref_To_Local'>time1</span></a> <span class='Operator'>: </span><a href="date.c.html#LN1514"><span class='Ref_To_Local'>time2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1520"></a><span class='Declare_Function'>time_smaller</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1522"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1523"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN64"><span class='Ref_to_Macro'>PG_RETURN_TIMEADT</span></a><span class='Parentheses'>((</span><a href="date.c.html#LN1522"><span class='Ref_To_Local'>time1</span></a> <span class='Operator'>&LT; </span><a href="date.c.html#LN1523"><span class='Ref_To_Local'>time2</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="date.c.html#LN1522"><span class='Ref_To_Local'>time1</span></a> <span class='Operator'>: </span><a href="date.c.html#LN1523"><span class='Ref_To_Local'>time2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* overlaps_time() --- implements the SQL OVERLAPS operator. 
 * 
 * Algorithm is per SQL spec.  This is much harder than you'd think 
 * because the spec requires us to deliver a non-null answer in some cases 
 * where some of the inputs are null. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1535"></a><span class='Declare_Function'>overlaps_time</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* 
     * The arguments are TimeADT, but we leave them as generic Datums to avoid 
     * dereferencing nulls (TimeADT is pass-by-reference!) 
     */ 
</span><a name="LN1541"></a>    <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>ts1</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1542"></a>    <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>te1</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1543"></a>    <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>ts2</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1544"></a>    <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>te2</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>3</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1545"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>ts1IsNull</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN173"><span class='Ref_to_Macro'>PG_ARGISNULL</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1546"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>te1IsNull</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN173"><span class='Ref_to_Macro'>PG_ARGISNULL</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1547"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>ts2IsNull</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN173"><span class='Ref_to_Macro'>PG_ARGISNULL</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1548"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>te2IsNull</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN173"><span class='Ref_to_Macro'>PG_ARGISNULL</span></a><span class='Parentheses'>(</span><span class='Number'>3</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<a name="LN1550"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>TIMEADT_GT</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>t1</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>t2</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN52"><span class='Ref_to_Macro'>DatumGetTimeADT</span></a><span class='Parentheses'>(</span>t1<span class='Parentheses'>) </span><span class='Operator'>&GT; </span><a href="../../../include/utils/date.h.html#LN52"><span class='Ref_to_Macro'>DatumGetTimeADT</span></a><span class='Parentheses'>(</span>t2<span class='Parentheses'>))</span> 
<a name="LN1552"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>TIMEADT_LT</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>t1</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>t2</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN52"><span class='Ref_to_Macro'>DatumGetTimeADT</span></a><span class='Parentheses'>(</span>t1<span class='Parentheses'>) </span><span class='Operator'>&LT; </span><a href="../../../include/utils/date.h.html#LN52"><span class='Ref_to_Macro'>DatumGetTimeADT</span></a><span class='Parentheses'>(</span>t2<span class='Parentheses'>))</span> 
 
    <span class='Comment_Multi_Line'>/* 
     * If both endpoints of interval 1 are null, the result is null (unknown). 
     * If just one endpoint is null, take ts1 as the non-null one. Otherwise, 
     * take ts1 as the lesser endpoint. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1545"><span class='Ref_To_Local'>ts1IsNull</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1546"><span class='Ref_To_Local'>te1IsNull</span></a><span class='Parentheses'>) 
</span>            <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* swap null for non-null */ 
</span>        <a href="date.c.html#LN1541"><span class='Ref_To_Local'>ts1</span></a> <span class='Operator'>= </span><a href="date.c.html#LN1542"><span class='Ref_To_Local'>te1</span></a><span class='Delimiter'>; 
</span>        <a href="date.c.html#LN1546"><span class='Ref_To_Local'>te1IsNull</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="date.c.html#LN1546"><span class='Ref_To_Local'>te1IsNull</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1550"><span class='Ref_to_Macro'>TIMEADT_GT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1541"><span class='Ref_To_Local'>ts1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1542"><span class='Ref_To_Local'>te1</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN1572"></a>            <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>tt</span> <span class='Operator'>= </span><a href="date.c.html#LN1541"><span class='Ref_To_Local'>ts1</span></a><span class='Delimiter'>; 
</span> 
            <a href="date.c.html#LN1541"><span class='Ref_To_Local'>ts1</span></a> <span class='Operator'>= </span><a href="date.c.html#LN1542"><span class='Ref_To_Local'>te1</span></a><span class='Delimiter'>; 
</span>            <a href="date.c.html#LN1542"><span class='Ref_To_Local'>te1</span></a> <span class='Operator'>= </span><a href="date.c.html#LN1572"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Likewise for interval 2. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1547"><span class='Ref_To_Local'>ts2IsNull</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1548"><span class='Ref_To_Local'>te2IsNull</span></a><span class='Parentheses'>) 
</span>            <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* swap null for non-null */ 
</span>        <a href="date.c.html#LN1543"><span class='Ref_To_Local'>ts2</span></a> <span class='Operator'>= </span><a href="date.c.html#LN1544"><span class='Ref_To_Local'>te2</span></a><span class='Delimiter'>; 
</span>        <a href="date.c.html#LN1548"><span class='Ref_To_Local'>te2IsNull</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="date.c.html#LN1548"><span class='Ref_To_Local'>te2IsNull</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1550"><span class='Ref_to_Macro'>TIMEADT_GT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1543"><span class='Ref_To_Local'>ts2</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1544"><span class='Ref_To_Local'>te2</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN1592"></a>            <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>tt</span> <span class='Operator'>= </span><a href="date.c.html#LN1543"><span class='Ref_To_Local'>ts2</span></a><span class='Delimiter'>; 
</span> 
            <a href="date.c.html#LN1543"><span class='Ref_To_Local'>ts2</span></a> <span class='Operator'>= </span><a href="date.c.html#LN1544"><span class='Ref_To_Local'>te2</span></a><span class='Delimiter'>; 
</span>            <a href="date.c.html#LN1544"><span class='Ref_To_Local'>te2</span></a> <span class='Operator'>= </span><a href="date.c.html#LN1592"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * At this point neither ts1 nor ts2 is null, so we can consider three 
     * cases: ts1 &GT; ts2, ts1 &LT; ts2, ts1 = ts2 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1550"><span class='Ref_to_Macro'>TIMEADT_GT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1541"><span class='Ref_To_Local'>ts1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1543"><span class='Ref_To_Local'>ts2</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * This case is ts1 &LT; te2 OR te1 &LT; te2, which may look redundant but 
         * in the presence of nulls it's not quite completely so. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1548"><span class='Ref_To_Local'>te2IsNull</span></a><span class='Parentheses'>) 
</span>            <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1552"><span class='Ref_to_Macro'>TIMEADT_LT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1541"><span class='Ref_To_Local'>ts1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1544"><span class='Ref_To_Local'>te2</span></a><span class='Parentheses'>))</span> 
            <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1546"><span class='Ref_To_Local'>te1IsNull</span></a><span class='Parentheses'>) 
</span>            <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If te1 is not null then we had ts1 &LT;= te1 above, and we just found 
         * ts1 &GT;= te2, hence te1 &GT;= te2. 
         */ 
</span>        <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1552"><span class='Ref_to_Macro'>TIMEADT_LT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1541"><span class='Ref_To_Local'>ts1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1543"><span class='Ref_To_Local'>ts2</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* This case is ts2 &LT; te1 OR te2 &LT; te1 */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1546"><span class='Ref_To_Local'>te1IsNull</span></a><span class='Parentheses'>) 
</span>            <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1552"><span class='Ref_to_Macro'>TIMEADT_LT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1543"><span class='Ref_To_Local'>ts2</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1542"><span class='Ref_To_Local'>te1</span></a><span class='Parentheses'>))</span> 
            <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1548"><span class='Ref_To_Local'>te2IsNull</span></a><span class='Parentheses'>) 
</span>            <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If te2 is not null then we had ts2 &LT;= te2 above, and we just found 
         * ts2 &GT;= te1, hence te2 &GT;= te1. 
         */ 
</span>        <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * For ts1 = ts2 the spec says te1 &LT;&GT; te2 OR te1 = te2, which is a 
         * rather silly way of saying "true if both are nonnull, else null". 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1546"><span class='Ref_To_Local'>te1IsNull</span></a> <span class='Operator'>|| </span><a href="date.c.html#LN1548"><span class='Ref_To_Local'>te2IsNull</span></a><span class='Parentheses'>) 
</span>            <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
<span class='Keyword'>#undef </span><a href="date.c.html#LN1550"><span class='Ref_to_Macro'>TIMEADT_GT</span></a> 
<span class='Keyword'>#undef </span><a href="date.c.html#LN1552"><span class='Ref_to_Macro'>TIMEADT_LT</span></a> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end overlaps_time &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* timestamp_time() 
 * Convert timestamp to time data type. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1657"></a><span class='Declare_Function'>timestamp_time</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1659"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>timestamp</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN34"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1660"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1661"></a>    <span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Declare_Local'>tt</span><span class='Delimiter'>, 
</span><a name="LN1662"></a>               <span class='Operator'>*</span><span class='Declare_Local'>tm</span> <span class='Operator'>= &</span><a href="date.c.html#LN1661"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span><a name="LN1663"></a>    <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a>      <span class='Declare_Local'>fsec</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/datatype/timestamp.h.html#LN121"><span class='Ref_to_Macro'>TIMESTAMP_NOT_FINITE</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1659"><span class='Ref_To_Local'>timestamp</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN84"><span class='Ref_to_Proto'>timestamp2tm</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1659"><span class='Ref_To_Local'>timestamp</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="date.c.html#LN1662"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN1663"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"timestamp out of range"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Could also do this with time = (timestamp / USECS_PER_DAY * 
     * USECS_PER_DAY) - timestamp; 
     */ 
</span>    <a href="date.c.html#LN1660"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>((((</span><a href="date.c.html#LN1662"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN28"><span class='Ref_to_Member'>tm_hour</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN88"><span class='Ref_to_Const'>MINS_PER_HOUR</span></a> <span class='Operator'>+ </span><a href="date.c.html#LN1662"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN27"><span class='Ref_to_Member'>tm_min</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN87"><span class='Ref_to_Const'>SECS_PER_MINUTE</span></a><span class='Parentheses'>)</span> <span class='Operator'>+ </span><a href="date.c.html#LN1662"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN26"><span class='Ref_to_Member'>tm_sec</span></a><span class='Parentheses'>)</span> <span class='Operator'>* 
</span>              <a href="../../../include/datatype/timestamp.h.html#LN93"><span class='Ref_to_Const'>USECS_PER_SEC</span></a><span class='Parentheses'>)</span> <span class='Operator'>+ </span><a href="date.c.html#LN1663"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN64"><span class='Ref_to_Macro'>PG_RETURN_TIMEADT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1660"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end timestamp_time &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* timestamptz_time() 
 * Convert timestamptz to time data type. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1687"></a><span class='Declare_Function'>timestamptz_time</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1689"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>timestamp</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN34"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1690"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1691"></a>    <span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Declare_Local'>tt</span><span class='Delimiter'>, 
</span><a name="LN1692"></a>               <span class='Operator'>*</span><span class='Declare_Local'>tm</span> <span class='Operator'>= &</span><a href="date.c.html#LN1691"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span><a name="LN1693"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>tz</span><span class='Delimiter'>; 
</span><a name="LN1694"></a>    <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a>      <span class='Declare_Local'>fsec</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/datatype/timestamp.h.html#LN121"><span class='Ref_to_Macro'>TIMESTAMP_NOT_FINITE</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1689"><span class='Ref_To_Local'>timestamp</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN84"><span class='Ref_to_Proto'>timestamp2tm</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1689"><span class='Ref_To_Local'>timestamp</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN1693"><span class='Ref_To_Local'>tz</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1692"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN1694"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"timestamp out of range"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Could also do this with time = (timestamp / USECS_PER_DAY * 
     * USECS_PER_DAY) - timestamp; 
     */ 
</span>    <a href="date.c.html#LN1690"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>((((</span><a href="date.c.html#LN1692"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN28"><span class='Ref_to_Member'>tm_hour</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN88"><span class='Ref_to_Const'>MINS_PER_HOUR</span></a> <span class='Operator'>+ </span><a href="date.c.html#LN1692"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN27"><span class='Ref_to_Member'>tm_min</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN87"><span class='Ref_to_Const'>SECS_PER_MINUTE</span></a><span class='Parentheses'>)</span> <span class='Operator'>+ </span><a href="date.c.html#LN1692"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN26"><span class='Ref_to_Member'>tm_sec</span></a><span class='Parentheses'>)</span> <span class='Operator'>* 
</span>              <a href="../../../include/datatype/timestamp.h.html#LN93"><span class='Ref_to_Const'>USECS_PER_SEC</span></a><span class='Parentheses'>)</span> <span class='Operator'>+ </span><a href="date.c.html#LN1694"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN64"><span class='Ref_to_Macro'>PG_RETURN_TIMEADT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1690"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end timestamptz_time &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* datetime_timestamp() 
 * Convert date and time to timestamp data type. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1718"></a><span class='Declare_Function'>datetime_timestamp</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1720"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>date</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1721"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1722"></a>    <a href="../../../include/datatype/timestamp.h.html#LN37"><span class='Ref_to_Typedef'>Timestamp</span></a>   <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN1722"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN572"><span class='Ref_to_Func'>date2timestamp</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1720"><span class='Ref_To_Local'>date</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/datatype/timestamp.h.html#LN121"><span class='Ref_to_Macro'>TIMESTAMP_NOT_FINITE</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1722"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="date.c.html#LN1722"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>+= </span><a href="date.c.html#LN1721"><span class='Ref_To_Local'>time</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/datatype/timestamp.h.html#LN194"><span class='Ref_to_Macro'>IS_VALID_TIMESTAMP</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1722"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span> 
            <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"timestamp out of range"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../../include/utils/timestamp.h.html#LN38"><span class='Ref_to_Macro'>PG_RETURN_TIMESTAMP</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1722"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* time_interval() 
 * Convert time to interval data type. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1741"></a><span class='Declare_Function'>time_interval</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1743"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1744"></a>    <a href="../../../include/datatype/timestamp.h.html#LN42"><span class='Ref_to_Typedef'>Interval</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN1744"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/datatype/timestamp.h.html#LN42"><span class='Ref_to_Typedef'>Interval</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/datatype/timestamp.h.html#LN42"><span class='Ref_to_Typedef'>Interval</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN1744"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../interfaces/ecpg/include/pgtypes_interval.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>= </span><a href="date.c.html#LN1743"><span class='Ref_To_Local'>time</span></a><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN1744"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/datatype/timestamp.h.html#LN46"><span class='Ref_to_Member'>day</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN1744"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../interfaces/ecpg/include/pgtypes_interval.h.html#LN28"><span class='Ref_to_Member'>month</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/timestamp.h.html#LN40"><span class='Ref_to_Macro'>PG_RETURN_INTERVAL_P</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1744"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* interval_time() 
 * Convert interval to time data type. 
 * 
 * This is defined as producing the fractional-day portion of the interval. 
 * Therefore, we can just ignore the months field.  It is not real clear 
 * what to do with negative intervals, but we choose to subtract the floor, 
 * so that, say, '-2 hours' becomes '22:00:00'. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1764"></a><span class='Declare_Function'>interval_time</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1766"></a>    <a href="../../../include/datatype/timestamp.h.html#LN42"><span class='Ref_to_Typedef'>Interval</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>span</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN36"><span class='Ref_to_Macro'>PG_GETARG_INTERVAL_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1767"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1768"></a>    <a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>days</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN1767"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN1766"><span class='Ref_To_Local'>span</span></a><span class='Operator'>-&GT;</span><a href="../../../interfaces/ecpg/include/pgtypes_interval.h.html#LN27"><span class='Ref_to_Member'>time</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1767"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>&GT;= </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="date.c.html#LN1768"><span class='Ref_To_Local'>days</span></a> <span class='Operator'>= </span><a href="date.c.html#LN1767"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>/ </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Delimiter'>; 
</span>        <a href="date.c.html#LN1767"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>-= </span><a href="date.c.html#LN1768"><span class='Ref_To_Local'>days</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1767"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="date.c.html#LN1768"><span class='Ref_To_Local'>days</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Operator'>-</span><a href="date.c.html#LN1767"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>+ </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>/ </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Delimiter'>; 
</span>        <a href="date.c.html#LN1767"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>+= </span><a href="date.c.html#LN1768"><span class='Ref_To_Local'>days</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../../include/utils/date.h.html#LN64"><span class='Ref_to_Macro'>PG_RETURN_TIMEADT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1767"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end interval_time &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* time_mi_time() 
 * Subtract two times to produce an interval. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1789"></a><span class='Declare_Function'>time_mi_time</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1791"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1792"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1793"></a>    <a href="../../../include/datatype/timestamp.h.html#LN42"><span class='Ref_to_Typedef'>Interval</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN1793"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/datatype/timestamp.h.html#LN42"><span class='Ref_to_Typedef'>Interval</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/datatype/timestamp.h.html#LN42"><span class='Ref_to_Typedef'>Interval</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN1793"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../interfaces/ecpg/include/pgtypes_interval.h.html#LN28"><span class='Ref_to_Member'>month</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN1793"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/datatype/timestamp.h.html#LN46"><span class='Ref_to_Member'>day</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN1793"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../interfaces/ecpg/include/pgtypes_interval.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>= </span><a href="date.c.html#LN1791"><span class='Ref_To_Local'>time1</span></a> <span class='Operator'>- </span><a href="date.c.html#LN1792"><span class='Ref_To_Local'>time2</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/timestamp.h.html#LN40"><span class='Ref_to_Macro'>PG_RETURN_INTERVAL_P</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1793"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* time_pl_interval() 
 * Add interval to time. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1808"></a><span class='Declare_Function'>time_pl_interval</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1810"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1811"></a>    <a href="../../../include/datatype/timestamp.h.html#LN42"><span class='Ref_to_Typedef'>Interval</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>span</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN36"><span class='Ref_to_Macro'>PG_GETARG_INTERVAL_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1812"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN1812"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN1810"><span class='Ref_To_Local'>time</span></a> <span class='Operator'>+ </span><a href="date.c.html#LN1811"><span class='Ref_To_Local'>span</span></a><span class='Operator'>-&GT;</span><a href="../../../interfaces/ecpg/include/pgtypes_interval.h.html#LN27"><span class='Ref_to_Member'>time</span></a><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN1812"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>-= </span><a href="date.c.html#LN1812"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>/ </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1812"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>&LT; </span><a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>))</span> 
        <a href="date.c.html#LN1812"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>+= </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN64"><span class='Ref_to_Macro'>PG_RETURN_TIMEADT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1812"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* time_mi_interval() 
 * Subtract interval from time. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1826"></a><span class='Declare_Function'>time_mi_interval</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1828"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1829"></a>    <a href="../../../include/datatype/timestamp.h.html#LN42"><span class='Ref_to_Typedef'>Interval</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>span</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN36"><span class='Ref_to_Macro'>PG_GETARG_INTERVAL_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1830"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN1830"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN1828"><span class='Ref_To_Local'>time</span></a> <span class='Operator'>- </span><a href="date.c.html#LN1829"><span class='Ref_To_Local'>span</span></a><span class='Operator'>-&GT;</span><a href="../../../interfaces/ecpg/include/pgtypes_interval.h.html#LN27"><span class='Ref_to_Member'>time</span></a><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN1830"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>-= </span><a href="date.c.html#LN1830"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>/ </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1830"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>&LT; </span><a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>))</span> 
        <a href="date.c.html#LN1830"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>+= </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN64"><span class='Ref_to_Macro'>PG_RETURN_TIMEADT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1830"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* time_part() 
 * Extract specified field from time type. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1845"></a><span class='Declare_Function'>time_part</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1847"></a>    <a href="../../../../contrib/seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>units</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN272"><span class='Ref_to_Macro'>PG_GETARG_TEXT_PP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1848"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1849"></a>    <a href="../../../include/c.h.html#LN380"><span class='Ref_to_Typedef'>float8</span></a>      <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1850"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>type</span><span class='Delimiter'>, 
</span><a name="LN1851"></a>                <span class='Declare_Local'>val</span><span class='Delimiter'>; 
</span><a name="LN1852"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>lowunits</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN1852"><span class='Ref_To_Local'>lowunits</span></a> <span class='Operator'>= </span><a href="../../../include/parser/scansup.h.html#LN19"><span class='Ref_to_Proto'>downcase_truncate_identifier</span></a><span class='Parentheses'>(</span><a href="../../../include/postgres.h.html#LN346"><span class='Ref_to_Macro'>VARDATA_ANY</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1847"><span class='Ref_To_Local'>units</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                            <a href="../../../include/postgres.h.html#LN339"><span class='Ref_to_Macro'>VARSIZE_ANY_EXHDR</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1847"><span class='Ref_To_Local'>units</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                            <span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN1850"><span class='Ref_To_Local'>type</span></a> <span class='Operator'>= </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN318"><span class='Ref_to_Proto'>DecodeUnits</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="date.c.html#LN1852"><span class='Ref_To_Local'>lowunits</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN1851"><span class='Ref_To_Local'>val</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1850"><span class='Ref_To_Local'>type</span></a> <span class='Operator'>== </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN118"><span class='Ref_to_Const'>UNKNOWN_FIELD</span></a><span class='Parentheses'>) 
</span>        <a href="date.c.html#LN1850"><span class='Ref_To_Local'>type</span></a> <span class='Operator'>= </span><a href="../../../include/utils/datetime.h.html#LN327"><span class='Ref_to_Proto'>DecodeSpecial</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="date.c.html#LN1852"><span class='Ref_To_Local'>lowunits</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN1851"><span class='Ref_To_Local'>val</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1850"><span class='Ref_To_Local'>type</span></a> <span class='Operator'>== </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN106"><span class='Ref_to_Const'>UNITS</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1864"></a>        <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a>      <span class='Declare_Local'>fsec</span><span class='Delimiter'>; 
</span><a name="LN1865"></a>        <span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Declare_Local'>tt</span><span class='Delimiter'>, 
</span><a name="LN1866"></a>                   <span class='Operator'>*</span><span class='Declare_Local'>tm</span> <span class='Operator'>= &</span><a href="date.c.html#LN1865"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span> 
        <a href="date.c.html#LN43"><span class='Ref_to_Proto'>time2tm</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1848"><span class='Ref_To_Local'>time</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1866"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN1864"><span class='Ref_To_Local'>fsec</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1851"><span class='Ref_To_Local'>val</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN169"><span class='Ref_to_Const'>DTK_MICROSEC</span></a><span class='Operator'>: 
</span>                <a href="date.c.html#LN1849"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN1866"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN26"><span class='Ref_to_Member'>tm_sec</span></a> <span class='Operator'>* </span><span class='Number'>1000000</span><span class='Operator'>.</span><span class='Number'>0</span> <span class='Operator'>+ </span><a href="date.c.html#LN1864"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN168"><span class='Ref_to_Const'>DTK_MILLISEC</span></a><span class='Operator'>: 
</span>                <a href="date.c.html#LN1849"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN1866"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN26"><span class='Ref_to_Member'>tm_sec</span></a> <span class='Operator'>* </span><span class='Number'>1000</span><span class='Operator'>.</span><span class='Number'>0</span> <span class='Operator'>+ </span><a href="date.c.html#LN1864"><span class='Ref_To_Local'>fsec</span></a> <span class='Operator'>/ </span><span class='Number'>1000</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN157"><span class='Ref_to_Const'>DTK_SECOND</span></a><span class='Operator'>: 
</span>                <a href="date.c.html#LN1849"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN1866"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN26"><span class='Ref_to_Member'>tm_sec</span></a> <span class='Operator'>+ </span><a href="date.c.html#LN1864"><span class='Ref_To_Local'>fsec</span></a> <span class='Operator'>/ </span><span class='Number'>1000000</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN158"><span class='Ref_to_Const'>DTK_MINUTE</span></a><span class='Operator'>: 
</span>                <a href="date.c.html#LN1849"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN1866"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN27"><span class='Ref_to_Member'>tm_min</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN159"><span class='Ref_to_Const'>DTK_HOUR</span></a><span class='Operator'>: 
</span>                <a href="date.c.html#LN1849"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN1866"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN28"><span class='Ref_to_Member'>tm_hour</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN141"><span class='Ref_to_Const'>DTK_TZ</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN175"><span class='Ref_to_Const'>DTK_TZ_MINUTE</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN174"><span class='Ref_to_Const'>DTK_TZ_HOUR</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN160"><span class='Ref_to_Const'>DTK_DAY</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN162"><span class='Ref_to_Const'>DTK_MONTH</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN163"><span class='Ref_to_Const'>DTK_QUARTER</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN164"><span class='Ref_to_Const'>DTK_YEAR</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN165"><span class='Ref_to_Const'>DTK_DECADE</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN166"><span class='Ref_to_Const'>DTK_CENTURY</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN167"><span class='Ref_to_Const'>DTK_MILLENNIUM</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN176"><span class='Ref_to_Const'>DTK_ISOYEAR</span></a><span class='Operator'>: 
</span>            <span class='Control'>default</span><span class='Operator'>: 
</span>                <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"\"time\" units \"%s\" not recognized"</span><span class='Delimiter'>, 
</span>                                <a href="date.c.html#LN1852"><span class='Ref_To_Local'>lowunits</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <a href="date.c.html#LN1849"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch val &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if type==UNITS &raquo; </span> 
    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1850"><span class='Ref_To_Local'>type</span></a> <span class='Operator'>== </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN89"><span class='Ref_to_Const'>RESERV</span></a> <span class='Operator'>&& </span><a href="date.c.html#LN1851"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>== </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN149"><span class='Ref_to_Const'>DTK_EPOCH</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="date.c.html#LN1849"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN1848"><span class='Ref_To_Local'>time</span></a> <span class='Operator'>/ </span><span class='Number'>1000000</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"\"time\" units \"%s\" not recognized"</span><span class='Delimiter'>, 
</span>                        <a href="date.c.html#LN1852"><span class='Ref_To_Local'>lowunits</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <a href="date.c.html#LN1849"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../../include/fmgr.h.html#LN325"><span class='Ref_to_Macro'>PG_RETURN_FLOAT8</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1849"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end time_part &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/***************************************************************************** 
 *   Time With Time Zone ADT 
 *****************************************************************************/ 
</span> 
<span class='Comment_Multi_Line'>/* tm2timetz() 
 * Convert a tm structure to a time data type. 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN1936"></a><span class='Declare_Function'>tm2timetz</span><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>tm</span><span class='Delimiter'>, </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a> <span class='Declare_Parameter'>fsec</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>tz</span><span class='Delimiter'>, </span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>result</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="date.c.html#LN1936"><span class='Ref_to_Parameter'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>= </span><span class='Parentheses'>((((</span><a href="date.c.html#LN1936"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN28"><span class='Ref_to_Member'>tm_hour</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN88"><span class='Ref_to_Const'>MINS_PER_HOUR</span></a> <span class='Operator'>+ </span><a href="date.c.html#LN1936"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN27"><span class='Ref_to_Member'>tm_min</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN87"><span class='Ref_to_Const'>SECS_PER_MINUTE</span></a><span class='Parentheses'>)</span> <span class='Operator'>+ </span><a href="date.c.html#LN1936"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN26"><span class='Ref_to_Member'>tm_sec</span></a><span class='Parentheses'>)</span> <span class='Operator'>* 
</span>                    <a href="../../../include/datatype/timestamp.h.html#LN93"><span class='Ref_to_Const'>USECS_PER_SEC</span></a><span class='Parentheses'>)</span> <span class='Operator'>+ </span><a href="date.c.html#LN1936"><span class='Ref_to_Parameter'>fsec</span></a><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN1936"><span class='Ref_to_Parameter'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a> <span class='Operator'>= </span><a href="date.c.html#LN1936"><span class='Ref_to_Parameter'>tz</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1946"></a><span class='Declare_Function'>timetz_in</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1948"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>str</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN241"><span class='Ref_to_Macro'>PG_GETARG_CSTRING</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Directive'>#ifdef</span> NOT_USED 
<a name="LN1951"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>typelem</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
<a name="LN1953"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>typmod</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1954"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1955"></a>    <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a>      <span class='Declare_Local'>fsec</span><span class='Delimiter'>; 
</span><a name="LN1956"></a>    <span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Declare_Local'>tt</span><span class='Delimiter'>, 
</span><a name="LN1957"></a>               <span class='Operator'>*</span><span class='Declare_Local'>tm</span> <span class='Operator'>= &</span><a href="date.c.html#LN1956"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span><a name="LN1958"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>tz</span><span class='Delimiter'>; 
</span><a name="LN1959"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>nf</span><span class='Delimiter'>; 
</span><a name="LN1960"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>dterr</span><span class='Delimiter'>; 
</span><a name="LN1961"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>workbuf</span><span class='Delimiter'>[</span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN195"><span class='Ref_to_Const'>MAXDATELEN</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span><a name="LN1962"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>field</span><span class='Delimiter'>[</span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN197"><span class='Ref_to_Const'>MAXDATEFIELDS</span></a><span class='Delimiter'>]; 
</span><a name="LN1963"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>dtype</span><span class='Delimiter'>; 
</span><a name="LN1964"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>ftype</span><span class='Delimiter'>[</span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN197"><span class='Ref_to_Const'>MAXDATEFIELDS</span></a><span class='Delimiter'>]; 
</span> 
    <a href="date.c.html#LN1960"><span class='Ref_To_Local'>dterr</span></a> <span class='Operator'>= </span><a href="../../../include/utils/datetime.h.html#LN293"><span class='Ref_to_Proto'>ParseDateTime</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1948"><span class='Ref_To_Local'>str</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1961"><span class='Ref_To_Local'>workbuf</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="date.c.html#LN1961"><span class='Ref_To_Local'>workbuf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                          <a href="date.c.html#LN1962"><span class='Ref_To_Local'>field</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1964"><span class='Ref_To_Local'>ftype</span></a><span class='Delimiter'>, </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN197"><span class='Ref_to_Const'>MAXDATEFIELDS</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN1959"><span class='Ref_To_Local'>nf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1960"><span class='Ref_To_Local'>dterr</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="date.c.html#LN1960"><span class='Ref_To_Local'>dterr</span></a> <span class='Operator'>= </span><a href="../../../include/utils/datetime.h.html#LN300"><span class='Ref_to_Proto'>DecodeTimeOnly</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1962"><span class='Ref_To_Local'>field</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1964"><span class='Ref_To_Local'>ftype</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1959"><span class='Ref_To_Local'>nf</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN1963"><span class='Ref_To_Local'>dtype</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1957"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN1955"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN1958"><span class='Ref_To_Local'>tz</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN1960"><span class='Ref_To_Local'>dterr</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="datetime.c.html#LN3763"><span class='Ref_to_Func'>DateTimeParseError</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1960"><span class='Ref_To_Local'>dterr</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1948"><span class='Ref_To_Local'>str</span></a><span class='Delimiter'>, </span><span class='String'>"time with time zone"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN1954"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN46"><span class='Ref_to_Proto'>tm2timetz</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1957"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1955"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1958"><span class='Ref_To_Local'>tz</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1954"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN47"><span class='Ref_to_Proto'>AdjustTimeForTypmod</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><span class='Parentheses'>(</span><a href="date.c.html#LN1954"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="date.c.html#LN1953"><span class='Ref_To_Local'>typmod</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN65"><span class='Ref_to_Macro'>PG_RETURN_TIMETZADT_P</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1954"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end timetz_in &raquo; </span> 
 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1981"></a><span class='Declare_Function'>timetz_out</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1983"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1984"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1985"></a>    <span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Declare_Local'>tt</span><span class='Delimiter'>, 
</span><a name="LN1986"></a>               <span class='Operator'>*</span><span class='Declare_Local'>tm</span> <span class='Operator'>= &</span><a href="date.c.html#LN1985"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span><a name="LN1987"></a>    <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a>      <span class='Declare_Local'>fsec</span><span class='Delimiter'>; 
</span><a name="LN1988"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>tz</span><span class='Delimiter'>; 
</span><a name="LN1989"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>buf</span><span class='Delimiter'>[</span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN195"><span class='Ref_to_Const'>MAXDATELEN</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span> 
    <a href="date.c.html#LN44"><span class='Ref_to_Proto'>timetz2tm</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1983"><span class='Ref_To_Local'>time</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1986"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN1987"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN1988"><span class='Ref_To_Local'>tz</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/datetime.h.html#LN317"><span class='Ref_to_Proto'>EncodeTimeOnly</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1986"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1987"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><a href="date.c.html#LN1988"><span class='Ref_To_Local'>tz</span></a><span class='Delimiter'>, </span><a href="../init/globals.c.html#LN106"><span class='Ref_to_Global_Var'>DateStyle</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN1989"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN1984"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/common/fe_memutils.h.html#LN32"><span class='Ref_to_Proto'>pstrdup</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1989"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN321"><span class='Ref_to_Macro'>PG_RETURN_CSTRING</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN1984"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 *      timetz_recv         - converts external binary format to timetz 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN2002"></a><span class='Declare_Function'>timetz_recv</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2004"></a>    <a href="../../../include/lib/stringinfo.h.html#LN42"><span class='Ref_to_Typedef'>StringInfo</span></a>  <span class='Declare_Local'>buf</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/lib/stringinfo.h.html#LN42"><span class='Ref_to_Typedef'>StringInfo</span></a><span class='Parentheses'>) </span><a href="../../../include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Directive'>#ifdef</span> NOT_USED 
<a name="LN2007"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>typelem</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
<a name="LN2009"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>typmod</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2010"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN2010"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN2010"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>= </span><a href="../../../include/libpq/pqformat.h.html#LN39"><span class='Ref_to_Proto'>pq_getmsgint64</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2004"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2010"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>&LT; </span><a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>) </span><span class='Operator'>|| </span><a href="date.c.html#LN2010"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>&GT; </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Parentheses'>)</span> 
        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"time out of range"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN2010"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a> <span class='Operator'>= </span><a href="../../../include/libpq/pqformat.h.html#LN38"><span class='Ref_to_Proto'>pq_getmsgint</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2004"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="date.c.html#LN2010"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Check for sane GMT displacement; see notes in datatype/timestamp.h */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2010"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a> <span class='Operator'>&LT;= -</span><a href="../../../include/datatype/timestamp.h.html#LN103"><span class='Ref_to_Const'>TZDISP_LIMIT</span></a> <span class='Operator'>|| </span><a href="date.c.html#LN2010"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a> <span class='Operator'>&GT;= </span><a href="../../../include/datatype/timestamp.h.html#LN103"><span class='Ref_to_Const'>TZDISP_LIMIT</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_TIME_ZONE_DISPLACEMENT_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"time zone displacement out of range"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN47"><span class='Ref_to_Proto'>AdjustTimeForTypmod</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><span class='Parentheses'>(</span><a href="date.c.html#LN2010"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="date.c.html#LN2009"><span class='Ref_To_Local'>typmod</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN65"><span class='Ref_to_Macro'>PG_RETURN_TIMETZADT_P</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2010"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end timetz_recv &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 *      timetz_send         - converts timetz to binary format 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN2038"></a><span class='Declare_Function'>timetz_send</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2040"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2041"></a>    <a href="../../../include/lib/stringinfo.h.html#LN34"><span class='Ref_to_Struct'>StringInfoData</span></a> <span class='Declare_Local'>buf</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/libpq/pqformat.h.html#LN31"><span class='Ref_to_Proto'>pq_begintypsend</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="date.c.html#LN2041"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/libpq/pqformat.h.html#LN26"><span class='Ref_to_Proto'>pq_sendint64</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="date.c.html#LN2041"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2040"><span class='Ref_To_Local'>time</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/libpq/pqformat.h.html#LN25"><span class='Ref_to_Proto'>pq_sendint</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="date.c.html#LN2041"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2040"><span class='Ref_To_Local'>time</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="date.c.html#LN2040"><span class='Ref_To_Local'>time</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN328"><span class='Ref_to_Macro'>PG_RETURN_BYTEA_P</span></a><span class='Parentheses'>(</span><a href="../../../include/libpq/pqformat.h.html#LN32"><span class='Ref_to_Proto'>pq_endtypsend</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="date.c.html#LN2041"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN2050"></a><span class='Declare_Function'>timetztypmodin</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2052"></a>    <a href="../../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>ta</span> <span class='Operator'>= </span><a href="../../../include/utils/array.h.html#LN243"><span class='Ref_to_Macro'>PG_GETARG_ARRAYTYPE_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN51"><span class='Ref_to_Func'>anytime_typmodin</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Delimiter'>, </span><a href="date.c.html#LN2052"><span class='Ref_To_Local'>ta</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN2058"></a><span class='Declare_Function'>timetztypmodout</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2060"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>typmod</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN321"><span class='Ref_to_Macro'>PG_RETURN_CSTRING</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN94"><span class='Ref_to_Func'>anytime_typmodout</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Delimiter'>, </span><a href="date.c.html#LN2060"><span class='Ref_To_Local'>typmod</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* timetz2tm() 
 * Convert TIME WITH TIME ZONE data type to POSIX time structure. 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN2070"></a><span class='Declare_Function'>timetz2tm</span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>time</span><span class='Delimiter'>, </span><span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>tm</span><span class='Delimiter'>, </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>fsec</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>tzp</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2072"></a>    <a href="../../../include/datatype/timestamp.h.html#LN39"><span class='Ref_to_Typedef'>TimeOffset</span></a>  <span class='Declare_Local'>trem</span> <span class='Operator'>= </span><a href="date.c.html#LN2070"><span class='Ref_to_Parameter'>time</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN2070"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN28"><span class='Ref_to_Member'>tm_hour</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2072"><span class='Ref_To_Local'>trem</span></a> <span class='Operator'>/ </span><a href="../../../include/datatype/timestamp.h.html#LN91"><span class='Ref_to_Const'>USECS_PER_HOUR</span></a><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN2072"><span class='Ref_To_Local'>trem</span></a> <span class='Operator'>-= </span><a href="date.c.html#LN2070"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN28"><span class='Ref_to_Member'>tm_hour</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN91"><span class='Ref_to_Const'>USECS_PER_HOUR</span></a><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN2070"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN27"><span class='Ref_to_Member'>tm_min</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2072"><span class='Ref_To_Local'>trem</span></a> <span class='Operator'>/ </span><a href="../../../include/datatype/timestamp.h.html#LN92"><span class='Ref_to_Const'>USECS_PER_MINUTE</span></a><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN2072"><span class='Ref_To_Local'>trem</span></a> <span class='Operator'>-= </span><a href="date.c.html#LN2070"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN27"><span class='Ref_to_Member'>tm_min</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN92"><span class='Ref_to_Const'>USECS_PER_MINUTE</span></a><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN2070"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN26"><span class='Ref_to_Member'>tm_sec</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2072"><span class='Ref_To_Local'>trem</span></a> <span class='Operator'>/ </span><a href="../../../include/datatype/timestamp.h.html#LN93"><span class='Ref_to_Const'>USECS_PER_SEC</span></a><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="date.c.html#LN2070"><span class='Ref_to_Parameter'>fsec</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2072"><span class='Ref_To_Local'>trem</span></a> <span class='Operator'>- </span><a href="date.c.html#LN2070"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN26"><span class='Ref_to_Member'>tm_sec</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN93"><span class='Ref_to_Const'>USECS_PER_SEC</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2070"><span class='Ref_to_Parameter'>tzp</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="date.c.html#LN2070"><span class='Ref_to_Parameter'>tzp</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2070"><span class='Ref_to_Parameter'>time</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* timetz_scale() 
 * Adjust time type for specified scale factor. 
 * Used by PostgreSQL type system to stuff columns. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN2092"></a><span class='Declare_Function'>timetz_scale</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2094"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2095"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>typmod</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2096"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN2096"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN2096"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2094"><span class='Ref_To_Local'>time</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN2096"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2094"><span class='Ref_To_Local'>time</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN47"><span class='Ref_to_Proto'>AdjustTimeForTypmod</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><span class='Parentheses'>(</span><a href="date.c.html#LN2096"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="date.c.html#LN2095"><span class='Ref_To_Local'>typmod</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN65"><span class='Ref_to_Macro'>PG_RETURN_TIMETZADT_P</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2096"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Keyword'>static int 
</span><a name="LN2110"></a><span class='Declare_Function'>timetz_cmp_internal</span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>time1</span><span class='Delimiter'>, </span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>time2</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2112"></a>    <a href="../../../include/datatype/timestamp.h.html#LN39"><span class='Ref_to_Typedef'>TimeOffset</span></a>  <span class='Declare_Local'>t1</span><span class='Delimiter'>, 
</span><a name="LN2113"></a>                <span class='Declare_Local'>t2</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Primary sort is by true (GMT-equivalent) time */ 
</span>    <a href="date.c.html#LN2112"><span class='Ref_To_Local'>t1</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2110"><span class='Ref_to_Parameter'>time1</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>+ </span><span class='Parentheses'>(</span><a href="date.c.html#LN2110"><span class='Ref_to_Parameter'>time1</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN93"><span class='Ref_to_Const'>USECS_PER_SEC</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN2113"><span class='Ref_To_Local'>t2</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2110"><span class='Ref_to_Parameter'>time2</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>+ </span><span class='Parentheses'>(</span><a href="date.c.html#LN2110"><span class='Ref_to_Parameter'>time2</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN93"><span class='Ref_to_Const'>USECS_PER_SEC</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2112"><span class='Ref_To_Local'>t1</span></a> <span class='Operator'>&GT; </span><a href="date.c.html#LN2113"><span class='Ref_To_Local'>t2</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2112"><span class='Ref_To_Local'>t1</span></a> <span class='Operator'>&LT; </span><a href="date.c.html#LN2113"><span class='Ref_To_Local'>t2</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If same GMT time, sort by timezone; we only want to say that two 
     * timetz's are equal if both the time and zone parts are equal. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2110"><span class='Ref_to_Parameter'>time1</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a> <span class='Operator'>&GT; </span><a href="date.c.html#LN2110"><span class='Ref_to_Parameter'>time2</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2110"><span class='Ref_to_Parameter'>time1</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a> <span class='Operator'>&LT; </span><a href="date.c.html#LN2110"><span class='Ref_to_Parameter'>time2</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end timetz_cmp_internal &raquo; </span> 
 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN2137"></a><span class='Declare_Function'>timetz_eq</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2139"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2140"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2109"><span class='Ref_to_Func'>timetz_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2139"><span class='Ref_To_Local'>time1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2140"><span class='Ref_To_Local'>time2</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN2146"></a><span class='Declare_Function'>timetz_ne</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2148"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2149"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2109"><span class='Ref_to_Func'>timetz_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2148"><span class='Ref_To_Local'>time1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2149"><span class='Ref_To_Local'>time2</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN2155"></a><span class='Declare_Function'>timetz_lt</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2157"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2158"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2109"><span class='Ref_to_Func'>timetz_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2157"><span class='Ref_To_Local'>time1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2158"><span class='Ref_To_Local'>time2</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN2164"></a><span class='Declare_Function'>timetz_le</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2166"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2167"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2109"><span class='Ref_to_Func'>timetz_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2166"><span class='Ref_To_Local'>time1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2167"><span class='Ref_To_Local'>time2</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN2173"></a><span class='Declare_Function'>timetz_gt</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2175"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2176"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2109"><span class='Ref_to_Func'>timetz_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2175"><span class='Ref_To_Local'>time1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2176"><span class='Ref_To_Local'>time2</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN2182"></a><span class='Declare_Function'>timetz_ge</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2184"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2185"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2109"><span class='Ref_to_Func'>timetz_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2184"><span class='Ref_To_Local'>time1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2185"><span class='Ref_To_Local'>time2</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN2191"></a><span class='Declare_Function'>timetz_cmp</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2193"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2194"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2109"><span class='Ref_to_Func'>timetz_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2193"><span class='Ref_To_Local'>time1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2194"><span class='Ref_To_Local'>time2</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN2200"></a><span class='Declare_Function'>timetz_hash</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2202"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>key</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2203"></a>    <a href="../../../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a>      <span class='Declare_Local'>thash</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * To avoid any problems with padding bytes in the struct, we figure the 
     * field hashes separately and XOR them. 
     */ 
</span>    <a href="date.c.html#LN2203"><span class='Ref_To_Local'>thash</span></a> <span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN491"><span class='Ref_to_Macro'>DatumGetUInt32</span></a><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN583"><span class='Ref_to_Macro'>DirectFunctionCall1</span></a><span class='Parentheses'>(</span><a href="../../access/hash/hashfunc.c.html#LN60"><span class='Ref_to_Func'>hashint8</span></a><span class='Delimiter'>, 
</span>                                               <a href="../../../include/postgres.h.html#LN777"><span class='Ref_to_Macro'>Int64GetDatumFast</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2202"><span class='Ref_To_Local'>key</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN2203"><span class='Ref_To_Local'>thash</span></a> <span class='Operator'>^= </span><a href="../../../include/postgres.h.html#LN491"><span class='Ref_to_Macro'>DatumGetUInt32</span></a><span class='Parentheses'>(</span><a href="../../../include/access/hash.h.html#LN326"><span class='Ref_to_Proto'>hash_uint32</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2202"><span class='Ref_To_Local'>key</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN314"><span class='Ref_to_Macro'>PG_RETURN_UINT32</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2203"><span class='Ref_To_Local'>thash</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN2216"></a><span class='Declare_Function'>timetz_larger</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2218"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2219"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2220"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2109"><span class='Ref_to_Func'>timetz_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2218"><span class='Ref_To_Local'>time1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2219"><span class='Ref_To_Local'>time2</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="date.c.html#LN2220"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2218"><span class='Ref_To_Local'>time1</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="date.c.html#LN2220"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2219"><span class='Ref_To_Local'>time2</span></a><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/date.h.html#LN65"><span class='Ref_to_Macro'>PG_RETURN_TIMETZADT_P</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2220"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN2230"></a><span class='Declare_Function'>timetz_smaller</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2232"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time1</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2233"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time2</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2234"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2109"><span class='Ref_to_Func'>timetz_cmp_internal</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2232"><span class='Ref_To_Local'>time1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2233"><span class='Ref_To_Local'>time2</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="date.c.html#LN2234"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2232"><span class='Ref_To_Local'>time1</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="date.c.html#LN2234"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2233"><span class='Ref_To_Local'>time2</span></a><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/date.h.html#LN65"><span class='Ref_to_Macro'>PG_RETURN_TIMETZADT_P</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2234"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* timetz_pl_interval() 
 * Add interval to timetz. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN2247"></a><span class='Declare_Function'>timetz_pl_interval</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2249"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2250"></a>    <a href="../../../include/datatype/timestamp.h.html#LN42"><span class='Ref_to_Typedef'>Interval</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>span</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN36"><span class='Ref_to_Macro'>PG_GETARG_INTERVAL_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2251"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN2251"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN2251"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2249"><span class='Ref_To_Local'>time</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>+ </span><a href="date.c.html#LN2250"><span class='Ref_To_Local'>span</span></a><span class='Operator'>-&GT;</span><a href="../../../interfaces/ecpg/include/pgtypes_interval.h.html#LN27"><span class='Ref_to_Member'>time</span></a><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN2251"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>-= </span><a href="date.c.html#LN2251"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>/ </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2251"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>&LT; </span><a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>))</span> 
        <a href="date.c.html#LN2251"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>+= </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN2251"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2249"><span class='Ref_To_Local'>time</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN65"><span class='Ref_to_Macro'>PG_RETURN_TIMETZADT_P</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2251"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* timetz_mi_interval() 
 * Subtract interval from timetz. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN2269"></a><span class='Declare_Function'>timetz_mi_interval</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2271"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2272"></a>    <a href="../../../include/datatype/timestamp.h.html#LN42"><span class='Ref_to_Typedef'>Interval</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>span</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN36"><span class='Ref_to_Macro'>PG_GETARG_INTERVAL_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2273"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN2273"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN2273"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2271"><span class='Ref_To_Local'>time</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>- </span><a href="date.c.html#LN2272"><span class='Ref_To_Local'>span</span></a><span class='Operator'>-&GT;</span><a href="../../../interfaces/ecpg/include/pgtypes_interval.h.html#LN27"><span class='Ref_to_Member'>time</span></a><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN2273"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>-= </span><a href="date.c.html#LN2273"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>/ </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2273"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>&LT; </span><a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>))</span> 
        <a href="date.c.html#LN2273"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>+= </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN2273"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2271"><span class='Ref_To_Local'>time</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN65"><span class='Ref_to_Macro'>PG_RETURN_TIMETZADT_P</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2273"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* overlaps_timetz() --- implements the SQL OVERLAPS operator. 
 * 
 * Algorithm is per SQL spec.  This is much harder than you'd think 
 * because the spec requires us to deliver a non-null answer in some cases 
 * where some of the inputs are null. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN2294"></a><span class='Declare_Function'>overlaps_timetz</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* 
     * The arguments are TimeTzADT *, but we leave them as generic Datums for 
     * convenience of notation --- and to avoid dereferencing nulls. 
     */ 
</span><a name="LN2300"></a>    <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>ts1</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2301"></a>    <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>te1</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2302"></a>    <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>ts2</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2303"></a>    <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>te2</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><span class='Number'>3</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2304"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>ts1IsNull</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN173"><span class='Ref_to_Macro'>PG_ARGISNULL</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2305"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>te1IsNull</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN173"><span class='Ref_to_Macro'>PG_ARGISNULL</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2306"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>ts2IsNull</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN173"><span class='Ref_to_Macro'>PG_ARGISNULL</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2307"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>te2IsNull</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN173"><span class='Ref_to_Macro'>PG_ARGISNULL</span></a><span class='Parentheses'>(</span><span class='Number'>3</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<a name="LN2309"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>TIMETZ_GT</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>t1</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>t2</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN585"><span class='Ref_to_Macro'>DirectFunctionCall2</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2172"><span class='Ref_to_Func'>timetz_gt</span></a><span class='Delimiter'>,</span>t1<span class='Delimiter'>,</span>t2<span class='Parentheses'>))</span> 
<a name="LN2311"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>TIMETZ_LT</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>t1</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>t2</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <a href="../../../include/postgres.h.html#LN398"><span class='Ref_to_Macro'>DatumGetBool</span></a><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN585"><span class='Ref_to_Macro'>DirectFunctionCall2</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2154"><span class='Ref_to_Func'>timetz_lt</span></a><span class='Delimiter'>,</span>t1<span class='Delimiter'>,</span>t2<span class='Parentheses'>))</span> 
 
    <span class='Comment_Multi_Line'>/* 
     * If both endpoints of interval 1 are null, the result is null (unknown). 
     * If just one endpoint is null, take ts1 as the non-null one. Otherwise, 
     * take ts1 as the lesser endpoint. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2304"><span class='Ref_To_Local'>ts1IsNull</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2305"><span class='Ref_To_Local'>te1IsNull</span></a><span class='Parentheses'>) 
</span>            <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* swap null for non-null */ 
</span>        <a href="date.c.html#LN2300"><span class='Ref_To_Local'>ts1</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2301"><span class='Ref_To_Local'>te1</span></a><span class='Delimiter'>; 
</span>        <a href="date.c.html#LN2305"><span class='Ref_To_Local'>te1IsNull</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="date.c.html#LN2305"><span class='Ref_To_Local'>te1IsNull</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2309"><span class='Ref_to_Macro'>TIMETZ_GT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2300"><span class='Ref_To_Local'>ts1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2301"><span class='Ref_To_Local'>te1</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN2331"></a>            <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>tt</span> <span class='Operator'>= </span><a href="date.c.html#LN2300"><span class='Ref_To_Local'>ts1</span></a><span class='Delimiter'>; 
</span> 
            <a href="date.c.html#LN2300"><span class='Ref_To_Local'>ts1</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2301"><span class='Ref_To_Local'>te1</span></a><span class='Delimiter'>; 
</span>            <a href="date.c.html#LN2301"><span class='Ref_To_Local'>te1</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2331"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Likewise for interval 2. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2306"><span class='Ref_To_Local'>ts2IsNull</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2307"><span class='Ref_To_Local'>te2IsNull</span></a><span class='Parentheses'>) 
</span>            <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* swap null for non-null */ 
</span>        <a href="date.c.html#LN2302"><span class='Ref_To_Local'>ts2</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2303"><span class='Ref_To_Local'>te2</span></a><span class='Delimiter'>; 
</span>        <a href="date.c.html#LN2307"><span class='Ref_To_Local'>te2IsNull</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="date.c.html#LN2307"><span class='Ref_To_Local'>te2IsNull</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2309"><span class='Ref_to_Macro'>TIMETZ_GT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2302"><span class='Ref_To_Local'>ts2</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2303"><span class='Ref_To_Local'>te2</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN2351"></a>            <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>tt</span> <span class='Operator'>= </span><a href="date.c.html#LN2302"><span class='Ref_To_Local'>ts2</span></a><span class='Delimiter'>; 
</span> 
            <a href="date.c.html#LN2302"><span class='Ref_To_Local'>ts2</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2303"><span class='Ref_To_Local'>te2</span></a><span class='Delimiter'>; 
</span>            <a href="date.c.html#LN2303"><span class='Ref_To_Local'>te2</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2351"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * At this point neither ts1 nor ts2 is null, so we can consider three 
     * cases: ts1 &GT; ts2, ts1 &LT; ts2, ts1 = ts2 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2309"><span class='Ref_to_Macro'>TIMETZ_GT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2300"><span class='Ref_To_Local'>ts1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2302"><span class='Ref_To_Local'>ts2</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * This case is ts1 &LT; te2 OR te1 &LT; te2, which may look redundant but 
         * in the presence of nulls it's not quite completely so. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2307"><span class='Ref_To_Local'>te2IsNull</span></a><span class='Parentheses'>) 
</span>            <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2311"><span class='Ref_to_Macro'>TIMETZ_LT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2300"><span class='Ref_To_Local'>ts1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2303"><span class='Ref_To_Local'>te2</span></a><span class='Parentheses'>))</span> 
            <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2305"><span class='Ref_To_Local'>te1IsNull</span></a><span class='Parentheses'>) 
</span>            <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If te1 is not null then we had ts1 &LT;= te1 above, and we just found 
         * ts1 &GT;= te2, hence te1 &GT;= te2. 
         */ 
</span>        <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2311"><span class='Ref_to_Macro'>TIMETZ_LT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2300"><span class='Ref_To_Local'>ts1</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2302"><span class='Ref_To_Local'>ts2</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* This case is ts2 &LT; te1 OR te2 &LT; te1 */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2305"><span class='Ref_To_Local'>te1IsNull</span></a><span class='Parentheses'>) 
</span>            <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2311"><span class='Ref_to_Macro'>TIMETZ_LT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2302"><span class='Ref_To_Local'>ts2</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2301"><span class='Ref_To_Local'>te1</span></a><span class='Parentheses'>))</span> 
            <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2307"><span class='Ref_To_Local'>te2IsNull</span></a><span class='Parentheses'>) 
</span>            <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If te2 is not null then we had ts2 &LT;= te2 above, and we just found 
         * ts2 &GT;= te1, hence te2 &GT;= te1. 
         */ 
</span>        <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * For ts1 = ts2 the spec says te1 &LT;&GT; te2 OR te1 = te2, which is a 
         * rather silly way of saying "true if both are nonnull, else null". 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2305"><span class='Ref_To_Local'>te1IsNull</span></a> <span class='Operator'>|| </span><a href="date.c.html#LN2307"><span class='Ref_To_Local'>te2IsNull</span></a><span class='Parentheses'>) 
</span>            <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
<span class='Keyword'>#undef </span><a href="date.c.html#LN2309"><span class='Ref_to_Macro'>TIMETZ_GT</span></a> 
<span class='Keyword'>#undef </span><a href="date.c.html#LN2311"><span class='Ref_to_Macro'>TIMETZ_LT</span></a> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end overlaps_timetz &raquo; </span> 
 
 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN2414"></a><span class='Declare_Function'>timetz_time</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2416"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>timetz</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2417"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* swallow the time zone and just return the time */ 
</span>    <a href="date.c.html#LN2417"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2416"><span class='Ref_To_Local'>timetz</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN64"><span class='Ref_to_Macro'>PG_RETURN_TIMEADT</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2417"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN2427"></a><span class='Declare_Function'>time_timetz</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2429"></a>    <a href="../../../include/utils/date.h.html#LN23"><span class='Ref_to_Typedef'>TimeADT</span></a>     <span class='Declare_Local'>time</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN60"><span class='Ref_to_Macro'>PG_GETARG_TIMEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2430"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN2431"></a>    <span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Declare_Local'>tt</span><span class='Delimiter'>, 
</span><a name="LN2432"></a>               <span class='Operator'>*</span><span class='Declare_Local'>tm</span> <span class='Operator'>= &</span><a href="date.c.html#LN2431"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span><a name="LN2433"></a>    <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a>      <span class='Declare_Local'>fsec</span><span class='Delimiter'>; 
</span><a name="LN2434"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>tz</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/datetime.h.html#LN288"><span class='Ref_to_Proto'>GetCurrentDateTime</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2432"><span class='Ref_To_Local'>tm</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN43"><span class='Ref_to_Proto'>time2tm</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2429"><span class='Ref_To_Local'>time</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2432"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN2433"><span class='Ref_To_Local'>fsec</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN2434"><span class='Ref_To_Local'>tz</span></a> <span class='Operator'>= </span><a href="../../../include/utils/datetime.h.html#LN311"><span class='Ref_to_Proto'>DetermineTimeZoneOffset</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2432"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><a href="../../../timezone/pgtz.c.html#LN27"><span class='Ref_to_Global_Var'>session_timezone</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN2430"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN2430"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2429"><span class='Ref_To_Local'>time</span></a><span class='Delimiter'>; 
</span>    <a href="date.c.html#LN2430"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2434"><span class='Ref_To_Local'>tz</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN65"><span class='Ref_to_Macro'>PG_RETURN_TIMETZADT_P</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2430"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end time_timetz &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* timestamptz_timetz() 
 * Convert timestamp to timetz data type. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN2453"></a><span class='Declare_Function'>timestamptz_timetz</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2455"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>timestamp</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN34"><span class='Ref_to_Macro'>PG_GETARG_TIMESTAMP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2456"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN2457"></a>    <span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Declare_Local'>tt</span><span class='Delimiter'>, 
</span><a name="LN2458"></a>               <span class='Operator'>*</span><span class='Declare_Local'>tm</span> <span class='Operator'>= &</span><a href="date.c.html#LN2457"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span><a name="LN2459"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>tz</span><span class='Delimiter'>; 
</span><a name="LN2460"></a>    <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a>      <span class='Declare_Local'>fsec</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/datatype/timestamp.h.html#LN121"><span class='Ref_to_Macro'>TIMESTAMP_NOT_FINITE</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2455"><span class='Ref_To_Local'>timestamp</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN84"><span class='Ref_to_Proto'>timestamp2tm</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2455"><span class='Ref_To_Local'>timestamp</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN2459"><span class='Ref_To_Local'>tz</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2458"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN2460"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"timestamp out of range"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN2456"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN46"><span class='Ref_to_Proto'>tm2timetz</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2458"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2460"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2459"><span class='Ref_To_Local'>tz</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2456"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN65"><span class='Ref_to_Macro'>PG_RETURN_TIMETZADT_P</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2456"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end timestamptz_timetz &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* datetimetz_timestamptz() 
 * Convert date and timetz to timestamp with time zone data type. 
 * Timestamp is stored in GMT, so add the time zone 
 * stored with the timetz to the result. 
 * - thomas 2000-03-10 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN2485"></a><span class='Declare_Function'>datetimetz_timestamptz</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2487"></a>    <a href="../../../include/utils/date.h.html#LN21"><span class='Ref_to_Typedef'>DateADT</span></a>     <span class='Declare_Local'>date</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN59"><span class='Ref_to_Macro'>PG_GETARG_DATEADT</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2488"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2489"></a>    <a href="../../../interfaces/ecpg/include/pgtypes_timestamp.h.html#LN9"><span class='Ref_to_Typedef'>TimestampTz</span></a> <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN38"><span class='Ref_to_Macro'>DATE_IS_NOBEGIN</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2487"><span class='Ref_To_Local'>date</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/datatype/timestamp.h.html#LN111"><span class='Ref_to_Macro'>TIMESTAMP_NOBEGIN</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2489"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN40"><span class='Ref_to_Macro'>DATE_IS_NOEND</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2487"><span class='Ref_To_Local'>date</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/datatype/timestamp.h.html#LN116"><span class='Ref_to_Macro'>TIMESTAMP_NOEND</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2489"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Date's range is wider than timestamp's, so check for boundaries. 
         * Since dates have the same minimum values as timestamps, only upper 
         * boundary need be checked for overflow. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2487"><span class='Ref_To_Local'>date</span></a> <span class='Operator'>&GT;= </span><span class='Parentheses'>(</span><a href="../../../include/datatype/timestamp.h.html#LN180"><span class='Ref_to_Const'>TIMESTAMP_END_JULIAN</span></a> <span class='Operator'>- </span><a href="../../../include/datatype/timestamp.h.html#LN162"><span class='Ref_to_Const'>POSTGRES_EPOCH_JDATE</span></a><span class='Parentheses'>))</span> 
            <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"date out of range for timestamp"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <a href="date.c.html#LN2489"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2487"><span class='Ref_To_Local'>date</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a> <span class='Operator'>+ </span><a href="date.c.html#LN2488"><span class='Ref_To_Local'>time</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>+ </span><a href="date.c.html#LN2488"><span class='Ref_To_Local'>time</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN93"><span class='Ref_to_Const'>USECS_PER_SEC</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Since it is possible to go beyond allowed timestamptz range because 
         * of time zone, check for allowed timestamp range after adding tz. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/datatype/timestamp.h.html#LN194"><span class='Ref_to_Macro'>IS_VALID_TIMESTAMP</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2489"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span> 
            <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATETIME_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"date out of range for timestamp"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <a href="../../../include/utils/timestamp.h.html#LN38"><span class='Ref_to_Macro'>PG_RETURN_TIMESTAMP</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2489"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end datetimetz_timestamptz &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* timetz_part() 
 * Extract specified field from time type. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN2526"></a><span class='Declare_Function'>timetz_part</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2528"></a>    <a href="../../../../contrib/seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>units</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN272"><span class='Ref_to_Macro'>PG_GETARG_TEXT_PP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2529"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2530"></a>    <a href="../../../include/c.h.html#LN380"><span class='Ref_to_Typedef'>float8</span></a>      <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN2531"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>type</span><span class='Delimiter'>, 
</span><a name="LN2532"></a>                <span class='Declare_Local'>val</span><span class='Delimiter'>; 
</span><a name="LN2533"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>lowunits</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN2533"><span class='Ref_To_Local'>lowunits</span></a> <span class='Operator'>= </span><a href="../../../include/parser/scansup.h.html#LN19"><span class='Ref_to_Proto'>downcase_truncate_identifier</span></a><span class='Parentheses'>(</span><a href="../../../include/postgres.h.html#LN346"><span class='Ref_to_Macro'>VARDATA_ANY</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2528"><span class='Ref_To_Local'>units</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                            <a href="../../../include/postgres.h.html#LN339"><span class='Ref_to_Macro'>VARSIZE_ANY_EXHDR</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2528"><span class='Ref_To_Local'>units</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                            <span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN2531"><span class='Ref_To_Local'>type</span></a> <span class='Operator'>= </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN318"><span class='Ref_to_Proto'>DecodeUnits</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="date.c.html#LN2533"><span class='Ref_To_Local'>lowunits</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN2532"><span class='Ref_To_Local'>val</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2531"><span class='Ref_To_Local'>type</span></a> <span class='Operator'>== </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN118"><span class='Ref_to_Const'>UNKNOWN_FIELD</span></a><span class='Parentheses'>) 
</span>        <a href="date.c.html#LN2531"><span class='Ref_To_Local'>type</span></a> <span class='Operator'>= </span><a href="../../../include/utils/datetime.h.html#LN327"><span class='Ref_to_Proto'>DecodeSpecial</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="date.c.html#LN2533"><span class='Ref_To_Local'>lowunits</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN2532"><span class='Ref_To_Local'>val</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2531"><span class='Ref_To_Local'>type</span></a> <span class='Operator'>== </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN106"><span class='Ref_to_Const'>UNITS</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2545"></a>        <span class='Keyword'>double</span>      <span class='Declare_Local'>dummy</span><span class='Delimiter'>; 
</span><a name="LN2546"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>tz</span><span class='Delimiter'>; 
</span><a name="LN2547"></a>        <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a>      <span class='Declare_Local'>fsec</span><span class='Delimiter'>; 
</span><a name="LN2548"></a>        <span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Declare_Local'>tt</span><span class='Delimiter'>, 
</span><a name="LN2549"></a>                   <span class='Operator'>*</span><span class='Declare_Local'>tm</span> <span class='Operator'>= &</span><a href="date.c.html#LN2548"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span> 
        <a href="date.c.html#LN44"><span class='Ref_to_Proto'>timetz2tm</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2529"><span class='Ref_To_Local'>time</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2549"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN2547"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN2546"><span class='Ref_To_Local'>tz</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2532"><span class='Ref_To_Local'>val</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN141"><span class='Ref_to_Const'>DTK_TZ</span></a><span class='Operator'>: 
</span>                <a href="date.c.html#LN2530"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= -</span><a href="date.c.html#LN2546"><span class='Ref_To_Local'>tz</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN175"><span class='Ref_to_Const'>DTK_TZ_MINUTE</span></a><span class='Operator'>: 
</span>                <a href="date.c.html#LN2530"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= -</span><a href="date.c.html#LN2546"><span class='Ref_To_Local'>tz</span></a><span class='Delimiter'>; 
</span>                <a href="date.c.html#LN2530"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>/= </span><a href="../../../include/datatype/timestamp.h.html#LN87"><span class='Ref_to_Const'>SECS_PER_MINUTE</span></a><span class='Delimiter'>; 
</span>                <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN216"><span class='Ref_to_Macro'>FMODULO</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2530"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2545"><span class='Ref_To_Local'>dummy</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>double</span><span class='Parentheses'>) </span><a href="../../../include/datatype/timestamp.h.html#LN87"><span class='Ref_to_Const'>SECS_PER_MINUTE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN174"><span class='Ref_to_Const'>DTK_TZ_HOUR</span></a><span class='Operator'>: 
</span>                <a href="date.c.html#LN2545"><span class='Ref_To_Local'>dummy</span></a> <span class='Operator'>= -</span><a href="date.c.html#LN2546"><span class='Ref_To_Local'>tz</span></a><span class='Delimiter'>; 
</span>                <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN216"><span class='Ref_to_Macro'>FMODULO</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2545"><span class='Ref_To_Local'>dummy</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2530"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>double</span><span class='Parentheses'>) </span><a href="../../../include/datatype/timestamp.h.html#LN86"><span class='Ref_to_Const'>SECS_PER_HOUR</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN169"><span class='Ref_to_Const'>DTK_MICROSEC</span></a><span class='Operator'>: 
</span>                <a href="date.c.html#LN2530"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2549"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN26"><span class='Ref_to_Member'>tm_sec</span></a> <span class='Operator'>* </span><span class='Number'>1000000</span><span class='Operator'>.</span><span class='Number'>0</span> <span class='Operator'>+ </span><a href="date.c.html#LN2547"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN168"><span class='Ref_to_Const'>DTK_MILLISEC</span></a><span class='Operator'>: 
</span>                <a href="date.c.html#LN2530"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2549"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN26"><span class='Ref_to_Member'>tm_sec</span></a> <span class='Operator'>* </span><span class='Number'>1000</span><span class='Operator'>.</span><span class='Number'>0</span> <span class='Operator'>+ </span><a href="date.c.html#LN2547"><span class='Ref_To_Local'>fsec</span></a> <span class='Operator'>/ </span><span class='Number'>1000</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN157"><span class='Ref_to_Const'>DTK_SECOND</span></a><span class='Operator'>: 
</span>                <a href="date.c.html#LN2530"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2549"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN26"><span class='Ref_to_Member'>tm_sec</span></a> <span class='Operator'>+ </span><a href="date.c.html#LN2547"><span class='Ref_To_Local'>fsec</span></a> <span class='Operator'>/ </span><span class='Number'>1000000</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN158"><span class='Ref_to_Const'>DTK_MINUTE</span></a><span class='Operator'>: 
</span>                <a href="date.c.html#LN2530"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2549"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN27"><span class='Ref_to_Member'>tm_min</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN159"><span class='Ref_to_Const'>DTK_HOUR</span></a><span class='Operator'>: 
</span>                <a href="date.c.html#LN2530"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2549"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN28"><span class='Ref_to_Member'>tm_hour</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN160"><span class='Ref_to_Const'>DTK_DAY</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN162"><span class='Ref_to_Const'>DTK_MONTH</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN163"><span class='Ref_to_Const'>DTK_QUARTER</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN164"><span class='Ref_to_Const'>DTK_YEAR</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN165"><span class='Ref_to_Const'>DTK_DECADE</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN166"><span class='Ref_to_Const'>DTK_CENTURY</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN167"><span class='Ref_to_Const'>DTK_MILLENNIUM</span></a><span class='Operator'>: 
</span>            <span class='Control'>default</span><span class='Operator'>: 
</span>                <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"\"time with time zone\" units \"%s\" not recognized"</span><span class='Delimiter'>, 
</span>                       <a href="date.c.html#LN2533"><span class='Ref_To_Local'>lowunits</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <a href="date.c.html#LN2530"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch val &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if type==UNITS &raquo; </span> 
    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2531"><span class='Ref_To_Local'>type</span></a> <span class='Operator'>== </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN89"><span class='Ref_to_Const'>RESERV</span></a> <span class='Operator'>&& </span><a href="date.c.html#LN2532"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>== </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN149"><span class='Ref_to_Const'>DTK_EPOCH</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="date.c.html#LN2530"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2529"><span class='Ref_To_Local'>time</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>/ </span><span class='Number'>1000000</span><span class='Operator'>.</span><span class='Number'>0</span> <span class='Operator'>+ </span><a href="date.c.html#LN2529"><span class='Ref_To_Local'>time</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"\"time with time zone\" units \"%s\" not recognized"</span><span class='Delimiter'>, 
</span>                        <a href="date.c.html#LN2533"><span class='Ref_To_Local'>lowunits</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <a href="date.c.html#LN2530"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../../include/fmgr.h.html#LN325"><span class='Ref_to_Macro'>PG_RETURN_FLOAT8</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2530"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end timetz_part &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* timetz_zone() 
 * Encode time with time zone type with specified time zone. 
 * Applies DST rules as of the current date. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN2626"></a><span class='Declare_Function'>timetz_zone</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2628"></a>    <a href="../../../../contrib/seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>zone</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN272"><span class='Ref_to_Macro'>PG_GETARG_TEXT_PP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2629"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>t</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2630"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN2631"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>tz</span><span class='Delimiter'>; 
</span><a name="LN2632"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>tzname</span><span class='Delimiter'>[</span><a href="../../../include/pgtime.h.html#LN43"><span class='Ref_to_Const'>TZ_STRLEN_MAX</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span><a name="LN2633"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>lowzone</span><span class='Delimiter'>; 
</span><a name="LN2634"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>type</span><span class='Delimiter'>, 
</span><a name="LN2635"></a>                <span class='Declare_Local'>val</span><span class='Delimiter'>; 
</span><a name="LN2636"></a>    <a href="../../../timezone/pgtz.h.html#LN58"><span class='Ref_to_Struct'>pg_tz</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>tzp</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Look up the requested timezone.  First we look in the timezone 
     * abbreviation table (to handle cases like "EST"), and if that fails, we 
     * look in the timezone database (to handle cases like 
     * "America/New_York").  (This matches the order in which timestamp input 
     * checks the cases; it's important because the timezone database unwisely 
     * uses a few zone names that are identical to offset abbreviations.) 
     */ 
</span>    <a href="../../../include/utils/builtins.h.html#LN88"><span class='Ref_to_Proto'>text_to_cstring_buffer</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2628"><span class='Ref_To_Local'>zone</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2632"><span class='Ref_To_Local'>tzname</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="date.c.html#LN2632"><span class='Ref_To_Local'>tzname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* DecodeTimezoneAbbrev requires lowercase input */ 
</span>    <a href="date.c.html#LN2633"><span class='Ref_To_Local'>lowzone</span></a> <span class='Operator'>= </span><a href="../../../include/parser/scansup.h.html#LN19"><span class='Ref_to_Proto'>downcase_truncate_identifier</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2632"><span class='Ref_To_Local'>tzname</span></a><span class='Delimiter'>, 
</span>                                           strlen<span class='Parentheses'>(</span><a href="date.c.html#LN2632"><span class='Ref_To_Local'>tzname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                           <span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN2634"><span class='Ref_To_Local'>type</span></a> <span class='Operator'>= </span><a href="../../../include/utils/datetime.h.html#LN325"><span class='Ref_to_Proto'>DecodeTimezoneAbbrev</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="date.c.html#LN2633"><span class='Ref_To_Local'>lowzone</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN2635"><span class='Ref_To_Local'>val</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="date.c.html#LN2636"><span class='Ref_To_Local'>tzp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2634"><span class='Ref_To_Local'>type</span></a> <span class='Operator'>== </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN94"><span class='Ref_to_Const'>TZ</span></a> <span class='Operator'>|| </span><a href="date.c.html#LN2634"><span class='Ref_To_Local'>type</span></a> <span class='Operator'>== </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN95"><span class='Ref_to_Const'>DTZ</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* fixed-offset abbreviation */ 
</span>        <a href="date.c.html#LN2631"><span class='Ref_To_Local'>tz</span></a> <span class='Operator'>= -</span><a href="date.c.html#LN2635"><span class='Ref_To_Local'>val</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2634"><span class='Ref_To_Local'>type</span></a> <span class='Operator'>== </span><a href="../../../interfaces/ecpg/pgtypeslib/dt.h.html#LN96"><span class='Ref_to_Const'>DYNTZ</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* dynamic-offset abbreviation, resolve using current time */ 
</span><a name="LN2663"></a>        <a href="../../../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a>   <span class='Declare_Local'>now</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a><span class='Parentheses'>) </span>time<span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2664"></a>        <span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Operator'>*</span><span class='Declare_Local'>tm</span><span class='Delimiter'>; 
</span> 
        <a href="date.c.html#LN2664"><span class='Ref_To_Local'>tm</span></a> <span class='Operator'>= </span><a href="../../../include/pgtime.h.html#LN47"><span class='Ref_to_Proto'>pg_localtime</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="date.c.html#LN2663"><span class='Ref_To_Local'>now</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2636"><span class='Ref_To_Local'>tzp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="date.c.html#LN2631"><span class='Ref_To_Local'>tz</span></a> <span class='Operator'>= </span><a href="../../../include/utils/datetime.h.html#LN312"><span class='Ref_to_Proto'>DetermineTimeZoneAbbrevOffset</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2664"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2632"><span class='Ref_To_Local'>tzname</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2636"><span class='Ref_To_Local'>tzp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* try it as a full zone name */ 
</span>        <a href="date.c.html#LN2636"><span class='Ref_To_Local'>tzp</span></a> <span class='Operator'>= </span><a href="../../../include/pgtime.h.html#LN76"><span class='Ref_to_Proto'>pg_tzset</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2632"><span class='Ref_To_Local'>tzname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2636"><span class='Ref_To_Local'>tzp</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Get the offset-from-GMT that is valid today for the zone */ 
</span><a name="LN2676"></a>            <a href="../../../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a>   <span class='Declare_Local'>now</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a><span class='Parentheses'>) </span>time<span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2677"></a>            <span class='Control'>struct</span> <a href="../../../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Operator'>*</span><span class='Declare_Local'>tm</span><span class='Delimiter'>; 
</span> 
            <a href="date.c.html#LN2677"><span class='Ref_To_Local'>tm</span></a> <span class='Operator'>= </span><a href="../../../include/pgtime.h.html#LN47"><span class='Ref_to_Proto'>pg_localtime</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="date.c.html#LN2676"><span class='Ref_To_Local'>now</span></a><span class='Delimiter'>, </span><a href="date.c.html#LN2636"><span class='Ref_To_Local'>tzp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="date.c.html#LN2631"><span class='Ref_To_Local'>tz</span></a> <span class='Operator'>= -</span><a href="date.c.html#LN2677"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span><a href="../../../include/pgtime.h.html#LN35"><span class='Ref_to_Member'>tm_gmtoff</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"time zone \"%s\" not recognized"</span><span class='Delimiter'>, </span><a href="date.c.html#LN2632"><span class='Ref_To_Local'>tzname</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <a href="date.c.html#LN2631"><span class='Ref_To_Local'>tz</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>;</span>             <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <a href="date.c.html#LN2630"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN2630"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2629"><span class='Ref_To_Local'>t</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>+ </span><span class='Parentheses'>(</span><a href="date.c.html#LN2629"><span class='Ref_To_Local'>t</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a> <span class='Operator'>- </span><a href="date.c.html#LN2631"><span class='Ref_To_Local'>tz</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN93"><span class='Ref_to_Const'>USECS_PER_SEC</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2630"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>&LT; </span><a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>))</span> 
        <a href="date.c.html#LN2630"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>+= </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2630"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>&GT;= </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Parentheses'>) 
</span>        <a href="date.c.html#LN2630"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>-= </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN2630"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2631"><span class='Ref_To_Local'>tz</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN65"><span class='Ref_to_Macro'>PG_RETURN_TIMETZADT_P</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2630"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end timetz_zone &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* timetz_izone() 
 * Encode time with time zone type with specified time interval as time zone. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN2708"></a><span class='Declare_Function'>timetz_izone</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2710"></a>    <a href="../../../include/datatype/timestamp.h.html#LN42"><span class='Ref_to_Typedef'>Interval</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>zone</span> <span class='Operator'>= </span><a href="../../../include/utils/timestamp.h.html#LN36"><span class='Ref_to_Macro'>PG_GETARG_INTERVAL_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2711"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>time</span> <span class='Operator'>= </span><a href="../../../include/utils/date.h.html#LN61"><span class='Ref_to_Macro'>PG_GETARG_TIMETZADT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2712"></a>    <a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN2713"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>tz</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2710"><span class='Ref_To_Local'>zone</span></a><span class='Operator'>-&GT;</span><a href="../../../interfaces/ecpg/include/pgtypes_interval.h.html#LN28"><span class='Ref_to_Member'>month</span></a> <span class='Operator'>!= </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="date.c.html#LN2710"><span class='Ref_To_Local'>zone</span></a><span class='Operator'>-&GT;</span><a href="../../../include/datatype/timestamp.h.html#LN46"><span class='Ref_to_Member'>day</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>          <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"interval time zone \"%s\" must not include months or days"</span><span class='Delimiter'>, 
</span>                 <a href="../../../include/postgres.h.html#LN571"><span class='Ref_to_Macro'>DatumGetCString</span></a><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN583"><span class='Ref_to_Macro'>DirectFunctionCall1</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN956"><span class='Ref_to_Func'>interval_out</span></a><span class='Delimiter'>, 
</span>                                                  <a href="../../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2710"><span class='Ref_To_Local'>zone</span></a><span class='Parentheses'>))))))</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN2713"><span class='Ref_To_Local'>tz</span></a> <span class='Operator'>= -</span><span class='Parentheses'>(</span><a href="date.c.html#LN2710"><span class='Ref_To_Local'>zone</span></a><span class='Operator'>-&GT;</span><a href="../../../interfaces/ecpg/include/pgtypes_interval.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>/ </span><a href="../../../include/datatype/timestamp.h.html#LN93"><span class='Ref_to_Const'>USECS_PER_SEC</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN2712"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/utils/date.h.html#LN25"><span class='Ref_to_Typedef'>TimeTzADT</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN2712"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2711"><span class='Ref_To_Local'>time</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>+ </span><span class='Parentheses'>(</span><a href="date.c.html#LN2711"><span class='Ref_To_Local'>time</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a> <span class='Operator'>- </span><a href="date.c.html#LN2713"><span class='Ref_To_Local'>tz</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN93"><span class='Ref_to_Const'>USECS_PER_SEC</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2712"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>&LT; </span><a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>))</span> 
        <a href="date.c.html#LN2712"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>+= </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="date.c.html#LN2712"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>&GT;= </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Parentheses'>) 
</span>        <a href="date.c.html#LN2712"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>-= </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Delimiter'>; 
</span> 
    <a href="date.c.html#LN2712"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../../../include/utils/date.h.html#LN28"><span class='Ref_to_Member'>zone</span></a> <span class='Operator'>= </span><a href="date.c.html#LN2713"><span class='Ref_To_Local'>tz</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/date.h.html#LN65"><span class='Ref_to_Macro'>PG_RETURN_TIMETZADT_P</span></a><span class='Parentheses'>(</span><a href="date.c.html#LN2712"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end timetz_izone &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>