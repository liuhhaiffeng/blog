<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\backend\utils\adt\inet_net_pton.c</title>
<LINK REL=StyleSheet HREF="../../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\backend\utils\adt\inet_net_pton.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:51 2017
</td></tr>
<tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/* 
 * Copyright (c) 2004 by Internet Systems Consortium, Inc. ("ISC") 
 * Copyright (c) 1996,1999 by Internet Software Consortium. 
 * 
 * Permission to use, copy, modify, and distribute this software for any 
 * purpose with or without fee is hereby granted, provided that the above 
 * copyright notice and this permission notice appear in all copies. 
 * 
 * THE SOFTWARE IS PROVIDED "AS IS" AND ISC DISCLAIMS ALL WARRANTIES 
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF 
 * MERCHANTABILITY AND FITNESS.  IN NO EVENT SHALL ISC BE LIABLE FOR 
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES 
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN 
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT 
 * OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE. 
 * 
 *    src/backend/utils/adt/inet_net_pton.c 
 */ 
</span> 
<span class='Directive'>#if</span> defined<span class='Parentheses'>(</span>LIBC_SCCS<span class='Parentheses'>) </span><span class='Operator'>&& !</span>defined<span class='Parentheses'>(</span>lint<span class='Parentheses'>) 
</span><a name="LN20"></a><span class='Keyword'>static const char </span><span class='Declare_Var'>rcsid</span><span class='Delimiter'>[] </span><span class='Operator'>= </span><span class='String'>"Id: inet_net_pton.c,v 1.4.2.3 2004/03/17 00:40:11 marka Exp $"</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
 
<span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>&LT;sys/socket.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;netinet/in.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;arpa/inet.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;assert.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;ctype.h&GT;</span> 
 
<span class='Keyword'>#include </span><span class='String'>"utils/builtins.h"</span> <span class='Comment_Multi_Line'>/* pgrminclude ignore */</span>    <span class='Comment_Multi_Line'>/* needed on some 
                                                         * platforms */ 
</span><span class='Keyword'>#include </span><span class='String'>"utils/inet.h"</span> 
 
 
<a name="LN36"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>inet_net_pton_ipv4</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>src</span><span class='Delimiter'>, </span>u_char <span class='Operator'>*</span><span class='Declare_Parameter'>dst</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN37"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>inet_cidr_pton_ipv4</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>src</span><span class='Delimiter'>, </span>u_char <span class='Operator'>*</span><span class='Declare_Parameter'>dst</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>size</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN38"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>inet_net_pton_ipv6</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>src</span><span class='Delimiter'>, </span>u_char <span class='Operator'>*</span><span class='Declare_Parameter'>dst</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN39"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>inet_cidr_pton_ipv6</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>src</span><span class='Delimiter'>, </span>u_char <span class='Operator'>*</span><span class='Declare_Parameter'>dst</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>size</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * int 
 * inet_net_pton(af, src, dst, size) 
 *  convert network number from presentation to network format. 
 *  accepts hex octets, hex strings, decimal octets, and /CIDR. 
 *  "size" is in bytes and describes "dst". 
 * return: 
 *  number of bits, either imputed classfully or specified with /CIDR, 
 *  or -1 if some failure occurred (check errno).  ENOENT means it was 
 *  not a valid network specification. 
 * author: 
 *  Paul Vixie (ISC), June 1996 
 * 
 * Changes: 
 *  I added the inet_cidr_pton function (also from Paul) and changed 
 *  the names to reflect their current use. 
 * 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN61"></a><span class='Declare_Function'>inet_net_pton</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>af</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>src</span><span class='Delimiter'>, </span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Declare_Parameter'>dst</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>size</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN61"><span class='Ref_to_Parameter'>af</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../../include/utils/inet.h.html#LN38"><span class='Ref_to_Const'>PGSQL_AF_INET</span></a><span class='Operator'>: 
</span>            <span class='Control'>return</span> <a href="inet_net_pton.c.html#LN61"><span class='Ref_to_Parameter'>size</span></a> <span class='Operator'>== -</span><span class='Number'>1</span> <span class='Operator'>? 
</span>                <a href="inet_net_pton.c.html#LN36"><span class='Ref_to_Proto'>inet_net_pton_ipv4</span></a><span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN61"><span class='Ref_to_Parameter'>src</span></a><span class='Delimiter'>, </span><a href="inet_net_pton.c.html#LN61"><span class='Ref_to_Parameter'>dst</span></a><span class='Parentheses'>) </span><span class='Operator'>: 
</span>                <a href="inet_net_pton.c.html#LN37"><span class='Ref_to_Proto'>inet_cidr_pton_ipv4</span></a><span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN61"><span class='Ref_to_Parameter'>src</span></a><span class='Delimiter'>, </span><a href="inet_net_pton.c.html#LN61"><span class='Ref_to_Parameter'>dst</span></a><span class='Delimiter'>, </span><a href="inet_net_pton.c.html#LN61"><span class='Ref_to_Parameter'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="../../../include/utils/inet.h.html#LN39"><span class='Ref_to_Const'>PGSQL_AF_INET6</span></a><span class='Operator'>: 
</span>            <span class='Control'>return</span> <a href="inet_net_pton.c.html#LN61"><span class='Ref_to_Parameter'>size</span></a> <span class='Operator'>== -</span><span class='Number'>1</span> <span class='Operator'>? 
</span>                <a href="inet_net_pton.c.html#LN38"><span class='Ref_to_Proto'>inet_net_pton_ipv6</span></a><span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN61"><span class='Ref_to_Parameter'>src</span></a><span class='Delimiter'>, </span><a href="inet_net_pton.c.html#LN61"><span class='Ref_to_Parameter'>dst</span></a><span class='Parentheses'>) </span><span class='Operator'>: 
</span>                <a href="inet_net_pton.c.html#LN39"><span class='Ref_to_Proto'>inet_cidr_pton_ipv6</span></a><span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN61"><span class='Ref_to_Parameter'>src</span></a><span class='Delimiter'>, </span><a href="inet_net_pton.c.html#LN61"><span class='Ref_to_Parameter'>dst</span></a><span class='Delimiter'>, </span><a href="inet_net_pton.c.html#LN61"><span class='Ref_to_Parameter'>size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            errno <span class='Operator'>= </span><a href="../../../include/port/win32.h.html#LN288"><span class='Ref_to_Const'>EAFNOSUPPORT</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * static int 
 * inet_cidr_pton_ipv4(src, dst, size) 
 *  convert IPv4 network number from presentation to network format. 
 *  accepts hex octets, hex strings, decimal octets, and /CIDR. 
 *  "size" is in bytes and describes "dst". 
 * return: 
 *  number of bits, either imputed classfully or specified with /CIDR, 
 *  or -1 if some failure occurred (check errno).  ENOENT means it was 
 *  not an IPv4 network specification. 
 * note: 
 *  network byte order assumed.  this means 192.5.5.240/28 has 
 *  0b11110000 in its fourth octet. 
 * author: 
 *  Paul Vixie (ISC), June 1996 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN96"></a><span class='Declare_Function'>inet_cidr_pton_ipv4</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>src</span><span class='Delimiter'>, </span>u_char <span class='Operator'>*</span><span class='Declare_Parameter'>dst</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>size</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN98"></a>    <span class='Keyword'>static const char </span><span class='Declare_Local'>xdigits</span><span class='Delimiter'>[] </span><span class='Operator'>= </span><span class='String'>"0123456789abcdef"</span><span class='Delimiter'>; 
</span><a name="LN99"></a>    <span class='Keyword'>static const char </span><span class='Declare_Local'>digits</span><span class='Delimiter'>[] </span><span class='Operator'>= </span><span class='String'>"0123456789"</span><span class='Delimiter'>; 
</span><a name="LN100"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>n</span><span class='Delimiter'>, 
</span><a name="LN101"></a>                <span class='Declare_Local'>ch</span><span class='Delimiter'>, 
</span><a name="LN102"></a>                <span class='Declare_Local'>tmp</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>, 
</span><a name="LN103"></a>                <span class='Declare_Local'>dirty</span><span class='Delimiter'>, 
</span><a name="LN104"></a>                <span class='Declare_Local'>bits</span><span class='Delimiter'>; 
</span><a name="LN105"></a>    <span class='Keyword'>const </span>u_char <span class='Operator'>*</span><span class='Declare_Local'>odst</span> <span class='Operator'>= </span><a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>dst</span></a><span class='Delimiter'>; 
</span> 
    <a href="inet_net_pton.c.html#LN101"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>= *</span><a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN101"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>== </span><span class='String'>'0'</span> <span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>src</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'x'</span> <span class='Operator'>|| </span><a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>src</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'X'</span><span class='Parentheses'>)</span> 
        <span class='Operator'>&& </span>isxdigit<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>src</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Hexadecimal: Eat nybble string. */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>size</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0U</span><span class='Parentheses'>) 
</span>            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN236"><span class='Ref_to_Label'>emsgsize</span></a><span class='Delimiter'>; 
</span>        <a href="inet_net_pton.c.html#LN103"><span class='Ref_To_Local'>dirty</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>                  <span class='Comment_Single_Line'>/* skip x or X. */ 
</span>        <span class='Control'>while</span> <span class='Parentheses'>((</span><a href="inet_net_pton.c.html#LN101"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>= *</span><a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> <span class='Operator'>!= </span><span class='String'>'\0'</span> <span class='Operator'>&& </span>isxdigit<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="inet_net_pton.c.html#LN101"><span class='Ref_To_Local'>ch</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span>isupper<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="inet_net_pton.c.html#LN101"><span class='Ref_To_Local'>ch</span></a><span class='Parentheses'>))</span> 
                <a href="inet_net_pton.c.html#LN101"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>= </span>tolower<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="inet_net_pton.c.html#LN101"><span class='Ref_To_Local'>ch</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="inet_net_pton.c.html#LN100"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN98"><span class='Ref_To_Local'>xdigits</span></a><span class='Delimiter'>, </span><a href="inet_net_pton.c.html#LN101"><span class='Ref_To_Local'>ch</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="inet_net_pton.c.html#LN98"><span class='Ref_To_Local'>xdigits</span></a><span class='Delimiter'>; 
</span>            <span class='Debug'>assert</span><span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN100"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="inet_net_pton.c.html#LN100"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>&LT;= </span><span class='Number'>15</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN103"><span class='Ref_To_Local'>dirty</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                <a href="inet_net_pton.c.html#LN102"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>= </span><a href="inet_net_pton.c.html#LN100"><span class='Ref_To_Local'>n</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="inet_net_pton.c.html#LN102"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN102"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>4</span><span class='Parentheses'>) </span><span class='Operator'>| </span><a href="inet_net_pton.c.html#LN100"><span class='Ref_To_Local'>n</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>++</span><a href="inet_net_pton.c.html#LN103"><span class='Ref_To_Local'>dirty</span></a> <span class='Operator'>== </span><span class='Number'>2</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>size</span></a><span class='Operator'>-- &LT;= </span><span class='Number'>0U</span><span class='Parentheses'>) 
</span>                    <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN236"><span class='Ref_to_Label'>emsgsize</span></a><span class='Delimiter'>; 
</span>                <span class='Operator'>*</span><a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>dst</span></a><span class='Operator'>++ = </span><span class='Parentheses'>(</span>u_char<span class='Parentheses'>) </span><a href="inet_net_pton.c.html#LN102"><span class='Ref_To_Local'>tmp</span></a><span class='Delimiter'>; 
</span>                <a href="inet_net_pton.c.html#LN103"><span class='Ref_To_Local'>dirty</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN103"><span class='Ref_To_Local'>dirty</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{</span>                       <span class='Comment_Single_Line'>/* Odd trailing nybble? */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>size</span></a><span class='Operator'>-- &LT;= </span><span class='Number'>0U</span><span class='Parentheses'>) 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN236"><span class='Ref_to_Label'>emsgsize</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>dst</span></a><span class='Operator'>++ = </span><span class='Parentheses'>(</span>u_char<span class='Parentheses'>) (</span><a href="inet_net_pton.c.html#LN102"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>4</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if ch=='0'&&(src[0]=='x'... &raquo; </span> 
    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>isdigit<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="inet_net_pton.c.html#LN101"><span class='Ref_To_Local'>ch</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Decimal: eat dotted digit string. */ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>;;</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="inet_net_pton.c.html#LN102"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <span class='Control'>do</span> 
            <span class='Delimiter'>{ 
</span>                <a href="inet_net_pton.c.html#LN100"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN99"><span class='Ref_To_Local'>digits</span></a><span class='Delimiter'>, </span><a href="inet_net_pton.c.html#LN101"><span class='Ref_To_Local'>ch</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="inet_net_pton.c.html#LN99"><span class='Ref_To_Local'>digits</span></a><span class='Delimiter'>; 
</span>                <span class='Debug'>assert</span><span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN100"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="inet_net_pton.c.html#LN100"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>&LT;= </span><span class='Number'>9</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="inet_net_pton.c.html#LN102"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>*= </span><span class='Number'>10</span><span class='Delimiter'>; 
</span>                <a href="inet_net_pton.c.html#LN102"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>+= </span><a href="inet_net_pton.c.html#LN100"><span class='Ref_To_Local'>n</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN102"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>&GT; </span><span class='Number'>255</span><span class='Parentheses'>) 
</span>                    <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN232"><span class='Ref_to_Label'>enoent</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} </span><span class='Control'>while</span> <span class='Parentheses'>((</span><a href="inet_net_pton.c.html#LN101"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>= *</span><a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> <span class='Operator'>!= </span><span class='String'>'\0'</span> <span class='Operator'>&& 
</span>                     isdigit<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="inet_net_pton.c.html#LN101"><span class='Ref_To_Local'>ch</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>size</span></a><span class='Operator'>-- &LT;= </span><span class='Number'>0U</span><span class='Parentheses'>) 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN236"><span class='Ref_to_Label'>emsgsize</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>dst</span></a><span class='Operator'>++ = </span><span class='Parentheses'>(</span>u_char<span class='Parentheses'>) </span><a href="inet_net_pton.c.html#LN102"><span class='Ref_To_Local'>tmp</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN101"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>== </span><span class='String'>'\0'</span> <span class='Operator'>|| </span><a href="inet_net_pton.c.html#LN101"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>== </span><span class='String'>'/'</span><span class='Parentheses'>) 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN101"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>!= </span><span class='String'>'.'</span><span class='Parentheses'>) 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN232"><span class='Ref_to_Label'>enoent</span></a><span class='Delimiter'>; 
</span>            <a href="inet_net_pton.c.html#LN101"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>= *</span><a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span>isdigit<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="inet_net_pton.c.html#LN101"><span class='Ref_To_Local'>ch</span></a><span class='Parentheses'>))</span> 
                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN232"><span class='Ref_to_Label'>enoent</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for ;; &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if isdigit((unsignedchar... &raquo; </span> 
    <span class='Control'>else</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN232"><span class='Ref_to_Label'>enoent</span></a><span class='Delimiter'>; 
</span> 
    <a href="inet_net_pton.c.html#LN104"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN101"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>== </span><span class='String'>'/'</span> <span class='Operator'>&& </span>isdigit<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>src</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span> <span class='Operator'>&& </span><a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>dst</span></a> <span class='Operator'>&GT; </span><a href="inet_net_pton.c.html#LN105"><span class='Ref_To_Local'>odst</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* CIDR width specifier.  Nothing can follow it. */ 
</span>        <a href="inet_net_pton.c.html#LN101"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>= *</span><a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>            <span class='Comment_Single_Line'>/* Skip over the /. */ 
</span>        <a href="inet_net_pton.c.html#LN104"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Control'>do</span> 
        <span class='Delimiter'>{ 
</span>            <a href="inet_net_pton.c.html#LN100"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN99"><span class='Ref_To_Local'>digits</span></a><span class='Delimiter'>, </span><a href="inet_net_pton.c.html#LN101"><span class='Ref_To_Local'>ch</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="inet_net_pton.c.html#LN99"><span class='Ref_To_Local'>digits</span></a><span class='Delimiter'>; 
</span>            <span class='Debug'>assert</span><span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN100"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="inet_net_pton.c.html#LN100"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>&LT;= </span><span class='Number'>9</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="inet_net_pton.c.html#LN104"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>*= </span><span class='Number'>10</span><span class='Delimiter'>; 
</span>            <a href="inet_net_pton.c.html#LN104"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>+= </span><a href="inet_net_pton.c.html#LN100"><span class='Ref_To_Local'>n</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} </span><span class='Control'>while</span> <span class='Parentheses'>((</span><a href="inet_net_pton.c.html#LN101"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>= *</span><a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> <span class='Operator'>!= </span><span class='String'>'\0'</span> <span class='Operator'>&& </span>isdigit<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="inet_net_pton.c.html#LN101"><span class='Ref_To_Local'>ch</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN101"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN232"><span class='Ref_to_Label'>enoent</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN104"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>&GT; </span><span class='Number'>32</span><span class='Parentheses'>) 
</span>            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN236"><span class='Ref_to_Label'>emsgsize</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Firey death and destruction unless we prefetched EOS. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN101"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN232"><span class='Ref_to_Label'>enoent</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* If nothing was written to the destination, we found no address. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>dst</span></a> <span class='Operator'>== </span><a href="inet_net_pton.c.html#LN105"><span class='Ref_To_Local'>odst</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN232"><span class='Ref_to_Label'>enoent</span></a><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* If no CIDR spec was given, infer width from net class. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN104"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>== -</span><span class='Number'>1</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="inet_net_pton.c.html#LN105"><span class='Ref_To_Local'>odst</span></a> <span class='Operator'>&GT;= </span><span class='Number'>240</span><span class='Parentheses'>)</span>       <span class='Comment_Single_Line'>/* Class E */ 
</span>            <a href="inet_net_pton.c.html#LN104"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>= </span><span class='Number'>32</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="inet_net_pton.c.html#LN105"><span class='Ref_To_Local'>odst</span></a> <span class='Operator'>&GT;= </span><span class='Number'>224</span><span class='Parentheses'>)</span>  <span class='Comment_Single_Line'>/* Class D */ 
</span>            <a href="inet_net_pton.c.html#LN104"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>= </span><span class='Number'>8</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="inet_net_pton.c.html#LN105"><span class='Ref_To_Local'>odst</span></a> <span class='Operator'>&GT;= </span><span class='Number'>192</span><span class='Parentheses'>)</span>  <span class='Comment_Single_Line'>/* Class C */ 
</span>            <a href="inet_net_pton.c.html#LN104"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>= </span><span class='Number'>24</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="inet_net_pton.c.html#LN105"><span class='Ref_To_Local'>odst</span></a> <span class='Operator'>&GT;= </span><span class='Number'>128</span><span class='Parentheses'>)</span>  <span class='Comment_Single_Line'>/* Class B */ 
</span>            <a href="inet_net_pton.c.html#LN104"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>= </span><span class='Number'>16</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <span class='Comment_Multi_Line'>/* Class A */ 
</span>            <a href="inet_net_pton.c.html#LN104"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>= </span><span class='Number'>8</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* If imputed mask is narrower than specified octets, widen. */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN104"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>&LT; </span><span class='Parentheses'>((</span><a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>dst</span></a> <span class='Operator'>- </span><a href="inet_net_pton.c.html#LN105"><span class='Ref_To_Local'>odst</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><span class='Number'>8</span><span class='Parentheses'>))</span> 
            <a href="inet_net_pton.c.html#LN104"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>dst</span></a> <span class='Operator'>- </span><a href="inet_net_pton.c.html#LN105"><span class='Ref_To_Local'>odst</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><span class='Number'>8</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If there are no additional bits specified for a class D address 
         * adjust bits to 4. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN104"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>== </span><span class='Number'>8</span> <span class='Operator'>&& *</span><a href="inet_net_pton.c.html#LN105"><span class='Ref_To_Local'>odst</span></a> <span class='Operator'>== </span><span class='Number'>224</span><span class='Parentheses'>) 
</span>            <a href="inet_net_pton.c.html#LN104"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if bits==-1 &raquo; </span> 
    <span class='Comment_Multi_Line'>/* Extend network to cover the actual mask. */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN104"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>&GT; </span><span class='Parentheses'>((</span><a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>dst</span></a> <span class='Operator'>- </span><a href="inet_net_pton.c.html#LN105"><span class='Ref_To_Local'>odst</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><span class='Number'>8</span><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>size</span></a><span class='Operator'>-- &LT;= </span><span class='Number'>0U</span><span class='Parentheses'>) 
</span>            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN236"><span class='Ref_to_Label'>emsgsize</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="inet_net_pton.c.html#LN96"><span class='Ref_to_Parameter'>dst</span></a><span class='Operator'>++ = </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN104"><span class='Ref_To_Local'>bits</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<a name="LN232"></a><span class='Label'>enoent</span><span class='Operator'>: 
</span>    errno <span class='Operator'>= </span>ENOENT<span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<a name="LN236"></a><span class='Label'>emsgsize</span><span class='Operator'>: 
</span>    errno <span class='Operator'>= </span><a href="../../../include/port/win32.h.html#LN286"><span class='Ref_to_Const'>EMSGSIZE</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end inet_cidr_pton_ipv4 &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * int 
 * inet_net_pton(af, src, dst, *bits) 
 *  convert network address from presentation to network format. 
 *  accepts inet_pton()'s input for this "af" plus trailing "/CIDR". 
 *  "dst" is assumed large enough for its "af".  "bits" is set to the 
 *  /CIDR prefix length, which can have defaults (like /32 for IPv4). 
 * return: 
 *  -1 if an error occurred (inspect errno; ENOENT means bad format). 
 *  0 if successful conversion occurred. 
 * note: 
 *  192.5.5.1/28 has a nonzero host part, which means it isn't a network 
 *  as called for by inet_cidr_pton() but it can be a host address with 
 *  an included netmask. 
 * author: 
 *  Paul Vixie (ISC), October 1998 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN259"></a><span class='Declare_Function'>inet_net_pton_ipv4</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>src</span><span class='Delimiter'>, </span>u_char <span class='Operator'>*</span><span class='Declare_Parameter'>dst</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN261"></a>    <span class='Keyword'>static const char </span><span class='Declare_Local'>digits</span><span class='Delimiter'>[] </span><span class='Operator'>= </span><span class='String'>"0123456789"</span><span class='Delimiter'>; 
</span><a name="LN262"></a>    <span class='Keyword'>const </span>u_char <span class='Operator'>*</span><span class='Declare_Local'>odst</span> <span class='Operator'>= </span><a href="inet_net_pton.c.html#LN259"><span class='Ref_to_Parameter'>dst</span></a><span class='Delimiter'>; 
</span><a name="LN263"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>n</span><span class='Delimiter'>, 
</span><a name="LN264"></a>                <span class='Declare_Local'>ch</span><span class='Delimiter'>, 
</span><a name="LN265"></a>                <span class='Declare_Local'>tmp</span><span class='Delimiter'>, 
</span><a name="LN266"></a>                <span class='Declare_Local'>bits</span><span class='Delimiter'>; 
</span><a name="LN267"></a>    size_t      <span class='Declare_Local'>size</span> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Get the mantissa. */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN264"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>= *</span><a href="inet_net_pton.c.html#LN259"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>++</span><span class='Delimiter'>, </span>isdigit<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="inet_net_pton.c.html#LN264"><span class='Ref_To_Local'>ch</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="inet_net_pton.c.html#LN265"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Control'>do</span> 
        <span class='Delimiter'>{ 
</span>            <a href="inet_net_pton.c.html#LN263"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN261"><span class='Ref_To_Local'>digits</span></a><span class='Delimiter'>, </span><a href="inet_net_pton.c.html#LN264"><span class='Ref_To_Local'>ch</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="inet_net_pton.c.html#LN261"><span class='Ref_To_Local'>digits</span></a><span class='Delimiter'>; 
</span>            <span class='Debug'>assert</span><span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN263"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="inet_net_pton.c.html#LN263"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>&LT;= </span><span class='Number'>9</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="inet_net_pton.c.html#LN265"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>*= </span><span class='Number'>10</span><span class='Delimiter'>; 
</span>            <a href="inet_net_pton.c.html#LN265"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>+= </span><a href="inet_net_pton.c.html#LN263"><span class='Ref_To_Local'>n</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN265"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>&GT; </span><span class='Number'>255</span><span class='Parentheses'>) 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN338"><span class='Ref_to_Label'>enoent</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} </span><span class='Control'>while</span> <span class='Parentheses'>((</span><a href="inet_net_pton.c.html#LN264"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>= *</span><a href="inet_net_pton.c.html#LN259"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> <span class='Operator'>!= </span><span class='String'>'\0'</span> <span class='Operator'>&& </span>isdigit<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="inet_net_pton.c.html#LN264"><span class='Ref_To_Local'>ch</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN267"><span class='Ref_To_Local'>size</span></a><span class='Operator'>-- == </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN342"><span class='Ref_to_Label'>emsgsize</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="inet_net_pton.c.html#LN259"><span class='Ref_to_Parameter'>dst</span></a><span class='Operator'>++ = </span><span class='Parentheses'>(</span>u_char<span class='Parentheses'>) </span><a href="inet_net_pton.c.html#LN265"><span class='Ref_To_Local'>tmp</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN264"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>== </span><span class='String'>'\0'</span> <span class='Operator'>|| </span><a href="inet_net_pton.c.html#LN264"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>== </span><span class='String'>'/'</span><span class='Parentheses'>) 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN264"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>!= </span><span class='String'>'.'</span><span class='Parentheses'>) 
</span>            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN338"><span class='Ref_to_Label'>enoent</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while ch=*src++,isdigit((un... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Get the prefix length if any. */ 
</span>    <a href="inet_net_pton.c.html#LN266"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN264"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>== </span><span class='String'>'/'</span> <span class='Operator'>&& </span>isdigit<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="inet_net_pton.c.html#LN259"><span class='Ref_to_Parameter'>src</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span> <span class='Operator'>&& </span><a href="inet_net_pton.c.html#LN259"><span class='Ref_to_Parameter'>dst</span></a> <span class='Operator'>&GT; </span><a href="inet_net_pton.c.html#LN262"><span class='Ref_To_Local'>odst</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* CIDR width specifier.  Nothing can follow it. */ 
</span>        <a href="inet_net_pton.c.html#LN264"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>= *</span><a href="inet_net_pton.c.html#LN259"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>            <span class='Comment_Single_Line'>/* Skip over the /. */ 
</span>        <a href="inet_net_pton.c.html#LN266"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Control'>do</span> 
        <span class='Delimiter'>{ 
</span>            <a href="inet_net_pton.c.html#LN263"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN261"><span class='Ref_To_Local'>digits</span></a><span class='Delimiter'>, </span><a href="inet_net_pton.c.html#LN264"><span class='Ref_To_Local'>ch</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="inet_net_pton.c.html#LN261"><span class='Ref_To_Local'>digits</span></a><span class='Delimiter'>; 
</span>            <span class='Debug'>assert</span><span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN263"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="inet_net_pton.c.html#LN263"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>&LT;= </span><span class='Number'>9</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="inet_net_pton.c.html#LN266"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>*= </span><span class='Number'>10</span><span class='Delimiter'>; 
</span>            <a href="inet_net_pton.c.html#LN266"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>+= </span><a href="inet_net_pton.c.html#LN263"><span class='Ref_To_Local'>n</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} </span><span class='Control'>while</span> <span class='Parentheses'>((</span><a href="inet_net_pton.c.html#LN264"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>= *</span><a href="inet_net_pton.c.html#LN259"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> <span class='Operator'>!= </span><span class='String'>'\0'</span> <span class='Operator'>&& </span>isdigit<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="inet_net_pton.c.html#LN264"><span class='Ref_To_Local'>ch</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN264"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN338"><span class='Ref_to_Label'>enoent</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN266"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>&GT; </span><span class='Number'>32</span><span class='Parentheses'>) 
</span>            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN342"><span class='Ref_to_Label'>emsgsize</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Firey death and destruction unless we prefetched EOS. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN264"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN338"><span class='Ref_to_Label'>enoent</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Prefix length can default to /32 only if all four octets spec'd. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN266"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>== -</span><span class='Number'>1</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN259"><span class='Ref_to_Parameter'>dst</span></a> <span class='Operator'>- </span><a href="inet_net_pton.c.html#LN262"><span class='Ref_To_Local'>odst</span></a> <span class='Operator'>== </span><span class='Number'>4</span><span class='Parentheses'>) 
</span>            <a href="inet_net_pton.c.html#LN266"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>= </span><span class='Number'>32</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN338"><span class='Ref_to_Label'>enoent</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* If nothing was written to the destination, we found no address. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN259"><span class='Ref_to_Parameter'>dst</span></a> <span class='Operator'>== </span><a href="inet_net_pton.c.html#LN262"><span class='Ref_To_Local'>odst</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN338"><span class='Ref_to_Label'>enoent</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* If prefix length overspecifies mantissa, life is bad. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="inet_net_pton.c.html#LN266"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>/ </span><span class='Number'>8</span><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN259"><span class='Ref_to_Parameter'>dst</span></a> <span class='Operator'>- </span><a href="inet_net_pton.c.html#LN262"><span class='Ref_To_Local'>odst</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN338"><span class='Ref_to_Label'>enoent</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Extend address to four octets. */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN267"><span class='Ref_To_Local'>size</span></a><span class='Operator'>-- &GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="inet_net_pton.c.html#LN259"><span class='Ref_to_Parameter'>dst</span></a><span class='Operator'>++ = </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="inet_net_pton.c.html#LN266"><span class='Ref_To_Local'>bits</span></a><span class='Delimiter'>; 
</span> 
<a name="LN338"></a><span class='Label'>enoent</span><span class='Operator'>: 
</span>    errno <span class='Operator'>= </span>ENOENT<span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<a name="LN342"></a><span class='Label'>emsgsize</span><span class='Operator'>: 
</span>    errno <span class='Operator'>= </span><a href="../../../include/port/win32.h.html#LN286"><span class='Ref_to_Const'>EMSGSIZE</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end inet_net_pton_ipv4 &raquo; </span> 
 
<span class='Keyword'>static int 
</span><a name="LN348"></a><span class='Declare_Function'>getbits</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>src</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>bitsp</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN350"></a>    <span class='Keyword'>static const char </span><span class='Declare_Local'>digits</span><span class='Delimiter'>[] </span><span class='Operator'>= </span><span class='String'>"0123456789"</span><span class='Delimiter'>; 
</span><a name="LN351"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>n</span><span class='Delimiter'>; 
</span><a name="LN352"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>val</span><span class='Delimiter'>; 
</span><a name="LN353"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>ch</span><span class='Delimiter'>; 
</span> 
    <a href="inet_net_pton.c.html#LN352"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="inet_net_pton.c.html#LN351"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>((</span><a href="inet_net_pton.c.html#LN353"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>= *</span><a href="inet_net_pton.c.html#LN348"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>++</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span><a name="LN359"></a>        <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>pch</span><span class='Delimiter'>; 
</span> 
        <a href="inet_net_pton.c.html#LN359"><span class='Ref_To_Local'>pch</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN350"><span class='Ref_To_Local'>digits</span></a><span class='Delimiter'>, </span><a href="inet_net_pton.c.html#LN353"><span class='Ref_To_Local'>ch</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN359"><span class='Ref_To_Local'>pch</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN351"><span class='Ref_To_Local'>n</span></a><span class='Operator'>++ != </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="inet_net_pton.c.html#LN352"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span>   <span class='Comment_Single_Line'>/* no leading zeros */ 
</span>                <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="inet_net_pton.c.html#LN352"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>*= </span><span class='Number'>10</span><span class='Delimiter'>; 
</span>            <a href="inet_net_pton.c.html#LN352"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>+= </span><span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN359"><span class='Ref_To_Local'>pch</span></a> <span class='Operator'>- </span><a href="inet_net_pton.c.html#LN350"><span class='Ref_To_Local'>digits</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN352"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>&GT; </span><span class='Number'>128</span><span class='Parentheses'>)</span>      <span class='Comment_Single_Line'>/* range */ 
</span>                <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN351"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="inet_net_pton.c.html#LN348"><span class='Ref_to_Parameter'>bitsp</span></a> <span class='Operator'>= </span><a href="inet_net_pton.c.html#LN352"><span class='Ref_To_Local'>val</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end getbits &raquo; </span> 
 
<span class='Keyword'>static int 
</span><a name="LN381"></a><span class='Declare_Function'>getv4</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>src</span><span class='Delimiter'>, </span>u_char <span class='Operator'>*</span><span class='Declare_Parameter'>dst</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>bitsp</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN383"></a>    <span class='Keyword'>static const char </span><span class='Declare_Local'>digits</span><span class='Delimiter'>[] </span><span class='Operator'>= </span><span class='String'>"0123456789"</span><span class='Delimiter'>; 
</span><a name="LN384"></a>    u_char     <span class='Operator'>*</span><span class='Declare_Local'>odst</span> <span class='Operator'>= </span><a href="inet_net_pton.c.html#LN381"><span class='Ref_to_Parameter'>dst</span></a><span class='Delimiter'>; 
</span><a name="LN385"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>n</span><span class='Delimiter'>; 
</span><a name="LN386"></a>    u_int       <span class='Declare_Local'>val</span><span class='Delimiter'>; 
</span><a name="LN387"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>ch</span><span class='Delimiter'>; 
</span> 
    <a href="inet_net_pton.c.html#LN386"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="inet_net_pton.c.html#LN385"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>((</span><a href="inet_net_pton.c.html#LN387"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>= *</span><a href="inet_net_pton.c.html#LN381"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>++</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span><a name="LN393"></a>        <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>pch</span><span class='Delimiter'>; 
</span> 
        <a href="inet_net_pton.c.html#LN393"><span class='Ref_To_Local'>pch</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN383"><span class='Ref_To_Local'>digits</span></a><span class='Delimiter'>, </span><a href="inet_net_pton.c.html#LN387"><span class='Ref_To_Local'>ch</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN393"><span class='Ref_To_Local'>pch</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN385"><span class='Ref_To_Local'>n</span></a><span class='Operator'>++ != </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="inet_net_pton.c.html#LN386"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span>   <span class='Comment_Single_Line'>/* no leading zeros */ 
</span>                <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="inet_net_pton.c.html#LN386"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>*= </span><span class='Number'>10</span><span class='Delimiter'>; 
</span>            <a href="inet_net_pton.c.html#LN386"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>+= </span><span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN393"><span class='Ref_To_Local'>pch</span></a> <span class='Operator'>- </span><a href="inet_net_pton.c.html#LN383"><span class='Ref_To_Local'>digits</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN386"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>&GT; </span><span class='Number'>255</span><span class='Parentheses'>)</span>      <span class='Comment_Single_Line'>/* range */ 
</span>                <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN387"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>== </span><span class='String'>'.'</span> <span class='Operator'>|| </span><a href="inet_net_pton.c.html#LN387"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>== </span><span class='String'>'/'</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN381"><span class='Ref_to_Parameter'>dst</span></a> <span class='Operator'>- </span><a href="inet_net_pton.c.html#LN384"><span class='Ref_To_Local'>odst</span></a> <span class='Operator'>&GT; </span><span class='Number'>3</span><span class='Parentheses'>) </span><span class='Comment_Single_Line'>/* too many octets? */ 
</span>                <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="inet_net_pton.c.html#LN381"><span class='Ref_to_Parameter'>dst</span></a><span class='Operator'>++ = </span><a href="inet_net_pton.c.html#LN386"><span class='Ref_To_Local'>val</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN387"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>== </span><span class='String'>'/'</span><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN347"><span class='Ref_to_Func'>getbits</span></a><span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN381"><span class='Ref_to_Parameter'>src</span></a><span class='Delimiter'>, </span><a href="inet_net_pton.c.html#LN381"><span class='Ref_to_Parameter'>bitsp</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="inet_net_pton.c.html#LN386"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <a href="inet_net_pton.c.html#LN385"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while (ch=*src++)!='\0' &raquo; </span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN385"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN381"><span class='Ref_to_Parameter'>dst</span></a> <span class='Operator'>- </span><a href="inet_net_pton.c.html#LN384"><span class='Ref_To_Local'>odst</span></a> <span class='Operator'>&GT; </span><span class='Number'>3</span><span class='Parentheses'>)</span>         <span class='Comment_Single_Line'>/* too many octets? */ 
</span>        <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="inet_net_pton.c.html#LN381"><span class='Ref_to_Parameter'>dst</span></a><span class='Operator'>++ = </span><a href="inet_net_pton.c.html#LN386"><span class='Ref_To_Local'>val</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end getv4 &raquo; </span> 
 
<span class='Keyword'>static int 
</span><a name="LN428"></a><span class='Declare_Function'>inet_net_pton_ipv6</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>src</span><span class='Delimiter'>, </span>u_char <span class='Operator'>*</span><span class='Declare_Parameter'>dst</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="inet_net_pton.c.html#LN39"><span class='Ref_to_Proto'>inet_cidr_pton_ipv6</span></a><span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN428"><span class='Ref_to_Parameter'>src</span></a><span class='Delimiter'>, </span><a href="inet_net_pton.c.html#LN428"><span class='Ref_to_Parameter'>dst</span></a><span class='Delimiter'>, </span><span class='Number'>16</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a name="LN433"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>NS_IN6ADDRSZ</span> <span class='Number'>16</span> 
<a name="LN434"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>NS_INT16SZ</span> <span class='Number'>2</span> 
<a name="LN435"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>NS_INADDRSZ</span> <span class='Number'>4</span> 
 
<span class='Keyword'>static int 
</span><a name="LN438"></a><span class='Declare_Function'>inet_cidr_pton_ipv6</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>src</span><span class='Delimiter'>, </span>u_char <span class='Operator'>*</span><span class='Declare_Parameter'>dst</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>size</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN440"></a>    <span class='Keyword'>static const char </span><span class='Declare_Local'>xdigits_l</span><span class='Delimiter'>[] </span><span class='Operator'>= </span><span class='String'>"0123456789abcdef"</span><span class='Delimiter'>, 
</span><a name="LN441"></a>                <span class='Declare_Local'>xdigits_u</span><span class='Delimiter'>[] </span><span class='Operator'>= </span><span class='String'>"0123456789ABCDEF"</span><span class='Delimiter'>; 
</span><a name="LN442"></a>    u_char      <span class='Declare_Local'>tmp</span><span class='Delimiter'>[</span><a href="../../../port/inet_net_ntop.c.html#LN46"><span class='Ref_to_Const'>NS_IN6ADDRSZ</span></a><span class='Delimiter'>], 
</span><a name="LN443"></a>               <span class='Operator'>*</span><span class='Declare_Local'>tp</span><span class='Delimiter'>, 
</span><a name="LN444"></a>               <span class='Operator'>*</span><span class='Declare_Local'>endp</span><span class='Delimiter'>, 
</span><a name="LN445"></a>               <span class='Operator'>*</span><span class='Declare_Local'>colonp</span><span class='Delimiter'>; 
</span><a name="LN446"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>xdigits</span><span class='Delimiter'>, 
</span><a name="LN447"></a>               <span class='Operator'>*</span><span class='Declare_Local'>curtok</span><span class='Delimiter'>; 
</span><a name="LN448"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>ch</span><span class='Delimiter'>, 
</span><a name="LN449"></a>                <span class='Declare_Local'>saw_xdigit</span><span class='Delimiter'>; 
</span><a name="LN450"></a>    u_int       <span class='Declare_Local'>val</span><span class='Delimiter'>; 
</span><a name="LN451"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>digits</span><span class='Delimiter'>; 
</span><a name="LN452"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>bits</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN438"><span class='Ref_to_Parameter'>size</span></a> <span class='Operator'>&LT; </span><a href="../../../port/inet_net_ntop.c.html#LN46"><span class='Ref_to_Const'>NS_IN6ADDRSZ</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN560"><span class='Ref_to_Label'>emsgsize</span></a><span class='Delimiter'>; 
</span> 
    memset<span class='Parentheses'>((</span><a href="inet_net_pton.c.html#LN443"><span class='Ref_To_Local'>tp</span></a> <span class='Operator'>= </span><a href="inet_net_pton.c.html#LN442"><span class='Ref_To_Local'>tmp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='String'>'\0'</span><span class='Delimiter'>, </span><a href="../../../port/inet_net_ntop.c.html#LN46"><span class='Ref_to_Const'>NS_IN6ADDRSZ</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="inet_net_pton.c.html#LN444"><span class='Ref_To_Local'>endp</span></a> <span class='Operator'>= </span><a href="inet_net_pton.c.html#LN443"><span class='Ref_To_Local'>tp</span></a> <span class='Operator'>+ </span><a href="../../../port/inet_net_ntop.c.html#LN46"><span class='Ref_to_Const'>NS_IN6ADDRSZ</span></a><span class='Delimiter'>; 
</span>    <a href="inet_net_pton.c.html#LN445"><span class='Ref_To_Local'>colonp</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* Leading :: requires some special handling. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="inet_net_pton.c.html#LN438"><span class='Ref_to_Parameter'>src</span></a> <span class='Operator'>== </span><span class='String'>':'</span><span class='Parentheses'>) 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*++</span><a href="inet_net_pton.c.html#LN438"><span class='Ref_to_Parameter'>src</span></a> <span class='Operator'>!= </span><span class='String'>':'</span><span class='Parentheses'>) 
</span>            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN556"><span class='Ref_to_Label'>enoent</span></a><span class='Delimiter'>; 
</span>    <a href="inet_net_pton.c.html#LN447"><span class='Ref_To_Local'>curtok</span></a> <span class='Operator'>= </span><a href="inet_net_pton.c.html#LN438"><span class='Ref_to_Parameter'>src</span></a><span class='Delimiter'>; 
</span>    <a href="inet_net_pton.c.html#LN449"><span class='Ref_To_Local'>saw_xdigit</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="inet_net_pton.c.html#LN450"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="inet_net_pton.c.html#LN451"><span class='Ref_To_Local'>digits</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="inet_net_pton.c.html#LN452"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>((</span><a href="inet_net_pton.c.html#LN448"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>= *</span><a href="inet_net_pton.c.html#LN438"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>++</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span><a name="LN471"></a>        <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>pch</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="inet_net_pton.c.html#LN471"><span class='Ref_To_Local'>pch</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>((</span><a href="inet_net_pton.c.html#LN446"><span class='Ref_To_Local'>xdigits</span></a> <span class='Operator'>= </span><a href="inet_net_pton.c.html#LN440"><span class='Ref_To_Local'>xdigits_l</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="inet_net_pton.c.html#LN448"><span class='Ref_To_Local'>ch</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
            <a href="inet_net_pton.c.html#LN471"><span class='Ref_To_Local'>pch</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>((</span><a href="inet_net_pton.c.html#LN446"><span class='Ref_To_Local'>xdigits</span></a> <span class='Operator'>= </span><a href="inet_net_pton.c.html#LN441"><span class='Ref_To_Local'>xdigits_u</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="inet_net_pton.c.html#LN448"><span class='Ref_To_Local'>ch</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN471"><span class='Ref_To_Local'>pch</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="inet_net_pton.c.html#LN450"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>&LT;&LT;= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>            <a href="inet_net_pton.c.html#LN450"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>|= </span><span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN471"><span class='Ref_To_Local'>pch</span></a> <span class='Operator'>- </span><a href="inet_net_pton.c.html#LN446"><span class='Ref_To_Local'>xdigits</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>++</span><a href="inet_net_pton.c.html#LN451"><span class='Ref_To_Local'>digits</span></a> <span class='Operator'>&GT; </span><span class='Number'>4</span><span class='Parentheses'>) 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN556"><span class='Ref_to_Label'>enoent</span></a><span class='Delimiter'>; 
</span>            <a href="inet_net_pton.c.html#LN449"><span class='Ref_To_Local'>saw_xdigit</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN448"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>== </span><span class='String'>':'</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="inet_net_pton.c.html#LN447"><span class='Ref_To_Local'>curtok</span></a> <span class='Operator'>= </span><a href="inet_net_pton.c.html#LN438"><span class='Ref_to_Parameter'>src</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="inet_net_pton.c.html#LN449"><span class='Ref_To_Local'>saw_xdigit</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN445"><span class='Ref_To_Local'>colonp</span></a><span class='Parentheses'>) 
</span>                    <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN556"><span class='Ref_to_Label'>enoent</span></a><span class='Delimiter'>; 
</span>                <a href="inet_net_pton.c.html#LN445"><span class='Ref_To_Local'>colonp</span></a> <span class='Operator'>= </span><a href="inet_net_pton.c.html#LN443"><span class='Ref_To_Local'>tp</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>continue</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="inet_net_pton.c.html#LN438"><span class='Ref_to_Parameter'>src</span></a> <span class='Operator'>== </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN556"><span class='Ref_to_Label'>enoent</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN443"><span class='Ref_To_Local'>tp</span></a> <span class='Operator'>+ </span><a href="../../../port/inet_net_ntop.c.html#LN47"><span class='Ref_to_Const'>NS_INT16SZ</span></a> <span class='Operator'>&GT; </span><a href="inet_net_pton.c.html#LN444"><span class='Ref_To_Local'>endp</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN556"><span class='Ref_to_Label'>enoent</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="inet_net_pton.c.html#LN443"><span class='Ref_To_Local'>tp</span></a><span class='Operator'>++ = </span><span class='Parentheses'>(</span>u_char<span class='Parentheses'>) (</span><a href="inet_net_pton.c.html#LN450"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>&GT;&GT; </span><span class='Number'>8</span><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Number'>0xff</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="inet_net_pton.c.html#LN443"><span class='Ref_To_Local'>tp</span></a><span class='Operator'>++ = </span><span class='Parentheses'>(</span>u_char<span class='Parentheses'>) </span><a href="inet_net_pton.c.html#LN450"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>& </span><span class='Number'>0xff</span><span class='Delimiter'>; 
</span>            <a href="inet_net_pton.c.html#LN449"><span class='Ref_To_Local'>saw_xdigit</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <a href="inet_net_pton.c.html#LN451"><span class='Ref_To_Local'>digits</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <a href="inet_net_pton.c.html#LN450"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if ch==':' &raquo; </span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN448"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>== </span><span class='String'>'.'</span> <span class='Operator'>&& </span><span class='Parentheses'>((</span><a href="inet_net_pton.c.html#LN443"><span class='Ref_To_Local'>tp</span></a> <span class='Operator'>+ </span><a href="inet_net_pton.c.html#LN435"><span class='Ref_to_Const'>NS_INADDRSZ</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><a href="inet_net_pton.c.html#LN444"><span class='Ref_To_Local'>endp</span></a><span class='Parentheses'>)</span> <span class='Operator'>&& 
</span>            <a href="inet_net_pton.c.html#LN380"><span class='Ref_to_Func'>getv4</span></a><span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN447"><span class='Ref_To_Local'>curtok</span></a><span class='Delimiter'>, </span><a href="inet_net_pton.c.html#LN443"><span class='Ref_To_Local'>tp</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="inet_net_pton.c.html#LN452"><span class='Ref_To_Local'>bits</span></a><span class='Parentheses'>)</span> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="inet_net_pton.c.html#LN443"><span class='Ref_To_Local'>tp</span></a> <span class='Operator'>+= </span><a href="inet_net_pton.c.html#LN435"><span class='Ref_to_Const'>NS_INADDRSZ</span></a><span class='Delimiter'>; 
</span>            <a href="inet_net_pton.c.html#LN449"><span class='Ref_To_Local'>saw_xdigit</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>;</span>              <span class='Comment_Single_Line'>/* '\0' was seen by inet_pton4(). */ 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN448"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>== </span><span class='String'>'/'</span> <span class='Operator'>&& </span><a href="inet_net_pton.c.html#LN347"><span class='Ref_to_Func'>getbits</span></a><span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN438"><span class='Ref_to_Parameter'>src</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="inet_net_pton.c.html#LN452"><span class='Ref_To_Local'>bits</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN556"><span class='Ref_to_Label'>enoent</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while (ch=*src++)!='\0' &raquo; </span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN449"><span class='Ref_To_Local'>saw_xdigit</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN443"><span class='Ref_To_Local'>tp</span></a> <span class='Operator'>+ </span><a href="../../../port/inet_net_ntop.c.html#LN47"><span class='Ref_to_Const'>NS_INT16SZ</span></a> <span class='Operator'>&GT; </span><a href="inet_net_pton.c.html#LN444"><span class='Ref_To_Local'>endp</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN556"><span class='Ref_to_Label'>enoent</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="inet_net_pton.c.html#LN443"><span class='Ref_To_Local'>tp</span></a><span class='Operator'>++ = </span><span class='Parentheses'>(</span>u_char<span class='Parentheses'>) (</span><a href="inet_net_pton.c.html#LN450"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>&GT;&GT; </span><span class='Number'>8</span><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Number'>0xff</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="inet_net_pton.c.html#LN443"><span class='Ref_To_Local'>tp</span></a><span class='Operator'>++ = </span><span class='Parentheses'>(</span>u_char<span class='Parentheses'>) </span><a href="inet_net_pton.c.html#LN450"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>& </span><span class='Number'>0xff</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN452"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>== -</span><span class='Number'>1</span><span class='Parentheses'>) 
</span>        <a href="inet_net_pton.c.html#LN452"><span class='Ref_To_Local'>bits</span></a> <span class='Operator'>= </span><span class='Number'>128</span><span class='Delimiter'>; 
</span> 
    <a href="inet_net_pton.c.html#LN444"><span class='Ref_To_Local'>endp</span></a> <span class='Operator'>= </span><a href="inet_net_pton.c.html#LN442"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>+ </span><span class='Number'>16</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN445"><span class='Ref_To_Local'>colonp</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Since some memmove()'s erroneously fail to handle overlapping 
         * regions, we'll do the shift by hand. 
         */ 
</span><a name="LN534"></a>        <span class='Keyword'>const int</span>   <span class='Declare_Local'>n</span> <span class='Operator'>= </span><a href="inet_net_pton.c.html#LN443"><span class='Ref_To_Local'>tp</span></a> <span class='Operator'>- </span><a href="inet_net_pton.c.html#LN445"><span class='Ref_To_Local'>colonp</span></a><span class='Delimiter'>; 
</span><a name="LN535"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN443"><span class='Ref_To_Local'>tp</span></a> <span class='Operator'>== </span><a href="inet_net_pton.c.html#LN444"><span class='Ref_To_Local'>endp</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN556"><span class='Ref_to_Label'>enoent</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN535"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; </span><a href="inet_net_pton.c.html#LN535"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT;= </span><a href="inet_net_pton.c.html#LN534"><span class='Ref_To_Local'>n</span></a><span class='Delimiter'>; </span><a href="inet_net_pton.c.html#LN535"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="inet_net_pton.c.html#LN444"><span class='Ref_To_Local'>endp</span></a><span class='Delimiter'>[</span><span class='Operator'>-</span><a href="inet_net_pton.c.html#LN535"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="inet_net_pton.c.html#LN445"><span class='Ref_To_Local'>colonp</span></a><span class='Delimiter'>[</span><a href="inet_net_pton.c.html#LN534"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>- </span><a href="inet_net_pton.c.html#LN535"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>            <a href="inet_net_pton.c.html#LN445"><span class='Ref_To_Local'>colonp</span></a><span class='Delimiter'>[</span><a href="inet_net_pton.c.html#LN534"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>- </span><a href="inet_net_pton.c.html#LN535"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="inet_net_pton.c.html#LN443"><span class='Ref_To_Local'>tp</span></a> <span class='Operator'>= </span><a href="inet_net_pton.c.html#LN444"><span class='Ref_To_Local'>endp</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN443"><span class='Ref_To_Local'>tp</span></a> <span class='Operator'>!= </span><a href="inet_net_pton.c.html#LN444"><span class='Ref_To_Local'>endp</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="inet_net_pton.c.html#LN556"><span class='Ref_to_Label'>enoent</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Copy out the result. 
     */ 
</span>    memcpy<span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN438"><span class='Ref_to_Parameter'>dst</span></a><span class='Delimiter'>, </span><a href="inet_net_pton.c.html#LN442"><span class='Ref_To_Local'>tmp</span></a><span class='Delimiter'>, </span><a href="../../../port/inet_net_ntop.c.html#LN46"><span class='Ref_to_Const'>NS_IN6ADDRSZ</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="inet_net_pton.c.html#LN452"><span class='Ref_To_Local'>bits</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<a name="LN556"></a><span class='Label'>enoent</span><span class='Operator'>: 
</span>    errno <span class='Operator'>= </span>ENOENT<span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<a name="LN560"></a><span class='Label'>emsgsize</span><span class='Operator'>: 
</span>    errno <span class='Operator'>= </span><a href="../../../include/port/win32.h.html#LN286"><span class='Ref_to_Const'>EMSGSIZE</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end inet_cidr_pton_ipv6 &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>