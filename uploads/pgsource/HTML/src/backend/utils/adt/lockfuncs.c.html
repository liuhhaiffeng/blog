<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\backend\utils\adt\lockfuncs.c</title>
<LINK REL=StyleSheet HREF="../../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\backend\utils\adt\lockfuncs.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:52 2017
</td></tr>
<tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * lockfuncs.c 
 *      Functions for SQL access to various lock-manager capabilities. 
 * 
 * Copyright (c) 2002-2017, PostgreSQL Global Development Group 
 * 
 * IDENTIFICATION 
 *      src/backend/utils/adt/lockfuncs.c 
 * 
 *------------------------------------------------------------------------- 
 */ 
</span><span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>"access/htup_details.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"access/xact.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_type.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"funcapi.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"miscadmin.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"storage/predicate_internals.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/array.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/builtins.h"</span> 
 
 
<span class='Comment_Multi_Line'>/* This must match enum LockTagType! */ 
</span><a name="LN25"></a><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Keyword'>const </span><span class='Declare_Var'>LockTagTypeNames</span><span class='Delimiter'>[] </span><span class='Operator'>= </span><span class='Delimiter'>{ 
</span>    <span class='String'>"relation"</span><span class='Delimiter'>, 
</span>    <span class='String'>"extend"</span><span class='Delimiter'>, 
</span>    <span class='String'>"page"</span><span class='Delimiter'>, 
</span>    <span class='String'>"tuple"</span><span class='Delimiter'>, 
</span>    <span class='String'>"transactionid"</span><span class='Delimiter'>, 
</span>    <span class='String'>"virtualxid"</span><span class='Delimiter'>, 
</span>    <span class='String'>"speculative token"</span><span class='Delimiter'>, 
</span>    <span class='String'>"object"</span><span class='Delimiter'>, 
</span>    <span class='String'>"userlock"</span><span class='Delimiter'>, 
</span>    <span class='String'>"advisory"</span> 
<span class='Delimiter'>}; 
</span> 
<span class='Comment_Multi_Line'>/* This must match enum PredicateLockTargetType (predicate_internals.h) */ 
</span><a name="LN39"></a><span class='Keyword'>static const char </span><span class='Operator'>*</span><span class='Keyword'>const </span><span class='Declare_Var'>PredicateLockTagTypeNames</span><span class='Delimiter'>[] </span><span class='Operator'>= </span><span class='Delimiter'>{ 
</span>    <span class='String'>"relation"</span><span class='Delimiter'>, 
</span>    <span class='String'>"page"</span><span class='Delimiter'>, 
</span>    <span class='String'>"tuple"</span> 
<span class='Delimiter'>}; 
</span> 
<span class='Comment_Multi_Line'>/* Working status for pg_lock_status */ 
</span><span class='Control'>typedef</span> <span class='Control'>struct</span> 
<span class='Delimiter'>{ 
</span><a name="LN48"></a>    <a href="../../../include/storage/lock.h.html#LN437"><span class='Ref_to_Struct'>LockData</span></a>   <span class='Operator'>*</span><span class='Declare_Member'>lockData</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* state data from lmgr */ 
</span><a name="LN49"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>currIdx</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* current PROCLOCK index */ 
</span><a name="LN50"></a>    <a href="../../../include/storage/predicate_internals.h.html#LN376"><span class='Ref_to_Struct'>PredicateLockData</span></a> <span class='Operator'>*</span><span class='Declare_Member'>predLockData</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* state data for pred locks */ 
</span><a name="LN51"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>predLockIdx</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* current index for pred lock */ 
</span><a name="LN52"></a><span class='Delimiter'>} </span><span class='Declare_Typedef'>PG_Lock_Status</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Number of columns in pg_locks output */ 
</span><a name="LN55"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>NUM_LOCK_STATUS_COLUMNS</span>     <span class='Number'>15</span> 
 
<span class='Comment_Multi_Line'>/* 
 * VXIDGetDatum - Construct a text representation of a VXID 
 * 
 * This is currently only used in pg_lock_status, so we put it here. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN63"></a><span class='Declare_Function'>VXIDGetDatum</span><span class='Parentheses'>(</span><a href="../../../include/storage/backendid.h.html#LN20"><span class='Ref_to_Typedef'>BackendId</span></a> <span class='Declare_Parameter'>bid</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN398"><span class='Ref_to_Typedef'>LocalTransactionId</span></a> <span class='Declare_Parameter'>lxid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* 
     * The representation is "&LT;bid&GT;/&LT;lxid&GT;", decimal and unsigned decimal 
     * respectively.  Note that elog.c also knows how to format a vxid. 
     */ 
</span><a name="LN69"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>vxidstr</span><span class='Delimiter'>[</span><span class='Number'>32</span><span class='Delimiter'>]; 
</span> 
    <a href="../../../pl/plperl/plperl.h.html#LN60"><span class='Ref_to_Macro'>snprintf</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN69"><span class='Ref_To_Local'>vxidstr</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN69"><span class='Ref_To_Local'>vxidstr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='String'>"%d/%u"</span><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN63"><span class='Ref_to_Parameter'>bid</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN63"><span class='Ref_to_Parameter'>lxid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="../../../include/utils/builtins.h.html#LN90"><span class='Ref_to_Macro'>CStringGetTextDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN69"><span class='Ref_To_Local'>vxidstr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * pg_lock_status - produce a view with one row per held or awaited lock mode 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN81"></a><span class='Declare_Function'>pg_lock_status</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN83"></a>    <a href="../../../include/funcapi.h.html#LN56"><span class='Ref_to_Struct'>FuncCallContext</span></a> <span class='Operator'>*</span><span class='Declare_Local'>funcctx</span><span class='Delimiter'>; 
</span><a name="LN84"></a>    <a href="lockfuncs.c.html#LN46"><span class='Ref_to_Typedef'>PG_Lock_Status</span></a> <span class='Operator'>*</span><span class='Declare_Local'>mystatus</span><span class='Delimiter'>; 
</span><a name="LN85"></a>    <a href="../../../include/storage/lock.h.html#LN437"><span class='Ref_to_Struct'>LockData</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lockData</span><span class='Delimiter'>; 
</span><a name="LN86"></a>    <a href="../../../include/storage/predicate_internals.h.html#LN376"><span class='Ref_to_Struct'>PredicateLockData</span></a> <span class='Operator'>*</span><span class='Declare_Local'>predLockData</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/funcapi.h.html#LN284"><span class='Ref_to_Macro'>SRF_IS_FIRSTCALL</span></a><span class='Parentheses'>())</span> 
    <span class='Delimiter'>{ 
</span><a name="LN90"></a>        <a href="../../../include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a>   <span class='Declare_Local'>tupdesc</span><span class='Delimiter'>; 
</span><a name="LN91"></a>        <a href="../../../include/utils/palloc.h.html#LN35"><span class='Ref_to_Typedef'>MemoryContext</span></a> <span class='Declare_Local'>oldcontext</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* create a function context for cross-call persistence */ 
</span>        <a href="lockfuncs.c.html#LN83"><span class='Ref_To_Local'>funcctx</span></a> <span class='Operator'>= </span><a href="../../../include/funcapi.h.html#LN286"><span class='Ref_to_Macro'>SRF_FIRSTCALL_INIT</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * switch to memory context appropriate for multiple function calls 
         */ 
</span>        <a href="lockfuncs.c.html#LN91"><span class='Ref_To_Local'>oldcontext</span></a> <span class='Operator'>= </span><a href="../../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN83"><span class='Ref_To_Local'>funcctx</span></a><span class='Operator'>-&GT;</span><a href="../../../include/funcapi.h.html#LN108"><span class='Ref_to_Member'>multi_call_memory_ctx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* build tupdesc for result tuples */ 
</span>        <span class='Comment_Multi_Line'>/* this had better match function's declaration in pg_proc.h */ 
</span>        <a href="lockfuncs.c.html#LN90"><span class='Ref_To_Local'>tupdesc</span></a> <span class='Operator'>= </span><a href="../../access/common/tupdesc.c.html#LN39"><span class='Ref_to_Func'>CreateTemplateTupleDesc</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN55"><span class='Ref_to_Const'>NUM_LOCK_STATUS_COLUMNS</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/access/tupdesc.h.html#LN114"><span class='Ref_to_Proto'>TupleDescInitEntry</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN90"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='String'>"locktype"</span><span class='Delimiter'>, 
</span>                           <a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN26"><span class='Ref_to_Const'>TEXTOID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/access/tupdesc.h.html#LN114"><span class='Ref_to_Proto'>TupleDescInitEntry</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN90"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='String'>"database"</span><span class='Delimiter'>, 
</span>                           <a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN27"><span class='Ref_to_Const'>OIDOID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/access/tupdesc.h.html#LN114"><span class='Ref_to_Proto'>TupleDescInitEntry</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN90"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='String'>"relation"</span><span class='Delimiter'>, 
</span>                           <a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN27"><span class='Ref_to_Const'>OIDOID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/access/tupdesc.h.html#LN114"><span class='Ref_to_Proto'>TupleDescInitEntry</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN90"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='String'>"page"</span><span class='Delimiter'>, 
</span>                           <a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN24"><span class='Ref_to_Const'>INT4OID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/access/tupdesc.h.html#LN114"><span class='Ref_to_Proto'>TupleDescInitEntry</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN90"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='String'>"tuple"</span><span class='Delimiter'>, 
</span>                           <a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN22"><span class='Ref_to_Const'>INT2OID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/access/tupdesc.h.html#LN114"><span class='Ref_to_Proto'>TupleDescInitEntry</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN90"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Number'>6</span><span class='Delimiter'>, </span><span class='String'>"virtualxid"</span><span class='Delimiter'>, 
</span>                           <a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN26"><span class='Ref_to_Const'>TEXTOID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/access/tupdesc.h.html#LN114"><span class='Ref_to_Proto'>TupleDescInitEntry</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN90"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Number'>7</span><span class='Delimiter'>, </span><span class='String'>"transactionid"</span><span class='Delimiter'>, 
</span>                           <a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN29"><span class='Ref_to_Const'>XIDOID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/access/tupdesc.h.html#LN114"><span class='Ref_to_Proto'>TupleDescInitEntry</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN90"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Number'>8</span><span class='Delimiter'>, </span><span class='String'>"classid"</span><span class='Delimiter'>, 
</span>                           <a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN27"><span class='Ref_to_Const'>OIDOID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/access/tupdesc.h.html#LN114"><span class='Ref_to_Proto'>TupleDescInitEntry</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN90"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Number'>9</span><span class='Delimiter'>, </span><span class='String'>"objid"</span><span class='Delimiter'>, 
</span>                           <a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN27"><span class='Ref_to_Const'>OIDOID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/access/tupdesc.h.html#LN114"><span class='Ref_to_Proto'>TupleDescInitEntry</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN90"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Number'>10</span><span class='Delimiter'>, </span><span class='String'>"objsubid"</span><span class='Delimiter'>, 
</span>                           <a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN22"><span class='Ref_to_Const'>INT2OID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/access/tupdesc.h.html#LN114"><span class='Ref_to_Proto'>TupleDescInitEntry</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN90"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Number'>11</span><span class='Delimiter'>, </span><span class='String'>"virtualtransaction"</span><span class='Delimiter'>, 
</span>                           <a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN26"><span class='Ref_to_Const'>TEXTOID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/access/tupdesc.h.html#LN114"><span class='Ref_to_Proto'>TupleDescInitEntry</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN90"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Number'>12</span><span class='Delimiter'>, </span><span class='String'>"pid"</span><span class='Delimiter'>, 
</span>                           <a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN24"><span class='Ref_to_Const'>INT4OID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/access/tupdesc.h.html#LN114"><span class='Ref_to_Proto'>TupleDescInitEntry</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN90"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Number'>13</span><span class='Delimiter'>, </span><span class='String'>"mode"</span><span class='Delimiter'>, 
</span>                           <a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN26"><span class='Ref_to_Const'>TEXTOID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/access/tupdesc.h.html#LN114"><span class='Ref_to_Proto'>TupleDescInitEntry</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN90"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Number'>14</span><span class='Delimiter'>, </span><span class='String'>"granted"</span><span class='Delimiter'>, 
</span>                           <a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN17"><span class='Ref_to_Const'>BOOLOID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/access/tupdesc.h.html#LN114"><span class='Ref_to_Proto'>TupleDescInitEntry</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN90"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Number'>15</span><span class='Delimiter'>, </span><span class='String'>"fastpath"</span><span class='Delimiter'>, 
</span>                           <a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN17"><span class='Ref_to_Const'>BOOLOID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="lockfuncs.c.html#LN83"><span class='Ref_To_Local'>funcctx</span></a><span class='Operator'>-&GT;</span><a href="../../../include/funcapi.h.html#LN119"><span class='Ref_to_Member'>tuple_desc</span></a> <span class='Operator'>= </span><a href="../../../include/funcapi.h.html#LN229"><span class='Ref_to_Proto'>BlessTupleDesc</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN90"><span class='Ref_To_Local'>tupdesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Collect all the locking information that we will format and send 
         * out as a result set. 
         */ 
</span>        <a href="lockfuncs.c.html#LN84"><span class='Ref_To_Local'>mystatus</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN46"><span class='Ref_to_Typedef'>PG_Lock_Status</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN46"><span class='Ref_to_Typedef'>PG_Lock_Status</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="lockfuncs.c.html#LN83"><span class='Ref_To_Local'>funcctx</span></a><span class='Operator'>-&GT;</span><a href="../../../include/funcapi.h.html#LN89"><span class='Ref_to_Member'>user_fctx</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="lockfuncs.c.html#LN84"><span class='Ref_To_Local'>mystatus</span></a><span class='Delimiter'>; 
</span> 
        <a href="lockfuncs.c.html#LN84"><span class='Ref_To_Local'>mystatus</span></a><span class='Operator'>-&GT;</span><a href="lockfuncs.c.html#LN48"><span class='Ref_to_Member'>lockData</span></a> <span class='Operator'>= </span><a href="../../../include/storage/lock.h.html#LN552"><span class='Ref_to_Proto'>GetLockStatusData</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <a href="lockfuncs.c.html#LN84"><span class='Ref_To_Local'>mystatus</span></a><span class='Operator'>-&GT;</span><a href="lockfuncs.c.html#LN49"><span class='Ref_to_Member'>currIdx</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="lockfuncs.c.html#LN84"><span class='Ref_To_Local'>mystatus</span></a><span class='Operator'>-&GT;</span><a href="lockfuncs.c.html#LN50"><span class='Ref_to_Member'>predLockData</span></a> <span class='Operator'>= </span><a href="../../../include/storage/predicate_internals.h.html#LN475"><span class='Ref_to_Proto'>GetPredicateLockStatusData</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <a href="lockfuncs.c.html#LN84"><span class='Ref_To_Local'>mystatus</span></a><span class='Operator'>-&GT;</span><a href="lockfuncs.c.html#LN51"><span class='Ref_to_Member'>predLockIdx</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
        <a href="../../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN91"><span class='Ref_To_Local'>oldcontext</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if SRF_IS_FIRSTCALL() &raquo; </span> 
 
    <a href="lockfuncs.c.html#LN83"><span class='Ref_To_Local'>funcctx</span></a> <span class='Operator'>= </span><a href="../../../include/funcapi.h.html#LN288"><span class='Ref_to_Macro'>SRF_PERCALL_SETUP</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN84"><span class='Ref_To_Local'>mystatus</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN46"><span class='Ref_to_Typedef'>PG_Lock_Status</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="lockfuncs.c.html#LN83"><span class='Ref_To_Local'>funcctx</span></a><span class='Operator'>-&GT;</span><a href="../../../include/funcapi.h.html#LN89"><span class='Ref_to_Member'>user_fctx</span></a><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN85"><span class='Ref_To_Local'>lockData</span></a> <span class='Operator'>= </span><a href="lockfuncs.c.html#LN84"><span class='Ref_To_Local'>mystatus</span></a><span class='Operator'>-&GT;</span><a href="lockfuncs.c.html#LN48"><span class='Ref_to_Member'>lockData</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN84"><span class='Ref_To_Local'>mystatus</span></a><span class='Operator'>-&GT;</span><a href="lockfuncs.c.html#LN49"><span class='Ref_to_Member'>currIdx</span></a> <span class='Operator'>&LT; </span><a href="lockfuncs.c.html#LN85"><span class='Ref_To_Local'>lockData</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN439"><span class='Ref_to_Member'>nelements</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN158"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>granted</span><span class='Delimiter'>; 
</span><a name="LN159"></a>        <a href="../../../include/storage/lockdefs.h.html#LN25"><span class='Ref_to_Typedef'>LOCKMODE</span></a>    <span class='Declare_Local'>mode</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN160"></a>        <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>locktypename</span><span class='Delimiter'>; 
</span><a name="LN161"></a>        <span class='Keyword'>char</span>        <span class='Declare_Local'>tnbuf</span><span class='Delimiter'>[</span><span class='Number'>32</span><span class='Delimiter'>]; 
</span><a name="LN162"></a>        <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>values</span><span class='Delimiter'>[</span><a href="lockfuncs.c.html#LN55"><span class='Ref_to_Const'>NUM_LOCK_STATUS_COLUMNS</span></a><span class='Delimiter'>]; 
</span><a name="LN163"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>nulls</span><span class='Delimiter'>[</span><a href="lockfuncs.c.html#LN55"><span class='Ref_to_Const'>NUM_LOCK_STATUS_COLUMNS</span></a><span class='Delimiter'>]; 
</span><a name="LN164"></a>        <a href="../../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tuple</span><span class='Delimiter'>; 
</span><a name="LN165"></a>        <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN166"></a>        <a href="../../../include/storage/lock.h.html#LN425"><span class='Ref_to_Struct'>LockInstanceData</span></a> <span class='Operator'>*</span><span class='Declare_Local'>instance</span><span class='Delimiter'>; 
</span> 
        <a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a> <span class='Operator'>= &</span><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN85"><span class='Ref_To_Local'>lockData</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN440"><span class='Ref_to_Member'>locks</span></a><span class='Delimiter'>[</span><a href="lockfuncs.c.html#LN84"><span class='Ref_To_Local'>mystatus</span></a><span class='Operator'>-&GT;</span><a href="lockfuncs.c.html#LN49"><span class='Ref_to_Member'>currIdx</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Look to see if there are any held lock modes in this PROCLOCK. If 
         * so, report, and destructively modify lockData so we don't report 
         * again. 
         */ 
</span>        <a href="lockfuncs.c.html#LN158"><span class='Ref_To_Local'>granted</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN428"><span class='Ref_to_Member'>holdMask</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN159"><span class='Ref_To_Local'>mode</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="lockfuncs.c.html#LN159"><span class='Ref_To_Local'>mode</span></a> <span class='Operator'>&LT; </span><a href="../../../include/storage/lock.h.html#LN85"><span class='Ref_to_Const'>MAX_LOCKMODES</span></a><span class='Delimiter'>; </span><a href="lockfuncs.c.html#LN159"><span class='Ref_To_Local'>mode</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN428"><span class='Ref_to_Member'>holdMask</span></a> <span class='Operator'>& </span><a href="../../../include/storage/lock.h.html#LN87"><span class='Ref_to_Macro'>LOCKBIT_ON</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN159"><span class='Ref_To_Local'>mode</span></a><span class='Parentheses'>))</span> 
                <span class='Delimiter'>{ 
</span>                    <a href="lockfuncs.c.html#LN158"><span class='Ref_To_Local'>granted</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                    <a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN428"><span class='Ref_to_Member'>holdMask</span></a> <span class='Operator'>&= </span><a href="../../../include/storage/lock.h.html#LN88"><span class='Ref_to_Macro'>LOCKBIT_OFF</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN159"><span class='Ref_To_Local'>mode</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If no (more) held modes to report, see if PROC is waiting for a 
         * lock on this lock. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="lockfuncs.c.html#LN158"><span class='Ref_To_Local'>granted</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN429"><span class='Ref_to_Member'>waitLockMode</span></a> <span class='Operator'>!= </span><a href="../../../include/storage/lockdefs.h.html#LN33"><span class='Ref_to_Const'>NoLock</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* Yes, so report it with proper mode */ 
</span>                <a href="lockfuncs.c.html#LN159"><span class='Ref_To_Local'>mode</span></a> <span class='Operator'>= </span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN429"><span class='Ref_to_Member'>waitLockMode</span></a><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* 
                 * We are now done with this PROCLOCK, so advance pointer to 
                 * continue with next one on next call. 
                 */ 
</span>                <a href="lockfuncs.c.html#LN84"><span class='Ref_To_Local'>mystatus</span></a><span class='Operator'>-&GT;</span><a href="lockfuncs.c.html#LN49"><span class='Ref_to_Member'>currIdx</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* 
                 * Okay, we've displayed all the locks associated with this 
                 * PROCLOCK, proceed to the next one. 
                 */ 
</span>                <a href="lockfuncs.c.html#LN84"><span class='Ref_To_Local'>mystatus</span></a><span class='Operator'>-&GT;</span><a href="lockfuncs.c.html#LN49"><span class='Ref_to_Member'>currIdx</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                <span class='Control'>continue</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if !granted &raquo; </span> 
 
        <span class='Comment_Multi_Line'>/* 
         * Form tuple with appropriate data. 
         */ 
</span>        <a href="../../../include/c.h.html#LN856"><span class='Ref_to_Macro'>MemSet</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN162"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN162"><span class='Ref_To_Local'>values</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../../include/c.h.html#LN856"><span class='Ref_to_Macro'>MemSet</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN427"><span class='Ref_to_Member'>locktag</span></a><span class='Operator'>.</span><a href="../../../include/storage/lock.h.html#LN184"><span class='Ref_to_Member'>locktag_type</span></a> <span class='Operator'>&LT;= </span><a href="../../../include/storage/lock.h.html#LN166"><span class='Ref_to_Const'>LOCKTAG_LAST_TYPE</span></a><span class='Parentheses'>) 
</span>            <a href="lockfuncs.c.html#LN160"><span class='Ref_To_Local'>locktypename</span></a> <span class='Operator'>= </span><a href="lockfuncs.c.html#LN25"><span class='Ref_to_Global_Var'>LockTagTypeNames</span></a><span class='Delimiter'>[</span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN427"><span class='Ref_to_Member'>locktag</span></a><span class='Operator'>.</span><a href="../../../include/storage/lock.h.html#LN184"><span class='Ref_to_Member'>locktag_type</span></a><span class='Delimiter'>]; 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="../../../pl/plperl/plperl.h.html#LN60"><span class='Ref_to_Macro'>snprintf</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN161"><span class='Ref_To_Local'>tnbuf</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN161"><span class='Ref_To_Local'>tnbuf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='String'>"unknown %d"</span><span class='Delimiter'>, 
</span>                     <span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN427"><span class='Ref_to_Member'>locktag</span></a><span class='Operator'>.</span><a href="../../../include/storage/lock.h.html#LN184"><span class='Ref_to_Member'>locktag_type</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="lockfuncs.c.html#LN160"><span class='Ref_To_Local'>locktypename</span></a> <span class='Operator'>= </span><a href="lockfuncs.c.html#LN161"><span class='Ref_To_Local'>tnbuf</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="lockfuncs.c.html#LN162"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/utils/builtins.h.html#LN90"><span class='Ref_to_Macro'>CStringGetTextDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN160"><span class='Ref_To_Local'>locktypename</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>switch</span> <span class='Parentheses'>((</span><a href="../../../include/storage/lock.h.html#LN138"><span class='Ref_to_Enum'>LockTagType</span></a><span class='Parentheses'>) </span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN427"><span class='Ref_to_Member'>locktag</span></a><span class='Operator'>.</span><a href="../../../include/storage/lock.h.html#LN184"><span class='Ref_to_Member'>locktag_type</span></a><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>case</span> <a href="../../../include/storage/lock.h.html#LN140"><span class='Ref_to_EnumConst'>LOCKTAG_RELATION</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../../include/storage/lock.h.html#LN142"><span class='Ref_to_EnumConst'>LOCKTAG_RELATION_EXTEND</span></a><span class='Operator'>: 
</span>                <a href="lockfuncs.c.html#LN162"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN427"><span class='Ref_to_Member'>locktag</span></a><span class='Operator'>.</span><a href="../../../include/storage/lock.h.html#LN180"><span class='Ref_to_Member'>locktag_field1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN162"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN427"><span class='Ref_to_Member'>locktag</span></a><span class='Operator'>.</span><a href="../../../include/storage/lock.h.html#LN181"><span class='Ref_to_Member'>locktag_field2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>4</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>5</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>6</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>7</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>8</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>9</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="../../../include/storage/lock.h.html#LN144"><span class='Ref_to_EnumConst'>LOCKTAG_PAGE</span></a><span class='Operator'>: 
</span>                <a href="lockfuncs.c.html#LN162"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN427"><span class='Ref_to_Member'>locktag</span></a><span class='Operator'>.</span><a href="../../../include/storage/lock.h.html#LN180"><span class='Ref_to_Member'>locktag_field1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN162"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN427"><span class='Ref_to_Member'>locktag</span></a><span class='Operator'>.</span><a href="../../../include/storage/lock.h.html#LN181"><span class='Ref_to_Member'>locktag_field2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN162"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN498"><span class='Ref_to_Macro'>UInt32GetDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN427"><span class='Ref_to_Member'>locktag</span></a><span class='Operator'>.</span><a href="../../../include/storage/lock.h.html#LN182"><span class='Ref_to_Member'>locktag_field3</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>4</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>5</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>6</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>7</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>8</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>9</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="../../../include/storage/lock.h.html#LN146"><span class='Ref_to_EnumConst'>LOCKTAG_TUPLE</span></a><span class='Operator'>: 
</span>                <a href="lockfuncs.c.html#LN162"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN427"><span class='Ref_to_Member'>locktag</span></a><span class='Operator'>.</span><a href="../../../include/storage/lock.h.html#LN180"><span class='Ref_to_Member'>locktag_field1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN162"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN427"><span class='Ref_to_Member'>locktag</span></a><span class='Operator'>.</span><a href="../../../include/storage/lock.h.html#LN181"><span class='Ref_to_Member'>locktag_field2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN162"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN498"><span class='Ref_to_Macro'>UInt32GetDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN427"><span class='Ref_to_Member'>locktag</span></a><span class='Operator'>.</span><a href="../../../include/storage/lock.h.html#LN182"><span class='Ref_to_Member'>locktag_field3</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN162"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>4</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN470"><span class='Ref_to_Macro'>UInt16GetDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN427"><span class='Ref_to_Member'>locktag</span></a><span class='Operator'>.</span><a href="../../../include/storage/lock.h.html#LN183"><span class='Ref_to_Member'>locktag_field4</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>5</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>6</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>7</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>8</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>9</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="../../../include/storage/lock.h.html#LN148"><span class='Ref_to_EnumConst'>LOCKTAG_TRANSACTION</span></a><span class='Operator'>: 
</span>                <a href="lockfuncs.c.html#LN162"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>6</span><span class='Delimiter'>] </span><span class='Operator'>= 
</span>                    <a href="../../../include/postgres.h.html#LN526"><span class='Ref_to_Macro'>TransactionIdGetDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN427"><span class='Ref_to_Member'>locktag</span></a><span class='Operator'>.</span><a href="../../../include/storage/lock.h.html#LN180"><span class='Ref_to_Member'>locktag_field1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>4</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>5</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>7</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>8</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>9</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="../../../include/storage/lock.h.html#LN150"><span class='Ref_to_EnumConst'>LOCKTAG_VIRTUALTRANSACTION</span></a><span class='Operator'>: 
</span>                <a href="lockfuncs.c.html#LN162"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>5</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="lockfuncs.c.html#LN62"><span class='Ref_to_Func'>VXIDGetDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN427"><span class='Ref_to_Member'>locktag</span></a><span class='Operator'>.</span><a href="../../../include/storage/lock.h.html#LN180"><span class='Ref_to_Member'>locktag_field1</span></a><span class='Delimiter'>, 
</span>                                         <a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN427"><span class='Ref_to_Member'>locktag</span></a><span class='Operator'>.</span><a href="../../../include/storage/lock.h.html#LN181"><span class='Ref_to_Member'>locktag_field2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>4</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>6</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>7</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>8</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>9</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="../../../include/storage/lock.h.html#LN154"><span class='Ref_to_EnumConst'>LOCKTAG_OBJECT</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../../include/storage/lock.h.html#LN162"><span class='Ref_to_EnumConst'>LOCKTAG_USERLOCK</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="../../../include/storage/lock.h.html#LN163"><span class='Ref_to_EnumConst'>LOCKTAG_ADVISORY</span></a><span class='Operator'>: 
</span>            <span class='Control'>default</span><span class='Operator'>:</span>            <span class='Comment_Single_Line'>/* treat unknown locktags like OBJECT */ 
</span>                <a href="lockfuncs.c.html#LN162"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN427"><span class='Ref_to_Member'>locktag</span></a><span class='Operator'>.</span><a href="../../../include/storage/lock.h.html#LN180"><span class='Ref_to_Member'>locktag_field1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN162"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>7</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN427"><span class='Ref_to_Member'>locktag</span></a><span class='Operator'>.</span><a href="../../../include/storage/lock.h.html#LN181"><span class='Ref_to_Member'>locktag_field2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN162"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>8</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN427"><span class='Ref_to_Member'>locktag</span></a><span class='Operator'>.</span><a href="../../../include/storage/lock.h.html#LN182"><span class='Ref_to_Member'>locktag_field3</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN162"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>9</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN456"><span class='Ref_to_Macro'>Int16GetDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN427"><span class='Ref_to_Member'>locktag</span></a><span class='Operator'>.</span><a href="../../../include/storage/lock.h.html#LN183"><span class='Ref_to_Member'>locktag_field4</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>4</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>5</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>6</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch (LockTagType)instance... &raquo; </span> 
 
        <a href="lockfuncs.c.html#LN162"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>10</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="lockfuncs.c.html#LN62"><span class='Ref_to_Func'>VXIDGetDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN430"><span class='Ref_to_Member'>backend</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN431"><span class='Ref_to_Member'>lxid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN432"><span class='Ref_to_Member'>pid</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="lockfuncs.c.html#LN162"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>11</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN484"><span class='Ref_to_Macro'>Int32GetDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN432"><span class='Ref_to_Member'>pid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>11</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <a href="lockfuncs.c.html#LN162"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>12</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/utils/builtins.h.html#LN90"><span class='Ref_to_Macro'>CStringGetTextDatum</span></a><span class='Parentheses'>(</span><a href="../../../include/storage/lock.h.html#LN556"><span class='Ref_to_Proto'>GetLockmodeName</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN427"><span class='Ref_to_Member'>locktag</span></a><span class='Operator'>.</span><a href="../../../include/storage/lock.h.html#LN185"><span class='Ref_to_Member'>locktag_lockmethodid</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN159"><span class='Ref_To_Local'>mode</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="lockfuncs.c.html#LN162"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>13</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN158"><span class='Ref_To_Local'>granted</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="lockfuncs.c.html#LN162"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>14</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN166"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN434"><span class='Ref_to_Member'>fastpath</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="lockfuncs.c.html#LN164"><span class='Ref_To_Local'>tuple</span></a> <span class='Operator'>= </span><a href="../../access/common/heaptuple.c.html#LN690"><span class='Ref_to_Func'>heap_form_tuple</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN83"><span class='Ref_To_Local'>funcctx</span></a><span class='Operator'>-&GT;</span><a href="../../../include/funcapi.h.html#LN119"><span class='Ref_to_Member'>tuple_desc</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN162"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN163"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="lockfuncs.c.html#LN165"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/funcapi.h.html#LN221"><span class='Ref_to_Macro'>HeapTupleGetDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN164"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/funcapi.h.html#LN290"><span class='Ref_to_Macro'>SRF_RETURN_NEXT</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN83"><span class='Ref_To_Local'>funcctx</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN165"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while mystatus-&GT;currIdx&LT;loc... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* 
     * Have returned all regular locks. Now start on the SIREAD predicate 
     * locks. 
     */ 
</span>    <a href="lockfuncs.c.html#LN86"><span class='Ref_To_Local'>predLockData</span></a> <span class='Operator'>= </span><a href="lockfuncs.c.html#LN84"><span class='Ref_To_Local'>mystatus</span></a><span class='Operator'>-&GT;</span><a href="lockfuncs.c.html#LN50"><span class='Ref_to_Member'>predLockData</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN84"><span class='Ref_To_Local'>mystatus</span></a><span class='Operator'>-&GT;</span><a href="lockfuncs.c.html#LN51"><span class='Ref_to_Member'>predLockIdx</span></a> <span class='Operator'>&LT; </span><a href="lockfuncs.c.html#LN86"><span class='Ref_To_Local'>predLockData</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/predicate_internals.h.html#LN378"><span class='Ref_to_Member'>nelements</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN330"></a>        <a href="../../../include/storage/predicate_internals.h.html#LN362"><span class='Ref_to_Enum'>PredicateLockTargetType</span></a> <span class='Declare_Local'>lockType</span><span class='Delimiter'>; 
</span> 
<a name="LN332"></a>        <a href="../../../include/storage/predicate_internals.h.html#LN268"><span class='Ref_to_Struct'>PREDICATELOCKTARGETTAG</span></a> <span class='Operator'>*</span><span class='Declare_Local'>predTag</span> <span class='Operator'>= &</span><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN86"><span class='Ref_To_Local'>predLockData</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/predicate_internals.h.html#LN379"><span class='Ref_to_Member'>locktags</span></a><span class='Delimiter'>[</span><a href="lockfuncs.c.html#LN84"><span class='Ref_To_Local'>mystatus</span></a><span class='Operator'>-&GT;</span><a href="lockfuncs.c.html#LN51"><span class='Ref_to_Member'>predLockIdx</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN333"></a>        <a href="../../../include/storage/predicate_internals.h.html#LN55"><span class='Ref_to_Struct'>SERIALIZABLEXACT</span></a> <span class='Operator'>*</span><span class='Declare_Local'>xact</span> <span class='Operator'>= &</span><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN86"><span class='Ref_To_Local'>predLockData</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/predicate_internals.h.html#LN380"><span class='Ref_to_Member'>xacts</span></a><span class='Delimiter'>[</span><a href="lockfuncs.c.html#LN84"><span class='Ref_To_Local'>mystatus</span></a><span class='Operator'>-&GT;</span><a href="lockfuncs.c.html#LN51"><span class='Ref_to_Member'>predLockIdx</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN334"></a>        <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>values</span><span class='Delimiter'>[</span><a href="lockfuncs.c.html#LN55"><span class='Ref_to_Const'>NUM_LOCK_STATUS_COLUMNS</span></a><span class='Delimiter'>]; 
</span><a name="LN335"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>nulls</span><span class='Delimiter'>[</span><a href="lockfuncs.c.html#LN55"><span class='Ref_to_Const'>NUM_LOCK_STATUS_COLUMNS</span></a><span class='Delimiter'>]; 
</span><a name="LN336"></a>        <a href="../../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tuple</span><span class='Delimiter'>; 
</span><a name="LN337"></a>        <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>       <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
        <a href="lockfuncs.c.html#LN84"><span class='Ref_To_Local'>mystatus</span></a><span class='Operator'>-&GT;</span><a href="lockfuncs.c.html#LN51"><span class='Ref_to_Member'>predLockIdx</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Form tuple with appropriate data. 
         */ 
</span>        <a href="../../../include/c.h.html#LN856"><span class='Ref_to_Macro'>MemSet</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN334"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN334"><span class='Ref_To_Local'>values</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../../include/c.h.html#LN856"><span class='Ref_to_Macro'>MemSet</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN335"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN335"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* lock type */ 
</span>        <a href="lockfuncs.c.html#LN330"><span class='Ref_To_Local'>lockType</span></a> <span class='Operator'>= </span><a href="../../../include/storage/predicate_internals.h.html#LN415"><span class='Ref_to_Macro'>GET_PREDICATELOCKTARGETTAG_TYPE</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="lockfuncs.c.html#LN332"><span class='Ref_To_Local'>predTag</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="lockfuncs.c.html#LN334"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/utils/builtins.h.html#LN90"><span class='Ref_to_Macro'>CStringGetTextDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN39"><span class='Ref_to_Global_Var'>PredicateLockTagTypeNames</span></a><span class='Delimiter'>[</span><a href="lockfuncs.c.html#LN330"><span class='Ref_To_Local'>lockType</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* lock target */ 
</span>        <a href="lockfuncs.c.html#LN334"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/storage/predicate_internals.h.html#LN407"><span class='Ref_to_Macro'>GET_PREDICATELOCKTARGETTAG_DB</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="lockfuncs.c.html#LN332"><span class='Ref_To_Local'>predTag</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="lockfuncs.c.html#LN334"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/storage/predicate_internals.h.html#LN409"><span class='Ref_to_Macro'>GET_PREDICATELOCKTARGETTAG_RELATION</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="lockfuncs.c.html#LN332"><span class='Ref_To_Local'>predTag</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN330"><span class='Ref_To_Local'>lockType</span></a> <span class='Operator'>== </span><a href="../../../include/storage/predicate_internals.h.html#LN366"><span class='Ref_to_EnumConst'>PREDLOCKTAG_TUPLE</span></a><span class='Parentheses'>) 
</span>            <a href="lockfuncs.c.html#LN334"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>4</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/storage/predicate_internals.h.html#LN413"><span class='Ref_to_Macro'>GET_PREDICATELOCKTARGETTAG_OFFSET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="lockfuncs.c.html#LN332"><span class='Ref_To_Local'>predTag</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="lockfuncs.c.html#LN335"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>4</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="lockfuncs.c.html#LN330"><span class='Ref_To_Local'>lockType</span></a> <span class='Operator'>== </span><a href="../../../include/storage/predicate_internals.h.html#LN366"><span class='Ref_to_EnumConst'>PREDLOCKTAG_TUPLE</span></a><span class='Parentheses'>) </span><span class='Operator'>|| 
</span>            <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN330"><span class='Ref_To_Local'>lockType</span></a> <span class='Operator'>== </span><a href="../../../include/storage/predicate_internals.h.html#LN365"><span class='Ref_to_EnumConst'>PREDLOCKTAG_PAGE</span></a><span class='Parentheses'>))</span> 
            <a href="lockfuncs.c.html#LN334"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/storage/predicate_internals.h.html#LN411"><span class='Ref_to_Macro'>GET_PREDICATELOCKTARGETTAG_PAGE</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="lockfuncs.c.html#LN332"><span class='Ref_To_Local'>predTag</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="lockfuncs.c.html#LN335"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* these fields are targets for other types of locks */ 
</span>        <a href="lockfuncs.c.html#LN335"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>5</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* virtualxid */ 
</span>        <a href="lockfuncs.c.html#LN335"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>6</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* transactionid */ 
</span>        <a href="lockfuncs.c.html#LN335"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>7</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* classid */ 
</span>        <a href="lockfuncs.c.html#LN335"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>8</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* objid */ 
</span>        <a href="lockfuncs.c.html#LN335"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>9</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* objsubid */ 
</span> 
        <span class='Comment_Multi_Line'>/* lock holder */ 
</span>        <a href="lockfuncs.c.html#LN334"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>10</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="lockfuncs.c.html#LN62"><span class='Ref_to_Func'>VXIDGetDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN333"><span class='Ref_To_Local'>xact</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/predicate_internals.h.html#LN57"><span class='Ref_to_Member'>vxid</span></a><span class='Operator'>.</span><a href="../../../include/storage/lock.h.html#LN64"><span class='Ref_to_Member'>backendId</span></a><span class='Delimiter'>, 
</span>                                  <a href="lockfuncs.c.html#LN333"><span class='Ref_To_Local'>xact</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/predicate_internals.h.html#LN57"><span class='Ref_to_Member'>vxid</span></a><span class='Operator'>.</span><a href="../../../include/storage/lock.h.html#LN65"><span class='Ref_to_Member'>localTransactionId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN333"><span class='Ref_To_Local'>xact</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/predicate_internals.h.html#LN106"><span class='Ref_to_Member'>pid</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="lockfuncs.c.html#LN334"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>11</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN484"><span class='Ref_to_Macro'>Int32GetDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN333"><span class='Ref_To_Local'>xact</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/predicate_internals.h.html#LN106"><span class='Ref_to_Member'>pid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="lockfuncs.c.html#LN335"><span class='Ref_To_Local'>nulls</span></a><span class='Delimiter'>[</span><span class='Number'>11</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Lock mode. Currently all predicate locks are SIReadLocks, which are 
         * always held (never waiting) and have no fast path 
         */ 
</span>        <a href="lockfuncs.c.html#LN334"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>12</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/utils/builtins.h.html#LN90"><span class='Ref_to_Macro'>CStringGetTextDatum</span></a><span class='Parentheses'>(</span><span class='String'>"SIReadLock"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="lockfuncs.c.html#LN334"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>13</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="lockfuncs.c.html#LN334"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>14</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN407"><span class='Ref_to_Macro'>BoolGetDatum</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="lockfuncs.c.html#LN336"><span class='Ref_To_Local'>tuple</span></a> <span class='Operator'>= </span><a href="../../access/common/heaptuple.c.html#LN690"><span class='Ref_to_Func'>heap_form_tuple</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN83"><span class='Ref_To_Local'>funcctx</span></a><span class='Operator'>-&GT;</span><a href="../../../include/funcapi.h.html#LN119"><span class='Ref_to_Member'>tuple_desc</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN334"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN335"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="lockfuncs.c.html#LN337"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../../../include/funcapi.h.html#LN221"><span class='Ref_to_Macro'>HeapTupleGetDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN336"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/funcapi.h.html#LN290"><span class='Ref_to_Macro'>SRF_RETURN_NEXT</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN83"><span class='Ref_To_Local'>funcctx</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN337"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if mystatus-&GT;predLockIdx... &raquo; </span> 
 
    <a href="../../../include/funcapi.h.html#LN308"><span class='Ref_to_Macro'>SRF_RETURN_DONE</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN83"><span class='Ref_To_Local'>funcctx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_lock_status &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * pg_blocking_pids - produce an array of the PIDs blocking given PID 
 * 
 * The reported PIDs are those that hold a lock conflicting with blocked_pid's 
 * current request (hard block), or are requesting such a lock and are ahead 
 * of blocked_pid in the lock's wait queue (soft block). 
 * 
 * In parallel-query cases, we report all PIDs blocking any member of the 
 * given PID's lock group, and the reported PIDs are those of the blocking 
 * PIDs' lock group leaders.  This allows callers to compare the result to 
 * lists of clients' pg_backend_pid() results even during a parallel query. 
 * 
 * Parallel query makes it possible for there to be duplicate PIDs in the 
 * result (either because multiple waiters are blocked by same PID, or 
 * because multiple blockers have same group leader PID).  We do not bother 
 * to eliminate such duplicates from the result. 
 * 
 * We need not consider predicate locks here, since those don't block anything. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN417"></a><span class='Declare_Function'>pg_blocking_pids</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN419"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>blocked_pid</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN420"></a>    <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>arrayelems</span><span class='Delimiter'>; 
</span><a name="LN421"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>narrayelems</span><span class='Delimiter'>; 
</span><a name="LN422"></a>    <a href="../../../include/storage/lock.h.html#LN456"><span class='Ref_to_Struct'>BlockedProcsData</span></a> <span class='Operator'>*</span><span class='Declare_Local'>lockData</span><span class='Delimiter'>; </span><span class='Comment_Single_Line'>/* state data from lmgr */ 
</span><a name="LN423"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>, 
</span><a name="LN424"></a>                <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Collect a snapshot of lock manager state */ 
</span>    <a href="lockfuncs.c.html#LN422"><span class='Ref_To_Local'>lockData</span></a> <span class='Operator'>= </span><a href="../../../include/storage/lock.h.html#LN553"><span class='Ref_to_Proto'>GetBlockerStatusData</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN419"><span class='Ref_To_Local'>blocked_pid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* We can't need more output entries than there are reported PROCLOCKs */ 
</span>    <a href="lockfuncs.c.html#LN420"><span class='Ref_To_Local'>arrayelems</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN422"><span class='Ref_To_Local'>lockData</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN463"><span class='Ref_to_Member'>nlocks</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN421"><span class='Ref_To_Local'>narrayelems</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* For each blocked proc in the lock group ... */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN423"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="lockfuncs.c.html#LN423"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="lockfuncs.c.html#LN422"><span class='Ref_To_Local'>lockData</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN461"><span class='Ref_to_Member'>nprocs</span></a><span class='Delimiter'>; </span><a href="lockfuncs.c.html#LN423"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN436"></a>        <a href="../../../include/storage/lock.h.html#LN443"><span class='Ref_to_Struct'>BlockedProcData</span></a> <span class='Operator'>*</span><span class='Declare_Local'>bproc</span> <span class='Operator'>= &</span><a href="lockfuncs.c.html#LN422"><span class='Ref_To_Local'>lockData</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN458"><span class='Ref_to_Member'>procs</span></a><span class='Delimiter'>[</span><a href="lockfuncs.c.html#LN423"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span><a name="LN437"></a>        <a href="../../../include/storage/lock.h.html#LN425"><span class='Ref_to_Struct'>LockInstanceData</span></a> <span class='Operator'>*</span><span class='Declare_Local'>instances</span> <span class='Operator'>= &</span><a href="lockfuncs.c.html#LN422"><span class='Ref_To_Local'>lockData</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN459"><span class='Ref_to_Member'>locks</span></a><span class='Delimiter'>[</span><a href="lockfuncs.c.html#LN436"><span class='Ref_To_Local'>bproc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN448"><span class='Ref_to_Member'>first_lock</span></a><span class='Delimiter'>]; 
</span><a name="LN438"></a>        <span class='Keyword'>int</span>        <span class='Operator'>*</span><span class='Declare_Local'>preceding_waiters</span> <span class='Operator'>= &</span><a href="lockfuncs.c.html#LN422"><span class='Ref_To_Local'>lockData</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN460"><span class='Ref_to_Member'>waiter_pids</span></a><span class='Delimiter'>[</span><a href="lockfuncs.c.html#LN436"><span class='Ref_To_Local'>bproc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN452"><span class='Ref_to_Member'>first_waiter</span></a><span class='Delimiter'>]; 
</span><a name="LN439"></a>        <a href="../../../include/storage/lock.h.html#LN425"><span class='Ref_to_Struct'>LockInstanceData</span></a> <span class='Operator'>*</span><span class='Declare_Local'>blocked_instance</span><span class='Delimiter'>; 
</span><a name="LN440"></a>        <a href="../../../include/storage/lock.h.html#LN119"><span class='Ref_to_Typedef'>LockMethod</span></a>  <span class='Declare_Local'>lockMethodTable</span><span class='Delimiter'>; 
</span><a name="LN441"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>conflictMask</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Locate the blocked proc's own entry in the LockInstanceData array. 
         * There should be exactly one matching entry. 
         */ 
</span>        <a href="lockfuncs.c.html#LN439"><span class='Ref_To_Local'>blocked_instance</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN424"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="lockfuncs.c.html#LN424"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><a href="lockfuncs.c.html#LN436"><span class='Ref_To_Local'>bproc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN449"><span class='Ref_to_Member'>num_locks</span></a><span class='Delimiter'>; </span><a href="lockfuncs.c.html#LN424"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN450"></a>            <a href="../../../include/storage/lock.h.html#LN425"><span class='Ref_to_Struct'>LockInstanceData</span></a> <span class='Operator'>*</span><span class='Declare_Local'>instance</span> <span class='Operator'>= &</span><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN437"><span class='Ref_To_Local'>instances</span></a><span class='Delimiter'>[</span><a href="lockfuncs.c.html#LN424"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN450"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN432"><span class='Ref_to_Member'>pid</span></a> <span class='Operator'>== </span><a href="lockfuncs.c.html#LN436"><span class='Ref_To_Local'>bproc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN445"><span class='Ref_to_Member'>pid</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN439"><span class='Ref_To_Local'>blocked_instance</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="lockfuncs.c.html#LN439"><span class='Ref_To_Local'>blocked_instance</span></a> <span class='Operator'>= </span><a href="lockfuncs.c.html#LN450"><span class='Ref_To_Local'>instance</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN439"><span class='Ref_To_Local'>blocked_instance</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="lockfuncs.c.html#LN440"><span class='Ref_To_Local'>lockMethodTable</span></a> <span class='Operator'>= </span><a href="../../storage/lmgr/lock.c.html#LN470"><span class='Ref_to_Func'>GetLockTagsMethodTable</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN439"><span class='Ref_To_Local'>blocked_instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN427"><span class='Ref_to_Member'>locktag</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="lockfuncs.c.html#LN441"><span class='Ref_To_Local'>conflictMask</span></a> <span class='Operator'>= </span><a href="lockfuncs.c.html#LN440"><span class='Ref_To_Local'>lockMethodTable</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN114"><span class='Ref_to_Member'>conflictTab</span></a><span class='Delimiter'>[</span><a href="lockfuncs.c.html#LN439"><span class='Ref_To_Local'>blocked_instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN429"><span class='Ref_to_Member'>waitLockMode</span></a><span class='Delimiter'>]; 
</span> 
        <span class='Comment_Multi_Line'>/* Now scan the PROCLOCK data for conflicting procs */ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN424"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="lockfuncs.c.html#LN424"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><a href="lockfuncs.c.html#LN436"><span class='Ref_To_Local'>bproc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN449"><span class='Ref_to_Member'>num_locks</span></a><span class='Delimiter'>; </span><a href="lockfuncs.c.html#LN424"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN466"></a>            <a href="../../../include/storage/lock.h.html#LN425"><span class='Ref_to_Struct'>LockInstanceData</span></a> <span class='Operator'>*</span><span class='Declare_Local'>instance</span> <span class='Operator'>= &</span><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN437"><span class='Ref_To_Local'>instances</span></a><span class='Delimiter'>[</span><a href="lockfuncs.c.html#LN424"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* A proc never blocks itself, so ignore that entry */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN466"><span class='Ref_To_Local'>instance</span></a> <span class='Operator'>== </span><a href="lockfuncs.c.html#LN439"><span class='Ref_To_Local'>blocked_instance</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* Members of same lock group never block each other, either */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN466"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN433"><span class='Ref_to_Member'>leaderPid</span></a> <span class='Operator'>== </span><a href="lockfuncs.c.html#LN439"><span class='Ref_To_Local'>blocked_instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN433"><span class='Ref_to_Member'>leaderPid</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN441"><span class='Ref_To_Local'>conflictMask</span></a> <span class='Operator'>& </span><a href="lockfuncs.c.html#LN466"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN428"><span class='Ref_to_Member'>holdMask</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* hard block: blocked by lock already held by this entry */ 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN466"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN429"><span class='Ref_to_Member'>waitLockMode</span></a> <span class='Operator'>!= </span><a href="../../../include/storage/lockdefs.h.html#LN33"><span class='Ref_to_Const'>NoLock</span></a> <span class='Operator'>&& 
</span>                     <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN441"><span class='Ref_To_Local'>conflictMask</span></a> <span class='Operator'>& </span><a href="../../../include/storage/lock.h.html#LN87"><span class='Ref_to_Macro'>LOCKBIT_ON</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN466"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN429"><span class='Ref_to_Member'>waitLockMode</span></a><span class='Parentheses'>)))</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* conflict in lock requests; who's in front in wait queue? */ 
</span><a name="LN483"></a>                <span class='Keyword'>bool</span>        <span class='Declare_Local'>ahead</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN484"></a>                <span class='Keyword'>int</span>         <span class='Declare_Local'>k</span><span class='Delimiter'>; 
</span> 
                <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN484"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="lockfuncs.c.html#LN484"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>&LT; </span><a href="lockfuncs.c.html#LN436"><span class='Ref_To_Local'>bproc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN453"><span class='Ref_to_Member'>num_waiters</span></a><span class='Delimiter'>; </span><a href="lockfuncs.c.html#LN484"><span class='Ref_To_Local'>k</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN438"><span class='Ref_To_Local'>preceding_waiters</span></a><span class='Delimiter'>[</span><a href="lockfuncs.c.html#LN484"><span class='Ref_To_Local'>k</span></a><span class='Delimiter'>] </span><span class='Operator'>== </span><a href="lockfuncs.c.html#LN466"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN432"><span class='Ref_to_Member'>pid</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <span class='Comment_Multi_Line'>/* soft block: this entry is ahead of blocked proc */ 
</span>                        <a href="lockfuncs.c.html#LN483"><span class='Ref_To_Local'>ahead</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                        <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="lockfuncs.c.html#LN483"><span class='Ref_To_Local'>ahead</span></a><span class='Parentheses'>) 
</span>                    <span class='Control'>continue</span><span class='Delimiter'>;</span>   <span class='Comment_Single_Line'>/* not blocked by this entry */ 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* not blocked by this entry */ 
</span>                <span class='Control'>continue</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Comment_Multi_Line'>/* blocked by this entry, so emit a record */ 
</span>            <a href="lockfuncs.c.html#LN420"><span class='Ref_To_Local'>arrayelems</span></a><span class='Delimiter'>[</span><a href="lockfuncs.c.html#LN421"><span class='Ref_To_Local'>narrayelems</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN484"><span class='Ref_to_Macro'>Int32GetDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN466"><span class='Ref_To_Local'>instance</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN433"><span class='Ref_to_Member'>leaderPid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for j=0;j&LT;bproc-&GT;num_lock... &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=0;i&LT;lockData-&GT;nproc... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Assert we didn't overrun arrayelems[] */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN421"><span class='Ref_To_Local'>narrayelems</span></a> <span class='Operator'>&LT;= </span><a href="lockfuncs.c.html#LN422"><span class='Ref_To_Local'>lockData</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/lock.h.html#LN463"><span class='Ref_to_Member'>nlocks</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Construct array, using hardwired knowledge about int4 type */ 
</span>    <a href="../../../include/utils/array.h.html#LN245"><span class='Ref_to_Macro'>PG_RETURN_ARRAYTYPE_P</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/array.h.html#LN369"><span class='Ref_to_Proto'>construct_array</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN420"><span class='Ref_To_Local'>arrayelems</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN421"><span class='Ref_To_Local'>narrayelems</span></a><span class='Delimiter'>, 
</span>                                          <a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN24"><span class='Ref_to_Const'>INT4OID</span></a><span class='Delimiter'>, 
</span>                                          <span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='String'>'i'</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_blocking_pids &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * pg_safe_snapshot_blocking_pids - produce an array of the PIDs blocking 
 * given PID from getting a safe snapshot 
 * 
 * XXX this does not consider parallel-query cases; not clear how big a 
 * problem that is in practice 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN527"></a><span class='Declare_Function'>pg_safe_snapshot_blocking_pids</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN529"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>blocked_pid</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN530"></a>    <span class='Keyword'>int</span>        <span class='Operator'>*</span><span class='Declare_Local'>blockers</span><span class='Delimiter'>; 
</span><a name="LN531"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>num_blockers</span><span class='Delimiter'>; 
</span><a name="LN532"></a>    <a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>blocker_datums</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* A buffer big enough for any possible blocker list without truncation */ 
</span>    <a href="lockfuncs.c.html#LN530"><span class='Ref_To_Local'>blockers</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="../init/globals.c.html#LN126"><span class='Ref_to_Global_Var'>MaxBackends</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Collect a snapshot of processes waited for by GetSafeSnapshot */ 
</span>    <a href="lockfuncs.c.html#LN531"><span class='Ref_To_Local'>num_blockers</span></a> <span class='Operator'>= 
</span>        <a href="../../../include/storage/predicate_internals.h.html#LN476"><span class='Ref_to_Proto'>GetSafeSnapshotBlockingPids</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN529"><span class='Ref_To_Local'>blocked_pid</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN530"><span class='Ref_To_Local'>blockers</span></a><span class='Delimiter'>, </span><a href="../init/globals.c.html#LN126"><span class='Ref_to_Global_Var'>MaxBackends</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Convert int array to Datum array */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN531"><span class='Ref_To_Local'>num_blockers</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN544"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
        <a href="lockfuncs.c.html#LN532"><span class='Ref_To_Local'>blocker_datums</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN531"><span class='Ref_To_Local'>num_blockers</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN544"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="lockfuncs.c.html#LN544"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="lockfuncs.c.html#LN531"><span class='Ref_To_Local'>num_blockers</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="lockfuncs.c.html#LN544"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>            <a href="lockfuncs.c.html#LN532"><span class='Ref_To_Local'>blocker_datums</span></a><span class='Delimiter'>[</span><a href="lockfuncs.c.html#LN544"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN484"><span class='Ref_to_Macro'>Int32GetDatum</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN530"><span class='Ref_To_Local'>blockers</span></a><span class='Delimiter'>[</span><a href="lockfuncs.c.html#LN544"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
        <a href="lockfuncs.c.html#LN532"><span class='Ref_To_Local'>blocker_datums</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Construct array, using hardwired knowledge about int4 type */ 
</span>    <a href="../../../include/utils/array.h.html#LN245"><span class='Ref_to_Macro'>PG_RETURN_ARRAYTYPE_P</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/array.h.html#LN369"><span class='Ref_to_Proto'>construct_array</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN532"><span class='Ref_To_Local'>blocker_datums</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN531"><span class='Ref_To_Local'>num_blockers</span></a><span class='Delimiter'>, 
</span>                                          <a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN24"><span class='Ref_to_Const'>INT4OID</span></a><span class='Delimiter'>, 
</span>                                          <span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='String'>'i'</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_safe_snapshot_blocking_pids &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * pg_isolation_test_session_is_blocked - support function for isolationtester 
 * 
 * Check if specified PID is blocked by any of the PIDs listed in the second 
 * argument.  Currently, this looks for blocking caused by waiting for 
 * heavyweight locks or safe snapshots.  We ignore blockage caused by PIDs 
 * not directly under the isolationtester's control, eg autovacuum. 
 * 
 * This is an undocumented function intended for use by the isolation tester, 
 * and may change in future releases as required for testing purposes. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN572"></a><span class='Declare_Function'>pg_isolation_test_session_is_blocked</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN574"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>blocked_pid</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN575"></a>    <a href="../../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>interesting_pids_a</span> <span class='Operator'>= </span><a href="../../../include/utils/array.h.html#LN243"><span class='Ref_to_Macro'>PG_GETARG_ARRAYTYPE_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN576"></a>    <a href="../../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>blocking_pids_a</span><span class='Delimiter'>; 
</span><a name="LN577"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>interesting_pids</span><span class='Delimiter'>; 
</span><a name="LN578"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>blocking_pids</span><span class='Delimiter'>; 
</span><a name="LN579"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>num_interesting_pids</span><span class='Delimiter'>; 
</span><a name="LN580"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>num_blocking_pids</span><span class='Delimiter'>; 
</span><a name="LN581"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>dummy</span><span class='Delimiter'>; 
</span><a name="LN582"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>, 
</span><a name="LN583"></a>                <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Validate the passed-in array */ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/utils/array.h.html#LN272"><span class='Ref_to_Macro'>ARR_ELEMTYPE</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN575"><span class='Ref_To_Local'>interesting_pids_a</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN24"><span class='Ref_to_Const'>INT4OID</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/array.h.html#LN386"><span class='Ref_to_Proto'>array_contains_nulls</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN575"><span class='Ref_To_Local'>interesting_pids_a</span></a><span class='Parentheses'>))</span> 
        <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"array must not contain nulls"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN577"><span class='Ref_To_Local'>interesting_pids</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/utils/array.h.html#LN302"><span class='Ref_to_Macro'>ARR_DATA_PTR</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN575"><span class='Ref_To_Local'>interesting_pids_a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN579"><span class='Ref_To_Local'>num_interesting_pids</span></a> <span class='Operator'>= </span><a href="arrayutils.c.html#LN73"><span class='Ref_to_Func'>ArrayGetNItems</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/array.h.html#LN270"><span class='Ref_to_Macro'>ARR_NDIM</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN575"><span class='Ref_To_Local'>interesting_pids_a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                          <a href="../../../include/utils/array.h.html#LN274"><span class='Ref_to_Macro'>ARR_DIMS</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN575"><span class='Ref_To_Local'>interesting_pids_a</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Get the PIDs of all sessions blocking the given session's attempt to 
     * acquire heavyweight locks. 
     */ 
</span>    <a href="lockfuncs.c.html#LN576"><span class='Ref_To_Local'>blocking_pids_a</span></a> <span class='Operator'>= 
</span>        <a href="../../../include/utils/array.h.html#LN241"><span class='Ref_to_Macro'>DatumGetArrayTypeP</span></a><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN583"><span class='Ref_to_Macro'>DirectFunctionCall1</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN416"><span class='Ref_to_Func'>pg_blocking_pids</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN574"><span class='Ref_To_Local'>blocked_pid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/utils/array.h.html#LN272"><span class='Ref_to_Macro'>ARR_ELEMTYPE</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN576"><span class='Ref_To_Local'>blocking_pids_a</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN24"><span class='Ref_to_Const'>INT4OID</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/utils/array.h.html#LN386"><span class='Ref_to_Proto'>array_contains_nulls</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN576"><span class='Ref_To_Local'>blocking_pids_a</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN578"><span class='Ref_To_Local'>blocking_pids</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/utils/array.h.html#LN302"><span class='Ref_to_Macro'>ARR_DATA_PTR</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN576"><span class='Ref_To_Local'>blocking_pids_a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN580"><span class='Ref_To_Local'>num_blocking_pids</span></a> <span class='Operator'>= </span><a href="arrayutils.c.html#LN73"><span class='Ref_to_Func'>ArrayGetNItems</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/array.h.html#LN270"><span class='Ref_to_Macro'>ARR_NDIM</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN576"><span class='Ref_To_Local'>blocking_pids_a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                       <a href="../../../include/utils/array.h.html#LN274"><span class='Ref_to_Macro'>ARR_DIMS</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN576"><span class='Ref_To_Local'>blocking_pids_a</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Check if any of these are in the list of interesting PIDs, that being 
     * the sessions that the isolation tester is running.  We don't use 
     * "arrayoverlaps" here, because it would lead to cache lookups and one of 
     * our goals is to run quickly under CLOBBER_CACHE_ALWAYS.  We expect 
     * blocking_pids to be usually empty and otherwise a very small number in 
     * isolation tester cases, so make that the outer loop of a naive search 
     * for a match. 
     */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN582"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="lockfuncs.c.html#LN582"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="lockfuncs.c.html#LN580"><span class='Ref_To_Local'>num_blocking_pids</span></a><span class='Delimiter'>; </span><a href="lockfuncs.c.html#LN582"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN583"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="lockfuncs.c.html#LN583"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><a href="lockfuncs.c.html#LN579"><span class='Ref_To_Local'>num_interesting_pids</span></a><span class='Delimiter'>; </span><a href="lockfuncs.c.html#LN583"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN578"><span class='Ref_To_Local'>blocking_pids</span></a><span class='Delimiter'>[</span><a href="lockfuncs.c.html#LN582"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>== </span><a href="lockfuncs.c.html#LN577"><span class='Ref_To_Local'>interesting_pids</span></a><span class='Delimiter'>[</span><a href="lockfuncs.c.html#LN583"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>                <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Check if blocked_pid is waiting for a safe snapshot.  We could in 
     * theory check the resulting array of blocker PIDs against the 
     * interesting PIDs whitelist, but since there is no danger of autovacuum 
     * blocking GetSafeSnapshot there seems to be no point in expending cycles 
     * on allocating a buffer and searching for overlap; so it's presently 
     * sufficient for the isolation tester's purposes to use a single element 
     * buffer and check if the number of safe snapshot blockers is non-zero. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/storage/predicate_internals.h.html#LN476"><span class='Ref_to_Proto'>GetSafeSnapshotBlockingPids</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN574"><span class='Ref_To_Local'>blocked_pid</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="lockfuncs.c.html#LN581"><span class='Ref_To_Local'>dummy</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_isolation_test_session_is_blocked &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * Functions for manipulating advisory locks 
 * 
 * We make use of the locktag fields as follows: 
 * 
 *  field1: MyDatabaseId ... ensures locks are local to each database 
 *  field2: first of 2 int4 keys, or high-order half of an int8 key 
 *  field3: second of 2 int4 keys, or low-order half of an int8 key 
 *  field4: 1 if using an int8 key, 2 if using 2 int4 keys 
 */ 
</span><a name="LN648"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>SET_LOCKTAG_INT64</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>tag</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>key64</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <a href="../../../include/storage/lock.h.html#LN257"><span class='Ref_to_Macro'>SET_LOCKTAG_ADVISORY</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN648"><span class='Ref_to_Parameter'>tag</span></a><span class='Delimiter'>, </span><span class='Operator'>\ 
</span>                         <a href="../init/globals.c.html#LN76"><span class='Ref_to_Global_Var'>MyDatabaseId</span></a><span class='Delimiter'>, </span><span class='Operator'>\ 
</span>                         <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a><span class='Parentheses'>)</span> <span class='Parentheses'>((</span><a href="lockfuncs.c.html#LN648"><span class='Ref_to_Parameter'>key64</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;&GT; </span><span class='Number'>32</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Operator'>\ 
</span>                         <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a><span class='Parentheses'>)</span> <span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN648"><span class='Ref_to_Parameter'>key64</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Operator'>\ 
</span>                         <span class='Number'>1</span><span class='Parentheses'>)</span> 
<a name="LN654"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>SET_LOCKTAG_INT32</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>tag</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>key1</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>key2</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <a href="../../../include/storage/lock.h.html#LN257"><span class='Ref_to_Macro'>SET_LOCKTAG_ADVISORY</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN654"><span class='Ref_to_Parameter'>tag</span></a><span class='Delimiter'>, </span><a href="../init/globals.c.html#LN76"><span class='Ref_to_Global_Var'>MyDatabaseId</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN654"><span class='Ref_to_Parameter'>key1</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN654"><span class='Ref_to_Parameter'>key2</span></a><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Parentheses'>) 
</span> 
<span class='Keyword'>static void 
</span><a name="LN658"></a><span class='Declare_Function'>PreventAdvisoryLocksInParallelMode</span><span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/access/xact.h.html#LN405"><span class='Ref_to_Proto'>IsInParallelMode</span></a><span class='Parentheses'>())</span> 
        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_TRANSACTION_STATE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>           <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot use advisory locks during a parallel operation"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pg_advisory_lock(int8) - acquire exclusive lock on an int8 key 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN670"></a><span class='Declare_Function'>pg_advisory_lock_int8</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN672"></a>    <a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>key</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN246"><span class='Ref_to_Macro'>PG_GETARG_INT64</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN673"></a>    <a href="../../../include/storage/lock.h.html#LN178"><span class='Ref_to_Struct'>LOCKTAG</span></a>     <span class='Declare_Local'>tag</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN657"><span class='Ref_to_Func'>PreventAdvisoryLocksInParallelMode</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN648"><span class='Ref_to_Macro'>SET_LOCKTAG_INT64</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN673"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN672"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="../../../include/storage/lock.h.html#LN523"><span class='Ref_to_Proto'>LockAcquire</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="lockfuncs.c.html#LN673"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="../../../include/storage/lockdefs.h.html#LN43"><span class='Ref_to_Const'>ExclusiveLock</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN308"><span class='Ref_to_Macro'>PG_RETURN_VOID</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pg_advisory_xact_lock(int8) - acquire xact scoped 
 * exclusive lock on an int8 key 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN688"></a><span class='Declare_Function'>pg_advisory_xact_lock_int8</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN690"></a>    <a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>key</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN246"><span class='Ref_to_Macro'>PG_GETARG_INT64</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN691"></a>    <a href="../../../include/storage/lock.h.html#LN178"><span class='Ref_to_Struct'>LOCKTAG</span></a>     <span class='Declare_Local'>tag</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN657"><span class='Ref_to_Func'>PreventAdvisoryLocksInParallelMode</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN648"><span class='Ref_to_Macro'>SET_LOCKTAG_INT64</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN691"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN690"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="../../../include/storage/lock.h.html#LN523"><span class='Ref_to_Proto'>LockAcquire</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="lockfuncs.c.html#LN691"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="../../../include/storage/lockdefs.h.html#LN43"><span class='Ref_to_Const'>ExclusiveLock</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN308"><span class='Ref_to_Macro'>PG_RETURN_VOID</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pg_advisory_lock_shared(int8) - acquire share lock on an int8 key 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN705"></a><span class='Declare_Function'>pg_advisory_lock_shared_int8</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN707"></a>    <a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>key</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN246"><span class='Ref_to_Macro'>PG_GETARG_INT64</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN708"></a>    <a href="../../../include/storage/lock.h.html#LN178"><span class='Ref_to_Struct'>LOCKTAG</span></a>     <span class='Declare_Local'>tag</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN657"><span class='Ref_to_Func'>PreventAdvisoryLocksInParallelMode</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN648"><span class='Ref_to_Macro'>SET_LOCKTAG_INT64</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN708"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN707"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="../../../include/storage/lock.h.html#LN523"><span class='Ref_to_Proto'>LockAcquire</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="lockfuncs.c.html#LN708"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="../../../include/storage/lockdefs.h.html#LN40"><span class='Ref_to_Const'>ShareLock</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN308"><span class='Ref_to_Macro'>PG_RETURN_VOID</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pg_advisory_xact_lock_shared(int8) - acquire xact scoped 
 * share lock on an int8 key 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN723"></a><span class='Declare_Function'>pg_advisory_xact_lock_shared_int8</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN725"></a>    <a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>key</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN246"><span class='Ref_to_Macro'>PG_GETARG_INT64</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN726"></a>    <a href="../../../include/storage/lock.h.html#LN178"><span class='Ref_to_Struct'>LOCKTAG</span></a>     <span class='Declare_Local'>tag</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN657"><span class='Ref_to_Func'>PreventAdvisoryLocksInParallelMode</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN648"><span class='Ref_to_Macro'>SET_LOCKTAG_INT64</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN726"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN725"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="../../../include/storage/lock.h.html#LN523"><span class='Ref_to_Proto'>LockAcquire</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="lockfuncs.c.html#LN726"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="../../../include/storage/lockdefs.h.html#LN40"><span class='Ref_to_Const'>ShareLock</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN308"><span class='Ref_to_Macro'>PG_RETURN_VOID</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pg_try_advisory_lock(int8) - acquire exclusive lock on an int8 key, no wait 
 * 
 * Returns true if successful, false if lock not available 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN742"></a><span class='Declare_Function'>pg_try_advisory_lock_int8</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN744"></a>    <a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>key</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN246"><span class='Ref_to_Macro'>PG_GETARG_INT64</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN745"></a>    <a href="../../../include/storage/lock.h.html#LN178"><span class='Ref_to_Struct'>LOCKTAG</span></a>     <span class='Declare_Local'>tag</span><span class='Delimiter'>; 
</span><a name="LN746"></a>    <a href="../../../include/storage/lock.h.html#LN471"><span class='Ref_to_Typedef'>LockAcquireResult</span></a> <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN657"><span class='Ref_to_Func'>PreventAdvisoryLocksInParallelMode</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN648"><span class='Ref_to_Macro'>SET_LOCKTAG_INT64</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN745"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN744"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN746"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="../../../include/storage/lock.h.html#LN523"><span class='Ref_to_Proto'>LockAcquire</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="lockfuncs.c.html#LN745"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="../../../include/storage/lockdefs.h.html#LN43"><span class='Ref_to_Const'>ExclusiveLock</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN746"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>!= </span><a href="../../../include/storage/lock.h.html#LN473"><span class='Ref_to_EnumConst'>LOCKACQUIRE_NOT_AVAIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pg_try_advisory_xact_lock(int8) - acquire xact scoped 
 * exclusive lock on an int8 key, no wait 
 * 
 * Returns true if successful, false if lock not available 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN763"></a><span class='Declare_Function'>pg_try_advisory_xact_lock_int8</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN765"></a>    <a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>key</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN246"><span class='Ref_to_Macro'>PG_GETARG_INT64</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN766"></a>    <a href="../../../include/storage/lock.h.html#LN178"><span class='Ref_to_Struct'>LOCKTAG</span></a>     <span class='Declare_Local'>tag</span><span class='Delimiter'>; 
</span><a name="LN767"></a>    <a href="../../../include/storage/lock.h.html#LN471"><span class='Ref_to_Typedef'>LockAcquireResult</span></a> <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN657"><span class='Ref_to_Func'>PreventAdvisoryLocksInParallelMode</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN648"><span class='Ref_to_Macro'>SET_LOCKTAG_INT64</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN766"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN765"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN767"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="../../../include/storage/lock.h.html#LN523"><span class='Ref_to_Proto'>LockAcquire</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="lockfuncs.c.html#LN766"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="../../../include/storage/lockdefs.h.html#LN43"><span class='Ref_to_Const'>ExclusiveLock</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN767"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>!= </span><a href="../../../include/storage/lock.h.html#LN473"><span class='Ref_to_EnumConst'>LOCKACQUIRE_NOT_AVAIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pg_try_advisory_lock_shared(int8) - acquire share lock on an int8 key, no wait 
 * 
 * Returns true if successful, false if lock not available 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN783"></a><span class='Declare_Function'>pg_try_advisory_lock_shared_int8</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN785"></a>    <a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>key</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN246"><span class='Ref_to_Macro'>PG_GETARG_INT64</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN786"></a>    <a href="../../../include/storage/lock.h.html#LN178"><span class='Ref_to_Struct'>LOCKTAG</span></a>     <span class='Declare_Local'>tag</span><span class='Delimiter'>; 
</span><a name="LN787"></a>    <a href="../../../include/storage/lock.h.html#LN471"><span class='Ref_to_Typedef'>LockAcquireResult</span></a> <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN657"><span class='Ref_to_Func'>PreventAdvisoryLocksInParallelMode</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN648"><span class='Ref_to_Macro'>SET_LOCKTAG_INT64</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN786"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN785"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN787"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="../../../include/storage/lock.h.html#LN523"><span class='Ref_to_Proto'>LockAcquire</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="lockfuncs.c.html#LN786"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="../../../include/storage/lockdefs.h.html#LN40"><span class='Ref_to_Const'>ShareLock</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN787"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>!= </span><a href="../../../include/storage/lock.h.html#LN473"><span class='Ref_to_EnumConst'>LOCKACQUIRE_NOT_AVAIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pg_try_advisory_xact_lock_shared(int8) - acquire xact scoped 
 * share lock on an int8 key, no wait 
 * 
 * Returns true if successful, false if lock not available 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN804"></a><span class='Declare_Function'>pg_try_advisory_xact_lock_shared_int8</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN806"></a>    <a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>key</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN246"><span class='Ref_to_Macro'>PG_GETARG_INT64</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN807"></a>    <a href="../../../include/storage/lock.h.html#LN178"><span class='Ref_to_Struct'>LOCKTAG</span></a>     <span class='Declare_Local'>tag</span><span class='Delimiter'>; 
</span><a name="LN808"></a>    <a href="../../../include/storage/lock.h.html#LN471"><span class='Ref_to_Typedef'>LockAcquireResult</span></a> <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN657"><span class='Ref_to_Func'>PreventAdvisoryLocksInParallelMode</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN648"><span class='Ref_to_Macro'>SET_LOCKTAG_INT64</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN807"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN806"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN808"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="../../../include/storage/lock.h.html#LN523"><span class='Ref_to_Proto'>LockAcquire</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="lockfuncs.c.html#LN807"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="../../../include/storage/lockdefs.h.html#LN40"><span class='Ref_to_Const'>ShareLock</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN808"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>!= </span><a href="../../../include/storage/lock.h.html#LN473"><span class='Ref_to_EnumConst'>LOCKACQUIRE_NOT_AVAIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pg_advisory_unlock(int8) - release exclusive lock on an int8 key 
 * 
 * Returns true if successful, false if lock was not held 
*/ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN824"></a><span class='Declare_Function'>pg_advisory_unlock_int8</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN826"></a>    <a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>key</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN246"><span class='Ref_to_Macro'>PG_GETARG_INT64</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN827"></a>    <a href="../../../include/storage/lock.h.html#LN178"><span class='Ref_to_Struct'>LOCKTAG</span></a>     <span class='Declare_Local'>tag</span><span class='Delimiter'>; 
</span><a name="LN828"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN657"><span class='Ref_to_Func'>PreventAdvisoryLocksInParallelMode</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN648"><span class='Ref_to_Macro'>SET_LOCKTAG_INT64</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN827"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN826"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN828"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="../../../include/storage/lock.h.html#LN533"><span class='Ref_to_Proto'>LockRelease</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="lockfuncs.c.html#LN827"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="../../../include/storage/lockdefs.h.html#LN43"><span class='Ref_to_Const'>ExclusiveLock</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN828"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pg_advisory_unlock_shared(int8) - release share lock on an int8 key 
 * 
 * Returns true if successful, false if lock was not held 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN844"></a><span class='Declare_Function'>pg_advisory_unlock_shared_int8</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN846"></a>    <a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>key</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN246"><span class='Ref_to_Macro'>PG_GETARG_INT64</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN847"></a>    <a href="../../../include/storage/lock.h.html#LN178"><span class='Ref_to_Struct'>LOCKTAG</span></a>     <span class='Declare_Local'>tag</span><span class='Delimiter'>; 
</span><a name="LN848"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN657"><span class='Ref_to_Func'>PreventAdvisoryLocksInParallelMode</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN648"><span class='Ref_to_Macro'>SET_LOCKTAG_INT64</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN847"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN846"><span class='Ref_To_Local'>key</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN848"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="../../../include/storage/lock.h.html#LN533"><span class='Ref_to_Proto'>LockRelease</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="lockfuncs.c.html#LN847"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="../../../include/storage/lockdefs.h.html#LN40"><span class='Ref_to_Const'>ShareLock</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN848"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pg_advisory_lock(int4, int4) - acquire exclusive lock on 2 int4 keys 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN862"></a><span class='Declare_Function'>pg_advisory_lock_int4</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN864"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>key1</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN865"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>key2</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN866"></a>    <a href="../../../include/storage/lock.h.html#LN178"><span class='Ref_to_Struct'>LOCKTAG</span></a>     <span class='Declare_Local'>tag</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN657"><span class='Ref_to_Func'>PreventAdvisoryLocksInParallelMode</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN654"><span class='Ref_to_Macro'>SET_LOCKTAG_INT32</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN866"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN864"><span class='Ref_To_Local'>key1</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN865"><span class='Ref_To_Local'>key2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="../../../include/storage/lock.h.html#LN523"><span class='Ref_to_Proto'>LockAcquire</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="lockfuncs.c.html#LN866"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="../../../include/storage/lockdefs.h.html#LN43"><span class='Ref_to_Const'>ExclusiveLock</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN308"><span class='Ref_to_Macro'>PG_RETURN_VOID</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pg_advisory_xact_lock(int4, int4) - acquire xact scoped 
 * exclusive lock on 2 int4 keys 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN881"></a><span class='Declare_Function'>pg_advisory_xact_lock_int4</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN883"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>key1</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN884"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>key2</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN885"></a>    <a href="../../../include/storage/lock.h.html#LN178"><span class='Ref_to_Struct'>LOCKTAG</span></a>     <span class='Declare_Local'>tag</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN657"><span class='Ref_to_Func'>PreventAdvisoryLocksInParallelMode</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN654"><span class='Ref_to_Macro'>SET_LOCKTAG_INT32</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN885"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN883"><span class='Ref_To_Local'>key1</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN884"><span class='Ref_To_Local'>key2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="../../../include/storage/lock.h.html#LN523"><span class='Ref_to_Proto'>LockAcquire</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="lockfuncs.c.html#LN885"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="../../../include/storage/lockdefs.h.html#LN43"><span class='Ref_to_Const'>ExclusiveLock</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN308"><span class='Ref_to_Macro'>PG_RETURN_VOID</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pg_advisory_lock_shared(int4, int4) - acquire share lock on 2 int4 keys 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN899"></a><span class='Declare_Function'>pg_advisory_lock_shared_int4</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN901"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>key1</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN902"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>key2</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN903"></a>    <a href="../../../include/storage/lock.h.html#LN178"><span class='Ref_to_Struct'>LOCKTAG</span></a>     <span class='Declare_Local'>tag</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN657"><span class='Ref_to_Func'>PreventAdvisoryLocksInParallelMode</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN654"><span class='Ref_to_Macro'>SET_LOCKTAG_INT32</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN903"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN901"><span class='Ref_To_Local'>key1</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN902"><span class='Ref_To_Local'>key2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="../../../include/storage/lock.h.html#LN523"><span class='Ref_to_Proto'>LockAcquire</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="lockfuncs.c.html#LN903"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="../../../include/storage/lockdefs.h.html#LN40"><span class='Ref_to_Const'>ShareLock</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN308"><span class='Ref_to_Macro'>PG_RETURN_VOID</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pg_advisory_xact_lock_shared(int4, int4) - acquire xact scoped 
 * share lock on 2 int4 keys 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN918"></a><span class='Declare_Function'>pg_advisory_xact_lock_shared_int4</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN920"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>key1</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN921"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>key2</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN922"></a>    <a href="../../../include/storage/lock.h.html#LN178"><span class='Ref_to_Struct'>LOCKTAG</span></a>     <span class='Declare_Local'>tag</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN657"><span class='Ref_to_Func'>PreventAdvisoryLocksInParallelMode</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN654"><span class='Ref_to_Macro'>SET_LOCKTAG_INT32</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN922"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN920"><span class='Ref_To_Local'>key1</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN921"><span class='Ref_To_Local'>key2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="../../../include/storage/lock.h.html#LN523"><span class='Ref_to_Proto'>LockAcquire</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="lockfuncs.c.html#LN922"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="../../../include/storage/lockdefs.h.html#LN40"><span class='Ref_to_Const'>ShareLock</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN308"><span class='Ref_to_Macro'>PG_RETURN_VOID</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pg_try_advisory_lock(int4, int4) - acquire exclusive lock on 2 int4 keys, no wait 
 * 
 * Returns true if successful, false if lock not available 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN938"></a><span class='Declare_Function'>pg_try_advisory_lock_int4</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN940"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>key1</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN941"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>key2</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN942"></a>    <a href="../../../include/storage/lock.h.html#LN178"><span class='Ref_to_Struct'>LOCKTAG</span></a>     <span class='Declare_Local'>tag</span><span class='Delimiter'>; 
</span><a name="LN943"></a>    <a href="../../../include/storage/lock.h.html#LN471"><span class='Ref_to_Typedef'>LockAcquireResult</span></a> <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN657"><span class='Ref_to_Func'>PreventAdvisoryLocksInParallelMode</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN654"><span class='Ref_to_Macro'>SET_LOCKTAG_INT32</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN942"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN940"><span class='Ref_To_Local'>key1</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN941"><span class='Ref_To_Local'>key2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN943"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="../../../include/storage/lock.h.html#LN523"><span class='Ref_to_Proto'>LockAcquire</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="lockfuncs.c.html#LN942"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="../../../include/storage/lockdefs.h.html#LN43"><span class='Ref_to_Const'>ExclusiveLock</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN943"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>!= </span><a href="../../../include/storage/lock.h.html#LN473"><span class='Ref_to_EnumConst'>LOCKACQUIRE_NOT_AVAIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pg_try_advisory_xact_lock(int4, int4) - acquire xact scoped 
 * exclusive lock on 2 int4 keys, no wait 
 * 
 * Returns true if successful, false if lock not available 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN960"></a><span class='Declare_Function'>pg_try_advisory_xact_lock_int4</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN962"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>key1</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN963"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>key2</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN964"></a>    <a href="../../../include/storage/lock.h.html#LN178"><span class='Ref_to_Struct'>LOCKTAG</span></a>     <span class='Declare_Local'>tag</span><span class='Delimiter'>; 
</span><a name="LN965"></a>    <a href="../../../include/storage/lock.h.html#LN471"><span class='Ref_to_Typedef'>LockAcquireResult</span></a> <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN657"><span class='Ref_to_Func'>PreventAdvisoryLocksInParallelMode</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN654"><span class='Ref_to_Macro'>SET_LOCKTAG_INT32</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN964"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN962"><span class='Ref_To_Local'>key1</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN963"><span class='Ref_To_Local'>key2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN965"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="../../../include/storage/lock.h.html#LN523"><span class='Ref_to_Proto'>LockAcquire</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="lockfuncs.c.html#LN964"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="../../../include/storage/lockdefs.h.html#LN43"><span class='Ref_to_Const'>ExclusiveLock</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN965"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>!= </span><a href="../../../include/storage/lock.h.html#LN473"><span class='Ref_to_EnumConst'>LOCKACQUIRE_NOT_AVAIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pg_try_advisory_lock_shared(int4, int4) - acquire share lock on 2 int4 keys, no wait 
 * 
 * Returns true if successful, false if lock not available 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN981"></a><span class='Declare_Function'>pg_try_advisory_lock_shared_int4</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN983"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>key1</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN984"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>key2</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN985"></a>    <a href="../../../include/storage/lock.h.html#LN178"><span class='Ref_to_Struct'>LOCKTAG</span></a>     <span class='Declare_Local'>tag</span><span class='Delimiter'>; 
</span><a name="LN986"></a>    <a href="../../../include/storage/lock.h.html#LN471"><span class='Ref_to_Typedef'>LockAcquireResult</span></a> <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN657"><span class='Ref_to_Func'>PreventAdvisoryLocksInParallelMode</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN654"><span class='Ref_to_Macro'>SET_LOCKTAG_INT32</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN985"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN983"><span class='Ref_To_Local'>key1</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN984"><span class='Ref_To_Local'>key2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN986"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="../../../include/storage/lock.h.html#LN523"><span class='Ref_to_Proto'>LockAcquire</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="lockfuncs.c.html#LN985"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="../../../include/storage/lockdefs.h.html#LN40"><span class='Ref_to_Const'>ShareLock</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN986"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>!= </span><a href="../../../include/storage/lock.h.html#LN473"><span class='Ref_to_EnumConst'>LOCKACQUIRE_NOT_AVAIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pg_try_advisory_xact_lock_shared(int4, int4) - acquire xact scoped 
 * share lock on 2 int4 keys, no wait 
 * 
 * Returns true if successful, false if lock not available 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1003"></a><span class='Declare_Function'>pg_try_advisory_xact_lock_shared_int4</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1005"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>key1</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1006"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>key2</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1007"></a>    <a href="../../../include/storage/lock.h.html#LN178"><span class='Ref_to_Struct'>LOCKTAG</span></a>     <span class='Declare_Local'>tag</span><span class='Delimiter'>; 
</span><a name="LN1008"></a>    <a href="../../../include/storage/lock.h.html#LN471"><span class='Ref_to_Typedef'>LockAcquireResult</span></a> <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN657"><span class='Ref_to_Func'>PreventAdvisoryLocksInParallelMode</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN654"><span class='Ref_to_Macro'>SET_LOCKTAG_INT32</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN1007"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN1005"><span class='Ref_To_Local'>key1</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN1006"><span class='Ref_To_Local'>key2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN1008"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="../../../include/storage/lock.h.html#LN523"><span class='Ref_to_Proto'>LockAcquire</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="lockfuncs.c.html#LN1007"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="../../../include/storage/lockdefs.h.html#LN40"><span class='Ref_to_Const'>ShareLock</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN1008"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>!= </span><a href="../../../include/storage/lock.h.html#LN473"><span class='Ref_to_EnumConst'>LOCKACQUIRE_NOT_AVAIL</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pg_advisory_unlock(int4, int4) - release exclusive lock on 2 int4 keys 
 * 
 * Returns true if successful, false if lock was not held 
*/ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1024"></a><span class='Declare_Function'>pg_advisory_unlock_int4</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1026"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>key1</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1027"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>key2</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1028"></a>    <a href="../../../include/storage/lock.h.html#LN178"><span class='Ref_to_Struct'>LOCKTAG</span></a>     <span class='Declare_Local'>tag</span><span class='Delimiter'>; 
</span><a name="LN1029"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN657"><span class='Ref_to_Func'>PreventAdvisoryLocksInParallelMode</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN654"><span class='Ref_to_Macro'>SET_LOCKTAG_INT32</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN1028"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN1026"><span class='Ref_To_Local'>key1</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN1027"><span class='Ref_To_Local'>key2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN1029"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="../../../include/storage/lock.h.html#LN533"><span class='Ref_to_Proto'>LockRelease</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="lockfuncs.c.html#LN1028"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="../../../include/storage/lockdefs.h.html#LN43"><span class='Ref_to_Const'>ExclusiveLock</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN1029"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pg_advisory_unlock_shared(int4, int4) - release share lock on 2 int4 keys 
 * 
 * Returns true if successful, false if lock was not held 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1045"></a><span class='Declare_Function'>pg_advisory_unlock_shared_int4</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1047"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>key1</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1048"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>key2</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1049"></a>    <a href="../../../include/storage/lock.h.html#LN178"><span class='Ref_to_Struct'>LOCKTAG</span></a>     <span class='Declare_Local'>tag</span><span class='Delimiter'>; 
</span><a name="LN1050"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN657"><span class='Ref_to_Func'>PreventAdvisoryLocksInParallelMode</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="lockfuncs.c.html#LN654"><span class='Ref_to_Macro'>SET_LOCKTAG_INT32</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN1049"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN1047"><span class='Ref_To_Local'>key1</span></a><span class='Delimiter'>, </span><a href="lockfuncs.c.html#LN1048"><span class='Ref_To_Local'>key2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="lockfuncs.c.html#LN1050"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="../../../include/storage/lock.h.html#LN533"><span class='Ref_to_Proto'>LockRelease</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="lockfuncs.c.html#LN1049"><span class='Ref_To_Local'>tag</span></a><span class='Delimiter'>, </span><a href="../../../include/storage/lockdefs.h.html#LN40"><span class='Ref_to_Const'>ShareLock</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="lockfuncs.c.html#LN1050"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pg_advisory_unlock_all() - release all advisory locks 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1064"></a><span class='Declare_Function'>pg_advisory_unlock_all</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="../../../include/storage/lock.h.html#LN536"><span class='Ref_to_Proto'>LockReleaseSession</span></a><span class='Parentheses'>(</span><a href="../../../include/storage/lock.h.html#LN129"><span class='Ref_to_Const'>USER_LOCKMETHOD</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN308"><span class='Ref_to_Macro'>PG_RETURN_VOID</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
} 
</span></pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>