<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\backend\utils\adt\misc.c</title>
<LINK REL=StyleSheet HREF="../../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\backend\utils\adt\misc.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:52 2017
</td></tr>
<tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * misc.c 
 * 
 * 
 * Portions Copyright (c) 1996-2017, PostgreSQL Global Development Group 
 * Portions Copyright (c) 1994, Regents of the University of California 
 * 
 * 
 * IDENTIFICATION 
 *    src/backend/utils/adt/misc.c 
 * 
 *------------------------------------------------------------------------- 
 */ 
</span><span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>&LT;sys/file.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;signal.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;dirent.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;math.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;unistd.h&GT;</span> 
 
<span class='Keyword'>#include </span><span class='String'>"access/sysattr.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_authid.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/catalog.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_tablespace.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"catalog/pg_type.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"commands/dbcommands.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"common/keywords.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"funcapi.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"miscadmin.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"pgstat.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"parser/scansup.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"postmaster/syslogger.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"rewrite/rewriteHandler.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"storage/fd.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"storage/pmsignal.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"storage/proc.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"storage/procarray.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/lsyscache.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/ruleutils.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"tcop/tcopprot.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/acl.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/builtins.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/timestamp.h"</span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * Common subroutine for num_nulls() and num_nonnulls(). 
 * Returns TRUE if successful, FALSE if function should return NULL. 
 * If successful, total argument count and number of nulls are 
 * returned into *nargs and *nulls. 
 */ 
</span><span class='Keyword'>static bool 
</span><a name="LN54"></a><span class='Declare_Function'>count_nulls</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN37"><span class='Ref_to_Typedef'>FunctionCallInfo</span></a> <span class='Declare_Parameter'>fcinfo</span><span class='Delimiter'>, 
</span><a name="LN55"></a>            <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>nargs</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>nulls</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN57"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>count</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN58"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Did we get a VARIADIC array argument, or separate arguments? */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN667"><span class='Ref_to_Proto'>get_fn_expr_variadic</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN54"><span class='Ref_to_Parameter'>fcinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/fmgr.h.html#LN78"><span class='Ref_to_Member'>flinfo</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN63"></a>        <a href="../../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>arr</span><span class='Delimiter'>; 
</span><a name="LN64"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>ndims</span><span class='Delimiter'>, 
</span><a name="LN65"></a>                    <span class='Declare_Local'>nitems</span><span class='Delimiter'>, 
</span><a name="LN66"></a>                   <span class='Operator'>*</span><span class='Declare_Local'>dims</span><span class='Delimiter'>; 
</span><a name="LN67"></a>        <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>bitmap</span><span class='Delimiter'>; 
</span> 
        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN167"><span class='Ref_to_Macro'>PG_NARGS</span></a><span class='Parentheses'>() </span><span class='Operator'>== </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If we get a null as VARIADIC array argument, we can't say anything 
         * useful about the number of elements, so return NULL.  This behavior 
         * is consistent with other variadic functions - see concat_internal. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN173"><span class='Ref_to_Macro'>PG_ARGISNULL</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Non-null argument had better be an array.  We assume that any call 
         * context that could let get_fn_expr_variadic return true will have 
         * checked that a VARIADIC-labeled parameter actually is an array.  So 
         * it should be okay to just Assert that it's an array rather than 
         * doing a full-fledged error check. 
         */ 
</span>        <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/lsyscache.h.html#LN160"><span class='Ref_to_Proto'>get_base_element_type</span></a><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN663"><span class='Ref_to_Proto'>get_fn_expr_argtype</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN54"><span class='Ref_to_Parameter'>fcinfo</span></a><span class='Operator'>-&GT;</span><a href="../../../include/fmgr.h.html#LN78"><span class='Ref_to_Member'>flinfo</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* OK, safe to fetch the array value */ 
</span>        <a href="misc.c.html#LN63"><span class='Ref_To_Local'>arr</span></a> <span class='Operator'>= </span><a href="../../../include/utils/array.h.html#LN243"><span class='Ref_to_Macro'>PG_GETARG_ARRAYTYPE_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Count the array elements */ 
</span>        <a href="misc.c.html#LN64"><span class='Ref_To_Local'>ndims</span></a> <span class='Operator'>= </span><a href="../../../include/utils/array.h.html#LN270"><span class='Ref_to_Macro'>ARR_NDIM</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN63"><span class='Ref_To_Local'>arr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="misc.c.html#LN66"><span class='Ref_To_Local'>dims</span></a> <span class='Operator'>= </span><a href="../../../include/utils/array.h.html#LN274"><span class='Ref_to_Macro'>ARR_DIMS</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN63"><span class='Ref_To_Local'>arr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="misc.c.html#LN65"><span class='Ref_To_Local'>nitems</span></a> <span class='Operator'>= </span><a href="arrayutils.c.html#LN73"><span class='Ref_to_Func'>ArrayGetNItems</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN64"><span class='Ref_To_Local'>ndims</span></a><span class='Delimiter'>, </span><a href="misc.c.html#LN66"><span class='Ref_To_Local'>dims</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Count those that are NULL */ 
</span>        <a href="misc.c.html#LN67"><span class='Ref_To_Local'>bitmap</span></a> <span class='Operator'>= </span><a href="../../../include/utils/array.h.html#LN280"><span class='Ref_to_Macro'>ARR_NULLBITMAP</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN63"><span class='Ref_To_Local'>arr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN67"><span class='Ref_To_Local'>bitmap</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN100"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>bitmask</span> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN58"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="misc.c.html#LN58"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="misc.c.html#LN65"><span class='Ref_To_Local'>nitems</span></a><span class='Delimiter'>; </span><a href="misc.c.html#LN58"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>*</span><a href="misc.c.html#LN67"><span class='Ref_To_Local'>bitmap</span></a> <span class='Operator'>& </span><a href="misc.c.html#LN100"><span class='Ref_To_Local'>bitmask</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                    <a href="misc.c.html#LN57"><span class='Ref_To_Local'>count</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span> 
                <a href="misc.c.html#LN100"><span class='Ref_To_Local'>bitmask</span></a> <span class='Operator'>&LT;&LT;= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN100"><span class='Ref_To_Local'>bitmask</span></a> <span class='Operator'>== </span><span class='Number'>0x100</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <a href="misc.c.html#LN67"><span class='Ref_To_Local'>bitmap</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                    <a href="misc.c.html#LN100"><span class='Ref_To_Local'>bitmask</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Operator'>*</span><a href="misc.c.html#LN55"><span class='Ref_to_Parameter'>nargs</span></a> <span class='Operator'>= </span><a href="misc.c.html#LN65"><span class='Ref_To_Local'>nitems</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="misc.c.html#LN55"><span class='Ref_to_Parameter'>nulls</span></a> <span class='Operator'>= </span><a href="misc.c.html#LN57"><span class='Ref_To_Local'>count</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if get_fn_expr_variadic(... &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Separate arguments, so just count 'em */ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN58"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="misc.c.html#LN58"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="../../../include/fmgr.h.html#LN167"><span class='Ref_to_Macro'>PG_NARGS</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; </span><a href="misc.c.html#LN58"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN173"><span class='Ref_to_Macro'>PG_ARGISNULL</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN58"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> 
                <a href="misc.c.html#LN57"><span class='Ref_To_Local'>count</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Operator'>*</span><a href="misc.c.html#LN55"><span class='Ref_to_Parameter'>nargs</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN167"><span class='Ref_to_Macro'>PG_NARGS</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="misc.c.html#LN55"><span class='Ref_to_Parameter'>nulls</span></a> <span class='Operator'>= </span><a href="misc.c.html#LN57"><span class='Ref_To_Local'>count</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end count_nulls &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * num_nulls() 
 *  Count the number of NULL arguments 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN140"></a><span class='Declare_Function'>pg_num_nulls</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN142"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>nargs</span><span class='Delimiter'>, 
</span><a name="LN143"></a>                <span class='Declare_Local'>nulls</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="misc.c.html#LN53"><span class='Ref_to_Func'>count_nulls</span></a><span class='Parentheses'>(</span>fcinfo<span class='Delimiter'>, </span><span class='Operator'>&</span><a href="misc.c.html#LN142"><span class='Ref_To_Local'>nargs</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="misc.c.html#LN143"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN143"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * num_nonnulls() 
 *  Count the number of non-NULL arguments 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN156"></a><span class='Declare_Function'>pg_num_nonnulls</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN158"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>nargs</span><span class='Delimiter'>, 
</span><a name="LN159"></a>                <span class='Declare_Local'>nulls</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="misc.c.html#LN53"><span class='Ref_to_Func'>count_nulls</span></a><span class='Parentheses'>(</span>fcinfo<span class='Delimiter'>, </span><span class='Operator'>&</span><a href="misc.c.html#LN158"><span class='Ref_To_Local'>nargs</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="misc.c.html#LN159"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN158"><span class='Ref_To_Local'>nargs</span></a> <span class='Operator'>- </span><a href="misc.c.html#LN159"><span class='Ref_To_Local'>nulls</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * current_database() 
 *  Expose the current database to the user 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN173"></a><span class='Declare_Function'>current_database</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN175"></a>    <a href="../../../include/c.h.html#LN496"><span class='Ref_to_Typedef'>Name</span></a>        <span class='Declare_Local'>db</span><span class='Delimiter'>; 
</span> 
    <a href="misc.c.html#LN175"><span class='Ref_To_Local'>db</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN496"><span class='Ref_to_Typedef'>Name</span></a><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="../../../interfaces/ecpg/include/sqlda-native.h.html#LN15"><span class='Ref_to_Const'>NAMEDATALEN</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/builtins.h.html#LN40"><span class='Ref_to_Proto'>namestrcpy</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN175"><span class='Ref_To_Local'>db</span></a><span class='Delimiter'>, </span><a href="../../../include/commands/dbcommands.h.html#LN29"><span class='Ref_to_Proto'>get_database_name</span></a><span class='Parentheses'>(</span><a href="../init/globals.c.html#LN76"><span class='Ref_to_Global_Var'>MyDatabaseId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN322"><span class='Ref_to_Macro'>PG_RETURN_NAME</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN175"><span class='Ref_To_Local'>db</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * current_query() 
 *  Expose the current query to the user (useful in stored procedures) 
 *  We might want to use ActivePortal-&GT;sourceText someday. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN190"></a><span class='Declare_Function'>current_query</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* there is no easy way to access the more concise 'query_string' */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../tcop/postgres.c.html#LN84"><span class='Ref_to_Global_Var'>debug_query_string</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/fmgr.h.html#LN329"><span class='Ref_to_Macro'>PG_RETURN_TEXT_P</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/builtins.h.html#LN85"><span class='Ref_to_Proto'>cstring_to_text</span></a><span class='Parentheses'>(</span><a href="../../tcop/postgres.c.html#LN84"><span class='Ref_to_Global_Var'>debug_query_string</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Send a signal to another backend. 
 * 
 * The signal is delivered if the user is either a superuser or the same 
 * role as the backend being signaled. For "dangerous" signals, an explicit 
 * check for superuser needs to be done prior to calling this function. 
 * 
 * Returns 0 on success, 1 on general failure, 2 on normal permission error 
 * and 3 if the caller needs to be a superuser. 
 * 
 * In the event of a general failure (return code 1), a warning message will 
 * be emitted. For permission errors, doing that is the responsibility of 
 * the caller. 
 */ 
</span><a name="LN213"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>SIGNAL_BACKEND_SUCCESS</span> <span class='Number'>0</span> 
<a name="LN214"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>SIGNAL_BACKEND_ERROR</span> <span class='Number'>1</span> 
<a name="LN215"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>SIGNAL_BACKEND_NOPERMISSION</span> <span class='Number'>2</span> 
<a name="LN216"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>SIGNAL_BACKEND_NOSUPERUSER</span> <span class='Number'>3</span> 
<span class='Keyword'>static int 
</span><a name="LN218"></a><span class='Declare_Function'>pg_signal_backend</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>pid</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>sig</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN220"></a>    <a href="../../../include/storage/proc.h.html#LN93"><span class='Ref_to_Struct'>PGPROC</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>proc</span> <span class='Operator'>= </span><a href="../../../include/storage/procarray.h.html#LN98"><span class='Ref_to_Proto'>BackendPidGetProc</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN218"><span class='Ref_to_Parameter'>pid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * BackendPidGetProc returns NULL if the pid isn't valid; but by the time 
     * we reach kill(), a process for which we get a valid proc here might 
     * have terminated on its own.  There's no way to acquire a lock on an 
     * arbitrary process to prevent that. But since so far all the callers of 
     * this mechanism involve some request for ending the process anyway, that 
     * it might end on its own first is not a problem. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN220"><span class='Ref_To_Local'>proc</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * This is just a warning so a loop-through-resultset will not abort 
         * if one backend terminated on its own during the run. 
         */ 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN39"><span class='Ref_to_Const'>WARNING</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"PID %d is not a PostgreSQL server process"</span><span class='Delimiter'>, </span><a href="misc.c.html#LN218"><span class='Ref_to_Parameter'>pid</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="misc.c.html#LN214"><span class='Ref_to_Const'>SIGNAL_BACKEND_ERROR</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Only allow superusers to signal superuser-owned backends. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../misc/superuser.c.html#LN55"><span class='Ref_to_Func'>superuser_arg</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN220"><span class='Ref_To_Local'>proc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/proc.h.html#LN113"><span class='Ref_to_Member'>roleId</span></a><span class='Parentheses'>) </span><span class='Operator'>&& !</span><a href="../misc/superuser.c.html#LN45"><span class='Ref_to_Func'>superuser</span></a><span class='Parentheses'>())</span> 
        <span class='Control'>return</span> <a href="misc.c.html#LN216"><span class='Ref_to_Const'>SIGNAL_BACKEND_NOSUPERUSER</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Users can signal backends they have role membership in. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/utils/acl.h.html#LN229"><span class='Ref_to_Proto'>has_privs_of_role</span></a><span class='Parentheses'>(</span><a href="../init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, </span><a href="misc.c.html#LN220"><span class='Ref_To_Local'>proc</span></a><span class='Operator'>-&GT;</span><a href="../../../include/storage/proc.h.html#LN113"><span class='Ref_to_Member'>roleId</span></a><span class='Parentheses'>)</span> <span class='Operator'>&& 
</span>        <span class='Operator'>!</span><a href="../../../include/utils/acl.h.html#LN229"><span class='Ref_to_Proto'>has_privs_of_role</span></a><span class='Parentheses'>(</span><a href="../init/miscinit.c.html#LN281"><span class='Ref_to_Func'>GetUserId</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, </span><a href="../../../include/catalog/pg_authid.h.html#LN111"><span class='Ref_to_Const'>DEFAULT_ROLE_SIGNAL_BACKENDID</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <a href="misc.c.html#LN215"><span class='Ref_to_Const'>SIGNAL_BACKEND_NOPERMISSION</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Can the process we just validated above end, followed by the pid being 
     * recycled for a new process, before reaching here?  Then we'd be trying 
     * to kill the wrong thing.  Seems near impossible when sequential pid 
     * assignment and wraparound is used.  Perhaps it could happen on a system 
     * where pid re-use is randomized.  That race condition possibility seems 
     * too unlikely to worry about. 
     */ 
</span> 
    <span class='Comment_Multi_Line'>/* If we have setsid(), signal the backend's whole process group */ 
</span><span class='Directive'>#ifdef</span> HAVE_SETSID 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/port.h.html#LN210"><span class='Ref_to_Macro'>kill</span></a><span class='Parentheses'>(</span><span class='Operator'>-</span><a href="misc.c.html#LN218"><span class='Ref_to_Parameter'>pid</span></a><span class='Delimiter'>, </span><a href="misc.c.html#LN218"><span class='Ref_to_Parameter'>sig</span></a><span class='Parentheses'>))</span> 
<span class='Directive'>#else</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/port.h.html#LN210"><span class='Ref_to_Macro'>kill</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN218"><span class='Ref_to_Parameter'>pid</span></a><span class='Delimiter'>, </span><a href="misc.c.html#LN218"><span class='Ref_to_Parameter'>sig</span></a><span class='Parentheses'>))</span> 
<span class='Directive'>#endif</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Again, just a warning to allow loops */ 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN39"><span class='Ref_to_Const'>WARNING</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"could not send signal to process %d: %m"</span><span class='Delimiter'>, </span><a href="misc.c.html#LN218"><span class='Ref_to_Parameter'>pid</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="misc.c.html#LN214"><span class='Ref_to_Const'>SIGNAL_BACKEND_ERROR</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="misc.c.html#LN213"><span class='Ref_to_Const'>SIGNAL_BACKEND_SUCCESS</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_signal_backend &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Signal to cancel a backend process.  This is allowed if you are a member of 
 * the role whose process is being canceled. 
 * 
 * Note that only superusers can signal superuser-owned processes. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN281"></a><span class='Declare_Function'>pg_cancel_backend</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN283"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>r</span> <span class='Operator'>= </span><a href="misc.c.html#LN217"><span class='Ref_to_Func'>pg_signal_backend</span></a><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span>SIGINT<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN283"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>== </span><a href="misc.c.html#LN216"><span class='Ref_to_Const'>SIGNAL_BACKEND_NOSUPERUSER</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INSUFFICIENT_PRIVILEGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <span class='Parentheses'>(</span><a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"must be a superuser to cancel superuser query"</span><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN283"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>== </span><a href="misc.c.html#LN215"><span class='Ref_to_Const'>SIGNAL_BACKEND_NOPERMISSION</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INSUFFICIENT_PRIVILEGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <span class='Parentheses'>(</span><a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"must be a member of the role whose query is being canceled or member of pg_signal_backend"</span><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN283"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>== </span><a href="misc.c.html#LN213"><span class='Ref_to_Const'>SIGNAL_BACKEND_SUCCESS</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Signal to terminate a backend process.  This is allowed if you are a member 
 * of the role whose process is being terminated. 
 * 
 * Note that only superusers can signal superuser-owned processes. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN305"></a><span class='Declare_Function'>pg_terminate_backend</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN307"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>r</span> <span class='Operator'>= </span><a href="misc.c.html#LN217"><span class='Ref_to_Func'>pg_signal_backend</span></a><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span>SIGTERM<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN307"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>== </span><a href="misc.c.html#LN216"><span class='Ref_to_Const'>SIGNAL_BACKEND_NOSUPERUSER</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INSUFFICIENT_PRIVILEGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>            <span class='Parentheses'>(</span><a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"must be a superuser to terminate superuser process"</span><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN307"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>== </span><a href="misc.c.html#LN215"><span class='Ref_to_Const'>SIGNAL_BACKEND_NOPERMISSION</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INSUFFICIENT_PRIVILEGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <span class='Parentheses'>(</span><a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"must be a member of the role whose process is being terminated or member of pg_signal_backend"</span><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN307"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>== </span><a href="misc.c.html#LN213"><span class='Ref_to_Const'>SIGNAL_BACKEND_SUCCESS</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Signal to reload the database configuration 
 * 
 * Permission checking for this function is managed through the normal 
 * GRANT system. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN329"></a><span class='Declare_Function'>pg_reload_conf</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/port.h.html#LN210"><span class='Ref_to_Macro'>kill</span></a><span class='Parentheses'>(</span><a href="../init/globals.c.html#LN86"><span class='Ref_to_Global_Var'>PostmasterPid</span></a><span class='Delimiter'>, </span><a href="../../../include/port/win32.h.html#LN187"><span class='Ref_to_Const'>SIGHUP</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN39"><span class='Ref_to_Const'>WARNING</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"failed to send signal to postmaster: %m"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * Rotate log file 
 * 
 * Permission checking for this function is managed through the normal 
 * GRANT system. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN349"></a><span class='Declare_Function'>pg_rotate_logfile</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../postmaster/syslogger.c.html#LN62"><span class='Ref_to_Global_Var'>Logging_collector</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN39"><span class='Ref_to_Const'>WARNING</span></a><span class='Delimiter'>, 
</span>        <span class='Parentheses'>(</span><a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"rotation not possible because log collection not active"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../../include/storage/pmsignal.h.html#LN45"><span class='Ref_to_Proto'>SendPostmasterSignal</span></a><span class='Parentheses'>(</span><a href="../../../include/storage/pmsignal.h.html#LN27"><span class='Ref_to_EnumConst'>PMSIGNAL_ROTATE_LOGFILE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* Function to find out which databases make use of a tablespace */ 
</span> 
<span class='Control'>typedef</span> <span class='Control'>struct</span> 
<span class='Delimiter'>{ 
</span><a name="LN366"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Member'>location</span><span class='Delimiter'>; 
</span><a name="LN367"></a>    <a href="../../../port/dirent.c.html#LN24"><span class='Ref_to_Struct'>DIR</span></a>        <span class='Operator'>*</span><span class='Declare_Member'>dirdesc</span><span class='Delimiter'>; 
</span><a name="LN368"></a>} <span class='Declare_Typedef'>ts_db_fctx</span><span class='Delimiter'>; 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN371"></a><span class='Declare_Function'>pg_tablespace_databases</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN373"></a>    <a href="../../../include/funcapi.h.html#LN56"><span class='Ref_to_Struct'>FuncCallContext</span></a> <span class='Operator'>*</span><span class='Declare_Local'>funcctx</span><span class='Delimiter'>; 
</span><a name="LN374"></a>    <span class='Control'>struct</span> <a href="../../../include/port/win32_msvc/dirent.h.html#LN8"><span class='Ref_to_Struct'>dirent</span></a> <span class='Operator'>*</span><span class='Declare_Local'>de</span><span class='Delimiter'>; 
</span><a name="LN375"></a>    <a href="misc.c.html#LN364"><span class='Ref_to_Typedef'>ts_db_fctx</span></a> <span class='Operator'>*</span><span class='Declare_Local'>fctx</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/funcapi.h.html#LN284"><span class='Ref_to_Macro'>SRF_IS_FIRSTCALL</span></a><span class='Parentheses'>())</span> 
    <span class='Delimiter'>{ 
</span><a name="LN379"></a>        <a href="../../../include/utils/palloc.h.html#LN35"><span class='Ref_to_Typedef'>MemoryContext</span></a> <span class='Declare_Local'>oldcontext</span><span class='Delimiter'>; 
</span><a name="LN380"></a>        <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>tablespaceOid</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="misc.c.html#LN373"><span class='Ref_To_Local'>funcctx</span></a> <span class='Operator'>= </span><a href="../../../include/funcapi.h.html#LN286"><span class='Ref_to_Macro'>SRF_FIRSTCALL_INIT</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <a href="misc.c.html#LN379"><span class='Ref_To_Local'>oldcontext</span></a> <span class='Operator'>= </span><a href="../../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN373"><span class='Ref_To_Local'>funcctx</span></a><span class='Operator'>-&GT;</span><a href="../../../include/funcapi.h.html#LN108"><span class='Ref_to_Member'>multi_call_memory_ctx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="misc.c.html#LN375"><span class='Ref_To_Local'>fctx</span></a> <span class='Operator'>= </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="misc.c.html#LN364"><span class='Ref_to_Typedef'>ts_db_fctx</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN380"><span class='Ref_To_Local'>tablespaceOid</span></a> <span class='Operator'>== </span><a href="../../../include/catalog/pg_tablespace.h.html#LN63"><span class='Ref_to_Const'>GLOBALTABLESPACE_OID</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="misc.c.html#LN375"><span class='Ref_To_Local'>fctx</span></a><span class='Operator'>-&GT;</span><a href="misc.c.html#LN367"><span class='Ref_to_Member'>dirdesc</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN39"><span class='Ref_to_Const'>WARNING</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"global tablespace never has databases"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN380"><span class='Ref_To_Local'>tablespaceOid</span></a> <span class='Operator'>== </span><a href="../../../include/catalog/pg_tablespace.h.html#LN62"><span class='Ref_to_Const'>DEFAULTTABLESPACE_OID</span></a><span class='Parentheses'>) 
</span>                <a href="misc.c.html#LN375"><span class='Ref_To_Local'>fctx</span></a><span class='Operator'>-&GT;</span><a href="misc.c.html#LN366"><span class='Ref_to_Member'>location</span></a> <span class='Operator'>= </span><a href="../../../common/psprintf.c.html#LN44"><span class='Ref_to_Func'>psprintf</span></a><span class='Parentheses'>(</span><span class='String'>"base"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="misc.c.html#LN375"><span class='Ref_To_Local'>fctx</span></a><span class='Operator'>-&GT;</span><a href="misc.c.html#LN366"><span class='Ref_to_Member'>location</span></a> <span class='Operator'>= </span><a href="../../../common/psprintf.c.html#LN44"><span class='Ref_to_Func'>psprintf</span></a><span class='Parentheses'>(</span><span class='String'>"pg_tblspc/%u/%s"</span><span class='Delimiter'>, </span><a href="misc.c.html#LN380"><span class='Ref_To_Local'>tablespaceOid</span></a><span class='Delimiter'>, 
</span>                                          <a href="../../../include/catalog/catalog.h.html#LN25"><span class='Ref_to_Const'>TABLESPACE_VERSION_DIRECTORY</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="misc.c.html#LN375"><span class='Ref_To_Local'>fctx</span></a><span class='Operator'>-&GT;</span><a href="misc.c.html#LN367"><span class='Ref_to_Member'>dirdesc</span></a> <span class='Operator'>= </span><a href="../../../include/storage/fd.h.html#LN91"><span class='Ref_to_Proto'>AllocateDir</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN375"><span class='Ref_To_Local'>fctx</span></a><span class='Operator'>-&GT;</span><a href="misc.c.html#LN366"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="misc.c.html#LN375"><span class='Ref_To_Local'>fctx</span></a><span class='Operator'>-&GT;</span><a href="misc.c.html#LN367"><span class='Ref_to_Member'>dirdesc</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* the only expected error is ENOENT */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span>errno <span class='Operator'>!= </span>ENOENT<span class='Parentheses'>) 
</span>                    <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN132"><span class='Ref_to_Proto'>errcode_for_file_access</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, 
</span>                             <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"could not open directory \"%s\": %m"</span><span class='Delimiter'>, 
</span>                                    <a href="misc.c.html#LN375"><span class='Ref_To_Local'>fctx</span></a><span class='Operator'>-&GT;</span><a href="misc.c.html#LN366"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN39"><span class='Ref_to_Const'>WARNING</span></a><span class='Delimiter'>, 
</span>                      <span class='Parentheses'>(</span><a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"%u is not a tablespace OID"</span><span class='Delimiter'>, </span><a href="misc.c.html#LN380"><span class='Ref_To_Local'>tablespaceOid</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
        <a href="misc.c.html#LN373"><span class='Ref_To_Local'>funcctx</span></a><span class='Operator'>-&GT;</span><a href="../../../include/funcapi.h.html#LN89"><span class='Ref_to_Member'>user_fctx</span></a> <span class='Operator'>= </span><a href="misc.c.html#LN375"><span class='Ref_To_Local'>fctx</span></a><span class='Delimiter'>; 
</span>        <a href="../../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN379"><span class='Ref_To_Local'>oldcontext</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if SRF_IS_FIRSTCALL() &raquo; </span> 
 
    <a href="misc.c.html#LN373"><span class='Ref_To_Local'>funcctx</span></a> <span class='Operator'>= </span><a href="../../../include/funcapi.h.html#LN288"><span class='Ref_to_Macro'>SRF_PERCALL_SETUP</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="misc.c.html#LN375"><span class='Ref_To_Local'>fctx</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="misc.c.html#LN364"><span class='Ref_to_Typedef'>ts_db_fctx</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="misc.c.html#LN373"><span class='Ref_To_Local'>funcctx</span></a><span class='Operator'>-&GT;</span><a href="../../../include/funcapi.h.html#LN89"><span class='Ref_to_Member'>user_fctx</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="misc.c.html#LN375"><span class='Ref_To_Local'>fctx</span></a><span class='Operator'>-&GT;</span><a href="misc.c.html#LN367"><span class='Ref_to_Member'>dirdesc</span></a><span class='Parentheses'>)</span>         <span class='Comment_Single_Line'>/* not a tablespace */ 
</span>        <a href="../../../include/funcapi.h.html#LN308"><span class='Ref_to_Macro'>SRF_RETURN_DONE</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN373"><span class='Ref_To_Local'>funcctx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>((</span><a href="misc.c.html#LN374"><span class='Ref_To_Local'>de</span></a> <span class='Operator'>= </span><a href="../../../include/storage/fd.h.html#LN92"><span class='Ref_to_Proto'>ReadDir</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN375"><span class='Ref_To_Local'>fctx</span></a><span class='Operator'>-&GT;</span><a href="misc.c.html#LN367"><span class='Ref_to_Member'>dirdesc</span></a><span class='Delimiter'>, </span><a href="misc.c.html#LN375"><span class='Ref_To_Local'>fctx</span></a><span class='Operator'>-&GT;</span><a href="misc.c.html#LN366"><span class='Ref_to_Member'>location</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span><a name="LN427"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>subdir</span><span class='Delimiter'>; 
</span><a name="LN428"></a>        <a href="../../../port/dirent.c.html#LN24"><span class='Ref_to_Struct'>DIR</span></a>        <span class='Operator'>*</span><span class='Declare_Local'>dirdesc</span><span class='Delimiter'>; 
</span><a name="LN429"></a>        <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>datOid</span> <span class='Operator'>= </span><a href="../../../include/postgres_ext.h.html#LN41"><span class='Ref_to_Macro'>atooid</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN374"><span class='Ref_To_Local'>de</span></a><span class='Operator'>-&GT;</span><a href="../../../include/port/win32_msvc/dirent.h.html#LN13"><span class='Ref_to_Member'>d_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* this test skips . and .., but is awfully weak */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="misc.c.html#LN429"><span class='Ref_To_Local'>datOid</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* if database subdir is empty, don't report tablespace as used */ 
</span> 
        <a href="misc.c.html#LN427"><span class='Ref_To_Local'>subdir</span></a> <span class='Operator'>= </span><a href="../../../common/psprintf.c.html#LN44"><span class='Ref_to_Func'>psprintf</span></a><span class='Parentheses'>(</span><span class='String'>"%s/%s"</span><span class='Delimiter'>, </span><a href="misc.c.html#LN375"><span class='Ref_To_Local'>fctx</span></a><span class='Operator'>-&GT;</span><a href="misc.c.html#LN366"><span class='Ref_to_Member'>location</span></a><span class='Delimiter'>, </span><a href="misc.c.html#LN374"><span class='Ref_To_Local'>de</span></a><span class='Operator'>-&GT;</span><a href="../../../include/port/win32_msvc/dirent.h.html#LN13"><span class='Ref_to_Member'>d_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="misc.c.html#LN428"><span class='Ref_To_Local'>dirdesc</span></a> <span class='Operator'>= </span><a href="../../../include/storage/fd.h.html#LN91"><span class='Ref_to_Proto'>AllocateDir</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN427"><span class='Ref_To_Local'>subdir</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>while</span> <span class='Parentheses'>((</span><a href="misc.c.html#LN374"><span class='Ref_To_Local'>de</span></a> <span class='Operator'>= </span><a href="../../../include/storage/fd.h.html#LN92"><span class='Ref_to_Proto'>ReadDir</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN428"><span class='Ref_To_Local'>dirdesc</span></a><span class='Delimiter'>, </span><a href="misc.c.html#LN427"><span class='Ref_To_Local'>subdir</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="misc.c.html#LN374"><span class='Ref_To_Local'>de</span></a><span class='Operator'>-&GT;</span><a href="../../../include/port/win32_msvc/dirent.h.html#LN13"><span class='Ref_to_Member'>d_name</span></a><span class='Delimiter'>, </span><span class='String'>"."</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span> <span class='Operator'>&& </span>strcmp<span class='Parentheses'>(</span><a href="misc.c.html#LN374"><span class='Ref_To_Local'>de</span></a><span class='Operator'>-&GT;</span><a href="../../../include/port/win32_msvc/dirent.h.html#LN13"><span class='Ref_to_Member'>d_name</span></a><span class='Delimiter'>, </span><span class='String'>".."</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="../../../include/storage/fd.h.html#LN93"><span class='Ref_to_Proto'>FreeDir</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN428"><span class='Ref_To_Local'>dirdesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN427"><span class='Ref_To_Local'>subdir</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="misc.c.html#LN374"><span class='Ref_To_Local'>de</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* indeed, nothing in it */ 
</span> 
        <a href="../../../include/funcapi.h.html#LN290"><span class='Ref_to_Macro'>SRF_RETURN_NEXT</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN373"><span class='Ref_To_Local'>funcctx</span></a><span class='Delimiter'>, </span><a href="../../../include/postgres.h.html#LN512"><span class='Ref_to_Macro'>ObjectIdGetDatum</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN429"><span class='Ref_To_Local'>datOid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while (de=ReadDir(fctx-&GT;dir... &raquo; </span> 
 
    <a href="../../../include/storage/fd.h.html#LN93"><span class='Ref_to_Proto'>FreeDir</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN375"><span class='Ref_To_Local'>fctx</span></a><span class='Operator'>-&GT;</span><a href="misc.c.html#LN367"><span class='Ref_to_Member'>dirdesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/funcapi.h.html#LN308"><span class='Ref_to_Macro'>SRF_RETURN_DONE</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN373"><span class='Ref_To_Local'>funcctx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_tablespace_databases &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * pg_tablespace_location - get location for a tablespace 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN462"></a><span class='Declare_Function'>pg_tablespace_location</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN464"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>tablespaceOid</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN465"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>sourcepath</span><span class='Delimiter'>[</span><a href="../../../include/pg_config_manual.h.html#LN88"><span class='Ref_to_Const'>MAXPGPATH</span></a><span class='Delimiter'>]; 
</span><a name="LN466"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>targetpath</span><span class='Delimiter'>[</span><a href="../../../include/pg_config_manual.h.html#LN88"><span class='Ref_to_Const'>MAXPGPATH</span></a><span class='Delimiter'>]; 
</span><a name="LN467"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>rllen</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * It's useful to apply this function to pg_class.reltablespace, wherein 
     * zero means "the database's default tablespace".  So, rather than 
     * throwing an error for zero, we choose to assume that's what is meant. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN464"><span class='Ref_To_Local'>tablespaceOid</span></a> <span class='Operator'>== </span><a href="../../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Parentheses'>) 
</span>        <a href="misc.c.html#LN464"><span class='Ref_To_Local'>tablespaceOid</span></a> <span class='Operator'>= </span><a href="../init/globals.c.html#LN78"><span class='Ref_to_Global_Var'>MyDatabaseTableSpace</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Return empty string for the cluster's default tablespaces 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN464"><span class='Ref_To_Local'>tablespaceOid</span></a> <span class='Operator'>== </span><a href="../../../include/catalog/pg_tablespace.h.html#LN62"><span class='Ref_to_Const'>DEFAULTTABLESPACE_OID</span></a> <span class='Operator'>|| 
</span>        <a href="misc.c.html#LN464"><span class='Ref_To_Local'>tablespaceOid</span></a> <span class='Operator'>== </span><a href="../../../include/catalog/pg_tablespace.h.html#LN63"><span class='Ref_to_Const'>GLOBALTABLESPACE_OID</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/fmgr.h.html#LN329"><span class='Ref_to_Macro'>PG_RETURN_TEXT_P</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/builtins.h.html#LN85"><span class='Ref_to_Proto'>cstring_to_text</span></a><span class='Parentheses'>(</span><span class='String'>""</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
<span class='Directive'>#if</span> defined<span class='Parentheses'>(</span>HAVE_READLINK<span class='Parentheses'>) </span><span class='Operator'>|| </span>defined<span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN61"><span class='Ref_to_Const'>WIN32</span></a><span class='Parentheses'>) 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Find the location of the tablespace by reading the symbolic link that 
     * is in pg_tblspc/&LT;oid&GT;. 
     */ 
</span>    <a href="../../../pl/plperl/plperl.h.html#LN60"><span class='Ref_to_Macro'>snprintf</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN465"><span class='Ref_To_Local'>sourcepath</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="misc.c.html#LN465"><span class='Ref_To_Local'>sourcepath</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='String'>"pg_tblspc/%u"</span><span class='Delimiter'>, </span><a href="misc.c.html#LN464"><span class='Ref_To_Local'>tablespaceOid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="misc.c.html#LN467"><span class='Ref_To_Local'>rllen</span></a> <span class='Operator'>= </span><a href="../../../include/port.h.html#LN256"><span class='Ref_to_Macro'>readlink</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN465"><span class='Ref_To_Local'>sourcepath</span></a><span class='Delimiter'>, </span><a href="misc.c.html#LN466"><span class='Ref_To_Local'>targetpath</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="misc.c.html#LN466"><span class='Ref_To_Local'>targetpath</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN467"><span class='Ref_To_Local'>rllen</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN132"><span class='Ref_to_Proto'>errcode_for_file_access</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"could not read symbolic link \"%s\": %m"</span><span class='Delimiter'>, 
</span>                        <a href="misc.c.html#LN465"><span class='Ref_To_Local'>sourcepath</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN467"><span class='Ref_To_Local'>rllen</span></a> <span class='Operator'>&GT;= </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="misc.c.html#LN466"><span class='Ref_To_Local'>targetpath</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_PROGRAM_LIMIT_EXCEEDED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"symbolic link \"%s\" target is too long"</span><span class='Delimiter'>, 
</span>                        <a href="misc.c.html#LN465"><span class='Ref_To_Local'>sourcepath</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <a href="misc.c.html#LN466"><span class='Ref_To_Local'>targetpath</span></a><span class='Delimiter'>[</span><a href="misc.c.html#LN467"><span class='Ref_To_Local'>rllen</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN329"><span class='Ref_to_Macro'>PG_RETURN_TEXT_P</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/builtins.h.html#LN85"><span class='Ref_to_Proto'>cstring_to_text</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN466"><span class='Ref_To_Local'>targetpath</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span><span class='Directive'>#else</span> 
    <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>            <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_FEATURE_NOT_SUPPORTED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>             <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"tablespaces are not supported on this platform"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end pg_tablespace_location &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * pg_sleep - delay for N seconds 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN518"></a><span class='Declare_Function'>pg_sleep</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN520"></a>    <a href="../../../include/c.h.html#LN380"><span class='Ref_to_Typedef'>float8</span></a>      <span class='Declare_Local'>secs</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN245"><span class='Ref_to_Macro'>PG_GETARG_FLOAT8</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN521"></a>    <a href="../../../include/c.h.html#LN380"><span class='Ref_to_Typedef'>float8</span></a>      <span class='Declare_Local'>endtime</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We sleep using WaitLatch, to ensure that we'll wake up promptly if an 
     * important signal (such as SIGALRM or SIGINT) arrives.  Because 
     * WaitLatch's upper limit of delay is INT_MAX milliseconds, and the user 
     * might ask for more than that, we sleep for at most 10 minutes and then 
     * loop. 
     * 
     * By computing the intended stop time initially, we avoid accumulation of 
     * extra delay across multiple sleeps.  This also ensures we won't delay 
     * less than the specified time when WaitLatch is terminated early by a 
     * non-query-canceling signal such as SIGHUP. 
     */ 
</span><a name="LN535"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>GetNowFloat</span><span class='Parentheses'>()</span>   <span class='Parentheses'>((</span><a href="../../../include/c.h.html#LN380"><span class='Ref_to_Typedef'>float8</span></a><span class='Parentheses'>) </span><a href="../../../include/utils/timestamp.h.html#LN69"><span class='Ref_to_Proto'>GetCurrentTimestamp</span></a><span class='Parentheses'>() </span><span class='Operator'>/ </span><span class='Number'>1000000</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Parentheses'>)</span> 
 
    <a href="misc.c.html#LN521"><span class='Ref_To_Local'>endtime</span></a> <span class='Operator'>= </span><a href="misc.c.html#LN535"><span class='Ref_to_Macro'>GetNowFloat</span></a><span class='Parentheses'>() </span><span class='Operator'>+ </span><a href="misc.c.html#LN520"><span class='Ref_To_Local'>secs</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>;;</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN541"></a>        <a href="../../../include/c.h.html#LN380"><span class='Ref_to_Typedef'>float8</span></a>      <span class='Declare_Local'>delay</span><span class='Delimiter'>; 
</span><a name="LN542"></a>        <span class='Keyword'>long</span>        <span class='Declare_Local'>delay_ms</span><span class='Delimiter'>; 
</span> 
        <a href="../../../include/miscadmin.h.html#LN99"><span class='Ref_to_Macro'>CHECK_FOR_INTERRUPTS</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
        <a href="misc.c.html#LN541"><span class='Ref_To_Local'>delay</span></a> <span class='Operator'>= </span><a href="misc.c.html#LN521"><span class='Ref_To_Local'>endtime</span></a> <span class='Operator'>- </span><a href="misc.c.html#LN535"><span class='Ref_to_Macro'>GetNowFloat</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN541"><span class='Ref_To_Local'>delay</span></a> <span class='Operator'>&GT;= </span><span class='Number'>600</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="misc.c.html#LN542"><span class='Ref_To_Local'>delay_ms</span></a> <span class='Operator'>= </span><span class='Number'>600000</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN541"><span class='Ref_To_Local'>delay</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="misc.c.html#LN542"><span class='Ref_To_Local'>delay_ms</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>long</span><span class='Parentheses'>) </span>ceil<span class='Parentheses'>(</span><a href="misc.c.html#LN541"><span class='Ref_To_Local'>delay</span></a> <span class='Operator'>* </span><span class='Number'>1000</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="../../../include/storage/latch.h.html#LN163"><span class='Ref_to_Proto'>WaitLatch</span></a><span class='Parentheses'>(</span><a href="../init/globals.c.html#LN51"><span class='Ref_to_Global_Var'>MyLatch</span></a><span class='Delimiter'>, 
</span>                         <a href="../../../include/storage/latch.h.html#LN123"><span class='Ref_to_Const'>WL_LATCH_SET</span></a> <span class='Operator'>| </span><a href="../../../include/storage/latch.h.html#LN126"><span class='Ref_to_Const'>WL_TIMEOUT</span></a><span class='Delimiter'>, 
</span>                         <a href="misc.c.html#LN542"><span class='Ref_To_Local'>delay_ms</span></a><span class='Delimiter'>, 
</span>                         <a href="../../../include/pgstat.h.html#LN826"><span class='Ref_to_EnumConst'>WAIT_EVENT_PG_SLEEP</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/storage/latch.h.html#LN152"><span class='Ref_to_Proto'>ResetLatch</span></a><span class='Parentheses'>(</span><a href="../init/globals.c.html#LN51"><span class='Ref_to_Global_Var'>MyLatch</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for ;; &raquo; </span> 
 
    <a href="../../../include/fmgr.h.html#LN308"><span class='Ref_to_Macro'>PG_RETURN_VOID</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_sleep &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* Function to return the list of grammar keywords */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN566"></a><span class='Declare_Function'>pg_get_keywords</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN568"></a>    <a href="../../../include/funcapi.h.html#LN56"><span class='Ref_to_Struct'>FuncCallContext</span></a> <span class='Operator'>*</span><span class='Declare_Local'>funcctx</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/funcapi.h.html#LN284"><span class='Ref_to_Macro'>SRF_IS_FIRSTCALL</span></a><span class='Parentheses'>())</span> 
    <span class='Delimiter'>{ 
</span><a name="LN572"></a>        <a href="../../../include/utils/palloc.h.html#LN35"><span class='Ref_to_Typedef'>MemoryContext</span></a> <span class='Declare_Local'>oldcontext</span><span class='Delimiter'>; 
</span><a name="LN573"></a>        <a href="../../../include/access/tupdesc.h.html#LN70"><span class='Ref_to_Typedef'>TupleDesc</span></a>   <span class='Declare_Local'>tupdesc</span><span class='Delimiter'>; 
</span> 
        <a href="misc.c.html#LN568"><span class='Ref_To_Local'>funcctx</span></a> <span class='Operator'>= </span><a href="../../../include/funcapi.h.html#LN286"><span class='Ref_to_Macro'>SRF_FIRSTCALL_INIT</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>        <a href="misc.c.html#LN572"><span class='Ref_To_Local'>oldcontext</span></a> <span class='Operator'>= </span><a href="../../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN568"><span class='Ref_To_Local'>funcctx</span></a><span class='Operator'>-&GT;</span><a href="../../../include/funcapi.h.html#LN108"><span class='Ref_to_Member'>multi_call_memory_ctx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="misc.c.html#LN573"><span class='Ref_To_Local'>tupdesc</span></a> <span class='Operator'>= </span><a href="../../access/common/tupdesc.c.html#LN39"><span class='Ref_to_Func'>CreateTemplateTupleDesc</span></a><span class='Parentheses'>(</span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/access/tupdesc.h.html#LN114"><span class='Ref_to_Proto'>TupleDescInitEntry</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN573"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='String'>"word"</span><span class='Delimiter'>, 
</span>                           <a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN26"><span class='Ref_to_Const'>TEXTOID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/access/tupdesc.h.html#LN114"><span class='Ref_to_Proto'>TupleDescInitEntry</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN573"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='String'>"catcode"</span><span class='Delimiter'>, 
</span>                           <a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN19"><span class='Ref_to_Const'>CHAROID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/access/tupdesc.h.html#LN114"><span class='Ref_to_Proto'>TupleDescInitEntry</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN573"><span class='Ref_To_Local'>tupdesc</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a><span class='Parentheses'>) </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='String'>"catdesc"</span><span class='Delimiter'>, 
</span>                           <a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN26"><span class='Ref_to_Const'>TEXTOID</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="misc.c.html#LN568"><span class='Ref_To_Local'>funcctx</span></a><span class='Operator'>-&GT;</span><a href="../../../include/funcapi.h.html#LN98"><span class='Ref_to_Member'>attinmeta</span></a> <span class='Operator'>= </span><a href="../../../include/funcapi.h.html#LN230"><span class='Ref_to_Proto'>TupleDescGetAttInMetadata</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN573"><span class='Ref_To_Local'>tupdesc</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="../../../include/utils/palloc.h.html#LN107"><span class='Ref_to_Func'>MemoryContextSwitchTo</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN572"><span class='Ref_To_Local'>oldcontext</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if SRF_IS_FIRSTCALL() &raquo; </span> 
 
    <a href="misc.c.html#LN568"><span class='Ref_To_Local'>funcctx</span></a> <span class='Operator'>= </span><a href="../../../include/funcapi.h.html#LN288"><span class='Ref_to_Macro'>SRF_PERCALL_SETUP</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN568"><span class='Ref_To_Local'>funcctx</span></a><span class='Operator'>-&GT;</span><a href="../../../include/funcapi.h.html#LN64"><span class='Ref_to_Member'>call_cntr</span></a> <span class='Operator'>&LT; </span><a href="../../../common/keywords.c.html#LN44"><span class='Ref_to_Global_Var'>NumScanKeywords</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN595"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>values</span><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>]; 
</span><a name="LN596"></a>        <a href="../../../include/access/htup.h.html#LN69"><span class='Ref_to_Typedef'>HeapTuple</span></a>   <span class='Declare_Local'>tuple</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* cast-away-const is ugly but alternatives aren't much better */ 
</span>        <a href="misc.c.html#LN595"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../common/keywords.c.html#LN40"><span class='Ref_to_Global_Var'>ScanKeywords</span></a><span class='Delimiter'>[</span><a href="misc.c.html#LN568"><span class='Ref_To_Local'>funcctx</span></a><span class='Operator'>-&GT;</span><a href="../../../include/funcapi.h.html#LN64"><span class='Ref_to_Member'>call_cntr</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/common/keywords.h.html#LN25"><span class='Ref_to_Member'>name</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="../../../common/keywords.c.html#LN40"><span class='Ref_to_Global_Var'>ScanKeywords</span></a><span class='Delimiter'>[</span><a href="misc.c.html#LN568"><span class='Ref_To_Local'>funcctx</span></a><span class='Operator'>-&GT;</span><a href="../../../include/funcapi.h.html#LN64"><span class='Ref_to_Member'>call_cntr</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/common/keywords.h.html#LN27"><span class='Ref_to_Member'>category</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>case</span> <a href="../../../include/common/keywords.h.html#LN17"><span class='Ref_to_Const'>UNRESERVED_KEYWORD</span></a><span class='Operator'>: 
</span>                <a href="misc.c.html#LN595"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='String'>"U"</span><span class='Delimiter'>; 
</span>                <a href="misc.c.html#LN595"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= </span>_<span class='Parentheses'>(</span><span class='String'>"unreserved"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="../../../include/common/keywords.h.html#LN18"><span class='Ref_to_Const'>COL_NAME_KEYWORD</span></a><span class='Operator'>: 
</span>                <a href="misc.c.html#LN595"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='String'>"C"</span><span class='Delimiter'>; 
</span>                <a href="misc.c.html#LN595"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= </span>_<span class='Parentheses'>(</span><span class='String'>"unreserved (cannot be function or type name)"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="../../../include/common/keywords.h.html#LN19"><span class='Ref_to_Const'>TYPE_FUNC_NAME_KEYWORD</span></a><span class='Operator'>: 
</span>                <a href="misc.c.html#LN595"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='String'>"T"</span><span class='Delimiter'>; 
</span>                <a href="misc.c.html#LN595"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= </span>_<span class='Parentheses'>(</span><span class='String'>"reserved (can be function or type name)"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="../../../include/common/keywords.h.html#LN20"><span class='Ref_to_Const'>RESERVED_KEYWORD</span></a><span class='Operator'>: 
</span>                <a href="misc.c.html#LN595"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='String'>"R"</span><span class='Delimiter'>; 
</span>                <a href="misc.c.html#LN595"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= </span>_<span class='Parentheses'>(</span><span class='String'>"reserved"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>default</span><span class='Operator'>:</span>            <span class='Comment_Single_Line'>/* shouldn't be possible */ 
</span>                <a href="misc.c.html#LN595"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>                <a href="misc.c.html#LN595"><span class='Ref_To_Local'>values</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch ScanKeywords[funcctx-... &raquo; </span> 
 
        <a href="misc.c.html#LN596"><span class='Ref_To_Local'>tuple</span></a> <span class='Operator'>= </span><a href="../../../include/funcapi.h.html#LN231"><span class='Ref_to_Proto'>BuildTupleFromCStrings</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN568"><span class='Ref_To_Local'>funcctx</span></a><span class='Operator'>-&GT;</span><a href="../../../include/funcapi.h.html#LN98"><span class='Ref_to_Member'>attinmeta</span></a><span class='Delimiter'>, </span><a href="misc.c.html#LN595"><span class='Ref_To_Local'>values</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="../../../include/funcapi.h.html#LN290"><span class='Ref_to_Macro'>SRF_RETURN_NEXT</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN568"><span class='Ref_To_Local'>funcctx</span></a><span class='Delimiter'>, </span><a href="../../../include/funcapi.h.html#LN221"><span class='Ref_to_Macro'>HeapTupleGetDatum</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN596"><span class='Ref_To_Local'>tuple</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if funcctx-&GT;call_cntr&LT;Nu... &raquo; </span> 
 
    <a href="../../../include/funcapi.h.html#LN308"><span class='Ref_to_Macro'>SRF_RETURN_DONE</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN568"><span class='Ref_To_Local'>funcctx</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_get_keywords &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * Return the type of the argument. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN638"></a><span class='Declare_Function'>pg_typeof</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="../../../include/fmgr.h.html#LN319"><span class='Ref_to_Macro'>PG_RETURN_OID</span></a><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN663"><span class='Ref_to_Proto'>get_fn_expr_argtype</span></a><span class='Parentheses'>(</span>fcinfo<span class='Operator'>-&GT;</span>flinfo<span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * Implementation of the COLLATE FOR expression; returns the collation 
 * of the argument. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN649"></a><span class='Declare_Function'>pg_collation_for</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN651"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>typeid</span><span class='Delimiter'>; 
</span><a name="LN652"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>collid</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>typeid </span><span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN663"><span class='Ref_to_Proto'>get_fn_expr_argtype</span></a><span class='Parentheses'>(</span>fcinfo<span class='Operator'>-&GT;</span>flinfo<span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><span class='Keyword'>typeid</span><span class='Parentheses'>) 
</span>        <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/utils/lsyscache.h.html#LN167"><span class='Ref_to_Proto'>type_is_collatable</span></a><span class='Parentheses'>(</span><span class='Keyword'>typeid</span><span class='Parentheses'>) </span><span class='Operator'>&& </span><span class='Keyword'>typeid </span><span class='Operator'>!= </span><a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN43"><span class='Ref_to_Const'>UNKNOWNOID</span></a><span class='Parentheses'>)</span> 
        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_DATATYPE_MISMATCH<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"collations are not supported by type %s"</span><span class='Delimiter'>, 
</span>                        <a href="format_type.c.html#LN92"><span class='Ref_to_Func'>format_type_be</span></a><span class='Parentheses'>(</span><span class='Keyword'>typeid</span><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
    <a href="misc.c.html#LN652"><span class='Ref_To_Local'>collid</span></a> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN162"><span class='Ref_to_Macro'>PG_GET_COLLATION</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="misc.c.html#LN652"><span class='Ref_To_Local'>collid</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN329"><span class='Ref_to_Macro'>PG_RETURN_TEXT_P</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/builtins.h.html#LN85"><span class='Ref_to_Proto'>cstring_to_text</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/ruleutils.h.html#LN34"><span class='Ref_to_Proto'>generate_collation_name</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN652"><span class='Ref_To_Local'>collid</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_collation_for &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * pg_relation_is_updatable - determine which update events the specified 
 * relation supports. 
 * 
 * This relies on relation_is_updatable() in rewriteHandler.c, which see 
 * for additional information. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN678"></a><span class='Declare_Function'>pg_relation_is_updatable</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN680"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>reloid</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN681"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>include_triggers</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN238"><span class='Ref_to_Macro'>PG_GETARG_BOOL</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><a href="../../../include/rewrite/rewriteHandler.h.html#LN28"><span class='Ref_to_Proto'>relation_is_updatable</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN680"><span class='Ref_To_Local'>reloid</span></a><span class='Delimiter'>, </span><a href="misc.c.html#LN681"><span class='Ref_To_Local'>include_triggers</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pg_column_is_updatable - determine whether a column is updatable 
 * 
 * This function encapsulates the decision about just what 
 * information_schema.columns.is_updatable actually means.  It's not clear 
 * whether deletability of the column's relation should be required, so 
 * we want that decision in C code where we could change it without initdb. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN695"></a><span class='Declare_Function'>pg_column_is_updatable</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN697"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>reloid</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN698"></a>    <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a>  <span class='Declare_Local'>attnum</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN235"><span class='Ref_to_Macro'>PG_GETARG_INT16</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN699"></a>    <a href="../../../include/access/attnum.h.html#LN20"><span class='Ref_to_Typedef'>AttrNumber</span></a>  <span class='Declare_Local'>col</span> <span class='Operator'>= </span><a href="misc.c.html#LN698"><span class='Ref_To_Local'>attnum</span></a> <span class='Operator'>- </span><a href="../../../include/access/sysattr.h.html#LN27"><span class='Ref_to_Const'>FirstLowInvalidHeapAttributeNumber</span></a><span class='Delimiter'>; 
</span><a name="LN700"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>include_triggers</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN238"><span class='Ref_to_Macro'>PG_GETARG_BOOL</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN701"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>events</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* System columns are never updatable */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN698"><span class='Ref_To_Local'>attnum</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="misc.c.html#LN701"><span class='Ref_To_Local'>events</span></a> <span class='Operator'>= </span><a href="../../../include/rewrite/rewriteHandler.h.html#LN28"><span class='Ref_to_Proto'>relation_is_updatable</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN697"><span class='Ref_To_Local'>reloid</span></a><span class='Delimiter'>, </span><a href="misc.c.html#LN700"><span class='Ref_To_Local'>include_triggers</span></a><span class='Delimiter'>, 
</span>                                   <a href="../../../include/nodes/bitmapset.h.html#LN67"><span class='Ref_to_Proto'>bms_make_singleton</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN699"><span class='Ref_To_Local'>col</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* We require both updatability and deletability of the relation */ 
</span><a name="LN711"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>REQ_EVENTS</span> <span class='Parentheses'>((</span><span class='Number'>1</span> <span class='Operator'>&LT;&LT; </span><a href="../../../include/nodes/nodes.h.html#LN651"><span class='Ref_to_EnumConst'>CMD_UPDATE</span></a><span class='Parentheses'>) </span><span class='Operator'>| </span><span class='Parentheses'>(</span><span class='Number'>1</span> <span class='Operator'>&LT;&LT; </span><a href="../../../include/nodes/nodes.h.html#LN653"><span class='Ref_to_EnumConst'>CMD_DELETE</span></a><span class='Parentheses'>))</span> 
 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>((</span><a href="misc.c.html#LN701"><span class='Ref_To_Local'>events</span></a> <span class='Operator'>& </span><a href="misc.c.html#LN711"><span class='Ref_to_Const'>REQ_EVENTS</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="misc.c.html#LN711"><span class='Ref_to_Const'>REQ_EVENTS</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_column_is_updatable &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * Is character a valid identifier start? 
 * Must match scan.l's {ident_start} character class. 
 */ 
</span><span class='Keyword'>static bool 
</span><a name="LN722"></a><span class='Declare_Function'>is_ident_start</span><span class='Parentheses'>(</span><span class='Keyword'>unsigned char </span><span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* Underscores and ASCII letters are OK */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN722"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>== </span><span class='String'>'_'</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="misc.c.html#LN722"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>&GT;= </span><span class='String'>'a'</span> <span class='Operator'>&& </span><a href="misc.c.html#LN722"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>&LT;= </span><span class='String'>'z'</span><span class='Parentheses'>) </span><span class='Operator'>|| </span><span class='Parentheses'>(</span><a href="misc.c.html#LN722"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>&GT;= </span><span class='String'>'A'</span> <span class='Operator'>&& </span><a href="misc.c.html#LN722"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>&LT;= </span><span class='String'>'Z'</span><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* Any high-bit-set character is OK (might be part of a multibyte char) */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN722"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Is character a valid identifier continuation? 
 * Must match scan.l's {ident_cont} character class. 
 */ 
</span><span class='Keyword'>static bool 
</span><a name="LN740"></a><span class='Declare_Function'>is_ident_cont</span><span class='Parentheses'>(</span><span class='Keyword'>unsigned char </span><span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* Can be digit or dollar sign ... */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="misc.c.html#LN740"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>&GT;= </span><span class='String'>'0'</span> <span class='Operator'>&& </span><a href="misc.c.html#LN740"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>&LT;= </span><span class='String'>'9'</span><span class='Parentheses'>) </span><span class='Operator'>|| </span><a href="misc.c.html#LN740"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>== </span><span class='String'>'$'</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* ... or an identifier start character */ 
</span>    <span class='Control'>return</span> <a href="misc.c.html#LN721"><span class='Ref_to_Func'>is_ident_start</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN740"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * parse_ident - parse a SQL qualified identifier into separate identifiers. 
 * When strict mode is active (second parameter), then any chars after 
 * the last identifier are disallowed. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN755"></a><span class='Declare_Function'>parse_ident</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN757"></a>    <a href="../../../../contrib/seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>qualname</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN272"><span class='Ref_to_Macro'>PG_GETARG_TEXT_PP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN758"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>strict</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN238"><span class='Ref_to_Macro'>PG_GETARG_BOOL</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN759"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>qualname_str</span> <span class='Operator'>= </span><a href="../../../include/utils/builtins.h.html#LN87"><span class='Ref_to_Proto'>text_to_cstring</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN757"><span class='Ref_To_Local'>qualname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN760"></a>    <a href="../../../include/utils/array.h.html#LN167"><span class='Ref_to_Struct'>ArrayBuildState</span></a> <span class='Operator'>*</span><span class='Declare_Local'>astate</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN761"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>nextp</span><span class='Delimiter'>; 
</span><a name="LN762"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>after_dot</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * The code below scribbles on qualname_str in some cases, so we should 
     * reconvert qualname if we need to show the original string in error 
     * messages. 
     */ 
</span>    <a href="misc.c.html#LN761"><span class='Ref_To_Local'>nextp</span></a> <span class='Operator'>= </span><a href="misc.c.html#LN759"><span class='Ref_To_Local'>qualname_str</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* skip leading whitespace */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="../../../include/parser/scansup.h.html#LN27"><span class='Ref_to_Proto'>scanner_isspace</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="misc.c.html#LN761"><span class='Ref_To_Local'>nextp</span></a><span class='Parentheses'>))</span> 
        <a href="misc.c.html#LN761"><span class='Ref_To_Local'>nextp</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>;;</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN777"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>curname</span><span class='Delimiter'>; 
</span><a name="LN778"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Local'>missing_ident</span> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="misc.c.html#LN761"><span class='Ref_To_Local'>nextp</span></a> <span class='Operator'>== </span><span class='String'>'"'</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN782"></a>            <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>endp</span><span class='Delimiter'>; 
</span> 
            <a href="misc.c.html#LN777"><span class='Ref_To_Local'>curname</span></a> <span class='Operator'>= </span><a href="misc.c.html#LN761"><span class='Ref_To_Local'>nextp</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>;;</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="misc.c.html#LN782"><span class='Ref_To_Local'>endp</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="misc.c.html#LN761"><span class='Ref_To_Local'>nextp</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='String'>'"'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN782"><span class='Ref_To_Local'>endp</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                    <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                           <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"string is not a valid identifier: \"%s\""</span><span class='Delimiter'>, 
</span>                                  <a href="../../../include/utils/builtins.h.html#LN87"><span class='Ref_to_Proto'>text_to_cstring</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN757"><span class='Ref_To_Local'>qualname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, 
</span>                           <a href="../error/elog.c.html#LN871"><span class='Ref_to_Func'>errdetail</span></a><span class='Parentheses'>(</span><span class='String'>"String has unclosed double quotes."</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN782"><span class='Ref_To_Local'>endp</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>!= </span><span class='String'>'"'</span><span class='Parentheses'>) 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <a href="../../../include/c.h.html#LN1057"><span class='Ref_to_Macro'>memmove</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN782"><span class='Ref_To_Local'>endp</span></a><span class='Delimiter'>, </span><a href="misc.c.html#LN782"><span class='Ref_To_Local'>endp</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>, </span>strlen<span class='Parentheses'>(</span><a href="misc.c.html#LN782"><span class='Ref_To_Local'>endp</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <a href="misc.c.html#LN761"><span class='Ref_To_Local'>nextp</span></a> <span class='Operator'>= </span><a href="misc.c.html#LN782"><span class='Ref_To_Local'>endp</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <a href="misc.c.html#LN761"><span class='Ref_To_Local'>nextp</span></a> <span class='Operator'>= </span><a href="misc.c.html#LN782"><span class='Ref_To_Local'>endp</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="misc.c.html#LN782"><span class='Ref_To_Local'>endp</span></a> <span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN782"><span class='Ref_To_Local'>endp</span></a> <span class='Operator'>- </span><a href="misc.c.html#LN777"><span class='Ref_To_Local'>curname</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"string is not a valid identifier: \"%s\""</span><span class='Delimiter'>, 
</span>                                <a href="../../../include/utils/builtins.h.html#LN87"><span class='Ref_to_Proto'>text_to_cstring</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN757"><span class='Ref_To_Local'>qualname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, 
</span>                         <a href="../error/elog.c.html#LN871"><span class='Ref_to_Func'>errdetail</span></a><span class='Parentheses'>(</span><span class='String'>"Quoted identifier must not be empty."</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
            <a href="misc.c.html#LN760"><span class='Ref_To_Local'>astate</span></a> <span class='Operator'>= </span><a href="../../../include/utils/array.h.html#LN390"><span class='Ref_to_Proto'>accumArrayResult</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN760"><span class='Ref_To_Local'>astate</span></a><span class='Delimiter'>, </span><a href="../../../include/utils/builtins.h.html#LN90"><span class='Ref_to_Macro'>CStringGetTextDatum</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN777"><span class='Ref_To_Local'>curname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                      <span class='Boolean'>false</span><span class='Delimiter'>, </span><a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN26"><span class='Ref_to_Const'>TEXTOID</span></a><span class='Delimiter'>, </span><a href="../mmgr/mcxt.c.html#LN36"><span class='Ref_to_Global_Var'>CurrentMemoryContext</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="misc.c.html#LN778"><span class='Ref_To_Local'>missing_ident</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if *nextp=='"' &raquo; </span> 
        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN721"><span class='Ref_to_Func'>is_ident_start</span></a><span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="misc.c.html#LN761"><span class='Ref_To_Local'>nextp</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN815"></a>            <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>downname</span><span class='Delimiter'>; 
</span><a name="LN816"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span><a name="LN817"></a>            <a href="../../../../contrib/seg/segparse.y.html#LN46"><span class='Ref_to_Global_Var'>text</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>part</span><span class='Delimiter'>; 
</span> 
            <a href="misc.c.html#LN777"><span class='Ref_To_Local'>curname</span></a> <span class='Operator'>= </span><a href="misc.c.html#LN761"><span class='Ref_To_Local'>nextp</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN739"><span class='Ref_to_Func'>is_ident_cont</span></a><span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="misc.c.html#LN761"><span class='Ref_To_Local'>nextp</span></a><span class='Parentheses'>))</span> 
                <a href="misc.c.html#LN761"><span class='Ref_To_Local'>nextp</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span> 
            <a href="misc.c.html#LN816"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="misc.c.html#LN761"><span class='Ref_To_Local'>nextp</span></a> <span class='Operator'>- </span><a href="misc.c.html#LN777"><span class='Ref_To_Local'>curname</span></a><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * We don't implicitly truncate identifiers. This is useful for 
             * allowing the user to check for specific parts of the identifier 
             * being too long. It's easy enough for the user to get the 
             * truncated names by casting our output to name[]. 
             */ 
</span>            <a href="misc.c.html#LN815"><span class='Ref_To_Local'>downname</span></a> <span class='Operator'>= </span><a href="../../../include/parser/scansup.h.html#LN22"><span class='Ref_to_Proto'>downcase_identifier</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN777"><span class='Ref_To_Local'>curname</span></a><span class='Delimiter'>, </span><a href="misc.c.html#LN816"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="misc.c.html#LN817"><span class='Ref_To_Local'>part</span></a> <span class='Operator'>= </span><a href="../../../include/utils/builtins.h.html#LN86"><span class='Ref_to_Proto'>cstring_to_text_with_len</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN815"><span class='Ref_To_Local'>downname</span></a><span class='Delimiter'>, </span><a href="misc.c.html#LN816"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="misc.c.html#LN760"><span class='Ref_To_Local'>astate</span></a> <span class='Operator'>= </span><a href="../../../include/utils/array.h.html#LN390"><span class='Ref_to_Proto'>accumArrayResult</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN760"><span class='Ref_To_Local'>astate</span></a><span class='Delimiter'>, </span><a href="../../../include/postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN817"><span class='Ref_To_Local'>part</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, 
</span>                                      <a href="../../../interfaces/ecpg/ecpglib/pg_type.h.html#LN26"><span class='Ref_to_Const'>TEXTOID</span></a><span class='Delimiter'>, </span><a href="../mmgr/mcxt.c.html#LN36"><span class='Ref_to_Global_Var'>CurrentMemoryContext</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="misc.c.html#LN778"><span class='Ref_To_Local'>missing_ident</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if is_ident_start((unsig... &raquo; </span> 
 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN778"><span class='Ref_To_Local'>missing_ident</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Different error messages based on where we failed. */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="misc.c.html#LN761"><span class='Ref_To_Local'>nextp</span></a> <span class='Operator'>== </span><span class='String'>'.'</span><span class='Parentheses'>) 
</span>                <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"string is not a valid identifier: \"%s\""</span><span class='Delimiter'>, 
</span>                                <a href="../../../include/utils/builtins.h.html#LN87"><span class='Ref_to_Proto'>text_to_cstring</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN757"><span class='Ref_To_Local'>qualname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, 
</span>                         <a href="../error/elog.c.html#LN871"><span class='Ref_to_Func'>errdetail</span></a><span class='Parentheses'>(</span><span class='String'>"No valid identifier before \".\"."</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN762"><span class='Ref_To_Local'>after_dot</span></a><span class='Parentheses'>) 
</span>                <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"string is not a valid identifier: \"%s\""</span><span class='Delimiter'>, 
</span>                                <a href="../../../include/utils/builtins.h.html#LN87"><span class='Ref_to_Proto'>text_to_cstring</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN757"><span class='Ref_To_Local'>qualname</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, 
</span>                         <a href="../error/elog.c.html#LN871"><span class='Ref_to_Func'>errdetail</span></a><span class='Parentheses'>(</span><span class='String'>"No valid identifier after \".\"."</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"string is not a valid identifier: \"%s\""</span><span class='Delimiter'>, 
</span>                                <a href="../../../include/utils/builtins.h.html#LN87"><span class='Ref_to_Proto'>text_to_cstring</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN757"><span class='Ref_To_Local'>qualname</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if missing_ident &raquo; </span> 
 
        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="../../../include/parser/scansup.h.html#LN27"><span class='Ref_to_Proto'>scanner_isspace</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="misc.c.html#LN761"><span class='Ref_To_Local'>nextp</span></a><span class='Parentheses'>))</span> 
            <a href="misc.c.html#LN761"><span class='Ref_To_Local'>nextp</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="misc.c.html#LN761"><span class='Ref_To_Local'>nextp</span></a> <span class='Operator'>== </span><span class='String'>'.'</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="misc.c.html#LN762"><span class='Ref_To_Local'>after_dot</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <a href="misc.c.html#LN761"><span class='Ref_To_Local'>nextp</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="../../../include/parser/scansup.h.html#LN27"><span class='Ref_to_Proto'>scanner_isspace</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="misc.c.html#LN761"><span class='Ref_To_Local'>nextp</span></a><span class='Parentheses'>))</span> 
                <a href="misc.c.html#LN761"><span class='Ref_To_Local'>nextp</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="misc.c.html#LN761"><span class='Ref_To_Local'>nextp</span></a> <span class='Operator'>== </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN758"><span class='Ref_To_Local'>strict</span></a><span class='Parentheses'>) 
</span>                <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"string is not a valid identifier: \"%s\""</span><span class='Delimiter'>, 
</span>                                <a href="../../../include/utils/builtins.h.html#LN87"><span class='Ref_to_Proto'>text_to_cstring</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN757"><span class='Ref_To_Local'>qualname</span></a><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for ;; &raquo; </span> 
 
    <a href="../../../include/fmgr.h.html#LN312"><span class='Ref_to_Macro'>PG_RETURN_DATUM</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/array.h.html#LN394"><span class='Ref_to_Proto'>makeArrayResult</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN760"><span class='Ref_To_Local'>astate</span></a><span class='Delimiter'>, </span><a href="../mmgr/mcxt.c.html#LN36"><span class='Ref_to_Global_Var'>CurrentMemoryContext</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end parse_ident &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * pg_current_logfile 
 * 
 * Report current log file used by log collector by scanning current_logfiles. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN894"></a><span class='Declare_Function'>pg_current_logfile</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN896"></a>    FILE       <span class='Operator'>*</span><span class='Declare_Local'>fd</span><span class='Delimiter'>; 
</span><a name="LN897"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>lbuffer</span><span class='Delimiter'>[</span><a href="../../../include/pg_config_manual.h.html#LN88"><span class='Ref_to_Const'>MAXPGPATH</span></a><span class='Delimiter'>]; 
</span><a name="LN898"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>logfmt</span><span class='Delimiter'>; 
</span><a name="LN899"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>log_filepath</span><span class='Delimiter'>; 
</span><a name="LN900"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>log_format</span> <span class='Operator'>= </span><a href="misc.c.html#LN897"><span class='Ref_To_Local'>lbuffer</span></a><span class='Delimiter'>; 
</span><a name="LN901"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>nlpos</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* The log format parameter is optional */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN167"><span class='Ref_to_Macro'>PG_NARGS</span></a><span class='Parentheses'>() </span><span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="../../../include/fmgr.h.html#LN173"><span class='Ref_to_Macro'>PG_ARGISNULL</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>))</span> 
        <a href="misc.c.html#LN898"><span class='Ref_To_Local'>logfmt</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="misc.c.html#LN898"><span class='Ref_To_Local'>logfmt</span></a> <span class='Operator'>= </span><a href="../../../include/utils/builtins.h.html#LN87"><span class='Ref_to_Proto'>text_to_cstring</span></a><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN272"><span class='Ref_to_Macro'>PG_GETARG_TEXT_PP</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="misc.c.html#LN898"><span class='Ref_To_Local'>logfmt</span></a><span class='Delimiter'>, </span><span class='String'>"stderr"</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span> <span class='Operator'>&& </span>strcmp<span class='Parentheses'>(</span><a href="misc.c.html#LN898"><span class='Ref_To_Local'>logfmt</span></a><span class='Delimiter'>, </span><span class='String'>"csvlog"</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"log format \"%s\" is not supported"</span><span class='Delimiter'>, </span><a href="misc.c.html#LN898"><span class='Ref_To_Local'>logfmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../error/elog.c.html#LN985"><span class='Ref_to_Func'>errhint</span></a><span class='Parentheses'>(</span><span class='String'>"The supported log formats are \"stderr\" and \"csvlog\"."</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="misc.c.html#LN896"><span class='Ref_To_Local'>fd</span></a> <span class='Operator'>= </span><a href="../../../include/storage/fd.h.html#LN83"><span class='Ref_to_Proto'>AllocateFile</span></a><span class='Parentheses'>(</span><a href="../../../include/postmaster/syslogger.h.html#LN93"><span class='Ref_to_Const'>LOG_METAINFO_DATAFILE</span></a><span class='Delimiter'>, </span><span class='String'>"r"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN896"><span class='Ref_To_Local'>fd</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>errno <span class='Operator'>!= </span>ENOENT<span class='Parentheses'>) 
</span>            <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN132"><span class='Ref_to_Proto'>errcode_for_file_access</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, 
</span>                     <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"could not read file \"%s\": %m"</span><span class='Delimiter'>, 
</span>                            <a href="../../../include/postmaster/syslogger.h.html#LN93"><span class='Ref_to_Const'>LOG_METAINFO_DATAFILE</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Read the file to gather current log filename(s) registered by the 
     * syslogger. 
     */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span>fgets<span class='Parentheses'>(</span><a href="misc.c.html#LN897"><span class='Ref_To_Local'>lbuffer</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="misc.c.html#LN897"><span class='Ref_To_Local'>lbuffer</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="misc.c.html#LN896"><span class='Ref_To_Local'>fd</span></a><span class='Parentheses'>)</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Extract log format and log file path from the line; lbuffer == 
         * log_format, they share storage. 
         */ 
</span>        <a href="misc.c.html#LN899"><span class='Ref_To_Local'>log_filepath</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="misc.c.html#LN897"><span class='Ref_To_Local'>lbuffer</span></a><span class='Delimiter'>, </span><span class='String'>' '</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN899"><span class='Ref_To_Local'>log_filepath</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Uh oh.  No space found, so file content is corrupted. */ 
</span>            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                 <span class='String'>"missing space character in \"%s\""</span><span class='Delimiter'>, </span><a href="../../../include/postmaster/syslogger.h.html#LN93"><span class='Ref_to_Const'>LOG_METAINFO_DATAFILE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Operator'>*</span><a href="misc.c.html#LN899"><span class='Ref_To_Local'>log_filepath</span></a> <span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>        <a href="misc.c.html#LN899"><span class='Ref_To_Local'>log_filepath</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <a href="misc.c.html#LN901"><span class='Ref_To_Local'>nlpos</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="misc.c.html#LN899"><span class='Ref_To_Local'>log_filepath</span></a><span class='Delimiter'>, </span><span class='String'>'\n'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN901"><span class='Ref_To_Local'>nlpos</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Uh oh.  No newline found, so file content is corrupted. */ 
</span>            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>               <span class='String'>"missing newline character in \"%s\""</span><span class='Delimiter'>, </span><a href="../../../include/postmaster/syslogger.h.html#LN93"><span class='Ref_to_Const'>LOG_METAINFO_DATAFILE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Operator'>*</span><a href="misc.c.html#LN901"><span class='Ref_To_Local'>nlpos</span></a> <span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="misc.c.html#LN898"><span class='Ref_To_Local'>logfmt</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strcmp<span class='Parentheses'>(</span><a href="misc.c.html#LN898"><span class='Ref_To_Local'>logfmt</span></a><span class='Delimiter'>, </span><a href="misc.c.html#LN900"><span class='Ref_To_Local'>log_format</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="../../../include/storage/fd.h.html#LN84"><span class='Ref_to_Proto'>FreeFile</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN896"><span class='Ref_To_Local'>fd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../../include/fmgr.h.html#LN329"><span class='Ref_to_Macro'>PG_RETURN_TEXT_P</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/builtins.h.html#LN85"><span class='Ref_to_Proto'>cstring_to_text</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN899"><span class='Ref_To_Local'>log_filepath</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while fgets(lbuffer,sizeof(... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Close the current log filename file. */ 
</span>    <a href="../../../include/storage/fd.h.html#LN84"><span class='Ref_to_Proto'>FreeFile</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN896"><span class='Ref_To_Local'>fd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_current_logfile &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Report current log file used by log collector (1 argument version) 
 * 
 * note: this wrapper is necessary to pass the sanity check in opr_sanity, 
 * which checks that all built-in functions that share the implementing C 
 * function take the same number of arguments 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN980"></a><span class='Declare_Function'>pg_current_logfile_1arg</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="misc.c.html#LN893"><span class='Ref_to_Func'>pg_current_logfile</span></a><span class='Parentheses'>(</span>fcinfo<span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * SQL wrapper around RelationGetReplicaIndex(). 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN989"></a><span class='Declare_Function'>pg_get_replica_identity_index</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN991"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>reloid</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN992"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>idxoid</span><span class='Delimiter'>; 
</span><a name="LN993"></a>    <a href="../../../include/utils/relcache.h.html#LN20"><span class='Ref_to_Typedef'>Relation</span></a>    <span class='Declare_Local'>rel</span><span class='Delimiter'>; 
</span> 
    <a href="misc.c.html#LN993"><span class='Ref_To_Local'>rel</span></a> <span class='Operator'>= </span><a href="../../../include/access/heapam.h.html#LN91"><span class='Ref_to_Proto'>heap_open</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN991"><span class='Ref_To_Local'>reloid</span></a><span class='Delimiter'>, </span><a href="../../../include/storage/lockdefs.h.html#LN35"><span class='Ref_to_Const'>AccessShareLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="misc.c.html#LN992"><span class='Ref_To_Local'>idxoid</span></a> <span class='Operator'>= </span><a href="../../../include/utils/relcache.h.html#LN44"><span class='Ref_to_Proto'>RelationGetReplicaIndex</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN993"><span class='Ref_To_Local'>rel</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/access/heapam.h.html#LN96"><span class='Ref_to_Macro'>heap_close</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN993"><span class='Ref_To_Local'>rel</span></a><span class='Delimiter'>, </span><a href="../../../include/storage/lockdefs.h.html#LN35"><span class='Ref_to_Const'>AccessShareLock</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN537"><span class='Ref_to_Macro'>OidIsValid</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN992"><span class='Ref_To_Local'>idxoid</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/fmgr.h.html#LN319"><span class='Ref_to_Macro'>PG_RETURN_OID</span></a><span class='Parentheses'>(</span><a href="misc.c.html#LN992"><span class='Ref_To_Local'>idxoid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="../../../include/fmgr.h.html#LN304"><span class='Ref_to_Macro'>PG_RETURN_NULL</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
} 
</span></pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>