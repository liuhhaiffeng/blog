<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\backend\utils\adt\tsvector.c</title>
<LINK REL=StyleSheet HREF="../../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\backend\utils\adt\tsvector.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:54 2017
</td></tr>
<tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
</span><span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * tsvector.c 
 *    I/O functions for tsvector 
 * 
 * Portions Copyright (c) 1996-2017, PostgreSQL Global Development Group 
 * 
 * 
 * IDENTIFICATION 
 *    src/backend/utils/adt/tsvector.c 
 * 
 *------------------------------------------------------------------------- 
 */ 
</span> 
<span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>"libpq/pqformat.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"tsearch/ts_locale.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"tsearch/ts_utils.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/builtins.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/memutils.h"</span> 
 
<span class='Control'>typedef</span> <span class='Control'>struct</span> 
<span class='Delimiter'>{ 
</span><a name="LN24"></a>    <a href="../../../include/tsearch/ts_type.h.html#LN40"><span class='Ref_to_Typedef'>WordEntry</span></a>   <span class='Declare_Member'>entry</span><span class='Delimiter'>;</span>          <span class='Comment_Single_Line'>/* must be first! */ 
</span><a name="LN25"></a>    <a href="../../../include/tsearch/ts_type.h.html#LN62"><span class='Ref_to_Typedef'>WordEntryPos</span></a> <span class='Operator'>*</span><span class='Declare_Member'>pos</span><span class='Delimiter'>; 
</span><a name="LN26"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>poslen</span><span class='Delimiter'>;</span>         <span class='Comment_Single_Line'>/* number of elements in pos */ 
</span><a name="LN27"></a><span class='Delimiter'>} </span><span class='Declare_Typedef'>WordEntryIN</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* Compare two WordEntryPos values for qsort */ 
</span><span class='Keyword'>int 
</span><a name="LN32"></a><span class='Declare_Function'>compareWordEntryPos</span><span class='Parentheses'>(</span><span class='Keyword'>const void </span><span class='Operator'>*</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><span class='Keyword'>const void </span><span class='Operator'>*</span><span class='Declare_Parameter'>b</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN34"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>apos</span> <span class='Operator'>= </span><a href="../../../include/tsearch/ts_type.h.html#LN79"><span class='Ref_to_Macro'>WEP_GETPOS</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="../../../include/tsearch/ts_type.h.html#LN62"><span class='Ref_to_Typedef'>WordEntryPos</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="tsvector.c.html#LN32"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN35"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>bpos</span> <span class='Operator'>= </span><a href="../../../include/tsearch/ts_type.h.html#LN79"><span class='Ref_to_Macro'>WEP_GETPOS</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="../../../include/tsearch/ts_type.h.html#LN62"><span class='Ref_to_Typedef'>WordEntryPos</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="tsvector.c.html#LN32"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN34"><span class='Ref_To_Local'>apos</span></a> <span class='Operator'>== </span><a href="tsvector.c.html#LN35"><span class='Ref_To_Local'>bpos</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN34"><span class='Ref_To_Local'>apos</span></a> <span class='Operator'>&GT; </span><a href="tsvector.c.html#LN35"><span class='Ref_To_Local'>bpos</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='Number'>1</span> <span class='Operator'>: -</span><span class='Number'>1</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Removes duplicate pos entries. If there's two entries with same pos 
 * but different weight, the higher weight is retained. 
 * 
 * Returns new length. 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN49"></a><span class='Declare_Function'>uniquePos</span><span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_type.h.html#LN62"><span class='Ref_to_Typedef'>WordEntryPos</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>l</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN51"></a>    <a href="../../../include/tsearch/ts_type.h.html#LN62"><span class='Ref_to_Typedef'>WordEntryPos</span></a> <span class='Operator'>*</span><span class='Declare_Local'>ptr</span><span class='Delimiter'>, 
</span><a name="LN52"></a>               <span class='Operator'>*</span><span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN49"><span class='Ref_to_Parameter'>l</span></a> <span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="tsvector.c.html#LN49"><span class='Ref_to_Parameter'>l</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/port.h.html#LN439"><span class='Ref_to_Macro'>qsort</span></a><span class='Parentheses'>((</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="tsvector.c.html#LN49"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN49"><span class='Ref_to_Parameter'>l</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_type.h.html#LN62"><span class='Ref_to_Typedef'>WordEntryPos</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="tsvector.c.html#LN31"><span class='Ref_to_Func'>compareWordEntryPos</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsvector.c.html#LN52"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN49"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>; 
</span>    <a href="tsvector.c.html#LN51"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN49"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN51"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>- </span><a href="tsvector.c.html#LN49"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>&LT; </span><a href="tsvector.c.html#LN49"><span class='Ref_to_Parameter'>l</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_type.h.html#LN79"><span class='Ref_to_Macro'>WEP_GETPOS</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="tsvector.c.html#LN51"><span class='Ref_To_Local'>ptr</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="../../../include/tsearch/ts_type.h.html#LN79"><span class='Ref_to_Macro'>WEP_GETPOS</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="tsvector.c.html#LN52"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="tsvector.c.html#LN52"><span class='Ref_To_Local'>res</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="tsvector.c.html#LN52"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= *</span><a href="tsvector.c.html#LN51"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN52"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>- </span><a href="tsvector.c.html#LN49"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>&GT;= </span><a href="../../../include/tsearch/ts_type.h.html#LN85"><span class='Ref_to_Const'>MAXNUMPOS</span></a> <span class='Operator'>- </span><span class='Number'>1</span> <span class='Operator'>|| 
</span>                <a href="../../../include/tsearch/ts_type.h.html#LN79"><span class='Ref_to_Macro'>WEP_GETPOS</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="tsvector.c.html#LN52"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="../../../include/tsearch/ts_type.h.html#LN84"><span class='Ref_to_Const'>MAXENTRYPOS</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_type.h.html#LN78"><span class='Ref_to_Macro'>WEP_GETWEIGHT</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="tsvector.c.html#LN51"><span class='Ref_To_Local'>ptr</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><a href="../../../include/tsearch/ts_type.h.html#LN78"><span class='Ref_to_Macro'>WEP_GETWEIGHT</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="tsvector.c.html#LN52"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>))</span> 
            <a href="../../../include/tsearch/ts_type.h.html#LN81"><span class='Ref_to_Macro'>WEP_SETWEIGHT</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="tsvector.c.html#LN52"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>, </span><a href="../../../include/tsearch/ts_type.h.html#LN78"><span class='Ref_to_Macro'>WEP_GETWEIGHT</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="tsvector.c.html#LN51"><span class='Ref_To_Local'>ptr</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="tsvector.c.html#LN51"><span class='Ref_To_Local'>ptr</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="tsvector.c.html#LN52"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>+ </span><span class='Number'>1</span> <span class='Operator'>- </span><a href="tsvector.c.html#LN49"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end uniquePos &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* Compare two WordEntryIN values for qsort */ 
</span><span class='Keyword'>static int 
</span><a name="LN81"></a><span class='Declare_Function'>compareentry</span><span class='Parentheses'>(</span><span class='Keyword'>const void </span><span class='Operator'>*</span><span class='Declare_Parameter'>va</span><span class='Delimiter'>, </span><span class='Keyword'>const void </span><span class='Operator'>*</span><span class='Declare_Parameter'>vb</span><span class='Delimiter'>, </span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Declare_Parameter'>arg</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN83"></a>    <span class='Keyword'>const </span><a href="tsvector.c.html#LN22"><span class='Ref_to_Typedef'>WordEntryIN</span></a> <span class='Operator'>*</span><span class='Declare_Local'>a</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="tsvector.c.html#LN22"><span class='Ref_to_Typedef'>WordEntryIN</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="tsvector.c.html#LN81"><span class='Ref_to_Parameter'>va</span></a><span class='Delimiter'>; 
</span><a name="LN84"></a>    <span class='Keyword'>const </span><a href="tsvector.c.html#LN22"><span class='Ref_to_Typedef'>WordEntryIN</span></a> <span class='Operator'>*</span><span class='Declare_Local'>b</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="tsvector.c.html#LN22"><span class='Ref_to_Typedef'>WordEntryIN</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="tsvector.c.html#LN81"><span class='Ref_to_Parameter'>vb</span></a><span class='Delimiter'>; 
</span><a name="LN85"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>BufferStr</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="tsvector.c.html#LN81"><span class='Ref_to_Parameter'>arg</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="../../../include/tsearch/ts_utils.h.html#LN184"><span class='Ref_to_Proto'>tsCompareString</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsvector.c.html#LN85"><span class='Ref_To_Local'>BufferStr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN83"><span class='Ref_To_Local'>a</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN45"><span class='Ref_to_Member'>pos</span></a><span class='Delimiter'>], </span><a href="tsvector.c.html#LN83"><span class='Ref_To_Local'>a</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN44"><span class='Ref_to_Member'>len</span></a><span class='Delimiter'>, 
</span>                           <span class='Operator'>&</span><a href="tsvector.c.html#LN85"><span class='Ref_To_Local'>BufferStr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN84"><span class='Ref_To_Local'>b</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN45"><span class='Ref_to_Member'>pos</span></a><span class='Delimiter'>], </span><a href="tsvector.c.html#LN84"><span class='Ref_To_Local'>b</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN44"><span class='Ref_to_Member'>len</span></a><span class='Delimiter'>, 
</span>                           <span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Sort an array of WordEntryIN, remove duplicates. 
 * *outbuflen receives the amount of space needed for strings and positions. 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN97"></a><span class='Declare_Function'>uniqueentry</span><span class='Parentheses'>(</span><a href="tsvector.c.html#LN22"><span class='Ref_to_Typedef'>WordEntryIN</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>l</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>buf</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>outbuflen</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN99"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>buflen</span><span class='Delimiter'>; 
</span><a name="LN100"></a>    <a href="tsvector.c.html#LN22"><span class='Ref_to_Typedef'>WordEntryIN</span></a> <span class='Operator'>*</span><span class='Declare_Local'>ptr</span><span class='Delimiter'>, 
</span><a name="LN101"></a>               <span class='Operator'>*</span><span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="tsvector.c.html#LN97"><span class='Ref_to_Parameter'>l</span></a> <span class='Operator'>&GT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN97"><span class='Ref_to_Parameter'>l</span></a> <span class='Operator'>&GT; </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>        <a href="../../../port/qsort_arg.c.html#LN111"><span class='Ref_to_Func'>qsort_arg</span></a><span class='Parentheses'>((</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="tsvector.c.html#LN97"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN97"><span class='Ref_to_Parameter'>l</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="tsvector.c.html#LN22"><span class='Ref_to_Typedef'>WordEntryIN</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="tsvector.c.html#LN80"><span class='Ref_to_Func'>compareentry</span></a><span class='Delimiter'>, 
</span>                  <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="tsvector.c.html#LN97"><span class='Ref_to_Parameter'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsvector.c.html#LN99"><span class='Ref_To_Local'>buflen</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN97"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>; 
</span>    <a href="tsvector.c.html#LN100"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN97"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN100"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>- </span><a href="tsvector.c.html#LN97"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>&LT; </span><a href="tsvector.c.html#LN97"><span class='Ref_to_Parameter'>l</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><span class='Parentheses'>(</span><a href="tsvector.c.html#LN100"><span class='Ref_To_Local'>ptr</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN44"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>== </span><a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN44"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>&& 
</span>              strncmp<span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsvector.c.html#LN97"><span class='Ref_to_Parameter'>buf</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN100"><span class='Ref_To_Local'>ptr</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN45"><span class='Ref_to_Member'>pos</span></a><span class='Delimiter'>], </span><span class='Operator'>&</span><a href="tsvector.c.html#LN97"><span class='Ref_to_Parameter'>buf</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN45"><span class='Ref_to_Member'>pos</span></a><span class='Delimiter'>], 
</span>                      <a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN44"><span class='Ref_to_Member'>len</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* done accumulating data into *res, count space needed */ 
</span>            <a href="tsvector.c.html#LN99"><span class='Ref_To_Local'>buflen</span></a> <span class='Operator'>+= </span><a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN44"><span class='Ref_to_Member'>len</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN43"><span class='Ref_to_Member'>haspos</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN26"><span class='Ref_to_Member'>poslen</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN48"><span class='Ref_to_Func'>uniquePos</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN25"><span class='Ref_to_Member'>pos</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN26"><span class='Ref_to_Member'>poslen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="tsvector.c.html#LN99"><span class='Ref_To_Local'>buflen</span></a> <span class='Operator'>= </span><a href="../../../include/c.h.html#LN583"><span class='Ref_to_Macro'>SHORTALIGN</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN99"><span class='Ref_To_Local'>buflen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="tsvector.c.html#LN99"><span class='Ref_To_Local'>buflen</span></a> <span class='Operator'>+= </span><a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN26"><span class='Ref_to_Member'>poslen</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_type.h.html#LN62"><span class='Ref_to_Typedef'>WordEntryPos</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>!= </span><a href="tsvector.c.html#LN100"><span class='Ref_To_Local'>ptr</span></a><span class='Parentheses'>) 
</span>                memcpy<span class='Parentheses'>(</span><a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN100"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="tsvector.c.html#LN22"><span class='Ref_to_Typedef'>WordEntryIN</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN100"><span class='Ref_To_Local'>ptr</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN43"><span class='Ref_to_Member'>haspos</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN43"><span class='Ref_to_Member'>haspos</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* append ptr's positions to res's positions */ 
</span><a name="LN135"></a>                <span class='Keyword'>int</span>         <span class='Declare_Local'>newlen</span> <span class='Operator'>= </span><a href="tsvector.c.html#LN100"><span class='Ref_To_Local'>ptr</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN26"><span class='Ref_to_Member'>poslen</span></a> <span class='Operator'>+ </span><a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN26"><span class='Ref_to_Member'>poslen</span></a><span class='Delimiter'>; 
</span> 
                <a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN25"><span class='Ref_to_Member'>pos</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_type.h.html#LN62"><span class='Ref_to_Typedef'>WordEntryPos</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>                    <a href="../../../include/common/fe_memutils.h.html#LN36"><span class='Ref_to_Proto'>repalloc</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN25"><span class='Ref_to_Member'>pos</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN135"><span class='Ref_To_Local'>newlen</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_type.h.html#LN62"><span class='Ref_to_Typedef'>WordEntryPos</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                memcpy<span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN25"><span class='Ref_to_Member'>pos</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN26"><span class='Ref_to_Member'>poslen</span></a><span class='Delimiter'>], </span><a href="tsvector.c.html#LN100"><span class='Ref_To_Local'>ptr</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN25"><span class='Ref_to_Member'>pos</span></a><span class='Delimiter'>, 
</span>                       <a href="tsvector.c.html#LN100"><span class='Ref_To_Local'>ptr</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN26"><span class='Ref_to_Member'>poslen</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_type.h.html#LN62"><span class='Ref_to_Typedef'>WordEntryPos</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN26"><span class='Ref_to_Member'>poslen</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN135"><span class='Ref_To_Local'>newlen</span></a><span class='Delimiter'>; 
</span>                <a href="../../../include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN100"><span class='Ref_To_Local'>ptr</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN25"><span class='Ref_to_Member'>pos</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* just give ptr's positions to pos */ 
</span>                <a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN43"><span class='Ref_to_Member'>haspos</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                <a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN25"><span class='Ref_to_Member'>pos</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN100"><span class='Ref_To_Local'>ptr</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN25"><span class='Ref_to_Member'>pos</span></a><span class='Delimiter'>; 
</span>                <a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN26"><span class='Ref_to_Member'>poslen</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN100"><span class='Ref_To_Local'>ptr</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN26"><span class='Ref_to_Member'>poslen</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if ptr-&GT;entry.haspos &raquo; </span> 
        <a href="tsvector.c.html#LN100"><span class='Ref_To_Local'>ptr</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while ptr-a&LT;l &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* count space needed for last item */ 
</span>    <a href="tsvector.c.html#LN99"><span class='Ref_To_Local'>buflen</span></a> <span class='Operator'>+= </span><a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN44"><span class='Ref_to_Member'>len</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN43"><span class='Ref_to_Member'>haspos</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN26"><span class='Ref_to_Member'>poslen</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN48"><span class='Ref_to_Func'>uniquePos</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN25"><span class='Ref_to_Member'>pos</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN26"><span class='Ref_to_Member'>poslen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="tsvector.c.html#LN99"><span class='Ref_To_Local'>buflen</span></a> <span class='Operator'>= </span><a href="../../../include/c.h.html#LN583"><span class='Ref_to_Macro'>SHORTALIGN</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN99"><span class='Ref_To_Local'>buflen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="tsvector.c.html#LN99"><span class='Ref_To_Local'>buflen</span></a> <span class='Operator'>+= </span><a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="tsvector.c.html#LN26"><span class='Ref_to_Member'>poslen</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_type.h.html#LN62"><span class='Ref_to_Typedef'>WordEntryPos</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Operator'>*</span><a href="tsvector.c.html#LN97"><span class='Ref_to_Parameter'>outbuflen</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN99"><span class='Ref_To_Local'>buflen</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="tsvector.c.html#LN101"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>+ </span><span class='Number'>1</span> <span class='Operator'>- </span><a href="tsvector.c.html#LN97"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end uniqueentry &raquo; </span> 
 
<span class='Keyword'>static int 
</span><a name="LN169"></a><span class='Declare_Function'>WordEntryCMP</span><span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_type.h.html#LN40"><span class='Ref_to_Typedef'>WordEntry</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="../../../include/tsearch/ts_type.h.html#LN40"><span class='Ref_to_Typedef'>WordEntry</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>b</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>buf</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="tsvector.c.html#LN80"><span class='Ref_to_Func'>compareentry</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN169"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN169"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN169"><span class='Ref_to_Parameter'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN176"></a><span class='Declare_Function'>tsvectorin</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN178"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>buf</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN241"><span class='Ref_to_Macro'>PG_GETARG_CSTRING</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN179"></a>    <a href="../../../include/tsearch/ts_utils.h.html#LN25"><span class='Ref_to_Typedef'>TSVectorParseState</span></a> <span class='Declare_Local'>state</span><span class='Delimiter'>; 
</span><a name="LN180"></a>    <a href="tsvector.c.html#LN22"><span class='Ref_to_Typedef'>WordEntryIN</span></a> <span class='Operator'>*</span><span class='Declare_Local'>arr</span><span class='Delimiter'>; 
</span><a name="LN181"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>totallen</span><span class='Delimiter'>; 
</span><a name="LN182"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>arrlen</span><span class='Delimiter'>;</span>         <span class='Comment_Single_Line'>/* allocated size of arr */ 
</span><a name="LN183"></a>    <a href="../../../include/tsearch/ts_type.h.html#LN40"><span class='Ref_to_Typedef'>WordEntry</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>inarr</span><span class='Delimiter'>; 
</span><a name="LN184"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN185"></a>    <a href="../../../include/tsearch/ts_type.h.html#LN106"><span class='Ref_to_Typedef'>TSVector</span></a>    <span class='Declare_Local'>in</span><span class='Delimiter'>; 
</span><a name="LN186"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN187"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>token</span><span class='Delimiter'>; 
</span><a name="LN188"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>toklen</span><span class='Delimiter'>; 
</span><a name="LN189"></a>    <a href="../../../include/tsearch/ts_type.h.html#LN62"><span class='Ref_to_Typedef'>WordEntryPos</span></a> <span class='Operator'>*</span><span class='Declare_Local'>pos</span><span class='Delimiter'>; 
</span><a name="LN190"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>poslen</span><span class='Delimiter'>; 
</span><a name="LN191"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>strbuf</span><span class='Delimiter'>; 
</span><a name="LN192"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>stroff</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Tokens are appended to tmpbuf, cur is a pointer to the end of used 
     * space in tmpbuf. 
     */ 
</span><a name="LN198"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>tmpbuf</span><span class='Delimiter'>; 
</span><a name="LN199"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>cur</span><span class='Delimiter'>; 
</span><a name="LN200"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>buflen</span> <span class='Operator'>= </span><span class='Number'>256</span><span class='Delimiter'>;</span>   <span class='Comment_Single_Line'>/* allocated size of tmpbuf */ 
</span> 
    <a href="tsvector.c.html#LN179"><span class='Ref_To_Local'>state</span></a> <span class='Operator'>= </span><a href="../../../include/tsearch/ts_utils.h.html#LN27"><span class='Ref_to_Proto'>init_tsvector_parser</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN178"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsvector.c.html#LN182"><span class='Ref_To_Local'>arrlen</span></a> <span class='Operator'>= </span><span class='Number'>64</span><span class='Delimiter'>; 
</span>    <a href="tsvector.c.html#LN180"><span class='Ref_To_Local'>arr</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="tsvector.c.html#LN22"><span class='Ref_to_Typedef'>WordEntryIN</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="tsvector.c.html#LN22"><span class='Ref_to_Typedef'>WordEntryIN</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="tsvector.c.html#LN182"><span class='Ref_To_Local'>arrlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="tsvector.c.html#LN199"><span class='Ref_To_Local'>cur</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN198"><span class='Ref_To_Local'>tmpbuf</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN200"><span class='Ref_To_Local'>buflen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_utils.h.html#LN31"><span class='Ref_to_Proto'>gettoken_tsvector</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN179"><span class='Ref_To_Local'>state</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsvector.c.html#LN187"><span class='Ref_To_Local'>token</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsvector.c.html#LN188"><span class='Ref_To_Local'>toklen</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsvector.c.html#LN189"><span class='Ref_To_Local'>pos</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsvector.c.html#LN190"><span class='Ref_To_Local'>poslen</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN188"><span class='Ref_To_Local'>toklen</span></a> <span class='Operator'>&GT;= </span><a href="../../../include/tsearch/ts_type.h.html#LN48"><span class='Ref_to_Const'>MAXSTRLEN</span></a><span class='Parentheses'>) 
</span>            <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_PROGRAM_LIMIT_EXCEEDED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"word is too long (%ld bytes, max %ld bytes)"</span><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><span class='Keyword'>long</span><span class='Parentheses'>) </span><a href="tsvector.c.html#LN188"><span class='Ref_To_Local'>toklen</span></a><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><span class='Keyword'>long</span><span class='Parentheses'>) (</span><a href="../../../include/tsearch/ts_type.h.html#LN48"><span class='Ref_to_Const'>MAXSTRLEN</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>))))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN199"><span class='Ref_To_Local'>cur</span></a> <span class='Operator'>- </span><a href="tsvector.c.html#LN198"><span class='Ref_To_Local'>tmpbuf</span></a> <span class='Operator'>&GT; </span><a href="../../../include/tsearch/ts_type.h.html#LN49"><span class='Ref_to_Const'>MAXSTRPOS</span></a><span class='Parentheses'>) 
</span>            <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_PROGRAM_LIMIT_EXCEEDED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"string is too long for tsvector (%ld bytes, max %ld bytes)"</span><span class='Delimiter'>, 
</span>                            <span class='Parentheses'>(</span><span class='Keyword'>long</span><span class='Parentheses'>) (</span><a href="tsvector.c.html#LN199"><span class='Ref_To_Local'>cur</span></a> <span class='Operator'>- </span><a href="tsvector.c.html#LN198"><span class='Ref_To_Local'>tmpbuf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>long</span><span class='Parentheses'>) </span><a href="../../../include/tsearch/ts_type.h.html#LN49"><span class='Ref_to_Const'>MAXSTRPOS</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Enlarge buffers if needed 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN184"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>&GT;= </span><a href="tsvector.c.html#LN182"><span class='Ref_To_Local'>arrlen</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="tsvector.c.html#LN182"><span class='Ref_To_Local'>arrlen</span></a> <span class='Operator'>*= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>            <a href="tsvector.c.html#LN180"><span class='Ref_To_Local'>arr</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="tsvector.c.html#LN22"><span class='Ref_to_Typedef'>WordEntryIN</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>                <a href="../../../include/common/fe_memutils.h.html#LN36"><span class='Ref_to_Proto'>repalloc</span></a><span class='Parentheses'>((</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="tsvector.c.html#LN180"><span class='Ref_To_Local'>arr</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="tsvector.c.html#LN22"><span class='Ref_to_Typedef'>WordEntryIN</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="tsvector.c.html#LN182"><span class='Ref_To_Local'>arrlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>while</span> <span class='Parentheses'>((</span><a href="tsvector.c.html#LN199"><span class='Ref_To_Local'>cur</span></a> <span class='Operator'>- </span><a href="tsvector.c.html#LN198"><span class='Ref_To_Local'>tmpbuf</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="tsvector.c.html#LN188"><span class='Ref_To_Local'>toklen</span></a> <span class='Operator'>&GT;= </span><a href="tsvector.c.html#LN200"><span class='Ref_To_Local'>buflen</span></a><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span><a name="LN234"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>dist</span> <span class='Operator'>= </span><a href="tsvector.c.html#LN199"><span class='Ref_To_Local'>cur</span></a> <span class='Operator'>- </span><a href="tsvector.c.html#LN198"><span class='Ref_To_Local'>tmpbuf</span></a><span class='Delimiter'>; 
</span> 
            <a href="tsvector.c.html#LN200"><span class='Ref_To_Local'>buflen</span></a> <span class='Operator'>*= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>            <a href="tsvector.c.html#LN198"><span class='Ref_To_Local'>tmpbuf</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN36"><span class='Ref_to_Proto'>repalloc</span></a><span class='Parentheses'>((</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="tsvector.c.html#LN198"><span class='Ref_To_Local'>tmpbuf</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN200"><span class='Ref_To_Local'>buflen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="tsvector.c.html#LN199"><span class='Ref_To_Local'>cur</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN198"><span class='Ref_To_Local'>tmpbuf</span></a> <span class='Operator'>+ </span><a href="tsvector.c.html#LN234"><span class='Ref_To_Local'>dist</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="tsvector.c.html#LN180"><span class='Ref_To_Local'>arr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN184"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN44"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN188"><span class='Ref_To_Local'>toklen</span></a><span class='Delimiter'>; 
</span>        <a href="tsvector.c.html#LN180"><span class='Ref_To_Local'>arr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN184"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN45"><span class='Ref_to_Member'>pos</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN199"><span class='Ref_To_Local'>cur</span></a> <span class='Operator'>- </span><a href="tsvector.c.html#LN198"><span class='Ref_To_Local'>tmpbuf</span></a><span class='Delimiter'>; 
</span>        memcpy<span class='Parentheses'>((</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="tsvector.c.html#LN199"><span class='Ref_To_Local'>cur</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="tsvector.c.html#LN187"><span class='Ref_To_Local'>token</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN188"><span class='Ref_To_Local'>toklen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="tsvector.c.html#LN199"><span class='Ref_To_Local'>cur</span></a> <span class='Operator'>+= </span><a href="tsvector.c.html#LN188"><span class='Ref_To_Local'>toklen</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN190"><span class='Ref_To_Local'>poslen</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="tsvector.c.html#LN180"><span class='Ref_To_Local'>arr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN184"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN43"><span class='Ref_to_Member'>haspos</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <a href="tsvector.c.html#LN180"><span class='Ref_To_Local'>arr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN184"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="tsvector.c.html#LN25"><span class='Ref_to_Member'>pos</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN189"><span class='Ref_To_Local'>pos</span></a><span class='Delimiter'>; 
</span>            <a href="tsvector.c.html#LN180"><span class='Ref_To_Local'>arr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN184"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="tsvector.c.html#LN26"><span class='Ref_to_Member'>poslen</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN190"><span class='Ref_To_Local'>poslen</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="tsvector.c.html#LN180"><span class='Ref_To_Local'>arr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN184"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN43"><span class='Ref_to_Member'>haspos</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <a href="tsvector.c.html#LN180"><span class='Ref_To_Local'>arr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN184"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="tsvector.c.html#LN25"><span class='Ref_to_Member'>pos</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <a href="tsvector.c.html#LN180"><span class='Ref_To_Local'>arr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN184"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="tsvector.c.html#LN26"><span class='Ref_to_Member'>poslen</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="tsvector.c.html#LN184"><span class='Ref_To_Local'>len</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while gettoken_tsvector(sta... &raquo; </span> 
 
    <a href="../../../include/tsearch/ts_utils.h.html#LN35"><span class='Ref_to_Proto'>close_tsvector_parser</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN179"><span class='Ref_To_Local'>state</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN184"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="tsvector.c.html#LN184"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN96"><span class='Ref_to_Func'>uniqueentry</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN180"><span class='Ref_To_Local'>arr</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN184"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN198"><span class='Ref_To_Local'>tmpbuf</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsvector.c.html#LN200"><span class='Ref_To_Local'>buflen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="tsvector.c.html#LN200"><span class='Ref_To_Local'>buflen</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN200"><span class='Ref_To_Local'>buflen</span></a> <span class='Operator'>&GT; </span><a href="../../../include/tsearch/ts_type.h.html#LN49"><span class='Ref_to_Const'>MAXSTRPOS</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_PROGRAM_LIMIT_EXCEEDED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"string is too long for tsvector (%d bytes, max %d bytes)"</span><span class='Delimiter'>, </span><a href="tsvector.c.html#LN200"><span class='Ref_To_Local'>buflen</span></a><span class='Delimiter'>, </span><a href="../../../include/tsearch/ts_type.h.html#LN49"><span class='Ref_to_Const'>MAXSTRPOS</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="tsvector.c.html#LN181"><span class='Ref_To_Local'>totallen</span></a> <span class='Operator'>= </span><a href="../../../../contrib/hstore/hstore.h.html#LN71"><span class='Ref_to_Macro'>CALCDATASIZE</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN184"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN200"><span class='Ref_To_Local'>buflen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="tsvector.c.html#LN185"><span class='Ref_To_Local'>in</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_type.h.html#LN106"><span class='Ref_to_Typedef'>TSVector</span></a><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN181"><span class='Ref_To_Local'>totallen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN185"><span class='Ref_To_Local'>in</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN181"><span class='Ref_To_Local'>totallen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="tsvector.c.html#LN185"><span class='Ref_To_Local'>in</span></a><span class='Operator'>-&GT;</span><a href="../../../include/tsearch/ts_type.h.html#LN101"><span class='Ref_to_Member'>size</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN184"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
</span>    <a href="tsvector.c.html#LN183"><span class='Ref_To_Local'>inarr</span></a> <span class='Operator'>= </span><a href="../../../../contrib/intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN185"><span class='Ref_To_Local'>in</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="tsvector.c.html#LN191"><span class='Ref_To_Local'>strbuf</span></a> <span class='Operator'>= </span><a href="../../../../contrib/hstore/hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN185"><span class='Ref_To_Local'>in</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="tsvector.c.html#LN192"><span class='Ref_To_Local'>stroff</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN186"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="tsvector.c.html#LN186"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="tsvector.c.html#LN184"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; </span><a href="tsvector.c.html#LN186"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        memcpy<span class='Parentheses'>(</span><a href="tsvector.c.html#LN191"><span class='Ref_To_Local'>strbuf</span></a> <span class='Operator'>+ </span><a href="tsvector.c.html#LN192"><span class='Ref_To_Local'>stroff</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsvector.c.html#LN198"><span class='Ref_To_Local'>tmpbuf</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN180"><span class='Ref_To_Local'>arr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN186"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN45"><span class='Ref_to_Member'>pos</span></a><span class='Delimiter'>], </span><a href="tsvector.c.html#LN180"><span class='Ref_To_Local'>arr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN186"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN44"><span class='Ref_to_Member'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="tsvector.c.html#LN180"><span class='Ref_To_Local'>arr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN186"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN45"><span class='Ref_to_Member'>pos</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN192"><span class='Ref_To_Local'>stroff</span></a><span class='Delimiter'>; 
</span>        <a href="tsvector.c.html#LN192"><span class='Ref_To_Local'>stroff</span></a> <span class='Operator'>+= </span><a href="tsvector.c.html#LN180"><span class='Ref_To_Local'>arr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN186"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN44"><span class='Ref_to_Member'>len</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN180"><span class='Ref_To_Local'>arr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN186"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN43"><span class='Ref_to_Member'>haspos</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN180"><span class='Ref_To_Local'>arr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN186"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="tsvector.c.html#LN26"><span class='Ref_to_Member'>poslen</span></a> <span class='Operator'>&GT; </span><span class='Number'>0xFFFF</span><span class='Parentheses'>) 
</span>                <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"positions array too long"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Copy number of positions */ 
</span>            <a href="tsvector.c.html#LN192"><span class='Ref_To_Local'>stroff</span></a> <span class='Operator'>= </span><a href="../../../include/c.h.html#LN583"><span class='Ref_to_Macro'>SHORTALIGN</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN192"><span class='Ref_To_Local'>stroff</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a> <span class='Operator'>*</span><span class='Parentheses'>) (</span><a href="tsvector.c.html#LN191"><span class='Ref_To_Local'>strbuf</span></a> <span class='Operator'>+ </span><a href="tsvector.c.html#LN192"><span class='Ref_To_Local'>stroff</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a><span class='Parentheses'>) </span><a href="tsvector.c.html#LN180"><span class='Ref_To_Local'>arr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN186"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="tsvector.c.html#LN26"><span class='Ref_to_Member'>poslen</span></a><span class='Delimiter'>; 
</span>            <a href="tsvector.c.html#LN192"><span class='Ref_To_Local'>stroff</span></a> <span class='Operator'>+= </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Copy positions */ 
</span>            memcpy<span class='Parentheses'>(</span><a href="tsvector.c.html#LN191"><span class='Ref_To_Local'>strbuf</span></a> <span class='Operator'>+ </span><a href="tsvector.c.html#LN192"><span class='Ref_To_Local'>stroff</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN180"><span class='Ref_To_Local'>arr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN186"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="tsvector.c.html#LN25"><span class='Ref_to_Member'>pos</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN180"><span class='Ref_To_Local'>arr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN186"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="tsvector.c.html#LN26"><span class='Ref_to_Member'>poslen</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_type.h.html#LN62"><span class='Ref_to_Typedef'>WordEntryPos</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <a href="tsvector.c.html#LN192"><span class='Ref_To_Local'>stroff</span></a> <span class='Operator'>+= </span><a href="tsvector.c.html#LN180"><span class='Ref_To_Local'>arr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN186"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="tsvector.c.html#LN26"><span class='Ref_to_Member'>poslen</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_type.h.html#LN62"><span class='Ref_to_Typedef'>WordEntryPos</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="../../../include/common/fe_memutils.h.html#LN37"><span class='Ref_to_Proto'>pfree</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN180"><span class='Ref_To_Local'>arr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN186"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="tsvector.c.html#LN25"><span class='Ref_to_Member'>pos</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="tsvector.c.html#LN183"><span class='Ref_To_Local'>inarr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN186"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="tsvector.c.html#LN180"><span class='Ref_To_Local'>arr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN186"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="tsvector.c.html#LN24"><span class='Ref_to_Member'>entry</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=0;i&LT;len;i++ &raquo; </span> 
 
    <span class='Debug'>Assert</span><span class='Parentheses'>((</span><a href="tsvector.c.html#LN191"><span class='Ref_To_Local'>strbuf</span></a> <span class='Operator'>+ </span><a href="tsvector.c.html#LN192"><span class='Ref_To_Local'>stroff</span></a> <span class='Operator'>- </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="tsvector.c.html#LN185"><span class='Ref_To_Local'>in</span></a><span class='Parentheses'>)</span> <span class='Operator'>== </span><a href="tsvector.c.html#LN181"><span class='Ref_To_Local'>totallen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/tsearch/ts_type.h.html#LN130"><span class='Ref_to_Macro'>PG_RETURN_TSVECTOR</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN185"><span class='Ref_To_Local'>in</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end tsvectorin &raquo; </span> 
 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN309"></a><span class='Declare_Function'>tsvectorout</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN311"></a>    <a href="../../../include/tsearch/ts_type.h.html#LN106"><span class='Ref_to_Typedef'>TSVector</span></a>    <span class='Declare_Local'>out</span> <span class='Operator'>= </span><a href="../../../include/tsearch/ts_type.h.html#LN128"><span class='Ref_to_Macro'>PG_GETARG_TSVECTOR</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN312"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>outbuf</span><span class='Delimiter'>; 
</span><a name="LN313"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>i</span><span class='Delimiter'>, 
</span><a name="LN314"></a>                <span class='Declare_Local'>lenbuf</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>, 
</span><a name="LN315"></a>                <span class='Declare_Local'>pp</span><span class='Delimiter'>; 
</span><a name="LN316"></a>    <a href="../../../include/tsearch/ts_type.h.html#LN40"><span class='Ref_to_Typedef'>WordEntry</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>ptr</span> <span class='Operator'>= </span><a href="../../../../contrib/intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN311"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN317"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>curbegin</span><span class='Delimiter'>, 
</span><a name="LN318"></a>               <span class='Operator'>*</span><span class='Declare_Local'>curin</span><span class='Delimiter'>, 
</span><a name="LN319"></a>               <span class='Operator'>*</span><span class='Declare_Local'>curout</span><span class='Delimiter'>; 
</span> 
    <a href="tsvector.c.html#LN314"><span class='Ref_To_Local'>lenbuf</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN311"><span class='Ref_To_Local'>out</span></a><span class='Operator'>-&GT;</span><a href="../../../include/tsearch/ts_type.h.html#LN101"><span class='Ref_to_Member'>size</span></a> <span class='Operator'>* </span><span class='Number'>2</span> <span class='Comment_Multi_Line'>/* '' */ </span><span class='Operator'>+ </span><a href="tsvector.c.html#LN311"><span class='Ref_To_Local'>out</span></a><span class='Operator'>-&GT;</span><a href="../../../include/tsearch/ts_type.h.html#LN101"><span class='Ref_to_Member'>size</span></a> <span class='Operator'>- </span><span class='Number'>1</span> <span class='Comment_Multi_Line'>/* space */ </span><span class='Operator'>+ </span><span class='Number'>2</span> <span class='Comment_Multi_Line'>/* \0 */ </span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN313"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="tsvector.c.html#LN313"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="tsvector.c.html#LN311"><span class='Ref_To_Local'>out</span></a><span class='Operator'>-&GT;</span><a href="../../../include/tsearch/ts_type.h.html#LN101"><span class='Ref_to_Member'>size</span></a><span class='Delimiter'>; </span><a href="tsvector.c.html#LN313"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="tsvector.c.html#LN314"><span class='Ref_To_Local'>lenbuf</span></a> <span class='Operator'>+= </span><a href="tsvector.c.html#LN316"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN313"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN44"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>* </span><span class='Number'>2</span> <span class='Operator'>* </span><a href="../../../include/mb/pg_wchar.h.html#LN535"><span class='Ref_to_Proto'>pg_database_encoding_max_length</span></a><span class='Parentheses'>() </span><span class='Comment_Multi_Line'>/* for escape */ </span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN316"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN313"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN43"><span class='Ref_to_Member'>haspos</span></a><span class='Parentheses'>) 
</span>            <a href="tsvector.c.html#LN314"><span class='Ref_To_Local'>lenbuf</span></a> <span class='Operator'>+= </span><span class='Number'>1</span> <span class='Comment_Multi_Line'>/* : */ </span><span class='Operator'>+ </span><span class='Number'>7</span> <span class='Comment_Multi_Line'>/* int2 + , + weight */ </span><span class='Operator'>* </span><a href="../../../include/tsearch/ts_type.h.html#LN118"><span class='Ref_to_Macro'>POSDATALEN</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN311"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><span class='Parentheses'>(</span><a href="tsvector.c.html#LN316"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN313"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="tsvector.c.html#LN319"><span class='Ref_To_Local'>curout</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN312"><span class='Ref_To_Local'>outbuf</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN314"><span class='Ref_To_Local'>lenbuf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN313"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="tsvector.c.html#LN313"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="tsvector.c.html#LN311"><span class='Ref_To_Local'>out</span></a><span class='Operator'>-&GT;</span><a href="../../../include/tsearch/ts_type.h.html#LN101"><span class='Ref_to_Member'>size</span></a><span class='Delimiter'>; </span><a href="tsvector.c.html#LN313"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="tsvector.c.html#LN317"><span class='Ref_To_Local'>curbegin</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN318"><span class='Ref_To_Local'>curin</span></a> <span class='Operator'>= </span><a href="../../../../contrib/hstore/hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN311"><span class='Ref_To_Local'>out</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="tsvector.c.html#LN316"><span class='Ref_To_Local'>ptr</span></a><span class='Operator'>-&GT;</span><a href="../../../include/tsearch/ts_type.h.html#LN45"><span class='Ref_to_Member'>pos</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN313"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Operator'>*</span><a href="tsvector.c.html#LN319"><span class='Ref_To_Local'>curout</span></a><span class='Operator'>++ = </span><span class='String'>' '</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="tsvector.c.html#LN319"><span class='Ref_To_Local'>curout</span></a><span class='Operator'>++ = </span><span class='String'>'\''</span><span class='Delimiter'>; 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN318"><span class='Ref_To_Local'>curin</span></a> <span class='Operator'>- </span><a href="tsvector.c.html#LN317"><span class='Ref_To_Local'>curbegin</span></a> <span class='Operator'>&LT; </span><a href="tsvector.c.html#LN316"><span class='Ref_To_Local'>ptr</span></a><span class='Operator'>-&GT;</span><a href="../../../include/tsearch/ts_type.h.html#LN44"><span class='Ref_to_Member'>len</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN338"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span> <span class='Operator'>= </span><a href="../../../include/mb/pg_wchar.h.html#LN521"><span class='Ref_to_Proto'>pg_mblen</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN318"><span class='Ref_To_Local'>curin</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_locale.h.html#LN51"><span class='Ref_to_Macro'>t_iseq</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN318"><span class='Ref_To_Local'>curin</span></a><span class='Delimiter'>, </span><span class='String'>'\''</span><span class='Parentheses'>))</span> 
                <span class='Operator'>*</span><a href="tsvector.c.html#LN319"><span class='Ref_To_Local'>curout</span></a><span class='Operator'>++ = </span><span class='String'>'\''</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_locale.h.html#LN51"><span class='Ref_to_Macro'>t_iseq</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN318"><span class='Ref_To_Local'>curin</span></a><span class='Delimiter'>, </span><span class='String'>'\\'</span><span class='Parentheses'>))</span> 
                <span class='Operator'>*</span><a href="tsvector.c.html#LN319"><span class='Ref_To_Local'>curout</span></a><span class='Operator'>++ = </span><span class='String'>'\\'</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN338"><span class='Ref_To_Local'>len</span></a><span class='Operator'>--</span><span class='Parentheses'>) 
</span>                <span class='Operator'>*</span><a href="tsvector.c.html#LN319"><span class='Ref_To_Local'>curout</span></a><span class='Operator'>++ = *</span><a href="tsvector.c.html#LN318"><span class='Ref_To_Local'>curin</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Operator'>*</span><a href="tsvector.c.html#LN319"><span class='Ref_To_Local'>curout</span></a><span class='Operator'>++ = </span><span class='String'>'\''</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="tsvector.c.html#LN315"><span class='Ref_To_Local'>pp</span></a> <span class='Operator'>= </span><a href="../../../include/tsearch/ts_type.h.html#LN118"><span class='Ref_to_Macro'>POSDATALEN</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN311"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN316"><span class='Ref_To_Local'>ptr</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span><a name="LN352"></a>            <a href="../../../include/tsearch/ts_type.h.html#LN62"><span class='Ref_to_Typedef'>WordEntryPos</span></a> <span class='Operator'>*</span><span class='Declare_Local'>wptr</span><span class='Delimiter'>; 
</span> 
            <span class='Operator'>*</span><a href="tsvector.c.html#LN319"><span class='Ref_To_Local'>curout</span></a><span class='Operator'>++ = </span><span class='String'>':'</span><span class='Delimiter'>; 
</span>            <a href="tsvector.c.html#LN352"><span class='Ref_To_Local'>wptr</span></a> <span class='Operator'>= </span><a href="../../../include/tsearch/ts_type.h.html#LN119"><span class='Ref_to_Macro'>POSDATAPTR</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN311"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN316"><span class='Ref_To_Local'>ptr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN315"><span class='Ref_To_Local'>pp</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="tsvector.c.html#LN319"><span class='Ref_To_Local'>curout</span></a> <span class='Operator'>+= </span><a href="../../../include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN319"><span class='Ref_To_Local'>curout</span></a><span class='Delimiter'>, </span><span class='String'>"%d"</span><span class='Delimiter'>, </span><a href="../../../include/tsearch/ts_type.h.html#LN79"><span class='Ref_to_Macro'>WEP_GETPOS</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="tsvector.c.html#LN352"><span class='Ref_To_Local'>wptr</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_type.h.html#LN78"><span class='Ref_to_Macro'>WEP_GETWEIGHT</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="tsvector.c.html#LN352"><span class='Ref_To_Local'>wptr</span></a><span class='Parentheses'>))</span> 
                <span class='Delimiter'>{ 
</span>                    <span class='Control'>case</span> <span class='Number'>3</span><span class='Operator'>: 
</span>                        <span class='Operator'>*</span><a href="tsvector.c.html#LN319"><span class='Ref_To_Local'>curout</span></a><span class='Operator'>++ = </span><span class='String'>'A'</span><span class='Delimiter'>; 
</span>                        <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Control'>case</span> <span class='Number'>2</span><span class='Operator'>: 
</span>                        <span class='Operator'>*</span><a href="tsvector.c.html#LN319"><span class='Ref_To_Local'>curout</span></a><span class='Operator'>++ = </span><span class='String'>'B'</span><span class='Delimiter'>; 
</span>                        <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Control'>case</span> <span class='Number'>1</span><span class='Operator'>: 
</span>                        <span class='Operator'>*</span><a href="tsvector.c.html#LN319"><span class='Ref_To_Local'>curout</span></a><span class='Operator'>++ = </span><span class='String'>'C'</span><span class='Delimiter'>; 
</span>                        <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Control'>case</span> <span class='Number'>0</span><span class='Operator'>: 
</span>                    <span class='Control'>default</span><span class='Operator'>: 
</span>                        <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span> 
                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN315"><span class='Ref_To_Local'>pp</span></a> <span class='Operator'>&GT; </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>                    <span class='Operator'>*</span><a href="tsvector.c.html#LN319"><span class='Ref_To_Local'>curout</span></a><span class='Operator'>++ = </span><span class='String'>','</span><span class='Delimiter'>; 
</span>                <a href="tsvector.c.html#LN315"><span class='Ref_To_Local'>pp</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>                <a href="tsvector.c.html#LN352"><span class='Ref_To_Local'>wptr</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while pp &raquo; </span> 
        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if (pp=POSDATALEN(out,pt... &raquo; </span> 
        <a href="tsvector.c.html#LN316"><span class='Ref_To_Local'>ptr</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=0;i&LT;out-&GT;size;i++ &raquo; </span> 
 
    <span class='Operator'>*</span><a href="tsvector.c.html#LN319"><span class='Ref_To_Local'>curout</span></a> <span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN311"><span class='Ref_To_Local'>out</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN321"><span class='Ref_to_Macro'>PG_RETURN_CSTRING</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN312"><span class='Ref_To_Local'>outbuf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end tsvectorout &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Binary Input / Output functions. The binary format is as follows: 
 * 
 * uint32   number of lexemes 
 * 
 * for each lexeme: 
 *      lexeme text in client encoding, null-terminated 
 *      uint16  number of positions 
 *      for each position: 
 *          uint16 WordEntryPos 
 */ 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN402"></a><span class='Declare_Function'>tsvectorsend</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN404"></a>    <a href="../../../include/tsearch/ts_type.h.html#LN106"><span class='Ref_to_Typedef'>TSVector</span></a>    <span class='Declare_Local'>vec</span> <span class='Operator'>= </span><a href="../../../include/tsearch/ts_type.h.html#LN128"><span class='Ref_to_Macro'>PG_GETARG_TSVECTOR</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN405"></a>    <a href="../../../include/lib/stringinfo.h.html#LN34"><span class='Ref_to_Struct'>StringInfoData</span></a> <span class='Declare_Local'>buf</span><span class='Delimiter'>; 
</span><a name="LN406"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>, 
</span><a name="LN407"></a>                <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span><a name="LN408"></a>    <a href="../../../include/tsearch/ts_type.h.html#LN40"><span class='Ref_to_Typedef'>WordEntry</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>weptr</span> <span class='Operator'>= </span><a href="../../../../contrib/intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN404"><span class='Ref_To_Local'>vec</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/libpq/pqformat.h.html#LN31"><span class='Ref_to_Proto'>pq_begintypsend</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsvector.c.html#LN405"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/libpq/pqformat.h.html#LN25"><span class='Ref_to_Proto'>pq_sendint</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsvector.c.html#LN405"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN404"><span class='Ref_To_Local'>vec</span></a><span class='Operator'>-&GT;</span><a href="../../../include/tsearch/ts_type.h.html#LN101"><span class='Ref_to_Member'>size</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN406"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="tsvector.c.html#LN406"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="tsvector.c.html#LN404"><span class='Ref_To_Local'>vec</span></a><span class='Operator'>-&GT;</span><a href="../../../include/tsearch/ts_type.h.html#LN101"><span class='Ref_to_Member'>size</span></a><span class='Delimiter'>; </span><a href="tsvector.c.html#LN406"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN415"></a>        <a href="../../../include/c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a>      <span class='Declare_Local'>npos</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * the strings in the TSVector array are not null-terminated, so we 
         * have to send the null-terminator separately 
         */ 
</span>        <a href="../../../include/libpq/pqformat.h.html#LN22"><span class='Ref_to_Proto'>pq_sendtext</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsvector.c.html#LN405"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="../../../../contrib/hstore/hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN404"><span class='Ref_To_Local'>vec</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="tsvector.c.html#LN408"><span class='Ref_To_Local'>weptr</span></a><span class='Operator'>-&GT;</span><a href="../../../include/tsearch/ts_type.h.html#LN45"><span class='Ref_to_Member'>pos</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN408"><span class='Ref_To_Local'>weptr</span></a><span class='Operator'>-&GT;</span><a href="../../../include/tsearch/ts_type.h.html#LN44"><span class='Ref_to_Member'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/libpq/pqformat.h.html#LN18"><span class='Ref_to_Proto'>pq_sendbyte</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsvector.c.html#LN405"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='String'>'\0'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="tsvector.c.html#LN415"><span class='Ref_To_Local'>npos</span></a> <span class='Operator'>= </span><a href="../../../include/tsearch/ts_type.h.html#LN118"><span class='Ref_to_Macro'>POSDATALEN</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN404"><span class='Ref_To_Local'>vec</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN408"><span class='Ref_To_Local'>weptr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/libpq/pqformat.h.html#LN25"><span class='Ref_to_Proto'>pq_sendint</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsvector.c.html#LN405"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN415"><span class='Ref_To_Local'>npos</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN415"><span class='Ref_To_Local'>npos</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN429"></a>            <a href="../../../include/tsearch/ts_type.h.html#LN62"><span class='Ref_to_Typedef'>WordEntryPos</span></a> <span class='Operator'>*</span><span class='Declare_Local'>wepptr</span> <span class='Operator'>= </span><a href="../../../include/tsearch/ts_type.h.html#LN119"><span class='Ref_to_Macro'>POSDATAPTR</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN404"><span class='Ref_To_Local'>vec</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN408"><span class='Ref_To_Local'>weptr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN407"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="tsvector.c.html#LN407"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><a href="tsvector.c.html#LN415"><span class='Ref_To_Local'>npos</span></a><span class='Delimiter'>; </span><a href="tsvector.c.html#LN407"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>                <a href="../../../include/libpq/pqformat.h.html#LN25"><span class='Ref_to_Proto'>pq_sendint</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsvector.c.html#LN405"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN429"><span class='Ref_To_Local'>wepptr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN407"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>], </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_type.h.html#LN62"><span class='Ref_to_Typedef'>WordEntryPos</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="tsvector.c.html#LN408"><span class='Ref_To_Local'>weptr</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=0;i&LT;vec-&GT;size;i++ &raquo; </span> 
 
    <a href="../../../include/fmgr.h.html#LN328"><span class='Ref_to_Macro'>PG_RETURN_BYTEA_P</span></a><span class='Parentheses'>(</span><a href="../../../include/libpq/pqformat.h.html#LN32"><span class='Ref_to_Proto'>pq_endtypsend</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsvector.c.html#LN405"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end tsvectorsend &raquo; </span> 
 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN441"></a><span class='Declare_Function'>tsvectorrecv</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN443"></a>    <a href="../../../include/lib/stringinfo.h.html#LN42"><span class='Ref_to_Typedef'>StringInfo</span></a>  <span class='Declare_Local'>buf</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/lib/stringinfo.h.html#LN42"><span class='Ref_to_Typedef'>StringInfo</span></a><span class='Parentheses'>) </span><a href="../../../include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN444"></a>    <a href="../../../include/tsearch/ts_type.h.html#LN106"><span class='Ref_to_Typedef'>TSVector</span></a>    <span class='Declare_Local'>vec</span><span class='Delimiter'>; 
</span><a name="LN445"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN446"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>nentries</span><span class='Delimiter'>; 
</span><a name="LN447"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>datalen</span><span class='Delimiter'>;</span>        <span class='Comment_Multi_Line'>/* number of bytes used in the variable size 
                                 * area after fixed size TSVector header and 
                                 * WordEntries */ 
</span><a name="LN450"></a>    <a href="../../../include/c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a>        <span class='Declare_Local'>hdrlen</span><span class='Delimiter'>; 
</span><a name="LN451"></a>    <a href="../../../include/c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a>        <span class='Declare_Local'>len</span><span class='Delimiter'>;</span>            <span class='Comment_Single_Line'>/* allocated size of vec */ 
</span><a name="LN452"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>needSort</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <a href="tsvector.c.html#LN446"><span class='Ref_To_Local'>nentries</span></a> <span class='Operator'>= </span><a href="../../../include/libpq/pqformat.h.html#LN38"><span class='Ref_to_Proto'>pq_getmsgint</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN443"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN446"><span class='Ref_To_Local'>nentries</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="tsvector.c.html#LN446"><span class='Ref_To_Local'>nentries</span></a> <span class='Operator'>&GT; </span><span class='Parentheses'>(</span><a href="../../../common/psprintf.c.html#LN27"><span class='Ref_to_Const'>MaxAllocSize</span></a> <span class='Operator'>/ </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_type.h.html#LN40"><span class='Ref_to_Typedef'>WordEntry</span></a><span class='Parentheses'>)))</span> 
        <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"invalid size of tsvector"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="tsvector.c.html#LN450"><span class='Ref_To_Local'>hdrlen</span></a> <span class='Operator'>= </span><a href="../../../include/tsearch/ts_type.h.html#LN108"><span class='Ref_to_Const'>DATAHDRSIZE</span></a> <span class='Operator'>+ </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_type.h.html#LN40"><span class='Ref_to_Typedef'>WordEntry</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="tsvector.c.html#LN446"><span class='Ref_To_Local'>nentries</span></a><span class='Delimiter'>; 
</span> 
    <a href="tsvector.c.html#LN451"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN450"><span class='Ref_To_Local'>hdrlen</span></a> <span class='Operator'>* </span><span class='Number'>2</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* times two to make room for lexemes */ 
</span>    <a href="tsvector.c.html#LN444"><span class='Ref_To_Local'>vec</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_type.h.html#LN106"><span class='Ref_to_Typedef'>TSVector</span></a><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN451"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="tsvector.c.html#LN444"><span class='Ref_To_Local'>vec</span></a><span class='Operator'>-&GT;</span><a href="../../../include/tsearch/ts_type.h.html#LN101"><span class='Ref_to_Member'>size</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN446"><span class='Ref_To_Local'>nentries</span></a><span class='Delimiter'>; 
</span> 
    <a href="tsvector.c.html#LN447"><span class='Ref_To_Local'>datalen</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN445"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="tsvector.c.html#LN445"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="tsvector.c.html#LN446"><span class='Ref_To_Local'>nentries</span></a><span class='Delimiter'>; </span><a href="tsvector.c.html#LN445"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN467"></a>        <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>lexeme</span><span class='Delimiter'>; 
</span><a name="LN468"></a>        <a href="../../../include/c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a>      <span class='Declare_Local'>npos</span><span class='Delimiter'>; 
</span><a name="LN469"></a>        size_t      <span class='Declare_Local'>lex_len</span><span class='Delimiter'>; 
</span> 
        <a href="tsvector.c.html#LN467"><span class='Ref_To_Local'>lexeme</span></a> <span class='Operator'>= </span><a href="../../../include/libpq/pqformat.h.html#LN45"><span class='Ref_to_Proto'>pq_getmsgstring</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN443"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="tsvector.c.html#LN468"><span class='Ref_To_Local'>npos</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a><span class='Parentheses'>) </span><a href="../../../include/libpq/pqformat.h.html#LN38"><span class='Ref_to_Proto'>pq_getmsgint</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN443"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* sanity checks */ 
</span> 
        <a href="tsvector.c.html#LN469"><span class='Ref_To_Local'>lex_len</span></a> <span class='Operator'>= </span>strlen<span class='Parentheses'>(</span><a href="tsvector.c.html#LN467"><span class='Ref_To_Local'>lexeme</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN469"><span class='Ref_To_Local'>lex_len</span></a> <span class='Operator'>&GT; </span><a href="../../../include/tsearch/ts_type.h.html#LN48"><span class='Ref_to_Const'>MAXSTRLEN</span></a><span class='Parentheses'>) 
</span>            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"invalid tsvector: lexeme too long"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN447"><span class='Ref_To_Local'>datalen</span></a> <span class='Operator'>&GT; </span><a href="../../../include/tsearch/ts_type.h.html#LN49"><span class='Ref_to_Const'>MAXSTRPOS</span></a><span class='Parentheses'>) 
</span>            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"invalid tsvector: maximum total lexeme length exceeded"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN468"><span class='Ref_To_Local'>npos</span></a> <span class='Operator'>&GT; </span><a href="../../../include/tsearch/ts_type.h.html#LN85"><span class='Ref_to_Const'>MAXNUMPOS</span></a><span class='Parentheses'>) 
</span>            <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"unexpected number of tsvector positions"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Looks valid. Fill the WordEntry struct, and copy lexeme. 
         * 
         * But make sure the buffer is large enough first. 
         */ 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN450"><span class='Ref_To_Local'>hdrlen</span></a> <span class='Operator'>+ </span><a href="../../../include/c.h.html#LN583"><span class='Ref_to_Macro'>SHORTALIGN</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN447"><span class='Ref_To_Local'>datalen</span></a> <span class='Operator'>+ </span><a href="tsvector.c.html#LN469"><span class='Ref_To_Local'>lex_len</span></a><span class='Parentheses'>) </span><span class='Operator'>+ 
</span>               <span class='Parentheses'>(</span><a href="tsvector.c.html#LN468"><span class='Ref_To_Local'>npos</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_type.h.html#LN62"><span class='Ref_to_Typedef'>WordEntryPos</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><a href="tsvector.c.html#LN451"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="tsvector.c.html#LN451"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>*= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>            <a href="tsvector.c.html#LN444"><span class='Ref_To_Local'>vec</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_type.h.html#LN106"><span class='Ref_to_Typedef'>TSVector</span></a><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN36"><span class='Ref_to_Proto'>repalloc</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN444"><span class='Ref_To_Local'>vec</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN451"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="tsvector.c.html#LN444"><span class='Ref_To_Local'>vec</span></a><span class='Operator'>-&GT;</span><a href="../../../include/tsearch/ts_type.h.html#LN102"><span class='Ref_to_Member'>entries</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN445"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN43"><span class='Ref_to_Member'>haspos</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="tsvector.c.html#LN468"><span class='Ref_To_Local'>npos</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='Number'>1</span> <span class='Operator'>: </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="tsvector.c.html#LN444"><span class='Ref_To_Local'>vec</span></a><span class='Operator'>-&GT;</span><a href="../../../include/tsearch/ts_type.h.html#LN102"><span class='Ref_to_Member'>entries</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN445"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN44"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN469"><span class='Ref_To_Local'>lex_len</span></a><span class='Delimiter'>; 
</span>        <a href="tsvector.c.html#LN444"><span class='Ref_To_Local'>vec</span></a><span class='Operator'>-&GT;</span><a href="../../../include/tsearch/ts_type.h.html#LN102"><span class='Ref_to_Member'>entries</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN445"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/tsearch/ts_type.h.html#LN45"><span class='Ref_to_Member'>pos</span></a> <span class='Operator'>= </span><a href="tsvector.c.html#LN447"><span class='Ref_To_Local'>datalen</span></a><span class='Delimiter'>; 
</span> 
        memcpy<span class='Parentheses'>(</span><a href="../../../../contrib/hstore/hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN444"><span class='Ref_To_Local'>vec</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="tsvector.c.html#LN447"><span class='Ref_To_Local'>datalen</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN467"><span class='Ref_To_Local'>lexeme</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN469"><span class='Ref_To_Local'>lex_len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="tsvector.c.html#LN447"><span class='Ref_To_Local'>datalen</span></a> <span class='Operator'>+= </span><a href="tsvector.c.html#LN469"><span class='Ref_To_Local'>lex_len</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN445"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="tsvector.c.html#LN168"><span class='Ref_to_Func'>WordEntryCMP</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="tsvector.c.html#LN444"><span class='Ref_To_Local'>vec</span></a><span class='Operator'>-&GT;</span><a href="../../../include/tsearch/ts_type.h.html#LN102"><span class='Ref_to_Member'>entries</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN445"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>], 
</span>                                  <span class='Operator'>&</span><a href="tsvector.c.html#LN444"><span class='Ref_To_Local'>vec</span></a><span class='Operator'>-&GT;</span><a href="../../../include/tsearch/ts_type.h.html#LN102"><span class='Ref_to_Member'>entries</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN445"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>], 
</span>                                  <a href="../../../../contrib/hstore/hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN444"><span class='Ref_To_Local'>vec</span></a><span class='Parentheses'>))</span> <span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="tsvector.c.html#LN452"><span class='Ref_To_Local'>needSort</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Receive positions */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN468"><span class='Ref_To_Local'>npos</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN514"></a>            <a href="../../../include/c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a>      <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span><a name="LN515"></a>            <a href="../../../include/tsearch/ts_type.h.html#LN62"><span class='Ref_to_Typedef'>WordEntryPos</span></a> <span class='Operator'>*</span><span class='Declare_Local'>wepptr</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Pad to 2-byte alignment if necessary. Though we used palloc0 
             * for the initial allocation, subsequent repalloc'd memory areas 
             * are not initialized to zero. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN447"><span class='Ref_To_Local'>datalen</span></a> <span class='Operator'>!= </span><a href="../../../include/c.h.html#LN583"><span class='Ref_to_Macro'>SHORTALIGN</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN447"><span class='Ref_To_Local'>datalen</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Operator'>*</span><span class='Parentheses'>(</span><a href="../../../../contrib/hstore/hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN444"><span class='Ref_To_Local'>vec</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="tsvector.c.html#LN447"><span class='Ref_To_Local'>datalen</span></a><span class='Parentheses'>)</span> <span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>                <a href="tsvector.c.html#LN447"><span class='Ref_To_Local'>datalen</span></a> <span class='Operator'>= </span><a href="../../../include/c.h.html#LN583"><span class='Ref_to_Macro'>SHORTALIGN</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN447"><span class='Ref_To_Local'>datalen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            memcpy<span class='Parentheses'>(</span><a href="../../../../contrib/hstore/hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN444"><span class='Ref_To_Local'>vec</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="tsvector.c.html#LN447"><span class='Ref_To_Local'>datalen</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsvector.c.html#LN468"><span class='Ref_To_Local'>npos</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
            <a href="tsvector.c.html#LN515"><span class='Ref_To_Local'>wepptr</span></a> <span class='Operator'>= </span><a href="../../../include/tsearch/ts_type.h.html#LN119"><span class='Ref_to_Macro'>POSDATAPTR</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN444"><span class='Ref_To_Local'>vec</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="tsvector.c.html#LN444"><span class='Ref_To_Local'>vec</span></a><span class='Operator'>-&GT;</span><a href="../../../include/tsearch/ts_type.h.html#LN102"><span class='Ref_to_Member'>entries</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN445"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN514"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="tsvector.c.html#LN514"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><a href="tsvector.c.html#LN468"><span class='Ref_To_Local'>npos</span></a><span class='Delimiter'>; </span><a href="tsvector.c.html#LN514"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="tsvector.c.html#LN515"><span class='Ref_To_Local'>wepptr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN514"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_type.h.html#LN62"><span class='Ref_to_Typedef'>WordEntryPos</span></a><span class='Parentheses'>) </span><a href="../../../include/libpq/pqformat.h.html#LN38"><span class='Ref_to_Proto'>pq_getmsgint</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN443"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_type.h.html#LN62"><span class='Ref_to_Typedef'>WordEntryPos</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN514"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="../../../include/tsearch/ts_type.h.html#LN79"><span class='Ref_to_Macro'>WEP_GETPOS</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN515"><span class='Ref_To_Local'>wepptr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN514"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><a href="../../../include/tsearch/ts_type.h.html#LN79"><span class='Ref_to_Macro'>WEP_GETPOS</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN515"><span class='Ref_To_Local'>wepptr</span></a><span class='Delimiter'>[</span><a href="tsvector.c.html#LN514"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
                    <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"position information is misordered"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <a href="tsvector.c.html#LN447"><span class='Ref_To_Local'>datalen</span></a> <span class='Operator'>+= </span><span class='Parentheses'>(</span><a href="tsvector.c.html#LN468"><span class='Ref_To_Local'>npos</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_type.h.html#LN40"><span class='Ref_to_Typedef'>WordEntry</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if npos&GT;0 &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=0;i&LT;nentries;i++ &raquo; </span> 
 
    <a href="../../../include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN444"><span class='Ref_To_Local'>vec</span></a><span class='Delimiter'>, </span><a href="tsvector.c.html#LN450"><span class='Ref_To_Local'>hdrlen</span></a> <span class='Operator'>+ </span><a href="tsvector.c.html#LN447"><span class='Ref_To_Local'>datalen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tsvector.c.html#LN452"><span class='Ref_To_Local'>needSort</span></a><span class='Parentheses'>) 
</span>        <a href="../../../port/qsort_arg.c.html#LN111"><span class='Ref_to_Func'>qsort_arg</span></a><span class='Parentheses'>((</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../../contrib/intarray/_int.h.html#LN13"><span class='Ref_to_Macro'>ARRPTR</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN444"><span class='Ref_To_Local'>vec</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="tsvector.c.html#LN444"><span class='Ref_To_Local'>vec</span></a><span class='Operator'>-&GT;</span><a href="../../../include/tsearch/ts_type.h.html#LN101"><span class='Ref_to_Member'>size</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/tsearch/ts_type.h.html#LN40"><span class='Ref_to_Typedef'>WordEntry</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                  <a href="tsvector.c.html#LN80"><span class='Ref_to_Func'>compareentry</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../../contrib/hstore/hstore.h.html#LN75"><span class='Ref_to_Macro'>STRPTR</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN444"><span class='Ref_To_Local'>vec</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/tsearch/ts_type.h.html#LN130"><span class='Ref_to_Macro'>PG_RETURN_TSVECTOR</span></a><span class='Parentheses'>(</span><a href="tsvector.c.html#LN444"><span class='Ref_To_Local'>vec</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end tsvectorrecv &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>